cscope 15 $HOME/School/CS_446/nautilus/src/rt/js               0001596779
	@config.h

1 
	~<«utûus/«utûus.h
>

2 
	~<«utûus/«ut_ty≥s.h
>

3 
	~<«utûus/«ut_°rög.h
>

4 
	~<«utûus/libccom∑t.h
>

7 
	#PRINT
(
fmt
, 
¨gs
...Ë
	`nk_vc_¥ötf
(fmt, ##¨gs)

	)

8 
	#PUTC
(
c
Ë
	`nk_vc_putch¨
(c)

	)

9 
	#¥ötf
 
PRINT


	)

10 
	#Ârötf
(
f
,
fmt
, 
¨gs
...Ë
	`PRINT
(fmt, ##¨gs)

	)

11 
	#_¥ötf
 
PRINT


	)

12 
	#_Ârötf
 
Ârötf


	)

13 
	#_putc
 
PUTC


	)

	@libregexp.c

25 
	~<«utûus/libccom∑t.h
>

26 
	~<π/js/cutûs.h
>

27 
	~<π/js/libªgexp.h
>

41 #i‡
deföed
(
TEST
)

42 
	#DUMP_REOP


	)

46 
	#DEF
(
id
, 
size
Ë
REOP_
 ## id,

	)

47 
	~<π/js/libªgexp-›code.h
>

48 #unde‡
DEF


49 
	mREOP_COUNT
,

50 } 
	tREOPCodeEnum
;

52 
	#CAPTURE_COUNT_MAX
 255

	)

53 
	#STACK_SIZE_MAX
 255

	)

56 
	#CP_LS
 0x2028

	)

57 
	#CP_PS
 0x2029

	)

59 
	#TMP_BUF_SIZE
 128

	)

62 
DynBuf
 
	mbyã_code
;

63 c⁄° 
uöt8_t
 *
	mbuf_±r
;

64 c⁄° 
uöt8_t
 *
	mbuf_íd
;

65 c⁄° 
uöt8_t
 *
	mbuf_°¨t
;

66 
	mª_Êags
;

67 
BOOL
 
	mis_utf16
;

68 
BOOL
 
	mign‹e_ˇ£
;

69 
BOOL
 
	mdŸÆl
;

70 
	mˇ±uª_cou¡
;

71 
	mtŸÆ_ˇ±uª_cou¡
;

72 
	mhas_«med_ˇ±uªs
;

73 *
	mmem_›aque
;

74 
DynBuf
 
	mgroup_«mes
;

76 
	mîr‹_msg
[
TMP_BUF_SIZE
];

77 
	mtmp_buf
[
TMP_BUF_SIZE
];

78 } 
	mu
;

79 } 
	tREP¨£Sèã
;

82 #ifde‡
DUMP_REOP


83 c⁄° *
	m«me
;

85 
uöt8_t
 
	msize
;

86 } 
	tREOpCode
;

88 c⁄° 
REOpCode
 
	gª›code_öfo
[
REOP_COUNT
] = {

89 #ifde‡
DUMP_REOP


90 
	#DEF
(
id
, 
size
Ë{ #id, sizê},

	)

92 
	#DEF
(
id
, 
size
Ë{ sizê},

	)

94 
	~<π/js/libªgexp-›code.h
>

95 #unde‡
DEF


98 
	#RE_HEADER_FLAGS
 0

	)

99 
	#RE_HEADER_CAPTURE_COUNT
 1

	)

100 
	#RE_HEADER_STACK_SIZE
 2

	)

102 
	#RE_HEADER_LEN
 7

	)

104 
ölöe
 
	$is_digô
(
c
) {

105  
c
 >= '0' && c <= '9';

106 
	}
}

109 
	$dbuf_ö£π
(
DynBuf
 *
s
, 
pos
, 
Àn
)

111 
	`dbuf_ªÆloc
(
s
, s->
size
 + 
Àn
);

112 
	`memmove
(
s
->
buf
 + 
pos
 + 
Àn
, s->bu‡+Öos, s->
size
 -Öos);

113 
s
->
size
 +
Àn
;

114 
	}
}

117 
uöt32_t
 
	$Ãe_ˇn⁄iˇlize
(
uöt32_t
 
c
, 
BOOL
 
is_utf16
)

119 
uöt32_t
 
ªs
[
LRE_CC_RES_LEN_MAX
];

120 
Àn
;

121 i‡(
is_utf16
) {

122 i‡(
	`likñy
(
c
 < 128)) {

123 i‡(
c
 >= 'A' && c <= 'Z')

124 
c
 = c - 'A' + 'a';

126 
	`Ãe_ˇ£_c⁄v
(
ªs
, 
c
, 2);

127 
c
 = 
ªs
[0];

130 i‡(
	`likñy
(
c
 < 128)) {

131 i‡(
c
 >= 'a' && c <= 'z')

132 
c
 = c - 'a' + 'A';

135 
Àn
 = 
	`Ãe_ˇ£_c⁄v
(
ªs
, 
c
, 
FALSE
);

136 i‡(
Àn
 =1 && 
ªs
[0] >= 128)

137 
c
 = 
ªs
[0];

140  
c
;

141 
	}
}

143 c⁄° 
uöt16_t
 
	gch¨_ønge_d
[] = {

149 c⁄° 
uöt16_t
 
	gch¨_ønge_s
[] = {

166 
BOOL
 
	$Ãe_is_•a˚
(
c
)

168 
i
, 
n
, 
low
, 
high
;

169 
n
 = (
	`cou¡of
(
ch¨_ønge_s
) - 1) / 2;

170 
i
 = 0; i < 
n
; i++) {

171 
low
 = 
ch¨_ønge_s
[2 * 
i
 + 1];

172 i‡(
c
 < 
low
)

173  
FALSE
;

174 
high
 = 
ch¨_ønge_s
[2 * 
i
 + 2];

175 i‡(
c
 < 
high
)

176  
TRUE
;

178  
FALSE
;

179 
	}
}

181 
uöt32_t
 c⁄° 
	gÃe_id_°¨t_èbÀ_ascii
[4] = {

186 
uöt32_t
 c⁄° 
	gÃe_id_c⁄töue_èbÀ_ascii
[4] = {

192 c⁄° 
uöt16_t
 
	gch¨_ønge_w
[] = {

200 
	#CLASS_RANGE_BASE
 0x40000000

	)

203 
	mCHAR_RANGE_d
,

204 
	mCHAR_RANGE_D
,

205 
	mCHAR_RANGE_s
,

206 
	mCHAR_RANGE_S
,

207 
	mCHAR_RANGE_w
,

208 
	mCHAR_RANGE_W
,

209 } 
	tCh¨R™geEnum
;

211 c⁄° 
uöt16_t
 *
	gch¨_ønge_èbÀ
[] = {

212 
ch¨_ønge_d
,

213 
ch¨_ønge_s
,

214 
ch¨_ønge_w
,

217 
	$¸_öô_ch¨_ønge
(
REP¨£Sèã
 *
s
, 
Ch¨R™ge
 *
¸
, 
uöt32_t
 
c
)

219 
BOOL
 
övît
;

220 c⁄° 
uöt16_t
 *
c_±
;

221 
Àn
, 
i
;

223 
övît
 = 
c
 & 1;

224 
c_±
 = 
ch¨_ønge_èbÀ
[
c
 >> 1];

225 
Àn
 = *
c_±
++;

226 
	`¸_öô
(
¸
, 
s
->
mem_›aque
, 
Ãe_ªÆloc
);

227 
i
 = 0; i < 
Àn
 * 2; i++) {

228 i‡(
	`¸_add_poöt
(
¸
, 
c_±
[
i
]))

229 
Áû
;

231 i‡(
övît
) {

232 i‡(
	`¸_övît
(
¸
))

233 
Áû
;

236 
Áû
:

237 
	`¸_‰ì
(
¸
);

239 
	}
}

241 
	$¸_ˇn⁄iˇlize
(
Ch¨R™ge
 *
¸
)

243 
Ch¨R™ge
 
a
;

244 
uöt32_t
 
±
[2];

245 
i
, 
ªt
;

247 
	`¸_öô
(&
a
, 
¸
->
mem_›aque
, 
Ãe_ªÆloc
);

248 
±
[0] = 'a';

249 
±
[1] = 'z' + 1;

250 
ªt
 = 
	`¸_›
(&
a
, 
¸
->
poöts
, cr->
Àn
, 
±
, 2, 
CR_OP_INTER
);

251 i‡(
ªt
)

252 
Áû
;

256 
i
 = 0; i < 
a
.
Àn
; i++) {

257 
a
.
poöts
[
i
] += 'A' - 'a';

260 
ªt
 = 
	`¸_uni⁄1
(
¸
, 
a
.
poöts
,á.
Àn
);

261 
Áû
:

262 
	`¸_‰ì
(&
a
);

263  
ªt
;

264 
	}
}

266 #ifde‡
DUMP_REOP


267 
__maybe_unu£d
 
	$Ãe_dump_byãcode
(c⁄° 
uöt8_t
 *
buf
,

268 
buf_Àn
)

270 
pos
, 
Àn
, 
›code
, 
bc_Àn
, 
ª_Êags
, 
i
;

271 
uöt32_t
 
vÆ
;

273 
	`as£π
(
buf_Àn
 >
RE_HEADER_LEN
);

275 
ª_Êags

buf
[0];

276 
bc_Àn
 = 
	`gë_u32
(
buf
 + 3);

277 
	`as£π
(
bc_Àn
 + 
RE_HEADER_LEN
 <
buf_Àn
);

278 
	`¥ötf
("flags: 0x%x capture_count=%d stack_size=%d\n",

279 
ª_Êags
, 
buf
[1], buf[2]);

280 i‡(
ª_Êags
 & 
LRE_FLAG_NAMED_GROUPS
) {

281 c⁄° *
p
;

282 
p
 = (*)
buf
 + 
RE_HEADER_LEN
 + 
bc_Àn
;

283 
	`¥ötf
("named groups: ");

284 
i
 = 1; i < 
buf
[1]; i++) {

285 i‡(
i
 != 1)

286 
	`¥ötf
(",");

287 
	`¥ötf
("<%s>", 
p
);

288 
p
 +
	`°æí
(p) + 1;

290 
	`¥ötf
("\n");

291 
	`as£π
(
p
 =(*)(
buf
 + 
buf_Àn
));

293 
	`¥ötf
("byãcode_Àn=%d\n", 
bc_Àn
);

295 
buf
 +
RE_HEADER_LEN
;

296 
pos
 = 0;

297 
pos
 < 
bc_Àn
) {

298 
	`¥ötf
("%5u: ", 
pos
);

299 
›code
 = 
buf
[
pos
];

300 
Àn
 = 
ª›code_öfo
[
›code
].
size
;

301 i‡(
›code
 >
REOP_COUNT
) {

302 
	`¥ötf
(" invÆid opcode=0x%02x\n", 
›code
);

305 i‡((
pos
 + 
Àn
Ë> 
bc_Àn
) {

306 
	`¥ötf
(" buf„∏ovîÊow (›code=0x%02x)\n", 
›code
);

309 
	`¥ötf
("%s", 
ª›code_öfo
[
›code
].
«me
);

310 
›code
) {

311 
REOP_ch¨
:

312 
vÆ
 = 
	`gë_u16
(
buf
 + 
pos
 + 1);

313 i‡(
vÆ
 >= ' ' && val <= 126)

314 
	`¥ötf
(" '%c'", 
vÆ
);

316 
	`¥ötf
(" 0x%04x", 
vÆ
);

318 
REOP_ch¨32
:

319 
vÆ
 = 
	`gë_u32
(
buf
 + 
pos
 + 1);

320 i‡(
vÆ
 >= ' ' && val <= 126)

321 
	`¥ötf
(" '%c'", 
vÆ
);

323 
	`¥ötf
(" 0x%08x", 
vÆ
);

325 
REOP_gŸo
:

326 
REOP_•lô_gŸo_fú°
:

327 
REOP_•lô_√xt_fú°
:

328 
REOP_lo›
:

329 
REOP_lookahód
:

330 
REOP_√g©ive_lookahód
:

331 
REOP_b√_ch¨_pos
:

332 
vÆ
 = 
	`gë_u32
(
buf
 + 
pos
 + 1);

333 
vÆ
 +(
pos
 + 5);

334 
	`¥ötf
(" %u", 
vÆ
);

336 
REOP_sim∂e_gªedy_qu™t
:

337 
	`¥ötf
(" %u %u %u %u",

338 
	`gë_u32
(
buf
 + 
pos
 + 1) + (pos + 17),

339 
	`gë_u32
(
buf
 + 
pos
 + 1 + 4),

340 
	`gë_u32
(
buf
 + 
pos
 + 1 + 8),

341 
	`gë_u32
(
buf
 + 
pos
 + 1 + 12));

343 
REOP_ßve_°¨t
:

344 
REOP_ßve_íd
:

345 
REOP_back_ª„ªn˚
:

346 
REOP_backw¨d_back_ª„ªn˚
:

347 
	`¥ötf
(" %u", 
buf
[
pos
 + 1]);

349 
REOP_ßve_ª£t
:

350 
	`¥ötf
(" %u %u", 
buf
[
pos
 + 1], buf[pos + 2]);

352 
REOP_push_i32
:

353 
vÆ
 = 
	`gë_u32
(
buf
 + 
pos
 + 1);

354 
	`¥ötf
(" %d", 
vÆ
);

356 
REOP_ønge
:

358 
n
, 
i
;

359 
n
 = 
	`gë_u16
(
buf
 + 
pos
 + 1);

360 
Àn
 +
n
 * 4;

361 
i
 = 0; i < 
n
 * 2; i++) {

362 
vÆ
 = 
	`gë_u16
(
buf
 + 
pos
 + 3 + 
i
 * 2);

363 
	`¥ötf
(" 0x%04x", 
vÆ
);

367 
REOP_ønge32
:

369 
n
, 
i
;

370 
n
 = 
	`gë_u16
(
buf
 + 
pos
 + 1);

371 
Àn
 +
n
 * 8;

372 
i
 = 0; i < 
n
 * 2; i++) {

373 
vÆ
 = 
	`gë_u32
(
buf
 + 
pos
 + 3 + 
i
 * 4);

374 
	`¥ötf
(" 0x%08x", 
vÆ
);

381 
	`¥ötf
("\n");

382 
pos
 +
Àn
;

384 
	}
}

387 
	$ª_emô_›
(
REP¨£Sèã
 *
s
, 
›
)

389 
	`dbuf_putc
(&
s
->
byã_code
, 
›
);

390 
	}
}

393 
	$ª_emô_›_u32
(
REP¨£Sèã
 *
s
, 
›
, 
uöt32_t
 
vÆ
)

395 
pos
;

396 
	`dbuf_putc
(&
s
->
byã_code
, 
›
);

397 
pos
 = 
s
->
byã_code
.
size
;

398 
	`dbuf_put_u32
(&
s
->
byã_code
, 
vÆ
);

399  
pos
;

400 
	}
}

402 
	$ª_emô_gŸo
(
REP¨£Sèã
 *
s
, 
›
, 
uöt32_t
 
vÆ
)

404 
pos
;

405 
	`dbuf_putc
(&
s
->
byã_code
, 
›
);

406 
pos
 = 
s
->
byã_code
.
size
;

407 
	`dbuf_put_u32
(&
s
->
byã_code
, 
vÆ
 - (
pos
 + 4));

408  
pos
;

409 
	}
}

411 
	$ª_emô_›_u8
(
REP¨£Sèã
 *
s
, 
›
, 
uöt32_t
 
vÆ
)

413 
	`dbuf_putc
(&
s
->
byã_code
, 
›
);

414 
	`dbuf_putc
(&
s
->
byã_code
, 
vÆ
);

415 
	}
}

417 
	$ª_emô_›_u16
(
REP¨£Sèã
 *
s
, 
›
, 
uöt32_t
 
vÆ
)

419 
	`dbuf_putc
(&
s
->
byã_code
, 
›
);

420 
	`dbuf_put_u16
(&
s
->
byã_code
, 
vÆ
);

421 
	}
}

423 
__©åibuã__
((
	$f‹m©
(
¥ötf
, 2, 3))Ë
	$ª_∑r£_îr‹
(
REP¨£Sèã
 *
s
, c⁄° *
fmt
, ...)

425 
va_li°
 
≠
;

426 
	`va_°¨t
(
≠
, 
fmt
);

427 
	`v¢¥ötf
(
s
->
u
.
îr‹_msg
, (s->u.îr‹_msg), 
fmt
, 
≠
);

428 
	`va_íd
(
≠
);

430 
	}
}

434 
	$∑r£_digôs
(c⁄° 
uöt8_t
 **
µ
, 
BOOL
 
Ælow_ovîÊow
)

436 c⁄° 
uöt8_t
 *
p
;

437 
uöt64_t
 
v
;

438 
c
;

440 
p
 = *
µ
;

441 
v
 = 0;

443 
c
 = *
p
;

444 i‡(
c
 < '0' || c > '9')

446 
v
 = v * 10 + 
c
 - '0';

447 i‡(
v
 >
INT32_MAX
) {

448 i‡(
Ælow_ovîÊow
)

449 
v
 = 
INT32_MAX
;

453 
p
++;

455 *
µ
 = 
p
;

456  
v
;

457 
	}
}

459 
	$ª_∑r£_ex≥˘
(
REP¨£Sèã
 *
s
, c⁄° 
uöt8_t
 **
µ
, 
c
)

461 c⁄° 
uöt8_t
 *
p
;

462 
p
 = *
µ
;

463 i‡(*
p
 !
c
)

464  
	`ª_∑r£_îr‹
(
s
, "ex≥˘ög '%c'", 
c
);

465 
p
++;

466 *
µ
 = 
p
;

468 
	}
}

480 
	$Ãe_∑r£_esˇ≥
(c⁄° 
uöt8_t
 **
µ
, 
Ælow_utf16
)

482 c⁄° 
uöt8_t
 *
p
;

483 
uöt32_t
 
c
;

485 
p
 = *
µ
;

486 
c
 = *
p
++;

487 
c
) {

489 
c
 = '\b';

492 
c
 = '\f';

495 
c
 = '\n';

498 
c
 = '\r';

501 
c
 = '\t';

504 
c
 = '\v';

509 
h
, 
n
, 
i
;

510 
uöt32_t
 
c1
;

512 i‡(*
p
 ='{' && 
Ælow_utf16
) {

513 
p
++;

514 
c
 = 0;

516 
h
 = 
	`‰om_hex
(*
p
++);

517 i‡(
h
 < 0)

519 
c
 = (¯<< 4Ë| 
h
;

520 i‡(
c
 > 0x10FFFF)

522 i‡(*
p
 == '}')

525 
p
++;

527 i‡(
c
 == 'x') {

528 
n
 = 2;

530 
n
 = 4;

533 
c
 = 0;

534 
i
 = 0; i < 
n
; i++) {

535 
h
 = 
	`‰om_hex
(*
p
++);

536 i‡(
h
 < 0) {

539 
c
 = (¯<< 4Ë| 
h
;

541 i‡(
c
 >= 0xd800 && c < 0xdc00 &&

542 
Ælow_utf16
 =2 && 
p
[0] == '\\' &&Ö[1] == 'u') {

545 
c1
 = 0;

546 
i
 = 0; i < 4; i++) {

547 
h
 = 
	`‰om_hex
(
p
[2 + 
i
]);

548 i‡(
h
 < 0)

550 
c1
 = (c1 << 4Ë| 
h
;

552 i‡(
i
 =4 && 
c1
 >= 0xdc00 && c1 < 0xe000) {

553 
p
 += 6;

554 
c
 = (((¯& 0x3ffË<< 10Ë| (
c1
 & 0x3ff)) + 0x10000;

561 
c
 -= '0';

562 i‡(
Ælow_utf16
 == 2) {

564 i‡(
c
 !0 || 
	`is_digô
(*
p
))

568 
uöt32_t
 
v
;

569 
v
 = *
p
 - '0';

570 i‡(
v
 > 7)

572 
c
 = (¯<< 3Ë| 
v
;

573 
p
++;

574 i‡(
c
 >= 32)

576 
v
 = *
p
 - '0';

577 i‡(
v
 > 7)

579 
c
 = (¯<< 3Ë| 
v
;

580 
p
++;

586 *
µ
 = 
p
;

587  
c
;

588 
	}
}

590 #ifde‡
CONFIG_ALL_UNICODE


592 
BOOL
 
	$is_unicode_ch¨
(
c
)

594  ((
c
 >= '0' && c <= '9') ||

595 (
c
 >= 'A' && c <= 'Z') ||

596 (
c
 >= 'a' && c <= 'z') ||

597 (
c
 == '_'));

598 
	}
}

600 
	$∑r£_unicode_¥›îty
(
REP¨£Sèã
 *
s
, 
Ch¨R™ge
 *
¸
,

601 c⁄° 
uöt8_t
 **
µ
, 
BOOL
 
is_öv
)

603 c⁄° 
uöt8_t
 *
p
;

604 
«me
[64], 
vÆue
[64];

605 *
q
;

606 
BOOL
 
s¸ùt_ext
;

607 
ªt
;

609 
p
 = *
µ
;

610 i‡(*
p
 != '{')

611  
	`ª_∑r£_îr‹
(
s
, "expecting '{'áfter \\p");

612 
p
++;

613 
q
 = 
«me
;

614 
	`is_unicode_ch¨
(*
p
)) {

615 i‡((
q
 - 
«me
) > (name) - 1)

616 
unknown_¥›îty_«me
;

617 *
q
++ = *
p
++;

619 *
q
 = '\0';

620 
q
 = 
vÆue
;

621 i‡(*
p
 == '=') {

622 
p
++;

623 
	`is_unicode_ch¨
(*
p
)) {

624 i‡((
q
 - 
vÆue
) > (value) - 1)

625  
	`ª_∑r£_îr‹
(
s
, "unknown unicodeÖroperty value");

626 *
q
++ = *
p
++;

629 *
q
 = '\0';

630 i‡(*
p
 != '}')

631  
	`ª_∑r£_îr‹
(
s
, "expecting '}'");

632 
p
++;

635 i‡(!
	`°rcmp
(
«me
, "Script") || !strcmp(name, "sc")) {

636 
s¸ùt_ext
 = 
FALSE
;

637 
do_s¸ùt
;

638 } i‡(!
	`°rcmp
(
«me
, "Script_Extensions") || !strcmp(name, "scx")) {

639 
s¸ùt_ext
 = 
TRUE
;

640 
do_s¸ùt
:

641 
	`¸_öô
(
¸
, 
s
->
mem_›aque
, 
Ãe_ªÆloc
);

642 
ªt
 = 
	`unicode_s¸ùt
(
¸
, 
vÆue
, 
s¸ùt_ext
);

643 i‡(
ªt
) {

644 
	`¸_‰ì
(
¸
);

645 i‡(
ªt
 == -2)

646  
	`ª_∑r£_îr‹
(
s
, "unknown unicode script");

648 
out_of_mem‹y
;

650 } i‡(!
	`°rcmp
(
«me
, "General_Category") || !strcmp(name, "gc")) {

651 
	`¸_öô
(
¸
, 
s
->
mem_›aque
, 
Ãe_ªÆloc
);

652 
ªt
 = 
	`unicode_gíîÆ_ˇãg‹y
(
¸
, 
vÆue
);

653 i‡(
ªt
) {

654 
	`¸_‰ì
(
¸
);

655 i‡(
ªt
 == -2)

656  
	`ª_∑r£_îr‹
(
s
, "unknown unicode general category");

658 
out_of_mem‹y
;

660 } i‡(
vÆue
[0] == '\0') {

661 
	`¸_öô
(
¸
, 
s
->
mem_›aque
, 
Ãe_ªÆloc
);

662 
ªt
 = 
	`unicode_gíîÆ_ˇãg‹y
(
¸
, 
«me
);

663 i‡(
ªt
 == -1) {

664 
	`¸_‰ì
(
¸
);

665 
out_of_mem‹y
;

667 i‡(
ªt
 < 0) {

668 
ªt
 = 
	`unicode_¥›
(
¸
, 
«me
);

669 i‡(
ªt
) {

670 
	`¸_‰ì
(
¸
);

671 i‡(
ªt
 == -2)

672 
unknown_¥›îty_«me
;

674 
out_of_mem‹y
;

678 
unknown_¥›îty_«me
:

679  
	`ª_∑r£_îr‹
(
s
, "unknown unicodeÖropertyÇame");

682 i‡(
is_öv
) {

683 i‡(
	`¸_övît
(
¸
)) {

684 
	`¸_‰ì
(
¸
);

688 *
µ
 = 
p
;

690 
out_of_mem‹y
:

691  
	`ª_∑r£_îr‹
(
s
, "out of memory");

692 
	}
}

698 
	$gë_˛ass_©om
(
REP¨£Sèã
 *
s
, 
Ch¨R™ge
 *
¸
,

699 c⁄° 
uöt8_t
 **
µ
, 
BOOL
 
ö˛ass
)

701 c⁄° 
uöt8_t
 *
p
;

702 
uöt32_t
 
c
;

703 
ªt
;

705 
p
 = *
µ
;

707 
c
 = *
p
;

708 
c
) {

710 
p
++;

711 i‡(
p
 >
s
->
buf_íd
)

712 
u√x≥˘ed_íd
;

713 
c
 = *
p
++;

714 
c
) {

716 
c
 = 
CHAR_RANGE_d
;

717 
˛ass_ønge
;

719 
c
 = 
CHAR_RANGE_D
;

720 
˛ass_ønge
;

722 
c
 = 
CHAR_RANGE_s
;

723 
˛ass_ønge
;

725 
c
 = 
CHAR_RANGE_S
;

726 
˛ass_ønge
;

728 
c
 = 
CHAR_RANGE_w
;

729 
˛ass_ønge
;

731 
c
 = 
CHAR_RANGE_W
;

732 
˛ass_ønge
:

733 i‡(
	`¸_öô_ch¨_ønge
(
s
, 
¸
, 
c
))

735 
c
 = 
CLASS_RANGE_BASE
;

738 
c
 = *
p
;

739 i‡((
c
 >= 'a' && c <= 'z') ||

740 (
c
 >= 'A' && c <= 'Z') ||

741 (((
c
 >= '0' && c <= '9') || c == '_') &&

742 
ö˛ass
 && !
s
->
is_utf16
)) {

743 
c
 &= 0x1f;

744 
p
++;

745 } i‡(
s
->
is_utf16
) {

746 
övÆid_esˇ≥
;

749 
p
--;

750 
c
 = '\\';

753 #ifde‡
CONFIG_ALL_UNICODE


756 i‡(
s
->
is_utf16
) {

757 i‡(
	`∑r£_unicode_¥›îty
(
s
, 
¸
, &
p
, (
c
 == 'P')))

759 
c
 = 
CLASS_RANGE_BASE
;

765 
p
--;

766 
ªt
 = 
	`Ãe_∑r£_esˇ≥
(&
p
, 
s
->
is_utf16
 * 2);

767 i‡(
ªt
 >= 0) {

768 
c
 = 
ªt
;

770 i‡(
ªt
 =-2 && *
p
 !'\0' && 
	`°rchr
("^$\\.*+?()[]{}|/", *p)) {

772 
n‹mÆ_ch¨
;

773 } i‡(
s
->
is_utf16
) {

774 
övÆid_esˇ≥
:

775  
	`ª_∑r£_îr‹
(
s
, "invalidÉscape sequence inÑegularÉxpression");

778 
n‹mÆ_ch¨
;

785 i‡(
p
 >
s
->
buf_íd
) {

786 
u√x≥˘ed_íd
:

787  
	`ª_∑r£_îr‹
(
s
, "unexpectedÉnd");

791 
n‹mÆ_ch¨
:

793 i‡(
c
 >= 128) {

794 
c
 = 
	`unicode_‰om_utf8
(
p
, 
UTF8_CHAR_LEN_MAX
, &p);

795 i‡(()
c
 > 0xfff‡&& !
s
->
is_utf16
) {

797  
	`ª_∑r£_îr‹
(
s
, "malformed unicode char");

800 
p
++;

804 *
µ
 = 
p
;

805  
c
;

806 
	}
}

808 
	$ª_emô_ønge
(
REP¨£Sèã
 *
s
, c⁄° 
Ch¨R™ge
 *
¸
)

810 
Àn
, 
i
;

811 
uöt32_t
 
high
;

813 
Àn
 = ()
¸
->len / 2;

814 i‡(
Àn
 >= 65535)

815  
	`ª_∑r£_îr‹
(
s
, "too manyÑanges");

816 i‡(
Àn
 == 0) {

819 
	`ª_emô_›_u32
(
s
, 
REOP_ch¨32
, -1);

821 
high
 = 
¸
->
poöts
[¸->
Àn
 - 1];

822 i‡(
high
 =
UINT32_MAX
)

823 
high
 = 
¸
->
poöts
[¸->
Àn
 - 2];

824 i‡(
high
 <= 0xffff) {

827 
	`ª_emô_›_u16
(
s
, 
REOP_ønge
, 
Àn
);

828 
i
 = 0; i < 
¸
->
Àn
; i += 2) {

829 
	`dbuf_put_u16
(&
s
->
byã_code
, 
¸
->
poöts
[
i
]);

830 
high
 = 
¸
->
poöts
[
i
 + 1] - 1;

831 i‡(
high
 =
UINT32_MAX
 - 1)

832 
high
 = 0xffff;

833 
	`dbuf_put_u16
(&
s
->
byã_code
, 
high
);

836 
	`ª_emô_›_u16
(
s
, 
REOP_ønge32
, 
Àn
);

837 
i
 = 0; i < 
¸
->
Àn
; i += 2) {

838 
	`dbuf_put_u32
(&
s
->
byã_code
, 
¸
->
poöts
[
i
]);

839 
	`dbuf_put_u32
(&
s
->
byã_code
, 
¸
->
poöts
[
i
 + 1] - 1);

844 
	}
}

846 
	$ª_∑r£_ch¨_˛ass
(
REP¨£Sèã
 *
s
, c⁄° 
uöt8_t
 **
µ
)

848 c⁄° 
uöt8_t
 *
p
;

849 
uöt32_t
 
c1
, 
c2
;

850 
Ch¨R™ge
 
¸_s
, *
¸
 = &cr_s;

851 
Ch¨R™ge
 
¸1_s
, *
¸1
 = &cr1_s;

852 
BOOL
 
övît
;

854 
	`¸_öô
(
¸
, 
s
->
mem_›aque
, 
Ãe_ªÆloc
);

855 
p
 = *
µ
;

856 
p
++;

857 
övît
 = 
FALSE
;

858 i‡(*
p
 == '^') {

859 
p
++;

860 
övît
 = 
TRUE
;

863 i‡(*
p
 == ']')

865 
c1
 = 
	`gë_˛ass_©om
(
s
, 
¸1
, &
p
, 
TRUE
);

866 i‡(()
c1
 < 0)

867 
Áû
;

868 i‡(*
p
 == '-' &&Ö[1] != ']') {

869 c⁄° 
uöt8_t
 *
p0
 = 
p
 + 1;

870 i‡(
c1
 >
CLASS_RANGE_BASE
) {

871 i‡(
s
->
is_utf16
) {

872 
	`¸_‰ì
(
¸1
);

873 
övÆid_˛ass_ønge
;

876 
˛ass_©om
;

878 
c2
 = 
	`gë_˛ass_©om
(
s
, 
¸1
, &
p0
, 
TRUE
);

879 i‡(()
c2
 < 0)

880 
Áû
;

881 i‡(
c2
 >
CLASS_RANGE_BASE
) {

882 
	`¸_‰ì
(
¸1
);

883 i‡(
s
->
is_utf16
) {

884 
övÆid_˛ass_ønge
;

887 
˛ass_©om
;

889 
p
 = 
p0
;

890 i‡(
c2
 < 
c1
) {

891 
övÆid_˛ass_ønge
:

892 
	`ª_∑r£_îr‹
(
s
, "invalid classÑange");

893 
Áû
;

895 i‡(
	`¸_uni⁄_öãrvÆ
(
¸
, 
c1
, 
c2
))

896 
mem‹y_îr‹
;

898 
˛ass_©om
:

899 i‡(
c1
 >
CLASS_RANGE_BASE
) {

900 
ªt
;

901 
ªt
 = 
	`¸_uni⁄1
(
¸
, 
¸1
->
poöts
, cr1->
Àn
);

902 
	`¸_‰ì
(
¸1
);

903 i‡(
ªt
)

904 
mem‹y_îr‹
;

906 i‡(
	`¸_uni⁄_öãrvÆ
(
¸
, 
c1
, c1))

907 
mem‹y_îr‹
;

911 i‡(
s
->
ign‹e_ˇ£
) {

912 i‡(
	`¸_ˇn⁄iˇlize
(
¸
))

913 
mem‹y_îr‹
;

915 i‡(
övît
) {

916 i‡(
	`¸_övît
(
¸
))

917 
mem‹y_îr‹
;

919 i‡(
	`ª_emô_ønge
(
s
, 
¸
))

920 
Áû
;

921 
	`¸_‰ì
(
¸
);

922 
p
++;

923 *
µ
 = 
p
;

925 
mem‹y_îr‹
:

926 
	`ª_∑r£_îr‹
(
s
, "out of memory");

927 
Áû
:

928 
	`¸_‰ì
(
¸
);

930 
	}
}

937 
	$ª_check_adv™˚
(c⁄° 
uöt8_t
 *
bc_buf
, 
bc_buf_Àn
)

939 
pos
, 
›code
, 
ªt
, 
Àn
, 
i
;

940 
uöt32_t
 
vÆ
, 
œ°
;

941 
BOOL
 
has_back_ª„ªn˚
;

942 
uöt8_t
 
ˇ±uª_bôm≠
[
CAPTURE_COUNT_MAX
];

944 
ªt
 = -2;

945 
pos
 = 0;

946 
has_back_ª„ªn˚
 = 
FALSE
;

947 
	`mem£t
(
ˇ±uª_bôm≠
, 0, (capture_bitmap));

949 
pos
 < 
bc_buf_Àn
) {

950 
›code
 = 
bc_buf
[
pos
];

951 
Àn
 = 
ª›code_öfo
[
›code
].
size
;

952 
›code
) {

953 
REOP_ønge
:

954 
vÆ
 = 
	`gë_u16
(
bc_buf
 + 
pos
 + 1);

955 
Àn
 +
vÆ
 * 4;

956 
sim∂e_ch¨
;

957 
REOP_ønge32
:

958 
vÆ
 = 
	`gë_u16
(
bc_buf
 + 
pos
 + 1);

959 
Àn
 +
vÆ
 * 8;

960 
sim∂e_ch¨
;

961 
REOP_ch¨
:

962 
REOP_ch¨32
:

963 
REOP_dŸ
:

964 
REOP_™y
:

965 
sim∂e_ch¨
:

966 i‡(
ªt
 == -2)

967 
ªt
 = 1;

969 
REOP_löe_°¨t
:

970 
REOP_löe_íd
:

971 
REOP_push_i32
:

972 
REOP_push_ch¨_pos
:

973 
REOP_dr›
:

974 
REOP_w‹d_bound¨y
:

975 
REOP_nŸ_w‹d_bound¨y
:

976 
REOP_¥ev
:

979 
REOP_ßve_°¨t
:

980 
REOP_ßve_íd
:

981 
vÆ
 = 
bc_buf
[
pos
 + 1];

982 
ˇ±uª_bôm≠
[
vÆ
] |= 1;

984 
REOP_ßve_ª£t
:

986 
vÆ
 = 
bc_buf
[
pos
 + 1];

987 
œ°
 = 
bc_buf
[
pos
 + 2];

988 
vÆ
 < 
œ°
)

989 
ˇ±uª_bôm≠
[
vÆ
++] |= 1;

992 
REOP_back_ª„ªn˚
:

993 
REOP_backw¨d_back_ª„ªn˚
:

994 
vÆ
 = 
bc_buf
[
pos
 + 1];

995 
ˇ±uª_bôm≠
[
vÆ
] |= 2;

996 
has_back_ª„ªn˚
 = 
TRUE
;

1000 i‡(
ªt
 == -2)

1001 
ªt
 = 0;

1004 
pos
 +
Àn
;

1006 i‡(
has_back_ª„ªn˚
) {

1009 
i
 = 0; i < 
CAPTURE_COUNT_MAX
; i++) {

1010 i‡(
ˇ±uª_bôm≠
[
i
] == 3)

1014 i‡(
ªt
 == -2)

1015 
ªt
 = 0;

1016  
ªt
;

1017 
	}
}

1021 
	$ª_is_sim∂e_qu™tifõr
(c⁄° 
uöt8_t
 *
bc_buf
, 
bc_buf_Àn
)

1023 
pos
, 
›code
, 
Àn
, 
cou¡
;

1024 
uöt32_t
 
vÆ
;

1026 
cou¡
 = 0;

1027 
pos
 = 0;

1028 
pos
 < 
bc_buf_Àn
) {

1029 
›code
 = 
bc_buf
[
pos
];

1030 
Àn
 = 
ª›code_öfo
[
›code
].
size
;

1031 
›code
) {

1032 
REOP_ønge
:

1033 
vÆ
 = 
	`gë_u16
(
bc_buf
 + 
pos
 + 1);

1034 
Àn
 +
vÆ
 * 4;

1035 
sim∂e_ch¨
;

1036 
REOP_ønge32
:

1037 
vÆ
 = 
	`gë_u16
(
bc_buf
 + 
pos
 + 1);

1038 
Àn
 +
vÆ
 * 8;

1039 
sim∂e_ch¨
;

1040 
REOP_ch¨
:

1041 
REOP_ch¨32
:

1042 
REOP_dŸ
:

1043 
REOP_™y
:

1044 
sim∂e_ch¨
:

1045 
cou¡
++;

1047 
REOP_löe_°¨t
:

1048 
REOP_löe_íd
:

1049 
REOP_w‹d_bound¨y
:

1050 
REOP_nŸ_w‹d_bound¨y
:

1055 
pos
 +
Àn
;

1057  
cou¡
;

1058 
	}
}

1061 
	$ª_∑r£_group_«me
(*
buf
, 
buf_size
,

1062 c⁄° 
uöt8_t
 **
µ
, 
BOOL
 
is_utf16
)

1064 c⁄° 
uöt8_t
 *
p
;

1065 
uöt32_t
 
c
;

1066 *
q
;

1068 
p
 = *
µ
;

1069 
q
 = 
buf
;

1071 
c
 = *
p
;

1072 i‡(
c
 == '\\') {

1073 
p
++;

1074 i‡(*
p
 != 'u')

1076 
c
 = 
	`Ãe_∑r£_esˇ≥
(&
p
, 
is_utf16
 * 2);

1077 } i‡(
c
 == '>') {

1079 } i‡(
c
 >= 128) {

1080 
c
 = 
	`unicode_‰om_utf8
(
p
, 
UTF8_CHAR_LEN_MAX
, &p);

1082 
p
++;

1084 i‡(
c
 > 0x10FFFF)

1086 i‡(
q
 =
buf
) {

1087 i‡(!
	`Ãe_js_is_idít_fú°
(
c
))

1090 i‡(!
	`Ãe_js_is_idít_√xt
(
c
))

1093 i‡((
q
 - 
buf
 + 
UTF8_CHAR_LEN_MAX
 + 1Ë> 
buf_size
)

1095 i‡(
c
 < 128) {

1096 *
q
++ = 
c
;

1098 
q
 +
	`unicode_to_utf8
((
uöt8_t
*)q, 
c
);

1101 i‡(
q
 =
buf
)

1103 *
q
 = '\0';

1104 
p
++;

1105 *
µ
 = 
p
;

1107 
	}
}

1112 
	$ª_∑r£_ˇ±uªs
(
REP¨£Sèã
 *
s
, *
phas_«med_ˇ±uªs
,

1113 c⁄° *
ˇ±uª_«me
)

1115 c⁄° 
uöt8_t
 *
p
;

1116 
ˇ±uª_ödex
;

1117 
«me
[
TMP_BUF_SIZE
];

1119 
ˇ±uª_ödex
 = 1;

1120 *
phas_«med_ˇ±uªs
 = 0;

1121 
p
 = 
s
->
buf_°¨t
;Ö < s->
buf_íd
;Ö++) {

1122 *
p
) {

1124 i‡(
p
[1] == '?') {

1125 i‡(
p
[2] == '<' &&Ö[3] != '=' &&Ö[3] != '!') {

1126 *
phas_«med_ˇ±uªs
 = 1;

1128 i‡(
ˇ±uª_«me
) {

1129 
p
 += 3;

1130 i‡(
	`ª_∑r£_group_«me
(
«me
, “ame), &
p
,

1131 
s
->
is_utf16
) == 0) {

1132 i‡(!
	`°rcmp
(
«me
, 
ˇ±uª_«me
))

1133  
ˇ±uª_ödex
;

1136 
ˇ±uª_ödex
++;

1139 
ˇ±uª_ödex
++;

1143 
p
++;

1146 
p
 +1 + (*∞=']');Ö < 
s
->
buf_íd
 && *p != ']';Ö++) {

1147 i‡(*
p
 == '\\')

1148 
p
++;

1153 i‡(
ˇ±uª_«me
)

1156  
ˇ±uª_ödex
;

1157 
	}
}

1159 
	$ª_cou¡_ˇ±uªs
(
REP¨£Sèã
 *
s
)

1161 i‡(
s
->
tŸÆ_ˇ±uª_cou¡
 < 0) {

1162 
s
->
tŸÆ_ˇ±uª_cou¡
 = 
	`ª_∑r£_ˇ±uªs
(s, &s->
has_«med_ˇ±uªs
,

1163 
NULL
);

1165  
s
->
tŸÆ_ˇ±uª_cou¡
;

1166 
	}
}

1168 
BOOL
 
	$ª_has_«med_ˇ±uªs
(
REP¨£Sèã
 *
s
)

1170 i‡(
s
->
has_«med_ˇ±uªs
 < 0)

1171 
	`ª_cou¡_ˇ±uªs
(
s
);

1172  
s
->
has_«med_ˇ±uªs
;

1173 
	}
}

1175 
	$föd_group_«me
(
REP¨£Sèã
 *
s
, c⁄° *
«me
)

1177 c⁄° *
p
, *
buf_íd
;

1178 
size_t
 
Àn
, 
«me_Àn
;

1179 
ˇ±uª_ödex
;

1181 
«me_Àn
 = 
	`°æí
(
«me
);

1182 
p
 = (*)
s
->
group_«mes
.
buf
;

1183 
buf_íd
 = (*)
s
->
group_«mes
.
buf
 + s->group_«mes.
size
;

1184 
ˇ±uª_ödex
 = 1;

1185 
p
 < 
buf_íd
) {

1186 
Àn
 = 
	`°æí
(
p
);

1187 i‡(
Àn
 =
«me_Àn
 && 
	`memcmp
(
«me
, 
p
,Çame_len) == 0)

1188  
ˇ±uª_ödex
;

1189 
p
 +
Àn
 + 1;

1190 
ˇ±uª_ödex
++;

1193 
	}
}

1195 
ª_∑r£_disjun˘i⁄
(
REP¨£Sèã
 *
s
, 
BOOL
 
is_backw¨d_dú
);

1197 
	$ª_∑r£_ãrm
(
REP¨£Sèã
 *
s
, 
BOOL
 
is_backw¨d_dú
)

1199 c⁄° 
uöt8_t
 *
p
;

1200 
c
, 
œ°_©om_°¨t
, 
qu™t_mö
, 
qu™t_max
, 
œ°_ˇ±uª_cou¡
;

1201 
BOOL
 
gªedy
, 
add_zîo_adv™˚_check
, 
is_√g
, 
is_backw¨d_lookahód
;

1202 
Ch¨R™ge
 
¸_s
, *
¸
 = &cr_s;

1204 
œ°_©om_°¨t
 = -1;

1205 
œ°_ˇ±uª_cou¡
 = 0;

1206 
p
 = 
s
->
buf_±r
;

1207 
c
 = *
p
;

1208 
c
) {

1210 
p
++;

1211 
	`ª_emô_›
(
s
, 
REOP_löe_°¨t
);

1214 
p
++;

1215 
	`ª_emô_›
(
s
, 
REOP_löe_íd
);

1218 
p
++;

1219 
œ°_©om_°¨t
 = 
s
->
byã_code
.
size
;

1220 
œ°_ˇ±uª_cou¡
 = 
s
->
ˇ±uª_cou¡
;

1221 i‡(
is_backw¨d_dú
)

1222 
	`ª_emô_›
(
s
, 
REOP_¥ev
);

1223 
	`ª_emô_›
(
s
, s->
dŸÆl
 ? 
REOP_™y
 : 
REOP_dŸ
);

1224 i‡(
is_backw¨d_dú
)

1225 
	`ª_emô_›
(
s
, 
REOP_¥ev
);

1228 i‡(
s
->
is_utf16
) {

1229  
	`ª_∑r£_îr‹
(
s
, "syntaxÉrror");

1230 } i‡(!
	`is_digô
(
p
[1])) {

1233 
∑r£_˛ass_©om
;

1235 c⁄° 
uöt8_t
 *
p1
 = 
p
 + 1;

1237 
	`∑r£_digôs
(&
p1
, 
TRUE
);

1238 i‡(*
p1
 == ',') {

1239 
p1
++;

1240 i‡(
	`is_digô
(*
p1
)) {

1241 
	`∑r£_digôs
(&
p1
, 
TRUE
);

1244 i‡(*
p1
 != '}') {

1245 
∑r£_˛ass_©om
;

1252  
	`ª_∑r£_îr‹
(
s
, "nothingÅoÑepeat");

1254 i‡(
p
[1] == '?') {

1255 i‡(
p
[2] == ':') {

1256 
p
 += 3;

1257 
œ°_©om_°¨t
 = 
s
->
byã_code
.
size
;

1258 
œ°_ˇ±uª_cou¡
 = 
s
->
ˇ±uª_cou¡
;

1259 
s
->
buf_±r
 = 
p
;

1260 i‡(
	`ª_∑r£_disjun˘i⁄
(
s
, 
is_backw¨d_dú
))

1262 
p
 = 
s
->
buf_±r
;

1263 i‡(
	`ª_∑r£_ex≥˘
(
s
, &
p
, ')'))

1265 } i‡((
p
[2] == '=' ||Ö[2] == '!')) {

1266 
is_√g
 = (
p
[2] == '!');

1267 
is_backw¨d_lookahód
 = 
FALSE
;

1268 
p
 += 3;

1269 
lookahód
;

1270 } i‡(
p
[2] == '<' &&

1271 (
p
[3] == '=' ||Ö[3] == '!')) {

1272 
pos
;

1273 
is_√g
 = (
p
[3] == '!');

1274 
is_backw¨d_lookahód
 = 
TRUE
;

1275 
p
 += 4;

1277 
lookahód
:

1280 i‡(!
s
->
is_utf16
 && !
is_backw¨d_lookahód
) {

1281 
œ°_©om_°¨t
 = 
s
->
byã_code
.
size
;

1282 
œ°_ˇ±uª_cou¡
 = 
s
->
ˇ±uª_cou¡
;

1284 
pos
 = 
	`ª_emô_›_u32
(
s
, 
REOP_lookahód
 + 
is_√g
, 0);

1285 
s
->
buf_±r
 = 
p
;

1286 i‡(
	`ª_∑r£_disjun˘i⁄
(
s
, 
is_backw¨d_lookahód
))

1288 
p
 = 
s
->
buf_±r
;

1289 i‡(
	`ª_∑r£_ex≥˘
(
s
, &
p
, ')'))

1291 
	`ª_emô_›
(
s
, 
REOP_m©ch
);

1293 
	`put_u32
(
s
->
byã_code
.
buf
 + 
pos
, s->byã_code.
size
 - (pos + 4));

1294 } i‡(
p
[2] == '<') {

1295 
p
 += 3;

1296 i‡(
	`ª_∑r£_group_«me
(
s
->
u
.
tmp_buf
, (s->u.tmp_buf),

1297 &
p
, 
s
->
is_utf16
)) {

1298  
	`ª_∑r£_îr‹
(
s
, "invalid groupÇame");

1300 i‡(
	`föd_group_«me
(
s
, s->
u
.
tmp_buf
) > 0) {

1301  
	`ª_∑r£_îr‹
(
s
, "duplicate groupÇame");

1304 
	`dbuf_put
(&
s
->
group_«mes
, (
uöt8_t
 *)s->
u
.
tmp_buf
,

1305 
	`°æí
(
s
->
u
.
tmp_buf
) + 1);

1306 
s
->
has_«med_ˇ±uªs
 = 1;

1307 
∑r£_ˇ±uª
;

1309  
	`ª_∑r£_îr‹
(
s
, "invalid group");

1312 
ˇ±uª_ödex
;

1313 
p
++;

1315 
	`dbuf_putc
(&
s
->
group_«mes
, 0);

1316 
∑r£_ˇ±uª
:

1317 i‡(
s
->
ˇ±uª_cou¡
 >
CAPTURE_COUNT_MAX
)

1318  
	`ª_∑r£_îr‹
(
s
, "too many captures");

1319 
œ°_©om_°¨t
 = 
s
->
byã_code
.
size
;

1320 
œ°_ˇ±uª_cou¡
 = 
s
->
ˇ±uª_cou¡
;

1321 
ˇ±uª_ödex
 = 
s
->
ˇ±uª_cou¡
++;

1322 
	`ª_emô_›_u8
(
s
, 
REOP_ßve_°¨t
 + 
is_backw¨d_dú
,

1323 
ˇ±uª_ödex
);

1325 
s
->
buf_±r
 = 
p
;

1326 i‡(
	`ª_∑r£_disjun˘i⁄
(
s
, 
is_backw¨d_dú
))

1328 
p
 = 
s
->
buf_±r
;

1330 
	`ª_emô_›_u8
(
s
, 
REOP_ßve_°¨t
 + 1 - 
is_backw¨d_dú
,

1331 
ˇ±uª_ödex
);

1333 i‡(
	`ª_∑r£_ex≥˘
(
s
, &
p
, ')'))

1338 
p
[1]) {

1341 
	`ª_emô_›
(
s
, 
REOP_w‹d_bound¨y
 + (
p
[1] != 'b'));

1342 
p
 += 2;

1346 c⁄° 
uöt8_t
 *
p1
;

1347 
dummy_ªs
;

1349 
p1
 = 
p
;

1350 i‡(
p1
[2] != '<') {

1354 i‡(
s
->
is_utf16
 || 
	`ª_has_«med_ˇ±uªs
(s))

1355  
	`ª_∑r£_îr‹
(
s
, "expecting groupÇame");

1357 
∑r£_˛ass_©om
;

1359 
p1
 += 3;

1360 i‡(
	`ª_∑r£_group_«me
(
s
->
u
.
tmp_buf
, (s->u.tmp_buf),

1361 &
p1
, 
s
->
is_utf16
)) {

1362 i‡(
s
->
is_utf16
 || 
	`ª_has_«med_ˇ±uªs
(s))

1363  
	`ª_∑r£_îr‹
(
s
, "invalid groupÇame");

1365 
∑r£_˛ass_©om
;

1367 
c
 = 
	`föd_group_«me
(
s
, s->
u
.
tmp_buf
);

1368 i‡(
c
 < 0) {

1371 
c
 = 
	`ª_∑r£_ˇ±uªs
(
s
, &
dummy_ªs
, s->
u
.
tmp_buf
);

1372 i‡(
c
 < 0) {

1373 i‡(
s
->
is_utf16
 || 
	`ª_has_«med_ˇ±uªs
(s))

1374  
	`ª_∑r£_îr‹
(
s
, "groupÇameÇot defined");

1376 
∑r£_˛ass_©om
;

1379 
p
 = 
p1
;

1381 
emô_back_ª„ªn˚
;

1383 
p
 += 2;

1384 
c
 = 0;

1385 i‡(
s
->
is_utf16
) {

1386 i‡(
	`is_digô
(*
p
)) {

1387  
	`ª_∑r£_îr‹
(
s
, "invalid decimalÉscape inÑegularÉxpression");

1391 i‡(*
p
 >= '0' && *p <= '7') {

1392 
c
 = *
p
++ - '0';

1393 i‡(*
p
 >= '0' && *p <= '7') {

1394 
c
 = (¯<< 3Ë+ *
p
++ - '0';

1398 
n‹mÆ_ch¨
;

1401 c⁄° 
uöt8_t
 *
q
 = ++
p
;

1403 
c
 = 
	`∑r£_digôs
(&
p
, 
FALSE
);

1404 i‡(
c
 < 0 || (¯>
s
->
ˇ±uª_cou¡
 && c >
	`ª_cou¡_ˇ±uªs
(s))) {

1405 i‡(!
s
->
is_utf16
) {

1407 
p
 = 
q
;

1408 i‡(*
p
 <= '7') {

1409 
c
 = 0;

1410 i‡(*
p
 <= '3')

1411 
c
 = *
p
++ - '0';

1412 i‡(*
p
 >= '0' && *p <= '7') {

1413 
c
 = (¯<< 3Ë+ *
p
++ - '0';

1414 i‡(*
p
 >= '0' && *p <= '7') {

1415 
c
 = (¯<< 3Ë+ *
p
++ - '0';

1419 
c
 = *
p
++;

1421 
n‹mÆ_ch¨
;

1423  
	`ª_∑r£_îr‹
(
s
, "backÑeference out ofÑange inÑeguarÉxpression");

1425 
emô_back_ª„ªn˚
:

1426 
œ°_©om_°¨t
 = 
s
->
byã_code
.
size
;

1427 
œ°_ˇ±uª_cou¡
 = 
s
->
ˇ±uª_cou¡
;

1428 
	`ª_emô_›_u8
(
s
, 
REOP_back_ª„ªn˚
 + 
is_backw¨d_dú
, 
c
);

1432 
∑r£_˛ass_©om
;

1436 
œ°_©om_°¨t
 = 
s
->
byã_code
.
size
;

1437 
œ°_ˇ±uª_cou¡
 = 
s
->
ˇ±uª_cou¡
;

1438 i‡(
is_backw¨d_dú
)

1439 
	`ª_emô_›
(
s
, 
REOP_¥ev
);

1440 i‡(
	`ª_∑r£_ch¨_˛ass
(
s
, &
p
))

1442 i‡(
is_backw¨d_dú
)

1443 
	`ª_emô_›
(
s
, 
REOP_¥ev
);

1447 i‡(
s
->
is_utf16
)

1448  
	`ª_∑r£_îr‹
(
s
, "syntaxÉrror");

1449 
∑r£_˛ass_©om
;

1451 
∑r£_˛ass_©om
:

1452 
c
 = 
	`gë_˛ass_©om
(
s
, 
¸
, &
p
, 
FALSE
);

1453 i‡(()
c
 < 0)

1455 
n‹mÆ_ch¨
:

1456 
œ°_©om_°¨t
 = 
s
->
byã_code
.
size
;

1457 
œ°_ˇ±uª_cou¡
 = 
s
->
ˇ±uª_cou¡
;

1458 i‡(
is_backw¨d_dú
)

1459 
	`ª_emô_›
(
s
, 
REOP_¥ev
);

1460 i‡(
c
 >
CLASS_RANGE_BASE
) {

1461 
ªt
;

1463 
ªt
 = 
	`ª_emô_ønge
(
s
, 
¸
);

1464 
	`¸_‰ì
(
¸
);

1465 i‡(
ªt
)

1468 i‡(
s
->
ign‹e_ˇ£
)

1469 
c
 = 
	`Ãe_ˇn⁄iˇlize
(c, 
s
->
is_utf16
);

1470 i‡(
c
 <= 0xffff)

1471 
	`ª_emô_›_u16
(
s
, 
REOP_ch¨
, 
c
);

1473 
	`ª_emô_›_u32
(
s
, 
REOP_ch¨32
, 
c
);

1475 i‡(
is_backw¨d_dú
)

1476 
	`ª_emô_›
(
s
, 
REOP_¥ev
);

1481 i‡(
œ°_©om_°¨t
 >= 0) {

1482 
c
 = *
p
;

1483 
c
) {

1485 
p
++;

1486 
qu™t_mö
 = 0;

1487 
qu™t_max
 = 
INT32_MAX
;

1488 
qu™tifõr
;

1490 
p
++;

1491 
qu™t_mö
 = 1;

1492 
qu™t_max
 = 
INT32_MAX
;

1493 
qu™tifõr
;

1495 
p
++;

1496 
qu™t_mö
 = 0;

1497 
qu™t_max
 = 1;

1498 
qu™tifõr
;

1501 c⁄° 
uöt8_t
 *
p1
 = 
p
;

1504 i‡(!
	`is_digô
(
p
[1])) {

1505 i‡(
s
->
is_utf16
)

1506 
övÆid_qu™t_cou¡
;

1509 
p
++;

1510 
qu™t_mö
 = 
	`∑r£_digôs
(&
p
, 
TRUE
);

1511 
qu™t_max
 = 
qu™t_mö
;

1512 i‡(*
p
 == ',') {

1513 
p
++;

1514 i‡(
	`is_digô
(*
p
)) {

1515 
qu™t_max
 = 
	`∑r£_digôs
(&
p
, 
TRUE
);

1516 i‡(
qu™t_max
 < 
qu™t_mö
) {

1517 
övÆid_qu™t_cou¡
:

1518  
	`ª_∑r£_îr‹
(
s
, "invalidÑepetition count");

1521 
qu™t_max
 = 
INT32_MAX
;

1524 i‡(*
p
 !'}' && !
s
->
is_utf16
) {

1526 
p
 = 
p1
;

1529 i‡(
	`ª_∑r£_ex≥˘
(
s
, &
p
, '}'))

1532 
qu™tifõr
:

1533 
gªedy
 = 
TRUE
;

1534 i‡(*
p
 == '?') {

1535 
p
++;

1536 
gªedy
 = 
FALSE
;

1538 i‡(
œ°_©om_°¨t
 < 0) {

1539  
	`ª_∑r£_îr‹
(
s
, "nothingÅoÑepeat");

1541 i‡(
gªedy
) {

1542 
Àn
, 
pos
;

1544 i‡(
qu™t_max
 > 0) {

1546 
Àn
 = 
	`ª_is_sim∂e_qu™tifõr
(
s
->
byã_code
.
buf
 + 
œ°_©om_°¨t
,

1547 
s
->
byã_code
.
size
 - 
œ°_©om_°¨t
);

1548 i‡(
Àn
 > 0) {

1549 
	`ª_emô_›
(
s
, 
REOP_m©ch
);

1551 
	`dbuf_ö£π
(&
s
->
byã_code
, 
œ°_©om_°¨t
, 17);

1552 
pos
 = 
œ°_©om_°¨t
;

1553 
s
->
byã_code
.
buf
[
pos
++] = 
REOP_sim∂e_gªedy_qu™t
;

1554 
	`put_u32
(&
s
->
byã_code
.
buf
[
pos
],

1555 
s
->
byã_code
.
size
 - 
œ°_©om_°¨t
 - 17);

1556 
pos
 += 4;

1557 
	`put_u32
(&
s
->
byã_code
.
buf
[
pos
], 
qu™t_mö
);

1558 
pos
 += 4;

1559 
	`put_u32
(&
s
->
byã_code
.
buf
[
pos
], 
qu™t_max
);

1560 
pos
 += 4;

1561 
	`put_u32
(&
s
->
byã_code
.
buf
[
pos
], 
Àn
);

1562 
pos
 += 4;

1563 
d⁄e
;

1567 
add_zîo_adv™˚_check
 = (
	`ª_check_adv™˚
(
s
->
byã_code
.
buf
 + 
œ°_©om_°¨t
,

1568 
s
->
byã_code
.
size
 - 
œ°_©om_°¨t
) == 0);

1570 
add_zîo_adv™˚_check
 = 
FALSE
;

1574 
Àn
, 
pos
;

1575 
Àn
 = 
s
->
byã_code
.
size
 - 
œ°_©om_°¨t
;

1576 i‡(
qu™t_mö
 == 0) {

1579 i‡(
œ°_ˇ±uª_cou¡
 !
s
->
ˇ±uª_cou¡
) {

1580 
	`dbuf_ö£π
(&
s
->
byã_code
, 
œ°_©om_°¨t
, 3);

1581 
s
->
byã_code
.
buf
[
œ°_©om_°¨t
++] = 
REOP_ßve_ª£t
;

1582 
s
->
byã_code
.
buf
[
œ°_©om_°¨t
++] = 
œ°_ˇ±uª_cou¡
;

1583 
s
->
byã_code
.
buf
[
œ°_©om_°¨t
++] = s->
ˇ±uª_cou¡
 - 1;

1585 i‡(
qu™t_max
 == 0) {

1586 
s
->
byã_code
.
size
 = 
œ°_©om_°¨t
;

1587 } i‡(
qu™t_max
 == 1) {

1588 
	`dbuf_ö£π
(&
s
->
byã_code
, 
œ°_©om_°¨t
, 5);

1589 
s
->
byã_code
.
buf
[
œ°_©om_°¨t
] = 
REOP_•lô_gŸo_fú°
 +

1590 
gªedy
;

1591 
	`put_u32
(
s
->
byã_code
.
buf
 + 
œ°_©om_°¨t
 + 1, 
Àn
);

1592 } i‡(
qu™t_max
 =
INT32_MAX
) {

1593 
	`dbuf_ö£π
(&
s
->
byã_code
, 
œ°_©om_°¨t
, 5 + 
add_zîo_adv™˚_check
);

1594 
s
->
byã_code
.
buf
[
œ°_©om_°¨t
] = 
REOP_•lô_gŸo_fú°
 +

1595 
gªedy
;

1596 
	`put_u32
(
s
->
byã_code
.
buf
 + 
œ°_©om_°¨t
 + 1,

1597 
Àn
 + 5 + 
add_zîo_adv™˚_check
);

1598 i‡(
add_zîo_adv™˚_check
) {

1603 
s
->
byã_code
.
buf
[
œ°_©om_°¨t
 + 1 + 4] = 
REOP_push_ch¨_pos
;

1604 
	`ª_emô_gŸo
(
s
, 
REOP_b√_ch¨_pos
, 
œ°_©om_°¨t
);

1606 
	`ª_emô_gŸo
(
s
, 
REOP_gŸo
, 
œ°_©om_°¨t
);

1609 
	`dbuf_ö£π
(&
s
->
byã_code
, 
œ°_©om_°¨t
, 10);

1610 
pos
 = 
œ°_©om_°¨t
;

1611 
s
->
byã_code
.
buf
[
pos
++] = 
REOP_push_i32
;

1612 
	`put_u32
(
s
->
byã_code
.
buf
 + 
pos
, 
qu™t_max
);

1613 
pos
 += 4;

1614 
s
->
byã_code
.
buf
[
pos
++] = 
REOP_•lô_gŸo_fú°
 + 
gªedy
;

1615 
	`put_u32
(
s
->
byã_code
.
buf
 + 
pos
, 
Àn
 + 5);

1616 
	`ª_emô_gŸo
(
s
, 
REOP_lo›
, 
œ°_©om_°¨t
 + 5);

1617 
	`ª_emô_›
(
s
, 
REOP_dr›
);

1619 } i‡(
qu™t_mö
 =1 && 
qu™t_max
 =
INT32_MAX
 &&

1620 !
add_zîo_adv™˚_check
) {

1621 
	`ª_emô_gŸo
(
s
, 
REOP_•lô_√xt_fú°
 - 
gªedy
,

1622 
œ°_©om_°¨t
);

1624 i‡(
qu™t_mö
 == 1) {

1627 
	`dbuf_ö£π
(&
s
->
byã_code
, 
œ°_©om_°¨t
, 5);

1628 
s
->
byã_code
.
buf
[
œ°_©om_°¨t
] = 
REOP_push_i32
;

1629 
	`put_u32
(
s
->
byã_code
.
buf
 + 
œ°_©om_°¨t
 + 1,

1630 
qu™t_mö
);

1631 
œ°_©om_°¨t
 += 5;

1632 
	`ª_emô_gŸo
(
s
, 
REOP_lo›
, 
œ°_©om_°¨t
);

1633 
	`ª_emô_›
(
s
, 
REOP_dr›
);

1635 i‡(
qu™t_max
 =
INT32_MAX
) {

1636 
pos
 = 
s
->
byã_code
.
size
;

1637 
	`ª_emô_›_u32
(
s
, 
REOP_•lô_gŸo_fú°
 + 
gªedy
,

1638 
Àn
 + 5 + 
add_zîo_adv™˚_check
);

1639 i‡(
add_zîo_adv™˚_check
)

1640 
	`ª_emô_›
(
s
, 
REOP_push_ch¨_pos
);

1642 
	`dbuf_put_£lf
(&
s
->
byã_code
, 
œ°_©om_°¨t
, 
Àn
);

1643 i‡(
add_zîo_adv™˚_check
)

1644 
	`ª_emô_gŸo
(
s
, 
REOP_b√_ch¨_pos
, 
pos
);

1646 
	`ª_emô_gŸo
(
s
, 
REOP_gŸo
, 
pos
);

1647 } i‡(
qu™t_max
 > 
qu™t_mö
) {

1648 
	`ª_emô_›_u32
(
s
, 
REOP_push_i32
, 
qu™t_max
 - 
qu™t_mö
);

1649 
pos
 = 
s
->
byã_code
.
size
;

1650 
	`ª_emô_›_u32
(
s
, 
REOP_•lô_gŸo_fú°
 + 
gªedy
, 
Àn
 + 5);

1652 
	`dbuf_put_£lf
(&
s
->
byã_code
, 
œ°_©om_°¨t
, 
Àn
);

1654 
	`ª_emô_gŸo
(
s
, 
REOP_lo›
, 
pos
);

1655 
	`ª_emô_›
(
s
, 
REOP_dr›
);

1658 
œ°_©om_°¨t
 = -1;

1665 
d⁄e
:

1666 
s
->
buf_±r
 = 
p
;

1668 
	}
}

1670 
	$ª_∑r£_Æã∫©ive
(
REP¨£Sèã
 *
s
, 
BOOL
 
is_backw¨d_dú
)

1672 c⁄° 
uöt8_t
 *
p
;

1673 
ªt
;

1674 
size_t
 
°¨t
, 
ãrm_°¨t
, 
íd
, 
ãrm_size
;

1676 
°¨t
 = 
s
->
byã_code
.
size
;

1678 
p
 = 
s
->
buf_±r
;

1679 i‡(
p
 >
s
->
buf_íd
)

1681 i‡(*
p
 == '|' || *p == ')')

1683 
ãrm_°¨t
 = 
s
->
byã_code
.
size
;

1684 
ªt
 = 
	`ª_∑r£_ãrm
(
s
, 
is_backw¨d_dú
);

1685 i‡(
ªt
)

1686  
ªt
;

1687 i‡(
is_backw¨d_dú
) {

1690 
íd
 = 
s
->
byã_code
.
size
;

1691 
ãrm_size
 = 
íd
 - 
ãrm_°¨t
;

1692 i‡(
	`dbuf_ªÆloc
(&
s
->
byã_code
, 
íd
 + 
ãrm_size
))

1694 
	`memmove
(
s
->
byã_code
.
buf
 + 
°¨t
 + 
ãrm_size
,

1695 
s
->
byã_code
.
buf
 + 
°¨t
,

1696 
íd
 - 
°¨t
);

1697 
	`mem˝y
(
s
->
byã_code
.
buf
 + 
°¨t
, s->byã_code.bu‡+ 
íd
,

1698 
ãrm_size
);

1702 
	}
}

1704 
	$ª_∑r£_disjun˘i⁄
(
REP¨£Sèã
 *
s
, 
BOOL
 
is_backw¨d_dú
)

1706 
°¨t
, 
Àn
, 
pos
;

1708 
°¨t
 = 
s
->
byã_code
.
size
;

1709 i‡(
	`ª_∑r£_Æã∫©ive
(
s
, 
is_backw¨d_dú
))

1711 *
s
->
buf_±r
 == '|') {

1712 
s
->
buf_±r
++;

1714 
Àn
 = 
s
->
byã_code
.
size
 - 
°¨t
;

1717 
	`dbuf_ö£π
(&
s
->
byã_code
, 
°¨t
, 5);

1718 
s
->
byã_code
.
buf
[
°¨t
] = 
REOP_•lô_√xt_fú°
;

1719 
	`put_u32
(
s
->
byã_code
.
buf
 + 
°¨t
 + 1, 
Àn
 + 5);

1721 
pos
 = 
	`ª_emô_›_u32
(
s
, 
REOP_gŸo
, 0);

1723 i‡(
	`ª_∑r£_Æã∫©ive
(
s
, 
is_backw¨d_dú
))

1727 
Àn
 = 
s
->
byã_code
.
size
 - (
pos
 + 4);

1728 
	`put_u32
(
s
->
byã_code
.
buf
 + 
pos
, 
Àn
);

1731 
	}
}

1734 
	$compuã_°ack_size
(c⁄° 
uöt8_t
 *
bc_buf
, 
bc_buf_Àn
)

1736 
°ack_size
, 
°ack_size_max
, 
pos
, 
›code
, 
Àn
;

1737 
uöt32_t
 
vÆ
;

1739 
°ack_size
 = 0;

1740 
°ack_size_max
 = 0;

1741 
bc_buf
 +
RE_HEADER_LEN
;

1742 
bc_buf_Àn
 -
RE_HEADER_LEN
;

1743 
pos
 = 0;

1744 
pos
 < 
bc_buf_Àn
) {

1745 
›code
 = 
bc_buf
[
pos
];

1746 
Àn
 = 
ª›code_öfo
[
›code
].
size
;

1747 
	`as£π
(
›code
 < 
REOP_COUNT
);

1748 
	`as£π
((
pos
 + 
Àn
Ë<
bc_buf_Àn
);

1749 
›code
) {

1750 
REOP_push_i32
:

1751 
REOP_push_ch¨_pos
:

1752 
°ack_size
++;

1753 i‡(
°ack_size
 > 
°ack_size_max
) {

1754 i‡(
°ack_size
 > 
STACK_SIZE_MAX
)

1756 
°ack_size_max
 = 
°ack_size
;

1759 
REOP_dr›
:

1760 
REOP_b√_ch¨_pos
:

1761 
	`as£π
(
°ack_size
 > 0);

1762 
°ack_size
--;

1764 
REOP_ønge
:

1765 
vÆ
 = 
	`gë_u16
(
bc_buf
 + 
pos
 + 1);

1766 
Àn
 +
vÆ
 * 4;

1768 
REOP_ønge32
:

1769 
vÆ
 = 
	`gë_u16
(
bc_buf
 + 
pos
 + 1);

1770 
Àn
 +
vÆ
 * 8;

1773 
pos
 +
Àn
;

1775  
°ack_size_max
;

1776 
	}
}

1782 
uöt8_t
 *
	$Ãe_compûe
(*
∂í
, *
îr‹_msg
, 
îr‹_msg_size
,

1783 c⁄° *
buf
, 
size_t
 
buf_Àn
, 
ª_Êags
,

1784 *
›aque
)

1786 
REP¨£Sèã
 
s_s
, *
s
 = &s_s;

1787 
°ack_size
;

1788 
BOOL
 
is_°icky
;

1790 
	`mem£t
(
s
, 0, (*s));

1791 
s
->
mem_›aque
 = 
›aque
;

1792 
s
->
buf_±r
 = (c⁄° 
uöt8_t
 *)
buf
;

1793 
s
->
buf_íd
 = s->
buf_±r
 + 
buf_Àn
;

1794 
s
->
buf_°¨t
 = s->
buf_±r
;

1795 
s
->
ª_Êags
 =Ñe_flags;

1796 
s
->
is_utf16
 = ((
ª_Êags
 & 
LRE_FLAG_UTF16
) != 0);

1797 
is_°icky
 = ((
ª_Êags
 & 
LRE_FLAG_STICKY
) != 0);

1798 
s
->
ign‹e_ˇ£
 = ((
ª_Êags
 & 
LRE_FLAG_IGNORECASE
) != 0);

1799 
s
->
dŸÆl
 = ((
ª_Êags
 & 
LRE_FLAG_DOTALL
) != 0);

1800 
s
->
ˇ±uª_cou¡
 = 1;

1801 
s
->
tŸÆ_ˇ±uª_cou¡
 = -1;

1802 
s
->
has_«med_ˇ±uªs
 = -1;

1804 
	`dbuf_öô2
(&
s
->
byã_code
, 
›aque
, 
Ãe_ªÆloc
);

1805 
	`dbuf_öô2
(&
s
->
group_«mes
, 
›aque
, 
Ãe_ªÆloc
);

1807 
	`dbuf_putc
(&
s
->
byã_code
, 
ª_Êags
);

1808 
	`dbuf_putc
(&
s
->
byã_code
, 0);

1809 
	`dbuf_putc
(&
s
->
byã_code
, 0);

1810 
	`dbuf_put_u32
(&
s
->
byã_code
, 0);

1812 i‡(!
is_°icky
) {

1817 
	`ª_emô_›_u32
(
s
, 
REOP_•lô_gŸo_fú°
, 1 + 5);

1818 
	`ª_emô_›
(
s
, 
REOP_™y
);

1819 
	`ª_emô_›_u32
(
s
, 
REOP_gŸo
, -(5 + 1 + 5));

1821 
	`ª_emô_›_u8
(
s
, 
REOP_ßve_°¨t
, 0);

1823 i‡(
	`ª_∑r£_disjun˘i⁄
(
s
, 
FALSE
)) {

1824 
îr‹
:

1825 
	`dbuf_‰ì
(&
s
->
byã_code
);

1826 
	`dbuf_‰ì
(&
s
->
group_«mes
);

1827 
	`p°r˝y
(
îr‹_msg
, 
îr‹_msg_size
, 
s
->
u
.error_msg);

1828 *
∂í
 = 0;

1829  
NULL
;

1832 
	`ª_emô_›_u8
(
s
, 
REOP_ßve_íd
, 0);

1834 
	`ª_emô_›
(
s
, 
REOP_m©ch
);

1836 i‡(*
s
->
buf_±r
 != '\0') {

1837 
	`ª_∑r£_îr‹
(
s
, "extraneous charactersátÅheÉnd");

1838 
îr‹
;

1841 i‡(
	`dbuf_îr‹
(&
s
->
byã_code
)) {

1842 
	`ª_∑r£_îr‹
(
s
, "out of memory");

1843 
îr‹
;

1846 
°ack_size
 = 
	`compuã_°ack_size
(
s
->
byã_code
.
buf
, s->byã_code.
size
);

1847 i‡(
°ack_size
 < 0) {

1848 
	`ª_∑r£_îr‹
(
s
, "too many imbricated quantifiers");

1849 
îr‹
;

1852 
s
->
byã_code
.
buf
[
RE_HEADER_CAPTURE_COUNT
] = s->
ˇ±uª_cou¡
;

1853 
s
->
byã_code
.
buf
[
RE_HEADER_STACK_SIZE
] = 
°ack_size
;

1854 
	`put_u32
(
s
->
byã_code
.
buf
 + 3, s->byã_code.
size
 - 
RE_HEADER_LEN
);

1857 i‡(
s
->
group_«mes
.
size
 > (s->
ˇ±uª_cou¡
 - 1)) {

1858 
	`dbuf_put
(&
s
->
byã_code
, s->
group_«mes
.
buf
, s->group_«mes.
size
);

1859 
s
->
byã_code
.
buf
[
RE_HEADER_FLAGS
] |
LRE_FLAG_NAMED_GROUPS
;

1861 
	`dbuf_‰ì
(&
s
->
group_«mes
);

1863 #ifde‡
DUMP_REOP


1864 
	`Ãe_dump_byãcode
(
s
->
byã_code
.
buf
, s->byã_code.
size
);

1867 
îr‹_msg
[0] = '\0';

1868 *
∂í
 = 
s
->
byã_code
.
size
;

1869  
s
->
byã_code
.
buf
;

1870 
	}
}

1872 
BOOL
 
	$is_löe_ãrmö©‹
(
uöt32_t
 
c
)

1874  (
c
 ='\n' || c ='\r' || c =
CP_LS
 || c =
CP_PS
);

1875 
	}
}

1877 
BOOL
 
	$is_w‹d_ch¨
(
uöt32_t
 
c
)

1879  ((
c
 >= '0' && c <= '9') ||

1880 (
c
 >= 'a' && c <= 'z') ||

1881 (
c
 >= 'A' && c <= 'Z') ||

1882 (
c
 == '_'));

1883 
	}
}

1885 
	#GET_CHAR
(
c
, 
˝å
, 
cbuf_íd
) \

1887 i‡(
cbuf_ty≥
 == 0) { \

1888 
c
 = *
˝å
++; \

1890 
uöt32_t
 
__c1
; \

1891 
c
 = *(
uöt16_t
 *)
˝å
; \

1892 
˝å
 += 2; \

1893 i‡(
c
 >= 0xd800 && c < 0xdc00 && \

1894 
cbuf_ty≥
 =2 && 
˝å
 < 
cbuf_íd
) { \

1895 
__c1
 = *(
uöt16_t
 *)
˝å
; \

1896 i‡(
__c1
 >= 0xdc00 && __c1 < 0xe000) { \

1897 
c
 = (((¯& 0x3ffË<< 10Ë| (
__c1
 & 0x3ff)) + 0x10000; \

1898 
˝å
 += 2; \

1902 } 0)

	)

1904 
	#PEEK_CHAR
(
c
, 
˝å
, 
cbuf_íd
) \

1906 i‡(
cbuf_ty≥
 == 0) { \

1907 
c
 = 
˝å
[0]; \

1909 
uöt32_t
 
__c1
; \

1910 
c
 = ((
uöt16_t
 *)
˝å
)[0]; \

1911 i‡(
c
 >= 0xd800 && c < 0xdc00 && \

1912 
cbuf_ty≥
 =2 && (
˝å
 + 2Ë< 
cbuf_íd
) { \

1913 
__c1
 = ((
uöt16_t
 *)
˝å
)[1]; \

1914 i‡(
__c1
 >= 0xdc00 && __c1 < 0xe000) { \

1915 
c
 = (((¯& 0x3ffË<< 10Ë| (
__c1
 & 0x3ff)) + 0x10000; \

1919 } 0)

	)

1921 
	#PEEK_PREV_CHAR
(
c
, 
˝å
, 
cbuf_°¨t
) \

1923 i‡(
cbuf_ty≥
 == 0) { \

1924 
c
 = 
˝å
[-1]; \

1926 
uöt32_t
 
__c1
; \

1927 
c
 = ((
uöt16_t
 *)
˝å
)[-1]; \

1928 i‡(
c
 >= 0xdc00 && c < 0xe000 && \

1929 
cbuf_ty≥
 =2 && (
˝å
 - 4Ë>
cbuf_°¨t
) { \

1930 
__c1
 = ((
uöt16_t
 *)
˝å
)[-2]; \

1931 i‡(
__c1
 >= 0xd800 && __c1 < 0xdc00 ) { \

1932 
c
 = (((
__c1
 & 0x3ff) << 10) | (c & 0x3ff)) + 0x10000; \

1936 } 0)

	)

1938 
	#GET_PREV_CHAR
(
c
, 
˝å
, 
cbuf_°¨t
) \

1940 i‡(
cbuf_ty≥
 == 0) { \

1941 
˝å
--; \

1942 
c
 = 
˝å
[0]; \

1944 
uöt32_t
 
__c1
; \

1945 
˝å
 -= 2; \

1946 
c
 = ((
uöt16_t
 *)
˝å
)[0]; \

1947 i‡(
c
 >= 0xdc00 && c < 0xe000 && \

1948 
cbuf_ty≥
 =2 && 
˝å
 > 
cbuf_°¨t
) { \

1949 
__c1
 = ((
uöt16_t
 *)
˝å
)[-1]; \

1950 i‡(
__c1
 >= 0xd800 && __c1 < 0xdc00 ) { \

1951 
˝å
 -= 2; \

1952 
c
 = (((
__c1
 & 0x3ff) << 10) | (c & 0x3ff)) + 0x10000; \

1956 } 0)

	)

1958 
	#PREV_CHAR
(
˝å
, 
cbuf_°¨t
) \

1960 i‡(
cbuf_ty≥
 == 0) { \

1961 
˝å
--; \

1963 
˝å
 -= 2; \

1964 i‡(
cbuf_ty≥
 == 2) { \

1965 
c
 = ((
uöt16_t
 *)
˝å
)[0]; \

1966 i‡(
c
 >0xdc00 && c < 0xe000 && 
˝å
 > 
cbuf_°¨t
) { \

1967 
c
 = ((
uöt16_t
 *)
˝å
)[-1]; \

1968 i‡(
c
 >= 0xd800 && c < 0xdc00) \

1969 
˝å
 -= 2; \

1973 } 0)

	)

1975 
uöçå_t
 
	tSèckI¡
;

1978 
	mRE_EXEC_STATE_SPLIT
,

1979 
	mRE_EXEC_STATE_LOOKAHEAD
,

1980 
	mRE_EXEC_STATE_NEGATIVE_LOOKAHEAD
,

1981 
	mRE_EXEC_STATE_GREEDY_QUANT
,

1982 } 
	tREExecSèãEnum
;

1984 
	sREExecSèã
 {

1985 
REExecSèãEnum
 
	mty≥
 : 8;

1986 
uöt8_t
 
	m°ack_Àn
;

1987 
size_t
 
	mcou¡
;

1988 c⁄° 
uöt8_t
 *
	m˝å
;

1989 c⁄° 
uöt8_t
 *
	mpc
;

1990 *
	mbuf
[0];

1991 } 
	tREExecSèã
;

1994 c⁄° 
uöt8_t
 *
	mcbuf
;

1995 c⁄° 
uöt8_t
 *
	mcbuf_íd
;

1997 
	mcbuf_ty≥
;

1998 
	mˇ±uª_cou¡
;

1999 
	m°ack_size_max
;

2000 
BOOL
 
	mmu…i_löe
;

2001 
BOOL
 
	mign‹e_ˇ£
;

2002 
BOOL
 
	mis_utf16
;

2003 *
	m›aque
;

2005 
size_t
 
	m°©e_size
;

2006 
uöt8_t
 *
	m°©e_°ack
;

2007 
size_t
 
	m°©e_°ack_size
;

2008 
size_t
 
	m°©e_°ack_Àn
;

2009 } 
	tREExecC⁄ãxt
;

2011 
	$push_°©e
(
REExecC⁄ãxt
 *
s
,

2012 
uöt8_t
 **
ˇ±uª
,

2013 
SèckI¡
 *
°ack
, 
size_t
 
°ack_Àn
,

2014 c⁄° 
uöt8_t
 *
pc
, c⁄° uöt8_à*
˝å
,

2015 
REExecSèãEnum
 
ty≥
, 
size_t
 
cou¡
)

2017 
REExecSèã
 *
rs
;

2018 
uöt8_t
 *
√w_°ack
;

2019 
size_t
 
√w_size
, 
i
, 
n
;

2020 
SèckI¡
 *
°ack_buf
;

2022 i‡(
	`u∆ikñy
((
s
->
°©e_°ack_Àn
 + 1Ë> s->
°©e_°ack_size
)) {

2024 
√w_size
 = 
s
->
°©e_°ack_size
 * 3 / 2;

2025 i‡(
√w_size
 < 8)

2026 
√w_size
 = 8;

2027 
√w_°ack
 = 
	`Ãe_ªÆloc
(
s
->
›aque
, s->
°©e_°ack
, 
√w_size
 * s->
°©e_size
);

2028 i‡(!
√w_°ack
)

2030 
s
->
°©e_°ack_size
 = 
√w_size
;

2031 
s
->
°©e_°ack
 = 
√w_°ack
;

2033 
rs
 = (
REExecSèã
 *)(
s
->
°©e_°ack
 + s->
°©e_°ack_Àn
 * s->
°©e_size
);

2034 
s
->
°©e_°ack_Àn
++;

2035 
rs
->
ty≥
 =Åype;

2036 
rs
->
cou¡
 = count;

2037 
rs
->
°ack_Àn
 = stack_len;

2038 
rs
->
˝å
 = cptr;

2039 
rs
->
pc
 =Öc;

2040 
n
 = 2 * 
s
->
ˇ±uª_cou¡
;

2041 
i
 = 0; i < 
n
; i++)

2042 
rs
->
buf
[
i
] = 
ˇ±uª
[i];

2043 
°ack_buf
 = (
SèckI¡
 *)(
rs
->
buf
 + 
n
);

2044 
i
 = 0; i < 
°ack_Àn
; i++)

2045 
°ack_buf
[
i
] = 
°ack
[i];

2047 
	}
}

2050 
öçå_t
 
	$Ãe_exec_backåack
(
REExecC⁄ãxt
 *
s
, 
uöt8_t
 **
ˇ±uª
,

2051 
SèckI¡
 *
°ack
, 
°ack_Àn
,

2052 c⁄° 
uöt8_t
 *
pc
, c⁄° uöt8_à*
˝å
,

2053 
BOOL
 
no_ªcur£
)

2055 
›code
, 
ªt
;

2056 
cbuf_ty≥
;

2057 
uöt32_t
 
vÆ
, 
c
;

2058 c⁄° 
uöt8_t
 *
cbuf_íd
;

2060 
cbuf_ty≥
 = 
s
->cbuf_type;

2061 
cbuf_íd
 = 
s
->cbuf_end;

2065 
›code
 = *
pc
++;

2066 
›code
) {

2067 
REOP_m©ch
:

2069 
REExecSèã
 *
rs
;

2070 i‡(
no_ªcur£
)

2071  (
öçå_t
)
˝å
;

2072 
ªt
 = 1;

2073 
ªcur£
;

2074 
no_m©ch
:

2075 i‡(
no_ªcur£
)

2077 
ªt
 = 0;

2078 
ªcur£
:

2080 i‡(
s
->
°©e_°ack_Àn
 == 0)

2081  
ªt
;

2082 
rs
 = (
REExecSèã
 *)(
s
->
°©e_°ack
 +

2083 (
s
->
°©e_°ack_Àn
 - 1Ë* s->
°©e_size
);

2084 i‡(
rs
->
ty≥
 =
RE_EXEC_STATE_SPLIT
) {

2085 i‡(!
ªt
) {

2086 
p›_°©e
:

2087 
	`mem˝y
(
ˇ±uª
, 
rs
->
buf
,

2088 (
ˇ±uª
[0]Ë* 2 * 
s
->
ˇ±uª_cou¡
);

2089 
p›_°©e1
:

2090 
pc
 = 
rs
->pc;

2091 
˝å
 = 
rs
->cptr;

2092 
°ack_Àn
 = 
rs
->stack_len;

2093 
	`mem˝y
(
°ack
, 
rs
->
buf
 + 2 * 
s
->
ˇ±uª_cou¡
,

2094 
°ack_Àn
 * (
°ack
[0]));

2095 
s
->
°©e_°ack_Àn
--;

2098 } i‡(
rs
->
ty≥
 =
RE_EXEC_STATE_GREEDY_QUANT
) {

2099 i‡(!
ªt
) {

2100 
uöt32_t
 
ch¨_cou¡
, 
i
;

2101 
	`mem˝y
(
ˇ±uª
, 
rs
->
buf
,

2102 (
ˇ±uª
[0]Ë* 2 * 
s
->
ˇ±uª_cou¡
);

2103 
°ack_Àn
 = 
rs
->stack_len;

2104 
	`mem˝y
(
°ack
, 
rs
->
buf
 + 2 * 
s
->
ˇ±uª_cou¡
,

2105 
°ack_Àn
 * (
°ack
[0]));

2106 
pc
 = 
rs
->pc;

2107 
˝å
 = 
rs
->cptr;

2109 
ch¨_cou¡
 = 
	`gë_u32
(
pc
 + 12);

2110 
i
 = 0; i < 
ch¨_cou¡
; i++) {

2111 
	`PREV_CHAR
(
˝å
, 
s
->
cbuf
);

2113 
pc
 = (p¯+ 16Ë+ ()
	`gë_u32
(pc);

2114 
rs
->
˝å
 = cptr;

2115 
rs
->
cou¡
--;

2116 i‡(
rs
->
cou¡
 == 0) {

2117 
s
->
°©e_°ack_Àn
--;

2122 
ªt
 = ((
rs
->
ty≥
 =
RE_EXEC_STATE_LOOKAHEAD
 &&Ñet) ||

2123 (
rs
->
ty≥
 =
RE_EXEC_STATE_NEGATIVE_LOOKAHEAD
 && !
ªt
));

2124 i‡(
ªt
) {

2126 i‡(
rs
->
ty≥
 =
RE_EXEC_STATE_LOOKAHEAD
)

2127 
p›_°©e1
;

2129 
p›_°©e
;

2132 
s
->
°©e_°ack_Àn
--;

2136 
REOP_ch¨32
:

2137 
vÆ
 = 
	`gë_u32
(
pc
);

2138 
pc
 += 4;

2139 
ã°_ch¨
;

2140 
REOP_ch¨
:

2141 
vÆ
 = 
	`gë_u16
(
pc
);

2142 
pc
 += 2;

2143 
ã°_ch¨
:

2144 i‡(
˝å
 >
cbuf_íd
)

2145 
no_m©ch
;

2146 
	`GET_CHAR
(
c
, 
˝å
, 
cbuf_íd
);

2147 i‡(
s
->
ign‹e_ˇ£
) {

2148 
c
 = 
	`Ãe_ˇn⁄iˇlize
(c, 
s
->
is_utf16
);

2150 i‡(
vÆ
 !
c
)

2151 
no_m©ch
;

2153 
REOP_•lô_gŸo_fú°
:

2154 
REOP_•lô_√xt_fú°
:

2156 c⁄° 
uöt8_t
 *
pc1
;

2158 
vÆ
 = 
	`gë_u32
(
pc
);

2159 
pc
 += 4;

2160 i‡(
›code
 =
REOP_•lô_√xt_fú°
) {

2161 
pc1
 = 
pc
 + ()
vÆ
;

2163 
pc1
 = 
pc
;

2164 
pc
 =Ö¯+ ()
vÆ
;

2166 
ªt
 = 
	`push_°©e
(
s
, 
ˇ±uª
, 
°ack
, 
°ack_Àn
,

2167 
pc1
, 
˝å
, 
RE_EXEC_STATE_SPLIT
, 0);

2168 i‡(
ªt
 < 0)

2172 
REOP_lookahód
:

2173 
REOP_√g©ive_lookahód
:

2174 
vÆ
 = 
	`gë_u32
(
pc
);

2175 
pc
 += 4;

2176 
ªt
 = 
	`push_°©e
(
s
, 
ˇ±uª
, 
°ack
, 
°ack_Àn
,

2177 
pc
 + ()
vÆ
, 
˝å
,

2178 
RE_EXEC_STATE_LOOKAHEAD
 + 
›code
 - 
REOP_lookahód
,

2180 i‡(
ªt
 < 0)

2184 
REOP_gŸo
:

2185 
vÆ
 = 
	`gë_u32
(
pc
);

2186 
pc
 +4 + ()
vÆ
;

2188 
REOP_löe_°¨t
:

2189 i‡(
˝å
 =
s
->
cbuf
)

2191 i‡(!
s
->
mu…i_löe
)

2192 
no_m©ch
;

2193 
	`PEEK_PREV_CHAR
(
c
, 
˝å
, 
s
->
cbuf
);

2194 i‡(!
	`is_löe_ãrmö©‹
(
c
))

2195 
no_m©ch
;

2197 
REOP_löe_íd
:

2198 i‡(
˝å
 =
cbuf_íd
)

2200 i‡(!
s
->
mu…i_löe
)

2201 
no_m©ch
;

2202 
	`PEEK_CHAR
(
c
, 
˝å
, 
cbuf_íd
);

2203 i‡(!
	`is_löe_ãrmö©‹
(
c
))

2204 
no_m©ch
;

2206 
REOP_dŸ
:

2207 i‡(
˝å
 =
cbuf_íd
)

2208 
no_m©ch
;

2209 
	`GET_CHAR
(
c
, 
˝å
, 
cbuf_íd
);

2210 i‡(
	`is_löe_ãrmö©‹
(
c
))

2211 
no_m©ch
;

2213 
REOP_™y
:

2214 i‡(
˝å
 =
cbuf_íd
)

2215 
no_m©ch
;

2216 
	`GET_CHAR
(
c
, 
˝å
, 
cbuf_íd
);

2218 
REOP_ßve_°¨t
:

2219 
REOP_ßve_íd
:

2220 
vÆ
 = *
pc
++;

2221 
	`as£π
(
vÆ
 < 
s
->
ˇ±uª_cou¡
);

2222 
ˇ±uª
[2 * 
vÆ
 + 
›code
 - 
REOP_ßve_°¨t
] = (
uöt8_t
 *)
˝å
;

2224 
REOP_ßve_ª£t
:

2226 
uöt32_t
 
vÆ2
;

2227 
vÆ
 = 
pc
[0];

2228 
vÆ2
 = 
pc
[1];

2229 
pc
 += 2;

2230 
	`as£π
(
vÆ2
 < 
s
->
ˇ±uª_cou¡
);

2231 
vÆ
 <
vÆ2
) {

2232 
ˇ±uª
[2 * 
vÆ
] = 
NULL
;

2233 
ˇ±uª
[2 * 
vÆ
 + 1] = 
NULL
;

2234 
vÆ
++;

2238 
REOP_push_i32
:

2239 
vÆ
 = 
	`gë_u32
(
pc
);

2240 
pc
 += 4;

2241 
°ack
[
°ack_Àn
++] = 
vÆ
;

2243 
REOP_dr›
:

2244 
°ack_Àn
--;

2246 
REOP_lo›
:

2247 
vÆ
 = 
	`gë_u32
(
pc
);

2248 
pc
 += 4;

2249 i‡(--
°ack
[
°ack_Àn
 - 1] != 0) {

2250 
pc
 +()
vÆ
;

2253 
REOP_push_ch¨_pos
:

2254 
°ack
[
°ack_Àn
++] = (
uöçå_t
)
˝å
;

2256 
REOP_b√_ch¨_pos
:

2257 
vÆ
 = 
	`gë_u32
(
pc
);

2258 
pc
 += 4;

2259 i‡(
°ack
[--
°ack_Àn
] !(
uöçå_t
)
˝å
)

2260 
pc
 +()
vÆ
;

2262 
REOP_w‹d_bound¨y
:

2263 
REOP_nŸ_w‹d_bound¨y
:

2265 
BOOL
 
v1
, 
v2
;

2267 i‡(
˝å
 =
s
->
cbuf
) {

2268 
v1
 = 
FALSE
;

2270 
	`PEEK_PREV_CHAR
(
c
, 
˝å
, 
s
->
cbuf
);

2271 
v1
 = 
	`is_w‹d_ch¨
(
c
);

2274 i‡(
˝å
 >
cbuf_íd
) {

2275 
v2
 = 
FALSE
;

2277 
	`PEEK_CHAR
(
c
, 
˝å
, 
cbuf_íd
);

2278 
v2
 = 
	`is_w‹d_ch¨
(
c
);

2280 i‡(
v1
 ^ 
v2
 ^ (
REOP_nŸ_w‹d_bound¨y
 - 
›code
))

2281 
no_m©ch
;

2284 
REOP_back_ª„ªn˚
:

2285 
REOP_backw¨d_back_ª„ªn˚
:

2287 c⁄° 
uöt8_t
 *
˝å1
, *
˝å1_íd
, *
˝å1_°¨t
;

2288 
uöt32_t
 
c1
, 
c2
;

2290 
vÆ
 = *
pc
++;

2291 i‡(
vÆ
 >
s
->
ˇ±uª_cou¡
)

2292 
no_m©ch
;

2293 
˝å1_°¨t
 = 
ˇ±uª
[2 * 
vÆ
];

2294 
˝å1_íd
 = 
ˇ±uª
[2 * 
vÆ
 + 1];

2295 i‡(!
˝å1_°¨t
 || !
˝å1_íd
)

2297 i‡(
›code
 =
REOP_back_ª„ªn˚
) {

2298 
˝å1
 = 
˝å1_°¨t
;

2299 
˝å1
 < 
˝å1_íd
) {

2300 i‡(
˝å
 >
cbuf_íd
)

2301 
no_m©ch
;

2302 
	`GET_CHAR
(
c1
, 
˝å1
, 
˝å1_íd
);

2303 
	`GET_CHAR
(
c2
, 
˝å
, 
cbuf_íd
);

2304 i‡(
s
->
ign‹e_ˇ£
) {

2305 
c1
 = 
	`Ãe_ˇn⁄iˇlize
(c1, 
s
->
is_utf16
);

2306 
c2
 = 
	`Ãe_ˇn⁄iˇlize
(c2, 
s
->
is_utf16
);

2308 i‡(
c1
 !
c2
)

2309 
no_m©ch
;

2312 
˝å1
 = 
˝å1_íd
;

2313 
˝å1
 > 
˝å1_°¨t
) {

2314 i‡(
˝å
 =
s
->
cbuf
)

2315 
no_m©ch
;

2316 
	`GET_PREV_CHAR
(
c1
, 
˝å1
, 
˝å1_°¨t
);

2317 
	`GET_PREV_CHAR
(
c2
, 
˝å
, 
s
->
cbuf
);

2318 i‡(
s
->
ign‹e_ˇ£
) {

2319 
c1
 = 
	`Ãe_ˇn⁄iˇlize
(c1, 
s
->
is_utf16
);

2320 
c2
 = 
	`Ãe_ˇn⁄iˇlize
(c2, 
s
->
is_utf16
);

2322 i‡(
c1
 !
c2
)

2323 
no_m©ch
;

2328 
REOP_ønge
:

2330 
n
;

2331 
uöt32_t
 
low
, 
high
, 
idx_mö
, 
idx_max
, 
idx
;

2333 
n
 = 
	`gë_u16
(
pc
);

2334 
pc
 += 2;

2335 i‡(
˝å
 >
cbuf_íd
)

2336 
no_m©ch
;

2337 
	`GET_CHAR
(
c
, 
˝å
, 
cbuf_íd
);

2338 i‡(
s
->
ign‹e_ˇ£
) {

2339 
c
 = 
	`Ãe_ˇn⁄iˇlize
(c, 
s
->
is_utf16
);

2341 
idx_mö
 = 0;

2342 
low
 = 
	`gë_u16
(
pc
 + 0 * 4);

2343 i‡(
c
 < 
low
)

2344 
no_m©ch
;

2345 
idx_max
 = 
n
 - 1;

2346 
high
 = 
	`gë_u16
(
pc
 + 
idx_max
 * 4 + 2);

2348 i‡(
	`u∆ikñy
(
c
 >0xffffË&& 
high
 == 0xffff)

2349 
ønge_m©ch
;

2350 i‡(
c
 > 
high
)

2351 
no_m©ch
;

2352 
idx_mö
 <
idx_max
) {

2353 
idx
 = (
idx_mö
 + 
idx_max
) / 2;

2354 
low
 = 
	`gë_u16
(
pc
 + 
idx
 * 4);

2355 
high
 = 
	`gë_u16
(
pc
 + 
idx
 * 4 + 2);

2356 i‡(
c
 < 
low
)

2357 
idx_max
 = 
idx
 - 1;

2358 i‡(
c
 > 
high
)

2359 
idx_mö
 = 
idx
 + 1;

2361 
ønge_m©ch
;

2363 
no_m©ch
;

2364 
ønge_m©ch
:

2365 
pc
 +4 * 
n
;

2368 
REOP_ønge32
:

2370 
n
;

2371 
uöt32_t
 
low
, 
high
, 
idx_mö
, 
idx_max
, 
idx
;

2373 
n
 = 
	`gë_u16
(
pc
);

2374 
pc
 += 2;

2375 i‡(
˝å
 >
cbuf_íd
)

2376 
no_m©ch
;

2377 
	`GET_CHAR
(
c
, 
˝å
, 
cbuf_íd
);

2378 i‡(
s
->
ign‹e_ˇ£
) {

2379 
c
 = 
	`Ãe_ˇn⁄iˇlize
(c, 
s
->
is_utf16
);

2381 
idx_mö
 = 0;

2382 
low
 = 
	`gë_u32
(
pc
 + 0 * 8);

2383 i‡(
c
 < 
low
)

2384 
no_m©ch
;

2385 
idx_max
 = 
n
 - 1;

2386 
high
 = 
	`gë_u32
(
pc
 + 
idx_max
 * 8 + 4);

2387 i‡(
c
 > 
high
)

2388 
no_m©ch
;

2389 
idx_mö
 <
idx_max
) {

2390 
idx
 = (
idx_mö
 + 
idx_max
) / 2;

2391 
low
 = 
	`gë_u32
(
pc
 + 
idx
 * 8);

2392 
high
 = 
	`gë_u32
(
pc
 + 
idx
 * 8 + 4);

2393 i‡(
c
 < 
low
)

2394 
idx_max
 = 
idx
 - 1;

2395 i‡(
c
 > 
high
)

2396 
idx_mö
 = 
idx
 + 1;

2398 
ønge32_m©ch
;

2400 
no_m©ch
;

2401 
ønge32_m©ch
:

2402 
pc
 +8 * 
n
;

2405 
REOP_¥ev
:

2407 i‡(
˝å
 =
s
->
cbuf
)

2408 
no_m©ch
;

2409 
	`PREV_CHAR
(
˝å
, 
s
->
cbuf
);

2411 
REOP_sim∂e_gªedy_qu™t
:

2413 
uöt32_t
 
√xt_pos
, 
qu™t_mö
, 
qu™t_max
;

2414 
size_t
 
q
;

2415 
öçå_t
 
ªs
;

2416 c⁄° 
uöt8_t
 *
pc1
;

2418 
√xt_pos
 = 
	`gë_u32
(
pc
);

2419 
qu™t_mö
 = 
	`gë_u32
(
pc
 + 4);

2420 
qu™t_max
 = 
	`gë_u32
(
pc
 + 8);

2421 
pc
 += 16;

2422 
pc1
 = 
pc
;

2423 
pc
 +()
√xt_pos
;

2425 
q
 = 0;

2427 
ªs
 = 
	`Ãe_exec_backåack
(
s
, 
ˇ±uª
, 
°ack
, 
°ack_Àn
,

2428 
pc1
, 
˝å
, 
TRUE
);

2429 i‡(
ªs
 == -1)

2430  
ªs
;

2431 i‡(!
ªs
)

2433 
˝å
 = (
uöt8_t
 *)
ªs
;

2434 
q
++;

2435 i‡(
q
 >
qu™t_max
 && qu™t_max !
INT32_MAX
)

2438 i‡(
q
 < 
qu™t_mö
)

2439 
no_m©ch
;

2440 i‡(
q
 > 
qu™t_mö
) {

2442 
ªt
 = 
	`push_°©e
(
s
, 
ˇ±uª
, 
°ack
, 
°ack_Àn
,

2443 
pc1
 - 16, 
˝å
,

2444 
RE_EXEC_STATE_GREEDY_QUANT
,

2445 
q
 - 
qu™t_mö
);

2446 i‡(
ªt
 < 0)

2452 
	`ab‹t
();

2455 
	}
}

2460 
	$Ãe_exec
(
uöt8_t
 **
ˇ±uª
,

2461 c⁄° 
uöt8_t
 *
bc_buf
, c⁄° uöt8_à*
cbuf
, 
cödex
, 
˛í
,

2462 
cbuf_ty≥
, *
›aque
)

2464 
REExecC⁄ãxt
 
s_s
, *
s
 = &s_s;

2465 
ª_Êags
, 
i
, 
Æloˇ_size
, 
ªt
;

2466 
SèckI¡
 *
°ack_buf
;

2468 
ª_Êags
 = 
bc_buf
[
RE_HEADER_FLAGS
];

2469 
s
->
mu…i_löe
 = (
ª_Êags
 & 
LRE_FLAG_MULTILINE
) != 0;

2470 
s
->
ign‹e_ˇ£
 = (
ª_Êags
 & 
LRE_FLAG_IGNORECASE
) != 0;

2471 
s
->
is_utf16
 = (
ª_Êags
 & 
LRE_FLAG_UTF16
) != 0;

2472 
s
->
ˇ±uª_cou¡
 = 
bc_buf
[
RE_HEADER_CAPTURE_COUNT
];

2473 
s
->
°ack_size_max
 = 
bc_buf
[
RE_HEADER_STACK_SIZE
];

2474 
s
->
cbuf
 = cbuf;

2475 
s
->
cbuf_íd
 = 
cbuf
 + (
˛í
 << 
cbuf_ty≥
);

2476 
s
->
cbuf_ty≥
 = cbuf_type;

2477 i‡(
s
->
cbuf_ty≥
 =1 && s->
is_utf16
)

2478 
s
->
cbuf_ty≥
 = 2;

2479 
s
->
›aque
 = opaque;

2481 
s
->
°©e_size
 = (
REExecSèã
) +

2482 
s
->
ˇ±uª_cou¡
 * (
ˇ±uª
[0]) * 2 +

2483 
s
->
°ack_size_max
 * (
°ack_buf
[0]);

2484 
s
->
°©e_°ack
 = 
NULL
;

2485 
s
->
°©e_°ack_Àn
 = 0;

2486 
s
->
°©e_°ack_size
 = 0;

2488 
i
 = 0; i < 
s
->
ˇ±uª_cou¡
 * 2; i++)

2489 
ˇ±uª
[
i
] = 
NULL
;

2490 
Æloˇ_size
 = 
s
->
°ack_size_max
 * (
°ack_buf
[0]);

2491 
°ack_buf
 = 
	`Æloˇ
(
Æloˇ_size
);

2492 
ªt
 = 
	`Ãe_exec_backåack
(
s
, 
ˇ±uª
, 
°ack_buf
, 0, 
bc_buf
 + 
RE_HEADER_LEN
,

2493 
cbuf
 + (
cödex
 << 
cbuf_ty≥
), 
FALSE
);

2494 
	`Ãe_ªÆloc
(
s
->
›aque
, s->
°©e_°ack
, 0);

2495  
ªt
;

2496 
	}
}

2498 
	$Ãe_gë_ˇ±uª_cou¡
(c⁄° 
uöt8_t
 *
bc_buf
)

2500  
bc_buf
[
RE_HEADER_CAPTURE_COUNT
];

2501 
	}
}

2503 
	$Ãe_gë_Êags
(c⁄° 
uöt8_t
 *
bc_buf
)

2505  
bc_buf
[
RE_HEADER_FLAGS
];

2506 
	}
}

2508 #ifde‡
TEST


2510 
BOOL
 
	$Ãe_check_°ack_ovîÊow
(*
›aque
, 
size_t
 
Æloˇ_size
)

2512  
FALSE
;

2513 
	}
}

2515 *
	$Ãe_ªÆloc
(*
›aque
, *
±r
, 
size_t
 
size
)

2517  
	`ªÆloc
(
±r
, 
size
);

2518 
	}
}

2520 
	$maö
(
¨gc
, **
¨gv
)

2522 
Àn
, 
ªt
, 
i
;

2523 
uöt8_t
 *
bc
;

2524 
îr‹_msg
[64];

2525 
uöt8_t
 *
ˇ±uª
[
CAPTURE_COUNT_MAX
 * 2];

2526 c⁄° *
öput
;

2527 
öput_Àn
, 
ˇ±uª_cou¡
;

2529 i‡(
¨gc
 < 3) {

2530 
	`¥ötf
("ußge: %†ªgex∞öput\n", 
¨gv
[0]);

2531 
	`exô
(1);

2533 
bc
 = 
	`Ãe_compûe
(&
Àn
, 
îr‹_msg
, ”º‹_msg), 
¨gv
[1],

2534 
	`°æí
(
¨gv
[1]), 0, 
NULL
);

2535 i‡(!
bc
) {

2536 
	`Ârötf
(
°dîr
, "îr‹: %s\n", 
îr‹_msg
);

2537 
	`exô
(1);

2540 
öput
 = 
¨gv
[2];

2541 
öput_Àn
 = 
	`°æí
(
öput
);

2543 
ªt
 = 
	`Ãe_exec
(
ˇ±uª
, 
bc
, (
uöt8_t
 *)
öput
, 0, 
öput_Àn
, 0, 
NULL
);

2544 
	`¥ötf
("ªt=%d\n", 
ªt
);

2545 i‡(
ªt
 == 1) {

2546 
ˇ±uª_cou¡
 = 
	`Ãe_gë_ˇ±uª_cou¡
(
bc
);

2547 
i
 = 0; i < 2 * 
ˇ±uª_cou¡
; i++) {

2548 
uöt8_t
 *
±r
;

2549 
±r
 = 
ˇ±uª
[
i
];

2550 
	`¥ötf
("%d: ", 
i
);

2551 i‡(!
±r
)

2552 
	`¥ötf
("<nil>");

2554 
	`¥ötf
("%u", ()(
±r
 - (
uöt8_t
 *)
öput
));

2555 
	`¥ötf
("\n");

2559 
	}
}

	@libunicode.c

25 
	~<π/js/cutûs.h
>

26 
	~<π/js/libunicode.h
>

27 
	~<π/js/libunicode-èbÀ.h
>

30 
	mRUN_TYPE_U
,

31 
	mRUN_TYPE_L
,

32 
	mRUN_TYPE_UF
,

33 
	mRUN_TYPE_LF
,

34 
	mRUN_TYPE_UL
,

35 
	mRUN_TYPE_LSU
,

36 
	mRUN_TYPE_U2L_399_EXT2
,

37 
	mRUN_TYPE_UF_D20
,

38 
	mRUN_TYPE_UF_D1_EXT
,

39 
	mRUN_TYPE_U_EXT
,

40 
	mRUN_TYPE_LF_EXT
,

41 
	mRUN_TYPE_U_EXT2
,

42 
	mRUN_TYPE_L_EXT2
,

43 
	mRUN_TYPE_U_EXT3
,

51 
	$Ãe_ˇ£_c⁄v
(
uöt32_t
 *
ªs
, uöt32_à
c
, 
c⁄v_ty≥
)

53 i‡(
c
 < 128) {

54 i‡(
c⁄v_ty≥
) {

55 i‡(
c
 >= 'A' && c <= 'Z') {

56 
c
 = c - 'A' + 'a';

59 i‡(
c
 >= 'a' && c <= 'z') {

60 
c
 = c - 'a' + 'A';

64 
uöt32_t
 
v
, 
code
, 
d©a
, 
ty≥
, 
Àn
, 
a
, 
is_lowî
;

65 
idx
, 
idx_mö
, 
idx_max
;

67 
is_lowî
 = (
c⁄v_ty≥
 != 0);

68 
idx_mö
 = 0;

69 
idx_max
 = 
	`cou¡of
(
ˇ£_c⁄v_èbÀ1
) - 1;

70 
idx_mö
 <
idx_max
) {

71 
idx
 = ()(
idx_max
 + 
idx_mö
) / 2;

72 
v
 = 
ˇ£_c⁄v_èbÀ1
[
idx
];

73 
code
 = 
v
 >> (32 - 17);

74 
Àn
 = (
v
 >> (32 - 17 - 7)) & 0x7f;

75 i‡(
c
 < 
code
) {

76 
idx_max
 = 
idx
 - 1;

77 } i‡(
c
 >
code
 + 
Àn
) {

78 
idx_mö
 = 
idx
 + 1;

80 
ty≥
 = (
v
 >> (32 - 17 - 7 - 4)) & 0xf;

81 
d©a
 = ((
v
 & 0xfË<< 8Ë| 
ˇ£_c⁄v_èbÀ2
[
idx
];

82 
ty≥
) {

83 
RUN_TYPE_U
:

84 
RUN_TYPE_L
:

85 
RUN_TYPE_UF
:

86 
RUN_TYPE_LF
:

87 i‡(
c⁄v_ty≥
 =(
ty≥
 & 1) ||

88 (
ty≥
 >
RUN_TYPE_UF
 && 
c⁄v_ty≥
 == 2)) {

89 
c
 = c - 
code
 + (
ˇ£_c⁄v_èbÀ1
[
d©a
] >> (32 - 17));

92 
RUN_TYPE_UL
:

93 
a
 = 
c
 - 
code
;

94 i‡((
a
 & 1Ë!(1 - 
is_lowî
))

96 
c
 = (
a
 ^ 1Ë+ 
code
;

98 
RUN_TYPE_LSU
:

99 
a
 = 
c
 - 
code
;

100 i‡(
a
 == 1) {

101 
c
 +2 * 
is_lowî
 - 1;

102 } i‡(
a
 =(1 - 
is_lowî
) * 2) {

103 
c
 +(2 * 
is_lowî
 - 1) * 2;

106 
RUN_TYPE_U2L_399_EXT2
:

107 i‡(!
is_lowî
) {

108 
ªs
[0] = 
c
 - 
code
 + 
ˇ£_c⁄v_ext
[
d©a
 >> 6];

109 
ªs
[1] = 0x399;

112 
c
 = c - 
code
 + 
ˇ£_c⁄v_ext
[
d©a
 & 0x3f];

115 
RUN_TYPE_UF_D20
:

116 i‡(
c⁄v_ty≥
 == 1)

118 
c
 = 
d©a
 + (
c⁄v_ty≥
 == 2) * 0x20;

120 
RUN_TYPE_UF_D1_EXT
:

121 i‡(
c⁄v_ty≥
 == 1)

123 
c
 = 
ˇ£_c⁄v_ext
[
d©a
] + (
c⁄v_ty≥
 == 2);

125 
RUN_TYPE_U_EXT
:

126 
RUN_TYPE_LF_EXT
:

127 i‡(
is_lowî
 !(
ty≥
 - 
RUN_TYPE_U_EXT
))

129 
c
 = 
ˇ£_c⁄v_ext
[
d©a
];

131 
RUN_TYPE_U_EXT2
:

132 
RUN_TYPE_L_EXT2
:

133 i‡(
c⁄v_ty≥
 !(
ty≥
 - 
RUN_TYPE_U_EXT2
))

135 
ªs
[0] = 
c
 - 
code
 + 
ˇ£_c⁄v_ext
[
d©a
 >> 6];

136 
ªs
[1] = 
ˇ£_c⁄v_ext
[
d©a
 & 0x3f];

139 
RUN_TYPE_U_EXT3
:

140 i‡(
c⁄v_ty≥
 != 0)

142 
ªs
[0] = 
ˇ£_c⁄v_ext
[
d©a
 >> 8];

143 
ªs
[1] = 
ˇ£_c⁄v_ext
[(
d©a
 >> 4) & 0xf];

144 
ªs
[2] = 
ˇ£_c⁄v_ext
[
d©a
 & 0xf];

151 
ªs
[0] = 
c
;

153 
	}
}

155 
uöt32_t
 
	$gë_À24
(c⁄° 
uöt8_t
 *
±r
)

157 #i‡
	`deföed
(
__x86__
Ë|| deföed(
__x86_64__
)

158  *(
uöt16_t
 *)
±r
 | (ptr[2] << 16);

160  
±r
[0] | (ptr[1] << 8) | (ptr[2] << 16);

162 
	}
}

164 
	#UNICODE_INDEX_BLOCK_LEN
 32

	)

167 
	$gë_ödex_pos
(
uöt32_t
 *
pcode
, uöt32_à
c
,

168 c⁄° 
uöt8_t
 *
ödex_èbÀ
, 
ödex_èbÀ_Àn
)

170 
uöt32_t
 
code
, 
v
;

171 
idx_mö
, 
idx_max
, 
idx
;

173 
idx_mö
 = 0;

174 
v
 = 
	`gë_À24
(
ödex_èbÀ
);

175 
code
 = 
v
 & ((1 << 21) - 1);

176 i‡(
c
 < 
code
) {

177 *
pcode
 = 0;

180 
idx_max
 = 
ödex_èbÀ_Àn
 - 1;

181 
code
 = 
	`gë_À24
(
ödex_èbÀ
 + 
idx_max
 * 3);

182 i‡(
c
 >
code
)

185 (
idx_max
 - 
idx_mö
) > 1) {

186 
idx
 = (
idx_max
 + 
idx_mö
) / 2;

187 
v
 = 
	`gë_À24
(
ödex_èbÀ
 + 
idx
 * 3);

188 
code
 = 
v
 & ((1 << 21) - 1);

189 i‡(
c
 < 
code
) {

190 
idx_max
 = 
idx
;

192 
idx_mö
 = 
idx
;

195 
v
 = 
	`gë_À24
(
ödex_èbÀ
 + 
idx_mö
 * 3);

196 *
pcode
 = 
v
 & ((1 << 21) - 1);

197  (
idx_mö
 + 1Ë* 
UNICODE_INDEX_BLOCK_LEN
 + (
v
 >> 21);

198 
	}
}

200 
BOOL
 
	$Ãe_is_ö_èbÀ
(
uöt32_t
 
c
, c⁄° 
uöt8_t
 *
èbÀ
,

201 c⁄° 
uöt8_t
 *
ödex_èbÀ
, 
ödex_èbÀ_Àn
)

203 
uöt32_t
 
code
, 
b
, 
bô
;

204 
pos
;

205 c⁄° 
uöt8_t
 *
p
;

207 
pos
 = 
	`gë_ödex_pos
(&
code
, 
c
, 
ödex_èbÀ
, 
ödex_èbÀ_Àn
);

208 i‡(
pos
 < 0)

209  
FALSE
;

210 
p
 = 
èbÀ
 + 
pos
;

211 
bô
 = 0;

213 
b
 = *
p
++;

214 i‡(
b
 < 64) {

215 
code
 +(
b
 >> 3) + 1;

216 i‡(
c
 < 
code
)

217  
bô
;

218 
bô
 ^= 1;

219 
code
 +(
b
 & 7) + 1;

220 } i‡(
b
 >= 0x80) {

221 
code
 +
b
 - 0x80 + 1;

222 } i‡(
b
 < 0x60) {

223 
code
 +(((
b
 - 0x40Ë<< 8Ë| 
p
[0]) + 1;

224 
p
++;

226 
code
 +(((
b
 - 0x60Ë<< 16Ë| (
p
[0] << 8) |Ö[1]) + 1;

227 
p
 += 2;

229 i‡(
c
 < 
code
)

230  
bô
;

231 
bô
 ^= 1;

233 
	}
}

235 
BOOL
 
	$Ãe_is_ˇ£d
(
uöt32_t
 
c
)

237 
uöt32_t
 
v
, 
code
, 
Àn
;

238 
idx
, 
idx_mö
, 
idx_max
;

240 
idx_mö
 = 0;

241 
idx_max
 = 
	`cou¡of
(
ˇ£_c⁄v_èbÀ1
) - 1;

242 
idx_mö
 <
idx_max
) {

243 
idx
 = ()(
idx_max
 + 
idx_mö
) / 2;

244 
v
 = 
ˇ£_c⁄v_èbÀ1
[
idx
];

245 
code
 = 
v
 >> (32 - 17);

246 
Àn
 = (
v
 >> (32 - 17 - 7)) & 0x7f;

247 i‡(
c
 < 
code
) {

248 
idx_max
 = 
idx
 - 1;

249 } i‡(
c
 >
code
 + 
Àn
) {

250 
idx_mö
 = 
idx
 + 1;

252  
TRUE
;

255  
	`Ãe_is_ö_èbÀ
(
c
, 
unicode_¥›_Ca£d1_èbÀ
,

256 
unicode_¥›_Ca£d1_ödex
,

257 (
unicode_¥›_Ca£d1_ödex
) / 3);

258 
	}
}

260 
BOOL
 
	$Ãe_is_ˇ£_ign‹abÀ
(
uöt32_t
 
c
)

262  
	`Ãe_is_ö_èbÀ
(
c
, 
unicode_¥›_Ca£_Ign‹abÀ_èbÀ
,

263 
unicode_¥›_Ca£_Ign‹abÀ_ödex
,

264 (
unicode_¥›_Ca£_Ign‹abÀ_ödex
) / 3);

265 
	}
}

269 
__maybe_unu£d
 
	$¸_dump
(
Ch¨R™ge
 *
¸
)

271 
i
;

272 
i
 = 0; i < 
¸
->
Àn
; i++)

273 
	`¥ötf
("%d: 0x%04x\n", 
i
, 
¸
->
poöts
[i]);

274 
	}
}

276 *
	$¸_deÁu…_ªÆloc
(*
›aque
, *
±r
, 
size_t
 
size
)

278  
	`ªÆloc
(
±r
, 
size
);

279 
	}
}

281 
	$¸_öô
(
Ch¨R™ge
 *
¸
, *
mem_›aque
, 
DynBufRóŒocFunc
 *
ªÆloc_func
)

283 
¸
->
Àn
 = cr->
size
 = 0;

284 
¸
->
poöts
 = 
NULL
;

285 
¸
->
mem_›aque
 = mem_opaque;

286 
¸
->
ªÆloc_func
 =ÑóŒoc_fun¯?ÑóŒoc_fun¯: 
¸_deÁu…_ªÆloc
;

287 
	}
}

289 
	$¸_‰ì
(
Ch¨R™ge
 *
¸
)

291 
¸
->
	`ªÆloc_func
(¸->
mem_›aque
, cr->
poöts
, 0);

292 
	}
}

294 
	$¸_ªÆloc
(
Ch¨R™ge
 *
¸
, 
size
)

296 
√w_size
;

297 
uöt32_t
 *
√w_buf
;

299 i‡(
size
 > 
¸
->size) {

300 
√w_size
 = 
	`max_öt
(
size
, 
¸
->size * 3 / 2);

301 
√w_buf
 = 
¸
->
	`ªÆloc_func
(¸->
mem_›aque
, cr->
poöts
,

302 
√w_size
 * (
¸
->
poöts
[0]));

303 i‡(!
√w_buf
)

305 
¸
->
poöts
 = 
√w_buf
;

306 
¸
->
size
 = 
√w_size
;

309 
	}
}

311 
	$¸_c›y
(
Ch¨R™ge
 *
¸
, c⁄° Ch¨R™gê*
¸1
)

313 i‡(
	`¸_ªÆloc
(
¸
, 
¸1
->
Àn
))

315 
	`mem˝y
(
¸
->
poöts
, 
¸1
->poöts, (¸->poöts[0]Ë* cr1->
Àn
);

316 
¸
->
Àn
 = 
¸1
->len;

318 
	}
}

321 
	$¸_com¥ess
(
Ch¨R™ge
 *
¸
)

323 
i
, 
j
, 
k
, 
Àn
;

324 
uöt32_t
 *
±
;

326 
±
 = 
¸
->
poöts
;

327 
Àn
 = 
¸
->len;

328 
i
 = 0;

329 
j
 = 0;

330 
k
 = 0;

331 (
i
 + 1Ë< 
Àn
) {

332 i‡(
±
[
i
] ==Öt[i + 1]) {

334 
i
 += 2;

336 
j
 = 
i
;

337 (
j
 + 3Ë< 
Àn
 && 
±
[j + 1] ==Öt[j + 2])

338 
j
 += 2;

340 
±
[
k
] =Öt[
i
];

341 
±
[
k
 + 1] =Öt[
j
 + 1];

342 
k
 += 2;

343 
i
 = 
j
 + 2;

346 
¸
->
Àn
 = 
k
;

347 
	}
}

350 
	$¸_›
(
Ch¨R™ge
 *
¸
, c⁄° 
uöt32_t
 *
a_±
, 
a_Àn
,

351 c⁄° 
uöt32_t
 *
b_±
, 
b_Àn
, 
›
)

353 
a_idx
, 
b_idx
, 
is_ö
;

354 
uöt32_t
 
v
;

356 
a_idx
 = 0;

357 
b_idx
 = 0;

360 i‡(
a_idx
 < 
a_Àn
 && 
b_idx
 < 
b_Àn
) {

361 i‡(
a_±
[
a_idx
] < 
b_±
[
b_idx
]) {

362 
a_add
;

363 } i‡(
a_±
[
a_idx
] =
b_±
[
b_idx
]) {

364 
v
 = 
a_±
[
a_idx
];

365 
a_idx
++;

366 
b_idx
++;

368 
b_add
;

370 } i‡(
a_idx
 < 
a_Àn
) {

371 
a_add
:

372 
v
 = 
a_±
[
a_idx
++];

373 } i‡(
b_idx
 < 
b_Àn
) {

374 
b_add
:

375 
v
 = 
b_±
[
b_idx
++];

380 
›
) {

381 
CR_OP_UNION
:

382 
is_ö
 = (
a_idx
 & 1Ë| (
b_idx
 & 1);

384 
CR_OP_INTER
:

385 
is_ö
 = (
a_idx
 & 1Ë& (
b_idx
 & 1);

387 
CR_OP_XOR
:

388 
is_ö
 = (
a_idx
 & 1Ë^ (
b_idx
 & 1);

391 
	`ab‹t
();

393 i‡(
is_ö
 !(
¸
->
Àn
 & 1)) {

394 i‡(
	`¸_add_poöt
(
¸
, 
v
))

398 
	`¸_com¥ess
(
¸
);

400 
	}
}

402 
	$¸_uni⁄1
(
Ch¨R™ge
 *
¸
, c⁄° 
uöt32_t
 *
b_±
, 
b_Àn
)

404 
Ch¨R™ge
 
a
 = *
¸
;

405 
ªt
;

406 
¸
->
Àn
 = 0;

407 
¸
->
size
 = 0;

408 
¸
->
poöts
 = 
NULL
;

409 
ªt
 = 
	`¸_›
(
¸
, 
a
.
poöts
,á.
Àn
, 
b_±
, 
b_Àn
, 
CR_OP_UNION
);

410 
	`¸_‰ì
(&
a
);

411  
ªt
;

412 
	}
}

414 
	$¸_övît
(
Ch¨R™ge
 *
¸
)

416 
Àn
;

417 
Àn
 = 
¸
->len;

418 i‡(
	`¸_ªÆloc
(
¸
, 
Àn
 + 2))

420 
	`memmove
(
¸
->
poöts
 + 1, cr->poöts, 
Àn
 * (cr->points[0]));

421 
¸
->
poöts
[0] = 0;

422 
¸
->
poöts
[
Àn
 + 1] = 
UINT32_MAX
;

423 
¸
->
Àn
 =Üen + 2;

424 
	`¸_com¥ess
(
¸
);

426 
	}
}

428 #ifde‡
CONFIG_ALL_UNICODE


430 
BOOL
 
	$Ãe_is_id_°¨t
(
uöt32_t
 
c
)

432  
	`Ãe_is_ö_èbÀ
(
c
, 
unicode_¥›_ID_Sèπ_èbÀ
,

433 
unicode_¥›_ID_Sèπ_ödex
,

434 (
unicode_¥›_ID_Sèπ_ödex
) / 3);

435 
	}
}

437 
BOOL
 
	$Ãe_is_id_c⁄töue
(
uöt32_t
 
c
)

439  
	`Ãe_is_id_°¨t
(
c
) ||

440 
	`Ãe_is_ö_èbÀ
(
c
, 
unicode_¥›_ID_C⁄töue1_èbÀ
,

441 
unicode_¥›_ID_C⁄töue1_ödex
,

442 (
unicode_¥›_ID_C⁄töue1_ödex
) / 3);

443 
	}
}

445 
	#UNICODE_DECOMP_LEN_MAX
 18

	)

448 
	mDECOMP_TYPE_C1
,

449 
	mDECOMP_TYPE_L1
,

450 
	mDECOMP_TYPE_L2
,

451 
	mDECOMP_TYPE_L3
,

452 
	mDECOMP_TYPE_L4
,

453 
	mDECOMP_TYPE_L5
,

454 
	mDECOMP_TYPE_L6
,

455 
	mDECOMP_TYPE_L7
,

456 
	mDECOMP_TYPE_LL1
,

457 
	mDECOMP_TYPE_LL2
,

458 
	mDECOMP_TYPE_S1
,

459 
	mDECOMP_TYPE_S2
,

460 
	mDECOMP_TYPE_S3
,

461 
	mDECOMP_TYPE_S4
,

462 
	mDECOMP_TYPE_S5
,

463 
	mDECOMP_TYPE_I1
,

464 
	mDECOMP_TYPE_I2_0
,

465 
	mDECOMP_TYPE_I2_1
,

466 
	mDECOMP_TYPE_I3_1
,

467 
	mDECOMP_TYPE_I3_2
,

468 
	mDECOMP_TYPE_I4_1
,

469 
	mDECOMP_TYPE_I4_2
,

470 
	mDECOMP_TYPE_B1
,

471 
	mDECOMP_TYPE_B2
,

472 
	mDECOMP_TYPE_B3
,

473 
	mDECOMP_TYPE_B4
,

474 
	mDECOMP_TYPE_B5
,

475 
	mDECOMP_TYPE_B6
,

476 
	mDECOMP_TYPE_B7
,

477 
	mDECOMP_TYPE_B8
,

478 
	mDECOMP_TYPE_B18
,

479 
	mDECOMP_TYPE_LS2
,

480 
	mDECOMP_TYPE_PAT3
,

481 
	mDECOMP_TYPE_S2_UL
,

482 
	mDECOMP_TYPE_LS2_UL
,

483 } 
	tDecompTy≥Enum
;

485 
uöt32_t
 
	$unicode_gë_sh‹t_code
(
uöt32_t
 
c
)

487 c⁄° 
uöt16_t
 
unicode_sh‹t_èbÀ
[2] = { 0x2044, 0x2215 };

489 i‡(
c
 < 0x80)

490  
c
;

491 i‡(
c
 < 0x80 + 0x50)

492  
c
 - 0x80 + 0x300;

494  
unicode_sh‹t_èbÀ
[
c
 - 0x80 - 0x50];

495 
	}
}

497 
uöt32_t
 
	$unicode_gë_lowî_sim∂e
(
uöt32_t
 
c
)

499 i‡(
c
 < 0x100 || (c >= 0x410 && c <= 0x42f))

500 
c
 += 0x20;

502 
c
++;

503  
c
;

504 
	}
}

506 
uöt16_t
 
	$unicode_gë16
(c⁄° 
uöt8_t
 *
p
)

508  
p
[0] | (p[1] << 8);

509 
	}
}

511 
	$unicode_decomp_íåy
(
uöt32_t
 *
ªs
, uöt32_à
c
,

512 
idx
, 
uöt32_t
 
code
, uöt32_à
Àn
,

513 
uöt32_t
 
ty≥
)

515 
uöt32_t
 
c1
;

516 
l
, 
i
, 
p
;

517 c⁄° 
uöt8_t
 *
d
;

519 i‡(
ty≥
 =
DECOMP_TYPE_C1
) {

520 
ªs
[0] = 
unicode_decomp_èbÀ2
[
idx
];

523 
d
 = 
unicode_decomp_d©a
 + 
unicode_decomp_èbÀ2
[
idx
];

524 
ty≥
) {

525 
DECOMP_TYPE_L1
 ... 
DECOMP_TYPE_L7
:

526 
l
 = 
ty≥
 - 
DECOMP_TYPE_L1
 + 1;

527 
d
 +(
c
 - 
code
Ë* 
l
 * 2;

528 
i
 = 0; i < 
l
; i++) {

529 i‡((
ªs
[
i
] = 
	`unicode_gë16
(
d
 + 2 * i)) == 0)

532  
l
;

533 
DECOMP_TYPE_LL1
 ... 
DECOMP_TYPE_LL2
:

535 
uöt32_t
 
k
, 
p
;

536 
l
 = 
ty≥
 - 
DECOMP_TYPE_LL1
 + 1;

537 
k
 = (
c
 - 
code
Ë* 
l
;

538 
p
 = 
Àn
 * 
l
 * 2;

539 
i
 = 0; i < 
l
; i++) {

540 
c1
 = 
	`unicode_gë16
(
d
 + 2 * 
k
) |

541 (((
d
[
p
 + (
k
 / 4)] >> ((k % 4) * 2)) & 3) << 16);

542 i‡(!
c1
)

544 
ªs
[
i
] = 
c1
;

545 
k
++;

548  
l
;

549 
DECOMP_TYPE_S1
 ... 
DECOMP_TYPE_S5
:

550 
l
 = 
ty≥
 - 
DECOMP_TYPE_S1
 + 1;

551 
d
 +(
c
 - 
code
Ë* 
l
;

552 
i
 = 0; i < 
l
; i++) {

553 i‡((
ªs
[
i
] = 
	`unicode_gë_sh‹t_code
(
d
[i])) == 0)

556  
l
;

557 
DECOMP_TYPE_I1
:

558 
l
 = 1;

559 
p
 = 0;

560 
decomp_ty≥_i
;

561 
DECOMP_TYPE_I2_0
:

562 
DECOMP_TYPE_I2_1
:

563 
DECOMP_TYPE_I3_1
:

564 
DECOMP_TYPE_I3_2
:

565 
DECOMP_TYPE_I4_1
:

566 
DECOMP_TYPE_I4_2
:

567 
l
 = 2 + ((
ty≥
 - 
DECOMP_TYPE_I2_0
) >> 1);

568 
p
 = ((
ty≥
 - 
DECOMP_TYPE_I2_0
Ë& 1Ë+ (
l
 > 2);

569 
decomp_ty≥_i
:

570 
i
 = 0; i < 
l
; i++) {

571 
c1
 = 
	`unicode_gë16
(
d
 + 2 * 
i
);

572 i‡(
i
 =
p
)

573 
c1
 +
c
 - 
code
;

574 
ªs
[
i
] = 
c1
;

576  
l
;

577 
DECOMP_TYPE_B18
:

578 
l
 = 18;

579 
decomp_ty≥_b
;

580 
DECOMP_TYPE_B1
 ... 
DECOMP_TYPE_B8
:

581 
l
 = 
ty≥
 - 
DECOMP_TYPE_B1
 + 1;

582 
decomp_ty≥_b
:

584 
uöt32_t
 
c_mö
;

585 
c_mö
 = 
	`unicode_gë16
(
d
);

586 
d
 +2 + (
c
 - 
code
Ë* 
l
;

587 
i
 = 0; i < 
l
; i++) {

588 
c1
 = 
d
[
i
];

589 i‡(
c1
 == 0xff)

590 
c1
 = 0x20;

592 
c1
 +
c_mö
;

593 
ªs
[
i
] = 
c1
;

596  
l
;

597 
DECOMP_TYPE_LS2
:

598 
d
 +(
c
 - 
code
) * 3;

599 i‡(!(
ªs
[0] = 
	`unicode_gë16
(
d
)))

601 
ªs
[1] = 
	`unicode_gë_sh‹t_code
(
d
[2]);

603 
DECOMP_TYPE_PAT3
:

604 
ªs
[0] = 
	`unicode_gë16
(
d
);

605 
ªs
[2] = 
	`unicode_gë16
(
d
 + 2);

606 
d
 +4 + (
c
 - 
code
) * 2;

607 
ªs
[1] = 
	`unicode_gë16
(
d
);

609 
DECOMP_TYPE_S2_UL
:

610 
DECOMP_TYPE_LS2_UL
:

611 
c1
 = 
c
 - 
code
;

612 i‡(
ty≥
 =
DECOMP_TYPE_S2_UL
) {

613 
d
 +
c1
 & ~1;

614 
c
 = 
	`unicode_gë_sh‹t_code
(*
d
);

615 
d
++;

617 
d
 +(
c1
 >> 1) * 3;

618 
c
 = 
	`unicode_gë16
(
d
);

619 
d
 += 2;

621 i‡(
c1
 & 1)

622 
c
 = 
	`unicode_gë_lowî_sim∂e
(c);

623 
ªs
[0] = 
c
;

624 
ªs
[1] = 
	`unicode_gë_sh‹t_code
(*
d
);

629 
	}
}

634 
	$unicode_decomp_ch¨
(
uöt32_t
 *
ªs
, uöt32_à
c
, 
BOOL
 
is_com∑t1
)

636 
uöt32_t
 
v
, 
ty≥
, 
is_com∑t
, 
code
, 
Àn
;

637 
idx_mö
, 
idx_max
, 
idx
;

639 
idx_mö
 = 0;

640 
idx_max
 = 
	`cou¡of
(
unicode_decomp_èbÀ1
) - 1;

641 
idx_mö
 <
idx_max
) {

642 
idx
 = (
idx_max
 + 
idx_mö
) / 2;

643 
v
 = 
unicode_decomp_èbÀ1
[
idx
];

644 
code
 = 
v
 >> (32 - 18);

645 
Àn
 = (
v
 >> (32 - 18 - 7)) & 0x7f;

647 i‡(
c
 < 
code
) {

648 
idx_max
 = 
idx
 - 1;

649 } i‡(
c
 >
code
 + 
Àn
) {

650 
idx_mö
 = 
idx
 + 1;

652 
is_com∑t
 = 
v
 & 1;

653 i‡(
is_com∑t1
 < 
is_com∑t
)

655 
ty≥
 = (
v
 >> (32 - 18 - 7 - 6)) & 0x3f;

656  
	`unicode_decomp_íåy
(
ªs
, 
c
, 
idx
, 
code
, 
Àn
, 
ty≥
);

660 
	}
}

663 
	$unicode_compo£_∑ú
(
uöt32_t
 
c0
, uöt32_à
c1
)

665 
uöt32_t
 
code
, 
Àn
, 
ty≥
, 
v
, 
idx1
, 
d_idx
, 
d_off£t
, 
ch
;

666 
idx_mö
, 
idx_max
, 
idx
, 
d
;

667 
uöt32_t
 
∑ú
[2];

669 
idx_mö
 = 0;

670 
idx_max
 = 
	`cou¡of
(
unicode_comp_èbÀ
) - 1;

671 
idx_mö
 <
idx_max
) {

672 
idx
 = (
idx_max
 + 
idx_mö
) / 2;

673 
idx1
 = 
unicode_comp_èbÀ
[
idx
];

676 
d_idx
 = 
idx1
 >> 6;

677 
d_off£t
 = 
idx1
 & 0x3f;

678 
v
 = 
unicode_decomp_èbÀ1
[
d_idx
];

679 
code
 = 
v
 >> (32 - 18);

680 
Àn
 = (
v
 >> (32 - 18 - 7)) & 0x7f;

681 
ty≥
 = (
v
 >> (32 - 18 - 7 - 6)) & 0x3f;

682 
ch
 = 
code
 + 
d_off£t
;

683 
	`unicode_decomp_íåy
(
∑ú
, 
ch
, 
d_idx
, 
code
, 
Àn
, 
ty≥
);

684 
d
 = 
c0
 - 
∑ú
[0];

685 i‡(
d
 == 0)

686 
d
 = 
c1
 - 
∑ú
[1];

687 i‡(
d
 < 0) {

688 
idx_max
 = 
idx
 - 1;

689 } i‡(
d
 > 0) {

690 
idx_mö
 = 
idx
 + 1;

692  
ch
;

696 
	}
}

699 
	$unicode_gë_cc
(
uöt32_t
 
c
)

701 
uöt32_t
 
code
, 
n
, 
ty≥
, 
cc
, 
c1
, 
b
;

702 
pos
;

703 c⁄° 
uöt8_t
 *
p
;

705 
pos
 = 
	`gë_ödex_pos
(&
code
, 
c
,

706 
unicode_cc_ödex
, (unicode_cc_index) / 3);

707 i‡(
pos
 < 0)

709 
p
 = 
unicode_cc_èbÀ
 + 
pos
;

711 
b
 = *
p
++;

712 
ty≥
 = 
b
 >> 6;

713 
n
 = 
b
 & 0x3f;

714 i‡(
n
 < 48) {

715 } i‡(
n
 < 56) {

716 
n
 = (n - 48) << 8;

717 
n
 |*
p
++;

718 
n
 += 48;

720 
n
 = (n - 56) << 8;

721 
n
 |*
p
++ << 8;

722 
n
 |*
p
++;

723 
n
 += 48 + (1 << 11);

725 i‡(
ty≥
 <= 1)

726 
p
++;

727 
c1
 = 
code
 + 
n
 + 1;

728 i‡(
c
 < 
c1
) {

729 
ty≥
) {

731 
cc
 = 
p
[-1];

734 
cc
 = 
p
[-1] + 
c
 - 
code
;

737 
cc
 = 0;

741 
cc
 = 230;

744  
cc
;

746 
code
 = 
c1
;

748 
	}
}

750 
	$s‹t_cc
(*
buf
, 
Àn
)

752 
i
, 
j
, 
k
, 
cc
, 
cc1
, 
°¨t
, 
ch1
;

754 
i
 = 0; i < 
Àn
; i++) {

755 
cc
 = 
	`unicode_gë_cc
(
buf
[
i
]);

756 i‡(
cc
 != 0) {

757 
°¨t
 = 
i
;

758 
j
 = 
i
 + 1;

759 
j
 < 
Àn
) {

760 
ch1
 = 
buf
[
j
];

761 
cc1
 = 
	`unicode_gë_cc
(
ch1
);

762 i‡(
cc1
 == 0)

764 
k
 = 
j
 - 1;

765 
k
 >
°¨t
) {

766 i‡(
	`unicode_gë_cc
(
buf
[
k
]Ë<
cc1
)

768 
buf
[
k
 + 1] = buf[k];

769 
k
--;

771 
buf
[
k
 + 1] = 
ch1
;

772 
j
++;

775 
	`¥ötf
("cc:");

776 
k
 = 
°¨t
; k < 
j
; k++) {

777 
	`¥ötf
(" %3d", 
	`unicode_gë_cc
(
buf
[
k
]));

779 
	`¥ötf
("\n");

781 
i
 = 
j
;

784 
	}
}

786 
	$to_nfd_ªc
(
DynBuf
 *
dbuf
,

787 c⁄° *
§c
, 
§c_Àn
, 
is_com∑t
)

789 
uöt32_t
 
c
, 
v
;

790 
i
, 
l
;

791 
uöt32_t
 
ªs
[
UNICODE_DECOMP_LEN_MAX
];

793 
i
 = 0; i < 
§c_Àn
; i++) {

794 
c
 = 
§c
[
i
];

795 i‡(
c
 >= 0xac00 && c < 0xd7a4) {

797 
c
 -= 0xac00;

798 
	`dbuf_put_u32
(
dbuf
, 0x1100 + 
c
 / 588);

799 
	`dbuf_put_u32
(
dbuf
, 0x1161 + (
c
 % 588) / 28);

800 
v
 = 
c
 % 28;

801 i‡(
v
 != 0)

802 
	`dbuf_put_u32
(
dbuf
, 0x11a7 + 
v
);

804 
l
 = 
	`unicode_decomp_ch¨
(
ªs
, 
c
, 
is_com∑t
);

805 i‡(
l
) {

806 
	`to_nfd_ªc
(
dbuf
, (*)
ªs
, 
l
, 
is_com∑t
);

808 
	`dbuf_put_u32
(
dbuf
, 
c
);

812 
	}
}

815 
	$compo£_∑ú
(
uöt32_t
 
c0
, uöt32_à
c1
)

818 i‡(
c0
 >= 0x1100 && c0 < 0x1100 + 19 &&

819 
c1
 >= 0x1161 && c1 < 0x1161 + 21) {

820  0xac00 + (
c0
 - 0x1100Ë* 588 + (
c1
 - 0x1161) * 28;

821 } i‡(
c0
 >= 0xac00 && c0 < 0xac00 + 11172 &&

822 (
c0
 - 0xac00) % 28 == 0 &&

823 
c1
 >= 0x11a7 && c1 < 0x11a7 + 28) {

824  
c0
 + 
c1
 - 0x11a7;

826  
	`unicode_compo£_∑ú
(
c0
, 
c1
);

828 
	}
}

830 
	$unicode_n‹mÆize
(
uöt32_t
 **
pd°
, c⁄° uöt32_à*
§c
, 
§c_Àn
,

831 
UnicodeN‹mÆiz©i⁄Enum
 
n_ty≥
,

832 *
›aque
, 
DynBufRóŒocFunc
 *
ªÆloc_func
)

834 *
buf
, 
buf_Àn
, 
i
, 
p
, 
°¨ãr_pos
, 
cc
, 
œ°_cc
, 
out_Àn
;

835 
BOOL
 
is_com∑t
;

836 
DynBuf
 
dbuf_s
, *
dbuf
 = &dbuf_s;

838 
is_com∑t
 = 
n_ty≥
 >> 1;

840 
	`dbuf_öô2
(
dbuf
, 
›aque
, 
ªÆloc_func
);

841 i‡(
	`dbuf_ªÆloc
(
dbuf
, (Ë* 
§c_Àn
))

842 
Áû
;

845 i‡(
n_ty≥
 =
UNICODE_NFC
) {

846 
i
 = 0; i < 
§c_Àn
; i++) {

847 i‡(
§c
[
i
] >= 0x100)

848 
nŸ_œtö1
;

850 
buf
 = (*)
dbuf
->buf;

851 
	`mem˝y
(
buf
, 
§c
, 
§c_Àn
 * ());

852 *
pd°
 = (
uöt32_t
 *)
buf
;

853  
§c_Àn
;

854 
nŸ_œtö1
: ;

857 
	`to_nfd_ªc
(
dbuf
, (c⁄° *)
§c
, 
§c_Àn
, 
is_com∑t
);

858 i‡(
	`dbuf_îr‹
(
dbuf
)) {

859 
Áû
:

860 *
pd°
 = 
NULL
;

863 
buf
 = (*)
dbuf
->buf;

864 
buf_Àn
 = 
dbuf
->
size
 / ();

866 
	`s‹t_cc
(
buf
, 
buf_Àn
);

868 i‡(
buf_Àn
 <1 || (
n_ty≥
 & 1) != 0) {

870 *
pd°
 = (
uöt32_t
 *)
buf
;

871  
buf_Àn
;

874 
i
 = 1;

875 
out_Àn
 = 1;

876 
i
 < 
buf_Àn
) {

879 
œ°_cc
 = 
	`unicode_gë_cc
(
buf
[
i
]);

880 
°¨ãr_pos
 = 
out_Àn
 - 1;

881 
°¨ãr_pos
 >= 0) {

882 
cc
 = 
	`unicode_gë_cc
(
buf
[
°¨ãr_pos
]);

883 i‡(
cc
 == 0)

885 i‡(
cc
 >
œ°_cc
)

886 
√xt
;

887 
œ°_cc
 = 256;

888 
°¨ãr_pos
--;

890 i‡(
°¨ãr_pos
 >= 0 &&

891 (
p
 = 
	`compo£_∑ú
(
buf
[
°¨ãr_pos
], buf[
i
])) != 0) {

892 
buf
[
°¨ãr_pos
] = 
p
;

893 
i
++;

895 
√xt
:

896 
buf
[
out_Àn
++] = buf[
i
++];

899 *
pd°
 = (
uöt32_t
 *)
buf
;

900  
out_Àn
;

901 
	}
}

905 
	$unicode_föd_«me
(c⁄° *
«me_èbÀ
, c⁄° *
«me
)

907 c⁄° *
p
, *
r
;

908 
pos
;

909 
size_t
 
«me_Àn
, 
Àn
;

911 
p
 = 
«me_èbÀ
;

912 
pos
 = 0;

913 
«me_Àn
 = 
	`°æí
(
«me
);

914 *
p
) {

916 
r
 = 
	`°rchr
(
p
, ',');

917 i‡(!
r
)

918 
Àn
 = 
	`°æí
(
p
);

920 
Àn
 = 
r
 - 
p
;

921 i‡(
Àn
 =
«me_Àn
 && !
	`memcmp
(
p
, 
«me
,Çame_len))

922  
pos
;

923 
p
 +
Àn
 + 1;

924 i‡(!
r
)

927 
pos
++;

930 
	}
}

934 
	$unicode_s¸ùt
(
Ch¨R™ge
 *
¸
,

935 c⁄° *
s¸ùt_«me
, 
BOOL
 
is_ext
)

937 
s¸ùt_idx
;

938 c⁄° 
uöt8_t
 *
p
, *
p_íd
;

939 
uöt32_t
 
c
, 
c1
, 
b
, 
n
, 
v
, 
v_Àn
, 
i
, 
ty≥
;

940 
Ch¨R™ge
 
¸1_s
, *
¸1
;

941 
Ch¨R™ge
 
¸2_s
, *
¸2
 = &cr2_s;

942 
BOOL
 
is_comm⁄
;

944 
s¸ùt_idx
 = 
	`unicode_föd_«me
(
unicode_s¸ùt_«me_èbÀ
, 
s¸ùt_«me
);

945 i‡(
s¸ùt_idx
 < 0)

948 
s¸ùt_idx
 +
UNICODE_SCRIPT_Unknown
 + 1;

950 
is_comm⁄
 = (
s¸ùt_idx
 =
UNICODE_SCRIPT_Comm⁄
 ||

951 
s¸ùt_idx
 =
UNICODE_SCRIPT_Inhîôed
);

952 i‡(
is_ext
) {

953 
¸1
 = &
¸1_s
;

954 
	`¸_öô
(
¸1
, 
¸
->
mem_›aque
, cr->
ªÆloc_func
);

955 
	`¸_öô
(
¸2
, 
¸
->
mem_›aque
, cr->
ªÆloc_func
);

957 
¸1
 = 
¸
;

960 
p
 = 
unicode_s¸ùt_èbÀ
;

961 
p_íd
 = 
unicode_s¸ùt_èbÀ
 + 
	`cou¡of
(unicode_script_table);

962 
c
 = 0;

963 
p
 < 
p_íd
) {

964 
b
 = *
p
++;

965 
ty≥
 = 
b
 >> 7;

966 
n
 = 
b
 & 0x7f;

967 i‡(
n
 < 96) {

968 } i‡(
n
 < 112) {

969 
n
 = (n - 96) << 8;

970 
n
 |*
p
++;

971 
n
 += 96;

973 
n
 = (n - 112) << 16;

974 
n
 |*
p
++ << 8;

975 
n
 |*
p
++;

976 
n
 += 96 + (1 << 12);

978 i‡(
ty≥
 == 0)

979 
v
 = 0;

981 
v
 = *
p
++;

982 
c1
 = 
c
 + 
n
 + 1;

983 i‡(
v
 =
s¸ùt_idx
) {

984 i‡(
	`¸_add_öãrvÆ
(
¸1
, 
c
, 
c1
))

985 
Áû
;

987 
c
 = 
c1
;

990 i‡(
is_ext
) {

992 
p
 = 
unicode_s¸ùt_ext_èbÀ
;

993 
p_íd
 = 
unicode_s¸ùt_ext_èbÀ
 + 
	`cou¡of
(unicode_script_ext_table);

994 
c
 = 0;

995 
p
 < 
p_íd
) {

996 
b
 = *
p
++;

997 i‡(
b
 < 128) {

998 
n
 = 
b
;

999 } i‡(
b
 < 128 + 64) {

1000 
n
 = (
b
 - 128) << 8;

1001 
n
 |*
p
++;

1002 
n
 += 128;

1004 
n
 = (
b
 - 128 - 64) << 16;

1005 
n
 |*
p
++ << 8;

1006 
n
 |*
p
++;

1007 
n
 += 128 + (1 << 14);

1009 
c1
 = 
c
 + 
n
 + 1;

1010 
v_Àn
 = *
p
++;

1011 i‡(
is_comm⁄
) {

1012 i‡(
v_Àn
 != 0) {

1013 i‡(
	`¸_add_öãrvÆ
(
¸2
, 
c
, 
c1
))

1014 
Áû
;

1017 
i
 = 0; i < 
v_Àn
; i++) {

1018 i‡(
p
[
i
] =
s¸ùt_idx
) {

1019 i‡(
	`¸_add_öãrvÆ
(
¸2
, 
c
, 
c1
))

1020 
Áû
;

1025 
p
 +
v_Àn
;

1026 
c
 = 
c1
;

1028 i‡(
is_comm⁄
) {

1030 i‡(
	`¸_övît
(
¸2
))

1031 
Áû
;

1032 i‡(
	`¸_›
(
¸
, 
¸1
->
poöts
, cr1->
Àn
, 
¸2
->points, cr2->len,

1033 
CR_OP_INTER
))

1034 
Áû
;

1036 i‡(
	`¸_›
(
¸
, 
¸1
->
poöts
, cr1->
Àn
, 
¸2
->points, cr2->len,

1037 
CR_OP_UNION
))

1038 
Áû
;

1040 
	`¸_‰ì
(
¸1
);

1041 
	`¸_‰ì
(
¸2
);

1044 
Áû
:

1045 i‡(
is_ext
) {

1046 
	`¸_‰ì
(
¸1
);

1047 
	`¸_‰ì
(
¸2
);

1049 
Áû
;

1050 
	}
}

1052 
	#M
(
id
Ë(1U << 
UNICODE_GC_
 ## id)

	)

1054 
	$unicode_gíîÆ_ˇãg‹y1
(
Ch¨R™ge
 *
¸
, 
uöt32_t
 
gc_mask
)

1056 c⁄° 
uöt8_t
 *
p
, *
p_íd
;

1057 
uöt32_t
 
c
, 
c0
, 
b
, 
n
, 
v
;

1059 
p
 = 
unicode_gc_èbÀ
;

1060 
p_íd
 = 
unicode_gc_èbÀ
 + 
	`cou¡of
(unicode_gc_table);

1061 
c
 = 0;

1062 
p
 < 
p_íd
) {

1063 
b
 = *
p
++;

1064 
n
 = 
b
 >> 5;

1065 
v
 = 
b
 & 0x1f;

1066 i‡(
n
 == 7) {

1067 
n
 = *
p
++;

1068 i‡(
n
 < 128) {

1069 
n
 += 7;

1070 } i‡(
n
 < 128 + 64) {

1071 
n
 = (n - 128) << 8;

1072 
n
 |*
p
++;

1073 
n
 += 7 + 128;

1075 
n
 = (n - 128 - 64) << 16;

1076 
n
 |*
p
++ << 8;

1077 
n
 |*
p
++;

1078 
n
 += 7 + 128 + (1 << 14);

1081 
c0
 = 
c
;

1082 
c
 +
n
 + 1;

1083 i‡(
v
 == 31) {

1085 
b
 = 
gc_mask
 & (
	`M
(
Lu
Ë| M(
Ll
));

1086 i‡(
b
 != 0) {

1087 i‡(
b
 =(
	`M
(
Lu
Ë| M(
Ll
))) {

1088 
add_ønge
;

1090 
c0
 +((
gc_mask
 & 
	`M
(
Ll
)) != 0);

1091 ; 
c0
 < 
c
; c0 += 2) {

1092 i‡(
	`¸_add_öãrvÆ
(
¸
, 
c0
, c0 + 1))

1097 } i‡((
gc_mask
 >> 
v
) & 1) {

1098 
add_ønge
:

1099 i‡(
	`¸_add_öãrvÆ
(
¸
, 
c0
, 
c
))

1104 
	}
}

1106 
	$unicode_¥›1
(
Ch¨R™ge
 *
¸
, 
¥›_idx
)

1108 c⁄° 
uöt8_t
 *
p
, *
p_íd
;

1109 
uöt32_t
 
c
, 
c0
, 
b
, 
bô
;

1111 
p
 = 
unicode_¥›_èbÀ
[
¥›_idx
];

1112 
p_íd
 = 
p
 + 
unicode_¥›_Àn_èbÀ
[
¥›_idx
];

1113 
c
 = 0;

1114 
bô
 = 0;

1115 
p
 < 
p_íd
) {

1116 
c0
 = 
c
;

1117 
b
 = *
p
++;

1118 i‡(
b
 < 64) {

1119 
c
 +(
b
 >> 3) + 1;

1120 i‡(
bô
) {

1121 i‡(
	`¸_add_öãrvÆ
(
¸
, 
c0
, 
c
))

1124 
bô
 ^= 1;

1125 
c0
 = 
c
;

1126 
c
 +(
b
 & 7) + 1;

1127 } i‡(
b
 >= 0x80) {

1128 
c
 +
b
 - 0x80 + 1;

1129 } i‡(
b
 < 0x60) {

1130 
c
 +(((
b
 - 0x40Ë<< 8Ë| 
p
[0]) + 1;

1131 
p
++;

1133 
c
 +(((
b
 - 0x60Ë<< 16Ë| (
p
[0] << 8) |Ö[1]) + 1;

1134 
p
 += 2;

1136 i‡(
bô
) {

1137 i‡(
	`¸_add_öãrvÆ
(
¸
, 
c0
, 
c
))

1140 
bô
 ^= 1;

1143 
	}
}

1145 
	#CASE_U
 (1 << 0)

	)

1146 
	#CASE_L
 (1 << 1)

	)

1147 
	#CASE_F
 (1 << 2)

	)

1154 
	$unicode_ˇ£1
(
Ch¨R™ge
 *
¸
, 
ˇ£_mask
)

1156 
	#MR
(
x
Ë(1 << 
RUN_TYPE_
 ## x)

	)

1157 c⁄° 
uöt32_t
 
èb_run_mask
[3] = {

1158 
	`MR
(
U
Ë| MR(
UF
Ë| MR(
UL
Ë| MR(
LSU
Ë| MR(
U2L_399_EXT2
Ë| MR(
UF_D20
) |

1159 
	`MR
(
UF_D1_EXT
Ë| MR(
U_EXT
Ë| MR(
U_EXT2
Ë| MR(
U_EXT3
),

1161 
	`MR
(
L
Ë| MR(
LF
Ë| MR(
UL
Ë| MR(
LSU
Ë| MR(
U2L_399_EXT2
Ë| MR(
LF_EXT
Ë| MR(
L_EXT2
),

1163 
	`MR
(
UF
Ë| MR(
LF
Ë| MR(
UL
Ë| MR(
LSU
Ë| MR(
U2L_399_EXT2
Ë| MR(
LF_EXT
Ë| MR(
UF_D20
Ë| MR(
UF_D1_EXT
) | MR(LF_EXT),

1165 #unde‡
MR


1166 
uöt32_t
 
mask
, 
v
, 
code
, 
ty≥
, 
Àn
, 
i
, 
idx
;

1168 i‡(
ˇ£_mask
 == 0)

1170 
mask
 = 0;

1171 
i
 = 0; i < 3; i++) {

1172 i‡((
ˇ£_mask
 >> 
i
) & 1)

1173 
mask
 |
èb_run_mask
[
i
];

1175 
idx
 = 0; idx < 
	`cou¡of
(
ˇ£_c⁄v_èbÀ1
); idx++) {

1176 
v
 = 
ˇ£_c⁄v_èbÀ1
[
idx
];

1177 
ty≥
 = (
v
 >> (32 - 17 - 7 - 4)) & 0xf;

1178 
code
 = 
v
 >> (32 - 17);

1179 
Àn
 = (
v
 >> (32 - 17 - 7)) & 0x7f;

1180 i‡((
mask
 >> 
ty≥
) & 1) {

1182 
ty≥
) {

1183 
RUN_TYPE_UL
:

1184 i‡((
ˇ£_mask
 & 
CASE_U
Ë&& (ˇ£_mask & (
CASE_L
 | 
CASE_F
)))

1185 
def_ˇ£
;

1186 
code
 +((
ˇ£_mask
 & 
CASE_U
) != 0);

1187 
i
 = 0; i < 
Àn
; i += 2) {

1188 i‡(
	`¸_add_öãrvÆ
(
¸
, 
code
 + 
i
, code + i + 1))

1192 
RUN_TYPE_LSU
:

1193 i‡((
ˇ£_mask
 & 
CASE_U
Ë&& (ˇ£_mask & (
CASE_L
 | 
CASE_F
)))

1194 
def_ˇ£
;

1195 i‡(!(
ˇ£_mask
 & 
CASE_U
)) {

1196 i‡(
	`¸_add_öãrvÆ
(
¸
, 
code
, code + 1))

1199 i‡(
	`¸_add_öãrvÆ
(
¸
, 
code
 + 1, code + 2))

1201 i‡(
ˇ£_mask
 & 
CASE_U
) {

1202 i‡(
	`¸_add_öãrvÆ
(
¸
, 
code
 + 2, code + 3))

1207 
def_ˇ£
:

1208 i‡(
	`¸_add_öãrvÆ
(
¸
, 
code
, codê+ 
Àn
))

1215 
	}
}

1218 
	mPOP_GC
,

1219 
	mPOP_PROP
,

1220 
	mPOP_CASE
,

1221 
	mPOP_UNION
,

1222 
	mPOP_INTER
,

1223 
	mPOP_XOR
,

1224 
	mPOP_INVERT
,

1225 
	mPOP_END
,

1226 } 
	tPr›OPEnum
;

1228 
	#POP_STACK_LEN_MAX
 4

	)

1230 
	$unicode_¥›_›s
(
Ch¨R™ge
 *
¸
, ...)

1232 
va_li°
 
≠
;

1233 
Ch¨R™ge
 
°ack
[
POP_STACK_LEN_MAX
];

1234 
°ack_Àn
, 
›
, 
ªt
, 
i
;

1235 
uöt32_t
 
a
;

1237 
	`va_°¨t
(
≠
, 
¸
);

1238 
°ack_Àn
 = 0;

1240 
›
 = 
	`va_¨g
(
≠
, );

1241 
›
) {

1242 
POP_GC
:

1243 
	`as£π
(
°ack_Àn
 < 
POP_STACK_LEN_MAX
);

1244 
a
 = 
	`va_¨g
(
≠
, );

1245 
	`¸_öô
(&
°ack
[
°ack_Àn
++], 
¸
->
mem_›aque
, cr->
ªÆloc_func
);

1246 i‡(
	`unicode_gíîÆ_ˇãg‹y1
(&
°ack
[
°ack_Àn
 - 1], 
a
))

1247 
Áû
;

1249 
POP_PROP
:

1250 
	`as£π
(
°ack_Àn
 < 
POP_STACK_LEN_MAX
);

1251 
a
 = 
	`va_¨g
(
≠
, );

1252 
	`¸_öô
(&
°ack
[
°ack_Àn
++], 
¸
->
mem_›aque
, cr->
ªÆloc_func
);

1253 i‡(
	`unicode_¥›1
(&
°ack
[
°ack_Àn
 - 1], 
a
))

1254 
Áû
;

1256 
POP_CASE
:

1257 
	`as£π
(
°ack_Àn
 < 
POP_STACK_LEN_MAX
);

1258 
a
 = 
	`va_¨g
(
≠
, );

1259 
	`¸_öô
(&
°ack
[
°ack_Àn
++], 
¸
->
mem_›aque
, cr->
ªÆloc_func
);

1260 i‡(
	`unicode_ˇ£1
(&
°ack
[
°ack_Àn
 - 1], 
a
))

1261 
Áû
;

1263 
POP_UNION
:

1264 
POP_INTER
:

1265 
POP_XOR
:

1267 
Ch¨R™ge
 *
¸1
, *
¸2
, *
¸3
;

1268 
	`as£π
(
°ack_Àn
 >= 2);

1269 
	`as£π
(
°ack_Àn
 < 
POP_STACK_LEN_MAX
);

1270 
¸1
 = &
°ack
[
°ack_Àn
 - 2];

1271 
¸2
 = &
°ack
[
°ack_Àn
 - 1];

1272 
¸3
 = &
°ack
[
°ack_Àn
++];

1273 
	`¸_öô
(
¸3
, 
¸
->
mem_›aque
, cr->
ªÆloc_func
);

1274 i‡(
	`¸_›
(
¸3
, 
¸1
->
poöts
, cr1->
Àn
,

1275 
¸2
->
poöts
, cr2->
Àn
, 
›
 - 
POP_UNION
 + 
CR_OP_UNION
))

1276 
Áû
;

1277 
	`¸_‰ì
(
¸1
);

1278 
	`¸_‰ì
(
¸2
);

1279 *
¸1
 = *
¸3
;

1280 
°ack_Àn
 -= 2;

1283 
POP_INVERT
:

1284 
	`as£π
(
°ack_Àn
 >= 1);

1285 i‡(
	`¸_övît
(&
°ack
[
°ack_Àn
 - 1]))

1286 
Áû
;

1288 
POP_END
:

1289 
d⁄e
;

1291 
	`ab‹t
();

1294 
d⁄e
:

1295 
	`as£π
(
°ack_Àn
 == 1);

1296 
ªt
 = 
	`¸_c›y
(
¸
, &
°ack
[0]);

1297 
	`¸_‰ì
(&
°ack
[0]);

1298  
ªt
;

1299 
Áû
:

1300 
i
 = 0; i < 
°ack_Àn
; i++)

1301 
	`¸_‰ì
(&
°ack
[
i
]);

1303 
	}
}

1305 c⁄° 
uöt32_t
 
	gunicode_gc_mask_èbÀ
[] = {

1306 
M
(
Lu
Ë| M(
Ll
Ë| M(
Lt
),

1307 
M
(
Lu
Ë| M(
Ll
Ë| M(
Lt
Ë| M(
Lm
Ë| M(
Lo
),

1308 
M
(
Mn
Ë| M(
Mc
Ë| M(
Me
),

1309 
M
(
Nd
Ë| M(
Nl
Ë| M(
No
),

1310 
M
(
Sm
Ë| M(
Sc
Ë| M(
Sk
Ë| M(
So
),

1311 
M
(
Pc
Ë| M(
Pd
Ë| M(
Ps
Ë| M(
Pe
Ë| M(
Pi
Ë| M(
Pf
Ë| M(
Po
),

1312 
M
(
Zs
Ë| M(
Zl
Ë| M(
Zp
),

1313 
M
(
Cc
Ë| M(
Cf
Ë| M(
Cs
Ë| M(
Co
Ë| M(
Cn
),

1318 
	$unicode_gíîÆ_ˇãg‹y
(
Ch¨R™ge
 *
¸
, c⁄° *
gc_«me
)

1320 
gc_idx
;

1321 
uöt32_t
 
gc_mask
;

1323 
gc_idx
 = 
	`unicode_föd_«me
(
unicode_gc_«me_èbÀ
, 
gc_«me
);

1324 i‡(
gc_idx
 < 0)

1326 i‡(
gc_idx
 <
UNICODE_GC_Co
) {

1327 
gc_mask
 = (
uöt64_t
)1 << 
gc_idx
;

1329 
gc_mask
 = 
unicode_gc_mask_èbÀ
[
gc_idx
 - 
UNICODE_GC_LC
];

1331  
	`unicode_gíîÆ_ˇãg‹y1
(
¸
, 
gc_mask
);

1332 
	}
}

1337 
	$unicode_¥›
(
Ch¨R™ge
 *
¸
, c⁄° *
¥›_«me
)

1339 
¥›_idx
, 
ªt
;

1341 
¥›_idx
 = 
	`unicode_föd_«me
(
unicode_¥›_«me_èbÀ
, 
¥›_«me
);

1342 i‡(
¥›_idx
 < 0)

1344 
¥›_idx
 +
UNICODE_PROP_ASCII_Hex_Digô
;

1346 
ªt
 = 0;

1347 
¥›_idx
) {

1348 
UNICODE_PROP_ASCII
:

1349 i‡(
	`¸_add_öãrvÆ
(
¸
, 0x00, 0x7f + 1))

1352 
UNICODE_PROP_Any
:

1353 i‡(
	`¸_add_öãrvÆ
(
¸
, 0x00000, 0x10ffff + 1))

1356 
UNICODE_PROP_Assig√d
:

1357 
ªt
 = 
	`unicode_¥›_›s
(
¸
,

1358 
POP_GC
, 
	`M
(
Cn
),

1359 
POP_INVERT
,

1360 
POP_END
);

1362 
UNICODE_PROP_M©h
:

1363 
ªt
 = 
	`unicode_¥›_›s
(
¸
,

1364 
POP_GC
, 
	`M
(
Sm
),

1365 
POP_PROP
, 
UNICODE_PROP_Othî_M©h
,

1366 
POP_UNION
,

1367 
POP_END
);

1369 
UNICODE_PROP_Lowîˇ£
:

1370 
ªt
 = 
	`unicode_¥›_›s
(
¸
,

1371 
POP_GC
, 
	`M
(
Ll
),

1372 
POP_PROP
, 
UNICODE_PROP_Othî_Lowîˇ£
,

1373 
POP_UNION
,

1374 
POP_END
);

1376 
UNICODE_PROP_Uµîˇ£
:

1377 
ªt
 = 
	`unicode_¥›_›s
(
¸
,

1378 
POP_GC
, 
	`M
(
Lu
),

1379 
POP_PROP
, 
UNICODE_PROP_Othî_Uµîˇ£
,

1380 
POP_UNION
,

1381 
POP_END
);

1383 
UNICODE_PROP_Ca£d
:

1384 
ªt
 = 
	`unicode_¥›_›s
(
¸
,

1385 
POP_GC
, 
	`M
(
Lu
Ë| M(
Ll
Ë| M(
Lt
),

1386 
POP_PROP
, 
UNICODE_PROP_Othî_Uµîˇ£
,

1387 
POP_UNION
,

1388 
POP_PROP
, 
UNICODE_PROP_Othî_Lowîˇ£
,

1389 
POP_UNION
,

1390 
POP_END
);

1392 
UNICODE_PROP_AÕhabëic
:

1393 
ªt
 = 
	`unicode_¥›_›s
(
¸
,

1394 
POP_GC
, 
	`M
(
Lu
Ë| M(
Ll
Ë| M(
Lt
Ë| M(
Lm
Ë| M(
Lo
Ë| M(
Nl
),

1395 
POP_PROP
, 
UNICODE_PROP_Othî_Uµîˇ£
,

1396 
POP_UNION
,

1397 
POP_PROP
, 
UNICODE_PROP_Othî_Lowîˇ£
,

1398 
POP_UNION
,

1399 
POP_PROP
, 
UNICODE_PROP_Othî_AÕhabëic
,

1400 
POP_UNION
,

1401 
POP_END
);

1403 
UNICODE_PROP_Gøpheme_Ba£
:

1404 
ªt
 = 
	`unicode_¥›_›s
(
¸
,

1405 
POP_GC
, 
	`M
(
Cc
Ë| M(
Cf
Ë| M(
Cs
Ë| M(
Co
Ë| M(
Cn
Ë| M(
Zl
Ë| M(
Zp
Ë| M(
Me
Ë| M(
Mn
),

1406 
POP_PROP
, 
UNICODE_PROP_Othî_Gøpheme_Exãnd
,

1407 
POP_UNION
,

1408 
POP_INVERT
,

1409 
POP_END
);

1411 
UNICODE_PROP_Gøpheme_Exãnd
:

1412 
ªt
 = 
	`unicode_¥›_›s
(
¸
,

1413 
POP_GC
, 
	`M
(
Me
Ë| M(
Mn
),

1414 
POP_PROP
, 
UNICODE_PROP_Othî_Gøpheme_Exãnd
,

1415 
POP_UNION
,

1416 
POP_END
);

1418 
UNICODE_PROP_XID_Sèπ
:

1419 
ªt
 = 
	`unicode_¥›_›s
(
¸
,

1420 
POP_GC
, 
	`M
(
Lu
Ë| M(
Ll
Ë| M(
Lt
Ë| M(
Lm
Ë| M(
Lo
Ë| M(
Nl
),

1421 
POP_PROP
, 
UNICODE_PROP_Othî_ID_Sèπ
,

1422 
POP_UNION
,

1423 
POP_PROP
, 
UNICODE_PROP_P©ã∫_Sy¡ax
,

1424 
POP_PROP
, 
UNICODE_PROP_P©ã∫_Whôe_S∑˚
,

1425 
POP_UNION
,

1426 
POP_PROP
, 
UNICODE_PROP_XID_Sèπ1
,

1427 
POP_UNION
,

1428 
POP_INVERT
,

1429 
POP_INTER
,

1430 
POP_END
);

1432 
UNICODE_PROP_XID_C⁄töue
:

1433 
ªt
 = 
	`unicode_¥›_›s
(
¸
,

1434 
POP_GC
, 
	`M
(
Lu
Ë| M(
Ll
Ë| M(
Lt
Ë| M(
Lm
Ë| M(
Lo
Ë| M(
Nl
) |

1435 
	`M
(
Mn
Ë| M(
Mc
Ë| M(
Nd
Ë| M(
Pc
),

1436 
POP_PROP
, 
UNICODE_PROP_Othî_ID_Sèπ
,

1437 
POP_UNION
,

1438 
POP_PROP
, 
UNICODE_PROP_Othî_ID_C⁄töue
,

1439 
POP_UNION
,

1440 
POP_PROP
, 
UNICODE_PROP_P©ã∫_Sy¡ax
,

1441 
POP_PROP
, 
UNICODE_PROP_P©ã∫_Whôe_S∑˚
,

1442 
POP_UNION
,

1443 
POP_PROP
, 
UNICODE_PROP_XID_C⁄töue1
,

1444 
POP_UNION
,

1445 
POP_INVERT
,

1446 
POP_INTER
,

1447 
POP_END
);

1449 
UNICODE_PROP_Ch™ges_Whí_Uµîˇ£d
:

1450 
ªt
 = 
	`unicode_ˇ£1
(
¸
, 
CASE_U
);

1452 
UNICODE_PROP_Ch™ges_Whí_Lowîˇ£d
:

1453 
ªt
 = 
	`unicode_ˇ£1
(
¸
, 
CASE_L
);

1455 
UNICODE_PROP_Ch™ges_Whí_Ca£m≠≥d
:

1456 
ªt
 = 
	`unicode_ˇ£1
(
¸
, 
CASE_U
 | 
CASE_L
 | 
CASE_F
);

1458 
UNICODE_PROP_Ch™ges_Whí_TôÀˇ£d
:

1459 
ªt
 = 
	`unicode_¥›_›s
(
¸
,

1460 
POP_CASE
, 
CASE_U
,

1461 
POP_PROP
, 
UNICODE_PROP_Ch™ges_Whí_TôÀˇ£d1
,

1462 
POP_XOR
,

1463 
POP_END
);

1465 
UNICODE_PROP_Ch™ges_Whí_Ca£fﬁded
:

1466 
ªt
 = 
	`unicode_¥›_›s
(
¸
,

1467 
POP_CASE
, 
CASE_F
,

1468 
POP_PROP
, 
UNICODE_PROP_Ch™ges_Whí_Ca£fﬁded1
,

1469 
POP_XOR
,

1470 
POP_END
);

1472 
UNICODE_PROP_Ch™ges_Whí_NFKC_Ca£fﬁded
:

1473 
ªt
 = 
	`unicode_¥›_›s
(
¸
,

1474 
POP_CASE
, 
CASE_F
,

1475 
POP_PROP
, 
UNICODE_PROP_Ch™ges_Whí_NFKC_Ca£fﬁded1
,

1476 
POP_XOR
,

1477 
POP_END
);

1480 
UNICODE_PROP_ID_Sèπ
:

1481 
ªt
 = 
	`unicode_¥›_›s
(
¸
,

1482 
POP_GC
, 
	`M
(
Lu
Ë| M(
Ll
Ë| M(
Lt
Ë| M(
Lm
Ë| M(
Lo
Ë| M(
Nl
),

1483 
POP_PROP
, 
UNICODE_PROP_Othî_ID_Sèπ
,

1484 
POP_UNION
,

1485 
POP_PROP
, 
UNICODE_PROP_P©ã∫_Sy¡ax
,

1486 
POP_PROP
, 
UNICODE_PROP_P©ã∫_Whôe_S∑˚
,

1487 
POP_UNION
,

1488 
POP_INVERT
,

1489 
POP_INTER
,

1490 
POP_END
);

1492 
UNICODE_PROP_ID_C⁄töue
:

1493 
ªt
 = 
	`unicode_¥›_›s
(
¸
,

1494 
POP_GC
, 
	`M
(
Lu
Ë| M(
Ll
Ë| M(
Lt
Ë| M(
Lm
Ë| M(
Lo
Ë| M(
Nl
) |

1495 
	`M
(
Mn
Ë| M(
Mc
Ë| M(
Nd
Ë| M(
Pc
),

1496 
POP_PROP
, 
UNICODE_PROP_Othî_ID_Sèπ
,

1497 
POP_UNION
,

1498 
POP_PROP
, 
UNICODE_PROP_Othî_ID_C⁄töue
,

1499 
POP_UNION
,

1500 
POP_PROP
, 
UNICODE_PROP_P©ã∫_Sy¡ax
,

1501 
POP_PROP
, 
UNICODE_PROP_P©ã∫_Whôe_S∑˚
,

1502 
POP_UNION
,

1503 
POP_INVERT
,

1504 
POP_INTER
,

1505 
POP_END
);

1507 
UNICODE_PROP_Ca£_Ign‹abÀ
:

1508 
ªt
 = 
	`unicode_¥›_›s
(
¸
,

1509 
POP_GC
, 
	`M
(
Mn
Ë| M(
Cf
Ë| M(
Lm
Ë| M(
Sk
),

1510 
POP_PROP
, 
UNICODE_PROP_Ca£_Ign‹abÀ1
,

1511 
POP_XOR
,

1512 
POP_END
);

1516 
UNICODE_PROP_ID_C⁄töue
:

1517 
ªt
 = 
	`unicode_¥›_›s
(
¸
,

1518 
POP_PROP
, 
UNICODE_PROP_ID_Sèπ
,

1519 
POP_PROP
, 
UNICODE_PROP_ID_C⁄töue1
,

1520 
POP_XOR
,

1521 
POP_END
);

1525 i‡(
¥›_idx
 >
	`cou¡of
(
unicode_¥›_èbÀ
))

1527 
ªt
 = 
	`unicode_¥›1
(
¸
, 
¥›_idx
);

1530  
ªt
;

1531 
	}
}

	@main.c

1 
	~<«utûus/«utûus.h
>

2 
	~<«utûus/shñl.h
>

5 
	$íåy
(* 
buf
, * 
¥iv
) {

6 
	`¥ötk
("TEST\n");

8 
	}
}

10 
shñl_cmd_im∂
 
	gjs_im∂
 = {

11 .
cmd
 = "js",

12 .
	ghñp_°r
 = "js",

13 .
	gh™dÀr
 = 
íåy


16 
nk_ªgi°î_shñl_cmd
(
js_im∂
);

	@qjs.c

26 
	~<°d¨g.h
>

28 
	~<«utûus/mm.h
>

31 
	~<as£π.h
>

33 
	~<π/js/quickjs-libc.h
>

40 c⁄° 
uöt8_t
 
qjsc_ª∂
[];

41 c⁄° 
uöt32_t
 
qjsc_ª∂_size
;

42 #ifde‡
CONFIG_BIGNUM


43 c⁄° 
uöt8_t
 
qjsc_qjsˇlc
[];

44 c⁄° 
uöt32_t
 
qjsc_qjsˇlc_size
;

47 
	$evÆ_buf
(
JSC⁄ãxt
 *
˘x
, c⁄° *
buf
, 
buf_Àn
,

48 c⁄° *
fûíame
, 
evÆ_Êags
)

50 
JSVÆue
 
vÆ
;

51 
ªt
;

53 i‡((
evÆ_Êags
 & 
JS_EVAL_TYPE_MASK
Ë=
JS_EVAL_TYPE_MODULE
) {

56 
vÆ
 = 
	`JS_EvÆ
(
˘x
, 
buf
, 
buf_Àn
, 
fûíame
,

57 
evÆ_Êags
 | 
JS_EVAL_FLAG_COMPILE_ONLY
);

58 i‡(!
	`JS_IsEx˚±i⁄
(
vÆ
)) {

59 
	`js_moduÀ_£t_imp‹t_mëa
(
˘x
, 
vÆ
, 
TRUE
, TRUE);

60 
vÆ
 = 
	`JS_EvÆFun˘i⁄
(
˘x
, val);

63 
vÆ
 = 
	`JS_EvÆ
(
˘x
, 
buf
, 
buf_Àn
, 
fûíame
, 
evÆ_Êags
);

65 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
)) {

66 
	`js_°d_dump_îr‹
(
˘x
);

67 
ªt
 = -1;

69 
ªt
 = 0;

71 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

72  
ªt
;

73 
	}
}

75 
	$evÆ_fûe
(
JSC⁄ãxt
 *
˘x
, c⁄° *
fûíame
, 
moduÀ
)

77 
uöt8_t
 *
buf
;

78 
ªt
, 
evÆ_Êags
;

79 
size_t
 
buf_Àn
;

81 
buf
 = 
	`js_lﬂd_fûe
(
˘x
, &
buf_Àn
, 
fûíame
);

82 i‡(!
buf
) {

83 
	`≥º‹
(
fûíame
);

84 
	`exô
(1);

87 i‡(
moduÀ
 < 0) {

88 
moduÀ
 = (
	`has_suffix
(
fûíame
, ".mjs") ||

89 
	`JS_Dëe˘ModuÀ
((c⁄° *)
buf
, 
buf_Àn
));

91 i‡(
moduÀ
)

92 
evÆ_Êags
 = 
JS_EVAL_TYPE_MODULE
;

94 
evÆ_Êags
 = 
JS_EVAL_TYPE_GLOBAL
;

95 
ªt
 = 
	`evÆ_buf
(
˘x
, 
buf
, 
buf_Àn
, 
fûíame
, 
evÆ_Êags
);

96 
	`js_‰ì
(
˘x
, 
buf
);

97  
ªt
;

98 
	}
}

100 #i‡
deföed
(
__APPLE__
)

101 
	#MALLOC_OVERHEAD
 0

	)

103 
	#MALLOC_OVERHEAD
 8

	)

106 
	såa˚_mÆloc_d©a
 {

107 
uöt8_t
 *
	mba£
;

110 
ölöe
 
	$js_åa˚_mÆloc_±r_off£t
(
uöt8_t
 *
±r
,

111 
åa˚_mÆloc_d©a
 *
dp
)

113  
±r
 - 
dp
->
ba£
;

114 
	}
}

117 
ölöe
 
size_t
 
	$js_åa˚_mÆloc_ußbÀ_size
(*
±r
)

119 #i‡
	`deföed
(
__APPLE__
)

120  
	`mÆloc_size
(
±r
);

121 #ñi‡
	`deföed
(
_WIN32
)

122  
	`_msize
(
±r
);

123 #ñi‡
	`deföed
(
EMSCRIPTEN
)

125 #ñi‡
	`deföed
(
__löux__
)

126  
	`mÆloc_ußbÀ_size
(
±r
);

129  
	`mÆloc_ußbÀ_size
(
±r
);

131 
	}
}

133 
__©åibuã__
((
	$f‹m©
(
¥ötf
, 2, 3)))

134 
	$js_åa˚_mÆloc_¥ötf
(
JSMÆlocSèã
 *
s
, c⁄° *
fmt
, ...)

136 
va_li°
 
≠
;

137 
c
;

139 
	`va_°¨t
(
≠
, 
fmt
);

140 (
c
 = *
fmt
++) != '\0') {

141 i‡(
c
 == '%') {

143 i‡(*
fmt
 == 'p') {

144 
uöt8_t
 *
±r
 = 
	`va_¨g
(
≠
, *);

145 i‡(
±r
 =
NULL
) {

146 
	`¥ötf
("NULL");

148 
	`¥ötf
("H%+06lld.%zd",

149 
	`js_åa˚_mÆloc_±r_off£t
(
±r
, 
s
->
›aque
),

150 
	`js_åa˚_mÆloc_ußbÀ_size
(
±r
));

152 
fmt
++;

155 i‡(
fmt
[0] == 'z' && fmt[1] == 'd') {

156 
size_t
 
sz
 = 
	`va_¨g
(
≠
, size_t);

157 
	`¥ötf
("%zd", 
sz
);

158 
fmt
 += 2;

162 
	`putc
(
c
, 
°dout
);

164 
	`va_íd
(
≠
);

165 
	}
}

167 
	$js_åa˚_mÆloc_öô
(
åa˚_mÆloc_d©a
 *
s
)

169 
	`‰ì
(
s
->
ba£
 = 
	`mÆloc
(8));

170 
	}
}

172 *
	$js_åa˚_mÆloc
(
JSMÆlocSèã
 *
s
, 
size_t
 
size
)

174 *
±r
;

177 
	`as£π
(
size
 != 0);

179 i‡(
	`u∆ikñy
(
s
->
mÆloc_size
 + 
size
 > s->
mÆloc_limô
))

180  
NULL
;

181 
±r
 = 
	`mÆloc
(
size
);

182 
	`js_åa˚_mÆloc_¥ötf
(
s
, "A %zd -> %p\n", 
size
, 
±r
);

183 i‡(
±r
) {

184 
s
->
mÆloc_cou¡
++;

185 
s
->
mÆloc_size
 +
	`js_åa˚_mÆloc_ußbÀ_size
(
±r
Ë+ 
MALLOC_OVERHEAD
;

187  
±r
;

188 
	}
}

190 
	$js_åa˚_‰ì
(
JSMÆlocSèã
 *
s
, *
±r
)

192 i‡(!
±r
)

195 
	`js_åa˚_mÆloc_¥ötf
(
s
, "F %p\n", 
±r
);

196 
s
->
mÆloc_cou¡
--;

197 
s
->
mÆloc_size
 -
	`js_åa˚_mÆloc_ußbÀ_size
(
±r
Ë+ 
MALLOC_OVERHEAD
;

198 
	`‰ì
(
±r
);

199 
	}
}

201 *
	$js_åa˚_ªÆloc
(
JSMÆlocSèã
 *
s
, *
±r
, 
size_t
 
size
)

203 
size_t
 
ﬁd_size
;

205 i‡(!
±r
) {

206 i‡(
size
 == 0)

207  
NULL
;

208  
	`js_åa˚_mÆloc
(
s
, 
size
);

210 
ﬁd_size
 = 
	`js_åa˚_mÆloc_ußbÀ_size
(
±r
);

211 i‡(
size
 == 0) {

212 
	`js_åa˚_mÆloc_¥ötf
(
s
, "R %zd %p\n", 
size
, 
±r
);

213 
s
->
mÆloc_cou¡
--;

214 
s
->
mÆloc_size
 -
ﬁd_size
 + 
MALLOC_OVERHEAD
;

215 
	`‰ì
(
±r
);

216  
NULL
;

218 i‡(
s
->
mÆloc_size
 + 
size
 - 
ﬁd_size
 > s->
mÆloc_limô
)

219  
NULL
;

221 
	`js_åa˚_mÆloc_¥ötf
(
s
, "R %zd %p", 
size
, 
±r
);

223 
±r
 = 
	`ªÆloc
’å, 
size
);

224 
	`js_åa˚_mÆloc_¥ötf
(
s
, " -> %p\n", 
±r
);

225 i‡(
±r
) {

226 
s
->
mÆloc_size
 +
	`js_åa˚_mÆloc_ußbÀ_size
(
±r
Ë- 
ﬁd_size
;

228  
±r
;

229 
	}
}

231 c⁄° 
JSMÆlocFun˘i⁄s
 
	gåa˚_mf
 = {

232 
js_åa˚_mÆloc
,

233 
js_åa˚_‰ì
,

234 
js_åa˚_ªÆloc
,

235 (
size_t
 (*)(c⁄° *))
kmem_mÆloc_ußbÀ_size
,

238 
	#PROG_NAME
 "qjs"

	)

240 
	$hñp
()

242 
	`¥ötf
("QuickJS version %s\n"

243 "ußge: " 
PROG_NAME
 " [options] [file [args]]\n"

251 #ifde‡
CONFIG_BIGNUM


260 
	`exô
(1);

261 
	}
}

263 
	$js_maö
(
¨gc
, **
¨gv
)

265 
JSRu¡ime
 *
π
;

266 
JSC⁄ãxt
 *
˘x
;

267 
åa˚_mÆloc_d©a
 
åa˚_d©a
 = { 
NULL
 };

268 
›töd
;

269 *
ex¥
 = 
NULL
;

270 
öãø˘ive
 = 0;

271 
dump_mem‹y
 = 0;

272 
åa˚_mem‹y
 = 0;

273 
em±y_run
 = 0;

274 
moduÀ
 = -1;

275 
lﬂd_°d
 = 0;

276 
dump_unh™dÀd_¥omi£_ªje˘i⁄
 = 0;

277 
size_t
 
mem‹y_limô
 = 0;

278 *
ö˛ude_li°
[32];

279 
i
, 
ö˛ude_cou¡
 = 0;

280 #ifde‡
CONFIG_BIGNUM


281 
lﬂd_jsˇlc
, 
bignum_ext
 = 0;

284 #ifde‡
CONFIG_BIGNUM


287 c⁄° *
p
, *
exíame
;

288 
exíame
 = 
¨gv
[0];

289 
p
 = 
	`°ºchr
(
exíame
, '/');

290 i‡(
p
)

291 
exíame
 = 
p
 + 1;

292 
lﬂd_jsˇlc
 = !
	`°rcmp
(
exíame
, "qjscalc");

298 
›töd
 = 1;

299 
›töd
 < 
¨gc
 && *
¨gv
[optind] == '-') {

300 *
¨g
 = 
¨gv
[
›töd
] + 1;

301 c⁄° *
l⁄g›t
 = "";

303 i‡(!*
¨g
)

305 
›töd
++;

306 i‡(*
¨g
 == '-') {

307 
l⁄g›t
 = 
¨g
 + 1;

308 
¨g
 +
	`°æí
(arg);

310 i‡(!*
l⁄g›t
)

313 ; *
¨g
 || *
l⁄g›t
;Üongopt = "") {

314 
›t
 = *
¨g
;

315 i‡(
›t
)

316 
¨g
++;

317 i‡(
›t
 ='h' || o± ='?' || !
	`°rcmp
(
l⁄g›t
, "help")) {

318 
	`hñp
();

321 i‡(
›t
 ='e' || !
	`°rcmp
(
l⁄g›t
, "eval")) {

322 i‡(*
¨g
) {

323 
ex¥
 = 
¨g
;

326 i‡(
›töd
 < 
¨gc
) {

327 
ex¥
 = 
¨gv
[
›töd
++];

330 
	`Ârötf
(
°dîr
, "qjs: missingÉxpression for -e\n");

331 
	`exô
(2);

333 i‡(
›t
 ='I' || !
	`°rcmp
(
l⁄g›t
, "include")) {

334 i‡(
›töd
 >
¨gc
) {

335 
	`Ârötf
(
°dîr
, "expecting filename");

336 
	`exô
(1);

338 i‡(
ö˛ude_cou¡
 >
	`cou¡of
(
ö˛ude_li°
)) {

339 
	`Ârötf
(
°dîr
, "too many included files");

340 
	`exô
(1);

342 
ö˛ude_li°
[
ö˛ude_cou¡
++] = 
¨gv
[
›töd
++];

345 i‡(
›t
 ='i' || !
	`°rcmp
(
l⁄g›t
, "interactive")) {

346 
öãø˘ive
++;

349 i‡(
›t
 ='m' || !
	`°rcmp
(
l⁄g›t
, "module")) {

350 
moduÀ
 = 1;

353 i‡(!
	`°rcmp
(
l⁄g›t
, "script")) {

354 
moduÀ
 = 0;

357 i‡(
›t
 ='d' || !
	`°rcmp
(
l⁄g›t
, "dump")) {

358 
dump_mem‹y
++;

361 i‡(
›t
 ='T' || !
	`°rcmp
(
l⁄g›t
, "trace")) {

362 
åa˚_mem‹y
++;

365 i‡(!
	`°rcmp
(
l⁄g›t
, "std")) {

366 
lﬂd_°d
 = 1;

369 i‡(!
	`°rcmp
(
l⁄g›t
, "unhandled-rejection")) {

370 
dump_unh™dÀd_¥omi£_ªje˘i⁄
 = 1;

373 #ifde‡
CONFIG_BIGNUM


374 i‡(!
	`°rcmp
(
l⁄g›t
, "bignum")) {

375 
bignum_ext
 = 1;

378 i‡(!
	`°rcmp
(
l⁄g›t
, "qjscalc")) {

379 
lﬂd_jsˇlc
 = 1;

383 i‡(
›t
 ='q' || !
	`°rcmp
(
l⁄g›t
, "quit")) {

384 
em±y_run
++;

387 i‡(!
	`°rcmp
(
l⁄g›t
, "memory-limit")) {

388 i‡(
›töd
 >
¨gc
) {

389 
	`Ârötf
(
°dîr
, "expecting memoryÜimit");

390 
	`exô
(1);

392 
mem‹y_limô
 = (
size_t
)
	`°πod
(
¨gv
[
›töd
++], 
NULL
);

395 i‡(
›t
) {

396 
	`Ârötf
(
°dîr
, "qjs: unknow¿›ti⁄ '-%c'\n", 
›t
);

398 
	`Ârötf
(
°dîr
, "qjs: unknow¿›ti⁄ '--%s'\n", 
l⁄g›t
);

400 
	`hñp
();

404 i‡(
åa˚_mem‹y
) {

405 
	`js_åa˚_mÆloc_öô
(&
åa˚_d©a
);

406 
π
 = 
	`JS_NewRu¡ime2
(&
åa˚_mf
, &
åa˚_d©a
);

408 
π
 = 
	`JS_NewRu¡ime
();

410 i‡(!
π
) {

411 
	`Ârötf
(
°dîr
, "qjs: cannotállocate JSÑuntime\n");

412 
	`exô
(2);

414 i‡(
mem‹y_limô
 != 0)

415 
	`JS_SëMem‹yLimô
(
π
, 
mem‹y_limô
);

416 
˘x
 = 
	`JS_NewC⁄ãxt
(
π
);

417 i‡(!
˘x
) {

418 
	`Ârötf
(
°dîr
, "qjs: cannotállocate JS context\n");

419 
	`exô
(2);

422 #ifde‡
CONFIG_BIGNUM


423 i‡(
bignum_ext
 || 
lﬂd_jsˇlc
) {

424 
	`JS_AddI¡rösicBigFlﬂt
(
˘x
);

425 
	`JS_AddI¡rösicBigDecimÆ
(
˘x
);

426 
	`JS_AddI¡rösicO≥øt‹s
(
˘x
);

427 
	`JS_E«bÀBignumExt
(
˘x
, 
TRUE
);

432 
	`JS_SëModuÀLﬂdîFunc
(
π
, 
NULL
, 
js_moduÀ_lﬂdî
, NULL);

434 i‡(
dump_unh™dÀd_¥omi£_ªje˘i⁄
) {

435 
	`JS_SëHo°Promi£Reje˘i⁄Tøckî
(
π
, 
js_°d_¥omi£_ªje˘i⁄_åackî
,

436 
NULL
);

439 i‡(!
em±y_run
) {

440 #ifde‡
CONFIG_BIGNUM


441 i‡(
lﬂd_jsˇlc
) {

442 
	`js_°d_evÆ_bö¨y
(
˘x
, 
qjsc_qjsˇlc
, 
qjsc_qjsˇlc_size
, 0);

445 
	`js_°d_add_hñ≥rs
(
˘x
, 
¨gc
 - 
›töd
, 
¨gv
 + optind);

448 
	`js_öô_moduÀ_°d
(
˘x
, "std");

449 
	`js_öô_moduÀ_os
(
˘x
, "os");

452 i‡(
lﬂd_°d
) {

453 c⁄° *
°r
 = "import *ás std from 'std';\n"

457 
	`evÆ_buf
(
˘x
, 
°r
, 
	`°æí
(°r), "<öput>", 
JS_EVAL_TYPE_MODULE
);

460 
i
 = 0; i < 
ö˛ude_cou¡
; i++) {

461 i‡(
	`evÆ_fûe
(
˘x
, 
ö˛ude_li°
[
i
], 
moduÀ
))

462 
Áû
;

465 i‡(
ex¥
) {

466 i‡(
	`evÆ_buf
(
˘x
, 
ex¥
, 
	`°æí
(expr), "<cmdline>", 0))

467 
Áû
;

469 i‡(
›töd
 >
¨gc
) {

471 
öãø˘ive
 = 1;

473 c⁄° *
fûíame
;

474 
fûíame
 = 
¨gv
[
›töd
];

475 i‡(
	`evÆ_fûe
(
˘x
, 
fûíame
, 
moduÀ
))

476 
Áû
;

478 i‡(
öãø˘ive
) {

479 
	`js_°d_evÆ_bö¨y
(
˘x
, 
qjsc_ª∂
, 
qjsc_ª∂_size
, 0);

481 
	`js_°d_lo›
(
˘x
);

484 i‡(
dump_mem‹y
) {

485 
JSMem‹yUßge
 
°©s
;

486 
	`JS_CompuãMem‹yUßge
(
π
, &
°©s
);

487 
	`JS_DumpMem‹yUßge
(
°dout
, &
°©s
, 
π
);

489 
	`js_°d_‰ì_h™dÀrs
(
π
);

490 
	`JS_FªeC⁄ãxt
(
˘x
);

491 
	`JS_FªeRu¡ime
(
π
);

493 i‡(
em±y_run
 && 
dump_mem‹y
) {

494 
˛ock_t
 
t
[5];

495 
be°
[5];

496 
i
, 
j
;

497 
i
 = 0; i < 100; i++) {

498 
t
[0] = 
	`˛ock
();

499 
π
 = 
	`JS_NewRu¡ime
();

500 
t
[1] = 
	`˛ock
();

501 
˘x
 = 
	`JS_NewC⁄ãxt
(
π
);

502 
t
[2] = 
	`˛ock
();

503 
	`JS_FªeC⁄ãxt
(
˘x
);

504 
t
[3] = 
	`˛ock
();

505 
	`JS_FªeRu¡ime
(
π
);

506 
t
[4] = 
	`˛ock
();

507 
j
 = 4; j > 0; j--) {

508 
ms
 = 1000.0 * (
t
[
j
] -Å[j - 1]Ë/ 
CLOCKS_PER_SEC
;

509 i‡(
i
 =0 || 
be°
[
j
] > 
ms
)

510 
be°
[
j
] = 
ms
;

513 
	`¥ötf
("\nInstantiationÅimes (ms): %.3f = %.3f+%.3f+%.3f+%.3f\n",

514 
be°
[1] + best[2] + best[3] + best[4],

515 
be°
[1], best[2], best[3], best[4]);

518 
Áû
:

519 
	`js_°d_‰ì_h™dÀrs
(
π
);

520 
	`JS_FªeC⁄ãxt
(
˘x
);

521 
	`JS_FªeRu¡ime
(
π
);

523 
	}
}

	@quickjs-libc.c

28 
	#PATH_MAX
 4096

	)

30 
	~<«utûus/libccom∑t.h
>

31 
	~<«utûus/«ut_ty≥s.h
>

33 
	~<π/js/cutûs.h
>

34 
	~<π/js/li°.h
>

35 
	~<π/js/quickjs-libc.h
>

37 ** 
ívú⁄
;

39 
	$js_°d_dbuf_öô
(
JSC⁄ãxt
 *
˘x
, 
DynBuf
 *
s
)

41 
	`dbuf_öô2
(
s
, 
	`JS_GëRu¡ime
(
˘x
), (
DynBufRóŒocFunc
 *)
js_ªÆloc_π
);

42 
	}
}

51 
li°_hód
 
	mlök
;

52 
	mfd
;

53 
JSVÆue
 
	mrw_func
[2];

54 } 
	tJSOSRWH™dÀr
;

57 
li°_hód
 
	mlök
;

58 
	msig_num
;

59 
JSVÆue
 
	mfunc
;

60 } 
	tJSOSSig«lH™dÀr
;

63 
li°_hód
 
	mlök
;

64 
BOOL
 
	mhas_obje˘
;

65 
söt64_t
 
	mtimeout
;

66 
JSVÆue
 
	mfunc
;

67 } 
	tJSOSTimî
;

70 
li°_hód
 
	gos_rw_h™dÀrs
 = 
LIST_HEAD_INIT
(
os_rw_h™dÀrs
);

71 
li°_hód
 
	gos_sig«l_h™dÀrs
 = 
LIST_HEAD_INIT
(
os_sig«l_h™dÀrs
);

72 
li°_hód
 
	gos_timîs
 = 
LIST_HEAD_INIT
(
os_timîs
);

73 
uöt64_t
 
	gos_≥ndög_sig«ls
;

74 
	gevÆ_s¸ùt_ªcur£
;

75 (*
os_pﬁl_func
)(
JSC⁄ãxt
 *
˘x
);

77 
JSVÆue
 
	$js_¥ötf_öã∫Æ
(
JSC⁄ãxt
 *
˘x
,

78 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
, 
FILE
 *
Â
)

80 
fmtbuf
[32];

81 
uöt8_t
 
cbuf
[
UTF8_CHAR_LEN_MAX
+1];

82 
JSVÆue
 
ªs
;

83 
DynBuf
 
dbuf
;

84 c⁄° *
fmt_°r
;

85 c⁄° 
uöt8_t
 *
fmt
, *
fmt_íd
;

86 c⁄° 
uöt8_t
 *
p
;

87 *
q
;

88 
i
, 
c
, 
Àn
;

89 
size_t
 
fmt_Àn
;

90 
söt32_t
 
öt32_¨g
;

91 
söt64_t
 
öt64_¨g
;

92 
doubÀ_¨g
;

93 c⁄° *
°rög_¨g
;

94 íum { 
PART_FLAGS
, 
PART_WIDTH
, 
PART_DOT
, 
PART_PREC
, 
PART_MODIFIER
 } 
∑π
;

95 
modsize
;

97 (*
dbuf_¥ötf_fun
)(
DynBuf
 *
s
, c⁄° *
fmt
, ...Ë(*)
dbuf_¥ötf
;

99 
	`js_°d_dbuf_öô
(
˘x
, &
dbuf
);

101 i‡(
¨gc
 > 0) {

102 
fmt_°r
 = 
	`JS_ToCSåögLí
(
˘x
, &
fmt_Àn
, 
¨gv
[0]);

103 i‡(!
fmt_°r
)

104 
Áû
;

106 
i
 = 1;

107 
fmt
 = (c⁄° 
uöt8_t
 *)
fmt_°r
;

108 
fmt_íd
 = 
fmt
 + 
fmt_Àn
;

109 
fmt
 < 
fmt_íd
) {

110 
p
 = 
fmt
; fmà< 
fmt_íd
 && *fmt != '%'; fmt++)

112 
	`dbuf_put
(&
dbuf
, 
p
, 
fmt
 -Ö);

113 i‡(
fmt
 >
fmt_íd
)

115 
q
 = 
fmtbuf
;

116 *
q
++ = *
fmt
++;

117 
∑π
 = 
PART_FLAGS
;

118 
modsize
 = 0;

120 i‡(
q
 >
fmtbuf
 + (fmtbuf) - 1)

121 
övÆid
;

123 
c
 = *
fmt
++;

124 *
q
++ = 
c
;

125 *
q
 = '\0';

127 
c
) {

131 i‡(
∑π
 !
PART_PREC
) {

132 i‡(
∑π
 <
PART_WIDTH
)

133 
∑π
 = 
PART_WIDTH
;

135 
övÆid
;

140 i‡(
∑π
 > 
PART_FLAGS
)

141 
övÆid
;

145 i‡(
∑π
 > 
PART_DOT
)

146 
övÆid
;

147 
∑π
 = 
PART_DOT
;

151 i‡(
∑π
 < 
PART_WIDTH
)

152 
∑π
 = 
PART_DOT
;

153 i‡(
∑π
 =
PART_DOT
)

154 
∑π
 = 
PART_MODIFIER
;

156 
övÆid
;

158 i‡(
i
 >
¨gc
)

159 
missög
;

161 i‡(
	`JS_ToI¡32
(
˘x
, &
öt32_¨g
, 
¨gv
[
i
++]))

162 
Áû
;

163 
q
 +
	`¢¥ötf
(q, 
fmtbuf
 + (fmtbufË- q, "%d", 
öt32_¨g
);

167 i‡(
modsize
 != 0 && modsize != -1)

168 
övÆid
;

169 
modsize
--;

170 
∑π
 = 
PART_MODIFIER
;

173 
q
--;

174 i‡(
modsize
 != 0 && modsize != 1)

175 
övÆid
;

176 
modsize
++;

177 
∑π
 = 
PART_MODIFIER
;

181 i‡(
i
 >
¨gc
)

182 
missög
;

183 i‡(
	`JS_IsSåög
(
¨gv
[
i
])) {

184 
°rög_¨g
 = 
	`JS_ToCSåög
(
˘x
, 
¨gv
[
i
++]);

185 i‡(!
°rög_¨g
)

186 
Áû
;

187 
öt32_¨g
 = 
	`unicode_‰om_utf8
((
uöt8_t
 *)
°rög_¨g
, 
UTF8_CHAR_LEN_MAX
, &
p
);

188 
	`JS_FªeCSåög
(
˘x
, 
°rög_¨g
);

190 i‡(
	`JS_ToI¡32
(
˘x
, &
öt32_¨g
, 
¨gv
[
i
++]))

191 
Áû
;

194 i‡(()
öt32_¨g
 > 0x10FFFF)

195 
öt32_¨g
 = 0xFFFD;

197 
Àn
 = 
	`unicode_to_utf8
(
cbuf
, 
öt32_¨g
);

198 
	`dbuf_put
(&
dbuf
, 
cbuf
, 
Àn
);

207 i‡(
i
 >
¨gc
)

208 
missög
;

209 i‡(
	`JS_ToI¡64Ext
(
˘x
, &
öt64_¨g
, 
¨gv
[
i
++]))

210 
Áû
;

211 i‡(
modsize
 > 0) {

212 
q
[1] = q[-1];

213 
q
[-1] = q[0] = 'l';

214 
q
[2] = '\0';

215 
	`dbuf_¥ötf_fun
(&
dbuf
, 
fmtbuf
, ()
öt64_¨g
);

217 
	`dbuf_¥ötf_fun
(&
dbuf
, 
fmtbuf
, ()
öt64_¨g
);

222 i‡(
i
 >
¨gc
)

223 
missög
;

225 
°rög_¨g
 = 
	`JS_ToCSåög
(
˘x
, 
¨gv
[
i
++]);

226 i‡(!
°rög_¨g
)

227 
Áû
;

228 
	`dbuf_¥ötf_fun
(&
dbuf
, 
fmtbuf
, 
°rög_¨g
);

229 
	`JS_FªeCSåög
(
˘x
, 
°rög_¨g
);

240 i‡(
i
 >
¨gc
)

241 
missög
;

242 i‡(
	`JS_ToFlﬂt64
(
˘x
, &
doubÀ_¨g
, 
¨gv
[
i
++]))

243 
Áû
;

244 
	`dbuf_¥ötf_fun
(&
dbuf
, 
fmtbuf
, 
doubÀ_¨g
);

248 
	`dbuf_putc
(&
dbuf
, '%');

253 
övÆid
:

254 
	`JS_ThrowTy≥Eº‹
(
˘x
, "invalid conversion specifier in format string");

255 
Áû
;

256 
missög
:

257 
	`JS_ThrowRe„ªn˚Eº‹
(
˘x
, "missingárgument for conversion specifier");

258 
Áû
;

263 
	`JS_FªeCSåög
(
˘x
, 
fmt_°r
);

265 i‡(
dbuf
.
îr‹
) {

266 
ªs
 = 
	`JS_ThrowOutOfMem‹y
(
˘x
);

268 i‡(
Â
) {

269 
Àn
 = 
	`fwrôe
(
dbuf
.
buf
, 1, dbuf.
size
, 
Â
);

270 
ªs
 = 
	`JS_NewI¡32
(
˘x
, 
Àn
);

272 
ªs
 = 
	`JS_NewSåögLí
(
˘x
, (*)
dbuf
.
buf
, dbuf.
size
);

275 
	`dbuf_‰ì
(&
dbuf
);

276  
ªs
;

278 
Áû
:

279 
	`dbuf_‰ì
(&
dbuf
);

280  
JS_EXCEPTION
;

281 
	}
}

283 
uöt8_t
 *
	$js_lﬂd_fûe
(
JSC⁄ãxt
 *
˘x
, 
size_t
 *
pbuf_Àn
, c⁄° *
fûíame
)

285 
FILE
 *
f
;

286 
uöt8_t
 *
buf
;

287 
size_t
 
buf_Àn
;

288 
Ãë
;

290 
f
 = 
	`f›í
(
fûíame
, "rb");

291 i‡(!
f
)

292  
NULL
;

293 i‡(
	`f£ek
(
f
, 0, 
SEEK_END
) < 0)

294 
Áû
;

295 
Ãë
 = 
	`·ñl
(
f
);

296 i‡(
Ãë
 < 0)

297 
Áû
;

299 i‡(
Ãë
 =
LONG_MAX
) {

300 
î∫o
 = 
EISDIR
;

301 
Áû
;

303 
buf_Àn
 = 
Ãë
;

304 i‡(
	`f£ek
(
f
, 0, 
SEEK_SET
) < 0)

305 
Áû
;

306 i‡(
˘x
)

307 
buf
 = 
	`js_mÆloc
(
˘x
, 
buf_Àn
 + 1);

309 
buf
 = 
	`mÆloc
(
buf_Àn
 + 1);

310 i‡(!
buf
)

311 
Áû
;

312 i‡(
	`‰ód
(
buf
, 1, 
buf_Àn
, 
f
) != buf_len) {

313 
î∫o
 = 
EIO
;

314 i‡(
˘x
)

315 
	`js_‰ì
(
˘x
, 
buf
);

317 
	`‰ì
(
buf
);

318 
Áû
:

319 
	`f˛o£
(
f
);

320  
NULL
;

322 
buf
[
buf_Àn
] = '\0';

323 
	`f˛o£
(
f
);

324 *
pbuf_Àn
 = 
buf_Àn
;

325  
buf
;

326 
	}
}

329 
JSVÆue
 
	$js_lﬂdS¸ùt
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

330 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

332 
uöt8_t
 *
buf
;

333 c⁄° *
fûíame
;

334 
JSVÆue
 
ªt
;

335 
size_t
 
buf_Àn
;

337 
fûíame
 = 
	`JS_ToCSåög
(
˘x
, 
¨gv
[0]);

338 i‡(!
fûíame
)

339  
JS_EXCEPTION
;

340 
buf
 = 
	`js_lﬂd_fûe
(
˘x
, &
buf_Àn
, 
fûíame
);

341 i‡(!
buf
) {

342 
	`JS_ThrowRe„ªn˚Eº‹
(
˘x
, "couldÇŸÜﬂd '%s'", 
fûíame
);

343 
	`JS_FªeCSåög
(
˘x
, 
fûíame
);

344  
JS_EXCEPTION
;

346 
ªt
 = 
	`JS_EvÆ
(
˘x
, (*)
buf
, 
buf_Àn
, 
fûíame
,

347 
JS_EVAL_TYPE_GLOBAL
);

348 
	`js_‰ì
(
˘x
, 
buf
);

349 
	`JS_FªeCSåög
(
˘x
, 
fûíame
);

350  
ªt
;

351 
	}
}

354 
JSVÆue
 
	$js_°d_lﬂdFûe
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

355 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

357 
uöt8_t
 *
buf
;

358 c⁄° *
fûíame
;

359 
JSVÆue
 
ªt
;

360 
size_t
 
buf_Àn
;

362 
fûíame
 = 
	`JS_ToCSåög
(
˘x
, 
¨gv
[0]);

363 i‡(!
fûíame
)

364  
JS_EXCEPTION
;

365 
buf
 = 
	`js_lﬂd_fûe
(
˘x
, &
buf_Àn
, 
fûíame
);

366 
	`JS_FªeCSåög
(
˘x
, 
fûíame
);

367 i‡(!
buf
)

368  
JS_NULL
;

369 
ªt
 = 
	`JS_NewSåögLí
(
˘x
, (*)
buf
, 
buf_Àn
);

370 
	`js_‰ì
(
˘x
, 
buf
);

371  
ªt
;

372 
	}
}

374 
	gJSModuÀDef
 *(
	tJSInôModuÀFunc
)(
	tJSC⁄ãxt
 *
	t˘x
,

375 c⁄° *
	tmoduÀ_«me
);

378 #i‡
deföed
(
_WIN32
)

379 
JSModuÀDef
 *
	$js_moduÀ_lﬂdî_so
(
JSC⁄ãxt
 *
˘x
,

380 c⁄° *
moduÀ_«me
)

382 
	`JS_ThrowRe„ªn˚Eº‹
(
˘x
, "sharedÜibrary modulesáreÇot supported yet");

383  
NULL
;

384 
	}
}

386 
JSModuÀDef
 *
	$js_moduÀ_lﬂdî_so
(
JSC⁄ãxt
 *
˘x
,

387 c⁄° *
moduÀ_«me
)

389 
JSModuÀDef
 *
m
;

390 *
hd
;

391 
JSInôModuÀFunc
 *
öô
;

392 *
fûíame
;

394 i‡(!
	`°rchr
(
moduÀ_«me
, '/')) {

397 
fûíame
 = 
	`js_mÆloc
(
˘x
, 
	`°æí
(
moduÀ_«me
) + 2 + 1);

398 i‡(!
fûíame
)

399  
NULL
;

400 
	`°r˝y
(
fûíame
, "./");

401 
	`°r˝y
(
fûíame
 + 2, 
moduÀ_«me
);

403 
fûíame
 = (*)
moduÀ_«me
;

407 
hd
 = 
	`dl›í
(
fûíame
, 
RTLD_NOW
 | 
RTLD_LOCAL
);

408 i‡(
fûíame
 !
moduÀ_«me
)

409 
	`js_‰ì
(
˘x
, 
fûíame
);

410 i‡(!
hd
) {

411 
	`JS_ThrowRe„ªn˚Eº‹
(
˘x
, "couldÇotÜoad module filename '%s'ás sharedÜibrary",

412 
moduÀ_«me
);

413 
Áû
;

416 
öô
 = 
	`dlsym
(
hd
, "js_init_module");

417 i‡(!
öô
) {

418 
	`JS_ThrowRe„ªn˚Eº‹
(
˘x
, "couldÇotÜoad module filename '%s': js_init_moduleÇot found",

419 
moduÀ_«me
);

420 
Áû
;

423 
m
 = 
	`öô
(
˘x
, 
moduÀ_«me
);

424 i‡(!
m
) {

425 
	`JS_ThrowRe„ªn˚Eº‹
(
˘x
, "couldÇotÜoad module filename '%s': initializationÉrror",

426 
moduÀ_«me
);

427 
Áû
:

428 i‡(
hd
)

429 
	`dl˛o£
(
hd
);

430  
NULL
;

432  
m
;

433 
	}
}

436 
	$js_moduÀ_£t_imp‹t_mëa
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
func_vÆ
,

437 
JS_BOOL
 
u£_ªÆ∑th
, JS_BOOL 
is_maö
)

439 
JSModuÀDef
 *
m
;

440 
buf
[
PATH_MAX
 + 16];

441 
JSVÆue
 
mëa_obj
;

442 
JSAtom
 
moduÀ_«me_©om
;

443 c⁄° *
moduÀ_«me
;

445 
	`as£π
(
	`JS_VALUE_GET_TAG
(
func_vÆ
Ë=
JS_TAG_MODULE
);

446 
m
 = 
	`JS_VALUE_GET_PTR
(
func_vÆ
);

448 
moduÀ_«me_©om
 = 
	`JS_GëModuÀName
(
˘x
, 
m
);

449 
moduÀ_«me
 = 
	`JS_AtomToCSåög
(
˘x
, 
moduÀ_«me_©om
);

450 
	`JS_FªeAtom
(
˘x
, 
moduÀ_«me_©om
);

451 i‡(!
moduÀ_«me
)

453 i‡(!
	`°rchr
(
moduÀ_«me
, ':')) {

454 
	`°r˝y
(
buf
, "file://");

455 #i‡!
	`deföed
(
_WIN32
)

459 i‡(
u£_ªÆ∑th
) {

460 *
ªs
 = 
	`ªÆ∑th
(
moduÀ_«me
, 
buf
 + 
	`°æí
(buf));

461 i‡(!
ªs
) {

462 
	`JS_ThrowTy≥Eº‹
(
˘x
, "realpath failure");

463 
	`JS_FªeCSåög
(
˘x
, 
moduÀ_«me
);

469 
	`p°rˇt
(
buf
, (buf), 
moduÀ_«me
);

472 
	`p°r˝y
(
buf
, (buf), 
moduÀ_«me
);

474 
	`JS_FªeCSåög
(
˘x
, 
moduÀ_«me
);

476 
mëa_obj
 = 
	`JS_GëImp‹tMëa
(
˘x
, 
m
);

477 i‡(
	`JS_IsEx˚±i⁄
(
mëa_obj
))

479 
	`JS_DeföePr›îtyVÆueSå
(
˘x
, 
mëa_obj
, "url",

480 
	`JS_NewSåög
(
˘x
, 
buf
),

481 
JS_PROP_C_W_E
);

482 
	`JS_DeföePr›îtyVÆueSå
(
˘x
, 
mëa_obj
, "main",

483 
	`JS_NewBoﬁ
(
˘x
, 
is_maö
),

484 
JS_PROP_C_W_E
);

485 
	`JS_FªeVÆue
(
˘x
, 
mëa_obj
);

487 
	}
}

489 
JSModuÀDef
 *
	$js_moduÀ_lﬂdî
(
JSC⁄ãxt
 *
˘x
,

490 c⁄° *
moduÀ_«me
, *
›aque
)

492 
JSModuÀDef
 *
m
;

494 i‡(
	`has_suffix
(
moduÀ_«me
, ".so")) {

495 
m
 = 
	`js_moduÀ_lﬂdî_so
(
˘x
, 
moduÀ_«me
);

497 
size_t
 
buf_Àn
;

498 
uöt8_t
 *
buf
;

499 
JSVÆue
 
func_vÆ
;

501 
buf
 = 
	`js_lﬂd_fûe
(
˘x
, &
buf_Àn
, 
moduÀ_«me
);

502 i‡(!
buf
) {

503 
	`JS_ThrowRe„ªn˚Eº‹
(
˘x
, "couldÇotÜoad module filename '%s'",

504 
moduÀ_«me
);

505  
NULL
;

509 
func_vÆ
 = 
	`JS_EvÆ
(
˘x
, (*)
buf
, 
buf_Àn
, 
moduÀ_«me
,

510 
JS_EVAL_TYPE_MODULE
 | 
JS_EVAL_FLAG_COMPILE_ONLY
);

511 
	`js_‰ì
(
˘x
, 
buf
);

512 i‡(
	`JS_IsEx˚±i⁄
(
func_vÆ
))

513  
NULL
;

515 
	`js_moduÀ_£t_imp‹t_mëa
(
˘x
, 
func_vÆ
, 
TRUE
, 
FALSE
);

517 
m
 = 
	`JS_VALUE_GET_PTR
(
func_vÆ
);

518 
	`JS_FªeVÆue
(
˘x
, 
func_vÆ
);

520  
m
;

521 
	}
}

523 
JSVÆue
 
	$js_°d_exô
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

524 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

526 
°©us
;

527 i‡(
	`JS_ToI¡32
(
˘x
, &
°©us
, 
¨gv
[0]))

528 
°©us
 = -1;

529 
	`exô
(
°©us
);

530  
JS_UNDEFINED
;

531 
	}
}

533 
JSVÆue
 
	$js_°d_gëív
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

534 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

536 c⁄° *
«me
, *
°r
;

537 
«me
 = 
	`JS_ToCSåög
(
˘x
, 
¨gv
[0]);

538 i‡(!
«me
)

539  
JS_EXCEPTION
;

540 
°r
 = 
	`gëív
(
«me
);

541 
	`JS_FªeCSåög
(
˘x
, 
«me
);

542 i‡(!
°r
)

543  
JS_UNDEFINED
;

545  
	`JS_NewSåög
(
˘x
, 
°r
);

546 
	}
}

548 
JSVÆue
 
	$js_°d_gc
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

549 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

551 
	`JS_RunGC
(
	`JS_GëRu¡ime
(
˘x
));

552  
JS_UNDEFINED
;

553 
	}
}

555 
	$öãºu±_h™dÀr
(
JSRu¡ime
 *
π
, *
›aque
)

557  (
os_≥ndög_sig«ls
 >> 
SIGINT
) & 1;

558 
	}
}

560 
	$gë_boﬁ_›ti⁄
(
JSC⁄ãxt
 *
˘x
, 
BOOL
 *
pboﬁ
,

561 
JSVÆueC⁄°
 
obj
,

562 c⁄° *
›ti⁄
)

564 
JSVÆue
 
vÆ
;

565 
vÆ
 = 
	`JS_GëPr›îtySå
(
˘x
, 
obj
, 
›ti⁄
);

566 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

568 i‡(!
	`JS_IsUndeföed
(
vÆ
)) {

569 *
pboﬁ
 = 
	`JS_ToBoﬁ
(
˘x
, 
vÆ
);

571 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

573 
	}
}

575 
JSVÆue
 
	$js_evÆS¸ùt
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

576 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

578 c⁄° *
°r
;

579 
size_t
 
Àn
;

580 
JSVÆue
 
ªt
;

581 
JSVÆueC⁄°
 
›ti⁄s_obj
;

582 
BOOL
 
backåa˚_b¨rõr
 = 
FALSE
;

583 
Êags
;

585 i‡(
¨gc
 >= 2) {

586 
›ti⁄s_obj
 = 
¨gv
[1];

587 i‡(
	`gë_boﬁ_›ti⁄
(
˘x
, &
backåa˚_b¨rõr
, 
›ti⁄s_obj
,

589  
JS_EXCEPTION
;

592 
°r
 = 
	`JS_ToCSåögLí
(
˘x
, &
Àn
, 
¨gv
[0]);

593 i‡(!
°r
)

594  
JS_EXCEPTION
;

595 i‡(++
evÆ_s¸ùt_ªcur£
 == 1) {

597 
	`JS_SëI¡îru±H™dÀr
(
	`JS_GëRu¡ime
(
˘x
), 
öãºu±_h™dÀr
, 
NULL
);

599 
Êags
 = 
JS_EVAL_TYPE_GLOBAL
;

600 i‡(
backåa˚_b¨rõr
)

601 
Êags
 |
JS_EVAL_FLAG_BACKTRACE_BARRIER
;

602 
ªt
 = 
	`JS_EvÆ
(
˘x
, 
°r
, 
Àn
, "<evÆS¸ùt>", 
Êags
);

603 
	`JS_FªeCSåög
(
˘x
, 
°r
);

604 i‡(--
evÆ_s¸ùt_ªcur£
 == 0) {

606 
	`JS_SëI¡îru±H™dÀr
(
	`JS_GëRu¡ime
(
˘x
), 
NULL
, NULL);

607 
os_≥ndög_sig«ls
 &~((
uöt64_t
)1 << 
SIGINT
);

610 i‡(
	`JS_IsEx˚±i⁄
(
ªt
))

611 
	`JS_Re£tUnˇtchabÀEº‹
(
˘x
);

613  
ªt
;

614 
	}
}

616 
JSCœssID
 
	gjs_°d_fûe_˛ass_id
;

619 
FILE
 *
	mf
;

620 
BOOL
 
	m˛o£_ö_föÆizî
;

621 
BOOL
 
	mis_p›í
;

622 } 
	tJSSTDFûe
;

624 
	$js_°d_fûe_föÆizî
(
JSRu¡ime
 *
π
, 
JSVÆue
 
vÆ
)

626 
JSSTDFûe
 *
s
 = 
	`JS_GëO∑que
(
vÆ
, 
js_°d_fûe_˛ass_id
);

627 i‡(
s
) {

628 i‡(
s
->
f
 && s->
˛o£_ö_föÆizî
) {

629 i‡(
s
->
is_p›í
)

630 
	`p˛o£
(
s
->
f
);

632 
	`f˛o£
(
s
->
f
);

634 
	`js_‰ì_π
(
π
, 
s
);

636 
	}
}

638 
ssize_t
 
	$js_gë_î∫o
(
ssize_t
 
ªt
)

640 i‡(
ªt
 == -1)

641 
ªt
 = -
î∫o
;

642  
ªt
;

643 
	}
}

645 
JSVÆue
 
	$js_°d_°ªº‹
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

646 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

648 
îr
;

649 i‡(
	`JS_ToI¡32
(
˘x
, &
îr
, 
¨gv
[0]))

650  
JS_EXCEPTION
;

651  
	`JS_NewSåög
(
˘x
, 
	`°ªº‹
(
îr
));

652 
	}
}

654 
JSVÆue
 
	$js_√w_°d_fûe
(
JSC⁄ãxt
 *
˘x
, 
FILE
 *
f
,

655 
BOOL
 
˛o£_ö_föÆizî
,

656 
BOOL
 
is_p›í
)

658 
JSSTDFûe
 *
s
;

659 
JSVÆue
 
obj
;

660 
obj
 = 
	`JS_NewObje˘Cœss
(
˘x
, 
js_°d_fûe_˛ass_id
);

661 i‡(
	`JS_IsEx˚±i⁄
(
obj
))

662  
obj
;

663 
s
 = 
	`js_mÆlocz
(
˘x
, (*s));

664 i‡(!
s
) {

665 
	`JS_FªeVÆue
(
˘x
, 
obj
);

666  
JS_EXCEPTION
;

668 
s
->
˛o£_ö_föÆizî
 = close_in_finalizer;

669 
s
->
is_p›í
 = is_popen;

670 
s
->
f
 = f;

671 
	`JS_SëO∑que
(
obj
, 
s
);

672  
obj
;

673 
	}
}

675 
	$js_£t_îr‹_obje˘
(
JSC⁄ãxt
 *
˘x
, 
JSVÆue
 
obj
, 
îr
)

677 i‡(!
	`JS_IsUndeföed
(
obj
)) {

678 
	`JS_SëPr›îtySå
(
˘x
, 
obj
, "î∫o", 
	`JS_NewI¡32
(˘x, 
îr
));

680 
	}
}

682 
JSVÆue
 
	$js_°d_›í
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

683 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

685 c⁄° *
fûíame
, *
mode
 = 
NULL
;

686 
FILE
 *
f
;

687 
îr
;

689 
fûíame
 = 
	`JS_ToCSåög
(
˘x
, 
¨gv
[0]);

690 i‡(!
fûíame
)

691 
Áû
;

692 
mode
 = 
	`JS_ToCSåög
(
˘x
, 
¨gv
[1]);

693 i‡(!
mode
)

694 
Áû
;

695 i‡(
mode
[
	`°r•n
(mode, "rwa+b")] != '\0') {

696 
	`JS_ThrowTy≥Eº‹
(
˘x
, "invalid file mode");

697 
Áû
;

700 
f
 = 
	`f›í
(
fûíame
, 
mode
);

701 i‡(!
f
)

702 
îr
 = 
î∫o
;

704 
îr
 = 0;

705 i‡(
¨gc
 >= 3)

706 
	`js_£t_îr‹_obje˘
(
˘x
, 
¨gv
[2], 
îr
);

707 
	`JS_FªeCSåög
(
˘x
, 
fûíame
);

708 
	`JS_FªeCSåög
(
˘x
, 
mode
);

709 i‡(!
f
)

710  
JS_NULL
;

711  
	`js_√w_°d_fûe
(
˘x
, 
f
, 
TRUE
, 
FALSE
);

712 
Áû
:

713 
	`JS_FªeCSåög
(
˘x
, 
fûíame
);

714 
	`JS_FªeCSåög
(
˘x
, 
mode
);

715  
JS_EXCEPTION
;

716 
	}
}

718 
JSVÆue
 
	$js_°d_p›í
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

719 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

721 c⁄° *
fûíame
, *
mode
 = 
NULL
;

722 
FILE
 *
f
;

723 
îr
;

725 
fûíame
 = 
	`JS_ToCSåög
(
˘x
, 
¨gv
[0]);

726 i‡(!
fûíame
)

727 
Áû
;

728 
mode
 = 
	`JS_ToCSåög
(
˘x
, 
¨gv
[1]);

729 i‡(!
mode
)

730 
Áû
;

731 i‡(
mode
[
	`°r•n
(mode, "rw")] != '\0') {

732 
	`JS_ThrowTy≥Eº‹
(
˘x
, "invalid file mode");

733 
Áû
;

736 
f
 = 
	`p›í
(
fûíame
, 
mode
);

737 i‡(!
f
)

738 
îr
 = 
î∫o
;

740 
îr
 = 0;

741 i‡(
¨gc
 >= 3)

742 
	`js_£t_îr‹_obje˘
(
˘x
, 
¨gv
[2], 
îr
);

743 
	`JS_FªeCSåög
(
˘x
, 
fûíame
);

744 
	`JS_FªeCSåög
(
˘x
, 
mode
);

745 i‡(!
f
)

746  
JS_NULL
;

747  
	`js_√w_°d_fûe
(
˘x
, 
f
, 
TRUE
, TRUE);

748 
Áû
:

749 
	`JS_FªeCSåög
(
˘x
, 
fûíame
);

750 
	`JS_FªeCSåög
(
˘x
, 
mode
);

751  
JS_EXCEPTION
;

752 
	}
}

754 
JSVÆue
 
	$js_°d_fd›í
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

755 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

757 c⁄° *
mode
;

758 
FILE
 *
f
;

759 
fd
, 
îr
;

761 i‡(
	`JS_ToI¡32
(
˘x
, &
fd
, 
¨gv
[0]))

762  
JS_EXCEPTION
;

763 
mode
 = 
	`JS_ToCSåög
(
˘x
, 
¨gv
[1]);

764 i‡(!
mode
)

765 
Áû
;

766 i‡(
mode
[
	`°r•n
(mode, "rwa+")] != '\0') {

767 
	`JS_ThrowTy≥Eº‹
(
˘x
, "invalid file mode");

768 
Áû
;

771 
f
 = 
	`fd›í
(
fd
, 
mode
);

772 i‡(!
f
)

773 
îr
 = 
î∫o
;

775 
îr
 = 0;

776 i‡(
¨gc
 >= 3)

777 
	`js_£t_îr‹_obje˘
(
˘x
, 
¨gv
[2], 
îr
);

778 
	`JS_FªeCSåög
(
˘x
, 
mode
);

779 i‡(!
f
)

780  
JS_NULL
;

781  
	`js_√w_°d_fûe
(
˘x
, 
f
, 
TRUE
, 
FALSE
);

782 
Áû
:

783 
	`JS_FªeCSåög
(
˘x
, 
mode
);

784  
JS_EXCEPTION
;

785 
	}
}

787 
JSVÆue
 
	$js_°d_tmpfûe
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

788 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

790 
FILE
 *
f
;

791 
f
 = 
	`tmpfûe
();

792 i‡(
¨gc
 >= 1)

793 
	`js_£t_îr‹_obje˘
(
˘x
, 
¨gv
[0], 
f
 ? 0 : 
î∫o
);

794 i‡(!
f
)

795  
JS_NULL
;

796  
	`js_√w_°d_fûe
(
˘x
, 
f
, 
TRUE
, 
FALSE
);

797 
	}
}

799 
JSVÆue
 
	$js_°d_•rötf
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

800 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

802  
	`js_¥ötf_öã∫Æ
(
˘x
, 
¨gc
, 
¨gv
, 
NULL
);

803 
	}
}

805 
JSVÆue
 
	$js_°d_¥ötf
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

806 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

808  
	`js_¥ötf_öã∫Æ
(
˘x
, 
¨gc
, 
¨gv
, 
°dout
);

809 
	}
}

811 
FILE
 *
	$js_°d_fûe_gë
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
obj
)

813 
JSSTDFûe
 *
s
 = 
	`JS_GëO∑que2
(
˘x
, 
obj
, 
js_°d_fûe_˛ass_id
);

814 i‡(!
s
)

815  
NULL
;

816 i‡(!
s
->
f
) {

817 
	`JS_ThrowTy≥Eº‹
(
˘x
, "invalid file handle");

818  
NULL
;

820  
s
->
f
;

821 
	}
}

823 
JSVÆue
 
	$js_°d_fûe_puts
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

824 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
, 
magic
)

826 
FILE
 *
f
;

827 
i
;

828 c⁄° *
°r
;

829 
size_t
 
Àn
;

831 i‡(
magic
 == 0) {

832 
f
 = 
°dout
;

834 
f
 = 
	`js_°d_fûe_gë
(
˘x
, 
this_vÆ
);

835 i‡(!
f
)

836  
JS_EXCEPTION
;

839 
i
 = 0; i < 
¨gc
; i++) {

840 
°r
 = 
	`JS_ToCSåögLí
(
˘x
, &
Àn
, 
¨gv
[
i
]);

841 i‡(!
°r
)

842  
JS_EXCEPTION
;

843 
	`fwrôe
(
°r
, 1, 
Àn
, 
f
);

844 
	`JS_FªeCSåög
(
˘x
, 
°r
);

846  
JS_UNDEFINED
;

847 
	}
}

849 
JSVÆue
 
	$js_°d_fûe_˛o£
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

850 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

852 
JSSTDFûe
 *
s
 = 
	`JS_GëO∑que2
(
˘x
, 
this_vÆ
, 
js_°d_fûe_˛ass_id
);

853 
îr
;

854 i‡(!
s
)

855  
JS_EXCEPTION
;

856 i‡(!
s
->
f
)

857  
	`JS_ThrowTy≥Eº‹
(
˘x
, "invalid file handle");

858 i‡(
s
->
is_p›í
)

859 
îr
 = 
	`js_gë_î∫o
(
	`p˛o£
(
s
->
f
));

861 
îr
 = 
	`js_gë_î∫o
(
	`f˛o£
(
s
->
f
));

862 
s
->
f
 = 
NULL
;

863  
	`JS_NewI¡32
(
˘x
, 
îr
);

864 
	}
}

866 
JSVÆue
 
	$js_°d_fûe_¥ötf
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

867 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

869 
FILE
 *
f
 = 
	`js_°d_fûe_gë
(
˘x
, 
this_vÆ
);

870 i‡(!
f
)

871  
JS_EXCEPTION
;

872  
	`js_¥ötf_öã∫Æ
(
˘x
, 
¨gc
, 
¨gv
, 
f
);

873 
	}
}

875 
JSVÆue
 
	$js_°d_fûe_Êush
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

876 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

878 
FILE
 *
f
 = 
	`js_°d_fûe_gë
(
˘x
, 
this_vÆ
);

879 i‡(!
f
)

880  
JS_EXCEPTION
;

881 
	`fÊush
(
f
);

882  
JS_UNDEFINED
;

883 
	}
}

885 
JSVÆue
 
	$js_°d_fûe_ãŒ
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

886 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
, 
is_bigöt
)

888 
FILE
 *
f
 = 
	`js_°d_fûe_gë
(
˘x
, 
this_vÆ
);

889 
söt64_t
 
pos
;

890 i‡(!
f
)

891  
JS_EXCEPTION
;

892 #i‡
	`deföed
(
__löux__
)

893 
pos
 = 
	`·ñlo
(
f
);

895 
pos
 = 
	`·ñl
(
f
);

897 i‡(
is_bigöt
)

898  
	`JS_NewBigI¡64
(
˘x
, 
pos
);

900  
	`JS_NewI¡64
(
˘x
, 
pos
);

901 
	}
}

903 
JSVÆue
 
	$js_°d_fûe_£ek
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

904 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

906 
FILE
 *
f
 = 
	`js_°d_fûe_gë
(
˘x
, 
this_vÆ
);

907 
söt64_t
 
pos
;

908 
whí˚
, 
ªt
;

909 i‡(!
f
)

910  
JS_EXCEPTION
;

911 i‡(
	`JS_ToI¡64Ext
(
˘x
, &
pos
, 
¨gv
[0]))

912  
JS_EXCEPTION
;

913 i‡(
	`JS_ToI¡32
(
˘x
, &
whí˚
, 
¨gv
[1]))

914  
JS_EXCEPTION
;

915 #i‡
	`deföed
(
__löux__
)

916 
ªt
 = 
	`f£eko
(
f
, 
pos
, 
whí˚
);

918 
ªt
 = 
	`f£ek
(
f
, 
pos
, 
whí˚
);

920 i‡(
ªt
 < 0)

921 
ªt
 = -
î∫o
;

922  
	`JS_NewI¡32
(
˘x
, 
ªt
);

923 
	}
}

925 
JSVÆue
 
	$js_°d_fûe_eof
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

926 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

928 
FILE
 *
f
 = 
	`js_°d_fûe_gë
(
˘x
, 
this_vÆ
);

929 i‡(!
f
)

930  
JS_EXCEPTION
;

931  
	`JS_NewBoﬁ
(
˘x
, 
	`„of
(
f
));

932 
	}
}

934 
JSVÆue
 
	$js_°d_fûe_îr‹
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

935 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

937 
FILE
 *
f
 = 
	`js_°d_fûe_gë
(
˘x
, 
this_vÆ
);

938 i‡(!
f
)

939  
JS_EXCEPTION
;

940  
	`JS_NewBoﬁ
(
˘x
, 
	`„º‹
(
f
));

941 
	}
}

943 
JSVÆue
 
	$js_°d_fûe_˛óªº
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

944 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

946 
FILE
 *
f
 = 
	`js_°d_fûe_gë
(
˘x
, 
this_vÆ
);

947 i‡(!
f
)

948  
JS_EXCEPTION
;

949 
	`˛óªº
(
f
);

950  
JS_UNDEFINED
;

951 
	}
}

953 
JSVÆue
 
	$js_°d_fûe_fûío
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

954 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

956 
FILE
 *
f
 = 
	`js_°d_fûe_gë
(
˘x
, 
this_vÆ
);

957 i‡(!
f
)

958  
JS_EXCEPTION
;

959  
	`JS_NewI¡32
(
˘x
, 
	`fûío
(
f
));

960 
	}
}

962 
JSVÆue
 
	$js_°d_fûe_ªad_wrôe
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

963 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
, 
magic
)

965 
FILE
 *
f
 = 
	`js_°d_fûe_gë
(
˘x
, 
this_vÆ
);

966 
uöt64_t
 
pos
, 
Àn
;

967 
size_t
 
size
, 
ªt
;

968 
uöt8_t
 *
buf
;

970 i‡(!
f
)

971  
JS_EXCEPTION
;

972 i‡(
	`JS_ToIndex
(
˘x
, &
pos
, 
¨gv
[1]))

973  
JS_EXCEPTION
;

974 i‡(
	`JS_ToIndex
(
˘x
, &
Àn
, 
¨gv
[2]))

975  
JS_EXCEPTION
;

976 
buf
 = 
	`JS_GëAºayBuf„r
(
˘x
, &
size
, 
¨gv
[0]);

977 i‡(!
buf
)

978  
JS_EXCEPTION
;

979 i‡(
pos
 + 
Àn
 > 
size
)

980  
	`JS_ThrowR™geEº‹
(
˘x
, "read/writeárray buffer overflow");

981 i‡(
magic
)

982 
ªt
 = 
	`fwrôe
(
buf
 + 
pos
, 1, 
Àn
, 
f
);

984 
ªt
 = 
	`‰ód
(
buf
 + 
pos
, 1, 
Àn
, 
f
);

985  
	`JS_NewI¡64
(
˘x
, 
ªt
);

986 
	}
}

989 
JSVÆue
 
	$js_°d_fûe_gëlöe
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

990 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

992 
FILE
 *
f
 = 
	`js_°d_fûe_gë
(
˘x
, 
this_vÆ
);

993 
c
;

994 
DynBuf
 
dbuf
;

995 
JSVÆue
 
obj
;

997 i‡(!
f
)

998  
JS_EXCEPTION
;

1000 
	`js_°d_dbuf_öô
(
˘x
, &
dbuf
);

1002 
c
 = 
	`fgëc
(
f
);

1003 i‡(
c
 =
EOF
) {

1004 i‡(
dbuf
.
size
 == 0) {

1006 
	`dbuf_‰ì
(&
dbuf
);

1007  
JS_NULL
;

1012 i‡(
c
 == '\n')

1014 i‡(
	`dbuf_putc
(&
dbuf
, 
c
)) {

1015 
	`dbuf_‰ì
(&
dbuf
);

1016  
	`JS_ThrowOutOfMem‹y
(
˘x
);

1019 
obj
 = 
	`JS_NewSåögLí
(
˘x
, (c⁄° *)
dbuf
.
buf
, dbuf.
size
);

1020 
	`dbuf_‰ì
(&
dbuf
);

1021  
obj
;

1022 
	}
}

1025 
JSVÆue
 
	$js_°d_fûe_ªadAsSåög
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

1026 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

1028 
FILE
 *
f
 = 
	`js_°d_fûe_gë
(
˘x
, 
this_vÆ
);

1029 
c
;

1030 
DynBuf
 
dbuf
;

1031 
JSVÆue
 
obj
;

1032 
uöt64_t
 
max_size64
;

1033 
size_t
 
max_size
;

1034 
JSVÆueC⁄°
 
max_size_vÆ
;

1036 i‡(!
f
)

1037  
JS_EXCEPTION
;

1039 i‡(
¨gc
 >= 1)

1040 
max_size_vÆ
 = 
¨gv
[0];

1042 
max_size_vÆ
 = 
JS_UNDEFINED
;

1043 
max_size
 = (
size_t
)-1;

1044 i‡(!
	`JS_IsUndeföed
(
max_size_vÆ
)) {

1045 i‡(
	`JS_ToIndex
(
˘x
, &
max_size64
, 
max_size_vÆ
))

1046  
JS_EXCEPTION
;

1047 i‡(
max_size64
 < 
max_size
)

1048 
max_size
 = 
max_size64
;

1051 
	`js_°d_dbuf_öô
(
˘x
, &
dbuf
);

1052 
max_size
 != 0) {

1053 
c
 = 
	`fgëc
(
f
);

1054 i‡(
c
 =
EOF
)

1056 i‡(
	`dbuf_putc
(&
dbuf
, 
c
)) {

1057 
	`dbuf_‰ì
(&
dbuf
);

1058  
JS_EXCEPTION
;

1060 
max_size
--;

1062 
obj
 = 
	`JS_NewSåögLí
(
˘x
, (c⁄° *)
dbuf
.
buf
, dbuf.
size
);

1063 
	`dbuf_‰ì
(&
dbuf
);

1064  
obj
;

1065 
	}
}

1067 
JSVÆue
 
	$js_°d_fûe_gëByã
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

1068 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

1070 
FILE
 *
f
 = 
	`js_°d_fûe_gë
(
˘x
, 
this_vÆ
);

1071 i‡(!
f
)

1072  
JS_EXCEPTION
;

1073  
	`JS_NewI¡32
(
˘x
, 
	`fgëc
(
f
));

1074 
	}
}

1076 
JSVÆue
 
	$js_°d_fûe_putByã
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

1077 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

1079 
FILE
 *
f
 = 
	`js_°d_fûe_gë
(
˘x
, 
this_vÆ
);

1080 
c
;

1081 i‡(!
f
)

1082  
JS_EXCEPTION
;

1083 i‡(
	`JS_ToI¡32
(
˘x
, &
c
, 
¨gv
[0]))

1084  
JS_EXCEPTION
;

1085 
c
 = 
	`Âutc
(c, 
f
);

1086  
	`JS_NewI¡32
(
˘x
, 
c
);

1087 
	}
}

1091 
	#URL_GET_PROGRAM
 "cuæ -†-i"

	)

1092 
	#URL_GET_BUF_SIZE
 4096

	)

1094 
	$hâp_gë_hódî_löe
(
FILE
 *
f
, *
buf
, 
size_t
 
buf_size
,

1095 
DynBuf
 *
dbuf
)

1097 
c
;

1098 *
p
;

1100 
p
 = 
buf
;

1102 
c
 = 
	`fgëc
(
f
);

1103 i‡(
c
 < 0)

1105 i‡((
p
 - 
buf
Ë< 
buf_size
 - 1)

1106 *
p
++ = 
c
;

1107 i‡(
dbuf
)

1108 
	`dbuf_putc
(
dbuf
, 
c
);

1109 i‡(
c
 == '\n')

1112 *
p
 = '\0';

1114 
	}
}

1116 
	$hâp_gë_°©us
(c⁄° *
buf
)

1118 c⁄° *
p
 = 
buf
;

1119 *
p
 != ' ' && *p != '\0')

1120 
p
++;

1121 i‡(*
p
 != ' ')

1123 *
p
 == ' ')

1124 
p
++;

1125  
	`©oi
(
p
);

1126 
	}
}

1128 
JSVÆue
 
	$js_°d_uæGë
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

1129 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

1131 c⁄° *
uæ
;

1132 
DynBuf
 
cmd_buf
;

1133 
DynBuf
 
d©a_buf_s
, *
d©a_buf
 = &data_buf_s;

1134 
DynBuf
 
hódî_buf_s
, *
hódî_buf
 = &header_buf_s;

1135 *
buf
;

1136 
size_t
 
i
, 
Àn
;

1137 
c
, 
°©us
;

1138 
JSVÆue
 
ª•⁄£
 = 
JS_UNDEFINED
, 
ªt_obj
;

1139 
JSVÆueC⁄°
 
›ti⁄s_obj
;

1140 
FILE
 *
f
;

1141 
BOOL
 
bö¨y_Êag
, 
fuŒ_Êag
;

1143 
uæ
 = 
	`JS_ToCSåög
(
˘x
, 
¨gv
[0]);

1144 i‡(!
uæ
)

1145  
JS_EXCEPTION
;

1147 
bö¨y_Êag
 = 
FALSE
;

1148 
fuŒ_Êag
 = 
FALSE
;

1150 i‡(
¨gc
 >= 2) {

1151 
›ti⁄s_obj
 = 
¨gv
[1];

1153 i‡(
	`gë_boﬁ_›ti⁄
(
˘x
, &
bö¨y_Êag
, 
›ti⁄s_obj
, "binary"))

1154 
Áû_obj
;

1156 i‡(
	`gë_boﬁ_›ti⁄
(
˘x
, &
fuŒ_Êag
, 
›ti⁄s_obj
, "full")) {

1157 
Áû_obj
:

1158 
	`JS_FªeCSåög
(
˘x
, 
uæ
);

1159  
JS_EXCEPTION
;

1163 
	`js_°d_dbuf_öô
(
˘x
, &
cmd_buf
);

1164 
	`dbuf_¥ötf
(&
cmd_buf
, "%†''", 
URL_GET_PROGRAM
);

1165 
Àn
 = 
	`°æí
(
uæ
);

1166 
i
 = 0; i < 
Àn
; i++) {

1167 
c
 = 
uæ
[
i
];

1168 i‡(
c
 == '\'' || c == '\\')

1169 
	`dbuf_putc
(&
cmd_buf
, '\\');

1170 
	`dbuf_putc
(&
cmd_buf
, 
c
);

1172 
	`JS_FªeCSåög
(
˘x
, 
uæ
);

1173 
	`dbuf_put°r
(&
cmd_buf
, "''");

1174 
	`dbuf_putc
(&
cmd_buf
, '\0');

1175 i‡(
	`dbuf_îr‹
(&
cmd_buf
)) {

1176 
	`dbuf_‰ì
(&
cmd_buf
);

1177  
JS_EXCEPTION
;

1180 
f
 = 
	`p›í
((*)
cmd_buf
.
buf
, "r");

1181 
	`dbuf_‰ì
(&
cmd_buf
);

1182 i‡(!
f
) {

1183  
	`JS_ThrowTy≥Eº‹
(
˘x
, "couldÇot start curl");

1186 
	`js_°d_dbuf_öô
(
˘x
, 
d©a_buf
);

1187 
	`js_°d_dbuf_öô
(
˘x
, 
hódî_buf
);

1189 
buf
 = 
	`js_mÆloc
(
˘x
, 
URL_GET_BUF_SIZE
);

1190 i‡(!
buf
)

1191 
Áû
;

1194 i‡(
	`hâp_gë_hódî_löe
(
f
, 
buf
, 
URL_GET_BUF_SIZE
, 
NULL
) < 0) {

1195 
°©us
 = 0;

1196 
bad_hódî
;

1198 
°©us
 = 
	`hâp_gë_°©us
(
buf
);

1199 i‡(!
fuŒ_Êag
 && !(
°©us
 >= 200 && status <= 299)) {

1200 
bad_hódî
;

1205 i‡(
	`hâp_gë_hódî_löe
(
f
, 
buf
, 
URL_GET_BUF_SIZE
, 
hódî_buf
) < 0) {

1206 
bad_hódî
:

1207 
ª•⁄£
 = 
JS_NULL
;

1208 
d⁄e
;

1210 i‡(!
	`°rcmp
(
buf
, "\r\n"))

1213 i‡(
	`dbuf_îr‹
(
hódî_buf
))

1214 
Áû
;

1215 
hódî_buf
->
size
 -= 2;

1219 
Àn
 = 
	`‰ód
(
buf
, 1, 
URL_GET_BUF_SIZE
, 
f
);

1220 i‡(
Àn
 == 0)

1222 
	`dbuf_put
(
d©a_buf
, (
uöt8_t
 *)
buf
, 
Àn
);

1224 i‡(
	`dbuf_îr‹
(
d©a_buf
))

1225 
Áû
;

1226 i‡(
bö¨y_Êag
) {

1227 
ª•⁄£
 = 
	`JS_NewAºayBuf„rC›y
(
˘x
,

1228 
d©a_buf
->
buf
, d©a_buf->
size
);

1230 
ª•⁄£
 = 
	`JS_NewSåögLí
(
˘x
, (*)
d©a_buf
->
buf
, d©a_buf->
size
);

1232 i‡(
	`JS_IsEx˚±i⁄
(
ª•⁄£
))

1233 
Áû
;

1234 
d⁄e
:

1235 
	`js_‰ì
(
˘x
, 
buf
);

1236 
buf
 = 
NULL
;

1237 
	`p˛o£
(
f
);

1238 
f
 = 
NULL
;

1239 
	`dbuf_‰ì
(
d©a_buf
);

1240 
d©a_buf
 = 
NULL
;

1242 i‡(
fuŒ_Êag
) {

1243 
ªt_obj
 = 
	`JS_NewObje˘
(
˘x
);

1244 i‡(
	`JS_IsEx˚±i⁄
(
ªt_obj
))

1245 
Áû
;

1246 
	`JS_DeföePr›îtyVÆueSå
(
˘x
, 
ªt_obj
, "response",

1247 
ª•⁄£
,

1248 
JS_PROP_C_W_E
);

1249 i‡(!
	`JS_IsNuŒ
(
ª•⁄£
)) {

1250 
	`JS_DeföePr›îtyVÆueSå
(
˘x
, 
ªt_obj
, "responseHeaders",

1251 
	`JS_NewSåögLí
(
˘x
, (*)
hódî_buf
->
buf
,

1252 
hódî_buf
->
size
),

1253 
JS_PROP_C_W_E
);

1254 
	`JS_DeföePr›îtyVÆueSå
(
˘x
, 
ªt_obj
, "status",

1255 
	`JS_NewI¡32
(
˘x
, 
°©us
),

1256 
JS_PROP_C_W_E
);

1259 
ªt_obj
 = 
ª•⁄£
;

1261 
	`dbuf_‰ì
(
hódî_buf
);

1262  
ªt_obj
;

1263 
Áû
:

1264 i‡(
f
)

1265 
	`p˛o£
(
f
);

1266 
	`js_‰ì
(
˘x
, 
buf
);

1267 i‡(
d©a_buf
)

1268 
	`dbuf_‰ì
(
d©a_buf
);

1269 i‡(
hódî_buf
)

1270 
	`dbuf_‰ì
(
hódî_buf
);

1271 
	`JS_FªeVÆue
(
˘x
, 
ª•⁄£
);

1272  
JS_EXCEPTION
;

1273 
	}
}

1275 
JSCœssDef
 
	gjs_°d_fûe_˛ass
 = {

1277 .
föÆizî
 = 
js_°d_fûe_föÆizî
,

1280 c⁄° 
JSCFun˘i⁄Li°E¡ry
 
	gjs_°d_îr‹_¥›s
[] = {

1282 
	#DEF
(
x
Ë
	`JS_PROP_INT32_DEF
(#x, x, 
JS_PROP_CONFIGURABLE
 )

	)

1283 
DEF
(
EINVAL
),

1284 
DEF
(
EIO
),

1285 
DEF
(
EACCES
),

1286 
DEF
(
EEXIST
),

1287 
DEF
(
ENOSPC
),

1288 
DEF
(
ENOSYS
),

1289 
DEF
(
EBUSY
),

1290 
DEF
(
ENOENT
),

1291 
DEF
(
EPERM
),

1292 
DEF
(
EPIPE
),

1293 
DEF
(
EBADF
),

1294 #unde‡
DEF


1297 c⁄° 
JSCFun˘i⁄Li°E¡ry
 
	gjs_°d_funcs
[] = {

1298 
JS_CFUNC_DEF
("exô", 1, 
js_°d_exô
 ),

1299 
JS_CFUNC_DEF
("gc", 0, 
js_°d_gc
 ),

1300 
JS_CFUNC_DEF
("evÆS¸ùt", 1, 
js_evÆS¸ùt
 ),

1301 
JS_CFUNC_DEF
("lﬂdS¸ùt", 1, 
js_lﬂdS¸ùt
 ),

1302 
JS_CFUNC_DEF
("gëív", 1, 
js_°d_gëív
 ),

1303 
JS_CFUNC_DEF
("uæGë", 1, 
js_°d_uæGë
 ),

1304 
JS_CFUNC_DEF
("lﬂdFûe", 1, 
js_°d_lﬂdFûe
 ),

1305 
JS_CFUNC_DEF
("°ªº‹", 1, 
js_°d_°ªº‹
 ),

1308 
JS_CFUNC_DEF
("›í", 2, 
js_°d_›í
 ),

1309 
JS_CFUNC_DEF
("p›í", 2, 
js_°d_p›í
 ),

1310 
JS_CFUNC_DEF
("fd›í", 2, 
js_°d_fd›í
 ),

1311 
JS_CFUNC_DEF
("tmpfûe", 0, 
js_°d_tmpfûe
 ),

1312 
JS_CFUNC_MAGIC_DEF
("puts", 1, 
js_°d_fûe_puts
, 0 ),

1313 
JS_CFUNC_DEF
("¥ötf", 1, 
js_°d_¥ötf
 ),

1314 
JS_CFUNC_DEF
("•rötf", 1, 
js_°d_•rötf
 ),

1315 
JS_PROP_INT32_DEF
("SEEK_SET", 
SEEK_SET
, 
JS_PROP_CONFIGURABLE
 ),

1316 
JS_PROP_INT32_DEF
("SEEK_CUR", 
SEEK_CUR
, 
JS_PROP_CONFIGURABLE
 ),

1317 
JS_PROP_INT32_DEF
("SEEK_END", 
SEEK_END
, 
JS_PROP_CONFIGURABLE
 ),

1318 
JS_OBJECT_DEF
("Eº‹", 
js_°d_îr‹_¥›s
, 
cou¡of
(js_°d_îr‹_¥›s), 
JS_PROP_CONFIGURABLE
),

1322 c⁄° 
JSCFun˘i⁄Li°E¡ry
 
	gjs_°d_fûe_¥Ÿo_funcs
[] = {

1323 
JS_CFUNC_DEF
("˛o£", 0, 
js_°d_fûe_˛o£
 ),

1324 
JS_CFUNC_MAGIC_DEF
("puts", 1, 
js_°d_fûe_puts
, 1 ),

1325 
JS_CFUNC_DEF
("¥ötf", 1, 
js_°d_fûe_¥ötf
 ),

1326 
JS_CFUNC_DEF
("Êush", 0, 
js_°d_fûe_Êush
 ),

1327 
JS_CFUNC_MAGIC_DEF
("ãŒ", 0, 
js_°d_fûe_ãŒ
, 0 ),

1328 
JS_CFUNC_MAGIC_DEF
("ãŒo", 0, 
js_°d_fûe_ãŒ
, 1 ),

1329 
JS_CFUNC_DEF
("£ek", 2, 
js_°d_fûe_£ek
 ),

1330 
JS_CFUNC_DEF
("eof", 0, 
js_°d_fûe_eof
 ),

1331 
JS_CFUNC_DEF
("fûío", 0, 
js_°d_fûe_fûío
 ),

1332 
JS_CFUNC_DEF
("îr‹", 0, 
js_°d_fûe_îr‹
 ),

1333 
JS_CFUNC_DEF
("˛óªº", 0, 
js_°d_fûe_˛óªº
 ),

1334 
JS_CFUNC_MAGIC_DEF
("ªad", 3, 
js_°d_fûe_ªad_wrôe
, 0 ),

1335 
JS_CFUNC_MAGIC_DEF
("wrôe", 3, 
js_°d_fûe_ªad_wrôe
, 1 ),

1336 
JS_CFUNC_DEF
("gëlöe", 0, 
js_°d_fûe_gëlöe
 ),

1337 
JS_CFUNC_DEF
("ªadAsSåög", 0, 
js_°d_fûe_ªadAsSåög
 ),

1338 
JS_CFUNC_DEF
("gëByã", 0, 
js_°d_fûe_gëByã
 ),

1339 
JS_CFUNC_DEF
("putByã", 1, 
js_°d_fûe_putByã
 ),

1343 
	$js_°d_öô
(
JSC⁄ãxt
 *
˘x
, 
JSModuÀDef
 *
m
)

1345 
JSVÆue
 
¥Ÿo
;

1349 
	`JS_NewCœssID
(&
js_°d_fûe_˛ass_id
);

1351 
	`JS_NewCœss
(
	`JS_GëRu¡ime
(
˘x
), 
js_°d_fûe_˛ass_id
, &
js_°d_fûe_˛ass
);

1352 
¥Ÿo
 = 
	`JS_NewObje˘
(
˘x
);

1353 
	`JS_SëPr›îtyFun˘i⁄Li°
(
˘x
, 
¥Ÿo
, 
js_°d_fûe_¥Ÿo_funcs
,

1354 
	`cou¡of
(
js_°d_fûe_¥Ÿo_funcs
));

1355 
	`JS_SëCœssPrŸo
(
˘x
, 
js_°d_fûe_˛ass_id
, 
¥Ÿo
);

1357 
	`JS_SëModuÀExp‹tLi°
(
˘x
, 
m
, 
js_°d_funcs
,

1358 
	`cou¡of
(
js_°d_funcs
));

1359 
	`JS_SëModuÀExp‹t
(
˘x
, 
m
, "ö", 
	`js_√w_°d_fûe
(˘x, 
°dö
, 
FALSE
, FALSE));

1360 
	`JS_SëModuÀExp‹t
(
˘x
, 
m
, "out", 
	`js_√w_°d_fûe
(˘x, 
°dout
, 
FALSE
, FALSE));

1361 
	`JS_SëModuÀExp‹t
(
˘x
, 
m
, "îr", 
	`js_√w_°d_fûe
(˘x, 
°dîr
, 
FALSE
, FALSE));

1363 
	}
}

1365 
JSModuÀDef
 *
	$js_öô_moduÀ_°d
(
JSC⁄ãxt
 *
˘x
, c⁄° *
moduÀ_«me
)

1367 
JSModuÀDef
 *
m
;

1368 
m
 = 
	`JS_NewCModuÀ
(
˘x
, 
moduÀ_«me
, 
js_°d_öô
);

1369 i‡(!
m
)

1370  
NULL
;

1371 
	`JS_AddModuÀExp‹tLi°
(
˘x
, 
m
, 
js_°d_funcs
, 
	`cou¡of
(js_std_funcs));

1372 
	`JS_AddModuÀExp‹t
(
˘x
, 
m
, "in");

1373 
	`JS_AddModuÀExp‹t
(
˘x
, 
m
, "out");

1374 
	`JS_AddModuÀExp‹t
(
˘x
, 
m
, "err");

1375  
m
;

1376 
	}
}

1381 
JSVÆue
 
	$js_os_›í
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

1382 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

1384 c⁄° *
fûíame
;

1385 
Êags
, 
mode
, 
ªt
;

1387 
fûíame
 = 
	`JS_ToCSåög
(
˘x
, 
¨gv
[0]);

1388 i‡(!
fûíame
)

1389  
JS_EXCEPTION
;

1390 i‡(
	`JS_ToI¡32
(
˘x
, &
Êags
, 
¨gv
[1]))

1391 
Áû
;

1392 i‡(
¨gc
 >3 && !
	`JS_IsUndeföed
(
¨gv
[2])) {

1393 i‡(
	`JS_ToI¡32
(
˘x
, &
mode
, 
¨gv
[2])) {

1394 
Áû
:

1395 
	`JS_FªeCSåög
(
˘x
, 
fûíame
);

1396  
JS_EXCEPTION
;

1399 
mode
 = 0666;

1401 #i‡
	`deföed
(
_WIN32
)

1403 i‡(!(
Êags
 & 
O_TEXT
))

1404 
Êags
 |
O_BINARY
;

1406 
ªt
 = 
	`js_gë_î∫o
(
	`›í
(
fûíame
, 
Êags
, 
mode
));

1407 
	`JS_FªeCSåög
(
˘x
, 
fûíame
);

1408  
	`JS_NewI¡32
(
˘x
, 
ªt
);

1409 
	}
}

1411 
JSVÆue
 
	$js_os_˛o£
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

1412 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

1414 
fd
, 
ªt
;

1415 i‡(
	`JS_ToI¡32
(
˘x
, &
fd
, 
¨gv
[0]))

1416  
JS_EXCEPTION
;

1417 
ªt
 = 
	`js_gë_î∫o
(
	`˛o£
(
fd
));

1418  
	`JS_NewI¡32
(
˘x
, 
ªt
);

1419 
	}
}

1421 
JSVÆue
 
	$js_os_£ek
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

1422 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

1424 
fd
, 
whí˚
;

1425 
söt64_t
 
pos
, 
ªt
;

1426 
BOOL
 
is_bigöt
;

1428 i‡(
	`JS_ToI¡32
(
˘x
, &
fd
, 
¨gv
[0]))

1429  
JS_EXCEPTION
;

1430 
is_bigöt
 = 
	`JS_IsBigI¡
(
˘x
, 
¨gv
[1]);

1431 i‡(
	`JS_ToI¡64Ext
(
˘x
, &
pos
, 
¨gv
[1]))

1432  
JS_EXCEPTION
;

1433 i‡(
	`JS_ToI¡32
(
˘x
, &
whí˚
, 
¨gv
[2]))

1434  
JS_EXCEPTION
;

1435 
ªt
 = 
	`l£ek
(
fd
, 
pos
, 
whí˚
);

1436 i‡(
ªt
 == -1)

1437 
ªt
 = -
î∫o
;

1438 i‡(
is_bigöt
)

1439  
	`JS_NewBigI¡64
(
˘x
, 
ªt
);

1441  
	`JS_NewI¡64
(
˘x
, 
ªt
);

1442 
	}
}

1444 
JSVÆue
 
	$js_os_ªad_wrôe
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

1445 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
, 
magic
)

1447 
fd
;

1448 
uöt64_t
 
pos
, 
Àn
;

1449 
size_t
 
size
;

1450 
ssize_t
 
ªt
;

1451 
uöt8_t
 *
buf
;

1453 i‡(
	`JS_ToI¡32
(
˘x
, &
fd
, 
¨gv
[0]))

1454  
JS_EXCEPTION
;

1455 i‡(
	`JS_ToIndex
(
˘x
, &
pos
, 
¨gv
[2]))

1456  
JS_EXCEPTION
;

1457 i‡(
	`JS_ToIndex
(
˘x
, &
Àn
, 
¨gv
[3]))

1458  
JS_EXCEPTION
;

1459 
buf
 = 
	`JS_GëAºayBuf„r
(
˘x
, &
size
, 
¨gv
[1]);

1460 i‡(!
buf
)

1461  
JS_EXCEPTION
;

1462 i‡(
pos
 + 
Àn
 > 
size
)

1463  
	`JS_ThrowR™geEº‹
(
˘x
, "read/writeárray buffer overflow");

1464 i‡(
magic
)

1465 
ªt
 = 
	`js_gë_î∫o
(
	`wrôe
(
fd
, 
buf
 + 
pos
, 
Àn
));

1467 
ªt
 = 
	`js_gë_î∫o
(
	`ªad
(
fd
, 
buf
 + 
pos
, 
Àn
));

1468  
	`JS_NewI¡64
(
˘x
, 
ªt
);

1469 
	}
}

1471 
JSVÆue
 
	$js_os_ißây
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

1472 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

1474 
fd
;

1475 i‡(
	`JS_ToI¡32
(
˘x
, &
fd
, 
¨gv
[0]))

1476  
JS_EXCEPTION
;

1477  
	`JS_NewBoﬁ
(
˘x
, 
	`ißây
(
fd
) == 1);

1478 
	}
}

1480 #i‡
deföed
(
_WIN32
)

1481 
JSVÆue
 
	$js_os_âyGëWöSize
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

1482 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

1484 
fd
;

1485 
HANDLE
 
h™dÀ
;

1486 
CONSOLE_SCREEN_BUFFER_INFO
 
öfo
;

1487 
JSVÆue
 
obj
;

1489 i‡(
	`JS_ToI¡32
(
˘x
, &
fd
, 
¨gv
[0]))

1490  
JS_EXCEPTION
;

1491 
h™dÀ
 = (
HANDLE
)
	`_gë_osfh™dÀ
(
fd
);

1493 i‡(!
	`GëC⁄sﬁeS¸ìnBuf„rInfo
(
h™dÀ
, &
öfo
))

1494  
JS_NULL
;

1495 
obj
 = 
	`JS_NewAºay
(
˘x
);

1496 i‡(
	`JS_IsEx˚±i⁄
(
obj
))

1497  
obj
;

1498 
	`JS_DeföePr›îtyVÆueUöt32
(
˘x
, 
obj
, 0, 
	`JS_NewI¡32
(˘x, 
öfo
.
dwSize
.
X
), 
JS_PROP_C_W_E
);

1499 
	`JS_DeföePr›îtyVÆueUöt32
(
˘x
, 
obj
, 1, 
	`JS_NewI¡32
(˘x, 
öfo
.
dwSize
.
Y
), 
JS_PROP_C_W_E
);

1500  
obj
;

1501 
	}
}

1503 
JSVÆue
 
	$js_os_âySëRaw
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

1504 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

1506 
fd
;

1507 
HANDLE
 
h™dÀ
;

1509 i‡(
	`JS_ToI¡32
(
˘x
, &
fd
, 
¨gv
[0]))

1510  
JS_EXCEPTION
;

1511 
h™dÀ
 = (
HANDLE
)
	`_gë_osfh™dÀ
(
fd
);

1513 
	`SëC⁄sﬁeMode
(
h™dÀ
, 
ENABLE_WINDOW_INPUT
);

1514  
JS_UNDEFINED
;

1515 
	}
}

1517 
JSVÆue
 
	$js_os_âyGëWöSize
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

1518 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

1520 
fd
;

1521 
wösize
 
ws
;

1522 
JSVÆue
 
obj
;

1524 i‡(
	`JS_ToI¡32
(
˘x
, &
fd
, 
¨gv
[0]))

1525  
JS_EXCEPTION
;

1526 i‡(
	`io˘l
(
fd
, 
TIOCGWINSZ
, &
ws
) == 0 &&

1527 
ws
.
ws_cﬁ
 >4 && ws.
ws_row
 >= 4) {

1528 
obj
 = 
	`JS_NewAºay
(
˘x
);

1529 i‡(
	`JS_IsEx˚±i⁄
(
obj
))

1530  
obj
;

1531 
	`JS_DeföePr›îtyVÆueUöt32
(
˘x
, 
obj
, 0, 
	`JS_NewI¡32
(˘x, 
ws
.
ws_cﬁ
), 
JS_PROP_C_W_E
);

1532 
	`JS_DeföePr›îtyVÆueUöt32
(
˘x
, 
obj
, 1, 
	`JS_NewI¡32
(˘x, 
ws
.
ws_row
), 
JS_PROP_C_W_E
);

1533  
obj
;

1535  
JS_NULL
;

1537 
	}
}

1539 
ãrmios
 
	gﬁdây
;

1541 
	$ãrm_exô
()

1543 
	`tc£èâr
(0, 
TCSANOW
, &
ﬁdây
);

1544 
	}
}

1547 
JSVÆue
 
	$js_os_âySëRaw
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

1548 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

1550 
ãrmios
 
ây
;

1551 
fd
;

1553 i‡(
	`JS_ToI¡32
(
˘x
, &
fd
, 
¨gv
[0]))

1554  
JS_EXCEPTION
;

1556 
	`mem£t
(&
ây
, 0, (tty));

1557 
	`tcgë©å
(
fd
, &
ây
);

1558 
ﬁdây
 = 
ây
;

1560 
ây
.
c_iÊag
 &~(
IGNBRK
|
BRKINT
|
PARMRK
|
ISTRIP


1561 |
INLCR
|
IGNCR
|
ICRNL
|
IXON
);

1562 
ây
.
c_oÊag
 |
OPOST
;

1563 
ây
.
c_lÊag
 &~(
ECHO
|
ECHONL
|
ICANON
|
IEXTEN
);

1564 
ây
.
c_cÊag
 &~(
CSIZE
|
PARENB
);

1565 
ây
.
c_cÊag
 |
CS8
;

1566 
ây
.
c_cc
[
VMIN
] = 1;

1567 
ây
.
c_cc
[
VTIME
] = 0;

1569 
	`tc£èâr
(
fd
, 
TCSANOW
, &
ây
);

1571 
	`©exô
(
ãrm_exô
);

1572  
JS_UNDEFINED
;

1573 
	}
}

1577 
JSVÆue
 
	$js_os_ªmove
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

1578 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

1580 c⁄° *
fûíame
;

1581 
ªt
;

1583 
fûíame
 = 
	`JS_ToCSåög
(
˘x
, 
¨gv
[0]);

1584 i‡(!
fûíame
)

1585  
JS_EXCEPTION
;

1586 
ªt
 = 
	`js_gë_î∫o
(
	`ªmove
(
fûíame
));

1587 
	`JS_FªeCSåög
(
˘x
, 
fûíame
);

1588  
	`JS_NewI¡32
(
˘x
, 
ªt
);

1589 
	}
}

1591 
JSVÆue
 
	$js_os_ª«me
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

1592 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

1594 c⁄° *
ﬁd∑th
, *
√w∑th
;

1595 
ªt
;

1597 
ﬁd∑th
 = 
	`JS_ToCSåög
(
˘x
, 
¨gv
[0]);

1598 i‡(!
ﬁd∑th
)

1599  
JS_EXCEPTION
;

1600 
√w∑th
 = 
	`JS_ToCSåög
(
˘x
, 
¨gv
[1]);

1601 i‡(!
√w∑th
) {

1602 
	`JS_FªeCSåög
(
˘x
, 
ﬁd∑th
);

1603  
JS_EXCEPTION
;

1605 
ªt
 = 
	`js_gë_î∫o
(
	`ª«me
(
ﬁd∑th
, 
√w∑th
));

1606 
	`JS_FªeCSåög
(
˘x
, 
ﬁd∑th
);

1607 
	`JS_FªeCSåög
(
˘x
, 
√w∑th
);

1608  
	`JS_NewI¡32
(
˘x
, 
ªt
);

1609 
	}
}

1611 
JSOSRWH™dÀr
 *
	$föd_rh
(
fd
)

1613 
JSOSRWH™dÀr
 *
rh
;

1614 
li°_hód
 *
ñ
;

1615 
	`li°_f‹_óch
(
ñ
, &
os_rw_h™dÀrs
) {

1616 
rh
 = 
	`li°_íåy
(
ñ
, 
JSOSRWH™dÀr
, 
lök
);

1617 i‡(
rh
->
fd
 == fd)

1618  
rh
;

1620  
NULL
;

1621 
	}
}

1623 
	$‰ì_rw_h™dÀr
(
JSRu¡ime
 *
π
, 
JSOSRWH™dÀr
 *
rh
)

1625 
i
;

1626 
	`li°_dñ
(&
rh
->
lök
);

1627 
i
 = 0; i < 2; i++) {

1628 
	`JS_FªeVÆueRT
(
π
, 
rh
->
rw_func
[
i
]);

1630 
	`js_‰ì_π
(
π
, 
rh
);

1631 
	}
}

1633 
JSVÆue
 
	$js_os_£tRódH™dÀr
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

1634 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
, 
magic
)

1636 
JSOSRWH™dÀr
 *
rh
;

1637 
fd
;

1638 
JSVÆueC⁄°
 
func
;

1640 i‡(
	`JS_ToI¡32
(
˘x
, &
fd
, 
¨gv
[0]))

1641  
JS_EXCEPTION
;

1642 
func
 = 
¨gv
[1];

1643 i‡(
	`JS_IsNuŒ
(
func
)) {

1644 
rh
 = 
	`föd_rh
(
fd
);

1645 i‡(
rh
) {

1646 
	`JS_FªeVÆue
(
˘x
, 
rh
->
rw_func
[
magic
]);

1647 
rh
->
rw_func
[
magic
] = 
JS_NULL
;

1648 i‡(
	`JS_IsNuŒ
(
rh
->
rw_func
[0]) &&

1649 
	`JS_IsNuŒ
(
rh
->
rw_func
[1])) {

1651 
	`‰ì_rw_h™dÀr
(
	`JS_GëRu¡ime
(
˘x
), 
rh
);

1655 i‡(!
	`JS_IsFun˘i⁄
(
˘x
, 
func
))

1656  
	`JS_ThrowTy≥Eº‹
(
˘x
, "notá function");

1657 
rh
 = 
	`föd_rh
(
fd
);

1658 i‡(!
rh
) {

1659 
rh
 = 
	`js_mÆlocz
(
˘x
, (*rh));

1660 i‡(!
rh
)

1661  
JS_EXCEPTION
;

1662 
rh
->
fd
 = fd;

1663 
rh
->
rw_func
[0] = 
JS_NULL
;

1664 
rh
->
rw_func
[1] = 
JS_NULL
;

1665 
	`li°_add_èû
(&
rh
->
lök
, &
os_rw_h™dÀrs
);

1667 
	`JS_FªeVÆue
(
˘x
, 
rh
->
rw_func
[
magic
]);

1668 
rh
->
rw_func
[
magic
] = 
	`JS_DupVÆue
(
˘x
, 
func
);

1670  
JS_UNDEFINED
;

1671 
	}
}

1673 
JSOSSig«lH™dÀr
 *
	$föd_sh
(
sig_num
)

1675 
JSOSSig«lH™dÀr
 *
sh
;

1676 
li°_hód
 *
ñ
;

1677 
	`li°_f‹_óch
(
ñ
, &
os_sig«l_h™dÀrs
) {

1678 
sh
 = 
	`li°_íåy
(
ñ
, 
JSOSSig«lH™dÀr
, 
lök
);

1679 i‡(
sh
->
sig_num
 == sig_num)

1680  
sh
;

1682  
NULL
;

1683 
	}
}

1685 
	$‰ì_sh
(
JSRu¡ime
 *
π
, 
JSOSSig«lH™dÀr
 *
sh
)

1687 
	`li°_dñ
(&
sh
->
lök
);

1688 
	`JS_FªeVÆueRT
(
π
, 
sh
->
func
);

1689 
	`js_‰ì_π
(
π
, 
sh
);

1690 
	}
}

1692 
	$os_sig«l_h™dÀr
(
sig_num
)

1694 
os_≥ndög_sig«ls
 |((
uöt64_t
)1 << 
sig_num
);

1695 
	}
}

1697 #i‡
deföed
(
_WIN32
)

1698 (*
	tsigh™dÀr_t
)(
	tsig_num
);

1701 (*
	tsigh™dÀr_t
)(
	tsig_num
);

1703 
JSVÆue
 
	$js_os_sig«l
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

1704 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

1706 
JSOSSig«lH™dÀr
 *
sh
;

1707 
uöt32_t
 
sig_num
;

1708 
JSVÆueC⁄°
 
func
;

1709 
sigh™dÀr_t
 
h™dÀr
;

1711 i‡(
	`JS_ToUöt32
(
˘x
, &
sig_num
, 
¨gv
[0]))

1712  
JS_EXCEPTION
;

1713 i‡(
sig_num
 >= 64)

1714  
	`JS_ThrowR™geEº‹
(
˘x
, "invalid signalÇumber");

1715 
func
 = 
¨gv
[1];

1717 i‡(
	`JS_IsNuŒ
(
func
Ë|| 
	`JS_IsUndeföed
(func)) {

1718 
sh
 = 
	`föd_sh
(
sig_num
);

1719 i‡(
sh
) {

1720 
	`‰ì_sh
(
	`JS_GëRu¡ime
(
˘x
), 
sh
);

1722 i‡(
	`JS_IsNuŒ
(
func
))

1723 
h™dÀr
 = 
SIG_DFL
;

1725 
h™dÀr
 = 
SIG_IGN
;

1726 
	`sig«l
(
sig_num
, 
h™dÀr
);

1728 i‡(!
	`JS_IsFun˘i⁄
(
˘x
, 
func
))

1729  
	`JS_ThrowTy≥Eº‹
(
˘x
, "notá function");

1730 
sh
 = 
	`föd_sh
(
sig_num
);

1731 i‡(!
sh
) {

1732 
sh
 = 
	`js_mÆlocz
(
˘x
, (*sh));

1733 i‡(!
sh
)

1734  
JS_EXCEPTION
;

1735 
sh
->
sig_num
 = sig_num;

1736 
	`li°_add_èû
(&
sh
->
lök
, &
os_sig«l_h™dÀrs
);

1738 
	`JS_FªeVÆue
(
˘x
, 
sh
->
func
);

1739 
sh
->
func
 = 
	`JS_DupVÆue
(
˘x
, func);

1740 
	`sig«l
(
sig_num
, 
os_sig«l_h™dÀr
);

1742  
JS_UNDEFINED
;

1743 
	}
}

1745 #i‡
deföed
(
__löux__
Ë|| deföed(
__APPLE__
)

1746 
söt64_t
 
	$gë_time_ms
()

1748 
time•ec
 
ts
;

1749 
	`˛ock_gëtime
(
CLOCK_MONOTONIC
, &
ts
);

1750  (
uöt64_t
)
ts
.
tv_£c
 * 1000 + (ts.
tv_n£c
 / 1000000);

1751 
	}
}

1754 
öt64_t
 
	$gë_time_ms
()

1756 
timevÆ
 
tv
;

1757 
	`gëtimeofday
(&
tv
, 
NULL
);

1758  (
öt64_t
)
tv
.
tv_£c
 * 1000 + (tv.
tv_u£c
 / 1000);

1759 
	}
}

1762 
	$u∆ök_timî
(
JSRu¡ime
 *
π
, 
JSOSTimî
 *
th
)

1764 i‡(
th
->
lök
.
¥ev
) {

1765 
	`li°_dñ
(&
th
->
lök
);

1766 
th
->
lök
.
¥ev
 =Åh->lök.
√xt
 = 
NULL
;

1768 
	}
}

1770 
	$‰ì_timî
(
JSRu¡ime
 *
π
, 
JSOSTimî
 *
th
)

1772 
	`JS_FªeVÆueRT
(
π
, 
th
->
func
);

1773 
	`js_‰ì_π
(
π
, 
th
);

1774 
	}
}

1776 
JSCœssID
 
	gjs_os_timî_˛ass_id
;

1778 
	$js_os_timî_föÆizî
(
JSRu¡ime
 *
π
, 
JSVÆue
 
vÆ
)

1780 
JSOSTimî
 *
th
 = 
	`JS_GëO∑que
(
vÆ
, 
js_os_timî_˛ass_id
);

1781 i‡(
th
) {

1782 
th
->
has_obje˘
 = 
FALSE
;

1783 i‡(!
th
->
lök
.
¥ev
)

1784 
	`‰ì_timî
(
π
, 
th
);

1786 
	}
}

1788 
	$js_os_timî_m¨k
(
JSRu¡ime
 *
π
, 
JSVÆueC⁄°
 
vÆ
,

1789 
JS_M¨kFunc
 *
m¨k_func
)

1791 
JSOSTimî
 *
th
 = 
	`JS_GëO∑que
(
vÆ
, 
js_os_timî_˛ass_id
);

1792 i‡(
th
) {

1793 
	`JS_M¨kVÆue
(
π
, 
th
->
func
, 
m¨k_func
);

1795 
	}
}

1797 
JSVÆue
 
	$js_os_£tTimeout
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

1798 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

1800 
söt64_t
 
dñay
;

1801 
JSVÆueC⁄°
 
func
;

1802 
JSOSTimî
 *
th
;

1803 
JSVÆue
 
obj
;

1805 
func
 = 
¨gv
[0];

1806 i‡(!
	`JS_IsFun˘i⁄
(
˘x
, 
func
))

1807  
	`JS_ThrowTy≥Eº‹
(
˘x
, "notá function");

1808 i‡(
	`JS_ToI¡64
(
˘x
, &
dñay
, 
¨gv
[1]))

1809  
JS_EXCEPTION
;

1810 
obj
 = 
	`JS_NewObje˘Cœss
(
˘x
, 
js_os_timî_˛ass_id
);

1811 i‡(
	`JS_IsEx˚±i⁄
(
obj
))

1812  
obj
;

1813 
th
 = 
	`js_mÆlocz
(
˘x
, (*th));

1814 i‡(!
th
) {

1815 
	`JS_FªeVÆue
(
˘x
, 
obj
);

1816  
JS_EXCEPTION
;

1818 
th
->
has_obje˘
 = 
TRUE
;

1819 
th
->
timeout
 = 
	`gë_time_ms
(Ë+ 
dñay
;

1820 
th
->
func
 = 
	`JS_DupVÆue
(
˘x
, func);

1821 
	`li°_add_èû
(&
th
->
lök
, &
os_timîs
);

1822 
	`JS_SëO∑que
(
obj
, 
th
);

1823  
obj
;

1824 
	}
}

1826 
JSVÆue
 
	$js_os_˛órTimeout
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

1827 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

1829 
JSOSTimî
 *
th
 = 
	`JS_GëO∑que2
(
˘x
, 
¨gv
[0], 
js_os_timî_˛ass_id
);

1830 i‡(!
th
)

1831  
JS_EXCEPTION
;

1832 
	`u∆ök_timî
(
	`JS_GëRu¡ime
(
˘x
), 
th
);

1833  
JS_UNDEFINED
;

1834 
	}
}

1836 
JSCœssDef
 
	gjs_os_timî_˛ass
 = {

1838 .
föÆizî
 = 
js_os_timî_föÆizî
,

1839 .
	ggc_m¨k
 = 
js_os_timî_m¨k
,

1842 
	$ˇŒ_h™dÀr
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
func
)

1844 
JSVÆue
 
ªt
, 
func1
;

1847 
func1
 = 
	`JS_DupVÆue
(
˘x
, 
func
);

1848 
ªt
 = 
	`JS_CÆl
(
˘x
, 
func1
, 
JS_UNDEFINED
, 0, 
NULL
);

1849 
	`JS_FªeVÆue
(
˘x
, 
func1
);

1850 i‡(
	`JS_IsEx˚±i⁄
(
ªt
))

1851 
	`js_°d_dump_îr‹
(
˘x
);

1852 
	`JS_FªeVÆue
(
˘x
, 
ªt
);

1853 
	}
}

1855 #i‡
deföed
(
_WIN32
)

1857 
	$js_os_pﬁl
(
JSC⁄ãxt
 *
˘x
)

1859 
mö_dñay
, 
c⁄sﬁe_fd
;

1860 
öt64_t
 
cur_time
, 
dñay
;

1861 
JSOSRWH™dÀr
 *
rh
;

1862 
li°_hód
 *
ñ
;

1866 i‡(
	`li°_em±y
(&
os_rw_h™dÀrs
Ë&&Üi°_em±y(&
os_timîs
))

1870 i‡(!
	`li°_em±y
(&
os_timîs
)) {

1871 
cur_time
 = 
	`gë_time_ms
();

1872 
mö_dñay
 = 10000;

1873 
	`li°_f‹_óch
(
ñ
, &
os_timîs
) {

1874 
JSOSTimî
 *
th
 = 
	`li°_íåy
(
ñ
, JSOSTimî, 
lök
);

1875 
dñay
 = 
th
->
timeout
 - 
cur_time
;

1876 i‡(
dñay
 <= 0) {

1877 
JSVÆue
 
func
;

1879 
func
 = 
th
->func;

1880 
th
->
func
 = 
JS_UNDEFINED
;

1881 
	`u∆ök_timî
(
	`JS_GëRu¡ime
(
˘x
), 
th
);

1882 i‡(!
th
->
has_obje˘
)

1883 
	`‰ì_timî
(
	`JS_GëRu¡ime
(
˘x
), 
th
);

1884 
	`ˇŒ_h™dÀr
(
˘x
, 
func
);

1885 
	`JS_FªeVÆue
(
˘x
, 
func
);

1887 } i‡(
dñay
 < 
mö_dñay
) {

1888 
mö_dñay
 = 
dñay
;

1892 
mö_dñay
 = -1;

1895 
c⁄sﬁe_fd
 = -1;

1896 
	`li°_f‹_óch
(
ñ
, &
os_rw_h™dÀrs
) {

1897 
rh
 = 
	`li°_íåy
(
ñ
, 
JSOSRWH™dÀr
, 
lök
);

1898 i‡(
rh
->
fd
 =0 && !
	`JS_IsNuŒ
‘h->
rw_func
[0])) {

1899 
c⁄sﬁe_fd
 = 
rh
->
fd
;

1904 i‡(
c⁄sﬁe_fd
 >= 0) {

1905 
DWORD
 
ti
, 
ªt
;

1906 
HANDLE
 
h™dÀ
;

1907 i‡(
mö_dñay
 == -1)

1908 
ti
 = 
INFINITE
;

1910 
ti
 = 
mö_dñay
;

1911 
h™dÀ
 = (
HANDLE
)
	`_gë_osfh™dÀ
(
c⁄sﬁe_fd
);

1912 
ªt
 = 
	`WaôF‹SögÀObje˘
(
h™dÀ
, 
ti
);

1913 i‡(
ªt
 =
WAIT_OBJECT_0
) {

1914 
	`li°_f‹_óch
(
ñ
, &
os_rw_h™dÀrs
) {

1915 
rh
 = 
	`li°_íåy
(
ñ
, 
JSOSRWH™dÀr
, 
lök
);

1916 i‡(
rh
->
fd
 =
c⁄sﬁe_fd
 && !
	`JS_IsNuŒ
‘h->
rw_func
[0])) {

1917 
	`ˇŒ_h™dÀr
(
˘x
, 
rh
->
rw_func
[0]);

1924 
	`SÀï
(
mö_dñay
);

1927 
	}
}

1929 
	$js_os_pﬁl
(
JSC⁄ãxt
 *
˘x
)

1931 
ªt
, 
fd_max
, 
mö_dñay
;

1932 
söt64_t
 
cur_time
, 
dñay
;

1933 
fd_£t
 
rfds
, 
wfds
;

1934 
JSOSRWH™dÀr
 *
rh
;

1935 
li°_hód
 *
ñ
;

1936 
timevÆ
 
tv
, *
tvp
;

1938 i‡(
	`u∆ikñy
(
os_≥ndög_sig«ls
 != 0)) {

1939 
JSOSSig«lH™dÀr
 *
sh
;

1940 
uöt64_t
 
mask
;

1942 
	`li°_f‹_óch
(
ñ
, &
os_sig«l_h™dÀrs
) {

1943 
sh
 = 
	`li°_íåy
(
ñ
, 
JSOSSig«lH™dÀr
, 
lök
);

1944 
mask
 = (
uöt64_t
)1 << 
sh
->
sig_num
;

1945 i‡(
os_≥ndög_sig«ls
 & 
mask
) {

1946 
os_≥ndög_sig«ls
 &~
mask
;

1947 
	`ˇŒ_h™dÀr
(
˘x
, 
sh
->
func
);

1953 i‡(
	`li°_em±y
(&
os_rw_h™dÀrs
Ë&&Üi°_em±y(&
os_timîs
))

1956 i‡(!
	`li°_em±y
(&
os_timîs
)) {

1957 
cur_time
 = 
	`gë_time_ms
();

1958 
mö_dñay
 = 10000;

1959 
	`li°_f‹_óch
(
ñ
, &
os_timîs
) {

1960 
JSOSTimî
 *
th
 = 
	`li°_íåy
(
ñ
, JSOSTimî, 
lök
);

1961 
dñay
 = 
th
->
timeout
 - 
cur_time
;

1962 i‡(
dñay
 <= 0) {

1963 
JSVÆue
 
func
;

1965 
func
 = 
th
->func;

1966 
th
->
func
 = 
JS_UNDEFINED
;

1967 
	`u∆ök_timî
(
	`JS_GëRu¡ime
(
˘x
), 
th
);

1968 i‡(!
th
->
has_obje˘
)

1969 
	`‰ì_timî
(
	`JS_GëRu¡ime
(
˘x
), 
th
);

1970 
	`ˇŒ_h™dÀr
(
˘x
, 
func
);

1971 
	`JS_FªeVÆue
(
˘x
, 
func
);

1973 } i‡(
dñay
 < 
mö_dñay
) {

1974 
mö_dñay
 = 
dñay
;

1977 
tv
.
tv_£c
 = 
mö_dñay
 / 1000;

1978 
tv
.
tv_u£c
 = (
mö_dñay
 % 1000) * 1000;

1979 
tvp
 = &
tv
;

1981 
tvp
 = 
NULL
;

1984 
	`FD_ZERO
(&
rfds
);

1985 
	`FD_ZERO
(&
wfds
);

1986 
fd_max
 = -1;

1987 
	`li°_f‹_óch
(
ñ
, &
os_rw_h™dÀrs
) {

1988 
rh
 = 
	`li°_íåy
(
ñ
, 
JSOSRWH™dÀr
, 
lök
);

1989 
fd_max
 = 
	`max_öt
(fd_max, 
rh
->
fd
);

1990 i‡(!
	`JS_IsNuŒ
(
rh
->
rw_func
[0]))

1991 
	`FD_SET
(
rh
->
fd
, &
rfds
);

1992 i‡(!
	`JS_IsNuŒ
(
rh
->
rw_func
[1]))

1993 
	`FD_SET
(
rh
->
fd
, &
wfds
);

1996 
ªt
 = 
	`£À˘
(
fd_max
 + 1, &
rfds
, &
wfds
, 
NULL
, 
tvp
);

1997 i‡(
ªt
 > 0) {

1998 
	`li°_f‹_óch
(
ñ
, &
os_rw_h™dÀrs
) {

1999 
rh
 = 
	`li°_íåy
(
ñ
, 
JSOSRWH™dÀr
, 
lök
);

2000 i‡(!
	`JS_IsNuŒ
(
rh
->
rw_func
[0]) &&

2001 
	`FD_ISSET
(
rh
->
fd
, &
rfds
)) {

2002 
	`ˇŒ_h™dÀr
(
˘x
, 
rh
->
rw_func
[0]);

2006 i‡(!
	`JS_IsNuŒ
(
rh
->
rw_func
[1])) {

2007 
	`FD_SET
(
rh
->
fd
, &
wfds
);

2008 
	`ˇŒ_h™dÀr
(
˘x
, 
rh
->
rw_func
[1]);

2015 
	}
}

2018 
JSVÆue
 
	$make_obj_îr‹
(
JSC⁄ãxt
 *
˘x
,

2019 
JSVÆue
 
obj
,

2020 
îr
)

2022 
JSVÆue
 
¨r
;

2023 i‡(
	`JS_IsEx˚±i⁄
(
obj
))

2024  
obj
;

2025 
¨r
 = 
	`JS_NewAºay
(
˘x
);

2026 i‡(
	`JS_IsEx˚±i⁄
(
¨r
))

2027  
JS_EXCEPTION
;

2028 
	`JS_DeföePr›îtyVÆueUöt32
(
˘x
, 
¨r
, 0, 
obj
,

2029 
JS_PROP_C_W_E
);

2030 
	`JS_DeföePr›îtyVÆueUöt32
(
˘x
, 
¨r
, 1, 
	`JS_NewI¡32
(˘x, 
îr
),

2031 
JS_PROP_C_W_E
);

2032  
¨r
;

2033 
	}
}

2035 
JSVÆue
 
	$make_°rög_îr‹
(
JSC⁄ãxt
 *
˘x
,

2036 c⁄° *
buf
,

2037 
îr
)

2039  
	`make_obj_îr‹
(
˘x
, 
	`JS_NewSåög
(˘x, 
buf
), 
îr
);

2040 
	}
}

2043 
JSVÆue
 
	$js_os_gëcwd
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

2044 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

2046 
buf
[
PATH_MAX
];

2047 
îr
;

2049 i‡(!
	`gëcwd
(
buf
, (buf))) {

2050 
buf
[0] = '\0';

2051 
îr
 = 
î∫o
;

2053 
îr
 = 0;

2055  
	`make_°rög_îr‹
(
˘x
, 
buf
, 
îr
);

2056 
	}
}

2058 #i‡!
deföed
(
_WIN32
)

2060 
JSVÆue
 
	$js_os_chdú
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

2061 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

2063 c⁄° *
èrgë
;

2064 
îr
;

2066 
èrgë
 = 
	`JS_ToCSåög
(
˘x
, 
¨gv
[0]);

2067 i‡(!
èrgë
)

2068  
JS_EXCEPTION
;

2069 
îr
 = 
	`js_gë_î∫o
(
	`chdú
(
èrgë
));

2070 
	`JS_FªeCSåög
(
˘x
, 
èrgë
);

2071  
	`JS_NewI¡32
(
˘x
, 
îr
);

2072 
	}
}

2075 
JSVÆue
 
	$js_os_ªÆ∑th
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

2076 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

2078 c⁄° *
∑th
;

2079 
buf
[
PATH_MAX
], *
ªs
;

2080 
îr
;

2082 
∑th
 = 
	`JS_ToCSåög
(
˘x
, 
¨gv
[0]);

2083 i‡(!
∑th
)

2084  
JS_EXCEPTION
;

2085 
ªs
 = 
	`ªÆ∑th
(
∑th
, 
buf
);

2086 
	`JS_FªeCSåög
(
˘x
, 
∑th
);

2087 i‡(!
ªs
) {

2088 
buf
[0] = '\0';

2089 
îr
 = 
î∫o
;

2091 
îr
 = 0;

2093  
	`make_°rög_îr‹
(
˘x
, 
buf
, 
îr
);

2094 
	}
}

2096 
JSVÆue
 
	$js_os_mkdú
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

2097 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

2099 
mode
, 
ªt
;

2100 c⁄° *
∑th
;

2102 i‡(
¨gc
 >= 2) {

2103 i‡(
	`JS_ToI¡32
(
˘x
, &
mode
, 
¨gv
[1]))

2104  
JS_EXCEPTION
;

2106 
mode
 = 0777;

2108 
∑th
 = 
	`JS_ToCSåög
(
˘x
, 
¨gv
[0]);

2109 i‡(!
∑th
)

2110  
JS_EXCEPTION
;

2111 
ªt
 = 
	`js_gë_î∫o
(
	`mkdú
(
∑th
, 
mode
));

2112 
	`JS_FªeCSåög
(
˘x
, 
∑th
);

2113  
	`JS_NewI¡32
(
˘x
, 
ªt
);

2114 
	}
}

2116 
söt64_t
 
	$time•ec_to_ms
(c⁄° 
time•ec
 *
tv
)

2118  (
söt64_t
)
tv
->
tv_£c
 * 1000 + (tv->
tv_n£c
 / 1000000);

2119 
	}
}

2122 
JSVÆue
 
	$js_os_°©
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

2123 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
, 
is_l°©
)

2125 c⁄° *
∑th
;

2126 
îr
, 
ªs
;

2127 
°©
 
°
;

2128 
JSVÆue
 
obj
;

2130 
∑th
 = 
	`JS_ToCSåög
(
˘x
, 
¨gv
[0]);

2131 i‡(!
∑th
)

2132  
JS_EXCEPTION
;

2133 i‡(
is_l°©
)

2134 
ªs
 = 
	`l°©
(
∑th
, &
°
);

2136 
ªs
 = 
	`°©
(
∑th
, &
°
);

2137 
	`JS_FªeCSåög
(
˘x
, 
∑th
);

2138 i‡(
ªs
 < 0) {

2139 
îr
 = 
î∫o
;

2140 
obj
 = 
JS_NULL
;

2142 
îr
 = 0;

2143 
obj
 = 
	`JS_NewObje˘
(
˘x
);

2144 i‡(
	`JS_IsEx˚±i⁄
(
obj
))

2145  
JS_EXCEPTION
;

2146 
	`JS_DeföePr›îtyVÆueSå
(
˘x
, 
obj
, "dev",

2147 
	`JS_NewI¡64
(
˘x
, 
°
.
°_dev
),

2148 
JS_PROP_C_W_E
);

2149 
	`JS_DeföePr›îtyVÆueSå
(
˘x
, 
obj
, "ino",

2150 
	`JS_NewI¡64
(
˘x
, 
°
.
°_öo
),

2151 
JS_PROP_C_W_E
);

2152 
	`JS_DeföePr›îtyVÆueSå
(
˘x
, 
obj
, "mode",

2153 
	`JS_NewI¡32
(
˘x
, 
°
.
°_mode
),

2154 
JS_PROP_C_W_E
);

2155 
	`JS_DeföePr›îtyVÆueSå
(
˘x
, 
obj
, "nlink",

2156 
	`JS_NewI¡64
(
˘x
, 
°
.
°_∆ök
),

2157 
JS_PROP_C_W_E
);

2158 
	`JS_DeföePr›îtyVÆueSå
(
˘x
, 
obj
, "uid",

2159 
	`JS_NewI¡64
(
˘x
, 
°
.
°_uid
),

2160 
JS_PROP_C_W_E
);

2161 
	`JS_DeföePr›îtyVÆueSå
(
˘x
, 
obj
, "gid",

2162 
	`JS_NewI¡64
(
˘x
, 
°
.
°_gid
),

2163 
JS_PROP_C_W_E
);

2164 
	`JS_DeföePr›îtyVÆueSå
(
˘x
, 
obj
, "rdev",

2165 
	`JS_NewI¡64
(
˘x
, 
°
.
°_rdev
),

2166 
JS_PROP_C_W_E
);

2167 
	`JS_DeföePr›îtyVÆueSå
(
˘x
, 
obj
, "size",

2168 
	`JS_NewI¡64
(
˘x
, 
°
.
°_size
),

2169 
JS_PROP_C_W_E
);

2170 
	`JS_DeföePr›îtyVÆueSå
(
˘x
, 
obj
, "blocks",

2171 
	`JS_NewI¡64
(
˘x
, 
°
.
°_blocks
),

2172 
JS_PROP_C_W_E
);

2173 #i‡
	`deföed
(
__APPLE__
)

2174 
	`JS_DeföePr›îtyVÆueSå
(
˘x
, 
obj
, "atime",

2175 
	`JS_NewI¡64
(
˘x
, 
	`time•ec_to_ms
(&
°
.
°_©ime•ec
)),

2176 
JS_PROP_C_W_E
);

2177 
	`JS_DeföePr›îtyVÆueSå
(
˘x
, 
obj
, "mtime",

2178 
	`JS_NewI¡64
(
˘x
, 
	`time•ec_to_ms
(&
°
.
°_mtime•ec
)),

2179 
JS_PROP_C_W_E
);

2180 
	`JS_DeföePr›îtyVÆueSå
(
˘x
, 
obj
, "ctime",

2181 
	`JS_NewI¡64
(
˘x
, 
	`time•ec_to_ms
(&
°
.
°_˘ime•ec
)),

2182 
JS_PROP_C_W_E
);

2184 
	`JS_DeföePr›îtyVÆueSå
(
˘x
, 
obj
, "atime",

2185 
	`JS_NewI¡64
(
˘x
, 
	`time•ec_to_ms
(&
°
.
°_©im
)),

2186 
JS_PROP_C_W_E
);

2187 
	`JS_DeföePr›îtyVÆueSå
(
˘x
, 
obj
, "mtime",

2188 
	`JS_NewI¡64
(
˘x
, 
	`time•ec_to_ms
(&
°
.
°_mtim
)),

2189 
JS_PROP_C_W_E
);

2190 
	`JS_DeföePr›îtyVÆueSå
(
˘x
, 
obj
, "ctime",

2191 
	`JS_NewI¡64
(
˘x
, 
	`time•ec_to_ms
(&
°
.
°_˘im
)),

2192 
JS_PROP_C_W_E
);

2195  
	`make_obj_îr‹
(
˘x
, 
obj
, 
îr
);

2196 
	}
}

2198 
JSVÆue
 
	$js_os_symlök
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

2199 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

2201 c⁄° *
èrgë
, *
lök∑th
;

2202 
îr
;

2204 
èrgë
 = 
	`JS_ToCSåög
(
˘x
, 
¨gv
[0]);

2205 i‡(!
èrgë
)

2206  
JS_EXCEPTION
;

2207 
lök∑th
 = 
	`JS_ToCSåög
(
˘x
, 
¨gv
[1]);

2208 i‡(!
lök∑th
) {

2209 
	`JS_FªeCSåög
(
˘x
, 
èrgë
);

2210  
JS_EXCEPTION
;

2212 
îr
 = 
	`js_gë_î∫o
(
	`symlök
(
èrgë
, 
lök∑th
));

2213 
	`JS_FªeCSåög
(
˘x
, 
èrgë
);

2214 
	`JS_FªeCSåög
(
˘x
, 
lök∑th
);

2215  
	`JS_NewI¡32
(
˘x
, 
îr
);

2216 
	}
}

2219 
JSVÆue
 
	$js_os_ªadlök
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

2220 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

2222 c⁄° *
∑th
;

2223 
buf
[
PATH_MAX
];

2224 
îr
;

2225 
ssize_t
 
ªs
;

2227 
∑th
 = 
	`JS_ToCSåög
(
˘x
, 
¨gv
[0]);

2228 i‡(!
∑th
)

2229  
JS_EXCEPTION
;

2230 
ªs
 = 
	`ªadlök
(
∑th
, 
buf
, (buf) - 1);

2231 i‡(
ªs
 < 0) {

2232 
buf
[0] = '\0';

2233 
îr
 = 
î∫o
;

2235 
buf
[
ªs
] = '\0';

2236 
îr
 = 0;

2238 
	`JS_FªeCSåög
(
˘x
, 
∑th
);

2239  
	`make_°rög_îr‹
(
˘x
, 
buf
, 
îr
);

2240 
	}
}

2243 
JSVÆue
 
	$js_os_ªaddú
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

2244 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

2246 c⁄° *
∑th
;

2247 
DIR
 *
f
;

2248 
dúít
 *
d
;

2249 
JSVÆue
 
obj
;

2250 
îr
;

2251 
uöt32_t
 
Àn
;

2253 
∑th
 = 
	`JS_ToCSåög
(
˘x
, 
¨gv
[0]);

2254 i‡(!
∑th
)

2255  
JS_EXCEPTION
;

2256 
obj
 = 
	`JS_NewAºay
(
˘x
);

2257 i‡(
	`JS_IsEx˚±i⁄
(
obj
)) {

2258 
	`JS_FªeCSåög
(
˘x
, 
∑th
);

2259  
JS_EXCEPTION
;

2261 
f
 = 
	`›ídú
(
∑th
);

2262 i‡(!
f
)

2263 
îr
 = 
î∫o
;

2265 
îr
 = 0;

2266 
	`JS_FªeCSåög
(
˘x
, 
∑th
);

2267 i‡(!
f
)

2268 
d⁄e
;

2269 
Àn
 = 0;

2271 
î∫o
 = 0;

2272 
d
 = 
	`ªaddú
(
f
);

2273 i‡(!
d
) {

2274 
îr
 = 
î∫o
;

2277 
	`JS_DeföePr›îtyVÆueUöt32
(
˘x
, 
obj
, 
Àn
++,

2278 
	`JS_NewSåög
(
˘x
, 
d
->
d_«me
),

2279 
JS_PROP_C_W_E
);

2281 
	`˛o£dú
(
f
);

2282 
d⁄e
:

2283  
	`make_obj_îr‹
(
˘x
, 
obj
, 
îr
);

2284 
	}
}

2286 
	$ms_to_timevÆ
(
timevÆ
 *
tv
, 
uöt64_t
 
v
)

2288 
tv
->
tv_£c
 = 
v
 / 1000;

2289 
tv
->
tv_u£c
 = (
v
 % 1000) * 1000;

2290 
	}
}

2292 
JSVÆue
 
	$js_os_utimes
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

2293 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

2295 c⁄° *
∑th
;

2296 
söt64_t
 
©ime
, 
mtime
;

2297 
ªt
;

2298 
timevÆ
 
times
[2];

2300 i‡(
	`JS_ToI¡64
(
˘x
, &
©ime
, 
¨gv
[1]))

2301  
JS_EXCEPTION
;

2302 i‡(
	`JS_ToI¡64
(
˘x
, &
mtime
, 
¨gv
[2]))

2303  
JS_EXCEPTION
;

2304 
∑th
 = 
	`JS_ToCSåög
(
˘x
, 
¨gv
[0]);

2305 i‡(!
∑th
)

2306  
JS_EXCEPTION
;

2307 
	`ms_to_timevÆ
(&
times
[0], 
©ime
);

2308 
	`ms_to_timevÆ
(&
times
[1], 
mtime
);

2309 
ªt
 = 
	`js_gë_î∫o
(
	`utimes
(
∑th
, 
times
));

2310 
	`JS_FªeCSåög
(
˘x
, 
∑th
);

2311  
	`JS_NewI¡32
(
˘x
, 
ªt
);

2312 
	}
}

2314 **
	$buûd_ívp
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
obj
)

2316 
uöt32_t
 
Àn
, 
i
;

2317 
JSPr›îtyEnum
 *
èb
;

2318 **
ívp
, *
∑ú
;

2319 c⁄° *
key
, *
°r
;

2320 
JSVÆue
 
vÆ
;

2321 
size_t
 
key_Àn
, 
°r_Àn
;

2323 i‡(
	`JS_GëOwnPr›îtyNames
(
˘x
, &
èb
, &
Àn
, 
obj
,

2324 
JS_GPN_STRING_MASK
 | 
JS_GPN_ENUM_ONLY
) < 0)

2325  
NULL
;

2326 
ívp
 = 
	`js_mÆlocz
(
˘x
, ”nvp[0]Ë* ((
size_t
)
Àn
 + 1));

2327 i‡(!
ívp
)

2328 
Áû
;

2329 
i
 = 0; i < 
Àn
; i++) {

2330 
vÆ
 = 
	`JS_GëPr›îty
(
˘x
, 
obj
, 
èb
[
i
].
©om
);

2331 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

2332 
Áû
;

2333 
°r
 = 
	`JS_ToCSåög
(
˘x
, 
vÆ
);

2334 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

2335 i‡(!
°r
)

2336 
Áû
;

2337 
key
 = 
	`JS_AtomToCSåög
(
˘x
, 
èb
[
i
].
©om
);

2338 i‡(!
key
) {

2339 
	`JS_FªeCSåög
(
˘x
, 
°r
);

2340 
Áû
;

2342 
key_Àn
 = 
	`°æí
(
key
);

2343 
°r_Àn
 = 
	`°æí
(
°r
);

2344 
∑ú
 = 
	`js_mÆloc
(
˘x
, 
key_Àn
 + 
°r_Àn
 + 2);

2345 i‡(!
∑ú
) {

2346 
	`JS_FªeCSåög
(
˘x
, 
key
);

2347 
	`JS_FªeCSåög
(
˘x
, 
°r
);

2348 
Áû
;

2350 
	`mem˝y
(
∑ú
, 
key
, 
key_Àn
);

2351 
∑ú
[
key_Àn
] = '=';

2352 
	`mem˝y
(
∑ú
 + 
key_Àn
 + 1, 
°r
, 
°r_Àn
);

2353 
∑ú
[
key_Àn
 + 1 + 
°r_Àn
] = '\0';

2354 
ívp
[
i
] = 
∑ú
;

2355 
	`JS_FªeCSåög
(
˘x
, 
key
);

2356 
	`JS_FªeCSåög
(
˘x
, 
°r
);

2358 
d⁄e
:

2359 
i
 = 0; i < 
Àn
; i++)

2360 
	`JS_FªeAtom
(
˘x
, 
èb
[
i
].
©om
);

2361 
	`js_‰ì
(
˘x
, 
èb
);

2362  
ívp
;

2363 
Áû
:

2364 i‡(
ívp
) {

2365 
i
 = 0; i < 
Àn
; i++)

2366 
	`js_‰ì
(
˘x
, 
ívp
[
i
]);

2367 
	`js_‰ì
(
˘x
, 
ívp
);

2368 
ívp
 = 
NULL
;

2370 
d⁄e
;

2371 
	}
}

2374 
	$my_execv≥
(c⁄° *
fûíame
, **
¨gv
, **
ívp
)

2376 *
∑th
, *
p
, *
p_√xt
, *
p1
;

2377 
buf
[
PATH_MAX
];

2378 
size_t
 
fûíame_Àn
, 
∑th_Àn
;

2379 
BOOL
 
óc˚s_îr‹
;

2381 
fûíame_Àn
 = 
	`°æí
(
fûíame
);

2382 i‡(
fûíame_Àn
 == 0) {

2383 
î∫o
 = 
ENOENT
;

2386 i‡(
	`°rchr
(
fûíame
, '/'))

2387  
	`execve
(
fûíame
, 
¨gv
, 
ívp
);

2389 
∑th
 = 
	`gëív
("PATH");

2390 i‡(!
∑th
)

2391 
∑th
 = "/bin:/usr/bin";

2392 
óc˚s_îr‹
 = 
FALSE
;

2393 
p
 = 
∑th
;

2394 
p
 = 
∑th
;Ö !
NULL
;Ö = 
p_√xt
) {

2395 
p1
 = 
	`°rchr
(
p
, ':');

2396 i‡(!
p1
) {

2397 
p_√xt
 = 
NULL
;

2398 
∑th_Àn
 = 
	`°æí
(
p
);

2400 
p_√xt
 = 
p1
 + 1;

2401 
∑th_Àn
 = 
p1
 - 
p
;

2404 i‡((
∑th_Àn
 + 1 + 
fûíame_Àn
 + 1Ë> 
PATH_MAX
)

2406 
	`mem˝y
(
buf
, 
p
, 
∑th_Àn
);

2407 
buf
[
∑th_Àn
] = '/';

2408 
	`mem˝y
(
buf
 + 
∑th_Àn
 + 1, 
fûíame
, 
fûíame_Àn
);

2409 
buf
[
∑th_Àn
 + 1 + 
fûíame_Àn
] = '\0';

2411 
	`execve
(
buf
, 
¨gv
, 
ívp
);

2413 
î∫o
) {

2414 
EACCES
:

2415 
óc˚s_îr‹
 = 
TRUE
;

2417 
ENOENT
:

2418 
ENOTDIR
:

2424 i‡(
óc˚s_îr‹
)

2425 
î∫o
 = 
EACCES
;

2427 
	}
}

2430 
JSVÆue
 
	$js_os_exec
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

2431 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

2433 
JSVÆueC⁄°
 
›ti⁄s
, 
¨gs
 = 
¨gv
[0];

2434 
JSVÆue
 
vÆ
, 
ªt_vÆ
;

2435 c⁄° **
exec_¨gv
, *
fûe
 = 
NULL
, *
°r
, *
cwd
 = NULL;

2436 **
ívp
 = 
ívú⁄
;

2437 
uöt32_t
 
exec_¨gc
, 
i
;

2438 
ªt
, 
pid
, 
°©us
;

2439 
BOOL
 
block_Êag
 = 
TRUE
, 
u£_∑th
 = TRUE;

2440 c⁄° *
°d_«me
[3] = { "stdin", "stdout", "stderr" };

2441 
°d_fds
[3];

2442 
uöt32_t
 
uid
 = -1, 
gid
 = -1;

2444 
vÆ
 = 
	`JS_GëPr›îtySå
(
˘x
, 
¨gs
, "length");

2445 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

2446  
JS_EXCEPTION
;

2447 
ªt
 = 
	`JS_ToUöt32
(
˘x
, &
exec_¨gc
, 
vÆ
);

2448 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

2449 i‡(
ªt
)

2450  
JS_EXCEPTION
;

2452 i‡(
exec_¨gc
 < 1 ||Éxec_argc > 65535) {

2453  
	`JS_ThrowTy≥Eº‹
(
˘x
, "invalidÇumber ofárguments");

2455 
exec_¨gv
 = 
	`js_mÆlocz
(
˘x
, ”xec_¨gv[0]Ë* (
exec_¨gc
 + 1));

2456 i‡(!
exec_¨gv
)

2457  
JS_EXCEPTION
;

2458 
i
 = 0; i < 
exec_¨gc
; i++) {

2459 
vÆ
 = 
	`JS_GëPr›îtyUöt32
(
˘x
, 
¨gs
, 
i
);

2460 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

2461 
ex˚±i⁄
;

2462 
°r
 = 
	`JS_ToCSåög
(
˘x
, 
vÆ
);

2463 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

2464 i‡(!
°r
)

2465 
ex˚±i⁄
;

2466 
exec_¨gv
[
i
] = 
°r
;

2468 
exec_¨gv
[
exec_¨gc
] = 
NULL
;

2470 
i
 = 0; i < 3; i++)

2471 
°d_fds
[
i
] = i;

2474 i‡(
¨gc
 >= 2) {

2475 
›ti⁄s
 = 
¨gv
[1];

2477 i‡(
	`gë_boﬁ_›ti⁄
(
˘x
, &
block_Êag
, 
›ti⁄s
, "block"))

2478 
ex˚±i⁄
;

2479 i‡(
	`gë_boﬁ_›ti⁄
(
˘x
, &
u£_∑th
, 
›ti⁄s
, "usePath"))

2480 
ex˚±i⁄
;

2482 
vÆ
 = 
	`JS_GëPr›îtySå
(
˘x
, 
›ti⁄s
, "file");

2483 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

2484 
ex˚±i⁄
;

2485 i‡(!
	`JS_IsUndeföed
(
vÆ
)) {

2486 
fûe
 = 
	`JS_ToCSåög
(
˘x
, 
vÆ
);

2487 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

2488 i‡(!
fûe
)

2489 
ex˚±i⁄
;

2492 
vÆ
 = 
	`JS_GëPr›îtySå
(
˘x
, 
›ti⁄s
, "cwd");

2493 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

2494 
ex˚±i⁄
;

2495 i‡(!
	`JS_IsUndeföed
(
vÆ
)) {

2496 
cwd
 = 
	`JS_ToCSåög
(
˘x
, 
vÆ
);

2497 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

2498 i‡(!
cwd
)

2499 
ex˚±i⁄
;

2503 
i
 = 0; i < 3; i++) {

2504 
vÆ
 = 
	`JS_GëPr›îtySå
(
˘x
, 
›ti⁄s
, 
°d_«me
[
i
]);

2505 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

2506 
ex˚±i⁄
;

2507 i‡(!
	`JS_IsUndeföed
(
vÆ
)) {

2508 
fd
;

2509 
ªt
 = 
	`JS_ToI¡32
(
˘x
, &
fd
, 
vÆ
);

2510 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

2511 i‡(
ªt
)

2512 
ex˚±i⁄
;

2513 
°d_fds
[
i
] = 
fd
;

2517 
vÆ
 = 
	`JS_GëPr›îtySå
(
˘x
, 
›ti⁄s
, "env");

2518 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

2519 
ex˚±i⁄
;

2520 i‡(!
	`JS_IsUndeföed
(
vÆ
)) {

2521 
ívp
 = 
	`buûd_ívp
(
˘x
, 
vÆ
);

2522 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

2523 i‡(!
ívp
)

2524 
ex˚±i⁄
;

2527 
vÆ
 = 
	`JS_GëPr›îtySå
(
˘x
, 
›ti⁄s
, "uid");

2528 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

2529 
ex˚±i⁄
;

2530 i‡(!
	`JS_IsUndeföed
(
vÆ
)) {

2531 
ªt
 = 
	`JS_ToUöt32
(
˘x
, &
uid
, 
vÆ
);

2532 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

2533 i‡(
ªt
)

2534 
ex˚±i⁄
;

2537 
vÆ
 = 
	`JS_GëPr›îtySå
(
˘x
, 
›ti⁄s
, "gid");

2538 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

2539 
ex˚±i⁄
;

2540 i‡(!
	`JS_IsUndeföed
(
vÆ
)) {

2541 
ªt
 = 
	`JS_ToUöt32
(
˘x
, &
gid
, 
vÆ
);

2542 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

2543 i‡(
ªt
)

2544 
ex˚±i⁄
;

2548 
pid
 = 
	`f‹k
();

2549 i‡(
pid
 < 0) {

2550 
	`JS_ThrowTy≥Eº‹
(
˘x
, "forkÉrror");

2551 
ex˚±i⁄
;

2553 i‡(
pid
 == 0) {

2555 
fd_max
 = 
	`sysc⁄f
(
_SC_OPEN_MAX
);

2558 
i
 = 0; i < 3; i++) {

2559 i‡(
°d_fds
[
i
] != i) {

2560 i‡(
	`dup2
(
°d_fds
[
i
], i) < 0)

2561 
	`_exô
(127);

2565 
i
 = 3; i < 
fd_max
; i++)

2566 
	`˛o£
(
i
);

2567 i‡(
cwd
) {

2568 i‡(
	`chdú
(
cwd
) < 0)

2569 
	`_exô
(127);

2571 i‡(
uid
 != -1) {

2572 i‡(
	`£tuid
(
uid
) < 0)

2573 
	`_exô
(127);

2575 i‡(
gid
 != -1) {

2576 i‡(
	`£tgid
(
gid
) < 0)

2577 
	`_exô
(127);

2580 i‡(!
fûe
)

2581 
fûe
 = 
exec_¨gv
[0];

2582 i‡(
u£_∑th
)

2583 
ªt
 = 
	`my_execv≥
(
fûe
, (**)
exec_¨gv
, 
ívp
);

2585 
ªt
 = 
	`execve
(
fûe
, (**)
exec_¨gv
, 
ívp
);

2586 
	`_exô
(127);

2589 i‡(
block_Êag
) {

2591 
ªt
 = 
	`waôpid
(
pid
, &
°©us
, 0);

2592 i‡(
ªt
 =
pid
) {

2593 i‡(
	`WIFEXITED
(
°©us
)) {

2594 
ªt
 = 
	`WEXITSTATUS
(
°©us
);

2596 } i‡(
	`WIFSIGNALED
(
°©us
)) {

2597 
ªt
 = -
	`WTERMSIG
(
°©us
);

2603 
ªt
 = 
pid
;

2605 
ªt_vÆ
 = 
	`JS_NewI¡32
(
˘x
, 
ªt
);

2606 
d⁄e
:

2607 
	`JS_FªeCSåög
(
˘x
, 
fûe
);

2608 
	`JS_FªeCSåög
(
˘x
, 
cwd
);

2609 
i
 = 0; i < 
exec_¨gc
; i++)

2610 
	`JS_FªeCSåög
(
˘x
, 
exec_¨gv
[
i
]);

2611 
	`js_‰ì
(
˘x
, 
exec_¨gv
);

2612 i‡(
ívp
 !
ívú⁄
) {

2613 **
p
;

2614 
p
 = 
ívp
;

2615 *
p
 !
NULL
) {

2616 
	`js_‰ì
(
˘x
, *
p
);

2617 
p
++;

2619 
	`js_‰ì
(
˘x
, 
ívp
);

2621  
ªt_vÆ
;

2622 
ex˚±i⁄
:

2623 
ªt_vÆ
 = 
JS_EXCEPTION
;

2624 
d⁄e
;

2625 
	}
}

2628 
JSVÆue
 
	$js_os_waôpid
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

2629 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

2631 
pid
, 
°©us
, 
›ti⁄s
, 
ªt
;

2632 
JSVÆue
 
obj
;

2634 i‡(
	`JS_ToI¡32
(
˘x
, &
pid
, 
¨gv
[0]))

2635  
JS_EXCEPTION
;

2636 i‡(
	`JS_ToI¡32
(
˘x
, &
›ti⁄s
, 
¨gv
[1]))

2637  
JS_EXCEPTION
;

2639 
ªt
 = 
	`waôpid
(
pid
, &
°©us
, 
›ti⁄s
);

2640 i‡(
ªt
 < 0) {

2641 
ªt
 = -
î∫o
;

2642 
°©us
 = 0;

2645 
obj
 = 
	`JS_NewAºay
(
˘x
);

2646 i‡(
	`JS_IsEx˚±i⁄
(
obj
))

2647  
obj
;

2648 
	`JS_DeföePr›îtyVÆueUöt32
(
˘x
, 
obj
, 0, 
	`JS_NewI¡32
(˘x, 
ªt
),

2649 
JS_PROP_C_W_E
);

2650 
	`JS_DeföePr›îtyVÆueUöt32
(
˘x
, 
obj
, 1, 
	`JS_NewI¡32
(˘x, 
°©us
),

2651 
JS_PROP_C_W_E
);

2652  
obj
;

2653 
	}
}

2656 
JSVÆue
 
	$js_os_pùe
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

2657 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

2659 
pùe_fds
[2], 
ªt
;

2660 
JSVÆue
 
obj
;

2662 
ªt
 = 
	`pùe
(
pùe_fds
);

2663 i‡(
ªt
 < 0)

2664  
JS_NULL
;

2665 
obj
 = 
	`JS_NewAºay
(
˘x
);

2666 i‡(
	`JS_IsEx˚±i⁄
(
obj
))

2667  
obj
;

2668 
	`JS_DeföePr›îtyVÆueUöt32
(
˘x
, 
obj
, 0, 
	`JS_NewI¡32
(˘x, 
pùe_fds
[0]),

2669 
JS_PROP_C_W_E
);

2670 
	`JS_DeföePr›îtyVÆueUöt32
(
˘x
, 
obj
, 1, 
	`JS_NewI¡32
(˘x, 
pùe_fds
[1]),

2671 
JS_PROP_C_W_E
);

2672  
obj
;

2673 
	}
}

2676 
JSVÆue
 
	$js_os_kûl
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

2677 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

2679 
pid
, 
sig
, 
ªt
;

2681 i‡(
	`JS_ToI¡32
(
˘x
, &
pid
, 
¨gv
[0]))

2682  
JS_EXCEPTION
;

2683 i‡(
	`JS_ToI¡32
(
˘x
, &
sig
, 
¨gv
[1]))

2684  
JS_EXCEPTION
;

2685 
ªt
 = 
	`js_gë_î∫o
(
	`kûl
(
pid
, 
sig
));

2686  
	`JS_NewI¡32
(
˘x
, 
ªt
);

2687 
	}
}

2690 
JSVÆue
 
	$js_os_¶ìp
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

2691 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

2693 
söt64_t
 
dñay
;

2694 
time•ec
 
ts
;

2695 
ªt
;

2697 i‡(
	`JS_ToI¡64
(
˘x
, &
dñay
, 
¨gv
[0]))

2698  
JS_EXCEPTION
;

2699 
ts
.
tv_£c
 = 
dñay
 / 1000;

2700 
ts
.
tv_n£c
 = (
dñay
 % 1000) * 1000000;

2701 
ªt
 = 
	`js_gë_î∫o
(
	`«no¶ìp
(&
ts
, 
NULL
));

2702  
	`JS_NewI¡32
(
˘x
, 
ªt
);

2703 
	}
}

2706 
JSVÆue
 
	$js_os_dup
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

2707 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

2709 
fd
, 
ªt
;

2711 i‡(
	`JS_ToI¡32
(
˘x
, &
fd
, 
¨gv
[0]))

2712  
JS_EXCEPTION
;

2713 
ªt
 = 
	`js_gë_î∫o
(
	`dup
(
fd
));

2714  
	`JS_NewI¡32
(
˘x
, 
ªt
);

2715 
	}
}

2718 
JSVÆue
 
	$js_os_dup2
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

2719 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

2721 
fd
, 
fd2
, 
ªt
;

2723 i‡(
	`JS_ToI¡32
(
˘x
, &
fd
, 
¨gv
[0]))

2724  
JS_EXCEPTION
;

2725 i‡(
	`JS_ToI¡32
(
˘x
, &
fd2
, 
¨gv
[1]))

2726  
JS_EXCEPTION
;

2727 
ªt
 = 
	`js_gë_î∫o
(
	`dup2
(
fd
, 
fd2
));

2728  
	`JS_NewI¡32
(
˘x
, 
ªt
);

2729 
	}
}

2733 #i‡
deföed
(
_WIN32
)

2734 
	#OS_PLATFORM
 "wö32"

	)

2735 #ñi‡
deföed
(
__APPLE__
)

2736 
	#OS_PLATFORM
 "d¨wö"

	)

2737 #ñi‡
deföed
(
EMSCRIPTEN
)

2738 
	#OS_PLATFORM
 "js"

	)

2740 
	#OS_PLATFORM
 "löux"

	)

2743 
	#OS_FLAG
(
x
Ë
	`JS_PROP_INT32_DEF
(#x, x, 
JS_PROP_CONFIGURABLE
 )

	)

2745 c⁄° 
JSCFun˘i⁄Li°E¡ry
 
	gjs_os_funcs
[] = {

2746 
JS_CFUNC_DEF
("›í", 2, 
js_os_›í
 ),

2747 
OS_FLAG
(
O_RDONLY
),

2748 
OS_FLAG
(
O_WRONLY
),

2749 
OS_FLAG
(
O_RDWR
),

2750 
OS_FLAG
(
O_APPEND
),

2751 
OS_FLAG
(
O_CREAT
),

2752 
OS_FLAG
(
O_EXCL
),

2753 
OS_FLAG
(
O_TRUNC
),

2754 #i‡
deföed
(
_WIN32
)

2755 
OS_FLAG
(
O_BINARY
),

2756 
OS_FLAG
(
O_TEXT
),

2758 
JS_CFUNC_DEF
("˛o£", 1, 
js_os_˛o£
 ),

2759 
JS_CFUNC_DEF
("£ek", 3, 
js_os_£ek
 ),

2760 
JS_CFUNC_MAGIC_DEF
("ªad", 4, 
js_os_ªad_wrôe
, 0 ),

2761 
JS_CFUNC_MAGIC_DEF
("wrôe", 4, 
js_os_ªad_wrôe
, 1 ),

2762 
JS_CFUNC_DEF
("ißây", 1, 
js_os_ißây
 ),

2763 
JS_CFUNC_DEF
("âyGëWöSize", 1, 
js_os_âyGëWöSize
 ),

2764 
JS_CFUNC_DEF
("âySëRaw", 1, 
js_os_âySëRaw
 ),

2765 
JS_CFUNC_DEF
("ªmove", 1, 
js_os_ªmove
 ),

2766 
JS_CFUNC_DEF
("ª«me", 2, 
js_os_ª«me
 ),

2767 
JS_CFUNC_MAGIC_DEF
("£tRódH™dÀr", 2, 
js_os_£tRódH™dÀr
, 0 ),

2768 
JS_CFUNC_MAGIC_DEF
("£tWrôeH™dÀr", 2, 
js_os_£tRódH™dÀr
, 1 ),

2769 
JS_CFUNC_DEF
("sig«l", 2, 
js_os_sig«l
 ),

2770 
OS_FLAG
(
SIGINT
),

2771 
OS_FLAG
(
SIGABRT
),

2772 
OS_FLAG
(
SIGFPE
),

2773 
OS_FLAG
(
SIGILL
),

2774 
OS_FLAG
(
SIGSEGV
),

2775 
OS_FLAG
(
SIGTERM
),

2776 #i‡!
deföed
(
_WIN32
)

2777 
OS_FLAG
(
SIGQUIT
),

2778 
OS_FLAG
(
SIGPIPE
),

2779 
OS_FLAG
(
SIGALRM
),

2780 
OS_FLAG
(
SIGUSR1
),

2781 
OS_FLAG
(
SIGUSR2
),

2782 
OS_FLAG
(
SIGCHLD
),

2783 
OS_FLAG
(
SIGCONT
),

2784 
OS_FLAG
(
SIGSTOP
),

2785 
OS_FLAG
(
SIGTSTP
),

2786 
OS_FLAG
(
SIGTTIN
),

2787 
OS_FLAG
(
SIGTTOU
),

2789 
JS_CFUNC_DEF
("£tTimeout", 2, 
js_os_£tTimeout
 ),

2790 
JS_CFUNC_DEF
("˛órTimeout", 1, 
js_os_˛órTimeout
 ),

2791 
JS_PROP_STRING_DEF
("∂©f‹m", 
OS_PLATFORM
, 0 ),

2792 
JS_CFUNC_DEF
("gëcwd", 0, 
js_os_gëcwd
 ),

2793 #i‡!
deföed
(
_WIN32
)

2794 
JS_CFUNC_DEF
("chdú", 0, 
js_os_chdú
 ),

2795 
JS_CFUNC_DEF
("ªÆ∑th", 1, 
js_os_ªÆ∑th
 ),

2796 
JS_CFUNC_DEF
("mkdú", 1, 
js_os_mkdú
 ),

2797 
JS_CFUNC_MAGIC_DEF
("°©", 1, 
js_os_°©
, 0 ),

2798 
JS_CFUNC_MAGIC_DEF
("l°©", 1, 
js_os_°©
, 1 ),

2800 
OS_FLAG
(
S_IFMT
),

2801 
OS_FLAG
(
S_IFIFO
),

2802 
OS_FLAG
(
S_IFCHR
),

2803 
OS_FLAG
(
S_IFDIR
),

2804 
OS_FLAG
(
S_IFBLK
),

2805 
OS_FLAG
(
S_IFREG
),

2806 
OS_FLAG
(
S_IFSOCK
),

2807 
OS_FLAG
(
S_IFLNK
),

2808 
OS_FLAG
(
S_ISGID
),

2809 
OS_FLAG
(
S_ISUID
),

2810 
JS_CFUNC_DEF
("symlök", 2, 
js_os_symlök
 ),

2811 
JS_CFUNC_DEF
("ªadlök", 1, 
js_os_ªadlök
 ),

2812 
JS_CFUNC_DEF
("ªaddú", 1, 
js_os_ªaddú
 ),

2813 
JS_CFUNC_DEF
("utimes", 3, 
js_os_utimes
 ),

2814 
JS_CFUNC_DEF
("exec", 1, 
js_os_exec
 ),

2815 
JS_CFUNC_DEF
("waôpid", 2, 
js_os_waôpid
 ),

2816 
OS_FLAG
(
WNOHANG
),

2817 
JS_CFUNC_DEF
("pùe", 0, 
js_os_pùe
 ),

2818 
JS_CFUNC_DEF
("kûl", 2, 
js_os_kûl
 ),

2819 
JS_CFUNC_DEF
("¶ìp", 1, 
js_os_¶ìp
 ),

2820 
JS_CFUNC_DEF
("dup", 1, 
js_os_dup
 ),

2821 
JS_CFUNC_DEF
("dup2", 2, 
js_os_dup2
 ),

2825 
	$js_os_öô
(
JSC⁄ãxt
 *
˘x
, 
JSModuÀDef
 *
m
)

2827 
os_pﬁl_func
 = 
js_os_pﬁl
;

2830 
	`JS_NewCœssID
(&
js_os_timî_˛ass_id
);

2831 
	`JS_NewCœss
(
	`JS_GëRu¡ime
(
˘x
), 
js_os_timî_˛ass_id
, &
js_os_timî_˛ass
);

2833  
	`JS_SëModuÀExp‹tLi°
(
˘x
, 
m
, 
js_os_funcs
,

2834 
	`cou¡of
(
js_os_funcs
));

2835 
	}
}

2837 
JSModuÀDef
 *
	$js_öô_moduÀ_os
(
JSC⁄ãxt
 *
˘x
, c⁄° *
moduÀ_«me
)

2839 
JSModuÀDef
 *
m
;

2840 
m
 = 
	`JS_NewCModuÀ
(
˘x
, 
moduÀ_«me
, 
js_os_öô
);

2841 i‡(!
m
)

2842  
NULL
;

2843 
	`JS_AddModuÀExp‹tLi°
(
˘x
, 
m
, 
js_os_funcs
, 
	`cou¡of
(js_os_funcs));

2844  
m
;

2845 
	}
}

2849 
JSVÆue
 
	$js_¥öt
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

2850 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

2852 
i
;

2853 c⁄° *
°r
;

2854 
size_t
 
Àn
;

2856 
i
 = 0; i < 
¨gc
; i++) {

2857 i‡(
i
 != 0)

2858 
	`putch¨
(' ');

2859 
°r
 = 
	`JS_ToCSåögLí
(
˘x
, &
Àn
, 
¨gv
[
i
]);

2860 i‡(!
°r
)

2861  
JS_EXCEPTION
;

2862 
	`fwrôe
(
°r
, 1, 
Àn
, 
°dout
);

2863 
	`JS_FªeCSåög
(
˘x
, 
°r
);

2865 
	`putch¨
('\n');

2866  
JS_UNDEFINED
;

2867 
	}
}

2869 
	$js_°d_add_hñ≥rs
(
JSC⁄ãxt
 *
˘x
, 
¨gc
, **
¨gv
)

2871 
JSVÆue
 
globÆ_obj
, 
c⁄sﬁe
, 
¨gs
;

2872 
i
;

2875 
globÆ_obj
 = 
	`JS_GëGlobÆObje˘
(
˘x
);

2877 
c⁄sﬁe
 = 
	`JS_NewObje˘
(
˘x
);

2878 
	`JS_SëPr›îtySå
(
˘x
, 
c⁄sﬁe
, "log",

2879 
	`JS_NewCFun˘i⁄
(
˘x
, 
js_¥öt
, "log", 1));

2880 
	`JS_SëPr›îtySå
(
˘x
, 
globÆ_obj
, "c⁄sﬁe", 
c⁄sﬁe
);

2883 
¨gs
 = 
	`JS_NewAºay
(
˘x
);

2884 
i
 = 0; i < 
¨gc
; i++) {

2885 
	`JS_SëPr›îtyUöt32
(
˘x
, 
¨gs
, 
i
, 
	`JS_NewSåög
(˘x, 
¨gv
[i]));

2887 
	`JS_SëPr›îtySå
(
˘x
, 
globÆ_obj
, "s¸ùtArgs", 
¨gs
);

2889 
	`JS_SëPr›îtySå
(
˘x
, 
globÆ_obj
, "print",

2890 
	`JS_NewCFun˘i⁄
(
˘x
, 
js_¥öt
, "print", 1));

2891 
	`JS_SëPr›îtySå
(
˘x
, 
globÆ_obj
, "__loadScript",

2892 
	`JS_NewCFun˘i⁄
(
˘x
, 
js_lﬂdS¸ùt
, "__loadScript", 1));

2894 
	`JS_FªeVÆue
(
˘x
, 
globÆ_obj
);

2897 
	`öô_li°_hód
(&
os_rw_h™dÀrs
);

2898 
	`öô_li°_hód
(&
os_sig«l_h™dÀrs
);

2899 
	`öô_li°_hód
(&
os_timîs
);

2900 
os_≥ndög_sig«ls
 = 0;

2901 
	}
}

2903 
	$js_°d_‰ì_h™dÀrs
(
JSRu¡ime
 *
π
)

2905 
li°_hód
 *
ñ
, *
ñ1
;

2907 
	`li°_f‹_óch_ß„
(
ñ
, 
ñ1
, &
os_rw_h™dÀrs
) {

2908 
JSOSRWH™dÀr
 *
rh
 = 
	`li°_íåy
(
ñ
, JSOSRWH™dÀr, 
lök
);

2909 
	`‰ì_rw_h™dÀr
(
π
, 
rh
);

2912 
	`li°_f‹_óch_ß„
(
ñ
, 
ñ1
, &
os_sig«l_h™dÀrs
) {

2913 
JSOSSig«lH™dÀr
 *
sh
 = 
	`li°_íåy
(
ñ
, JSOSSig«lH™dÀr, 
lök
);

2914 
	`‰ì_sh
(
π
, 
sh
);

2917 
	`li°_f‹_óch_ß„
(
ñ
, 
ñ1
, &
os_timîs
) {

2918 
JSOSTimî
 *
th
 = 
	`li°_íåy
(
ñ
, JSOSTimî, 
lök
);

2919 
	`u∆ök_timî
(
π
, 
th
);

2920 i‡(!
th
->
has_obje˘
)

2921 
	`‰ì_timî
(
π
, 
th
);

2923 
	}
}

2925 
	$js_dump_obj
(
JSC⁄ãxt
 *
˘x
, 
FILE
 *
f
, 
JSVÆueC⁄°
 
vÆ
)

2927 c⁄° *
°r
;

2929 
°r
 = 
	`JS_ToCSåög
(
˘x
, 
vÆ
);

2930 i‡(
°r
) {

2931 
	`Ârötf
(
f
, "%s\n", 
°r
);

2932 
	`JS_FªeCSåög
(
˘x
, 
°r
);

2934 
	`Ârötf
(
f
, "[exception]\n");

2936 
	}
}

2938 
	$js_°d_dump_îr‹1
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
ex˚±i⁄_vÆ
)

2940 
JSVÆue
 
vÆ
;

2941 
BOOL
 
is_îr‹
;

2943 
is_îr‹
 = 
	`JS_IsEº‹
(
˘x
, 
ex˚±i⁄_vÆ
);

2944 
	`js_dump_obj
(
˘x
, 
°dîr
, 
ex˚±i⁄_vÆ
);

2945 i‡(
is_îr‹
) {

2946 
vÆ
 = 
	`JS_GëPr›îtySå
(
˘x
, 
ex˚±i⁄_vÆ
, "stack");

2947 i‡(!
	`JS_IsUndeföed
(
vÆ
)) {

2948 
	`js_dump_obj
(
˘x
, 
°dîr
, 
vÆ
);

2950 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

2952 
	}
}

2954 
	$js_°d_dump_îr‹
(
JSC⁄ãxt
 *
˘x
)

2956 
JSVÆue
 
ex˚±i⁄_vÆ
;

2958 
ex˚±i⁄_vÆ
 = 
	`JS_GëEx˚±i⁄
(
˘x
);

2959 
	`js_°d_dump_îr‹1
(
˘x
, 
ex˚±i⁄_vÆ
);

2960 
	`JS_FªeVÆue
(
˘x
, 
ex˚±i⁄_vÆ
);

2961 
	}
}

2963 
	$js_°d_¥omi£_ªje˘i⁄_åackî
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
¥omi£
,

2964 
JSVÆueC⁄°
 
ªas⁄
,

2965 
BOOL
 
is_h™dÀd
, *
›aque
)

2967 i‡(!
is_h™dÀd
) {

2968 
	`Ârötf
(
°dîr
, "Possibly unhandledÖromiseÑejection: ");

2969 
	`js_°d_dump_îr‹1
(
˘x
, 
ªas⁄
);

2971 
	}
}

2974 
	$js_°d_lo›
(
JSC⁄ãxt
 *
˘x
)

2976 
JSC⁄ãxt
 *
˘x1
;

2977 
îr
;

2982 
îr
 = 
	`JS_ExecuãPídögJob
(
	`JS_GëRu¡ime
(
˘x
), &
˘x1
);

2983 i‡(
îr
 <= 0) {

2984 i‡(
îr
 < 0) {

2985 
	`js_°d_dump_îr‹
(
˘x1
);

2991 i‡(!
os_pﬁl_func
 || 
	`os_pﬁl_func
(
˘x
))

2994 
	}
}

2996 
	$js_°d_evÆ_bö¨y
(
JSC⁄ãxt
 *
˘x
, c⁄° 
uöt8_t
 *
buf
, 
size_t
 
buf_Àn
,

2997 
lﬂd_⁄ly
)

2999 
JSVÆue
 
obj
, 
vÆ
;

3000 
obj
 = 
	`JS_RódObje˘
(
˘x
, 
buf
, 
buf_Àn
, 
JS_READ_OBJ_BYTECODE
);

3001 i‡(
	`JS_IsEx˚±i⁄
(
obj
))

3002 
ex˚±i⁄
;

3003 i‡(
lﬂd_⁄ly
) {

3004 i‡(
	`JS_VALUE_GET_TAG
(
obj
Ë=
JS_TAG_MODULE
) {

3005 
	`js_moduÀ_£t_imp‹t_mëa
(
˘x
, 
obj
, 
FALSE
, FALSE);

3008 i‡(
	`JS_VALUE_GET_TAG
(
obj
Ë=
JS_TAG_MODULE
) {

3009 i‡(
	`JS_ResﬁveModuÀ
(
˘x
, 
obj
) < 0) {

3010 
	`JS_FªeVÆue
(
˘x
, 
obj
);

3011 
ex˚±i⁄
;

3013 
	`js_moduÀ_£t_imp‹t_mëa
(
˘x
, 
obj
, 
FALSE
, 
TRUE
);

3015 
vÆ
 = 
	`JS_EvÆFun˘i⁄
(
˘x
, 
obj
);

3016 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
)) {

3017 
ex˚±i⁄
:

3018 
	`js_°d_dump_îr‹
(
˘x
);

3019 
	`exô
(1);

3021 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

3023 
	}
}

	@quickjs.c

26 
	#CONFIG_VERSION
 "NAUT_0"

27 

	)

29 
	~<π/js/li°.h
>

30 
	~<π/js/quickjs.h
>

31 
	~<π/js/libªgexp.h
>

32 
	~<π/js/cutûs.h
>

35 #ifde‡
CONFIG_BIGNUM


36 
	~"libbf.h
"

40 
	#OPTIMIZE
 1

	)

41 
	#SHORT_OPCODES
 1

	)

42 #i‡
deföed
(
EMSCRIPTEN
)

43 
	#DIRECT_DISPATCH
 0

	)

45 
	#DIRECT_DISPATCH
 1

	)

48 #i‡
deföed
(
__APPLE__
)

49 
	#MALLOC_OVERHEAD
 0

	)

51 
	#MALLOC_OVERHEAD
 8

	)

54 #i‡!
deföed
(
_WIN32
)

56 
	#CONFIG_PRINTF_RNDN


	)

61 #i‡!
deföed
(
EMSCRIPTEN
)

62 
	#CONFIG_ATOMICS


	)

95 #ifde‡
CONFIG_ATOMICS


106 
	mJS_CLASS_OBJECT
 = 1,

107 
	mJS_CLASS_ARRAY
,

108 
	mJS_CLASS_ERROR
,

109 
	mJS_CLASS_NUMBER
,

110 
	mJS_CLASS_STRING
,

111 
	mJS_CLASS_BOOLEAN
,

112 
	mJS_CLASS_SYMBOL
,

113 
	mJS_CLASS_ARGUMENTS
,

114 
	mJS_CLASS_MAPPED_ARGUMENTS
,

115 
	mJS_CLASS_DATE
,

116 
	mJS_CLASS_MODULE_NS
,

117 
	mJS_CLASS_C_FUNCTION
,

118 
	mJS_CLASS_BYTECODE_FUNCTION
,

119 
	mJS_CLASS_BOUND_FUNCTION
,

120 
	mJS_CLASS_C_FUNCTION_DATA
,

121 
	mJS_CLASS_GENERATOR_FUNCTION
,

122 
	mJS_CLASS_FOR_IN_ITERATOR
,

123 
	mJS_CLASS_REGEXP
,

124 
	mJS_CLASS_ARRAY_BUFFER
,

125 
	mJS_CLASS_SHARED_ARRAY_BUFFER
,

126 
	mJS_CLASS_UINT8C_ARRAY
,

127 
	mJS_CLASS_INT8_ARRAY
,

128 
	mJS_CLASS_UINT8_ARRAY
,

129 
	mJS_CLASS_INT16_ARRAY
,

130 
	mJS_CLASS_UINT16_ARRAY
,

131 
	mJS_CLASS_INT32_ARRAY
,

132 
	mJS_CLASS_UINT32_ARRAY
,

133 #ifde‡
CONFIG_BIGNUM


134 
	mJS_CLASS_BIG_INT64_ARRAY
,

135 
	mJS_CLASS_BIG_UINT64_ARRAY
,

137 
	mJS_CLASS_FLOAT32_ARRAY
,

138 
	mJS_CLASS_FLOAT64_ARRAY
,

139 
	mJS_CLASS_DATAVIEW
,

140 #ifde‡
CONFIG_BIGNUM


141 
	mJS_CLASS_BIG_INT
,

142 
	mJS_CLASS_BIG_FLOAT
,

143 
	mJS_CLASS_FLOAT_ENV
,

144 
	mJS_CLASS_BIG_DECIMAL
,

145 
	mJS_CLASS_OPERATOR_SET
,

147 
	mJS_CLASS_MAP
,

148 
	mJS_CLASS_SET
,

149 
	mJS_CLASS_WEAKMAP
,

150 
	mJS_CLASS_WEAKSET
,

151 
	mJS_CLASS_MAP_ITERATOR
,

152 
	mJS_CLASS_SET_ITERATOR
,

153 
	mJS_CLASS_ARRAY_ITERATOR
,

154 
	mJS_CLASS_STRING_ITERATOR
,

155 
	mJS_CLASS_REGEXP_STRING_ITERATOR
,

156 
	mJS_CLASS_GENERATOR
,

157 
	mJS_CLASS_PROXY
,

158 
	mJS_CLASS_PROMISE
,

159 
	mJS_CLASS_PROMISE_RESOLVE_FUNCTION
,

160 
	mJS_CLASS_PROMISE_REJECT_FUNCTION
,

161 
	mJS_CLASS_ASYNC_FUNCTION
,

162 
	mJS_CLASS_ASYNC_FUNCTION_RESOLVE
,

163 
	mJS_CLASS_ASYNC_FUNCTION_REJECT
,

164 
	mJS_CLASS_ASYNC_FROM_SYNC_ITERATOR
,

165 
	mJS_CLASS_ASYNC_GENERATOR_FUNCTION
,

166 
	mJS_CLASS_ASYNC_GENERATOR
,

168 
	mJS_CLASS_INIT_COUNT
,

172 
	#JS_TYPED_ARRAY_COUNT
 (
JS_CLASS_FLOAT64_ARRAY
 - 
JS_CLASS_UINT8C_ARRAY
 + 1)

	)

173 
uöt8_t
 c⁄° 
	gty≥d_¨øy_size_log2
[
JS_TYPED_ARRAY_COUNT
];

174 
	#ty≥d_¨øy_size_log2
(
˛assid
Ë(
ty≥d_¨øy_size_log2
[(˛assid)- 
JS_CLASS_UINT8C_ARRAY
])

	)

176 
	eJSEº‹Enum
 {

177 
	mJS_EVAL_ERROR
,

178 
	mJS_RANGE_ERROR
,

179 
	mJS_REFERENCE_ERROR
,

180 
	mJS_SYNTAX_ERROR
,

181 
	mJS_TYPE_ERROR
,

182 
	mJS_URI_ERROR
,

183 
	mJS_INTERNAL_ERROR
,

184 
	mJS_AGGREGATE_ERROR
,

186 
	mJS_NATIVE_ERROR_COUNT
,

187 } 
	tJSEº‹Enum
;

189 
	#JS_MAX_LOCAL_VARS
 65536

	)

190 
	#JS_STACK_SIZE_MAX
 65536

	)

191 
	#JS_STRING_LEN_MAX
 ((1 << 30Ë- 1)

	)

193 
	#__ex˚±i⁄
 
	`__©åibuã__
((
w¨n_unu£d_ªsu…
))

	)

195 
JSSh≠e
 
	tJSSh≠e
;

196 
JSSåög
 
	tJSSåög
;

197 
JSSåög
 
	tJSAtomSåu˘
;

200 
	mJS_GC_PHASE_NONE
,

201 
	mJS_GC_PHASE_DECREF
,

202 
	mJS_GC_PHASE_REMOVE_CYCLES
,

203 } 
	tJSGCPha£Enum
;

205 
OPCodeEnum
 
	tOPCodeEnum
;

207 #ifde‡
CONFIG_BIGNUM


211 
JSVÆue
 (*
to_°rög
)(
JSC⁄ãxt
 *
	m˘x
, 
JSVÆueC⁄°
 
	mvÆ
);

212 
JSVÆue
 (*
‰om_°rög
)(
JSC⁄ãxt
 *
	m˘x
, c⁄° *
	mbuf
,

213 
	mødix
, 
	mÊags
, 
¶imb_t
 *
	m≥xp⁄ít
);

214 (*
	mu«ry_¨ôh
)(
JSC⁄ãxt
 *
	m˘x
,

215 
JSVÆue
 *
	m¥es
, 
OPCodeEnum
 
	m›
, JSVÆuê
	m›1
);

216 (*
	mbö¨y_¨ôh
)(
JSC⁄ãxt
 *
	m˘x
, 
OPCodeEnum
 
	m›
,

217 
JSVÆue
 *
	m¥es
, JSVÆuê
	m›1
, JSVÆuê
	m›2
);

218 (*
	mcom∑ª
)(
JSC⁄ãxt
 *
	m˘x
, 
OPCodeEnum
 
	m›
,

219 
JSVÆue
 
	m›1
, JSVÆuê
	m›2
);

221 
JSVÆue
 (*
mul_pow10_to_Êﬂt64
)(
JSC⁄ãxt
 *
	m˘x
, c⁄° 
bf_t
 *
	ma
,

222 
öt64_t
 
	mexp⁄ít
);

223 (*
	mmul_pow10
)(
JSC⁄ãxt
 *
	m˘x
, 
JSVÆue
 *
	m•
);

224 } 
	tJSNumîicO≥øti⁄s
;

227 
	sJSRu¡ime
 {

228 
JSMÆlocFun˘i⁄s
 
	mmf
;

229 
JSMÆlocSèã
 
	mmÆloc_°©e
;

230 c⁄° *
	mπ_öfo
;

232 
	m©om_hash_size
;

233 
	m©om_cou¡
;

234 
	m©om_size
;

235 
	m©om_cou¡_ªsize
;

236 
uöt32_t
 *
	m©om_hash
;

237 
JSAtomSåu˘
 **
	m©om_¨øy
;

238 
	m©om_‰ì_ödex
;

240 
	m˛ass_cou¡
;

241 
JSCœss
 *
	m˛ass_¨øy
;

243 
li°_hód
 
	mc⁄ãxt_li°
;

246 
li°_hód
 
	mgc_obj_li°
;

248 
li°_hód
 
	mgc_zîo_ªf_cou¡_li°
;

249 
li°_hód
 
	mtmp_obj_li°
;

250 
JSGCPha£Enum
 
	mgc_pha£
 : 8;

251 
size_t
 
	mmÆloc_gc_thªshﬁd
;

252 #ifde‡
DUMP_LEAKS


253 
li°_hód
 
	m°rög_li°
;

256 c⁄° 
uöt8_t
 *
	m°ack_t›
;

257 
size_t
 
	m°ack_size
;

259 
JSVÆue
 
	mcuºít_ex˚±i⁄
;

261 
BOOL
 
	mö_out_of_mem‹y
 : 8;

263 
JSSèckFøme
 *
	mcuºít_°ack_‰ame
;

265 
JSI¡îru±H™dÀr
 *
	möãºu±_h™dÀr
;

266 *
	möãºu±_›aque
;

268 
JSHo°Promi£Reje˘i⁄Tøckî
 *
	mho°_¥omi£_ªje˘i⁄_åackî
;

269 *
	mho°_¥omi£_ªje˘i⁄_åackî_›aque
;

271 
li°_hód
 
	mjob_li°
;

273 
JSModuÀN‹mÆizeFunc
 *
	mmoduÀ_n‹mÆize_func
;

274 
JSModuÀLﬂdîFunc
 *
	mmoduÀ_lﬂdî_func
;

275 *
	mmoduÀ_lﬂdî_›aque
;

277 
BOOL
 
	mˇn_block
 : 8;

280 
	msh≠e_hash_bôs
;

281 
	msh≠e_hash_size
;

282 
	msh≠e_hash_cou¡
;

283 
JSSh≠e
 **
	msh≠e_hash
;

284 #ifde‡
CONFIG_BIGNUM


285 
bf_c⁄ãxt_t
 
	mbf_˘x
;

286 
JSNumîicO≥øti⁄s
 
	mbigöt_›s
;

287 
JSNumîicO≥øti⁄s
 
	mbigÊﬂt_›s
;

288 
JSNumîicO≥øti⁄s
 
	mbigdecimÆ_›s
;

289 
uöt32_t
 
	m›î©‹_cou¡
;

291 *
	mu£r_›aque
;

294 
	sJSCœss
 {

295 
uöt32_t
 
	m˛ass_id
;

296 
JSAtom
 
	m˛ass_«me
;

297 
JSCœssFöÆizî
 *
	mföÆizî
;

298 
JSCœssGCM¨k
 *
	mgc_m¨k
;

299 
JSCœssCÆl
 *
	mˇŒ
;

301 c⁄° 
JSCœssExŸicMëhods
 *
	mexŸic
;

304 
	#JS_MODE_STRICT
 (1 << 0)

	)

305 
	#JS_MODE_STRIP
 (1 << 1)

	)

306 
	#JS_MODE_MATH
 (1 << 2)

	)

308 
	sJSSèckFøme
 {

309 
JSSèckFøme
 *
	m¥ev_‰ame
;

310 
JSVÆue
 
	mcur_func
;

311 
JSVÆue
 *
	m¨g_buf
;

312 
JSVÆue
 *
	mv¨_buf
;

313 
li°_hód
 
	mv¨_ªf_li°
;

314 c⁄° 
uöt8_t
 *
	mcur_pc
;

316 
	m¨g_cou¡
;

317 
	mjs_mode
;

320 
JSVÆue
 *
	mcur_•
;

321 } 
	tJSSèckFøme
;

324 
	mJS_GC_OBJ_TYPE_JS_OBJECT
,

325 
	mJS_GC_OBJ_TYPE_FUNCTION_BYTECODE
,

326 
	mJS_GC_OBJ_TYPE_SHAPE
,

327 
	mJS_GC_OBJ_TYPE_VAR_REF
,

328 
	mJS_GC_OBJ_TYPE_ASYNC_FUNCTION
,

329 
	mJS_GC_OBJ_TYPE_JS_CONTEXT
,

330 } 
	tJSGCObje˘Ty≥Enum
;

335 
	sJSGCObje˘Hódî
 {

336 
	mªf_cou¡
;

337 
JSGCObje˘Ty≥Enum
 
	mgc_obj_ty≥
 : 4;

338 
uöt8_t
 
	mm¨k
 : 4;

339 
uöt8_t
 
	mdummy1
;

340 
uöt16_t
 
	mdummy2
;

341 
li°_hód
 
	mlök
;

344 
	sJSV¨Ref
 {

346 
JSGCObje˘Hódî
 
	mhódî
;

348 
	m__gc_ªf_cou¡
;

349 
uöt8_t
 
	m__gc_m¨k
;

355 
uöt8_t
 
	mis_dëached
 : 1;

356 
uöt8_t
 
	mis_¨g
 : 1;

357 
uöt16_t
 
	mv¨_idx
;

361 
JSVÆue
 *
	mpvÆue
;

363 
JSVÆue
 
	mvÆue
;

364 } 
	tJSV¨Ref
;

366 #ifde‡
CONFIG_BIGNUM


367 
	sJSFlﬂtEnv
 {

368 
limb_t
 
	m¥ec
;

369 
bf_Êags_t
 
	mÊags
;

370 
	m°©us
;

371 } 
	tJSFlﬂtEnv
;

375 
	sJSBigFlﬂt
 {

376 
JSRefCou¡Hódî
 
	mhódî
;

377 
bf_t
 
	mnum
;

378 } 
	tJSBigFlﬂt
;

380 
	sJSBigDecimÆ
 {

381 
JSRefCou¡Hódî
 
	mhódî
;

382 
bfdec_t
 
	mnum
;

383 } 
	tJSBigDecimÆ
;

387 
	mJS_AUTOINIT_ID_PROTOTYPE
,

388 
	mJS_AUTOINIT_ID_MODULE_NS
,

389 
	mJS_AUTOINIT_ID_PROP
,

390 } 
	tJSAutoInôIDEnum
;

394 
	#JS_INTERRUPT_COUNTER_INIT
 10000

	)

396 
	sJSC⁄ãxt
 {

397 
JSGCObje˘Hódî
 
	mhódî
;

398 
JSRu¡ime
 *
	mπ
;

399 
li°_hód
 
	mlök
;

401 
uöt16_t
 
	mbö¨y_obje˘_cou¡
;

402 
	mbö¨y_obje˘_size
;

404 
JSSh≠e
 *
	m¨øy_sh≠e
;

406 
JSVÆue
 *
	m˛ass_¥Ÿo
;

407 
JSVÆue
 
	mfun˘i⁄_¥Ÿo
;

408 
JSVÆue
 
	mfun˘i⁄_˘‹
;

409 
JSVÆue
 
	m¨øy_˘‹
;

410 
JSVÆue
 
	mªgexp_˘‹
;

411 
JSVÆue
 
	m¥omi£_˘‹
;

412 
JSVÆue
 
	m«tive_îr‹_¥Ÿo
[
JS_NATIVE_ERROR_COUNT
];

413 
JSVÆue
 
	môî©‹_¥Ÿo
;

414 
JSVÆue
 
	masync_ôî©‹_¥Ÿo
;

415 
JSVÆue
 
	m¨øy_¥Ÿo_vÆues
;

416 
JSVÆue
 
	mthrow_ty≥_îr‹
;

417 
JSVÆue
 
	mevÆ_obj
;

419 
JSVÆue
 
	mglobÆ_obj
;

420 
JSVÆue
 
	mglobÆ_v¨_obj
;

422 
uöt64_t
 
	møndom_°©e
;

423 #ifde‡
CONFIG_BIGNUM


424 
bf_c⁄ãxt_t
 *
	mbf_˘x
;

425 
JSFlﬂtEnv
 
	mÂ_ív
;

426 
BOOL
 
	mbignum_ext
 : 8;

427 
BOOL
 
	mÆlow_›î©‹_ovîlﬂdög
 : 8;

430 
	möãºu±_cou¡î
;

431 
BOOL
 
	mis_îr‹_¥›îty_íabÀd
;

433 
li°_hód
 
	mlﬂded_moduÀs
;

436 
JSVÆue
 (*
compûe_ªgexp
)(
JSC⁄ãxt
 *
	m˘x
, 
JSVÆueC⁄°
 
	m∑âîn
,

437 
JSVÆueC⁄°
 
	mÊags
);

439 
JSVÆue
 (*
evÆ_öã∫Æ
)(
JSC⁄ãxt
 *
	m˘x
, 
JSVÆueC⁄°
 
	mthis_obj
,

440 c⁄° *
	möput
, 
size_t
 
	möput_Àn
,

441 c⁄° *
	mfûíame
, 
	mÊags
, 
	msc›e_idx
);

442 *
	mu£r_›aque
;

445 
	uJSFlﬂt64Uni⁄
 {

446 
	md
;

447 
uöt64_t
 
	mu64
;

448 
uöt32_t
 
	mu32
[2];

449 } 
	tJSFlﬂt64Uni⁄
;

452 
	mJS_ATOM_TYPE_STRING
 = 1,

453 
	mJS_ATOM_TYPE_GLOBAL_SYMBOL
,

454 
	mJS_ATOM_TYPE_SYMBOL
,

455 
	mJS_ATOM_TYPE_PRIVATE
,

459 
	mJS_ATOM_HASH_SYMBOL
,

460 
	mJS_ATOM_HASH_PRIVATE
,

464 
	mJS_ATOM_KIND_STRING
,

465 
	mJS_ATOM_KIND_SYMBOL
,

466 
	mJS_ATOM_KIND_PRIVATE
,

467 } 
	tJSAtomKödEnum
;

469 
	#JS_ATOM_HASH_MASK
 ((1 << 30Ë- 1)

	)

471 
	sJSSåög
 {

472 
JSRefCou¡Hódî
 
	mhódî
;

473 
uöt32_t
 
	mÀn
 : 31;

474 
uöt8_t
 
	mis_wide_ch¨
 : 1;

478 
uöt32_t
 
	mhash
 : 30;

479 
uöt8_t
 
	m©om_ty≥
 : 2;

480 
uöt32_t
 
	mhash_√xt
;

481 #ifde‡
DUMP_LEAKS


482 
li°_hód
 
	mlök
;

485 
uöt8_t
 
	m°r8
[0];

486 
uöt16_t
 
	m°r16
[0];

487 } 
	mu
;

490 
	sJSClosuªV¨
 {

491 
uöt8_t
 
	mis_loˇl
 : 1;

492 
uöt8_t
 
	mis_¨g
 : 1;

493 
uöt8_t
 
	mis_c⁄°
 : 1;

494 
uöt8_t
 
	mis_Àxiˇl
 : 1;

495 
uöt8_t
 
	mv¨_köd
 : 3;

497 
uöt16_t
 
	mv¨_idx
;

500 
JSAtom
 
	mv¨_«me
;

501 } 
	tJSClosuªV¨
;

503 
	sJSV¨Sc›e
 {

504 
	m∑ª¡
;

505 
	mfú°
;

506 } 
	tJSV¨Sc›e
;

510 
	mJS_VAR_NORMAL
,

511 
	mJS_VAR_FUNCTION_DECL
,

512 
	mJS_VAR_NEW_FUNCTION_DECL
,

514 
	mJS_VAR_CATCH
,

515 
	mJS_VAR_PRIVATE_FIELD
,

516 
	mJS_VAR_PRIVATE_METHOD
,

517 
	mJS_VAR_PRIVATE_GETTER
,

518 
	mJS_VAR_PRIVATE_SETTER
,

519 
	mJS_VAR_PRIVATE_GETTER_SETTER
,

520 } 
	tJSV¨KödEnum
;

522 
	sJSV¨Def
 {

523 
JSAtom
 
	mv¨_«me
;

524 
	msc›e_Àvñ
;

525 
	msc›e_√xt
;

527 
uöt8_t
 
	mis_func_v¨
 : 1;

528 
uöt8_t
 
	mis_c⁄°
 : 1;

529 
uöt8_t
 
	mis_Àxiˇl
 : 1;

530 
uöt8_t
 
	mis_ˇ±uªd
 : 1;

531 
uöt8_t
 
	mv¨_köd
 : 4;

537 
	mfunc_poﬁ_‹_sc›e_idx
 : 24;

538 } 
	tJSV¨Def
;

541 
	#PC2LINE_BASE
 (-1)

	)

542 
	#PC2LINE_RANGE
 5

	)

543 
	#PC2LINE_OP_FIRST
 1

	)

544 
	#PC2LINE_DIFF_PC_MAX
 ((255 - 
PC2LINE_OP_FIRST
Ë/ 
PC2LINE_RANGE
)

	)

546 
	eJSFun˘i⁄KödEnum
 {

547 
	mJS_FUNC_NORMAL
 = 0,

548 
	mJS_FUNC_GENERATOR
 = (1 << 0),

549 
	mJS_FUNC_ASYNC
 = (1 << 1),

550 
	mJS_FUNC_ASYNC_GENERATOR
 = (
JS_FUNC_GENERATOR
 | 
JS_FUNC_ASYNC
),

551 } 
	tJSFun˘i⁄KödEnum
;

553 
	sJSFun˘i⁄Byãcode
 {

554 
JSGCObje˘Hódî
 
	mhódî
;

555 
uöt8_t
 
	mjs_mode
;

556 
uöt8_t
 
	mhas_¥ŸŸy≥
 : 1;

557 
uöt8_t
 
	mhas_sim∂e_∑ømëî_li°
 : 1;

558 
uöt8_t
 
	mis_dîived_˛ass_c⁄°ru˘‹
 : 1;

560 
uöt8_t
 
	m√ed_home_obje˘
 : 1;

561 
uöt8_t
 
	mfunc_köd
 : 2;

562 
uöt8_t
 
	m√w_èrgë_Ælowed
 : 1;

563 
uöt8_t
 
	msu≥r_ˇŒ_Ælowed
 : 1;

564 
uöt8_t
 
	msu≥r_Ælowed
 : 1;

565 
uöt8_t
 
	m¨gumíts_Ælowed
 : 1;

566 
uöt8_t
 
	mhas_debug
 : 1;

567 
uöt8_t
 
	mbackåa˚_b¨rõr
 : 1;

568 
uöt8_t
 
	mªad_⁄ly_byãcode
 : 1;

570 
uöt8_t
 *
	mbyã_code_buf
;

571 
	mbyã_code_Àn
;

572 
JSAtom
 
	mfunc_«me
;

573 
JSV¨Def
 *
	mv¨defs
;

574 
JSClosuªV¨
 *
	m˛osuª_v¨
;

575 
uöt16_t
 
	m¨g_cou¡
;

576 
uöt16_t
 
	mv¨_cou¡
;

577 
uöt16_t
 
	mdeföed_¨g_cou¡
;

578 
uöt16_t
 
	m°ack_size
;

579 
JSC⁄ãxt
 *
	mªÆm
;

580 
JSVÆue
 *
	m˝oﬁ
;

581 
	m˝oﬁ_cou¡
;

582 
	m˛osuª_v¨_cou¡
;

585 
JSAtom
 
	mfûíame
;

586 
	mlöe_num
;

587 
	msour˚_Àn
;

588 
	mpc2löe_Àn
;

589 
uöt8_t
 *
	mpc2löe_buf
;

590 *
	msour˚
;

591 } 
	mdebug
;

592 } 
	tJSFun˘i⁄Byãcode
;

594 
	sJSBoundFun˘i⁄
 {

595 
JSVÆue
 
	mfunc_obj
;

596 
JSVÆue
 
	mthis_vÆ
;

597 
	m¨gc
;

598 
JSVÆue
 
	m¨gv
[0];

599 } 
	tJSBoundFun˘i⁄
;

601 
	eJSIãøt‹KödEnum
 {

602 
	mJS_ITERATOR_KIND_KEY
,

603 
	mJS_ITERATOR_KIND_VALUE
,

604 
	mJS_ITERATOR_KIND_KEY_AND_VALUE
,

605 } 
	tJSIãøt‹KödEnum
;

607 
	sJSF‹InIãøt‹
 {

608 
JSVÆue
 
	mobj
;

609 
BOOL
 
	mis_¨øy
;

610 
uöt32_t
 
	m¨øy_Àngth
;

611 
uöt32_t
 
	midx
;

612 } 
	tJSF‹InIãøt‹
;

614 
	sJSRegExp
 {

615 
JSSåög
 *
	m∑âîn
;

616 
JSSåög
 *
	mbyãcode
;

617 } 
	tJSRegExp
;

619 
	sJSProxyD©a
 {

620 
JSVÆue
 
	mèrgë
;

621 
JSVÆue
 
	mh™dÀr
;

622 
JSVÆue
 
	m¥Ÿo
;

623 
uöt8_t
 
	mis_func
;

624 
uöt8_t
 
	mis_ªvoked
;

625 } 
	tJSProxyD©a
;

627 
	sJSAºayBuf„r
 {

628 
	mbyã_Àngth
;

629 
uöt8_t
 
	mdëached
;

630 
uöt8_t
 
	msh¨ed
;

631 
uöt8_t
 *
	md©a
;

632 
li°_hód
 
	m¨øy_li°
;

633 *
	m›aque
;

634 
JSFªeAºayBuf„rD©aFunc
 *
	m‰ì_func
;

635 } 
	tJSAºayBuf„r
;

637 
	sJSTy≥dAºay
 {

638 
li°_hód
 
	mlök
;

639 
JSObje˘
 *
	mobj
;

640 
JSObje˘
 *
	mbuf„r
;

641 
uöt32_t
 
	moff£t
;

642 
uöt32_t
 
	mÀngth
;

643 } 
	tJSTy≥dAºay
;

645 
	sJSAsyncFun˘i⁄Sèã
 {

646 
JSVÆue
 
	mthis_vÆ
;

647 
	m¨gc
;

648 
BOOL
 
	mthrow_Êag
;

649 
JSSèckFøme
 
	m‰ame
;

650 } 
	tJSAsyncFun˘i⁄Sèã
;

654 
	sJSAsyncFun˘i⁄D©a
 {

655 
JSGCObje˘Hódî
 
	mhódî
;

656 
JSVÆue
 
	mªsﬁvög_funcs
[2];

657 
BOOL
 
	mis_a˘ive
;

658 
JSAsyncFun˘i⁄Sèã
 
	mfunc_°©e
;

659 } 
	tJSAsyncFun˘i⁄D©a
;

663 
	mJS_OVOP_ADD
,

664 
	mJS_OVOP_SUB
,

665 
	mJS_OVOP_MUL
,

666 
	mJS_OVOP_DIV
,

667 
	mJS_OVOP_MOD
,

668 
	mJS_OVOP_POW
,

669 
	mJS_OVOP_OR
,

670 
	mJS_OVOP_AND
,

671 
	mJS_OVOP_XOR
,

672 
	mJS_OVOP_SHL
,

673 
	mJS_OVOP_SAR
,

674 
	mJS_OVOP_SHR
,

675 
	mJS_OVOP_EQ
,

676 
	mJS_OVOP_LESS
,

678 
	mJS_OVOP_BINARY_COUNT
,

680 
	mJS_OVOP_POS
 = 
JS_OVOP_BINARY_COUNT
,

681 
	mJS_OVOP_NEG
,

682 
	mJS_OVOP_INC
,

683 
	mJS_OVOP_DEC
,

684 
	mJS_OVOP_NOT
,

686 
	mJS_OVOP_COUNT
,

687 } 
	tJSOvîlﬂdabÀO≥øt‹Enum
;

690 
uöt32_t
 
	m›î©‹_ödex
;

691 
JSObje˘
 *
	m›s
[
JS_OVOP_BINARY_COUNT
];

692 } 
	tJSBö¨yO≥øt‹DefE¡ry
;

695 
	mcou¡
;

696 
JSBö¨yO≥øt‹DefE¡ry
 *
	mèb
;

697 } 
	tJSBö¨yO≥øt‹Def
;

700 
uöt32_t
 
	m›î©‹_cou¡î
;

701 
BOOL
 
	mis_¥imôive
;

703 
JSObje˘
 *
	m£lf_›s
[
JS_OVOP_COUNT
];

704 
JSBö¨yO≥øt‹Def
 
	mÀ·
;

705 
JSBö¨yO≥øt‹Def
 
	mright
;

706 } 
	tJSO≥øt‹SëD©a
;

708 
	sJSReqModuÀE¡ry
 {

709 
JSAtom
 
	mmoduÀ_«me
;

710 
JSModuÀDef
 *
	mmoduÀ
;

711 } 
	tJSReqModuÀE¡ry
;

713 
	eJSExp‹tTy≥Enum
 {

714 
	mJS_EXPORT_TYPE_LOCAL
,

715 
	mJS_EXPORT_TYPE_INDIRECT
,

716 } 
	tJSExp‹tTy≥Enum
;

718 
	sJSExp‹tE¡ry
 {

721 
	mv¨_idx
;

722 
JSV¨Ref
 *
	mv¨_ªf
;

723 } 
	mloˇl
;

724 
	mªq_moduÀ_idx
;

725 } 
	mu
;

726 
JSExp‹tTy≥Enum
 
	mexp‹t_ty≥
;

727 
JSAtom
 
	mloˇl_«me
;

729 
JSAtom
 
	mexp‹t_«me
;

730 } 
	tJSExp‹tE¡ry
;

732 
	sJSSèrExp‹tE¡ry
 {

733 
	mªq_moduÀ_idx
;

734 } 
	tJSSèrExp‹tE¡ry
;

736 
	sJSImp‹tE¡ry
 {

737 
	mv¨_idx
;

738 
JSAtom
 
	mimp‹t_«me
;

739 
	mªq_moduÀ_idx
;

740 } 
	tJSImp‹tE¡ry
;

742 
	sJSModuÀDef
 {

743 
JSRefCou¡Hódî
 
	mhódî
;

744 
JSAtom
 
	mmoduÀ_«me
;

745 
li°_hód
 
	mlök
;

747 
JSReqModuÀE¡ry
 *
	mªq_moduÀ_íåõs
;

748 
	mªq_moduÀ_íåõs_cou¡
;

749 
	mªq_moduÀ_íåõs_size
;

751 
JSExp‹tE¡ry
 *
	mexp‹t_íåõs
;

752 
	mexp‹t_íåõs_cou¡
;

753 
	mexp‹t_íåõs_size
;

755 
JSSèrExp‹tE¡ry
 *
	m°¨_exp‹t_íåõs
;

756 
	m°¨_exp‹t_íåõs_cou¡
;

757 
	m°¨_exp‹t_íåõs_size
;

759 
JSImp‹tE¡ry
 *
	mimp‹t_íåõs
;

760 
	mimp‹t_íåõs_cou¡
;

761 
	mimp‹t_íåõs_size
;

763 
JSVÆue
 
	mmoduÀ_ns
;

764 
JSVÆue
 
	mfunc_obj
;

765 
JSModuÀInôFunc
 *
	möô_func
;

766 
BOOL
 
	mªsﬁved
 : 8;

767 
BOOL
 
	mö°™tüãd
 : 8;

768 
BOOL
 
	mevÆu©ed
 : 8;

769 
BOOL
 
	mevÆ_m¨k
 : 8;

772 
BOOL
 
	mevÆ_has_ex˚±i⁄
 : 8;

773 
JSVÆue
 
	mevÆ_ex˚±i⁄
;

774 
JSVÆue
 
	mmëa_obj
;

777 
	sJSJobE¡ry
 {

778 
li°_hód
 
	mlök
;

779 
JSC⁄ãxt
 *
	m˘x
;

780 
JSJobFunc
 *
	mjob_func
;

781 
	m¨gc
;

782 
JSVÆue
 
	m¨gv
[0];

783 } 
	tJSJobE¡ry
;

785 
	sJSPr›îty
 {

787 
JSVÆue
 
	mvÆue
;

789 
JSObje˘
 *
	mgëãr
;

790 
JSObje˘
 *
	m£âî
;

791 } 
	mgë£t
;

792 
JSV¨Ref
 *
	mv¨_ªf
;

797 
JSC⁄ãxt
 *
	mªÆm
;

798 
uöçå_t
 
	möô_id
;

799 } 
	mu
;

800 *
	m›aque
;

801 } 
	möô
;

802 } 
	mu
;

803 } 
	tJSPr›îty
;

805 
	#JS_PROP_INITIAL_SIZE
 2

	)

806 
	#JS_PROP_INITIAL_HASH_SIZE
 4

	)

807 
	#JS_ARRAY_INITIAL_SIZE
 2

	)

809 
	sJSSh≠ePr›îty
 {

810 
uöt32_t
 
	mhash_√xt
 : 26;

811 
uöt32_t
 
	mÊags
 : 6;

812 
JSAtom
 
	m©om
;

813 } 
	tJSSh≠ePr›îty
;

815 
	sJSSh≠e
 {

816 
uöt32_t
 
	m¥›_hash_íd
[0];

818 
JSGCObje˘Hódî
 
	mhódî
;

821 
uöt8_t
 
	mis_hashed
;

825 
uöt8_t
 
	mhas_smÆl_¨øy_ödex
;

826 
uöt32_t
 
	mhash
;

827 
uöt32_t
 
	m¥›_hash_mask
;

828 
	m¥›_size
;

829 
	m¥›_cou¡
;

830 
JSSh≠e
 *
	msh≠e_hash_√xt
;

831 
JSObje˘
 *
	m¥Ÿo
;

832 
JSSh≠ePr›îty
 
	m¥›
[0];

834 
	sJSObje˘
 {

836 
JSGCObje˘Hódî
 
	mhódî
;

838 
	m__gc_ªf_cou¡
;

839 
uöt8_t
 
	m__gc_m¨k
;

841 
uöt8_t
 
	mexãnsibÀ
 : 1;

842 
uöt8_t
 
	m‰ì_m¨k
 : 1;

843 
uöt8_t
 
	mis_exŸic
 : 1;

844 
uöt8_t
 
	mÁ°_¨øy
 : 1;

845 
uöt8_t
 
	mis_c⁄°ru˘‹
 : 1;

846 
uöt8_t
 
	mis_unˇtchabÀ_îr‹
 : 1;

847 
uöt8_t
 
	mis_˛ass
 : 1;

848 
uöt8_t
 
	mtmp_m¨k
 : 1;

849 
uöt16_t
 
	m˛ass_id
;

853 
JSSh≠e
 *
	msh≠e
;

854 
JSPr›îty
 *
	m¥›
;

856 
JSM≠Rec‹d
 *
	mfú°_wók_ªf
;

859 *
	m›aque
;

860 
JSBoundFun˘i⁄
 *
	mbound_fun˘i⁄
;

861 
JSCFun˘i⁄D©aRec‹d
 *
	mc_fun˘i⁄_d©a_ªc‹d
;

862 
JSF‹InIãøt‹
 *
	mf‹_ö_ôî©‹
;

863 
JSAºayBuf„r
 *
	m¨øy_buf„r
;

864 
JSTy≥dAºay
 *
	mty≥d_¨øy
;

865 #ifde‡
CONFIG_BIGNUM


866 
JSFlﬂtEnv
 *
	mÊﬂt_ív
;

867 
JSO≥øt‹SëD©a
 *
	m›î©‹_£t
;

869 
JSM≠Sèã
 *
	mm≠_°©e
;

870 
JSM≠Iãøt‹D©a
 *
	mm≠_ôî©‹_d©a
;

871 
JSAºayIãøt‹D©a
 *
	m¨øy_ôî©‹_d©a
;

872 
JSRegExpSåögIãøt‹D©a
 *
	mªgexp_°rög_ôî©‹_d©a
;

873 
JSGíî©‹D©a
 *
	mgíî©‹_d©a
;

874 
JSProxyD©a
 *
	m¥oxy_d©a
;

875 
JSPromi£D©a
 *
	m¥omi£_d©a
;

876 
JSPromi£Fun˘i⁄D©a
 *
	m¥omi£_fun˘i⁄_d©a
;

877 
JSAsyncFun˘i⁄D©a
 *
	masync_fun˘i⁄_d©a
;

878 
JSAsyncFromSyncIãøt‹D©a
 *
	masync_‰om_sync_ôî©‹_d©a
;

879 
JSAsyncGíî©‹D©a
 *
	masync_gíî©‹_d©a
;

882 
JSFun˘i⁄Byãcode
 *
	mfun˘i⁄_byãcode
;

883 
JSV¨Ref
 **
	mv¨_ªfs
;

884 
JSObje˘
 *
	mhome_obje˘
;

885 } 
	mfunc
;

887 
JSC⁄ãxt
 *
	mªÆm
;

888 
JSCFun˘i⁄Ty≥
 
	mc_fun˘i⁄
;

889 
uöt8_t
 
	mÀngth
;

890 
uöt8_t
 
	m˝rŸo
;

891 
öt16_t
 
	mmagic
;

892 } 
	mcfunc
;

896 
uöt32_t
 
	msize
;

897 
JSTy≥dAºay
 *
	mty≥d_¨øy
;

898 } 
	mu1
;

900 
JSVÆue
 *
	mvÆues
;

901 *
	m±r
;

902 
öt8_t
 *
	möt8_±r
;

903 
uöt8_t
 *
	muöt8_±r
;

904 
öt16_t
 *
	möt16_±r
;

905 
uöt16_t
 *
	muöt16_±r
;

906 
öt32_t
 *
	möt32_±r
;

907 
uöt32_t
 *
	muöt32_±r
;

908 
söt64_t
 *
	möt64_±r
;

909 
uöt64_t
 *
	muöt64_±r
;

910 *
	mÊﬂt_±r
;

911 *
	mdoubÀ_±r
;

912 } 
	mu
;

913 
uöt32_t
 
	mcou¡
;

914 } 
	m¨øy
;

915 
JSRegExp
 
	mªgexp
;

916 
JSVÆue
 
	mobje˘_d©a
;

917 } 
	mu
;

921 
	mJS_ATOM_NULL
,

922 
	#DEF
(
«me
, 
°r
Ë
JS_ATOM_
 ##Çame,

	)

923 
	~<π/js/quickjs-©om.h
>

924 #unde‡
DEF


925 
	mJS_ATOM_END
,

927 
	#JS_ATOM_LAST_KEYWORD
 
JS_ATOM_su≥r


	)

928 
	#JS_ATOM_LAST_STRICT_KEYWORD
 
JS_ATOM_yõld


	)

930 c⁄° 
	gjs_©om_öô
[] =

931 
	#DEF
(
«me
, 
°r
Ë°∏"\0"

	)

932 
	~<π/js/quickjs-©om.h
>

933 #unde‡
DEF


936 
	eOPCodeF‹m©
 {

937 
	#FMT
(
f
Ë
OP_FMT_
 ## f,

	)

938 
	#DEF
(
id
, 
size
, 
n_p›
, 
n_push
, 
f
)

	)

939 
	~<π/js/quickjs-›code.h
>

940 #unde‡
DEF


941 #unde‡
FMT


942 } 
	tOPCodeF‹m©
;

944 
	eOPCodeEnum
 {

945 
	#FMT
(
f
)

	)

946 
	#DEF
(
id
, 
size
, 
n_p›
, 
n_push
, 
f
Ë
OP_
 ## id,

	)

947 
	#def
(
id
, 
size
, 
n_p›
, 
n_push
, 
f
)

	)

948 
	~<π/js/quickjs-›code.h
>

949 #unde‡
def


950 #unde‡
DEF


951 #unde‡
FMT


952 
	mOP_COUNT
,

954 
	mOP_TEMP_START
 = 
OP_n›
 + 1,

955 
	mOP___dummy
 = 
OP_TEMP_START
 - 1,

956 
	#FMT
(
f
)

	)

957 
	#DEF
(
id
, 
size
, 
n_p›
, 
n_push
, 
f
)

	)

958 
	#def
(
id
, 
size
, 
n_p›
, 
n_push
, 
f
Ë
OP_
 ## id,

	)

959 
	~<π/js/quickjs-›code.h
>

960 #unde‡
def


961 #unde‡
DEF


962 #unde‡
FMT


963 
	mOP_TEMP_END
,

966 
JS_InôAtoms
(
JSRu¡ime
 *
π
);

967 
JSAtom
 
__JS_NewAtomInô
(
JSRu¡ime
 *
π
, c⁄° *
°r
, 
Àn
,

968 
©om_ty≥
);

969 
JS_FªeAtomSåu˘
(
JSRu¡ime
 *
π
, 
JSAtomSåu˘
 *
p
);

970 
‰ì_fun˘i⁄_byãcode
(
JSRu¡ime
 *
π
, 
JSFun˘i⁄Byãcode
 *
b
);

971 
JSVÆue
 
js_ˇŒ_c_fun˘i⁄
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
func_obj
,

972 
JSVÆueC⁄°
 
this_obj
,

973 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
, 
Êags
);

974 
JSVÆue
 
js_ˇŒ_bound_fun˘i⁄
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
func_obj
,

975 
JSVÆueC⁄°
 
this_obj
,

976 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
, 
Êags
);

977 
JSVÆue
 
JS_CÆlI¡î«l
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
func_obj
,

978 
JSVÆueC⁄°
 
this_obj
, JSVÆueC⁄° 
√w_èrgë
,

979 
¨gc
, 
JSVÆue
 *
¨gv
, 
Êags
);

980 
JSVÆue
 
JS_CÆlC⁄°ru˘‹I¡î«l
(
JSC⁄ãxt
 *
˘x
,

981 
JSVÆueC⁄°
 
func_obj
,

982 
JSVÆueC⁄°
 
√w_èrgë
,

983 
¨gc
, 
JSVÆue
 *
¨gv
, 
Êags
);

984 
JSVÆue
 
JS_CÆlFªe
(
JSC⁄ãxt
 *
˘x
, JSVÆuê
func_obj
, 
JSVÆueC⁄°
 
this_obj
,

985 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
);

986 
JSVÆue
 
JS_InvokeFªe
(
JSC⁄ãxt
 *
˘x
, JSVÆuê
this_vÆ
, 
JSAtom
 
©om
,

987 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
);

988 
__ex˚±i⁄
 
JS_ToAºayLígthFªe
(
JSC⁄ãxt
 *
˘x
, 
uöt32_t
 *
∂í
,

989 
JSVÆue
 
vÆ
);

990 
JSVÆue
 
JS_EvÆObje˘
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_obj
,

991 
JSVÆueC⁄°
 
vÆ
, 
Êags
, 
sc›e_idx
);

992 
JSVÆue
 
__©åibuã__
((
	$f‹m©
(
¥ötf
, 2, 3))Ë
	`JS_ThrowI¡î«lEº‹
(
JSC⁄ãxt
 *
˘x
, c⁄° *
fmt
, ...);

993 
__maybe_unu£d
 
	`JS_DumpAtoms
(
JSRu¡ime
 *
π
);

994 
__maybe_unu£d
 
	`JS_DumpSåög
(
JSRu¡ime
 *
π
,

995 c⁄° 
JSSåög
 *
p
);

996 
__maybe_unu£d
 
	`JS_DumpObje˘Hódî
(
JSRu¡ime
 *
π
);

997 
__maybe_unu£d
 
	`JS_DumpObje˘
(
JSRu¡ime
 *
π
, 
JSObje˘
 *
p
);

998 
__maybe_unu£d
 
	`JS_DumpGCObje˘
(
JSRu¡ime
 *
π
, 
JSGCObje˘Hódî
 *
p
);

999 
__maybe_unu£d
 
	`JS_DumpVÆueSh‹t
(
JSRu¡ime
 *
π
,

1000 
JSVÆueC⁄°
 
vÆ
);

1001 
__maybe_unu£d
 
	`JS_DumpVÆue
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
vÆ
);

1002 
__maybe_unu£d
 
	`JS_PrötVÆue
(
JSC⁄ãxt
 *
˘x
,

1003 c⁄° *
°r
,

1004 
JSVÆueC⁄°
 
vÆ
);

1005 
__maybe_unu£d
 
	`JS_DumpSh≠es
(
JSRu¡ime
 *
π
);

1006 
JSVÆue
 
	`js_fun˘i⁄_≠∂y
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

1007 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
, 
magic
);

1008 
	`js_¨øy_föÆizî
(
JSRu¡ime
 *
π
, 
JSVÆue
 
vÆ
);

1009 
	`js_¨øy_m¨k
(
JSRu¡ime
 *
π
, 
JSVÆueC⁄°
 
vÆ
,

1010 
JS_M¨kFunc
 *
m¨k_func
);

1011 
	`js_obje˘_d©a_föÆizî
(
JSRu¡ime
 *
π
, 
JSVÆue
 
vÆ
);

1012 
	`js_obje˘_d©a_m¨k
(
JSRu¡ime
 *
π
, 
JSVÆueC⁄°
 
vÆ
,

1013 
JS_M¨kFunc
 *
m¨k_func
);

1014 
	`js_c_fun˘i⁄_föÆizî
(
JSRu¡ime
 *
π
, 
JSVÆue
 
vÆ
);

1015 
	`js_c_fun˘i⁄_m¨k
(
JSRu¡ime
 *
π
, 
JSVÆueC⁄°
 
vÆ
,

1016 
JS_M¨kFunc
 *
m¨k_func
);

1017 
	`js_byãcode_fun˘i⁄_föÆizî
(
JSRu¡ime
 *
π
, 
JSVÆue
 
vÆ
);

1018 
	`js_byãcode_fun˘i⁄_m¨k
(
JSRu¡ime
 *
π
, 
JSVÆueC⁄°
 
vÆ
,

1019 
JS_M¨kFunc
 *
m¨k_func
);

1020 
	`js_bound_fun˘i⁄_föÆizî
(
JSRu¡ime
 *
π
, 
JSVÆue
 
vÆ
);

1021 
	`js_bound_fun˘i⁄_m¨k
(
JSRu¡ime
 *
π
, 
JSVÆueC⁄°
 
vÆ
,

1022 
JS_M¨kFunc
 *
m¨k_func
);

1023 
	`js_f‹_ö_ôî©‹_föÆizî
(
JSRu¡ime
 *
π
, 
JSVÆue
 
vÆ
);

1024 
	`js_f‹_ö_ôî©‹_m¨k
(
JSRu¡ime
 *
π
, 
JSVÆueC⁄°
 
vÆ
,

1025 
JS_M¨kFunc
 *
m¨k_func
);

1026 
	`js_ªgexp_föÆizî
(
JSRu¡ime
 *
π
, 
JSVÆue
 
vÆ
);

1027 
	`js_¨øy_buf„r_föÆizî
(
JSRu¡ime
 *
π
, 
JSVÆue
 
vÆ
);

1028 
	`js_ty≥d_¨øy_föÆizî
(
JSRu¡ime
 *
π
, 
JSVÆue
 
vÆ
);

1029 
	`js_ty≥d_¨øy_m¨k
(
JSRu¡ime
 *
π
, 
JSVÆueC⁄°
 
vÆ
,

1030 
JS_M¨kFunc
 *
m¨k_func
);

1031 
	`js_¥oxy_föÆizî
(
JSRu¡ime
 *
π
, 
JSVÆue
 
vÆ
);

1032 
	`js_¥oxy_m¨k
(
JSRu¡ime
 *
π
, 
JSVÆueC⁄°
 
vÆ
,

1033 
JS_M¨kFunc
 *
m¨k_func
);

1034 
	`js_m≠_föÆizî
(
JSRu¡ime
 *
π
, 
JSVÆue
 
vÆ
);

1035 
	`js_m≠_m¨k
(
JSRu¡ime
 *
π
, 
JSVÆueC⁄°
 
vÆ
,

1036 
JS_M¨kFunc
 *
m¨k_func
);

1037 
	`js_m≠_ôî©‹_föÆizî
(
JSRu¡ime
 *
π
, 
JSVÆue
 
vÆ
);

1038 
	`js_m≠_ôî©‹_m¨k
(
JSRu¡ime
 *
π
, 
JSVÆueC⁄°
 
vÆ
,

1039 
JS_M¨kFunc
 *
m¨k_func
);

1040 
	`js_¨øy_ôî©‹_föÆizî
(
JSRu¡ime
 *
π
, 
JSVÆue
 
vÆ
);

1041 
	`js_¨øy_ôî©‹_m¨k
(
JSRu¡ime
 *
π
, 
JSVÆueC⁄°
 
vÆ
,

1042 
JS_M¨kFunc
 *
m¨k_func
);

1043 
	`js_ªgexp_°rög_ôî©‹_föÆizî
(
JSRu¡ime
 *
π
, 
JSVÆue
 
vÆ
);

1044 
	`js_ªgexp_°rög_ôî©‹_m¨k
(
JSRu¡ime
 *
π
, 
JSVÆueC⁄°
 
vÆ
,

1045 
JS_M¨kFunc
 *
m¨k_func
);

1046 
	`js_gíî©‹_föÆizî
(
JSRu¡ime
 *
π
, 
JSVÆue
 
obj
);

1047 
	`js_gíî©‹_m¨k
(
JSRu¡ime
 *
π
, 
JSVÆueC⁄°
 
vÆ
,

1048 
JS_M¨kFunc
 *
m¨k_func
);

1049 
	`js_¥omi£_föÆizî
(
JSRu¡ime
 *
π
, 
JSVÆue
 
vÆ
);

1050 
	`js_¥omi£_m¨k
(
JSRu¡ime
 *
π
, 
JSVÆueC⁄°
 
vÆ
,

1051 
JS_M¨kFunc
 *
m¨k_func
);

1052 
	`js_¥omi£_ªsﬁve_fun˘i⁄_föÆizî
(
JSRu¡ime
 *
π
, 
JSVÆue
 
vÆ
);

1053 
	`js_¥omi£_ªsﬁve_fun˘i⁄_m¨k
(
JSRu¡ime
 *
π
, 
JSVÆueC⁄°
 
vÆ
,

1054 
JS_M¨kFunc
 *
m¨k_func
);

1055 #ifde‡
CONFIG_BIGNUM


1056 
	`js_›î©‹_£t_föÆizî
(
JSRu¡ime
 *
π
, 
JSVÆue
 
vÆ
);

1057 
	`js_›î©‹_£t_m¨k
(
JSRu¡ime
 *
π
, 
JSVÆueC⁄°
 
vÆ
,

1058 
JS_M¨kFunc
 *
m¨k_func
);

1060 
JSVÆue
 
	`JS_ToSåögFªe
(
JSC⁄ãxt
 *
˘x
, JSVÆuê
vÆ
);

1061 
	`JS_ToBoﬁFªe
(
JSC⁄ãxt
 *
˘x
, 
JSVÆue
 
vÆ
);

1062 
	`JS_ToI¡32Fªe
(
JSC⁄ãxt
 *
˘x
, 
öt32_t
 *
¥es
, 
JSVÆue
 
vÆ
);

1063 
	`JS_ToFlﬂt64Fªe
(
JSC⁄ãxt
 *
˘x
, *
¥es
, 
JSVÆue
 
vÆ
);

1064 
	`JS_ToUöt8CœmpFªe
(
JSC⁄ãxt
 *
˘x
, 
öt32_t
 *
¥es
, 
JSVÆue
 
vÆ
);

1065 
JSVÆue
 
	`js_compûe_ªgexp
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
∑âîn
,

1066 
JSVÆueC⁄°
 
Êags
);

1067 
JSVÆue
 
	`js_ªgexp_c⁄°ru˘‹_öã∫Æ
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
˘‹
,

1068 
JSVÆue
 
∑âîn
, JSVÆuê
bc
);

1069 
	`gc_de¸ef
(
JSRu¡ime
 *
π
);

1070 
	`JS_NewCœss1
(
JSRu¡ime
 *
π
, 
JSCœssID
 
˛ass_id
,

1071 c⁄° 
JSCœssDef
 *
˛ass_def
, 
JSAtom
 
«me
);

1073 
	eJSSåi˘EqModeEnum
 {

1074 
JS_EQ_STRICT
,

1075 
JS_EQ_SAME_VALUE
,

1076 
JS_EQ_SAME_VALUE_ZERO
,

1077 } 
	tJSSåi˘EqModeEnum
;

1079 
BOOL
 
	`js_°ri˘_eq2
(
JSC⁄ãxt
 *
˘x
, 
JSVÆue
 
›1
, JSVÆuê
›2
,

1080 
JSSåi˘EqModeEnum
 
eq_mode
);

1081 
BOOL
 
	`js_°ri˘_eq
(
JSC⁄ãxt
 *
˘x
, 
JSVÆue
 
›1
, JSVÆuê
›2
);

1082 
BOOL
 
	`js_ßme_vÆue
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
›1
, JSVÆueC⁄° 
›2
);

1083 
BOOL
 
	`js_ßme_vÆue_zîo
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
›1
, JSVÆueC⁄° 
›2
);

1084 
JSVÆue
 
	`JS_ToObje˘
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
vÆ
);

1085 
JSVÆue
 
	`JS_ToObje˘Fªe
(
JSC⁄ãxt
 *
˘x
, JSVÆuê
vÆ
);

1086 
JSPr›îty
 *
	`add_¥›îty
(
JSC⁄ãxt
 *
˘x
,

1087 
JSObje˘
 *
p
, 
JSAtom
 
¥›
, 
¥›_Êags
);

1088 #ifde‡
CONFIG_BIGNUM


1089 
	`js_Êﬂt_ív_föÆizî
(
JSRu¡ime
 *
π
, 
JSVÆue
 
vÆ
);

1090 
JSVÆue
 
	`JS_NewBigFlﬂt
(
JSC⁄ãxt
 *
˘x
);

1091 
ölöe
 
bf_t
 *
	$JS_GëBigFlﬂt
(
JSVÆueC⁄°
 
vÆ
)

1093 
JSBigFlﬂt
 *
p
 = 
	`JS_VALUE_GET_PTR
(
vÆ
);

1094  &
p
->
num
;

1095 
	}
}

1096 
JSVÆue
 
JS_NewBigDecimÆ
(
JSC⁄ãxt
 *
˘x
);

1097 
ölöe
 
bfdec_t
 *
	$JS_GëBigDecimÆ
(
JSVÆueC⁄°
 
vÆ
)

1099 
JSBigDecimÆ
 *
p
 = 
	`JS_VALUE_GET_PTR
(
vÆ
);

1100  &
p
->
num
;

1101 
	}
}

1102 
JSVÆue
 
JS_NewBigI¡
(
JSC⁄ãxt
 *
˘x
);

1103 
ölöe
 
bf_t
 *
	$JS_GëBigI¡
(
JSVÆueC⁄°
 
vÆ
)

1105 
JSBigFlﬂt
 *
p
 = 
	`JS_VALUE_GET_PTR
(
vÆ
);

1106  &
p
->
num
;

1107 
	}
}

1108 
JSVÆue
 
JS_Com∑˘BigI¡1
(
JSC⁄ãxt
 *
˘x
, JSVÆuê
vÆ
,

1109 
BOOL
 
c⁄vît_to_ß„_öãgî
);

1110 
JSVÆue
 
JS_Com∑˘BigI¡
(
JSC⁄ãxt
 *
˘x
, JSVÆuê
vÆ
);

1111 
JS_ToBigI¡64Fªe
(
JSC⁄ãxt
 *
˘x
, 
öt64_t
 *
¥es
, 
JSVÆue
 
vÆ
);

1112 
bf_t
 *
JS_ToBigI¡
(
JSC⁄ãxt
 *
˘x
, bf_à*
buf
, 
JSVÆueC⁄°
 
vÆ
);

1113 
JS_FªeBigI¡
(
JSC⁄ãxt
 *
˘x
, 
bf_t
 *
a
, bf_à*
buf
);

1114 
bf_t
 *
JS_ToBigFlﬂt
(
JSC⁄ãxt
 *
˘x
, bf_à*
buf
, 
JSVÆueC⁄°
 
vÆ
);

1115 
JSVÆue
 
JS_ToBigDecimÆFªe
(
JSC⁄ãxt
 *
˘x
, JSVÆuê
vÆ
,

1116 
BOOL
 
Ælow_nuŒ_‹_undeföed
);

1117 
bfdec_t
 *
JS_ToBigDecimÆ
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
vÆ
);

1119 
JSVÆue
 
JS_ThrowOutOfMem‹y
(
JSC⁄ãxt
 *
˘x
);

1120 
JSVÆue
 
JS_ThrowTy≥Eº‹RevokedProxy
(
JSC⁄ãxt
 *
˘x
);

1121 
JSVÆueC⁄°
 
js_¥oxy_gëPrŸŸy≥Of
(
JSC⁄ãxt
 *
˘x
, JSVÆueC⁄° 
obj
);

1122 
js_¥oxy_£tPrŸŸy≥Of
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
obj
,

1123 
JSVÆueC⁄°
 
¥Ÿo_vÆ
, 
BOOL
 
throw_Êag
);

1124 
js_¥oxy_isExãnsibÀ
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
obj
);

1125 
js_¥oxy_¥evítExãnsi⁄s
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
obj
);

1126 
js_¥oxy_isAºay
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
obj
);

1127 
JS_Cª©ePr›îty
(
JSC⁄ãxt
 *
˘x
, 
JSObje˘
 *
p
,

1128 
JSAtom
 
¥›
, 
JSVÆueC⁄°
 
vÆ
,

1129 
JSVÆueC⁄°
 
gëãr
, JSVÆueC⁄° 
£âî
,

1130 
Êags
);

1131 
js_°rög_memcmp
(c⁄° 
JSSåög
 *
p1
, c⁄° JSSåög *
p2
, 
Àn
);

1132 
ª£t_wók_ªf
(
JSRu¡ime
 *
π
, 
JSObje˘
 *
p
);

1133 
BOOL
 
ty≥d_¨øy_is_dëached
(
JSC⁄ãxt
 *
˘x
, 
JSObje˘
 *
p
);

1134 
uöt32_t
 
ty≥d_¨øy_gë_Àngth
(
JSC⁄ãxt
 *
˘x
, 
JSObje˘
 *
p
);

1135 
JSVÆue
 
JS_ThrowTy≥Eº‹DëachedAºayBuf„r
(
JSC⁄ãxt
 *
˘x
);

1136 
JSV¨Ref
 *
gë_v¨_ªf
(
JSC⁄ãxt
 *
˘x
, 
JSSèckFøme
 *
sf
, 
v¨_idx
,

1137 
BOOL
 
is_¨g
);

1138 
JSVÆue
 
js_gíî©‹_fun˘i⁄_ˇŒ
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
func_obj
,

1139 
JSVÆueC⁄°
 
this_obj
,

1140 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
,

1141 
Êags
);

1142 
js_async_fun˘i⁄_ªsﬁve_föÆizî
(
JSRu¡ime
 *
π
, 
JSVÆue
 
vÆ
);

1143 
js_async_fun˘i⁄_ªsﬁve_m¨k
(
JSRu¡ime
 *
π
, 
JSVÆueC⁄°
 
vÆ
,

1144 
JS_M¨kFunc
 *
m¨k_func
);

1145 
JSVÆue
 
JS_EvÆI¡î«l
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_obj
,

1146 c⁄° *
öput
, 
size_t
 
öput_Àn
,

1147 c⁄° *
fûíame
, 
Êags
, 
sc›e_idx
);

1148 
js_‰ì_moduÀ_def
(
JSC⁄ãxt
 *
˘x
, 
JSModuÀDef
 *
m
);

1149 
js_m¨k_moduÀ_def
(
JSRu¡ime
 *
π
, 
JSModuÀDef
 *
m
,

1150 
JS_M¨kFunc
 *
m¨k_func
);

1151 
JSVÆue
 
js_imp‹t_mëa
(
JSC⁄ãxt
 *
˘x
);

1152 
JSVÆue
 
js_dy«mic_imp‹t
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
•ecifõr
);

1153 
‰ì_v¨_ªf
(
JSRu¡ime
 *
π
, 
JSV¨Ref
 *
v¨_ªf
);

1154 
JSVÆue
 
js_√w_¥omi£_ˇ∑bûôy
(
JSC⁄ãxt
 *
˘x
,

1155 
JSVÆue
 *
ªsﬁvög_funcs
,

1156 
JSVÆueC⁄°
 
˘‹
);

1157 
__ex˚±i⁄
 
≥rf‹m_¥omi£_thí
(
JSC⁄ãxt
 *
˘x
,

1158 
JSVÆueC⁄°
 
¥omi£
,

1159 
JSVÆueC⁄°
 *
ªsﬁve_ªje˘
,

1160 
JSVÆueC⁄°
 *
ˇp_ªsﬁvög_funcs
);

1161 
JSVÆue
 
js_¥omi£_ªsﬁve
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

1162 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
, 
magic
);

1163 
js_°rög_com∑ª
(
JSC⁄ãxt
 *
˘x
,

1164 c⁄° 
JSSåög
 *
p1
, c⁄° JSSåög *
p2
);

1165 
JSVÆue
 
JS_ToNumbî
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
vÆ
);

1166 
JS_SëPr›îtyVÆue
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_obj
,

1167 
JSVÆue
 
¥›
, JSVÆuê
vÆ
, 
Êags
);

1168 
JS_NumbîIsI¡egî
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
vÆ
);

1169 
BOOL
 
JS_NumbîIsNeg©iveOrMöusZîo
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
vÆ
);

1170 
JSVÆue
 
JS_ToNumbîFªe
(
JSC⁄ãxt
 *
˘x
, JSVÆuê
vÆ
);

1171 
JS_GëOwnPr›îtyI¡î«l
(
JSC⁄ãxt
 *
˘x
, 
JSPr›îtyDes¸ùt‹
 *
desc
,

1172 
JSObje˘
 *
p
, 
JSAtom
 
¥›
);

1173 
js_‰ì_desc
(
JSC⁄ãxt
 *
˘x
, 
JSPr›îtyDes¸ùt‹
 *
desc
);

1174 
async_func_m¨k
(
JSRu¡ime
 *
π
, 
JSAsyncFun˘i⁄Sèã
 *
s
,

1175 
JS_M¨kFunc
 *
m¨k_func
);

1176 
JS_AddI¡rösicBasicObje˘s
(
JSC⁄ãxt
 *
˘x
);

1177 
js_‰ì_sh≠e
(
JSRu¡ime
 *
π
, 
JSSh≠e
 *
sh
);

1178 
js_‰ì_sh≠e_nuŒ
(
JSRu¡ime
 *
π
, 
JSSh≠e
 *
sh
);

1179 
js_sh≠e_¥ï¨e_upd©e
(
JSC⁄ãxt
 *
˘x
, 
JSObje˘
 *
p
,

1180 
JSSh≠ePr›îty
 **
µrs
);

1181 
öô_sh≠e_hash
(
JSRu¡ime
 *
π
);

1182 
__ex˚±i⁄
 
js_gë_Àngth32
(
JSC⁄ãxt
 *
˘x
, 
uöt32_t
 *
¥es
,

1183 
JSVÆueC⁄°
 
obj
);

1184 
__ex˚±i⁄
 
js_gë_Àngth64
(
JSC⁄ãxt
 *
˘x
, 
öt64_t
 *
¥es
,

1185 
JSVÆueC⁄°
 
obj
);

1186 
‰ì_¨g_li°
(
JSC⁄ãxt
 *
˘x
, 
JSVÆue
 *
èb
, 
uöt32_t
 
Àn
);

1187 
JSVÆue
 *
buûd_¨g_li°
(
JSC⁄ãxt
 *
˘x
, 
uöt32_t
 *
∂í
,

1188 
JSVÆueC⁄°
 
¨øy_¨g
);

1189 
BOOL
 
js_gë_Á°_¨øy
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
obj
,

1190 
JSVÆue
 **
¨Ωp
, 
uöt32_t
 *
cou¡p
);

1191 
JSVÆue
 
JS_Cª©eAsyncFromSyncIãøt‹
(
JSC⁄ãxt
 *
˘x
,

1192 
JSVÆueC⁄°
 
sync_ôî
);

1193 
js_c_fun˘i⁄_d©a_föÆizî
(
JSRu¡ime
 *
π
, 
JSVÆue
 
vÆ
);

1194 
js_c_fun˘i⁄_d©a_m¨k
(
JSRu¡ime
 *
π
, 
JSVÆueC⁄°
 
vÆ
,

1195 
JS_M¨kFunc
 *
m¨k_func
);

1196 
JSVÆue
 
js_c_fun˘i⁄_d©a_ˇŒ
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
func_obj
,

1197 
JSVÆueC⁄°
 
this_vÆ
,

1198 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
, 
Êags
);

1199 
JSAtom
 
js_symbﬁ_to_©om
(
JSC⁄ãxt
 *
˘x
, 
JSVÆue
 
vÆ
);

1200 
add_gc_obje˘
(
JSRu¡ime
 *
π
, 
JSGCObje˘Hódî
 *
h
,

1201 
JSGCObje˘Ty≥Enum
 
ty≥
);

1202 
ªmove_gc_obje˘
(
JSGCObje˘Hódî
 *
h
);

1203 
js_async_fun˘i⁄_‰ì0
(
JSRu¡ime
 *
π
, 
JSAsyncFun˘i⁄D©a
 *
s
);

1204 
js_ö°™tüã_¥ŸŸy≥
(
JSC⁄ãxt
 *
˘x
, 
JSObje˘
 *
p
, 
JSAtom
 
©om
, *
›aque
);

1205 
js_moduÀ_ns_autoöô
(
JSC⁄ãxt
 *
˘x
, 
JSObje˘
 *
p
, 
JSAtom
 
©om
,

1206 *
›aque
);

1207 
JS_In°™tüãFun˘i⁄Li°Iãm
(
JSC⁄ãxt
 *
˘x
, 
JSObje˘
 *
p
,

1208 
JSAtom
 
©om
, *
›aque
);

1210 c⁄° 
JSCœssExŸicMëhods
 
	gjs_¨gumíts_exŸic_mëhods
;

1211 c⁄° 
JSCœssExŸicMëhods
 
	gjs_°rög_exŸic_mëhods
;

1212 c⁄° 
JSCœssExŸicMëhods
 
	gjs_¥oxy_exŸic_mëhods
;

1213 c⁄° 
JSCœssExŸicMëhods
 
	gjs_moduÀ_ns_exŸic_mëhods
;

1214 
JSCœssID
 
	gjs_˛ass_id_Æloc
 = 
JS_CLASS_INIT_COUNT
;

1216 
	$js_åiggî_gc
(
JSRu¡ime
 *
π
, 
size_t
 
size
)

1218 
BOOL
 
f‹˚_gc
;

1219 #ifde‡
FORCE_GC_AT_MALLOC


1220 
f‹˚_gc
 = 
TRUE
;

1222 
f‹˚_gc
 = ((
π
->
mÆloc_°©e
.
mÆloc_size
 + 
size
) >

1223 
π
->
mÆloc_gc_thªshﬁd
);

1225 i‡(
f‹˚_gc
) {

1226 #ifde‡
DUMP_GC


1227 
	`¥ötf
("GC: size=%" 
PRIu64
 "\n",

1228 (
uöt64_t
)
π
->
mÆloc_°©e
.
mÆloc_size
);

1230 
	`JS_RunGC
(
π
);

1231 
π
->
mÆloc_gc_thªshﬁd
 =Ñt->
mÆloc_°©e
.
mÆloc_size
 +

1232 (
π
->
mÆloc_°©e
.
mÆloc_size
 >> 1);

1234 
	}
}

1236 
size_t
 
	$js_mÆloc_ußbÀ_size_unknown
(c⁄° *
±r
)

1239 
	}
}

1241 *
	$js_mÆloc_π
(
JSRu¡ime
 *
π
, 
size_t
 
size
)

1243  
π
->
mf
.
	`js_mÆloc
(&π->
mÆloc_°©e
, 
size
);

1244 
	}
}

1246 
	$js_‰ì_π
(
JSRu¡ime
 *
π
, *
±r
)

1248 
π
->
mf
.
	`js_‰ì
(&π->
mÆloc_°©e
, 
±r
);

1249 
	}
}

1251 *
	$js_ªÆloc_π
(
JSRu¡ime
 *
π
, *
±r
, 
size_t
 
size
)

1253  
π
->
mf
.
	`js_ªÆloc
(&π->
mÆloc_°©e
, 
±r
, 
size
);

1254 
	}
}

1256 
size_t
 
	$js_mÆloc_ußbÀ_size_π
(
JSRu¡ime
 *
π
, c⁄° *
±r
)

1258  
π
->
mf
.
	`js_mÆloc_ußbÀ_size
(
±r
);

1259 
	}
}

1261 *
	$js_mÆlocz_π
(
JSRu¡ime
 *
π
, 
size_t
 
size
)

1263 *
±r
;

1264 
±r
 = 
	`js_mÆloc_π
(
π
, 
size
);

1265 i‡(!
±r
)

1266  
NULL
;

1267  
	`mem£t
(
±r
, 0, 
size
);

1268 
	}
}

1270 #ifde‡
CONFIG_BIGNUM


1272 *
	$js_bf_ªÆloc
(*
›aque
, *
±r
, 
size_t
 
size
)

1274 
JSRu¡ime
 *
π
 = 
›aque
;

1275  
	`js_ªÆloc_π
(
π
, 
±r
, 
size
);

1276 
	}
}

1280 *
	$js_mÆloc
(
JSC⁄ãxt
 *
˘x
, 
size_t
 
size
)

1282 *
±r
;

1283 
±r
 = 
	`js_mÆloc_π
(
˘x
->
π
, 
size
);

1284 i‡(
	`u∆ikñy
(!
±r
)) {

1285 
	`JS_ThrowOutOfMem‹y
(
˘x
);

1286  
NULL
;

1288  
±r
;

1289 
	}
}

1292 *
	$js_mÆlocz
(
JSC⁄ãxt
 *
˘x
, 
size_t
 
size
)

1294 *
±r
;

1295 
±r
 = 
	`js_mÆlocz_π
(
˘x
->
π
, 
size
);

1296 i‡(
	`u∆ikñy
(!
±r
)) {

1297 
	`JS_ThrowOutOfMem‹y
(
˘x
);

1298  
NULL
;

1300  
±r
;

1301 
	}
}

1303 
	$js_‰ì
(
JSC⁄ãxt
 *
˘x
, *
±r
)

1305 
	`js_‰ì_π
(
˘x
->
π
, 
±r
);

1306 
	}
}

1309 *
	$js_ªÆloc
(
JSC⁄ãxt
 *
˘x
, *
±r
, 
size_t
 
size
)

1311 *
ªt
;

1312 
ªt
 = 
	`js_ªÆloc_π
(
˘x
->
π
, 
±r
, 
size
);

1313 i‡(
	`u∆ikñy
(!
ªt
 && 
size
 != 0)) {

1314 
	`JS_ThrowOutOfMem‹y
(
˘x
);

1315  
NULL
;

1317  
ªt
;

1318 
	}
}

1321 *
	$js_ªÆloc2
(
JSC⁄ãxt
 *
˘x
, *
±r
, 
size_t
 
size
, size_à*
p¶ack
)

1323 *
ªt
;

1324 
ªt
 = 
	`js_ªÆloc_π
(
˘x
->
π
, 
±r
, 
size
);

1325 i‡(
	`u∆ikñy
(!
ªt
 && 
size
 != 0)) {

1326 
	`JS_ThrowOutOfMem‹y
(
˘x
);

1327  
NULL
;

1329 i‡(
p¶ack
) {

1330 
size_t
 
√w_size
 = 
	`js_mÆloc_ußbÀ_size_π
(
˘x
->
π
, 
ªt
);

1331 *
p¶ack
 = (
√w_size
 > 
size
) ?Çew_size - size : 0;

1333  
ªt
;

1334 
	}
}

1336 
size_t
 
	$js_mÆloc_ußbÀ_size
(
JSC⁄ãxt
 *
˘x
, c⁄° *
±r
)

1338  
	`js_mÆloc_ußbÀ_size_π
(
˘x
->
π
, 
±r
);

1339 
	}
}

1342 *
	$js_°∫dup
(
JSC⁄ãxt
 *
˘x
, c⁄° *
s
, 
size_t
 
n
)

1344 *
±r
;

1345 
±r
 = 
	`js_mÆloc
(
˘x
, 
n
 + 1);

1346 i‡(
±r
) {

1347 
	`mem˝y
(
±r
, 
s
, 
n
);

1348 
±r
[
n
] = '\0';

1350  
±r
;

1351 
	}
}

1353 *
	$js_°rdup
(
JSC⁄ãxt
 *
˘x
, c⁄° *
°r
)

1355  
	`js_°∫dup
(
˘x
, 
°r
, 
	`°æí
(str));

1356 
	}
}

1358 
ölöe
 
	$js_dbuf_öô
(
JSC⁄ãxt
 *
˘x
, 
DynBuf
 *
s
)

1360 
	`dbuf_öô2
(
s
, 
˘x
->
π
, (
DynBufRóŒocFunc
 *)
js_ªÆloc_π
);

1361 
	}
}

1363 
ölöe
 
	$is_digô
(
c
) {

1364  
c
 >= '0' && c <= '9';

1365 
	}
}

1367 
	sJSCœssSh‹tDef
 {

1368 
JSAtom
 
	m˛ass_«me
;

1369 
JSCœssFöÆizî
 *
	mföÆizî
;

1370 
JSCœssGCM¨k
 *
	mgc_m¨k
;

1371 } 
	tJSCœssSh‹tDef
;

1373 
JSCœssSh‹tDef
 c⁄° 
	gjs_°d_˛ass_def
[] = {

1374 { 
JS_ATOM_Obje˘
, 
NULL
, NULL },

1375 { 
JS_ATOM_Aºay
, 
js_¨øy_föÆizî
, 
js_¨øy_m¨k
 },

1376 { 
JS_ATOM_Eº‹
, 
js_obje˘_d©a_föÆizî
, 
js_obje˘_d©a_m¨k
 },

1377 { 
JS_ATOM_Numbî
, 
js_obje˘_d©a_föÆizî
, 
js_obje˘_d©a_m¨k
 },

1378 { 
JS_ATOM_Såög
, 
js_obje˘_d©a_föÆizî
, 
js_obje˘_d©a_m¨k
 },

1379 { 
JS_ATOM_Boﬁón
, 
js_obje˘_d©a_föÆizî
, 
js_obje˘_d©a_m¨k
 },

1380 { 
JS_ATOM_Symbﬁ
, 
js_obje˘_d©a_föÆizî
, 
js_obje˘_d©a_m¨k
 },

1381 { 
JS_ATOM_Argumíts
, 
js_¨øy_föÆizî
, 
js_¨øy_m¨k
 },

1382 { 
JS_ATOM_Argumíts
, 
NULL
, NULL },

1383 { 
JS_ATOM_D©e
, 
js_obje˘_d©a_föÆizî
, 
js_obje˘_d©a_m¨k
 },

1384 { 
JS_ATOM_Obje˘
, 
NULL
, NULL },

1385 { 
JS_ATOM_Fun˘i⁄
, 
js_c_fun˘i⁄_föÆizî
, 
js_c_fun˘i⁄_m¨k
 },

1386 { 
JS_ATOM_Fun˘i⁄
, 
js_byãcode_fun˘i⁄_föÆizî
, 
js_byãcode_fun˘i⁄_m¨k
 },

1387 { 
JS_ATOM_Fun˘i⁄
, 
js_bound_fun˘i⁄_föÆizî
, 
js_bound_fun˘i⁄_m¨k
 },

1388 { 
JS_ATOM_Fun˘i⁄
, 
js_c_fun˘i⁄_d©a_föÆizî
, 
js_c_fun˘i⁄_d©a_m¨k
 },

1389 { 
JS_ATOM_Gíî©‹Fun˘i⁄
, 
js_byãcode_fun˘i⁄_föÆizî
, 
js_byãcode_fun˘i⁄_m¨k
 },

1390 { 
JS_ATOM_F‹InIãøt‹
, 
js_f‹_ö_ôî©‹_föÆizî
, 
js_f‹_ö_ôî©‹_m¨k
 },

1391 { 
JS_ATOM_RegExp
, 
js_ªgexp_föÆizî
, 
NULL
 },

1392 { 
JS_ATOM_AºayBuf„r
, 
js_¨øy_buf„r_föÆizî
, 
NULL
 },

1393 { 
JS_ATOM_Sh¨edAºayBuf„r
, 
js_¨øy_buf„r_föÆizî
, 
NULL
 },

1394 { 
JS_ATOM_Uöt8Cœm≥dAºay
, 
js_ty≥d_¨øy_föÆizî
, 
js_ty≥d_¨øy_m¨k
 },

1395 { 
JS_ATOM_I¡8Aºay
, 
js_ty≥d_¨øy_föÆizî
, 
js_ty≥d_¨øy_m¨k
 },

1396 { 
JS_ATOM_Uöt8Aºay
, 
js_ty≥d_¨øy_föÆizî
, 
js_ty≥d_¨øy_m¨k
 },

1397 { 
JS_ATOM_I¡16Aºay
, 
js_ty≥d_¨øy_föÆizî
, 
js_ty≥d_¨øy_m¨k
 },

1398 { 
JS_ATOM_Uöt16Aºay
, 
js_ty≥d_¨øy_föÆizî
, 
js_ty≥d_¨øy_m¨k
 },

1399 { 
JS_ATOM_I¡32Aºay
, 
js_ty≥d_¨øy_föÆizî
, 
js_ty≥d_¨øy_m¨k
 },

1400 { 
JS_ATOM_Uöt32Aºay
, 
js_ty≥d_¨øy_föÆizî
, 
js_ty≥d_¨øy_m¨k
 },

1401 #ifde‡
CONFIG_BIGNUM


1402 { 
JS_ATOM_BigI¡64Aºay
, 
js_ty≥d_¨øy_föÆizî
, 
js_ty≥d_¨øy_m¨k
 },

1403 { 
JS_ATOM_BigUöt64Aºay
, 
js_ty≥d_¨øy_föÆizî
, 
js_ty≥d_¨øy_m¨k
 },

1405 { 
JS_ATOM_Flﬂt32Aºay
, 
js_ty≥d_¨øy_föÆizî
, 
js_ty≥d_¨øy_m¨k
 },

1406 { 
JS_ATOM_Flﬂt64Aºay
, 
js_ty≥d_¨øy_föÆizî
, 
js_ty≥d_¨øy_m¨k
 },

1407 { 
JS_ATOM_D©aVõw
, 
js_ty≥d_¨øy_föÆizî
, 
js_ty≥d_¨øy_m¨k
 },

1408 #ifde‡
CONFIG_BIGNUM


1409 { 
JS_ATOM_BigI¡
, 
js_obje˘_d©a_föÆizî
, 
js_obje˘_d©a_m¨k
 },

1410 { 
JS_ATOM_BigFlﬂt
, 
js_obje˘_d©a_föÆizî
, 
js_obje˘_d©a_m¨k
 },

1411 { 
JS_ATOM_BigFlﬂtEnv
, 
js_Êﬂt_ív_föÆizî
, 
NULL
 },

1412 { 
JS_ATOM_BigDecimÆ
, 
js_obje˘_d©a_föÆizî
, 
js_obje˘_d©a_m¨k
 },

1413 { 
JS_ATOM_O≥øt‹Së
, 
js_›î©‹_£t_föÆizî
, 
js_›î©‹_£t_m¨k
 },

1415 { 
JS_ATOM_M≠
, 
js_m≠_föÆizî
, 
js_m≠_m¨k
 },

1416 { 
JS_ATOM_Së
, 
js_m≠_föÆizî
, 
js_m≠_m¨k
 },

1417 { 
JS_ATOM_WókM≠
, 
js_m≠_föÆizî
, 
js_m≠_m¨k
 },

1418 { 
JS_ATOM_WókSë
, 
js_m≠_föÆizî
, 
js_m≠_m¨k
 },

1419 { 
JS_ATOM_M≠_Iãøt‹
, 
js_m≠_ôî©‹_föÆizî
, 
js_m≠_ôî©‹_m¨k
 },

1420 { 
JS_ATOM_Së_Iãøt‹
, 
js_m≠_ôî©‹_föÆizî
, 
js_m≠_ôî©‹_m¨k
 },

1421 { 
JS_ATOM_Aºay_Iãøt‹
, 
js_¨øy_ôî©‹_föÆizî
, 
js_¨øy_ôî©‹_m¨k
 },

1422 { 
JS_ATOM_Såög_Iãøt‹
, 
js_¨øy_ôî©‹_föÆizî
, 
js_¨øy_ôî©‹_m¨k
 },

1423 { 
JS_ATOM_RegExp_Såög_Iãøt‹
, 
js_ªgexp_°rög_ôî©‹_föÆizî
, 
js_ªgexp_°rög_ôî©‹_m¨k
 },

1424 { 
JS_ATOM_Gíî©‹
, 
js_gíî©‹_föÆizî
, 
js_gíî©‹_m¨k
 },

1427 
	$öô_˛ass_ønge
(
JSRu¡ime
 *
π
, 
JSCœssSh‹tDef
 c⁄° *
èb
,

1428 
°¨t
, 
cou¡
)

1430 
JSCœssDef
 
cm_s
, *
cm
 = &cm_s;

1431 
i
, 
˛ass_id
;

1433 
i
 = 0; i < 
cou¡
; i++) {

1434 
˛ass_id
 = 
i
 + 
°¨t
;

1435 
	`mem£t
(
cm
, 0, (*cm));

1436 
cm
->
föÆizî
 = 
èb
[
i
].finalizer;

1437 
cm
->
gc_m¨k
 = 
èb
[
i
].gc_mark;

1438 i‡(
	`JS_NewCœss1
(
π
, 
˛ass_id
, 
cm
, 
èb
[
i
].
˛ass_«me
) < 0)

1442 
	}
}

1444 #ifde‡
CONFIG_BIGNUM


1445 
JSVÆue
 
	$JS_ThrowUnsuµ‹ãdO≥øti⁄
(
JSC⁄ãxt
 *
˘x
)

1447  
	`JS_ThrowTy≥Eº‹
(
˘x
, "unsupported operation");

1448 
	}
}

1450 
JSVÆue
 
	$övÆid_to_°rög
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
vÆ
)

1452  
	`JS_ThrowUnsuµ‹ãdO≥øti⁄
(
˘x
);

1453 
	}
}

1455 
JSVÆue
 
	$övÆid_‰om_°rög
(
JSC⁄ãxt
 *
˘x
, c⁄° *
buf
,

1456 
ødix
, 
Êags
, 
¶imb_t
 *
≥xp⁄ít
)

1458  
JS_NAN
;

1459 
	}
}

1461 
	$övÆid_u«ry_¨ôh
(
JSC⁄ãxt
 *
˘x
,

1462 
JSVÆue
 *
¥es
, 
OPCodeEnum
 
›
, JSVÆuê
›1
)

1464 
	`JS_FªeVÆue
(
˘x
, 
›1
);

1465 
	`JS_ThrowUnsuµ‹ãdO≥øti⁄
(
˘x
);

1467 
	}
}

1469 
	$övÆid_bö¨y_¨ôh
(
JSC⁄ãxt
 *
˘x
, 
OPCodeEnum
 
›
,

1470 
JSVÆue
 *
¥es
, JSVÆuê
›1
, JSVÆuê
›2
)

1472 
	`JS_FªeVÆue
(
˘x
, 
›1
);

1473 
	`JS_FªeVÆue
(
˘x
, 
›2
);

1474 
	`JS_ThrowUnsuµ‹ãdO≥øti⁄
(
˘x
);

1476 
	}
}

1478 
JSVÆue
 
	$övÆid_mul_pow10_to_Êﬂt64
(
JSC⁄ãxt
 *
˘x
, c⁄° 
bf_t
 *
a
,

1479 
öt64_t
 
exp⁄ít
)

1481  
	`JS_ThrowUnsuµ‹ãdO≥øti⁄
(
˘x
);

1482 
	}
}

1484 
	$övÆid_mul_pow10
(
JSC⁄ãxt
 *
˘x
, 
JSVÆue
 *
•
)

1486 
	`JS_ThrowUnsuµ‹ãdO≥øti⁄
(
˘x
);

1488 
	}
}

1490 
	$£t_dummy_numîic_›s
(
JSNumîicO≥øti⁄s
 *
›s
)

1492 
›s
->
to_°rög
 = 
övÆid_to_°rög
;

1493 
›s
->
‰om_°rög
 = 
övÆid_‰om_°rög
;

1494 
›s
->
u«ry_¨ôh
 = 
övÆid_u«ry_¨ôh
;

1495 
›s
->
bö¨y_¨ôh
 = 
övÆid_bö¨y_¨ôh
;

1496 
›s
->
mul_pow10_to_Êﬂt64
 = 
övÆid_mul_pow10_to_Êﬂt64
;

1497 
›s
->
mul_pow10
 = 
övÆid_mul_pow10
;

1498 
	}
}

1502 #i‡
deföed
(
EMSCRIPTEN
)

1504 
ölöe
 
uöt8_t
 *
	$js_gë_°ack_poöãr
()

1506  
NULL
;

1507 
	}
}

1509 
ölöe
 
BOOL
 
	$js_check_°ack_ovîÊow
(
JSRu¡ime
 *
π
, 
size_t
 
Æloˇ_size
)

1511  
FALSE
;

1512 
	}
}

1515 
ölöe
 
uöt8_t
 *
	$js_gë_°ack_poöãr
()

1517  
	`__buûtö_‰ame_addªss
(0);

1518 
	}
}

1520 
ölöe
 
BOOL
 
	$js_check_°ack_ovîÊow
(
JSRu¡ime
 *
π
, 
size_t
 
Æloˇ_size
)

1522 
size_t
 
size
;

1523 
size
 = 
π
->
°ack_t›
 - 
	`js_gë_°ack_poöãr
();

1524  
	`u∆ikñy
((
size
 + 
Æloˇ_size
Ë> 
π
->
°ack_size
);

1525 
	}
}

1528 
JSRu¡ime
 *
	$JS_NewRu¡ime2
(c⁄° 
JSMÆlocFun˘i⁄s
 *
mf
, *
›aque
)

1530 
JSRu¡ime
 *
π
;

1531 
JSMÆlocSèã
 
ms
;

1533 
	`mem£t
(&
ms
, 0, (ms));

1534 
ms
.
›aque
 = opaque;

1535 
ms
.
mÆloc_limô
 = -1;

1537 
π
 = 
mf
->
	`js_mÆloc
(&
ms
, (
JSRu¡ime
));

1538 i‡(!
π
)

1539  
NULL
;

1540 
	`mem£t
(
π
, 0, (*rt));

1541 
π
->
mf
 = *mf;

1542 i‡(!
π
->
mf
.
js_mÆloc_ußbÀ_size
) {

1544 
π
->
mf
.
js_mÆloc_ußbÀ_size
 = 
js_mÆloc_ußbÀ_size_unknown
;

1546 
π
->
mÆloc_°©e
 = 
ms
;

1547 
π
->
mÆloc_gc_thªshﬁd
 = 256 * 1024;

1549 #ifde‡
CONFIG_BIGNUM


1550 
	`bf_c⁄ãxt_öô
(&
π
->
bf_˘x
, 
js_bf_ªÆloc
,Ñt);

1551 
	`£t_dummy_numîic_›s
(&
π
->
bigöt_›s
);

1552 
	`£t_dummy_numîic_›s
(&
π
->
bigÊﬂt_›s
);

1553 
	`£t_dummy_numîic_›s
(&
π
->
bigdecimÆ_›s
);

1556 
	`öô_li°_hód
(&
π
->
c⁄ãxt_li°
);

1557 
	`öô_li°_hód
(&
π
->
gc_obj_li°
);

1558 
	`öô_li°_hód
(&
π
->
gc_zîo_ªf_cou¡_li°
);

1559 
π
->
gc_pha£
 = 
JS_GC_PHASE_NONE
;

1561 #ifde‡
DUMP_LEAKS


1562 
	`öô_li°_hód
(&
π
->
°rög_li°
);

1564 
	`öô_li°_hód
(&
π
->
job_li°
);

1566 i‡(
	`JS_InôAtoms
(
π
))

1567 
Áû
;

1570 i‡(
	`öô_˛ass_ønge
(
π
, 
js_°d_˛ass_def
, 
JS_CLASS_OBJECT
,

1571 
	`cou¡of
(
js_°d_˛ass_def
)) < 0)

1572 
Áû
;

1573 
π
->
˛ass_¨øy
[
JS_CLASS_ARGUMENTS
].
exŸic
 = &
js_¨gumíts_exŸic_mëhods
;

1574 
π
->
˛ass_¨øy
[
JS_CLASS_STRING
].
exŸic
 = &
js_°rög_exŸic_mëhods
;

1575 
π
->
˛ass_¨øy
[
JS_CLASS_MODULE_NS
].
exŸic
 = &
js_moduÀ_ns_exŸic_mëhods
;

1577 
π
->
˛ass_¨øy
[
JS_CLASS_C_FUNCTION
].
ˇŒ
 = 
js_ˇŒ_c_fun˘i⁄
;

1578 
π
->
˛ass_¨øy
[
JS_CLASS_C_FUNCTION_DATA
].
ˇŒ
 = 
js_c_fun˘i⁄_d©a_ˇŒ
;

1579 
π
->
˛ass_¨øy
[
JS_CLASS_BOUND_FUNCTION
].
ˇŒ
 = 
js_ˇŒ_bound_fun˘i⁄
;

1580 
π
->
˛ass_¨øy
[
JS_CLASS_GENERATOR_FUNCTION
].
ˇŒ
 = 
js_gíî©‹_fun˘i⁄_ˇŒ
;

1581 i‡(
	`öô_sh≠e_hash
(
π
))

1582 
Áû
;

1584 
π
->
°ack_t›
 = 
	`js_gë_°ack_poöãr
();

1585 
π
->
°ack_size
 = 
JS_DEFAULT_STACK_SIZE
;

1586 
π
->
cuºít_ex˚±i⁄
 = 
JS_NULL
;

1588  
π
;

1589 
Áû
:

1590 
	`JS_FªeRu¡ime
(
π
);

1591  
NULL
;

1592 
	}
}

1594 *
	$JS_GëRu¡imeO∑que
(
JSRu¡ime
 *
π
)

1596  
π
->
u£r_›aque
;

1597 
	}
}

1599 
	$JS_SëRu¡imeO∑que
(
JSRu¡ime
 *
π
, *
›aque
)

1601 
π
->
u£r_›aque
 = 
›aque
;

1602 
	}
}

1605 
ölöe
 
size_t
 
	$js_def_mÆloc_ußbÀ_size
(*
±r
)

1607 #i‡
	`deföed
(
__APPLE__
)

1608  
	`mÆloc_size
(
±r
);

1609 #ñi‡
	`deföed
(
_WIN32
)

1610  
	`_msize
(
±r
);

1611 #ñi‡
	`deföed
(
EMSCRIPTEN
)

1613 #ñi‡
	`deföed
(
__löux__
)

1614  
	`mÆloc_ußbÀ_size
(
±r
);

1617  
	`mÆloc_ußbÀ_size
(
±r
);

1619 
	}
}

1621 *
	$js_def_mÆloc
(
JSMÆlocSèã
 *
s
, 
size_t
 
size
)

1623 *
±r
;

1626 
	`as£π
(
size
 != 0);

1628 i‡(
	`u∆ikñy
(
s
->
mÆloc_size
 + 
size
 > s->
mÆloc_limô
))

1629  
NULL
;

1631 
±r
 = 
	`mÆloc
(
size
);

1632 i‡(!
±r
)

1633  
NULL
;

1635 
s
->
mÆloc_cou¡
++;

1636 
s
->
mÆloc_size
 +
	`js_def_mÆloc_ußbÀ_size
(
±r
Ë+ 
MALLOC_OVERHEAD
;

1637  
±r
;

1638 
	}
}

1640 
	$js_def_‰ì
(
JSMÆlocSèã
 *
s
, *
±r
)

1642 i‡(!
±r
)

1645 
s
->
mÆloc_cou¡
--;

1646 
s
->
mÆloc_size
 -
	`js_def_mÆloc_ußbÀ_size
(
±r
Ë+ 
MALLOC_OVERHEAD
;

1647 
	`‰ì
(
±r
);

1648 
	}
}

1650 *
	$js_def_ªÆloc
(
JSMÆlocSèã
 *
s
, *
±r
, 
size_t
 
size
)

1652 
size_t
 
ﬁd_size
;

1654 i‡(!
±r
) {

1655 i‡(
size
 == 0)

1656  
NULL
;

1657  
	`js_def_mÆloc
(
s
, 
size
);

1659 
ﬁd_size
 = 
	`js_def_mÆloc_ußbÀ_size
(
±r
);

1660 i‡(
size
 == 0) {

1661 
s
->
mÆloc_cou¡
--;

1662 
s
->
mÆloc_size
 -
ﬁd_size
 + 
MALLOC_OVERHEAD
;

1663 
	`‰ì
(
±r
);

1664  
NULL
;

1666 i‡(
s
->
mÆloc_size
 + 
size
 - 
ﬁd_size
 > s->
mÆloc_limô
)

1667  
NULL
;

1669 
±r
 = 
	`ªÆloc
’å, 
size
);

1670 i‡(!
±r
)

1671  
NULL
;

1673 
s
->
mÆloc_size
 +
	`js_def_mÆloc_ußbÀ_size
(
±r
Ë- 
ﬁd_size
;

1674  
±r
;

1675 
	}
}

1677 c⁄° 
JSMÆlocFun˘i⁄s
 
	gdef_mÆloc_funcs
 = {

1678 
js_def_mÆloc
,

1679 
js_def_‰ì
,

1680 
js_def_ªÆloc
,

1681 #i‡
deföed
(
__APPLE__
)

1682 
mÆloc_size
,

1683 #ñi‡
deföed
(
_WIN32
)

1684 (
size_t
 (*)(c⁄° *))
_msize
,

1685 #ñi‡
deföed
(
EMSCRIPTEN
)

1686 
NULL
,

1687 #ñi‡
deföed
(
__löux__
)

1688 (
size_t
 (*)(c⁄° *))
mÆloc_ußbÀ_size
,

1691 
mÆloc_ußbÀ_size
,

1695 
JSRu¡ime
 *
	$JS_NewRu¡ime
()

1697  
	`JS_NewRu¡ime2
(&
def_mÆloc_funcs
, 
NULL
);

1698 
	}
}

1700 
	$JS_SëMem‹yLimô
(
JSRu¡ime
 *
π
, 
size_t
 
limô
)

1702 
π
->
mÆloc_°©e
.
mÆloc_limô
 = 
limô
;

1703 
	}
}

1706 
	$JS_SëGCThªshﬁd
(
JSRu¡ime
 *
π
, 
size_t
 
gc_thªshﬁd
)

1708 
π
->
mÆloc_gc_thªshﬁd
 = 
gc_thªshﬁd
;

1709 
	}
}

1711 
	#mÆloc
(
s
Ë
	`mÆloc_is_f‹biddí
(s)

	)

1712 
	#‰ì
(
p
Ë
	`‰ì_is_f‹biddí
’)

	)

1713 
	#ªÆloc
(
p
,
s
Ë
	`ªÆloc_is_f‹biddí
’,s)

	)

1715 
	$JS_SëI¡îru±H™dÀr
(
JSRu¡ime
 *
π
, 
JSI¡îru±H™dÀr
 *
cb
, *
›aque
)

1717 
π
->
öãºu±_h™dÀr
 = 
cb
;

1718 
π
->
öãºu±_›aque
 = 
›aque
;

1719 
	}
}

1721 
	$JS_SëC™Block
(
JSRu¡ime
 *
π
, 
BOOL
 
ˇn_block
)

1723 
π
->
ˇn_block
 = can_block;

1724 
	}
}

1727 
	$JS_EnqueueJob
(
JSC⁄ãxt
 *
˘x
, 
JSJobFunc
 *
job_func
,

1728 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

1730 
JSRu¡ime
 *
π
 = 
˘x
->rt;

1731 
JSJobE¡ry
 *
e
;

1732 
i
;

1734 
e
 = 
	`js_mÆloc
(
˘x
, (*eË+ 
¨gc
 * (
JSVÆue
));

1735 i‡(!
e
)

1737 
e
->
˘x
 = ctx;

1738 
e
->
job_func
 = job_func;

1739 
e
->
¨gc
 =árgc;

1740 
i
 = 0; i < 
¨gc
; i++) {

1741 
e
->
¨gv
[
i
] = 
	`JS_DupVÆue
(
˘x
,árgv[i]);

1743 
	`li°_add_èû
(&
e
->
lök
, &
π
->
job_li°
);

1745 
	}
}

1747 
BOOL
 
	$JS_IsJobPídög
(
JSRu¡ime
 *
π
)

1749  !
	`li°_em±y
(&
π
->
job_li°
);

1750 
	}
}

1754 
	$JS_ExecuãPídögJob
(
JSRu¡ime
 *
π
, 
JSC⁄ãxt
 **
p˘x
)

1756 
JSC⁄ãxt
 *
˘x
;

1757 
JSJobE¡ry
 *
e
;

1758 
JSVÆue
 
ªs
;

1759 
i
, 
ªt
;

1761 i‡(
	`li°_em±y
(&
π
->
job_li°
)) {

1762 *
p˘x
 = 
NULL
;

1767 
e
 = 
	`li°_íåy
(
π
->
job_li°
.
√xt
, 
JSJobE¡ry
, 
lök
);

1768 
	`li°_dñ
(&
e
->
lök
);

1769 
˘x
 = 
e
->ctx;

1770 
ªs
 = 
e
->
	`job_func
”->
˘x
,É->
¨gc
, (
JSVÆueC⁄°
 *Î->
¨gv
);

1771 
i
 = 0; i < 
e
->
¨gc
; i++)

1772 
	`JS_FªeVÆue
(
˘x
, 
e
->
¨gv
[
i
]);

1773 i‡(
	`JS_IsEx˚±i⁄
(
ªs
))

1774 
ªt
 = -1;

1776 
ªt
 = 1;

1777 
	`JS_FªeVÆue
(
˘x
, 
ªs
);

1778 
	`js_‰ì
(
˘x
, 
e
);

1779 *
p˘x
 = 
˘x
;

1780  
ªt
;

1781 
	}
}

1783 
ölöe
 
uöt32_t
 
	$©om_gë_‰ì
(c⁄° 
JSAtomSåu˘
 *
p
)

1785  (
uöçå_t
)
p
 >> 1;

1786 
	}
}

1788 
ölöe
 
BOOL
 
	$©om_is_‰ì
(c⁄° 
JSAtomSåu˘
 *
p
)

1790  (
uöçå_t
)
p
 & 1;

1791 
	}
}

1793 
ölöe
 
JSAtomSåu˘
 *
	$©om_£t_‰ì
(
uöt32_t
 
v
)

1795  (
JSAtomSåu˘
 *)(((
uöçå_t
)
v
 << 1) | 1);

1796 
	}
}

1799 
JSSåög
 *
	$js_Æloc_°rög_π
(
JSRu¡ime
 *
π
, 
max_Àn
, 
is_wide_ch¨
)

1801 
JSSåög
 *
°r
;

1802 
°r
 = 
	`js_mÆloc_π
(
π
, (
JSSåög
Ë+ (
max_Àn
 << 
is_wide_ch¨
) + 1 - is_wide_char);

1803 i‡(
	`u∆ikñy
(!
°r
))

1804  
NULL
;

1805 
°r
->
hódî
.
ªf_cou¡
 = 1;

1806 
°r
->
is_wide_ch¨
 = is_wide_char;

1807 
°r
->
Àn
 = 
max_Àn
;

1808 
°r
->
©om_ty≥
 = 0;

1809 
°r
->
hash
 = 0;

1810 
°r
->
hash_√xt
 = 0;

1811 #ifde‡
DUMP_LEAKS


1812 
	`li°_add_èû
(&
°r
->
lök
, &
π
->
°rög_li°
);

1814  
°r
;

1815 
	}
}

1817 
JSSåög
 *
	$js_Æloc_°rög
(
JSC⁄ãxt
 *
˘x
, 
max_Àn
, 
is_wide_ch¨
)

1819 
JSSåög
 *
p
;

1820 
p
 = 
	`js_Æloc_°rög_π
(
˘x
->
π
, 
max_Àn
, 
is_wide_ch¨
);

1821 i‡(
	`u∆ikñy
(!
p
)) {

1822 
	`JS_ThrowOutOfMem‹y
(
˘x
);

1823  
NULL
;

1825  
p
;

1826 
	}
}

1829 
ölöe
 
	$js_‰ì_°rög
(
JSRu¡ime
 *
π
, 
JSSåög
 *
°r
)

1831 i‡(--
°r
->
hódî
.
ªf_cou¡
 <= 0) {

1832 i‡(
°r
->
©om_ty≥
) {

1833 
	`JS_FªeAtomSåu˘
(
π
, 
°r
);

1835 #ifde‡
DUMP_LEAKS


1836 
	`li°_dñ
(&
°r
->
lök
);

1838 
	`js_‰ì_π
(
π
, 
°r
);

1841 
	}
}

1843 
	$JS_SëRu¡imeInfo
(
JSRu¡ime
 *
π
, c⁄° *
s
)

1845 i‡(
π
)

1846 
π
->
π_öfo
 = 
s
;

1847 
	}
}

1849 
	$JS_FªeRu¡ime
(
JSRu¡ime
 *
π
)

1851 
li°_hód
 *
ñ
, *
ñ1
;

1852 
i
;

1854 
	`JS_FªeVÆueRT
(
π
,Ñt->
cuºít_ex˚±i⁄
);

1856 
	`li°_f‹_óch_ß„
(
ñ
, 
ñ1
, &
π
->
job_li°
) {

1857 
JSJobE¡ry
 *
e
 = 
	`li°_íåy
(
ñ
, JSJobE¡ry, 
lök
);

1858 
i
 = 0; i < 
e
->
¨gc
; i++)

1859 
	`JS_FªeVÆueRT
(
π
, 
e
->
¨gv
[
i
]);

1860 
	`js_‰ì_π
(
π
, 
e
);

1862 
	`öô_li°_hód
(&
π
->
job_li°
);

1864 
	`JS_RunGC
(
π
);

1866 #ifde‡
DUMP_LEAKS


1869 
BOOL
 
hódî_d⁄e
;

1870 
JSGCObje˘Hódî
 *
p
;

1871 
cou¡
;

1875 
	`li°_f‹_óch
(
ñ
, &
π
->
gc_obj_li°
) {

1876 
p
 = 
	`li°_íåy
(
ñ
, 
JSGCObje˘Hódî
, 
lök
);

1877 
p
->
m¨k
 = 0;

1879 
	`gc_de¸ef
(
π
);

1881 
hódî_d⁄e
 = 
FALSE
;

1882 
	`li°_f‹_óch
(
ñ
, &
π
->
gc_obj_li°
) {

1883 
p
 = 
	`li°_íåy
(
ñ
, 
JSGCObje˘Hódî
, 
lök
);

1884 i‡(
p
->
ªf_cou¡
 != 0) {

1885 i‡(!
hódî_d⁄e
) {

1886 
	`¥ötf
("ObjectÜeaks:\n");

1887 
	`JS_DumpObje˘Hódî
(
π
);

1888 
hódî_d⁄e
 = 
TRUE
;

1890 
	`JS_DumpGCObje˘
(
π
, 
p
);

1894 
cou¡
 = 0;

1895 
	`li°_f‹_óch
(
ñ
, &
π
->
gc_obj_li°
) {

1896 
p
 = 
	`li°_íåy
(
ñ
, 
JSGCObje˘Hódî
, 
lök
);

1897 i‡(
p
->
ªf_cou¡
 == 0) {

1898 
cou¡
++;

1901 i‡(
cou¡
 != 0)

1902 
	`¥ötf
("Sec⁄d¨y obje˘Üóks: %d\n", 
cou¡
);

1905 
	`as£π
(
	`li°_em±y
(&
π
->
gc_obj_li°
));

1908 
i
 = 0; i < 
π
->
˛ass_cou¡
; i++) {

1909 
JSCœss
 *
˛
 = &
π
->
˛ass_¨øy
[
i
];

1910 i‡(
˛
->
˛ass_id
 != 0) {

1911 
	`JS_FªeAtomRT
(
π
, 
˛
->
˛ass_«me
);

1914 
	`js_‰ì_π
(
π
,Ñt->
˛ass_¨øy
);

1916 #ifde‡
CONFIG_BIGNUM


1917 
	`bf_c⁄ãxt_íd
(&
π
->
bf_˘x
);

1920 #ifde‡
DUMP_LEAKS


1923 
BOOL
 
hódî_d⁄e
 = 
FALSE
;

1925 
i
 = 0; i < 
π
->
©om_size
; i++) {

1926 
JSAtomSåu˘
 *
p
 = 
π
->
©om_¨øy
[
i
];

1927 i‡(!
	`©om_is_‰ì
(
p
) ) {

1928 i‡(
i
 >
JS_ATOM_END
 || 
p
->
hódî
.
ªf_cou¡
 != 1) {

1929 i‡(!
hódî_d⁄e
) {

1930 
hódî_d⁄e
 = 
TRUE
;

1931 i‡(
π
->
π_öfo
) {

1932 
	`¥ötf
("%s:1:átomÜókage:", 
π
->
π_öfo
);

1934 
	`¥ötf
("AtomÜeaks:\n"

1939 i‡(
π
->
π_öfo
) {

1940 
	`¥ötf
(" ");

1942 
	`¥ötf
(" %6u %6u ", 
i
, 
p
->
hódî
.
ªf_cou¡
);

1944 
p
->
©om_ty≥
) {

1945 
JS_ATOM_TYPE_STRING
:

1946 
	`JS_DumpSåög
(
π
, 
p
);

1948 
JS_ATOM_TYPE_GLOBAL_SYMBOL
:

1949 
	`¥ötf
("Symbol.for(");

1950 
	`JS_DumpSåög
(
π
, 
p
);

1951 
	`¥ötf
(")");

1953 
JS_ATOM_TYPE_SYMBOL
:

1954 i‡(
p
->
hash
 =
JS_ATOM_HASH_SYMBOL
) {

1955 
	`¥ötf
("Symbol(");

1956 
	`JS_DumpSåög
(
π
, 
p
);

1957 
	`¥ötf
(")");

1959 
	`¥ötf
("Private(");

1960 
	`JS_DumpSåög
(
π
, 
p
);

1961 
	`¥ötf
(")");

1965 i‡(
π
->
π_öfo
) {

1966 
	`¥ötf
(":%u", 
p
->
hódî
.
ªf_cou¡
);

1968 
	`¥ötf
("\n");

1973 i‡(
π
->
π_öfo
 && 
hódî_d⁄e
)

1974 
	`¥ötf
("\n");

1979 
i
 = 0; i < 
π
->
©om_size
; i++) {

1980 
JSAtomSåu˘
 *
p
 = 
π
->
©om_¨øy
[
i
];

1981 i‡(!
	`©om_is_‰ì
(
p
)) {

1982 #ifde‡
DUMP_LEAKS


1983 
	`li°_dñ
(&
p
->
lök
);

1985 
	`js_‰ì_π
(
π
, 
p
);

1988 
	`js_‰ì_π
(
π
,Ñt->
©om_¨øy
);

1989 
	`js_‰ì_π
(
π
,Ñt->
©om_hash
);

1990 
	`js_‰ì_π
(
π
,Ñt->
sh≠e_hash
);

1991 #ifde‡
DUMP_LEAKS


1992 i‡(!
	`li°_em±y
(&
π
->
°rög_li°
)) {

1993 i‡(
π
->
π_öfo
) {

1994 
	`¥ötf
("%s:1: såögÜókage:", 
π
->
π_öfo
);

1996 
	`¥ötf
("StringÜeaks:\n"

2000 
	`li°_f‹_óch_ß„
(
ñ
, 
ñ1
, &
π
->
°rög_li°
) {

2001 
JSSåög
 *
°r
 = 
	`li°_íåy
(
ñ
, JSSåög, 
lök
);

2002 i‡(
π
->
π_öfo
) {

2003 
	`¥ötf
(" ");

2005 
	`¥ötf
(" %6u ", 
°r
->
hódî
.
ªf_cou¡
);

2007 
	`JS_DumpSåög
(
π
, 
°r
);

2008 i‡(
π
->
π_öfo
) {

2009 
	`¥ötf
(":%u", 
°r
->
hódî
.
ªf_cou¡
);

2011 
	`¥ötf
("\n");

2013 
	`li°_dñ
(&
°r
->
lök
);

2014 
	`js_‰ì_π
(
π
, 
°r
);

2016 i‡(
π
->
π_öfo
)

2017 
	`¥ötf
("\n");

2020 
JSMÆlocSèã
 *
s
 = &
π
->
mÆloc_°©e
;

2021 i‡(
s
->
mÆloc_cou¡
 > 1) {

2022 i‡(
π
->
π_öfo
)

2023 
	`¥ötf
("%s:1: ", 
π
->
π_öfo
);

2024 
	`¥ötf
("Mem‹yÜók: %"
PRIu64
" bytesÜost in %"PRIu64" block%s\n",

2025 (
uöt64_t
)(
s
->
mÆloc_size
 - (
JSRu¡ime
)),

2026 (
uöt64_t
)(
s
->
mÆloc_cou¡
 - 1), &"s"[s->malloc_count == 2]);

2032 
JSMÆlocSèã
 
ms
 = 
π
->
mÆloc_°©e
;

2033 
π
->
mf
.
	`js_‰ì
(&
ms
,Ñt);

2035 
	}
}

2037 
JSC⁄ãxt
 *
	$JS_NewC⁄ãxtRaw
(
JSRu¡ime
 *
π
)

2039 
JSC⁄ãxt
 *
˘x
;

2040 
i
;

2042 
˘x
 = 
	`js_mÆlocz_π
(
π
, (
JSC⁄ãxt
));

2043 i‡(!
˘x
)

2044  
NULL
;

2045 
˘x
->
hódî
.
ªf_cou¡
 = 1;

2046 
	`add_gc_obje˘
(
π
, &
˘x
->
hódî
, 
JS_GC_OBJ_TYPE_JS_CONTEXT
);

2048 
˘x
->
˛ass_¥Ÿo
 = 
	`js_mÆloc_π
(
π
, (ctx->class_proto[0]) *

2049 
π
->
˛ass_cou¡
);

2050 i‡(!
˘x
->
˛ass_¥Ÿo
) {

2051 
	`js_‰ì_π
(
π
, 
˘x
);

2052  
NULL
;

2054 
˘x
->
π
 =Ñt;

2055 
	`li°_add_èû
(&
˘x
->
lök
, &
π
->
c⁄ãxt_li°
);

2056 #ifde‡
CONFIG_BIGNUM


2057 
˘x
->
bf_˘x
 = &
π
->bf_ctx;

2058 
˘x
->
Â_ív
.
¥ec
 = 113;

2059 
˘x
->
Â_ív
.
Êags
 = 
	`bf_£t_exp_bôs
(15Ë| 
BF_RNDN
 | 
BF_FLAG_SUBNORMAL
;

2061 
i
 = 0; i < 
π
->
˛ass_cou¡
; i++)

2062 
˘x
->
˛ass_¥Ÿo
[
i
] = 
JS_NULL
;

2063 
˘x
->
¨øy_˘‹
 = 
JS_NULL
;

2064 
˘x
->
ªgexp_˘‹
 = 
JS_NULL
;

2065 
˘x
->
¥omi£_˘‹
 = 
JS_NULL
;

2066 
	`öô_li°_hód
(&
˘x
->
lﬂded_moduÀs
);

2068 
	`JS_AddI¡rösicBasicObje˘s
(
˘x
);

2069  
˘x
;

2070 
	}
}

2072 
JSC⁄ãxt
 *
	$JS_NewC⁄ãxt
(
JSRu¡ime
 *
π
)

2074 
JSC⁄ãxt
 *
˘x
;

2076 
˘x
 = 
	`JS_NewC⁄ãxtRaw
(
π
);

2077 i‡(!
˘x
)

2078  
NULL
;

2080 
	`JS_AddI¡rösicBa£Obje˘s
(
˘x
);

2081 
	`JS_AddI¡rösicD©e
(
˘x
);

2082 
	`JS_AddI¡rösicEvÆ
(
˘x
);

2083 
	`JS_AddI¡rösicSåögN‹mÆize
(
˘x
);

2084 
	`JS_AddI¡rösicRegExp
(
˘x
);

2085 
	`JS_AddI¡rösicJSON
(
˘x
);

2086 
	`JS_AddI¡rösicProxy
(
˘x
);

2087 
	`JS_AddI¡rösicM≠Së
(
˘x
);

2088 
	`JS_AddI¡rösicTy≥dAºays
(
˘x
);

2089 
	`JS_AddI¡rösicPromi£
(
˘x
);

2090 #ifde‡
CONFIG_BIGNUM


2091 
	`JS_AddI¡rösicBigI¡
(
˘x
);

2093  
˘x
;

2094 
	}
}

2096 *
	$JS_GëC⁄ãxtO∑que
(
JSC⁄ãxt
 *
˘x
)

2098  
˘x
->
u£r_›aque
;

2099 
	}
}

2101 
	$JS_SëC⁄ãxtO∑que
(
JSC⁄ãxt
 *
˘x
, *
›aque
)

2103 
˘x
->
u£r_›aque
 = 
›aque
;

2104 
	}
}

2108 
ölöe
 
	$£t_vÆue
(
JSC⁄ãxt
 *
˘x
, 
JSVÆue
 *
pvÆ
, JSVÆuê
√w_vÆ
)

2110 
JSVÆue
 
ﬁd_vÆ
;

2111 
ﬁd_vÆ
 = *
pvÆ
;

2112 *
pvÆ
 = 
√w_vÆ
;

2113 
	`JS_FªeVÆue
(
˘x
, 
ﬁd_vÆ
);

2114 
	}
}

2116 
	$JS_SëCœssPrŸo
(
JSC⁄ãxt
 *
˘x
, 
JSCœssID
 
˛ass_id
, 
JSVÆue
 
obj
)

2118 
JSRu¡ime
 *
π
 = 
˘x
->rt;

2119 
	`as£π
(
˛ass_id
 < 
π
->
˛ass_cou¡
);

2120 
	`£t_vÆue
(
˘x
, &˘x->
˛ass_¥Ÿo
[
˛ass_id
], 
obj
);

2121 
	}
}

2123 
JSVÆue
 
	$JS_GëCœssPrŸo
(
JSC⁄ãxt
 *
˘x
, 
JSCœssID
 
˛ass_id
)

2125 
JSRu¡ime
 *
π
 = 
˘x
->rt;

2126 
	`as£π
(
˛ass_id
 < 
π
->
˛ass_cou¡
);

2127  
	`JS_DupVÆue
(
˘x
, ctx->
˛ass_¥Ÿo
[
˛ass_id
]);

2128 
	}
}

2130 
	eJSFªeModuÀEnum
 {

2131 
	mJS_FREE_MODULE_ALL
,

2132 
	mJS_FREE_MODULE_NOT_RESOLVED
,

2133 
	mJS_FREE_MODULE_NOT_EVALUATED
,

2134 } 
	tJSFªeModuÀEnum
;

2137 
	$js_‰ì_moduÀs
(
JSC⁄ãxt
 *
˘x
, 
JSFªeModuÀEnum
 
Êag
)

2139 
li°_hód
 *
ñ
, *
ñ1
;

2140 
	`li°_f‹_óch_ß„
(
ñ
, 
ñ1
, &
˘x
->
lﬂded_moduÀs
) {

2141 
JSModuÀDef
 *
m
 = 
	`li°_íåy
(
ñ
, JSModuÀDef, 
lök
);

2142 i‡(
Êag
 =
JS_FREE_MODULE_ALL
 ||

2143 (
Êag
 =
JS_FREE_MODULE_NOT_RESOLVED
 && !
m
->
ªsﬁved
) ||

2144 (
Êag
 =
JS_FREE_MODULE_NOT_EVALUATED
 && !
m
->
evÆu©ed
)) {

2145 
	`js_‰ì_moduÀ_def
(
˘x
, 
m
);

2148 
	}
}

2150 
JSC⁄ãxt
 *
	$JS_DupC⁄ãxt
(
JSC⁄ãxt
 *
˘x
)

2152 
˘x
->
hódî
.
ªf_cou¡
++;

2153  
˘x
;

2154 
	}
}

2157 
	$JS_M¨kC⁄ãxt
(
JSRu¡ime
 *
π
, 
JSC⁄ãxt
 *
˘x
,

2158 
JS_M¨kFunc
 *
m¨k_func
)

2160 
i
;

2161 
li°_hód
 *
ñ
;

2165 
	`li°_f‹_óch
(
ñ
, &
˘x
->
lﬂded_moduÀs
) {

2166 
JSModuÀDef
 *
m
 = 
	`li°_íåy
(
ñ
, JSModuÀDef, 
lök
);

2167 
	`js_m¨k_moduÀ_def
(
π
, 
m
, 
m¨k_func
);

2170 
	`JS_M¨kVÆue
(
π
, 
˘x
->
globÆ_obj
, 
m¨k_func
);

2171 
	`JS_M¨kVÆue
(
π
, 
˘x
->
globÆ_v¨_obj
, 
m¨k_func
);

2173 
	`JS_M¨kVÆue
(
π
, 
˘x
->
throw_ty≥_îr‹
, 
m¨k_func
);

2174 
	`JS_M¨kVÆue
(
π
, 
˘x
->
evÆ_obj
, 
m¨k_func
);

2176 
	`JS_M¨kVÆue
(
π
, 
˘x
->
¨øy_¥Ÿo_vÆues
, 
m¨k_func
);

2177 
i
 = 0; i < 
JS_NATIVE_ERROR_COUNT
; i++) {

2178 
	`JS_M¨kVÆue
(
π
, 
˘x
->
«tive_îr‹_¥Ÿo
[
i
], 
m¨k_func
);

2180 
i
 = 0; i < 
π
->
˛ass_cou¡
; i++) {

2181 
	`JS_M¨kVÆue
(
π
, 
˘x
->
˛ass_¥Ÿo
[
i
], 
m¨k_func
);

2183 
	`JS_M¨kVÆue
(
π
, 
˘x
->
ôî©‹_¥Ÿo
, 
m¨k_func
);

2184 
	`JS_M¨kVÆue
(
π
, 
˘x
->
async_ôî©‹_¥Ÿo
, 
m¨k_func
);

2185 
	`JS_M¨kVÆue
(
π
, 
˘x
->
¥omi£_˘‹
, 
m¨k_func
);

2186 
	`JS_M¨kVÆue
(
π
, 
˘x
->
¨øy_˘‹
, 
m¨k_func
);

2187 
	`JS_M¨kVÆue
(
π
, 
˘x
->
ªgexp_˘‹
, 
m¨k_func
);

2188 
	`JS_M¨kVÆue
(
π
, 
˘x
->
fun˘i⁄_˘‹
, 
m¨k_func
);

2189 
	`JS_M¨kVÆue
(
π
, 
˘x
->
fun˘i⁄_¥Ÿo
, 
m¨k_func
);

2191 i‡(
˘x
->
¨øy_sh≠e
)

2192 
	`m¨k_func
(
π
, &
˘x
->
¨øy_sh≠e
->
hódî
);

2193 
	}
}

2195 
	$JS_FªeC⁄ãxt
(
JSC⁄ãxt
 *
˘x
)

2197 
JSRu¡ime
 *
π
 = 
˘x
->rt;

2198 
i
;

2200 i‡(--
˘x
->
hódî
.
ªf_cou¡
 > 0)

2202 
	`as£π
(
˘x
->
hódî
.
ªf_cou¡
 == 0);

2204 #ifde‡
DUMP_ATOMS


2205 
	`JS_DumpAtoms
(
˘x
->
π
);

2207 #ifde‡
DUMP_SHAPES


2208 
	`JS_DumpSh≠es
(
˘x
->
π
);

2210 #ifde‡
DUMP_OBJECTS


2212 
li°_hód
 *
ñ
;

2213 
JSGCObje˘Hódî
 *
p
;

2214 
	`¥ötf
("JSObjects: {\n");

2215 
	`JS_DumpObje˘Hódî
(
˘x
->
π
);

2216 
	`li°_f‹_óch
(
ñ
, &
π
->
gc_obj_li°
) {

2217 
p
 = 
	`li°_íåy
(
ñ
, 
JSGCObje˘Hódî
, 
lök
);

2218 
	`JS_DumpGCObje˘
(
π
, 
p
);

2220 
	`¥ötf
("}\n");

2223 #ifde‡
DUMP_MEM


2225 
JSMem‹yUßge
 
°©s
;

2226 
	`JS_CompuãMem‹yUßge
(
π
, &
°©s
);

2227 
	`JS_DumpMem‹yUßge
(
°dout
, &
°©s
, 
π
);

2231 
	`js_‰ì_moduÀs
(
˘x
, 
JS_FREE_MODULE_ALL
);

2233 
	`JS_FªeVÆue
(
˘x
, ctx->
globÆ_obj
);

2234 
	`JS_FªeVÆue
(
˘x
, ctx->
globÆ_v¨_obj
);

2236 
	`JS_FªeVÆue
(
˘x
, ctx->
throw_ty≥_îr‹
);

2237 
	`JS_FªeVÆue
(
˘x
, ctx->
evÆ_obj
);

2239 
	`JS_FªeVÆue
(
˘x
, ctx->
¨øy_¥Ÿo_vÆues
);

2240 
i
 = 0; i < 
JS_NATIVE_ERROR_COUNT
; i++) {

2241 
	`JS_FªeVÆue
(
˘x
, ctx->
«tive_îr‹_¥Ÿo
[
i
]);

2243 
i
 = 0; i < 
π
->
˛ass_cou¡
; i++) {

2244 
	`JS_FªeVÆue
(
˘x
, ctx->
˛ass_¥Ÿo
[
i
]);

2246 
	`js_‰ì_π
(
π
, 
˘x
->
˛ass_¥Ÿo
);

2247 
	`JS_FªeVÆue
(
˘x
, ctx->
ôî©‹_¥Ÿo
);

2248 
	`JS_FªeVÆue
(
˘x
, ctx->
async_ôî©‹_¥Ÿo
);

2249 
	`JS_FªeVÆue
(
˘x
, ctx->
¥omi£_˘‹
);

2250 
	`JS_FªeVÆue
(
˘x
, ctx->
¨øy_˘‹
);

2251 
	`JS_FªeVÆue
(
˘x
, ctx->
ªgexp_˘‹
);

2252 
	`JS_FªeVÆue
(
˘x
, ctx->
fun˘i⁄_˘‹
);

2253 
	`JS_FªeVÆue
(
˘x
, ctx->
fun˘i⁄_¥Ÿo
);

2255 
	`js_‰ì_sh≠e_nuŒ
(
˘x
->
π
, ctx->
¨øy_sh≠e
);

2257 
	`li°_dñ
(&
˘x
->
lök
);

2258 
	`ªmove_gc_obje˘
(&
˘x
->
hódî
);

2259 
	`js_‰ì_π
(
˘x
->
π
, ctx);

2260 
	}
}

2262 
JSRu¡ime
 *
	$JS_GëRu¡ime
(
JSC⁄ãxt
 *
˘x
)

2264  
˘x
->
π
;

2265 
	}
}

2267 
	$JS_SëMaxSèckSize
(
JSRu¡ime
 *
π
, 
size_t
 
°ack_size
)

2269 
π
->
°ack_size
 = stack_size;

2270 
	}
}

2272 
ölöe
 
BOOL
 
	$is_°ri˘_mode
(
JSC⁄ãxt
 *
˘x
)

2274 
JSSèckFøme
 *
sf
 = 
˘x
->
π
->
cuºít_°ack_‰ame
;

2275  (
sf
 && (sf->
js_mode
 & 
JS_MODE_STRICT
));

2276 
	}
}

2278 #ifde‡
CONFIG_BIGNUM


2279 
ölöe
 
BOOL
 
	$is_m©h_mode
(
JSC⁄ãxt
 *
˘x
)

2281 
JSSèckFøme
 *
sf
 = 
˘x
->
π
->
cuºít_°ack_‰ame
;

2282  (
sf
 && (sf->
js_mode
 & 
JS_MODE_MATH
));

2283 
	}
}

2288 
	#JS_ATOM_TAG_INT
 (1U << 31)

	)

2289 
	#JS_ATOM_MAX_INT
 (
JS_ATOM_TAG_INT
 - 1)

	)

2290 
	#JS_ATOM_MAX
 ((1U << 30Ë- 1)

	)

2293 
	#JS_ATOM_COUNT_RESIZE
(
n
Ë(“Ë* 2)

	)

2295 
ölöe
 
BOOL
 
	$__JS_AtomIsC⁄°
(
JSAtom
 
v
)

2297 #i‡
	`deföed
(
DUMP_LEAKS
) && DUMP_LEAKS > 1

2298  (
öt32_t
)
v
 <= 0;

2300  (
öt32_t
)
v
 < 
JS_ATOM_END
;

2302 
	}
}

2304 
ölöe
 
BOOL
 
	$__JS_AtomIsTaggedI¡
(
JSAtom
 
v
)

2306  (
v
 & 
JS_ATOM_TAG_INT
) != 0;

2307 
	}
}

2309 
ölöe
 
JSAtom
 
	$__JS_AtomFromUI¡32
(
uöt32_t
 
v
)

2311  
v
 | 
JS_ATOM_TAG_INT
;

2312 
	}
}

2314 
ölöe
 
uöt32_t
 
	$__JS_AtomToUI¡32
(
JSAtom
 
©om
)

2316  
©om
 & ~
JS_ATOM_TAG_INT
;

2317 
	}
}

2319 
ölöe
 
	$is_num
(
c
)

2321  
c
 >= '0' && c <= '9';

2322 
	}
}

2325 
ölöe
 
BOOL
 
	$is_num_°rög
(
uöt32_t
 *
pvÆ
, c⁄° 
JSSåög
 *
p
)

2327 
uöt32_t
 
n
;

2328 
uöt64_t
 
n64
;

2329 
c
, 
i
, 
Àn
;

2331 
Àn
 = 
p
->len;

2332 i‡(
Àn
 == 0 ||Üen > 10)

2333  
FALSE
;

2334 i‡(
p
->
is_wide_ch¨
)

2335 
c
 = 
p
->
u
.
°r16
[0];

2337 
c
 = 
p
->
u
.
°r8
[0];

2338 i‡(
	`is_num
(
c
)) {

2339 i‡(
c
 == '0') {

2340 i‡(
Àn
 != 1)

2341  
FALSE
;

2342 
n
 = 0;

2344 
n
 = 
c
 - '0';

2345 
i
 = 1; i < 
Àn
; i++) {

2346 i‡(
p
->
is_wide_ch¨
)

2347 
c
 = 
p
->
u
.
°r16
[
i
];

2349 
c
 = 
p
->
u
.
°r8
[
i
];

2350 i‡(!
	`is_num
(
c
))

2351  
FALSE
;

2352 
n64
 = (
uöt64_t
)
n
 * 10 + (
c
 - '0');

2353 i‡((
n64
 >> 32) != 0)

2354  
FALSE
;

2355 
n
 = 
n64
;

2358 *
pvÆ
 = 
n
;

2359  
TRUE
;

2361  
FALSE
;

2363 
	}
}

2366 
ölöe
 
uöt32_t
 
	$hash_°rög8
(c⁄° 
uöt8_t
 *
°r
, 
size_t
 
Àn
, 
uöt32_t
 
h
)

2368 
size_t
 
i
;

2370 
i
 = 0; i < 
Àn
; i++)

2371 
h
 = h * 263 + 
°r
[
i
];

2372  
h
;

2373 
	}
}

2375 
ölöe
 
uöt32_t
 
	$hash_°rög16
(c⁄° 
uöt16_t
 *
°r
,

2376 
size_t
 
Àn
, 
uöt32_t
 
h
)

2378 
size_t
 
i
;

2380 
i
 = 0; i < 
Àn
; i++)

2381 
h
 = h * 263 + 
°r
[
i
];

2382  
h
;

2383 
	}
}

2385 
uöt32_t
 
	$hash_°rög
(c⁄° 
JSSåög
 *
°r
, 
uöt32_t
 
h
)

2387 i‡(
°r
->
is_wide_ch¨
)

2388 
h
 = 
	`hash_°rög16
(
°r
->
u
.
°r16
, så->
Àn
, h);

2390 
h
 = 
	`hash_°rög8
(
°r
->
u
.
°r8
, så->
Àn
, h);

2391  
h
;

2392 
	}
}

2394 
__maybe_unu£d
 
	$JS_DumpSåög
(
JSRu¡ime
 *
π
,

2395 c⁄° 
JSSåög
 *
p
)

2397 
i
, 
c
, 
£p
;

2399 i‡(
p
 =
NULL
) {

2400 
	`¥ötf
("<null>");

2403 
	`¥ötf
("%d", 
p
->
hódî
.
ªf_cou¡
);

2404 
£p
 = (
p
->
hódî
.
ªf_cou¡
 == 1) ? '\"' : '\'';

2405 
	`putch¨
(
£p
);

2406 
i
 = 0; i < 
p
->
Àn
; i++) {

2407 i‡(
p
->
is_wide_ch¨
)

2408 
c
 = 
p
->
u
.
°r16
[
i
];

2410 
c
 = 
p
->
u
.
°r8
[
i
];

2411 i‡(
c
 =
£p
 || c == '\\') {

2412 
	`putch¨
('\\');

2413 
	`putch¨
(
c
);

2414 } i‡(
c
 >= ' ' && c <= 126) {

2415 
	`putch¨
(
c
);

2416 } i‡(
c
 == '\n') {

2417 
	`putch¨
('\\');

2418 
	`putch¨
('n');

2420 
	`¥ötf
("\\u%04x", 
c
);

2423 
	`putch¨
(
£p
);

2424 
	}
}

2426 
__maybe_unu£d
 
	$JS_DumpAtoms
(
JSRu¡ime
 *
π
)

2428 
JSAtomSåu˘
 *
p
;

2429 
h
, 
i
;

2431 
	`¥ötf
("JSAtom count=%d size=%d hash_size=%d:\n",

2432 
π
->
©om_cou¡
,Ñt->
©om_size
,Ñt->
©om_hash_size
);

2433 
	`¥ötf
("JSAtom hashÅable: {\n");

2434 
i
 = 0; i < 
π
->
©om_hash_size
; i++) {

2435 
h
 = 
π
->
©om_hash
[
i
];

2436 i‡(
h
) {

2437 
	`¥ötf
(" %d:", 
i
);

2438 
h
) {

2439 
p
 = 
π
->
©om_¨øy
[
h
];

2440 
	`¥ötf
(" ");

2441 
	`JS_DumpSåög
(
π
, 
p
);

2442 
h
 = 
p
->
hash_√xt
;

2444 
	`¥ötf
("\n");

2447 
	`¥ötf
("}\n");

2448 
	`¥ötf
("JSAtomÅable: {\n");

2449 
i
 = 0; i < 
π
->
©om_size
; i++) {

2450 
p
 = 
π
->
©om_¨øy
[
i
];

2451 i‡(!
	`©om_is_‰ì
(
p
)) {

2452 
	`¥ötf
(" %d: { %d %08x ", 
i
, 
p
->
©om_ty≥
,Ö->
hash
);

2453 i‡(!(
p
->
Àn
 =0 &&Ö->
is_wide_ch¨
 != 0))

2454 
	`JS_DumpSåög
(
π
, 
p
);

2455 
	`¥ötf
(" %d }\n", 
p
->
hash_√xt
);

2458 
	`¥ötf
("}\n");

2459 
	}
}

2461 
	$JS_ResizeAtomHash
(
JSRu¡ime
 *
π
, 
√w_hash_size
)

2463 
JSAtomSåu˘
 *
p
;

2464 
uöt32_t
 
√w_hash_mask
, 
h
, 
i
, 
hash_√xt1
, 
j
, *
√w_hash
;

2466 
	`as£π
((
√w_hash_size
 & (new_hash_size - 1)) == 0);

2467 
√w_hash_mask
 = 
√w_hash_size
 - 1;

2468 
√w_hash
 = 
	`js_mÆlocz_π
(
π
, ‘t->
©om_hash
[0]Ë* 
√w_hash_size
);

2469 i‡(!
√w_hash
)

2471 
i
 = 0; i < 
π
->
©om_hash_size
; i++) {

2472 
h
 = 
π
->
©om_hash
[
i
];

2473 
h
 != 0) {

2474 
p
 = 
π
->
©om_¨øy
[
h
];

2475 
hash_√xt1
 = 
p
->
hash_√xt
;

2477 
j
 = 
p
->
hash
 & 
√w_hash_mask
;

2478 
p
->
hash_√xt
 = 
√w_hash
[
j
];

2479 
√w_hash
[
j
] = 
h
;

2480 
h
 = 
hash_√xt1
;

2483 
	`js_‰ì_π
(
π
,Ñt->
©om_hash
);

2484 
π
->
©om_hash
 = 
√w_hash
;

2485 
π
->
©om_hash_size
 = 
√w_hash_size
;

2486 
π
->
©om_cou¡_ªsize
 = 
	`JS_ATOM_COUNT_RESIZE
(
√w_hash_size
);

2489 
	}
}

2491 
	$JS_InôAtoms
(
JSRu¡ime
 *
π
)

2493 
i
, 
Àn
, 
©om_ty≥
;

2494 c⁄° *
p
;

2496 
π
->
©om_hash_size
 = 0;

2497 
π
->
©om_hash
 = 
NULL
;

2498 
π
->
©om_cou¡
 = 0;

2499 
π
->
©om_size
 = 0;

2500 
π
->
©om_‰ì_ödex
 = 0;

2501 i‡(
	`JS_ResizeAtomHash
(
π
, 256))

2504 
p
 = 
js_©om_öô
;

2505 
i
 = 1; i < 
JS_ATOM_END
; i++) {

2506 i‡(
i
 =
JS_ATOM_Priv©e_bønd
)

2507 
©om_ty≥
 = 
JS_ATOM_TYPE_PRIVATE
;

2508 i‡(
i
 >
JS_ATOM_Symbﬁ_toPrimôive
)

2509 
©om_ty≥
 = 
JS_ATOM_TYPE_SYMBOL
;

2511 
©om_ty≥
 = 
JS_ATOM_TYPE_STRING
;

2512 
Àn
 = 
	`°æí
(
p
);

2513 i‡(
	`__JS_NewAtomInô
(
π
, 
p
, 
Àn
, 
©om_ty≥
Ë=
JS_ATOM_NULL
)

2515 
p
 =Ö + 
Àn
 + 1;

2518 
	}
}

2520 
JSAtom
 
	$JS_DupAtomRT
(
JSRu¡ime
 *
π
, 
JSAtom
 
v
)

2522 
JSAtomSåu˘
 *
p
;

2524 i‡(!
	`__JS_AtomIsC⁄°
(
v
)) {

2525 
p
 = 
π
->
©om_¨øy
[
v
];

2526 
p
->
hódî
.
ªf_cou¡
++;

2528  
v
;

2529 
	}
}

2531 
JSAtom
 
	$JS_DupAtom
(
JSC⁄ãxt
 *
˘x
, 
JSAtom
 
v
)

2533 
JSRu¡ime
 *
π
;

2534 
JSAtomSåu˘
 *
p
;

2536 i‡(!
	`__JS_AtomIsC⁄°
(
v
)) {

2537 
π
 = 
˘x
->rt;

2538 
p
 = 
π
->
©om_¨øy
[
v
];

2539 
p
->
hódî
.
ªf_cou¡
++;

2541  
v
;

2542 
	}
}

2544 
JSAtomKödEnum
 
	$JS_AtomGëKöd
(
JSC⁄ãxt
 *
˘x
, 
JSAtom
 
v
)

2546 
JSRu¡ime
 *
π
;

2547 
JSAtomSåu˘
 *
p
;

2549 
π
 = 
˘x
->rt;

2550 i‡(
	`__JS_AtomIsTaggedI¡
(
v
))

2551  
JS_ATOM_KIND_STRING
;

2552 
p
 = 
π
->
©om_¨øy
[
v
];

2553 
p
->
©om_ty≥
) {

2554 
JS_ATOM_TYPE_STRING
:

2555  
JS_ATOM_KIND_STRING
;

2556 
JS_ATOM_TYPE_GLOBAL_SYMBOL
:

2557  
JS_ATOM_KIND_SYMBOL
;

2558 
JS_ATOM_TYPE_SYMBOL
:

2559 
p
->
hash
) {

2560 
JS_ATOM_HASH_SYMBOL
:

2561  
JS_ATOM_KIND_SYMBOL
;

2562 
JS_ATOM_HASH_PRIVATE
:

2563  
JS_ATOM_KIND_PRIVATE
;

2565 
	`ab‹t
();

2568 
	`ab‹t
();

2570 
	}
}

2572 
BOOL
 
	$JS_AtomIsSåög
(
JSC⁄ãxt
 *
˘x
, 
JSAtom
 
v
)

2574  
	`JS_AtomGëKöd
(
˘x
, 
v
Ë=
JS_ATOM_KIND_STRING
;

2575 
	}
}

2577 
JSAtom
 
	$js_gë_©om_ödex
(
JSRu¡ime
 *
π
, 
JSAtomSåu˘
 *
p
)

2579 
uöt32_t
 
i
 = 
p
->
hash_√xt
;

2580 i‡(
p
->
©om_ty≥
 !
JS_ATOM_TYPE_SYMBOL
) {

2581 
JSAtomSåu˘
 *
p1
;

2583 
i
 = 
π
->
©om_hash
[
p
->
hash
 & (π->
©om_hash_size
 - 1)];

2584 
p1
 = 
π
->
©om_¨øy
[
i
];

2585 
p1
 !
p
) {

2586 
	`as£π
(
i
 != 0);

2587 
i
 = 
p1
->
hash_√xt
;

2588 
p1
 = 
π
->
©om_¨øy
[
i
];

2591  
i
;

2592 
	}
}

2596 
JSAtom
 
	$__JS_NewAtom
(
JSRu¡ime
 *
π
, 
JSSåög
 *
°r
, 
©om_ty≥
)

2598 
uöt32_t
 
h
, 
h1
, 
i
;

2599 
JSAtomSåu˘
 *
p
;

2600 
Àn
;

2603 
	`¥ötf
("__JS_NewAtom: "); 
	`JS_DumpSåög
(
π
, 
°r
);Örintf("\n");

2605 i‡(
©om_ty≥
 < 
JS_ATOM_TYPE_SYMBOL
) {

2607 i‡(
°r
->
©om_ty≥
 ==átom_type) {

2609 
i
 = 
	`js_gë_©om_ödex
(
π
, 
°r
);

2611 i‡(
	`__JS_AtomIsC⁄°
(
i
))

2612 
°r
->
hódî
.
ªf_cou¡
--;

2613  
i
;

2616 
Àn
 = 
°r
->len;

2617 
h
 = 
	`hash_°rög
(
°r
, 
©om_ty≥
);

2618 
h
 &
JS_ATOM_HASH_MASK
;

2619 
h1
 = 
h
 & (
π
->
©om_hash_size
 - 1);

2620 
i
 = 
π
->
©om_hash
[
h1
];

2621 
i
 != 0) {

2622 
p
 = 
π
->
©om_¨øy
[
i
];

2623 i‡(
p
->
hash
 =
h
 &&

2624 
p
->
©om_ty≥
 ==átom_type &&

2625 
p
->
Àn
 ==Üen &&

2626 
	`js_°rög_memcmp
(
p
, 
°r
, 
Àn
) == 0) {

2627 i‡(!
	`__JS_AtomIsC⁄°
(
i
))

2628 
p
->
hódî
.
ªf_cou¡
++;

2629 
d⁄e
;

2631 
i
 = 
p
->
hash_√xt
;

2634 
h1
 = 0;

2635 i‡(
©om_ty≥
 =
JS_ATOM_TYPE_SYMBOL
) {

2636 
h
 = 
JS_ATOM_HASH_SYMBOL
;

2638 
h
 = 
JS_ATOM_HASH_PRIVATE
;

2639 
©om_ty≥
 = 
JS_ATOM_TYPE_SYMBOL
;

2643 i‡(
π
->
©om_‰ì_ödex
 == 0) {

2645 
uöt32_t
 
√w_size
, 
°¨t
;

2646 
JSAtomSåu˘
 **
√w_¨øy
;

2652 
√w_size
 = 
	`max_öt
(211, 
π
->
©om_size
 * 3 / 2);

2653 i‡(
√w_size
 > 
JS_ATOM_MAX
)

2654 
Áû
;

2656 
√w_¨øy
 = 
	`js_ªÆloc_π
(
π
,Ñt->
©om_¨øy
, (*√w_¨øyË* 
√w_size
);

2657 i‡(!
√w_¨øy
)

2658 
Áû
;

2660 
°¨t
 = 
π
->
©om_size
;

2661 i‡(
°¨t
 == 0) {

2663 
p
 = 
	`js_mÆlocz_π
(
π
, (
JSAtomSåu˘
));

2664 i‡(!
p
) {

2665 
	`js_‰ì_π
(
π
, 
√w_¨øy
);

2666 
Áû
;

2668 
p
->
hódî
.
ªf_cou¡
 = 1;

2669 
p
->
©om_ty≥
 = 
JS_ATOM_TYPE_SYMBOL
;

2670 #ifde‡
DUMP_LEAKS


2671 
	`li°_add_èû
(&
p
->
lök
, &
π
->
°rög_li°
);

2673 
√w_¨øy
[0] = 
p
;

2674 
π
->
©om_cou¡
++;

2675 
°¨t
 = 1;

2677 
π
->
©om_size
 = 
√w_size
;

2678 
π
->
©om_¨øy
 = 
√w_¨øy
;

2679 
π
->
©om_‰ì_ödex
 = 
°¨t
;

2680 
i
 = 
°¨t
; i < 
√w_size
; i++) {

2681 
uöt32_t
 
√xt
;

2682 i‡(
i
 =(
√w_size
 - 1))

2683 
√xt
 = 0;

2685 
√xt
 = 
i
 + 1;

2686 
π
->
©om_¨øy
[
i
] = 
	`©om_£t_‰ì
(
√xt
);

2690 i‡(
°r
) {

2691 i‡(
°r
->
©om_ty≥
 == 0) {

2692 
p
 = 
°r
;

2693 
p
->
©om_ty≥
 =átom_type;

2695 
p
 = 
	`js_mÆloc_π
(
π
, (
JSSåög
) +

2696 (
°r
->
Àn
 << så->
is_wide_ch¨
) +

2697 1 - 
°r
->
is_wide_ch¨
);

2698 i‡(
	`u∆ikñy
(!
p
))

2699 
Áû
;

2700 
p
->
hódî
.
ªf_cou¡
 = 1;

2701 
p
->
is_wide_ch¨
 = 
°r
->is_wide_char;

2702 
p
->
Àn
 = 
°r
->len;

2703 #ifde‡
DUMP_LEAKS


2704 
	`li°_add_èû
(&
p
->
lök
, &
π
->
°rög_li°
);

2706 
	`mem˝y
(
p
->
u
.
°r8
, 
°r
->u.°r8, (°r->
Àn
 << så->
is_wide_ch¨
) +

2707 1 - 
°r
->
is_wide_ch¨
);

2708 
	`js_‰ì_°rög
(
π
, 
°r
);

2711 
p
 = 
	`js_mÆloc_π
(
π
, (
JSAtomSåu˘
));

2712 i‡(!
p
)

2713  
JS_ATOM_NULL
;

2714 
p
->
hódî
.
ªf_cou¡
 = 1;

2715 
p
->
is_wide_ch¨
 = 1;

2716 
p
->
Àn
 = 0;

2717 #ifde‡
DUMP_LEAKS


2718 
	`li°_add_èû
(&
p
->
lök
, &
π
->
°rög_li°
);

2723 
i
 = 
π
->
©om_‰ì_ödex
;

2724 
π
->
©om_‰ì_ödex
 = 
	`©om_gë_‰ì
‘t->
©om_¨øy
[
i
]);

2725 
π
->
©om_¨øy
[
i
] = 
p
;

2727 
p
->
hash
 = 
h
;

2728 
p
->
hash_√xt
 = 
i
;

2729 
p
->
©om_ty≥
 =átom_type;

2731 
π
->
©om_cou¡
++;

2733 i‡(
©om_ty≥
 !
JS_ATOM_TYPE_SYMBOL
) {

2734 
p
->
hash_√xt
 = 
π
->
©om_hash
[
h1
];

2735 
π
->
©om_hash
[
h1
] = 
i
;

2736 i‡(
	`u∆ikñy
(
π
->
©om_cou¡
 >π->
©om_cou¡_ªsize
))

2737 
	`JS_ResizeAtomHash
(
π
,Ñt->
©om_hash_size
 * 2);

2741  
i
;

2743 
Áû
:

2744 
i
 = 
JS_ATOM_NULL
;

2745 
d⁄e
:

2746 i‡(
°r
)

2747 
	`js_‰ì_°rög
(
π
, 
°r
);

2748  
i
;

2749 
	}
}

2752 
JSAtom
 
	$__JS_NewAtomInô
(
JSRu¡ime
 *
π
, c⁄° *
°r
, 
Àn
,

2753 
©om_ty≥
)

2755 
JSSåög
 *
p
;

2756 
p
 = 
	`js_Æloc_°rög_π
(
π
, 
Àn
, 0);

2757 i‡(!
p
)

2758  
JS_ATOM_NULL
;

2759 
	`mem˝y
(
p
->
u
.
°r8
, 
°r
, 
Àn
);

2760 
p
->
u
.
°r8
[
Àn
] = '\0';

2761  
	`__JS_NewAtom
(
π
, 
p
, 
©om_ty≥
);

2762 
	}
}

2764 
JSAtom
 
	$__JS_FödAtom
(
JSRu¡ime
 *
π
, c⁄° *
°r
, 
size_t
 
Àn
,

2765 
©om_ty≥
)

2767 
uöt32_t
 
h
, 
h1
, 
i
;

2768 
JSAtomSåu˘
 *
p
;

2770 
h
 = 
	`hash_°rög8
((c⁄° 
uöt8_t
 *)
°r
, 
Àn
, 
JS_ATOM_TYPE_STRING
);

2771 
h
 &
JS_ATOM_HASH_MASK
;

2772 
h1
 = 
h
 & (
π
->
©om_hash_size
 - 1);

2773 
i
 = 
π
->
©om_hash
[
h1
];

2774 
i
 != 0) {

2775 
p
 = 
π
->
©om_¨øy
[
i
];

2776 i‡(
p
->
hash
 =
h
 &&

2777 
p
->
©om_ty≥
 =
JS_ATOM_TYPE_STRING
 &&

2778 
p
->
Àn
 ==Üen &&

2779 
p
->
is_wide_ch¨
 == 0 &&

2780 
	`memcmp
(
p
->
u
.
°r8
, 
°r
, 
Àn
) == 0) {

2781 i‡(!
	`__JS_AtomIsC⁄°
(
i
))

2782 
p
->
hódî
.
ªf_cou¡
++;

2783  
i
;

2785 
i
 = 
p
->
hash_√xt
;

2787  
JS_ATOM_NULL
;

2788 
	}
}

2790 
	$JS_FªeAtomSåu˘
(
JSRu¡ime
 *
π
, 
JSAtomSåu˘
 *
p
)

2793 i‡(
	`u∆ikñy
(
i
 =
JS_ATOM_NULL
)) {

2794 
p
->
hódî
.
ªf_cou¡
 = 
INT32_MAX
 / 2;

2798 
uöt32_t
 
i
 = 
p
->
hash_√xt
;

2799 i‡(
p
->
©om_ty≥
 !
JS_ATOM_TYPE_SYMBOL
) {

2800 
JSAtomSåu˘
 *
p0
, *
p1
;

2801 
uöt32_t
 
h0
;

2803 
h0
 = 
p
->
hash
 & (
π
->
©om_hash_size
 - 1);

2804 
i
 = 
π
->
©om_hash
[
h0
];

2805 
p1
 = 
π
->
©om_¨øy
[
i
];

2806 i‡(
p1
 =
p
) {

2807 
π
->
©om_hash
[
h0
] = 
p1
->
hash_√xt
;

2810 
	`as£π
(
i
 != 0);

2811 
p0
 = 
p1
;

2812 
i
 = 
p1
->
hash_√xt
;

2813 
p1
 = 
π
->
©om_¨øy
[
i
];

2814 i‡(
p1
 =
p
) {

2815 
p0
->
hash_√xt
 = 
p1
->hash_next;

2822 
π
->
©om_¨øy
[
i
] = 
	`©om_£t_‰ì
‘t->
©om_‰ì_ödex
);

2823 
π
->
©om_‰ì_ödex
 = 
i
;

2825 #ifde‡
DUMP_LEAKS


2826 
	`li°_dñ
(&
p
->
lök
);

2828 
	`js_‰ì_π
(
π
, 
p
);

2829 
π
->
©om_cou¡
--;

2830 
	`as£π
(
π
->
©om_cou¡
 >= 0);

2831 
	}
}

2833 
	$__JS_FªeAtom
(
JSRu¡ime
 *
π
, 
uöt32_t
 
i
)

2835 
JSAtomSåu˘
 *
p
;

2837 
p
 = 
π
->
©om_¨øy
[
i
];

2838 i‡(--
p
->
hódî
.
ªf_cou¡
 > 0)

2840 
	`JS_FªeAtomSåu˘
(
π
, 
p
);

2841 
	}
}

2844 
JSAtom
 
	$JS_NewAtomSå
(
JSC⁄ãxt
 *
˘x
, 
JSSåög
 *
p
)

2846 
JSRu¡ime
 *
π
 = 
˘x
->rt;

2847 
uöt32_t
 
n
;

2848 i‡(
	`is_num_°rög
(&
n
, 
p
)) {

2849 i‡(
n
 <
JS_ATOM_MAX_INT
) {

2850 
	`js_‰ì_°rög
(
π
, 
p
);

2851  
	`__JS_AtomFromUI¡32
(
n
);

2855  
	`__JS_NewAtom
(
π
, 
p
, 
JS_ATOM_TYPE_STRING
);

2856 
	}
}

2858 
JSAtom
 
	$JS_NewAtomLí
(
JSC⁄ãxt
 *
˘x
, c⁄° *
°r
, 
size_t
 
Àn
)

2860 
JSVÆue
 
vÆ
;

2862 i‡(
Àn
 =0 || !
	`is_digô
(*
°r
)) {

2863 
JSAtom
 
©om
 = 
	`__JS_FödAtom
(
˘x
->
π
, 
°r
, 
Àn
, 
JS_ATOM_TYPE_STRING
);

2864 i‡(
©om
)

2865  
©om
;

2867 
vÆ
 = 
	`JS_NewSåögLí
(
˘x
, 
°r
, 
Àn
);

2868 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

2869  
JS_ATOM_NULL
;

2870  
	`JS_NewAtomSå
(
˘x
, 
	`JS_VALUE_GET_STRING
(
vÆ
));

2871 
	}
}

2873 
JSAtom
 
	$JS_NewAtom
(
JSC⁄ãxt
 *
˘x
, c⁄° *
°r
)

2875  
	`JS_NewAtomLí
(
˘x
, 
°r
, 
	`°æí
(str));

2876 
	}
}

2878 
JSAtom
 
	$JS_NewAtomUI¡32
(
JSC⁄ãxt
 *
˘x
, 
uöt32_t
 
n
)

2880 i‡(
n
 <
JS_ATOM_MAX_INT
) {

2881  
	`__JS_AtomFromUI¡32
(
n
);

2883 
buf
[11];

2884 
JSVÆue
 
vÆ
;

2885 
	`¢¥ötf
(
buf
, (buf), "%u", 
n
);

2886 
vÆ
 = 
	`JS_NewSåög
(
˘x
, 
buf
);

2887 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

2888  
JS_ATOM_NULL
;

2889  
	`__JS_NewAtom
(
˘x
->
π
, 
	`JS_VALUE_GET_STRING
(
vÆ
),

2890 
JS_ATOM_TYPE_STRING
);

2892 
	}
}

2894 
JSAtom
 
	$JS_NewAtomI¡64
(
JSC⁄ãxt
 *
˘x
, 
öt64_t
 
n
)

2896 i‡((
uöt64_t
)
n
 <
JS_ATOM_MAX_INT
) {

2897  
	`__JS_AtomFromUI¡32
((
uöt32_t
)
n
);

2899 
buf
[24];

2900 
JSVÆue
 
vÆ
;

2901 
	`¢¥ötf
(
buf
, (buf), "%" 
PRId64
 , 
n
);

2902 
vÆ
 = 
	`JS_NewSåög
(
˘x
, 
buf
);

2903 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

2904  
JS_ATOM_NULL
;

2905  
	`__JS_NewAtom
(
˘x
->
π
, 
	`JS_VALUE_GET_STRING
(
vÆ
),

2906 
JS_ATOM_TYPE_STRING
);

2908 
	}
}

2911 
JSVÆue
 
	$JS_NewSymbﬁ
(
JSC⁄ãxt
 *
˘x
, 
JSSåög
 *
p
, 
©om_ty≥
)

2913 
JSRu¡ime
 *
π
 = 
˘x
->rt;

2914 
JSAtom
 
©om
;

2915 
©om
 = 
	`__JS_NewAtom
(
π
, 
p
, 
©om_ty≥
);

2916 i‡(
©om
 =
JS_ATOM_NULL
)

2917  
	`JS_ThrowOutOfMem‹y
(
˘x
);

2918  
	`JS_MKPTR
(
JS_TAG_SYMBOL
, 
π
->
©om_¨øy
[
©om
]);

2919 
	}
}

2922 
JSVÆue
 
	$JS_NewSymbﬁFromAtom
(
JSC⁄ãxt
 *
˘x
, 
JSAtom
 
des¸
,

2923 
©om_ty≥
)

2925 
JSRu¡ime
 *
π
 = 
˘x
->rt;

2926 
JSSåög
 *
p
;

2928 
	`as£π
(!
	`__JS_AtomIsTaggedI¡
(
des¸
));

2929 
	`as£π
(
des¸
 < 
π
->
©om_size
);

2930 
p
 = 
π
->
©om_¨øy
[
des¸
];

2931 
	`JS_DupVÆue
(
˘x
, 
	`JS_MKPTR
(
JS_TAG_STRING
, 
p
));

2932  
	`JS_NewSymbﬁ
(
˘x
, 
p
, 
©om_ty≥
);

2933 
	}
}

2935 
	#ATOM_GET_STR_BUF_SIZE
 64

	)

2938 c⁄° *
	$JS_AtomGëSåRT
(
JSRu¡ime
 *
π
, *
buf
, 
buf_size
,

2939 
JSAtom
 
©om
)

2941 i‡(
	`__JS_AtomIsTaggedI¡
(
©om
)) {

2942 
	`¢¥ötf
(
buf
, 
buf_size
, "%u", 
	`__JS_AtomToUI¡32
(
©om
));

2944 
JSAtomSåu˘
 *
p
;

2945 
	`as£π
(
©om
 < 
π
->
©om_size
);

2946 i‡(
©om
 =
JS_ATOM_NULL
) {

2947 
	`¢¥ötf
(
buf
, 
buf_size
, "<null>");

2949 
i
, 
c
;

2950 *
q
;

2951 
JSSåög
 *
°r
;

2953 
q
 = 
buf
;

2954 
p
 = 
π
->
©om_¨øy
[
©om
];

2955 
	`as£π
(!
	`©om_is_‰ì
(
p
));

2956 
°r
 = 
p
;

2957 i‡(
°r
) {

2958 i‡(!
°r
->
is_wide_ch¨
) {

2960 
c
 = 0;

2961 
i
 = 0; i < 
°r
->
Àn
; i++) {

2962 
c
 |
°r
->
u
.
°r8
[
i
];

2964 i‡(
c
 < 0x80)

2965  (c⁄° *)
°r
->
u
.
°r8
;

2967 
i
 = 0; i < 
°r
->
Àn
; i++) {

2968 i‡(
°r
->
is_wide_ch¨
)

2969 
c
 = 
°r
->
u
.
°r16
[
i
];

2971 
c
 = 
°r
->
u
.
°r8
[
i
];

2972 i‡((
q
 - 
buf
Ë>
buf_size
 - 
UTF8_CHAR_LEN_MAX
)

2974 i‡(
c
 < 128) {

2975 *
q
++ = 
c
;

2977 
q
 +
	`unicode_to_utf8
((
uöt8_t
 *)q, 
c
);

2981 *
q
 = '\0';

2984  
buf
;

2985 
	}
}

2987 c⁄° *
	$JS_AtomGëSå
(
JSC⁄ãxt
 *
˘x
, *
buf
, 
buf_size
, 
JSAtom
 
©om
)

2989  
	`JS_AtomGëSåRT
(
˘x
->
π
, 
buf
, 
buf_size
, 
©om
);

2990 
	}
}

2992 
JSVÆue
 
	$__JS_AtomToVÆue
(
JSC⁄ãxt
 *
˘x
, 
JSAtom
 
©om
, 
BOOL
 
f‹˚_°rög
)

2994 
buf
[
ATOM_GET_STR_BUF_SIZE
];

2996 i‡(
	`__JS_AtomIsTaggedI¡
(
©om
)) {

2997 
	`¢¥ötf
(
buf
, (buf), "%u", 
	`__JS_AtomToUI¡32
(
©om
));

2998  
	`JS_NewSåög
(
˘x
, 
buf
);

3000 
JSRu¡ime
 *
π
 = 
˘x
->rt;

3001 
JSAtomSåu˘
 *
p
;

3002 
	`as£π
(
©om
 < 
π
->
©om_size
);

3003 
p
 = 
π
->
©om_¨øy
[
©om
];

3004 i‡(
p
->
©om_ty≥
 =
JS_ATOM_TYPE_STRING
) {

3005 
ªt_°rög
;

3006 } i‡(
f‹˚_°rög
) {

3007 i‡(
p
->
Àn
 =0 &&Ö->
is_wide_ch¨
 != 0) {

3009 
p
 = 
π
->
©om_¨øy
[
JS_ATOM_em±y_°rög
];

3011 
ªt_°rög
:

3012  
	`JS_DupVÆue
(
˘x
, 
	`JS_MKPTR
(
JS_TAG_STRING
, 
p
));

3014  
	`JS_DupVÆue
(
˘x
, 
	`JS_MKPTR
(
JS_TAG_SYMBOL
, 
p
));

3017 
	}
}

3019 
JSVÆue
 
	$JS_AtomToVÆue
(
JSC⁄ãxt
 *
˘x
, 
JSAtom
 
©om
)

3021  
	`__JS_AtomToVÆue
(
˘x
, 
©om
, 
FALSE
);

3022 
	}
}

3024 
JSVÆue
 
	$JS_AtomToSåög
(
JSC⁄ãxt
 *
˘x
, 
JSAtom
 
©om
)

3026  
	`__JS_AtomToVÆue
(
˘x
, 
©om
, 
TRUE
);

3027 
	}
}

3031 
BOOL
 
	$JS_AtomIsAºayIndex
(
JSC⁄ãxt
 *
˘x
, 
uöt32_t
 *
pvÆ
, 
JSAtom
 
©om
)

3033 i‡(
	`__JS_AtomIsTaggedI¡
(
©om
)) {

3034 *
pvÆ
 = 
	`__JS_AtomToUI¡32
(
©om
);

3035  
TRUE
;

3037 
JSRu¡ime
 *
π
 = 
˘x
->rt;

3038 
JSAtomSåu˘
 *
p
;

3039 
uöt32_t
 
vÆ
;

3041 
	`as£π
(
©om
 < 
π
->
©om_size
);

3042 
p
 = 
π
->
©om_¨øy
[
©om
];

3043 i‡(
p
->
©om_ty≥
 =
JS_ATOM_TYPE_STRING
 &&

3044 
	`is_num_°rög
(&
vÆ
, 
p
) && val != -1) {

3045 *
pvÆ
 = 
vÆ
;

3046  
TRUE
;

3048 *
pvÆ
 = 0;

3049  
FALSE
;

3052 
	}
}

3057 
JSVÆue
 
	$JS_AtomIsNumîicIndex1
(
JSC⁄ãxt
 *
˘x
, 
JSAtom
 
©om
)

3059 
JSRu¡ime
 *
π
 = 
˘x
->rt;

3060 
JSAtomSåu˘
 *
p1
;

3061 
JSSåög
 *
p
;

3062 
c
, 
Àn
, 
ªt
;

3063 
JSVÆue
 
num
, 
°r
;

3065 i‡(
	`__JS_AtomIsTaggedI¡
(
©om
))

3066  
	`JS_NewI¡32
(
˘x
, 
	`__JS_AtomToUI¡32
(
©om
));

3067 
	`as£π
(
©om
 < 
π
->
©om_size
);

3068 
p1
 = 
π
->
©om_¨øy
[
©om
];

3069 i‡(
p1
->
©om_ty≥
 !
JS_ATOM_TYPE_STRING
)

3070  
JS_UNDEFINED
;

3071 
p
 = 
p1
;

3072 
Àn
 = 
p
->len;

3073 i‡(
p
->
is_wide_ch¨
) {

3074 c⁄° 
uöt16_t
 *
r
 = 
p
->
u
.
°r16
, *
r_íd
 =Ö->u.°r16 + 
Àn
;

3075 i‡(
r
 >
r_íd
)

3076  
JS_UNDEFINED
;

3077 
c
 = *
r
;

3078 i‡(
c
 == '-') {

3079 i‡(
r
 >
r_íd
)

3080  
JS_UNDEFINED
;

3081 
r
++;

3082 
c
 = *
r
;

3084 i‡(
c
 ='0' && 
Àn
 == 2)

3085 
möus_zîo
;

3088 i‡(!
	`is_num
(
c
)) {

3090 c⁄° 
uöt16_t
 
nföôy16
[7] = { 'n', 'f', 'i', 'n', 'i', 't', 'y' };

3091 i‡(!(
c
 =='I' && (
r_íd
 - 
r
) == 8 &&

3092 !
	`memcmp
(
r
 + 1, 
nföôy16
, (nfinity16))))

3093  
JS_UNDEFINED
;

3096 c⁄° 
uöt8_t
 *
r
 = 
p
->
u
.
°r8
, *
r_íd
 =Ö->u.°r8 + 
Àn
;

3097 i‡(
r
 >
r_íd
)

3098  
JS_UNDEFINED
;

3099 
c
 = *
r
;

3100 i‡(
c
 == '-') {

3101 i‡(
r
 >
r_íd
)

3102  
JS_UNDEFINED
;

3103 
r
++;

3104 
c
 = *
r
;

3106 i‡(
c
 ='0' && 
Àn
 == 2) {

3107 
möus_zîo
:

3108  
	`__JS_NewFlﬂt64
(
˘x
, -0.0);

3111 i‡(!
	`is_num
(
c
)) {

3112 i‡(!(
c
 =='I' && (
r_íd
 - 
r
) == 8 &&

3113 !
	`memcmp
(
r
 + 1, "nfinity", 7)))

3114  
JS_UNDEFINED
;

3120 
num
 = 
	`JS_ToNumbî
(
˘x
, 
	`JS_MKPTR
(
JS_TAG_STRING
, 
p
));

3121 i‡(
	`JS_IsEx˚±i⁄
(
num
))

3122  
num
;

3123 
°r
 = 
	`JS_ToSåög
(
˘x
, 
num
);

3124 i‡(
	`JS_IsEx˚±i⁄
(
°r
)) {

3125 
	`JS_FªeVÆue
(
˘x
, 
num
);

3126  
°r
;

3128 
ªt
 = 
	`js_°rög_com∑ª
(
˘x
, 
p
, 
	`JS_VALUE_GET_STRING
(
°r
));

3129 
	`JS_FªeVÆue
(
˘x
, 
°r
);

3130 i‡(
ªt
 == 0) {

3131  
num
;

3133 
	`JS_FªeVÆue
(
˘x
, 
num
);

3134  
JS_UNDEFINED
;

3136 
	}
}

3139 
	$JS_AtomIsNumîicIndex
(
JSC⁄ãxt
 *
˘x
, 
JSAtom
 
©om
)

3141 
JSVÆue
 
num
;

3142 
num
 = 
	`JS_AtomIsNumîicIndex1
(
˘x
, 
©om
);

3143 i‡(
	`likñy
(
	`JS_IsUndeföed
(
num
)))

3144  
FALSE
;

3145 i‡(
	`JS_IsEx˚±i⁄
(
num
))

3147 
	`JS_FªeVÆue
(
˘x
, 
num
);

3148  
TRUE
;

3149 
	}
}

3151 
	$JS_FªeAtom
(
JSC⁄ãxt
 *
˘x
, 
JSAtom
 
v
)

3153 i‡(!
	`__JS_AtomIsC⁄°
(
v
))

3154 
	`__JS_FªeAtom
(
˘x
->
π
, 
v
);

3155 
	}
}

3157 
	$JS_FªeAtomRT
(
JSRu¡ime
 *
π
, 
JSAtom
 
v
)

3159 i‡(!
	`__JS_AtomIsC⁄°
(
v
))

3160 
	`__JS_FªeAtom
(
π
, 
v
);

3161 
	}
}

3164 
BOOL
 
	$JS_AtomSymbﬁHasDes¸ùti⁄
(
JSC⁄ãxt
 *
˘x
, 
JSAtom
 
v
)

3166 
JSRu¡ime
 *
π
;

3167 
JSAtomSåu˘
 *
p
;

3169 
π
 = 
˘x
->rt;

3170 i‡(
	`__JS_AtomIsTaggedI¡
(
v
))

3171  
FALSE
;

3172 
p
 = 
π
->
©om_¨øy
[
v
];

3173  (((
p
->
©om_ty≥
 =
JS_ATOM_TYPE_SYMBOL
 &&

3174 
p
->
hash
 =
JS_ATOM_HASH_SYMBOL
) ||

3175 
p
->
©om_ty≥
 =
JS_ATOM_TYPE_GLOBAL_SYMBOL
) &&

3176 !(
p
->
Àn
 =0 &&Ö->
is_wide_ch¨
 != 0));

3177 
	}
}

3179 
__maybe_unu£d
 
	$¥öt_©om
(
JSC⁄ãxt
 *
˘x
, 
JSAtom
 
©om
)

3181 
buf
[
ATOM_GET_STR_BUF_SIZE
];

3182 c⁄° *
p
;

3183 
i
;

3187 
p
 = 
	`JS_AtomGëSå
(
˘x
, 
buf
, (buf), 
©om
);

3188 
i
 = 0; 
p
[i]; i++) {

3189 
c
 = ()
p
[
i
];

3190 i‡(!((
c
 >= 'a' && c <= 'z') || (c >= 'A' && c <= 'Z') ||

3191 (
c
 ='_' || c ='$'Ë|| (¯>'0' && c <'9' && 
i
 > 0)))

3194 i‡(
i
 > 0 && 
p
[i] == '\0') {

3195 
	`¥ötf
("%s", 
p
);

3197 
	`putch¨
('"');

3198 
	`¥ötf
("%.*s", 
i
, 
p
);

3199 ; 
p
[
i
]; i++) {

3200 
c
 = ()
p
[
i
];

3201 i‡(
c
 == '\"' || c == '\\') {

3202 
	`putch¨
('\\');

3203 
	`putch¨
(
c
);

3204 } i‡(
c
 >= ' ' && c <= 126) {

3205 
	`putch¨
(
c
);

3206 } i‡(
c
 == '\n') {

3207 
	`putch¨
('\\');

3208 
	`putch¨
('n');

3210 
	`¥ötf
("\\u%04x", 
c
);

3213 
	`putch¨
('\"');

3215 
	}
}

3218 c⁄° *
	$JS_AtomToCSåög
(
JSC⁄ãxt
 *
˘x
, 
JSAtom
 
©om
)

3220 
JSVÆue
 
°r
;

3221 c⁄° *
c°r
;

3223 
°r
 = 
	`JS_AtomToSåög
(
˘x
, 
©om
);

3224 i‡(
	`JS_IsEx˚±i⁄
(
°r
))

3225  
NULL
;

3226 
c°r
 = 
	`JS_ToCSåög
(
˘x
, 
°r
);

3227 
	`JS_FªeVÆue
(
˘x
, 
°r
);

3228  
c°r
;

3229 
	}
}

3232 
JSAtom
 
	$js_©om_c⁄ˇt_°r
(
JSC⁄ãxt
 *
˘x
, 
JSAtom
 
«me
, c⁄° *
°r1
)

3234 
JSVÆue
 
°r
;

3235 
JSAtom
 
©om
;

3236 c⁄° *
c°r
;

3237 *
c°r2
;

3238 
size_t
 
Àn
, 
Àn1
;

3240 
°r
 = 
	`JS_AtomToSåög
(
˘x
, 
«me
);

3241 i‡(
	`JS_IsEx˚±i⁄
(
°r
))

3242  
JS_ATOM_NULL
;

3243 
c°r
 = 
	`JS_ToCSåögLí
(
˘x
, &
Àn
, 
°r
);

3244 i‡(!
c°r
)

3245 
Áû
;

3246 
Àn1
 = 
	`°æí
(
°r1
);

3247 
c°r2
 = 
	`js_mÆloc
(
˘x
, 
Àn
 + 
Àn1
 + 1);

3248 i‡(!
c°r2
)

3249 
Áû
;

3250 
	`mem˝y
(
c°r2
, 
c°r
, 
Àn
);

3251 
	`mem˝y
(
c°r2
 + 
Àn
, 
°r1
, 
Àn1
);

3252 
c°r2
[
Àn
 + 
Àn1
] = '\0';

3253 
©om
 = 
	`JS_NewAtomLí
(
˘x
, 
c°r2
, 
Àn
 + 
Àn1
);

3254 
	`js_‰ì
(
˘x
, 
c°r2
);

3255 
	`JS_FªeCSåög
(
˘x
, 
c°r
);

3256 
	`JS_FªeVÆue
(
˘x
, 
°r
);

3257  
©om
;

3258 
Áû
:

3259 
	`JS_FªeCSåög
(
˘x
, 
c°r
);

3260 
	`JS_FªeVÆue
(
˘x
, 
°r
);

3261  
JS_ATOM_NULL
;

3262 
	}
}

3264 
JSAtom
 
	$js_©om_c⁄ˇt_num
(
JSC⁄ãxt
 *
˘x
, 
JSAtom
 
«me
, 
uöt32_t
 
n
)

3266 
buf
[16];

3267 
	`¢¥ötf
(
buf
, (buf), "%u", 
n
);

3268  
	`js_©om_c⁄ˇt_°r
(
˘x
, 
«me
, 
buf
);

3269 
	}
}

3271 
ölöe
 
BOOL
 
	$JS_IsEm±ySåög
(
JSVÆueC⁄°
 
v
)

3273  
	`JS_VALUE_GET_TAG
(
v
Ë=
JS_TAG_STRING
 && 
	`JS_VALUE_GET_STRING
(v)->
Àn
 == 0;

3274 
	}
}

3279 
JSCœssID
 
	$JS_NewCœssID
(
JSCœssID
 *
p˛ass_id
)

3281 
JSCœssID
 
˛ass_id
;

3283 
˛ass_id
 = *
p˛ass_id
;

3284 i‡(
˛ass_id
 == 0) {

3285 
˛ass_id
 = 
js_˛ass_id_Æloc
++;

3286 *
p˛ass_id
 = 
˛ass_id
;

3288  
˛ass_id
;

3289 
	}
}

3291 
BOOL
 
	$JS_IsRegi°îedCœss
(
JSRu¡ime
 *
π
, 
JSCœssID
 
˛ass_id
)

3293  (
˛ass_id
 < 
π
->
˛ass_cou¡
 &&

3294 
π
->
˛ass_¨øy
[
˛ass_id
].class_id != 0);

3295 
	}
}

3299 
	$JS_NewCœss1
(
JSRu¡ime
 *
π
, 
JSCœssID
 
˛ass_id
,

3300 c⁄° 
JSCœssDef
 *
˛ass_def
, 
JSAtom
 
«me
)

3302 
√w_size
, 
i
;

3303 
JSCœss
 *
˛
, *
√w_˛ass_¨øy
;

3304 
li°_hód
 *
ñ
;

3306 i‡(
˛ass_id
 < 
π
->
˛ass_cou¡
 &&

3307 
π
->
˛ass_¨øy
[
˛ass_id
].class_id != 0)

3310 i‡(
˛ass_id
 >
π
->
˛ass_cou¡
) {

3311 
√w_size
 = 
	`max_öt
(
JS_CLASS_INIT_COUNT
,

3312 
	`max_öt
(
˛ass_id
 + 1, 
π
->
˛ass_cou¡
 * 3 / 2));

3315 
	`li°_f‹_óch
(
ñ
, &
π
->
c⁄ãxt_li°
) {

3316 
JSC⁄ãxt
 *
˘x
 = 
	`li°_íåy
(
ñ
, JSC⁄ãxt, 
lök
);

3317 
JSVÆue
 *
√w_èb
;

3318 
√w_èb
 = 
	`js_ªÆloc_π
(
π
, 
˘x
->
˛ass_¥Ÿo
,

3319 (
˘x
->
˛ass_¥Ÿo
[0]Ë* 
√w_size
);

3320 i‡(!
√w_èb
)

3322 
i
 = 
π
->
˛ass_cou¡
; i < 
√w_size
; i++)

3323 
√w_èb
[
i
] = 
JS_NULL
;

3324 
˘x
->
˛ass_¥Ÿo
 = 
√w_èb
;

3327 
√w_˛ass_¨øy
 = 
	`js_ªÆloc_π
(
π
,Ñt->
˛ass_¨øy
,

3328 (
JSCœss
Ë* 
√w_size
);

3329 i‡(!
√w_˛ass_¨øy
)

3331 
	`mem£t
(
√w_˛ass_¨øy
 + 
π
->
˛ass_cou¡
, 0,

3332 (
√w_size
 - 
π
->
˛ass_cou¡
Ë* (
JSCœss
));

3333 
π
->
˛ass_¨øy
 = 
√w_˛ass_¨øy
;

3334 
π
->
˛ass_cou¡
 = 
√w_size
;

3336 
˛
 = &
π
->
˛ass_¨øy
[
˛ass_id
];

3337 
˛
->
˛ass_id
 = class_id;

3338 
˛
->
˛ass_«me
 = 
	`JS_DupAtomRT
(
π
, 
«me
);

3339 
˛
->
föÆizî
 = 
˛ass_def
->finalizer;

3340 
˛
->
gc_m¨k
 = 
˛ass_def
->gc_mark;

3341 
˛
->
ˇŒ
 = 
˛ass_def
->call;

3342 
˛
->
exŸic
 = 
˛ass_def
->exotic;

3344 
	}
}

3346 
	$JS_NewCœss
(
JSRu¡ime
 *
π
, 
JSCœssID
 
˛ass_id
, c⁄° 
JSCœssDef
 *
˛ass_def
)

3348 
ªt
, 
Àn
;

3349 
JSAtom
 
«me
;

3351 
Àn
 = 
	`°æí
(
˛ass_def
->
˛ass_«me
);

3352 
«me
 = 
	`__JS_FödAtom
(
π
, 
˛ass_def
->
˛ass_«me
, 
Àn
, 
JS_ATOM_TYPE_STRING
);

3353 i‡(
«me
 =
JS_ATOM_NULL
) {

3354 
«me
 = 
	`__JS_NewAtomInô
(
π
, 
˛ass_def
->
˛ass_«me
, 
Àn
, 
JS_ATOM_TYPE_STRING
);

3355 i‡(
«me
 =
JS_ATOM_NULL
)

3358 
ªt
 = 
	`JS_NewCœss1
(
π
, 
˛ass_id
, 
˛ass_def
, 
«me
);

3359 
	`JS_FªeAtomRT
(
π
, 
«me
);

3360  
ªt
;

3361 
	}
}

3363 
JSVÆue
 
	$js_√w_°rög8
(
JSC⁄ãxt
 *
˘x
, c⁄° 
uöt8_t
 *
buf
, 
Àn
)

3365 
JSSåög
 *
°r
;

3367 i‡(
Àn
 <= 0) {

3368  
	`JS_AtomToSåög
(
˘x
, 
JS_ATOM_em±y_°rög
);

3370 
°r
 = 
	`js_Æloc_°rög
(
˘x
, 
Àn
, 0);

3371 i‡(!
°r
)

3372  
JS_EXCEPTION
;

3373 
	`mem˝y
(
°r
->
u
.
°r8
, 
buf
, 
Àn
);

3374 
°r
->
u
.
°r8
[
Àn
] = '\0';

3375  
	`JS_MKPTR
(
JS_TAG_STRING
, 
°r
);

3376 
	}
}

3378 
JSVÆue
 
	$js_√w_°rög16
(
JSC⁄ãxt
 *
˘x
, c⁄° 
uöt16_t
 *
buf
, 
Àn
)

3380 
JSSåög
 *
°r
;

3381 
°r
 = 
	`js_Æloc_°rög
(
˘x
, 
Àn
, 1);

3382 i‡(!
°r
)

3383  
JS_EXCEPTION
;

3384 
	`mem˝y
(
°r
->
u
.
°r16
, 
buf
, 
Àn
 * 2);

3385  
	`JS_MKPTR
(
JS_TAG_STRING
, 
°r
);

3386 
	}
}

3388 
JSVÆue
 
	$js_√w_°rög_ch¨
(
JSC⁄ãxt
 *
˘x
, 
uöt16_t
 
c
)

3390 i‡(
c
 < 0x100) {

3391 
uöt8_t
 
ch8
 = 
c
;

3392  
	`js_√w_°rög8
(
˘x
, &
ch8
, 1);

3394 
uöt16_t
 
ch16
 = 
c
;

3395  
	`js_√w_°rög16
(
˘x
, &
ch16
, 1);

3397 
	}
}

3399 
JSVÆue
 
	$js_sub_°rög
(
JSC⁄ãxt
 *
˘x
, 
JSSåög
 *
p
, 
°¨t
, 
íd
)

3401 
Àn
 = 
íd
 - 
°¨t
;

3402 i‡(
°¨t
 =0 && 
íd
 =
p
->
Àn
) {

3403  
	`JS_DupVÆue
(
˘x
, 
	`JS_MKPTR
(
JS_TAG_STRING
, 
p
));

3405 i‡(
p
->
is_wide_ch¨
 && 
Àn
 > 0) {

3406 
JSSåög
 *
°r
;

3407 
i
;

3408 
uöt16_t
 
c
 = 0;

3409 
i
 = 
°¨t
; i < 
íd
; i++) {

3410 
c
 |
p
->
u
.
°r16
[
i
];

3412 i‡(
c
 > 0xFF)

3413  
	`js_√w_°rög16
(
˘x
, 
p
->
u
.
°r16
 + 
°¨t
, 
Àn
);

3415 
°r
 = 
	`js_Æloc_°rög
(
˘x
, 
Àn
, 0);

3416 i‡(!
°r
)

3417  
JS_EXCEPTION
;

3418 
i
 = 0; i < 
Àn
; i++) {

3419 
°r
->
u
.
°r8
[
i
] = 
p
->u.
°r16
[
°¨t
 + i];

3421 
°r
->
u
.
°r8
[
Àn
] = '\0';

3422  
	`JS_MKPTR
(
JS_TAG_STRING
, 
°r
);

3424  
	`js_√w_°rög8
(
˘x
, 
p
->
u
.
°r8
 + 
°¨t
, 
Àn
);

3426 
	}
}

3428 
	sSåögBuf„r
 {

3429 
JSC⁄ãxt
 *
	m˘x
;

3430 
JSSåög
 *
	m°r
;

3431 
	mÀn
;

3432 
	msize
;

3433 
	mis_wide_ch¨
;

3434 
	mîr‹_°©us
;

3435 } 
	tSåögBuf„r
;

3441 
	$°rög_buf„r_öô2
(
JSC⁄ãxt
 *
˘x
, 
SåögBuf„r
 *
s
, 
size
,

3442 
is_wide
)

3444 
s
->
˘x
 = ctx;

3445 
s
->
size
 = size;

3446 
s
->
Àn
 = 0;

3447 
s
->
is_wide_ch¨
 = 
is_wide
;

3448 
s
->
îr‹_°©us
 = 0;

3449 
s
->
°r
 = 
	`js_Æloc_°rög
(
˘x
, 
size
, 
is_wide
);

3450 i‡(
	`u∆ikñy
(!
s
->
°r
)) {

3451 
s
->
size
 = 0;

3452  
s
->
îr‹_°©us
 = -1;

3454 #ifde‡
DUMP_LEAKS


3456 
	`li°_dñ
(&
s
->
°r
->
lök
);

3459 
	}
}

3461 
ölöe
 
	$°rög_buf„r_öô
(
JSC⁄ãxt
 *
˘x
, 
SåögBuf„r
 *
s
, 
size
)

3463  
	`°rög_buf„r_öô2
(
˘x
, 
s
, 
size
, 0);

3464 
	}
}

3466 
	$°rög_buf„r_‰ì
(
SåögBuf„r
 *
s
)

3468 
	`js_‰ì
(
s
->
˘x
, s->
°r
);

3469 
s
->
°r
 = 
NULL
;

3470 
	}
}

3472 
	$°rög_buf„r_£t_îr‹
(
SåögBuf„r
 *
s
)

3474 
	`js_‰ì
(
s
->
˘x
, s->
°r
);

3475 
s
->
°r
 = 
NULL
;

3476 
s
->
size
 = 0;

3477 
s
->
Àn
 = 0;

3478  
s
->
îr‹_°©us
 = -1;

3479 
	}
}

3481 
no_ölöe
 
	$°rög_buf„r_widí
(
SåögBuf„r
 *
s
, 
size
)

3483 
JSSåög
 *
°r
;

3484 
size_t
 
¶ack
;

3485 
i
;

3487 i‡(
s
->
îr‹_°©us
)

3490 
°r
 = 
	`js_ªÆloc2
(
s
->
˘x
, s->°r, (
JSSåög
Ë+ (
size
 << 1), &
¶ack
);

3491 i‡(!
°r
)

3492  
	`°rög_buf„r_£t_îr‹
(
s
);

3493 
size
 +
¶ack
 >> 1;

3494 
i
 = 
s
->
Àn
; i-- > 0;) {

3495 
°r
->
u
.
°r16
[
i
] = så->u.
°r8
[i];

3497 
s
->
is_wide_ch¨
 = 1;

3498 
s
->
size
 = size;

3499 
s
->
°r
 = str;

3501 
	}
}

3503 
no_ölöe
 
	$°rög_buf„r_ªÆloc
(
SåögBuf„r
 *
s
, 
√w_Àn
, 
c
)

3505 
JSSåög
 *
√w_°r
;

3506 
√w_size
;

3507 
size_t
 
√w_size_byãs
, 
¶ack
;

3509 i‡(
s
->
îr‹_°©us
)

3512 i‡(
√w_Àn
 > 
JS_STRING_LEN_MAX
) {

3513 
	`JS_ThrowI¡î«lEº‹
(
s
->
˘x
, "stringÅooÜong");

3514  
	`°rög_buf„r_£t_îr‹
(
s
);

3516 
√w_size
 = 
	`mö_öt
(
	`max_öt
(
√w_Àn
, 
s
->
size
 * 3 / 2), 
JS_STRING_LEN_MAX
);

3517 i‡(!
s
->
is_wide_ch¨
 && 
c
 >= 0x100) {

3518  
	`°rög_buf„r_widí
(
s
, 
√w_size
);

3520 
√w_size_byãs
 = (
JSSåög
Ë+ (
√w_size
 << 
s
->
is_wide_ch¨
) + 1 - s->is_wide_char;

3521 
√w_°r
 = 
	`js_ªÆloc2
(
s
->
˘x
, s->
°r
, 
√w_size_byãs
, &
¶ack
);

3522 i‡(!
√w_°r
)

3523  
	`°rög_buf„r_£t_îr‹
(
s
);

3524 
√w_size
 = 
	`mö_öt
“ew_sizê+ (
¶ack
 >> 
s
->
is_wide_ch¨
), 
JS_STRING_LEN_MAX
);

3525 
s
->
size
 = 
√w_size
;

3526 
s
->
°r
 = 
√w_°r
;

3528 
	}
}

3530 
no_ölöe
 
	$°rög_buf„r_putc_¶ow
(
SåögBuf„r
 *
s
, 
uöt32_t
 
c
)

3532 i‡(
	`u∆ikñy
(
s
->
Àn
 >s->
size
)) {

3533 i‡(
	`°rög_buf„r_ªÆloc
(
s
, s->
Àn
 + 1, 
c
))

3536 i‡(
s
->
is_wide_ch¨
) {

3537 
s
->
°r
->
u
.
°r16
[s->
Àn
++] = 
c
;

3538 } i‡(
c
 < 0x100) {

3539 
s
->
°r
->
u
.
°r8
[s->
Àn
++] = 
c
;

3541 i‡(
	`°rög_buf„r_widí
(
s
, s->
size
))

3543 
s
->
°r
->
u
.
°r16
[s->
Àn
++] = 
c
;

3546 
	}
}

3549 
	$°rög_buf„r_putc8
(
SåögBuf„r
 *
s
, 
uöt32_t
 
c
)

3551 i‡(
	`u∆ikñy
(
s
->
Àn
 >s->
size
)) {

3552 i‡(
	`°rög_buf„r_ªÆloc
(
s
, s->
Àn
 + 1, 
c
))

3555 i‡(
s
->
is_wide_ch¨
) {

3556 
s
->
°r
->
u
.
°r16
[s->
Àn
++] = 
c
;

3558 
s
->
°r
->
u
.
°r8
[s->
Àn
++] = 
c
;

3561 
	}
}

3564 
	$°rög_buf„r_putc16
(
SåögBuf„r
 *
s
, 
uöt32_t
 
c
)

3566 i‡(
	`likñy
(
s
->
Àn
 < s->
size
)) {

3567 i‡(
s
->
is_wide_ch¨
) {

3568 
s
->
°r
->
u
.
°r16
[s->
Àn
++] = 
c
;

3570 } i‡(
c
 < 0x100) {

3571 
s
->
°r
->
u
.
°r8
[s->
Àn
++] = 
c
;

3575  
	`°rög_buf„r_putc_¶ow
(
s
, 
c
);

3576 
	}
}

3579 
	$°rög_buf„r_putc
(
SåögBuf„r
 *
s
, 
uöt32_t
 
c
)

3581 i‡(
	`u∆ikñy
(
c
 >= 0x10000)) {

3583 
c
 -= 0x10000;

3584 i‡(
	`°rög_buf„r_putc16
(
s
, (
c
 >> 10) + 0xd800))

3586 
c
 = (c & 0x3ff) + 0xdc00;

3588  
	`°rög_buf„r_putc16
(
s
, 
c
);

3589 
	}
}

3591 
	$°rög_gë
(c⁄° 
JSSåög
 *
p
, 
idx
) {

3592  
p
->
is_wide_ch¨
 ?Ö->
u
.
°r16
[
idx
] :Ö->u.
°r8
[idx];

3593 
	}
}

3595 
	$°rög_gëc
(c⁄° 
JSSåög
 *
p
, *
pidx
)

3597 
idx
, 
c
, 
c1
;

3598 
idx
 = *
pidx
;

3599 i‡(
p
->
is_wide_ch¨
) {

3600 
c
 = 
p
->
u
.
°r16
[
idx
++];

3601 i‡(
c
 >0xd800 && c < 0xdc00 && 
idx
 < 
p
->
Àn
) {

3602 
c1
 = 
p
->
u
.
°r16
[
idx
];

3603 i‡(
c1
 >= 0xdc00 && c1 < 0xe000) {

3604 
c
 = (((¯& 0x3ffË<< 10Ë| (
c1
 & 0x3ff)) + 0x10000;

3605 
idx
++;

3609 
c
 = 
p
->
u
.
°r8
[
idx
++];

3611 *
pidx
 = 
idx
;

3612  
c
;

3613 
	}
}

3615 
	$°rög_buf„r_wrôe8
(
SåögBuf„r
 *
s
, c⁄° 
uöt8_t
 *
p
, 
Àn
)

3617 
i
;

3619 i‡(
s
->
Àn
 +Üí > s->
size
) {

3620 i‡(
	`°rög_buf„r_ªÆloc
(
s
, s->
Àn
 +Üen, 0))

3623 i‡(
s
->
is_wide_ch¨
) {

3624 
i
 = 0; i < 
Àn
; i++) {

3625 
s
->
°r
->
u
.
°r16
[s->
Àn
 + 
i
] = 
p
[i];

3627 
s
->
Àn
 +=Üen;

3629 
	`mem˝y
(&
s
->
°r
->
u
.
°r8
[s->
Àn
], 
p
,Üen);

3630 
s
->
Àn
 +=Üen;

3633 
	}
}

3635 
	$°rög_buf„r_wrôe16
(
SåögBuf„r
 *
s
, c⁄° 
uöt16_t
 *
p
, 
Àn
)

3637 
c
 = 0, 
i
;

3639 
i
 = 0; i < 
Àn
; i++) {

3640 
c
 |
p
[
i
];

3642 i‡(
s
->
Àn
 +Üí > s->
size
) {

3643 i‡(
	`°rög_buf„r_ªÆloc
(
s
, s->
Àn
 +Üí, 
c
))

3645 } i‡(!
s
->
is_wide_ch¨
 && 
c
 >= 0x100) {

3646 i‡(
	`°rög_buf„r_widí
(
s
, s->
size
))

3649 i‡(
s
->
is_wide_ch¨
) {

3650 
	`mem˝y
(&
s
->
°r
->
u
.
°r16
[s->
Àn
], 
p
,Üen << 1);

3651 
s
->
Àn
 +=Üen;

3653 
i
 = 0; i < 
Àn
; i++) {

3654 
s
->
°r
->
u
.
°r8
[s->
Àn
 + 
i
] = 
p
[i];

3656 
s
->
Àn
 +=Üen;

3659 
	}
}

3662 
	$°rög_buf„r_puts8
(
SåögBuf„r
 *
s
, c⁄° *
°r
)

3664  
	`°rög_buf„r_wrôe8
(
s
, (c⁄° 
uöt8_t
 *)
°r
, 
	`°æí
(str));

3665 
	}
}

3667 
	$°rög_buf„r_c⁄ˇt
(
SåögBuf„r
 *
s
, c⁄° 
JSSåög
 *
p
,

3668 
uöt32_t
 
‰om
, uöt32_à
to
)

3670 i‡(
to
 <
‰om
)

3672 i‡(
p
->
is_wide_ch¨
)

3673  
	`°rög_buf„r_wrôe16
(
s
, 
p
->
u
.
°r16
 + 
‰om
, 
to
 - from);

3675  
	`°rög_buf„r_wrôe8
(
s
, 
p
->
u
.
°r8
 + 
‰om
, 
to
 - from);

3676 
	}
}

3678 
	$°rög_buf„r_c⁄ˇt_vÆue
(
SåögBuf„r
 *
s
, 
JSVÆueC⁄°
 
v
)

3680 
JSSåög
 *
p
;

3681 
JSVÆue
 
v1
;

3682 
ªs
;

3684 i‡(
s
->
îr‹_°©us
) {

3688 i‡(
	`u∆ikñy
(
	`JS_VALUE_GET_TAG
(
v
Ë!
JS_TAG_STRING
)) {

3689 
v1
 = 
	`JS_ToSåög
(
s
->
˘x
, 
v
);

3690 i‡(
	`JS_IsEx˚±i⁄
(
v1
))

3691  
	`°rög_buf„r_£t_îr‹
(
s
);

3692 
p
 = 
	`JS_VALUE_GET_STRING
(
v1
);

3693 
ªs
 = 
	`°rög_buf„r_c⁄ˇt
(
s
, 
p
, 0,Ö->
Àn
);

3694 
	`JS_FªeVÆue
(
s
->
˘x
, 
v1
);

3695  
ªs
;

3697 
p
 = 
	`JS_VALUE_GET_STRING
(
v
);

3698  
	`°rög_buf„r_c⁄ˇt
(
s
, 
p
, 0,Ö->
Àn
);

3699 
	}
}

3701 
	$°rög_buf„r_c⁄ˇt_vÆue_‰ì
(
SåögBuf„r
 *
s
, 
JSVÆue
 
v
)

3703 
JSSåög
 *
p
;

3704 
ªs
;

3706 i‡(
s
->
îr‹_°©us
) {

3708 
	`JS_FªeVÆue
(
s
->
˘x
, 
v
);

3711 i‡(
	`u∆ikñy
(
	`JS_VALUE_GET_TAG
(
v
Ë!
JS_TAG_STRING
)) {

3712 
v
 = 
	`JS_ToSåögFªe
(
s
->
˘x
, v);

3713 i‡(
	`JS_IsEx˚±i⁄
(
v
))

3714  
	`°rög_buf„r_£t_îr‹
(
s
);

3716 
p
 = 
	`JS_VALUE_GET_STRING
(
v
);

3717 
ªs
 = 
	`°rög_buf„r_c⁄ˇt
(
s
, 
p
, 0,Ö->
Àn
);

3718 
	`JS_FªeVÆue
(
s
->
˘x
, 
v
);

3719  
ªs
;

3720 
	}
}

3722 
	$°rög_buf„r_fûl
(
SåögBuf„r
 *
s
, 
c
, 
cou¡
)

3725 i‡(
s
->
Àn
 + 
cou¡
 > s->
size
) {

3726 i‡(
	`°rög_buf„r_ªÆloc
(
s
, s->
Àn
 + 
cou¡
, 
c
))

3729 
cou¡
-- > 0) {

3730 i‡(
	`°rög_buf„r_putc16
(
s
, 
c
))

3734 
	}
}

3736 
JSVÆue
 
	$°rög_buf„r_íd
(
SåögBuf„r
 *
s
)

3738 
JSSåög
 *
°r
;

3739 
°r
 = 
s
->str;

3740 i‡(
s
->
îr‹_°©us
)

3741  
JS_EXCEPTION
;

3742 i‡(
s
->
Àn
 == 0) {

3743 
	`js_‰ì
(
s
->
˘x
, 
°r
);

3744 
s
->
°r
 = 
NULL
;

3745  
	`JS_AtomToSåög
(
s
->
˘x
, 
JS_ATOM_em±y_°rög
);

3747 i‡(
s
->
Àn
 < s->
size
) {

3751 
°r
 = 
	`js_ªÆloc_π
(
s
->
˘x
->
π
, så, (
JSSåög
) +

3752 (
s
->
Àn
 << s->
is_wide_ch¨
) + 1 - s->is_wide_char);

3753 i‡(
°r
 =
NULL
)

3754 
°r
 = 
s
->str;

3755 
s
->
°r
 = str;

3757 i‡(!
s
->
is_wide_ch¨
)

3758 
°r
->
u
.
°r8
[
s
->
Àn
] = 0;

3759 #ifde‡
DUMP_LEAKS


3760 
	`li°_add_èû
(&
°r
->
lök
, &
s
->
˘x
->
π
->
°rög_li°
);

3762 
°r
->
is_wide_ch¨
 = 
s
->is_wide_char;

3763 
°r
->
Àn
 = 
s
->len;

3764 
s
->
°r
 = 
NULL
;

3765  
	`JS_MKPTR
(
JS_TAG_STRING
, 
°r
);

3766 
	}
}

3769 
JSVÆue
 
	$JS_NewSåögLí
(
JSC⁄ãxt
 *
˘x
, c⁄° *
buf
, 
size_t
 
buf_Àn
)

3771 c⁄° 
uöt8_t
 *
p
, *
p_íd
, *
p_°¨t
, *
p_√xt
;

3772 
uöt32_t
 
c
;

3773 
SåögBuf„r
 
b_s
, *
b
 = &b_s;

3774 
size_t
 
Àn1
;

3776 
p_°¨t
 = (c⁄° 
uöt8_t
 *)
buf
;

3777 
p_íd
 = 
p_°¨t
 + 
buf_Àn
;

3778 
p
 = 
p_°¨t
;

3779 
p
 < 
p_íd
 && *p < 128)

3780 
p
++;

3781 
Àn1
 = 
p
 - 
p_°¨t
;

3782 i‡(
Àn1
 > 
JS_STRING_LEN_MAX
)

3783  
	`JS_ThrowI¡î«lEº‹
(
˘x
, "stringÅooÜong");

3784 i‡(
p
 =
p_íd
) {

3786  
	`js_√w_°rög8
(
˘x
, (c⁄° 
uöt8_t
 *)
buf
, 
buf_Àn
);

3788 i‡(
	`°rög_buf„r_öô
(
˘x
, 
b
, 
buf_Àn
))

3789 
Áû
;

3790 
	`°rög_buf„r_wrôe8
(
b
, 
p_°¨t
, 
Àn1
);

3791 
p
 < 
p_íd
) {

3792 i‡(*
p
 < 128) {

3793 
	`°rög_buf„r_putc8
(
b
, *
p
++);

3796 
c
 = 
	`unicode_‰om_utf8
(
p
, 
p_íd
 -Ö, &
p_√xt
);

3797 i‡(
c
 < 0x10000) {

3798 
p
 = 
p_√xt
;

3799 } i‡(
c
 <= 0x10FFFF) {

3800 
p
 = 
p_√xt
;

3802 
c
 -= 0x10000;

3803 
	`°rög_buf„r_putc16
(
b
, (
c
 >> 10) + 0xd800);

3804 
c
 = (c & 0x3ff) + 0xdc00;

3807 
c
 = 0xfffd;

3810 
p
 < 
p_íd
 && (*p >= 0x80 && *p < 0xc0))

3811 
p
++;

3812 i‡(
p
 < 
p_íd
) {

3813 
p
++;

3814 
p
 < 
p_íd
 && (*p >= 0x80 && *p < 0xc0))

3815 
p
++;

3818 
	`°rög_buf„r_putc16
(
b
, 
c
);

3822  
	`°rög_buf„r_íd
(
b
);

3824 
Áû
:

3825 
	`°rög_buf„r_‰ì
(
b
);

3826  
JS_EXCEPTION
;

3827 
	}
}

3829 
JSVÆue
 
	$JS_C⁄ˇtSåög3
(
JSC⁄ãxt
 *
˘x
, c⁄° *
°r1
,

3830 
JSVÆue
 
°r2
, c⁄° *
°r3
)

3832 
SåögBuf„r
 
b_s
, *
b
 = &b_s;

3833 
Àn1
, 
Àn3
;

3834 
JSSåög
 *
p
;

3836 i‡(
	`u∆ikñy
(
	`JS_VALUE_GET_TAG
(
°r2
Ë!
JS_TAG_STRING
)) {

3837 
°r2
 = 
	`JS_ToSåögFªe
(
˘x
, str2);

3838 i‡(
	`JS_IsEx˚±i⁄
(
°r2
))

3839 
Áû
;

3841 
p
 = 
	`JS_VALUE_GET_STRING
(
°r2
);

3842 
Àn1
 = 
	`°æí
(
°r1
);

3843 
Àn3
 = 
	`°æí
(
°r3
);

3845 i‡(
	`°rög_buf„r_öô2
(
˘x
, 
b
, 
Àn1
 + 
p
->
Àn
 + 
Àn3
,Ö->
is_wide_ch¨
))

3846 
Áû
;

3848 
	`°rög_buf„r_wrôe8
(
b
, (c⁄° 
uöt8_t
 *)
°r1
, 
Àn1
);

3849 
	`°rög_buf„r_c⁄ˇt
(
b
, 
p
, 0,Ö->
Àn
);

3850 
	`°rög_buf„r_wrôe8
(
b
, (c⁄° 
uöt8_t
 *)
°r3
, 
Àn3
);

3852 
	`JS_FªeVÆue
(
˘x
, 
°r2
);

3853  
	`°rög_buf„r_íd
(
b
);

3855 
Áû
:

3856 
	`JS_FªeVÆue
(
˘x
, 
°r2
);

3857  
JS_EXCEPTION
;

3858 
	}
}

3860 
JSVÆue
 
	$JS_NewSåög
(
JSC⁄ãxt
 *
˘x
, c⁄° *
°r
)

3862  
	`JS_NewSåögLí
(
˘x
, 
°r
, 
	`°æí
(str));

3863 
	}
}

3865 
JSVÆue
 
	$JS_NewAtomSåög
(
JSC⁄ãxt
 *
˘x
, c⁄° *
°r
)

3867 
JSAtom
 
©om
 = 
	`JS_NewAtom
(
˘x
, 
°r
);

3868 i‡(
©om
 =
JS_ATOM_NULL
)

3869  
JS_EXCEPTION
;

3870 
JSVÆue
 
vÆ
 = 
	`JS_AtomToSåög
(
˘x
, 
©om
);

3871 
	`JS_FªeAtom
(
˘x
, 
©om
);

3872  
vÆ
;

3873 
	}
}

3878 c⁄° *
	$JS_ToCSåögLí2
(
JSC⁄ãxt
 *
˘x
, 
size_t
 *
∂í
, 
JSVÆueC⁄°
 
vÆ1
, 
BOOL
 
˚su8
)

3880 
JSVÆue
 
vÆ
;

3881 
JSSåög
 *
°r
, *
°r_√w
;

3882 
pos
, 
Àn
, 
c
, 
c1
;

3883 
uöt8_t
 *
q
;

3885 i‡(
	`JS_VALUE_GET_TAG
(
vÆ1
Ë!
JS_TAG_STRING
) {

3886 
vÆ
 = 
	`JS_ToSåög
(
˘x
, 
vÆ1
);

3887 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

3888 
Áû
;

3890 
vÆ
 = 
	`JS_DupVÆue
(
˘x
, 
vÆ1
);

3893 
°r
 = 
	`JS_VALUE_GET_STRING
(
vÆ
);

3894 
Àn
 = 
°r
->len;

3895 i‡(!
°r
->
is_wide_ch¨
) {

3896 c⁄° 
uöt8_t
 *
§c
 = 
°r
->
u
.
°r8
;

3897 
cou¡
;

3905 
cou¡
 = 0;

3906 
pos
 = 0;Öo†< 
Àn
;Öos++) {

3907 
cou¡
 +
§c
[
pos
] >> 7;

3909 i‡(
cou¡
 == 0) {

3910 i‡(
∂í
)

3911 *
∂í
 = 
Àn
;

3912  (c⁄° *)
§c
;

3914 
°r_√w
 = 
	`js_Æloc_°rög
(
˘x
, 
Àn
 + 
cou¡
, 0);

3915 i‡(!
°r_√w
)

3916 
Áû
;

3917 
q
 = 
°r_√w
->
u
.
°r8
;

3918 
pos
 = 0;Öo†< 
Àn
;Öos++) {

3919 
c
 = 
§c
[
pos
];

3920 i‡(
c
 < 0x80) {

3921 *
q
++ = 
c
;

3923 *
q
++ = (
c
 >> 6) | 0xc0;

3924 *
q
++ = (
c
 & 0x3f) | 0x80;

3928 c⁄° 
uöt16_t
 *
§c
 = 
°r
->
u
.
°r16
;

3932 
°r_√w
 = 
	`js_Æloc_°rög
(
˘x
, 
Àn
 * 3, 0);

3933 i‡(!
°r_√w
)

3934 
Áû
;

3935 
q
 = 
°r_√w
->
u
.
°r8
;

3936 
pos
 = 0;

3937 
pos
 < 
Àn
) {

3938 
c
 = 
§c
[
pos
++];

3939 i‡(
c
 < 0x80) {

3940 *
q
++ = 
c
;

3942 i‡(
c
 >= 0xd800 && c < 0xdc00) {

3943 i‡(
pos
 < 
Àn
 && !
˚su8
) {

3944 
c1
 = 
§c
[
pos
];

3945 i‡(
c1
 >= 0xdc00 && c1 < 0xe000) {

3946 
pos
++;

3948 
c
 = (((¯& 0x3ffË<< 10Ë| (
c1
 & 0x3ff)) + 0x10000;

3958 
q
 +
	`unicode_to_utf8
(q, 
c
);

3963 *
q
 = '\0';

3964 
°r_√w
->
Àn
 = 
q
 - så_√w->
u
.
°r8
;

3965 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

3966 i‡(
∂í
)

3967 *
∂í
 = 
°r_√w
->
Àn
;

3968  (c⁄° *)
°r_√w
->
u
.
°r8
;

3969 
Áû
:

3970 i‡(
∂í
)

3971 *
∂í
 = 0;

3972  
NULL
;

3973 
	}
}

3975 
	$JS_FªeCSåög
(
JSC⁄ãxt
 *
˘x
, c⁄° *
±r
)

3977 
JSSåög
 *
p
;

3978 i‡(!
±r
)

3981 
p
 = (
JSSåög
 *)(*)(
±r
 - 
	`off£tof
(JSSåög, 
u
));

3982 
	`JS_FªeVÆue
(
˘x
, 
	`JS_MKPTR
(
JS_TAG_STRING
, 
p
));

3983 
	}
}

3985 
	$memcmp16_8
(c⁄° 
uöt16_t
 *
§c1
, c⁄° 
uöt8_t
 *
§c2
, 
Àn
)

3987 
c
, 
i
;

3988 
i
 = 0; i < 
Àn
; i++) {

3989 
c
 = 
§c1
[
i
] - 
§c2
[i];

3990 i‡(
c
 != 0)

3991  
c
;

3994 
	}
}

3996 
	$memcmp16
(c⁄° 
uöt16_t
 *
§c1
, c⁄° uöt16_à*
§c2
, 
Àn
)

3998 
c
, 
i
;

3999 
i
 = 0; i < 
Àn
; i++) {

4000 
c
 = 
§c1
[
i
] - 
§c2
[i];

4001 i‡(
c
 != 0)

4002  
c
;

4005 
	}
}

4007 
	$js_°rög_memcmp
(c⁄° 
JSSåög
 *
p1
, c⁄° JSSåög *
p2
, 
Àn
)

4009 
ªs
;

4011 i‡(
	`likñy
(!
p1
->
is_wide_ch¨
)) {

4012 i‡(
	`likñy
(!
p2
->
is_wide_ch¨
))

4013 
ªs
 = 
	`memcmp
(
p1
->
u
.
°r8
, 
p2
->u.°r8, 
Àn
);

4015 
ªs
 = -
	`memcmp16_8
(
p2
->
u
.
°r16
, 
p1
->u.
°r8
, 
Àn
);

4017 i‡(!
p2
->
is_wide_ch¨
)

4018 
ªs
 = 
	`memcmp16_8
(
p1
->
u
.
°r16
, 
p2
->u.
°r8
, 
Àn
);

4020 
ªs
 = 
	`memcmp16
(
p1
->
u
.
°r16
, 
p2
->u.°r16, 
Àn
);

4022  
ªs
;

4023 
	}
}

4026 
	$js_°rög_com∑ª
(
JSC⁄ãxt
 *
˘x
,

4027 c⁄° 
JSSåög
 *
p1
, c⁄° JSSåög *
p2
)

4029 
ªs
, 
Àn
;

4030 
Àn
 = 
	`mö_öt
(
p1
->Àn, 
p2
->len);

4031 
ªs
 = 
	`js_°rög_memcmp
(
p1
, 
p2
, 
Àn
);

4032 i‡(
ªs
 == 0) {

4033 i‡(
p1
->
Àn
 =
p2
->len)

4034 
ªs
 = 0;

4035 i‡(
p1
->
Àn
 < 
p2
->len)

4036 
ªs
 = -1;

4038 
ªs
 = 1;

4040  
ªs
;

4041 
	}
}

4043 
	$c›y_°r16
(
uöt16_t
 *
d°
, c⁄° 
JSSåög
 *
p
, 
off£t
, 
Àn
)

4045 i‡(
p
->
is_wide_ch¨
) {

4046 
	`mem˝y
(
d°
, 
p
->
u
.
°r16
 + 
off£t
, 
Àn
 * 2);

4048 c⁄° 
uöt8_t
 *
§c1
 = 
p
->
u
.
°r8
 + 
off£t
;

4049 
i
;

4051 
i
 = 0; i < 
Àn
; i++)

4052 
d°
[
i
] = 
§c1
[i];

4054 
	}
}

4056 
JSVÆue
 
	$JS_C⁄ˇtSåög1
(
JSC⁄ãxt
 *
˘x
,

4057 c⁄° 
JSSåög
 *
p1
, c⁄° JSSåög *
p2
)

4059 
JSSåög
 *
p
;

4060 
uöt32_t
 
Àn
;

4061 
is_wide_ch¨
;

4063 
Àn
 = 
p1
->À¿+ 
p2
->len;

4064 i‡(
Àn
 > 
JS_STRING_LEN_MAX
)

4065  
	`JS_ThrowI¡î«lEº‹
(
˘x
, "stringÅooÜong");

4066 
is_wide_ch¨
 = 
p1
->is_wide_ch¨ | 
p2
->is_wide_char;

4067 
p
 = 
	`js_Æloc_°rög
(
˘x
, 
Àn
, 
is_wide_ch¨
);

4068 i‡(!
p
)

4069  
JS_EXCEPTION
;

4070 i‡(!
is_wide_ch¨
) {

4071 
	`mem˝y
(
p
->
u
.
°r8
, 
p1
->u.°r8,Ö1->
Àn
);

4072 
	`mem˝y
(
p
->
u
.
°r8
 + 
p1
->
Àn
, 
p2
->u.str8,Ö2->len);

4073 
p
->
u
.
°r8
[
Àn
] = '\0';

4075 
	`c›y_°r16
(
p
->
u
.
°r16
, 
p1
, 0,Ö1->
Àn
);

4076 
	`c›y_°r16
(
p
->
u
.
°r16
 + 
p1
->
Àn
, 
p2
, 0,Ö2->len);

4078  
	`JS_MKPTR
(
JS_TAG_STRING
, 
p
);

4079 
	}
}

4083 
JSVÆue
 
	$JS_C⁄ˇtSåög
(
JSC⁄ãxt
 *
˘x
, 
JSVÆue
 
›1
, JSVÆuê
›2
)

4085 
JSVÆue
 
ªt
;

4086 
JSSåög
 *
p1
, *
p2
;

4088 i‡(
	`u∆ikñy
(
	`JS_VALUE_GET_TAG
(
›1
Ë!
JS_TAG_STRING
)) {

4089 
›1
 = 
	`JS_ToSåögFªe
(
˘x
, op1);

4090 i‡(
	`JS_IsEx˚±i⁄
(
›1
)) {

4091 
	`JS_FªeVÆue
(
˘x
, 
›2
);

4092  
JS_EXCEPTION
;

4095 i‡(
	`u∆ikñy
(
	`JS_VALUE_GET_TAG
(
›2
Ë!
JS_TAG_STRING
)) {

4096 
›2
 = 
	`JS_ToSåögFªe
(
˘x
, op2);

4097 i‡(
	`JS_IsEx˚±i⁄
(
›2
)) {

4098 
	`JS_FªeVÆue
(
˘x
, 
›1
);

4099  
JS_EXCEPTION
;

4102 
p1
 = 
	`JS_VALUE_GET_STRING
(
›1
);

4103 
p2
 = 
	`JS_VALUE_GET_STRING
(
›2
);

4106 i‡(
p2
->
Àn
 == 0) {

4107 
ªt_›1
;

4109 i‡(
p1
->
hódî
.
ªf_cou¡
 =1 &&Ö1->
is_wide_ch¨
 =
p2
->is_wide_char

4110 && 
	`js_mÆloc_ußbÀ_size
(
˘x
, 
p1
Ë>(*p1Ë+ (’1->
Àn
 + 
p2
->ÀnË<<Ö2->
is_wide_ch¨
) + 1 -Ö1->is_wide_char) {

4112 i‡(
p1
->
is_wide_ch¨
) {

4113 
	`mem˝y
(
p1
->
u
.
°r16
 +Ö1->
Àn
, 
p2
->u.str16,Ö2->len << 1);

4114 
p1
->
Àn
 +
p2
->len;

4116 
	`mem˝y
(
p1
->
u
.
°r8
 +Ö1->
Àn
, 
p2
->u.str8,Ö2->len);

4117 
p1
->
Àn
 +
p2
->len;

4118 
p1
->
u
.
°r8
[p1->
Àn
] = '\0';

4120 
ªt_›1
:

4121 
	`JS_FªeVÆue
(
˘x
, 
›2
);

4122  
›1
;

4124 
ªt
 = 
	`JS_C⁄ˇtSåög1
(
˘x
, 
p1
, 
p2
);

4125 
	`JS_FªeVÆue
(
˘x
, 
›1
);

4126 
	`JS_FªeVÆue
(
˘x
, 
›2
);

4127  
ªt
;

4128 
	}
}

4132 
ölöe
 
size_t
 
	$gë_sh≠e_size
(
size_t
 
hash_size
, size_à
¥›_size
)

4134  
hash_size
 * (
uöt32_t
Ë+ (
JSSh≠e
) +

4135 
¥›_size
 * (
JSSh≠ePr›îty
);

4136 
	}
}

4138 
ölöe
 
JSSh≠e
 *
	$gë_sh≠e_‰om_Æloc
(*
sh_Æloc
, 
size_t
 
hash_size
)

4140  (
JSSh≠e
 *)(*)((
uöt32_t
 *)
sh_Æloc
 + 
hash_size
);

4141 
	}
}

4143 
ölöe
 *
	$gë_Æloc_‰om_sh≠e
(
JSSh≠e
 *
sh
)

4145  
sh
->
¥›_hash_íd
 - ((
öçå_t
)sh->
¥›_hash_mask
 + 1);

4146 
	}
}

4148 
ölöe
 
JSSh≠ePr›îty
 *
	$gë_sh≠e_¥›
(
JSSh≠e
 *
sh
)

4150  
sh
->
¥›
;

4151 
	}
}

4153 
	$öô_sh≠e_hash
(
JSRu¡ime
 *
π
)

4155 
π
->
sh≠e_hash_bôs
 = 4;

4156 
π
->
sh≠e_hash_size
 = 1 <<Ñt->
sh≠e_hash_bôs
;

4157 
π
->
sh≠e_hash_cou¡
 = 0;

4158 
π
->
sh≠e_hash
 = 
	`js_mÆlocz_π
(rt, (rt->shape_hash[0]) *

4159 
π
->
sh≠e_hash_size
);

4160 i‡(!
π
->
sh≠e_hash
)

4163 
	}
}

4166 
uöt32_t
 
	$sh≠e_hash
(
uöt32_t
 
h
, uöt32_à
vÆ
)

4168  (
h
 + 
vÆ
) * 0x9e370001;

4169 
	}
}

4172 
uöt32_t
 
	$gë_sh≠e_hash
(
uöt32_t
 
h
, 
hash_bôs
)

4174  
h
 >> (32 - 
hash_bôs
);

4175 
	}
}

4177 
uöt32_t
 
	$sh≠e_öôül_hash
(
JSObje˘
 *
¥Ÿo
)

4179 
uöt32_t
 
h
;

4180 
h
 = 
	`sh≠e_hash
(1, (
uöçå_t
)
¥Ÿo
);

4181 i‡((
¥Ÿo
) > 4)

4182 
h
 = 
	`sh≠e_hash
(h, (
uöt64_t
)(
uöçå_t
)
¥Ÿo
 >> 32);

4183  
h
;

4184 
	}
}

4186 
	$ªsize_sh≠e_hash
(
JSRu¡ime
 *
π
, 
√w_sh≠e_hash_bôs
)

4188 
√w_sh≠e_hash_size
, 
i
;

4189 
uöt32_t
 
h
;

4190 
JSSh≠e
 **
√w_sh≠e_hash
, *
sh
, *
sh_√xt
;

4192 
√w_sh≠e_hash_size
 = 1 << 
√w_sh≠e_hash_bôs
;

4193 
√w_sh≠e_hash
 = 
	`js_mÆlocz_π
(
π
, ‘t->
sh≠e_hash
[0]) *

4194 
√w_sh≠e_hash_size
);

4195 i‡(!
√w_sh≠e_hash
)

4197 
i
 = 0; i < 
π
->
sh≠e_hash_size
; i++) {

4198 
sh
 = 
π
->
sh≠e_hash
[
i
]; sh !
NULL
; sh = 
sh_√xt
) {

4199 
sh_√xt
 = 
sh
->
sh≠e_hash_√xt
;

4200 
h
 = 
	`gë_sh≠e_hash
(
sh
->
hash
, 
√w_sh≠e_hash_bôs
);

4201 
sh
->
sh≠e_hash_√xt
 = 
√w_sh≠e_hash
[
h
];

4202 
√w_sh≠e_hash
[
h
] = 
sh
;

4205 
	`js_‰ì_π
(
π
,Ñt->
sh≠e_hash
);

4206 
π
->
sh≠e_hash_bôs
 = 
√w_sh≠e_hash_bôs
;

4207 
π
->
sh≠e_hash_size
 = 
√w_sh≠e_hash_size
;

4208 
π
->
sh≠e_hash
 = 
√w_sh≠e_hash
;

4210 
	}
}

4212 
	$js_sh≠e_hash_lök
(
JSRu¡ime
 *
π
, 
JSSh≠e
 *
sh
)

4214 
uöt32_t
 
h
;

4215 
h
 = 
	`gë_sh≠e_hash
(
sh
->
hash
, 
π
->
sh≠e_hash_bôs
);

4216 
sh
->
sh≠e_hash_√xt
 = 
π
->
sh≠e_hash
[
h
];

4217 
π
->
sh≠e_hash
[
h
] = 
sh
;

4218 
π
->
sh≠e_hash_cou¡
++;

4219 
	}
}

4221 
	$js_sh≠e_hash_u∆ök
(
JSRu¡ime
 *
π
, 
JSSh≠e
 *
sh
)

4223 
uöt32_t
 
h
;

4224 
JSSh≠e
 **
psh
;

4226 
h
 = 
	`gë_sh≠e_hash
(
sh
->
hash
, 
π
->
sh≠e_hash_bôs
);

4227 
psh
 = &
π
->
sh≠e_hash
[
h
];

4228 *
psh
 !
sh
)

4229 
psh
 = &(*psh)->
sh≠e_hash_√xt
;

4230 *
psh
 = 
sh
->
sh≠e_hash_√xt
;

4231 
π
->
sh≠e_hash_cou¡
--;

4232 
	}
}

4235 
no_ölöe
 
JSSh≠e
 *
	$js_√w_sh≠e2
(
JSC⁄ãxt
 *
˘x
, 
JSObje˘
 *
¥Ÿo
,

4236 
hash_size
, 
¥›_size
)

4238 
JSRu¡ime
 *
π
 = 
˘x
->rt;

4239 *
sh_Æloc
;

4240 
JSSh≠e
 *
sh
;

4243 i‡(2 * (
π
->
sh≠e_hash_cou¡
 + 1Ë>Ñt->
sh≠e_hash_size
) {

4244 
	`ªsize_sh≠e_hash
(
π
,Ñt->
sh≠e_hash_bôs
 + 1);

4247 
sh_Æloc
 = 
	`js_mÆloc
(
˘x
, 
	`gë_sh≠e_size
(
hash_size
, 
¥›_size
));

4248 i‡(!
sh_Æloc
)

4249  
NULL
;

4250 
sh
 = 
	`gë_sh≠e_‰om_Æloc
(
sh_Æloc
, 
hash_size
);

4251 
sh
->
hódî
.
ªf_cou¡
 = 1;

4252 
	`add_gc_obje˘
(
π
, &
sh
->
hódî
, 
JS_GC_OBJ_TYPE_SHAPE
);

4253 i‡(
¥Ÿo
)

4254 
	`JS_DupVÆue
(
˘x
, 
	`JS_MKPTR
(
JS_TAG_OBJECT
, 
¥Ÿo
));

4255 
sh
->
¥Ÿo
 =Öroto;

4256 
	`mem£t
(
sh
->
¥›_hash_íd
 - 
hash_size
, 0, (sh->prop_hash_end[0]) *

4257 
hash_size
);

4258 
sh
->
¥›_hash_mask
 = 
hash_size
 - 1;

4259 
sh
->
¥›_cou¡
 = 0;

4260 
sh
->
¥›_size
 =Örop_size;

4263 
sh
->
hash
 = 
	`sh≠e_öôül_hash
(
¥Ÿo
);

4264 
sh
->
is_hashed
 = 
TRUE
;

4265 
sh
->
has_smÆl_¨øy_ödex
 = 
FALSE
;

4266 
	`js_sh≠e_hash_lök
(
˘x
->
π
, 
sh
);

4267  
sh
;

4268 
	}
}

4270 
JSSh≠e
 *
	$js_√w_sh≠e
(
JSC⁄ãxt
 *
˘x
, 
JSObje˘
 *
¥Ÿo
)

4272  
	`js_√w_sh≠e2
(
˘x
, 
¥Ÿo
, 
JS_PROP_INITIAL_HASH_SIZE
,

4273 
JS_PROP_INITIAL_SIZE
);

4274 
	}
}

4278 
JSSh≠e
 *
	$js_˛⁄e_sh≠e
(
JSC⁄ãxt
 *
˘x
, 
JSSh≠e
 *
sh1
)

4280 
JSSh≠e
 *
sh
;

4281 *
sh_Æloc
, *
sh_Æloc1
;

4282 
size_t
 
size
;

4283 
JSSh≠ePr›îty
 *
¥
;

4284 
uöt32_t
 
i
, 
hash_size
;

4286 
hash_size
 = 
sh1
->
¥›_hash_mask
 + 1;

4287 
size
 = 
	`gë_sh≠e_size
(
hash_size
, 
sh1
->
¥›_size
);

4288 
sh_Æloc
 = 
	`js_mÆloc
(
˘x
, 
size
);

4289 i‡(!
sh_Æloc
)

4290  
NULL
;

4291 
sh_Æloc1
 = 
	`gë_Æloc_‰om_sh≠e
(
sh1
);

4292 
	`mem˝y
(
sh_Æloc
, 
sh_Æloc1
, 
size
);

4293 
sh
 = 
	`gë_sh≠e_‰om_Æloc
(
sh_Æloc
, 
hash_size
);

4294 
sh
->
hódî
.
ªf_cou¡
 = 1;

4295 
	`add_gc_obje˘
(
˘x
->
π
, &
sh
->
hódî
, 
JS_GC_OBJ_TYPE_SHAPE
);

4296 
sh
->
is_hashed
 = 
FALSE
;

4297 i‡(
sh
->
¥Ÿo
) {

4298 
	`JS_DupVÆue
(
˘x
, 
	`JS_MKPTR
(
JS_TAG_OBJECT
, 
sh
->
¥Ÿo
));

4300 
i
 = 0, 
¥
 = 
	`gë_sh≠e_¥›
(
sh
); i < sh->
¥›_cou¡
; i++,Ör++) {

4301 
	`JS_DupAtom
(
˘x
, 
¥
->
©om
);

4303  
sh
;

4304 
	}
}

4306 
JSSh≠e
 *
	$js_dup_sh≠e
(
JSSh≠e
 *
sh
)

4308 
sh
->
hódî
.
ªf_cou¡
++;

4309  
sh
;

4310 
	}
}

4312 
	$js_‰ì_sh≠e0
(
JSRu¡ime
 *
π
, 
JSSh≠e
 *
sh
)

4314 
uöt32_t
 
i
;

4315 
JSSh≠ePr›îty
 *
¥
;

4317 
	`as£π
(
sh
->
hódî
.
ªf_cou¡
 == 0);

4318 i‡(
sh
->
is_hashed
)

4319 
	`js_sh≠e_hash_u∆ök
(
π
, 
sh
);

4320 i‡(
sh
->
¥Ÿo
 !
NULL
) {

4321 
	`JS_FªeVÆueRT
(
π
, 
	`JS_MKPTR
(
JS_TAG_OBJECT
, 
sh
->
¥Ÿo
));

4323 
¥
 = 
	`gë_sh≠e_¥›
(
sh
);

4324 
i
 = 0; i < 
sh
->
¥›_cou¡
; i++) {

4325 
	`JS_FªeAtomRT
(
π
, 
¥
->
©om
);

4326 
¥
++;

4328 
	`ªmove_gc_obje˘
(&
sh
->
hódî
);

4329 
	`js_‰ì_π
(
π
, 
	`gë_Æloc_‰om_sh≠e
(
sh
));

4330 
	}
}

4332 
	$js_‰ì_sh≠e
(
JSRu¡ime
 *
π
, 
JSSh≠e
 *
sh
)

4334 i‡(
	`u∆ikñy
(--
sh
->
hódî
.
ªf_cou¡
 <= 0)) {

4335 
	`js_‰ì_sh≠e0
(
π
, 
sh
);

4337 
	}
}

4339 
	$js_‰ì_sh≠e_nuŒ
(
JSRu¡ime
 *
π
, 
JSSh≠e
 *
sh
)

4341 i‡(
sh
)

4342 
	`js_‰ì_sh≠e
(
π
, 
sh
);

4343 
	}
}

4346 
no_ölöe
 
	$ªsize_¥›îtõs
(
JSC⁄ãxt
 *
˘x
, 
JSSh≠e
 **
psh
,

4347 
JSObje˘
 *
p
, 
uöt32_t
 
cou¡
)

4349 
JSSh≠e
 *
sh
;

4350 
uöt32_t
 
√w_size
, 
√w_hash_size
, 
√w_hash_mask
, 
i
;

4351 
JSSh≠ePr›îty
 *
¥
;

4352 *
sh_Æloc
;

4353 
öçå_t
 
h
;

4355 
sh
 = *
psh
;

4356 
√w_size
 = 
	`max_öt
(
cou¡
, 
sh
->
¥›_size
 * 3 / 2);

4359 i‡(
p
) {

4360 
JSPr›îty
 *
√w_¥›
;

4361 
√w_¥›
 = 
	`js_ªÆloc
(
˘x
, 
p
->
¥›
, “ew_¥›[0]Ë* 
√w_size
);

4362 i‡(
	`u∆ikñy
(!
√w_¥›
))

4364 
p
->
¥›
 = 
√w_¥›
;

4366 
√w_hash_size
 = 
sh
->
¥›_hash_mask
 + 1;

4367 
√w_hash_size
 < 
√w_size
)

4368 
√w_hash_size
 = 2 *Çew_hash_size;

4369 i‡(
√w_hash_size
 !(
sh
->
¥›_hash_mask
 + 1)) {

4370 
JSSh≠e
 *
ﬁd_sh
;

4372 
ﬁd_sh
 = 
sh
;

4373 
sh_Æloc
 = 
	`js_mÆloc
(
˘x
, 
	`gë_sh≠e_size
(
√w_hash_size
, 
√w_size
));

4374 i‡(!
sh_Æloc
)

4376 
sh
 = 
	`gë_sh≠e_‰om_Æloc
(
sh_Æloc
, 
√w_hash_size
);

4377 
	`li°_dñ
(&
ﬁd_sh
->
hódî
.
lök
);

4379 
	`mem˝y
(
sh
, 
ﬁd_sh
,

4380 (
JSSh≠e
Ë+ (
sh
->
¥›
[0]Ë* 
ﬁd_sh
->
¥›_cou¡
);

4381 
	`li°_add_èû
(&
sh
->
hódî
.
lök
, &
˘x
->
π
->
gc_obj_li°
);

4382 
√w_hash_mask
 = 
√w_hash_size
 - 1;

4383 
sh
->
¥›_hash_mask
 = 
√w_hash_mask
;

4384 
	`mem£t
(
sh
->
¥›_hash_íd
 - 
√w_hash_size
, 0,

4385 (
sh
->
¥›_hash_íd
[0]Ë* 
√w_hash_size
);

4386 
i
 = 0, 
¥
 = 
sh
->
¥›
; i < sh->
¥›_cou¡
; i++,Ör++) {

4387 i‡(
¥
->
©om
 !
JS_ATOM_NULL
) {

4388 
h
 = ((
uöçå_t
)
¥
->
©om
 & 
√w_hash_mask
);

4389 
¥
->
hash_√xt
 = 
sh
->
¥›_hash_íd
[-
h
 - 1];

4390 
sh
->
¥›_hash_íd
[-
h
 - 1] = 
i
 + 1;

4393 
	`js_‰ì
(
˘x
, 
	`gë_Æloc_‰om_sh≠e
(
ﬁd_sh
));

4396 
	`li°_dñ
(&
sh
->
hódî
.
lök
);

4397 
sh_Æloc
 = 
	`js_ªÆloc
(
˘x
, 
	`gë_Æloc_‰om_sh≠e
(
sh
),

4398 
	`gë_sh≠e_size
(
√w_hash_size
, 
√w_size
));

4399 i‡(
	`u∆ikñy
(!
sh_Æloc
)) {

4401 
	`li°_add_èû
(&
sh
->
hódî
.
lök
, &
˘x
->
π
->
gc_obj_li°
);

4404 
sh
 = 
	`gë_sh≠e_‰om_Æloc
(
sh_Æloc
, 
√w_hash_size
);

4405 
	`li°_add_èû
(&
sh
->
hódî
.
lök
, &
˘x
->
π
->
gc_obj_li°
);

4407 *
psh
 = 
sh
;

4408 
sh
->
¥›_size
 = 
√w_size
;

4410 
	}
}

4412 
	$add_sh≠e_¥›îty
(
JSC⁄ãxt
 *
˘x
, 
JSSh≠e
 **
psh
,

4413 
JSObje˘
 *
p
, 
JSAtom
 
©om
, 
¥›_Êags
)

4415 
JSRu¡ime
 *
π
 = 
˘x
->rt;

4416 
JSSh≠e
 *
sh
 = *
psh
;

4417 
JSSh≠ePr›îty
 *
¥
, *
¥›
;

4418 
uöt32_t
 
hash_mask
, 
√w_sh≠e_hash
 = 0;

4419 
öçå_t
 
h
;

4422 i‡(
sh
->
is_hashed
) {

4423 
	`js_sh≠e_hash_u∆ök
(
π
, 
sh
);

4424 
√w_sh≠e_hash
 = 
	`sh≠e_hash
(sh≠e_hash(
sh
->
hash
, 
©om
), 
¥›_Êags
);

4427 i‡(
	`u∆ikñy
(
sh
->
¥›_cou¡
 >sh->
¥›_size
)) {

4428 i‡(
	`ªsize_¥›îtõs
(
˘x
, 
psh
, 
p
, 
sh
->
¥›_cou¡
 + 1)) {

4431 i‡(
sh
->
is_hashed
)

4432 
	`js_sh≠e_hash_lök
(
π
, 
sh
);

4435 
sh
 = *
psh
;

4437 i‡(
sh
->
is_hashed
) {

4438 
sh
->
hash
 = 
√w_sh≠e_hash
;

4439 
	`js_sh≠e_hash_lök
(
π
, 
sh
);

4443 
¥›
 = 
	`gë_sh≠e_¥›
(
sh
);

4444 
¥
 = &
¥›
[
sh
->
¥›_cou¡
++];

4445 
¥
->
©om
 = 
	`JS_DupAtom
(
˘x
,átom);

4446 
¥
->
Êags
 = 
¥›_Êags
;

4447 
sh
->
has_smÆl_¨øy_ödex
 |
	`__JS_AtomIsTaggedI¡
(
©om
);

4449 
hash_mask
 = 
sh
->
¥›_hash_mask
;

4450 
h
 = 
©om
 & 
hash_mask
;

4451 
¥
->
hash_√xt
 = 
sh
->
¥›_hash_íd
[-
h
 - 1];

4452 
sh
->
¥›_hash_íd
[-
h
 - 1] = sh->
¥›_cou¡
;

4454 
	}
}

4458 
JSSh≠e
 *
	$föd_hashed_sh≠e_¥Ÿo
(
JSRu¡ime
 *
π
, 
JSObje˘
 *
¥Ÿo
)

4460 
JSSh≠e
 *
sh1
;

4461 
uöt32_t
 
h
, 
h1
;

4463 
h
 = 
	`sh≠e_öôül_hash
(
¥Ÿo
);

4464 
h1
 = 
	`gë_sh≠e_hash
(
h
, 
π
->
sh≠e_hash_bôs
);

4465 
sh1
 = 
π
->
sh≠e_hash
[
h1
]; sh1 !
NULL
; sh1 = sh1->
sh≠e_hash_√xt
) {

4466 i‡(
sh1
->
hash
 =
h
 &&

4467 
sh1
->
¥Ÿo
 ==Öroto &&

4468 
sh1
->
¥›_cou¡
 == 0) {

4469  
sh1
;

4472  
NULL
;

4473 
	}
}

4477 
JSSh≠e
 *
	$föd_hashed_sh≠e_¥›
(
JSRu¡ime
 *
π
, 
JSSh≠e
 *
sh
,

4478 
JSAtom
 
©om
, 
¥›_Êags
)

4480 
JSSh≠e
 *
sh1
;

4481 
uöt32_t
 
h
, 
h1
, 
i
, 
n
;

4483 
h
 = 
sh
->
hash
;

4484 
h
 = 
	`sh≠e_hash
(h, 
©om
);

4485 
h
 = 
	`sh≠e_hash
(h, 
¥›_Êags
);

4486 
h1
 = 
	`gë_sh≠e_hash
(
h
, 
π
->
sh≠e_hash_bôs
);

4487 
sh1
 = 
π
->
sh≠e_hash
[
h1
]; sh1 !
NULL
; sh1 = sh1->
sh≠e_hash_√xt
) {

4490 i‡(
sh1
->
hash
 =
h
 &&

4491 
sh1
->
¥Ÿo
 =
sh
->proto &&

4492 
sh1
->
¥›_cou¡
 =((
n
 = 
sh
->prop_count) + 1)) {

4493 
i
 = 0; i < 
n
; i++) {

4494 i‡(
	`u∆ikñy
(
sh1
->
¥›
[
i
].
©om
 !
sh
->prop[i].atom) ||

4495 
	`u∆ikñy
(
sh1
->
¥›
[
i
].
Êags
 !
sh
->prop[i].flags))

4496 
√xt
;

4498 i‡(
	`u∆ikñy
(
sh1
->
¥›
[
n
].
©om
 !=átom) ||

4499 
	`u∆ikñy
(
sh1
->
¥›
[
n
].
Êags
 !
¥›_Êags
))

4500 
√xt
;

4501  
sh1
;

4503 
√xt
: ;

4505  
NULL
;

4506 
	}
}

4508 
__maybe_unu£d
 
	$JS_DumpSh≠e
(
JSRu¡ime
 *
π
, 
i
, 
JSSh≠e
 *
sh
)

4510 
©om_buf
[
ATOM_GET_STR_BUF_SIZE
];

4511 
j
;

4514 
	`¥ötf
("%5d %3d%¯%14∞%5d %5d", 
i
,

4515 
sh
->
hódî
.
ªf_cou¡
, " *"[sh->
is_hashed
],

4516 (*)
sh
->
¥Ÿo
, sh->
¥›_size
, sh->
¥›_cou¡
);

4517 
j
 = 0; j < 
sh
->
¥›_cou¡
; j++) {

4518 
	`¥ötf
(" %s", 
	`JS_AtomGëSåRT
(
π
, 
©om_buf
, (atom_buf),

4519 
sh
->
¥›
[
j
].
©om
));

4521 
	`¥ötf
("\n");

4522 
	}
}

4524 
__maybe_unu£d
 
	$JS_DumpSh≠es
(
JSRu¡ime
 *
π
)

4526 
i
;

4527 
JSSh≠e
 *
sh
;

4528 
li°_hód
 *
ñ
;

4529 
JSObje˘
 *
p
;

4530 
JSGCObje˘Hódî
 *
gp
;

4532 
	`¥ötf
("JSShapes: {\n");

4533 
	`¥ötf
("%5s %4s %14s %5s %5s %s\n", "SLOT", "REFS", "PROTO", "SIZE", "COUNT", "PROPS");

4534 
i
 = 0; i < 
π
->
sh≠e_hash_size
; i++) {

4535 
sh
 = 
π
->
sh≠e_hash
[
i
]; sh !
NULL
; sh = sh->
sh≠e_hash_√xt
) {

4536 
	`JS_DumpSh≠e
(
π
, 
i
, 
sh
);

4537 
	`as£π
(
sh
->
is_hashed
);

4541 
	`li°_f‹_óch
(
ñ
, &
π
->
gc_obj_li°
) {

4542 
gp
 = 
	`li°_íåy
(
ñ
, 
JSGCObje˘Hódî
, 
lök
);

4543 i‡(
gp
->
gc_obj_ty≥
 =
JS_GC_OBJ_TYPE_JS_OBJECT
) {

4544 
p
 = (
JSObje˘
 *)
gp
;

4545 i‡(!
p
->
sh≠e
->
is_hashed
) {

4546 
	`JS_DumpSh≠e
(
π
, -1, 
p
->
sh≠e
);

4550 
	`¥ötf
("}\n");

4551 
	}
}

4553 
JSVÆue
 
	$JS_NewObje˘FromSh≠e
(
JSC⁄ãxt
 *
˘x
, 
JSSh≠e
 *
sh
, 
JSCœssID
 
˛ass_id
)

4555 
JSObje˘
 *
p
;

4557 
	`js_åiggî_gc
(
˘x
->
π
, (
JSObje˘
));

4558 
p
 = 
	`js_mÆloc
(
˘x
, (
JSObje˘
));

4559 i‡(
	`u∆ikñy
(!
p
))

4560 
Áû
;

4561 
p
->
˛ass_id
 = class_id;

4562 
p
->
exãnsibÀ
 = 
TRUE
;

4563 
p
->
‰ì_m¨k
 = 0;

4564 
p
->
is_exŸic
 = 0;

4565 
p
->
Á°_¨øy
 = 0;

4566 
p
->
is_c⁄°ru˘‹
 = 0;

4567 
p
->
is_unˇtchabÀ_îr‹
 = 0;

4568 
p
->
is_˛ass
 = 0;

4569 
p
->
tmp_m¨k
 = 0;

4570 
p
->
fú°_wók_ªf
 = 
NULL
;

4571 
p
->
u
.
›aque
 = 
NULL
;

4572 
p
->
sh≠e
 = 
sh
;

4573 
p
->
¥›
 = 
	`js_mÆloc
(
˘x
, (
JSPr›îty
Ë* 
sh
->
¥›_size
);

4574 i‡(
	`u∆ikñy
(!
p
->
¥›
)) {

4575 
	`js_‰ì
(
˘x
, 
p
);

4576 
Áû
:

4577 
	`js_‰ì_sh≠e
(
˘x
->
π
, 
sh
);

4578  
JS_EXCEPTION
;

4581 
˛ass_id
) {

4582 
JS_CLASS_OBJECT
:

4584 
JS_CLASS_ARRAY
:

4586 
JSPr›îty
 *
¥
;

4587 
p
->
is_exŸic
 = 1;

4588 
p
->
Á°_¨øy
 = 1;

4589 
p
->
u
.
¨øy
.u.
vÆues
 = 
NULL
;

4590 
p
->
u
.
¨øy
.
cou¡
 = 0;

4591 
p
->
u
.
¨øy
.
u1
.
size
 = 0;

4593 i‡(
	`likñy
(
sh
 =
˘x
->
¨øy_sh≠e
)) {

4594 
¥
 = &
p
->
¥›
[0];

4598 
¥
 = 
	`add_¥›îty
(
˘x
, 
p
, 
JS_ATOM_Àngth
,

4599 
JS_PROP_WRITABLE
 | 
JS_PROP_LENGTH
);

4601 
¥
->
u
.
vÆue
 = 
	`JS_NewI¡32
(
˘x
, 0);

4604 
JS_CLASS_C_FUNCTION
:

4605 
p
->
¥›
[0].
u
.
vÆue
 = 
JS_UNDEFINED
;

4607 
JS_CLASS_ARGUMENTS
:

4608 
JS_CLASS_UINT8C_ARRAY
 ... 
JS_CLASS_FLOAT64_ARRAY
:

4609 
p
->
is_exŸic
 = 1;

4610 
p
->
Á°_¨øy
 = 1;

4611 
p
->
u
.
¨øy
.u.
±r
 = 
NULL
;

4612 
p
->
u
.
¨øy
.
cou¡
 = 0;

4614 
JS_CLASS_DATAVIEW
:

4615 
p
->
u
.
¨øy
.u.
±r
 = 
NULL
;

4616 
p
->
u
.
¨øy
.
cou¡
 = 0;

4618 
JS_CLASS_ERROR
:

4619 
JS_CLASS_NUMBER
:

4620 
JS_CLASS_STRING
:

4621 
JS_CLASS_BOOLEAN
:

4622 
JS_CLASS_SYMBOL
:

4623 
JS_CLASS_DATE
:

4624 #ifde‡
CONFIG_BIGNUM


4625 
JS_CLASS_BIG_INT
:

4626 
JS_CLASS_BIG_FLOAT
:

4627 
JS_CLASS_BIG_DECIMAL
:

4629 
p
->
u
.
obje˘_d©a
 = 
JS_UNDEFINED
;

4630 
£t_exŸic
;

4631 
JS_CLASS_REGEXP
:

4632 
p
->
u
.
ªgexp
.
∑âîn
 = 
NULL
;

4633 
p
->
u
.
ªgexp
.
byãcode
 = 
NULL
;

4634 
£t_exŸic
;

4636 
£t_exŸic
:

4637 i‡(
˘x
->
π
->
˛ass_¨øy
[
˛ass_id
].
exŸic
) {

4638 
p
->
is_exŸic
 = 1;

4642 
p
->
hódî
.
ªf_cou¡
 = 1;

4643 
	`add_gc_obje˘
(
˘x
->
π
, &
p
->
hódî
, 
JS_GC_OBJ_TYPE_JS_OBJECT
);

4644  
	`JS_MKPTR
(
JS_TAG_OBJECT
, 
p
);

4645 
	}
}

4647 
JSObje˘
 *
	$gë_¥Ÿo_obj
(
JSVÆueC⁄°
 
¥Ÿo_vÆ
)

4649 i‡(
	`JS_VALUE_GET_TAG
(
¥Ÿo_vÆ
Ë!
JS_TAG_OBJECT
)

4650  
NULL
;

4652  
	`JS_VALUE_GET_OBJ
(
¥Ÿo_vÆ
);

4653 
	}
}

4656 
JSVÆue
 
	$JS_NewObje˘PrŸoCœss
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
¥Ÿo_vÆ
,

4657 
JSCœssID
 
˛ass_id
)

4659 
JSSh≠e
 *
sh
;

4660 
JSObje˘
 *
¥Ÿo
;

4662 
¥Ÿo
 = 
	`gë_¥Ÿo_obj
(
¥Ÿo_vÆ
);

4663 
sh
 = 
	`föd_hashed_sh≠e_¥Ÿo
(
˘x
->
π
, 
¥Ÿo
);

4664 i‡(
	`likñy
(
sh
)) {

4665 
sh
 = 
	`js_dup_sh≠e
(sh);

4667 
sh
 = 
	`js_√w_sh≠e
(
˘x
, 
¥Ÿo
);

4668 i‡(!
sh
)

4669  
JS_EXCEPTION
;

4671  
	`JS_NewObje˘FromSh≠e
(
˘x
, 
sh
, 
˛ass_id
);

4672 
	}
}

4675 
JSVÆue
 
	$JS_GëObje˘D©a
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
obj
)

4677 
JSObje˘
 *
p
;

4679 i‡(
	`JS_VALUE_GET_TAG
(
obj
Ë=
JS_TAG_OBJECT
) {

4680 
p
 = 
	`JS_VALUE_GET_OBJ
(
obj
);

4681 
p
->
˛ass_id
) {

4682 
JS_CLASS_NUMBER
:

4683 
JS_CLASS_STRING
:

4684 
JS_CLASS_BOOLEAN
:

4685 
JS_CLASS_SYMBOL
:

4686 
JS_CLASS_DATE
:

4687 #ifde‡
CONFIG_BIGNUM


4688 
JS_CLASS_BIG_INT
:

4689 
JS_CLASS_BIG_FLOAT
:

4690 
JS_CLASS_BIG_DECIMAL
:

4692  
	`JS_DupVÆue
(
˘x
, 
p
->
u
.
obje˘_d©a
);

4695  
JS_UNDEFINED
;

4696 
	}
}

4699 
	$JS_SëObje˘D©a
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
obj
, 
JSVÆue
 
vÆ
)

4701 
JSObje˘
 *
p
;

4703 i‡(
	`JS_VALUE_GET_TAG
(
obj
Ë=
JS_TAG_OBJECT
) {

4704 
p
 = 
	`JS_VALUE_GET_OBJ
(
obj
);

4705 
p
->
˛ass_id
) {

4706 
JS_CLASS_NUMBER
:

4707 
JS_CLASS_STRING
:

4708 
JS_CLASS_BOOLEAN
:

4709 
JS_CLASS_SYMBOL
:

4710 
JS_CLASS_DATE
:

4711 #ifde‡
CONFIG_BIGNUM


4712 
JS_CLASS_BIG_INT
:

4713 
JS_CLASS_BIG_FLOAT
:

4714 
JS_CLASS_BIG_DECIMAL
:

4716 
	`JS_FªeVÆue
(
˘x
, 
p
->
u
.
obje˘_d©a
);

4717 
p
->
u
.
obje˘_d©a
 = 
vÆ
;

4721 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

4722 i‡(!
	`JS_IsEx˚±i⁄
(
obj
))

4723 
	`JS_ThrowTy≥Eº‹
(
˘x
, "invalid objectÅype");

4725 
	}
}

4727 
JSVÆue
 
	$JS_NewObje˘Cœss
(
JSC⁄ãxt
 *
˘x
, 
˛ass_id
)

4729  
	`JS_NewObje˘PrŸoCœss
(
˘x
, ctx->
˛ass_¥Ÿo
[
˛ass_id
], class_id);

4730 
	}
}

4732 
JSVÆue
 
	$JS_NewObje˘PrŸo
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
¥Ÿo
)

4734  
	`JS_NewObje˘PrŸoCœss
(
˘x
, 
¥Ÿo
, 
JS_CLASS_OBJECT
);

4735 
	}
}

4737 
JSVÆue
 
	$JS_NewAºay
(
JSC⁄ãxt
 *
˘x
)

4739  
	`JS_NewObje˘FromSh≠e
(
˘x
, 
	`js_dup_sh≠e
(˘x->
¨øy_sh≠e
),

4740 
JS_CLASS_ARRAY
);

4741 
	}
}

4743 
JSVÆue
 
	$JS_NewObje˘
(
JSC⁄ãxt
 *
˘x
)

4746  
	`JS_NewObje˘PrŸoCœss
(
˘x
, ctx->
˛ass_¥Ÿo
[
JS_CLASS_OBJECT
], JS_CLASS_OBJECT);

4747 
	}
}

4749 
	$js_fun˘i⁄_£t_¥›îtõs
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
func_obj
,

4750 
JSAtom
 
«me
, 
Àn
)

4753 
	`JS_DeföePr›îtyVÆue
(
˘x
, 
func_obj
, 
JS_ATOM_Àngth
, 
	`JS_NewI¡32
(˘x, 
Àn
),

4754 
JS_PROP_CONFIGURABLE
);

4755 
	`JS_DeföePr›îtyVÆue
(
˘x
, 
func_obj
, 
JS_ATOM_«me
,

4756 
	`JS_AtomToSåög
(
˘x
, 
«me
), 
JS_PROP_CONFIGURABLE
);

4757 
	}
}

4759 
BOOL
 
	$js_˛ass_has_byãcode
(
JSCœssID
 
˛ass_id
)

4761  (
˛ass_id
 =
JS_CLASS_BYTECODE_FUNCTION
 ||

4762 
˛ass_id
 =
JS_CLASS_GENERATOR_FUNCTION
 ||

4763 
˛ass_id
 =
JS_CLASS_ASYNC_FUNCTION
 ||

4764 
˛ass_id
 =
JS_CLASS_ASYNC_GENERATOR_FUNCTION
);

4765 
	}
}

4768 
JSFun˘i⁄Byãcode
 *
	$JS_GëFun˘i⁄Byãcode
(
JSVÆueC⁄°
 
vÆ
)

4770 
JSObje˘
 *
p
;

4771 i‡(
	`JS_VALUE_GET_TAG
(
vÆ
Ë!
JS_TAG_OBJECT
)

4772  
NULL
;

4773 
p
 = 
	`JS_VALUE_GET_OBJ
(
vÆ
);

4774 i‡(!
	`js_˛ass_has_byãcode
(
p
->
˛ass_id
))

4775  
NULL
;

4776  
p
->
u
.
func
.
fun˘i⁄_byãcode
;

4777 
	}
}

4779 
	$js_mëhod_£t_home_obje˘
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
func_obj
,

4780 
JSVÆueC⁄°
 
home_obj
)

4782 
JSObje˘
 *
p
, *
p1
;

4783 
JSFun˘i⁄Byãcode
 *
b
;

4785 i‡(
	`JS_VALUE_GET_TAG
(
func_obj
Ë!
JS_TAG_OBJECT
)

4787 
p
 = 
	`JS_VALUE_GET_OBJ
(
func_obj
);

4788 i‡(!
	`js_˛ass_has_byãcode
(
p
->
˛ass_id
))

4790 
b
 = 
p
->
u
.
func
.
fun˘i⁄_byãcode
;

4791 i‡(
b
->
√ed_home_obje˘
) {

4792 
p1
 = 
p
->
u
.
func
.
home_obje˘
;

4793 i‡(
p1
) {

4794 
	`JS_FªeVÆue
(
˘x
, 
	`JS_MKPTR
(
JS_TAG_OBJECT
, 
p1
));

4796 i‡(
	`JS_VALUE_GET_TAG
(
home_obj
Ë=
JS_TAG_OBJECT
)

4797 
p1
 = 
	`JS_VALUE_GET_OBJ
(
	`JS_DupVÆue
(
˘x
, 
home_obj
));

4799 
p1
 = 
NULL
;

4800 
p
->
u
.
func
.
home_obje˘
 = 
p1
;

4802 
	}
}

4804 
JSVÆue
 
	$js_gë_fun˘i⁄_«me
(
JSC⁄ãxt
 *
˘x
, 
JSAtom
 
«me
)

4806 
JSVÆue
 
«me_°r
;

4808 
«me_°r
 = 
	`JS_AtomToSåög
(
˘x
, 
«me
);

4809 i‡(
	`JS_AtomSymbﬁHasDes¸ùti⁄
(
˘x
, 
«me
)) {

4810 
«me_°r
 = 
	`JS_C⁄ˇtSåög3
(
˘x
, "[",Çame_str, "]");

4812  
«me_°r
;

4813 
	}
}

4819 
	$js_mëhod_£t_¥›îtõs
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
func_obj
,

4820 
JSAtom
 
«me
, 
Êags
, 
JSVÆueC⁄°
 
home_obj
)

4822 
JSVÆue
 
«me_°r
;

4824 
«me_°r
 = 
	`js_gë_fun˘i⁄_«me
(
˘x
, 
«me
);

4825 i‡(
Êags
 & 
JS_PROP_HAS_GET
) {

4826 
«me_°r
 = 
	`JS_C⁄ˇtSåög3
(
˘x
, "get ",Çame_str, "");

4827 } i‡(
Êags
 & 
JS_PROP_HAS_SET
) {

4828 
«me_°r
 = 
	`JS_C⁄ˇtSåög3
(
˘x
, "set ",Çame_str, "");

4830 i‡(
	`JS_IsEx˚±i⁄
(
«me_°r
))

4832 i‡(
	`JS_DeföePr›îtyVÆue
(
˘x
, 
func_obj
, 
JS_ATOM_«me
, 
«me_°r
,

4833 
JS_PROP_CONFIGURABLE
) < 0)

4835 
	`js_mëhod_£t_home_obje˘
(
˘x
, 
func_obj
, 
home_obj
);

4837 
	}
}

4840 
JSVÆue
 
	$JS_NewCFun˘i⁄3
(
JSC⁄ãxt
 *
˘x
, 
JSCFun˘i⁄
 *
func
,

4841 c⁄° *
«me
,

4842 
Àngth
, 
JSCFun˘i⁄Enum
 
˝rŸo
, 
magic
,

4843 
JSVÆueC⁄°
 
¥Ÿo_vÆ
)

4845 
JSVÆue
 
func_obj
;

4846 
JSObje˘
 *
p
;

4847 
JSAtom
 
«me_©om
;

4849 
func_obj
 = 
	`JS_NewObje˘PrŸoCœss
(
˘x
, 
¥Ÿo_vÆ
, 
JS_CLASS_C_FUNCTION
);

4850 i‡(
	`JS_IsEx˚±i⁄
(
func_obj
))

4851  
func_obj
;

4852 
p
 = 
	`JS_VALUE_GET_OBJ
(
func_obj
);

4853 
p
->
u
.
cfunc
.
ªÆm
 = 
	`JS_DupC⁄ãxt
(
˘x
);

4854 
p
->
u
.
cfunc
.
c_fun˘i⁄
.
gíîic
 = 
func
;

4855 
p
->
u
.
cfunc
.
Àngth
 =Üength;

4856 
p
->
u
.
cfunc
.
˝rŸo
 = cproto;

4857 
p
->
u
.
cfunc
.
magic
 = magic;

4858 
p
->
is_c⁄°ru˘‹
 = (
˝rŸo
 =
JS_CFUNC_c⁄°ru˘‹
 ||

4859 
˝rŸo
 =
JS_CFUNC_c⁄°ru˘‹_magic
 ||

4860 
˝rŸo
 =
JS_CFUNC_c⁄°ru˘‹_‹_func
 ||

4861 
˝rŸo
 =
JS_CFUNC_c⁄°ru˘‹_‹_func_magic
);

4862 i‡(!
«me
)

4863 
«me
 = "";

4864 
«me_©om
 = 
	`JS_NewAtom
(
˘x
, 
«me
);

4865 
	`js_fun˘i⁄_£t_¥›îtõs
(
˘x
, 
func_obj
, 
«me_©om
, 
Àngth
);

4866 
	`JS_FªeAtom
(
˘x
, 
«me_©om
);

4867  
func_obj
;

4868 
	}
}

4871 
JSVÆue
 
	$JS_NewCFun˘i⁄2
(
JSC⁄ãxt
 *
˘x
, 
JSCFun˘i⁄
 *
func
,

4872 c⁄° *
«me
,

4873 
Àngth
, 
JSCFun˘i⁄Enum
 
˝rŸo
, 
magic
)

4875  
	`JS_NewCFun˘i⁄3
(
˘x
, 
func
, 
«me
, 
Àngth
, 
˝rŸo
, 
magic
,

4876 
˘x
->
fun˘i⁄_¥Ÿo
);

4877 
	}
}

4879 
	sJSCFun˘i⁄D©aRec‹d
 {

4880 
JSCFun˘i⁄D©a
 *
	mfunc
;

4881 
uöt8_t
 
	mÀngth
;

4882 
uöt8_t
 
	md©a_Àn
;

4883 
uöt16_t
 
	mmagic
;

4884 
JSVÆue
 
	md©a
[0];

4885 } 
	tJSCFun˘i⁄D©aRec‹d
;

4887 
	$js_c_fun˘i⁄_d©a_föÆizî
(
JSRu¡ime
 *
π
, 
JSVÆue
 
vÆ
)

4889 
JSCFun˘i⁄D©aRec‹d
 *
s
 = 
	`JS_GëO∑que
(
vÆ
, 
JS_CLASS_C_FUNCTION_DATA
);

4890 
i
;

4892 i‡(
s
) {

4893 
i
 = 0; i < 
s
->
d©a_Àn
; i++) {

4894 
	`JS_FªeVÆueRT
(
π
, 
s
->
d©a
[
i
]);

4896 
	`js_‰ì_π
(
π
, 
s
);

4898 
	}
}

4900 
	$js_c_fun˘i⁄_d©a_m¨k
(
JSRu¡ime
 *
π
, 
JSVÆueC⁄°
 
vÆ
,

4901 
JS_M¨kFunc
 *
m¨k_func
)

4903 
JSCFun˘i⁄D©aRec‹d
 *
s
 = 
	`JS_GëO∑que
(
vÆ
, 
JS_CLASS_C_FUNCTION_DATA
);

4904 
i
;

4906 i‡(
s
) {

4907 
i
 = 0; i < 
s
->
d©a_Àn
; i++) {

4908 
	`JS_M¨kVÆue
(
π
, 
s
->
d©a
[
i
], 
m¨k_func
);

4911 
	}
}

4913 
JSVÆue
 
	$js_c_fun˘i⁄_d©a_ˇŒ
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
func_obj
,

4914 
JSVÆueC⁄°
 
this_vÆ
,

4915 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
, 
Êags
)

4917 
JSCFun˘i⁄D©aRec‹d
 *
s
 = 
	`JS_GëO∑que
(
func_obj
, 
JS_CLASS_C_FUNCTION_DATA
);

4918 
JSVÆueC⁄°
 *
¨g_buf
;

4919 
i
;

4922 i‡(
	`u∆ikñy
(
¨gc
 < 
s
->
Àngth
)) {

4923 
¨g_buf
 = 
	`Æloˇ
(◊rg_buf[0]Ë* 
s
->
Àngth
);

4924 
i
 = 0; i < 
¨gc
; i++)

4925 
¨g_buf
[
i
] = 
¨gv
[i];

4926 
i
 = 
¨gc
; i < 
s
->
Àngth
; i++)

4927 
¨g_buf
[
i
] = 
JS_UNDEFINED
;

4929 
¨g_buf
 = 
¨gv
;

4932  
s
->
	`func
(
˘x
, 
this_vÆ
, 
¨gc
, 
¨g_buf
, s->
magic
, s->
d©a
);

4933 
	}
}

4935 
JSVÆue
 
	$JS_NewCFun˘i⁄D©a
(
JSC⁄ãxt
 *
˘x
, 
JSCFun˘i⁄D©a
 *
func
,

4936 
Àngth
, 
magic
, 
d©a_Àn
,

4937 
JSVÆueC⁄°
 *
d©a
)

4939 
JSCFun˘i⁄D©aRec‹d
 *
s
;

4940 
JSVÆue
 
func_obj
;

4941 
i
;

4943 
func_obj
 = 
	`JS_NewObje˘PrŸoCœss
(
˘x
, ctx->
fun˘i⁄_¥Ÿo
,

4944 
JS_CLASS_C_FUNCTION_DATA
);

4945 i‡(
	`JS_IsEx˚±i⁄
(
func_obj
))

4946  
func_obj
;

4947 
s
 = 
	`js_mÆloc
(
˘x
, (*sË+ 
d©a_Àn
 * (
JSVÆue
));

4948 i‡(!
s
) {

4949 
	`JS_FªeVÆue
(
˘x
, 
func_obj
);

4950  
JS_EXCEPTION
;

4952 
s
->
func
 = func;

4953 
s
->
Àngth
 =Üength;

4954 
s
->
d©a_Àn
 = data_len;

4955 
s
->
magic
 = magic;

4956 
i
 = 0; i < 
d©a_Àn
; i++)

4957 
s
->
d©a
[
i
] = 
	`JS_DupVÆue
(
˘x
, data[i]);

4958 
	`JS_SëO∑que
(
func_obj
, 
s
);

4959 
	`js_fun˘i⁄_£t_¥›îtõs
(
˘x
, 
func_obj
,

4960 
JS_ATOM_em±y_°rög
, 
Àngth
);

4961  
func_obj
;

4962 
	}
}

4964 
	$js_autoöô_‰ì
(
JSRu¡ime
 *
π
, 
JSPr›îty
 *
¥
)

4966 i‡(
¥
->
u
.
öô
.u.
öô_id
 >
JS_AUTOINIT_ID_PROP
) {

4967 
	`JS_FªeC⁄ãxt
(
¥
->
u
.
öô
.u.
ªÆm
);

4969 
	}
}

4971 
	$js_autoöô_m¨k
(
JSRu¡ime
 *
π
, 
JSPr›îty
 *
¥
,

4972 
JS_M¨kFunc
 *
m¨k_func
)

4974 i‡(
¥
->
u
.
öô
.u.
öô_id
 >
JS_AUTOINIT_ID_PROP
) {

4975 
	`m¨k_func
(
π
, &
¥
->
u
.
öô
.u.
ªÆm
->
hódî
);

4977 
	}
}

4979 
	$‰ì_¥›îty
(
JSRu¡ime
 *
π
, 
JSPr›îty
 *
¥
, 
¥›_Êags
)

4981 i‡(
	`u∆ikñy
(
¥›_Êags
 & 
JS_PROP_TMASK
)) {

4982 i‡((
¥›_Êags
 & 
JS_PROP_TMASK
Ë=
JS_PROP_GETSET
) {

4983 i‡(
¥
->
u
.
gë£t
.
gëãr
)

4984 
	`JS_FªeVÆueRT
(
π
, 
	`JS_MKPTR
(
JS_TAG_OBJECT
, 
¥
->
u
.
gë£t
.
gëãr
));

4985 i‡(
¥
->
u
.
gë£t
.
£âî
)

4986 
	`JS_FªeVÆueRT
(
π
, 
	`JS_MKPTR
(
JS_TAG_OBJECT
, 
¥
->
u
.
gë£t
.
£âî
));

4987 } i‡((
¥›_Êags
 & 
JS_PROP_TMASK
Ë=
JS_PROP_VARREF
) {

4988 
	`‰ì_v¨_ªf
(
π
, 
¥
->
u
.
v¨_ªf
);

4989 } i‡((
¥›_Êags
 & 
JS_PROP_TMASK
Ë=
JS_PROP_AUTOINIT
) {

4990 
	`js_autoöô_‰ì
(
π
, 
¥
);

4993 
	`JS_FªeVÆueRT
(
π
, 
¥
->
u
.
vÆue
);

4995 
	}
}

4997 
f‹˚_ölöe
 
JSSh≠ePr›îty
 *
	$föd_own_¥›îty1
(
JSObje˘
 *
p
,

4998 
JSAtom
 
©om
)

5000 
JSSh≠e
 *
sh
;

5001 
JSSh≠ePr›îty
 *
¥
, *
¥›
;

5002 
öçå_t
 
h
;

5003 
sh
 = 
p
->
sh≠e
;

5004 
h
 = (
uöçå_t
)
©om
 & 
sh
->
¥›_hash_mask
;

5005 
h
 = 
sh
->
¥›_hash_íd
[-h - 1];

5006 
¥›
 = 
	`gë_sh≠e_¥›
(
sh
);

5007 
h
) {

5008 
¥
 = &
¥›
[
h
 - 1];

5009 i‡(
	`likñy
(
¥
->
©om
 ==átom)) {

5010  
¥
;

5012 
h
 = 
¥
->
hash_√xt
;

5014  
NULL
;

5015 
	}
}

5017 
f‹˚_ölöe
 
JSSh≠ePr›îty
 *
	$föd_own_¥›îty
(
JSPr›îty
 **
µr
,

5018 
JSObje˘
 *
p
,

5019 
JSAtom
 
©om
)

5021 
JSSh≠e
 *
sh
;

5022 
JSSh≠ePr›îty
 *
¥
, *
¥›
;

5023 
öçå_t
 
h
;

5024 
sh
 = 
p
->
sh≠e
;

5025 
h
 = (
uöçå_t
)
©om
 & 
sh
->
¥›_hash_mask
;

5026 
h
 = 
sh
->
¥›_hash_íd
[-h - 1];

5027 
¥›
 = 
	`gë_sh≠e_¥›
(
sh
);

5028 
h
) {

5029 
¥
 = &
¥›
[
h
 - 1];

5030 i‡(
	`likñy
(
¥
->
©om
 ==átom)) {

5031 *
µr
 = &
p
->
¥›
[
h
 - 1];

5033  
¥
;

5035 
h
 = 
¥
->
hash_√xt
;

5037 *
µr
 = 
NULL
;

5038  
NULL
;

5039 
	}
}

5042 
	$£t_cy˛e_Êag
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
obj
)

5044 
	}
}

5046 
	$‰ì_v¨_ªf
(
JSRu¡ime
 *
π
, 
JSV¨Ref
 *
v¨_ªf
)

5048 i‡(
v¨_ªf
) {

5049 
	`as£π
(
v¨_ªf
->
hódî
.
ªf_cou¡
 > 0);

5050 i‡(--
v¨_ªf
->
hódî
.
ªf_cou¡
 == 0) {

5051 i‡(
v¨_ªf
->
is_dëached
) {

5052 
	`JS_FªeVÆueRT
(
π
, 
v¨_ªf
->
vÆue
);

5053 
	`ªmove_gc_obje˘
(&
v¨_ªf
->
hódî
);

5055 
	`li°_dñ
(&
v¨_ªf
->
hódî
.
lök
);

5057 
	`js_‰ì_π
(
π
, 
v¨_ªf
);

5060 
	}
}

5062 
	$js_¨øy_föÆizî
(
JSRu¡ime
 *
π
, 
JSVÆue
 
vÆ
)

5064 
JSObje˘
 *
p
 = 
	`JS_VALUE_GET_OBJ
(
vÆ
);

5065 
i
;

5067 
i
 = 0; i < 
p
->
u
.
¨øy
.
cou¡
; i++) {

5068 
	`JS_FªeVÆueRT
(
π
, 
p
->
u
.
¨øy
.u.
vÆues
[
i
]);

5070 
	`js_‰ì_π
(
π
, 
p
->
u
.
¨øy
.u.
vÆues
);

5071 
	}
}

5073 
	$js_¨øy_m¨k
(
JSRu¡ime
 *
π
, 
JSVÆueC⁄°
 
vÆ
,

5074 
JS_M¨kFunc
 *
m¨k_func
)

5076 
JSObje˘
 *
p
 = 
	`JS_VALUE_GET_OBJ
(
vÆ
);

5077 
i
;

5079 
i
 = 0; i < 
p
->
u
.
¨øy
.
cou¡
; i++) {

5080 
	`JS_M¨kVÆue
(
π
, 
p
->
u
.
¨øy
.u.
vÆues
[
i
], 
m¨k_func
);

5082 
	}
}

5084 
	$js_obje˘_d©a_föÆizî
(
JSRu¡ime
 *
π
, 
JSVÆue
 
vÆ
)

5086 
JSObje˘
 *
p
 = 
	`JS_VALUE_GET_OBJ
(
vÆ
);

5087 
	`JS_FªeVÆueRT
(
π
, 
p
->
u
.
obje˘_d©a
);

5088 
p
->
u
.
obje˘_d©a
 = 
JS_UNDEFINED
;

5089 
	}
}

5091 
	$js_obje˘_d©a_m¨k
(
JSRu¡ime
 *
π
, 
JSVÆueC⁄°
 
vÆ
,

5092 
JS_M¨kFunc
 *
m¨k_func
)

5094 
JSObje˘
 *
p
 = 
	`JS_VALUE_GET_OBJ
(
vÆ
);

5095 
	`JS_M¨kVÆue
(
π
, 
p
->
u
.
obje˘_d©a
, 
m¨k_func
);

5096 
	}
}

5098 
	$js_c_fun˘i⁄_föÆizî
(
JSRu¡ime
 *
π
, 
JSVÆue
 
vÆ
)

5100 
JSObje˘
 *
p
 = 
	`JS_VALUE_GET_OBJ
(
vÆ
);

5102 i‡(
p
->
u
.
cfunc
.
ªÆm
)

5103 
	`JS_FªeC⁄ãxt
(
p
->
u
.
cfunc
.
ªÆm
);

5104 
	}
}

5106 
	$js_c_fun˘i⁄_m¨k
(
JSRu¡ime
 *
π
, 
JSVÆueC⁄°
 
vÆ
,

5107 
JS_M¨kFunc
 *
m¨k_func
)

5109 
JSObje˘
 *
p
 = 
	`JS_VALUE_GET_OBJ
(
vÆ
);

5111 i‡(
p
->
u
.
cfunc
.
ªÆm
)

5112 
	`m¨k_func
(
π
, &
p
->
u
.
cfunc
.
ªÆm
->
hódî
);

5113 
	}
}

5115 
	$js_byãcode_fun˘i⁄_föÆizî
(
JSRu¡ime
 *
π
, 
JSVÆue
 
vÆ
)

5117 
JSObje˘
 *
p1
, *
p
 = 
	`JS_VALUE_GET_OBJ
(
vÆ
);

5118 
JSFun˘i⁄Byãcode
 *
b
;

5119 
JSV¨Ref
 **
v¨_ªfs
;

5120 
i
;

5122 
p1
 = 
p
->
u
.
func
.
home_obje˘
;

5123 i‡(
p1
) {

5124 
	`JS_FªeVÆueRT
(
π
, 
	`JS_MKPTR
(
JS_TAG_OBJECT
, 
p1
));

5126 
b
 = 
p
->
u
.
func
.
fun˘i⁄_byãcode
;

5127 i‡(
b
) {

5128 
v¨_ªfs
 = 
p
->
u
.
func
.var_refs;

5129 i‡(
v¨_ªfs
) {

5130 
i
 = 0; i < 
b
->
˛osuª_v¨_cou¡
; i++)

5131 
	`‰ì_v¨_ªf
(
π
, 
v¨_ªfs
[
i
]);

5132 
	`js_‰ì_π
(
π
, 
v¨_ªfs
);

5134 
	`JS_FªeVÆueRT
(
π
, 
	`JS_MKPTR
(
JS_TAG_FUNCTION_BYTECODE
, 
b
));

5136 
	}
}

5138 
	$js_byãcode_fun˘i⁄_m¨k
(
JSRu¡ime
 *
π
, 
JSVÆueC⁄°
 
vÆ
,

5139 
JS_M¨kFunc
 *
m¨k_func
)

5141 
JSObje˘
 *
p
 = 
	`JS_VALUE_GET_OBJ
(
vÆ
);

5142 
JSV¨Ref
 **
v¨_ªfs
 = 
p
->
u
.
func
.var_refs;

5143 
JSFun˘i⁄Byãcode
 *
b
 = 
p
->
u
.
func
.
fun˘i⁄_byãcode
;

5144 
i
;

5146 i‡(
p
->
u
.
func
.
home_obje˘
) {

5147 
	`JS_M¨kVÆue
(
π
, 
	`JS_MKPTR
(
JS_TAG_OBJECT
, 
p
->
u
.
func
.
home_obje˘
),

5148 
m¨k_func
);

5150 i‡(
b
) {

5151 i‡(
v¨_ªfs
) {

5152 
i
 = 0; i < 
b
->
˛osuª_v¨_cou¡
; i++) {

5153 
JSV¨Ref
 *
v¨_ªf
 = 
v¨_ªfs
[
i
];

5154 i‡(
v¨_ªf
 && v¨_ªf->
is_dëached
) {

5155 
	`m¨k_func
(
π
, &
v¨_ªf
->
hódî
);

5161 
	`JS_M¨kVÆue
(
π
, 
	`JS_MKPTR
(
JS_TAG_FUNCTION_BYTECODE
, 
b
), 
m¨k_func
);

5163 
	}
}

5165 
	$js_bound_fun˘i⁄_föÆizî
(
JSRu¡ime
 *
π
, 
JSVÆue
 
vÆ
)

5167 
JSObje˘
 *
p
 = 
	`JS_VALUE_GET_OBJ
(
vÆ
);

5168 
JSBoundFun˘i⁄
 *
bf
 = 
p
->
u
.
bound_fun˘i⁄
;

5169 
i
;

5171 
	`JS_FªeVÆueRT
(
π
, 
bf
->
func_obj
);

5172 
	`JS_FªeVÆueRT
(
π
, 
bf
->
this_vÆ
);

5173 
i
 = 0; i < 
bf
->
¨gc
; i++) {

5174 
	`JS_FªeVÆueRT
(
π
, 
bf
->
¨gv
[
i
]);

5176 
	`js_‰ì_π
(
π
, 
bf
);

5177 
	}
}

5179 
	$js_bound_fun˘i⁄_m¨k
(
JSRu¡ime
 *
π
, 
JSVÆueC⁄°
 
vÆ
,

5180 
JS_M¨kFunc
 *
m¨k_func
)

5182 
JSObje˘
 *
p
 = 
	`JS_VALUE_GET_OBJ
(
vÆ
);

5183 
JSBoundFun˘i⁄
 *
bf
 = 
p
->
u
.
bound_fun˘i⁄
;

5184 
i
;

5186 
	`JS_M¨kVÆue
(
π
, 
bf
->
func_obj
, 
m¨k_func
);

5187 
	`JS_M¨kVÆue
(
π
, 
bf
->
this_vÆ
, 
m¨k_func
);

5188 
i
 = 0; i < 
bf
->
¨gc
; i++)

5189 
	`JS_M¨kVÆue
(
π
, 
bf
->
¨gv
[
i
], 
m¨k_func
);

5190 
	}
}

5192 
	$js_f‹_ö_ôî©‹_föÆizî
(
JSRu¡ime
 *
π
, 
JSVÆue
 
vÆ
)

5194 
JSObje˘
 *
p
 = 
	`JS_VALUE_GET_OBJ
(
vÆ
);

5195 
JSF‹InIãøt‹
 *
ô
 = 
p
->
u
.
f‹_ö_ôî©‹
;

5196 
	`JS_FªeVÆueRT
(
π
, 
ô
->
obj
);

5197 
	`js_‰ì_π
(
π
, 
ô
);

5198 
	}
}

5200 
	$js_f‹_ö_ôî©‹_m¨k
(
JSRu¡ime
 *
π
, 
JSVÆueC⁄°
 
vÆ
,

5201 
JS_M¨kFunc
 *
m¨k_func
)

5203 
JSObje˘
 *
p
 = 
	`JS_VALUE_GET_OBJ
(
vÆ
);

5204 
JSF‹InIãøt‹
 *
ô
 = 
p
->
u
.
f‹_ö_ôî©‹
;

5205 
	`JS_M¨kVÆue
(
π
, 
ô
->
obj
, 
m¨k_func
);

5206 
	}
}

5208 
	$‰ì_obje˘
(
JSRu¡ime
 *
π
, 
JSObje˘
 *
p
)

5210 
i
;

5211 
JSCœssFöÆizî
 *
föÆizî
;

5212 
JSSh≠e
 *
sh
;

5213 
JSSh≠ePr›îty
 *
¥
;

5215 
p
->
‰ì_m¨k
 = 1;

5218 
sh
 = 
p
->
sh≠e
;

5219 
¥
 = 
	`gë_sh≠e_¥›
(
sh
);

5220 
i
 = 0; i < 
sh
->
¥›_cou¡
; i++) {

5221 
	`‰ì_¥›îty
(
π
, &
p
->
¥›
[
i
], 
¥
->
Êags
);

5222 
¥
++;

5224 
	`js_‰ì_π
(
π
, 
p
->
¥›
);

5227 
	`js_‰ì_sh≠e
(
π
, 
sh
);

5230 
p
->
sh≠e
 = 
NULL
;

5231 
p
->
¥›
 = 
NULL
;

5233 i‡(
	`u∆ikñy
(
p
->
fú°_wók_ªf
)) {

5234 
	`ª£t_wók_ªf
(
π
, 
p
);

5237 
föÆizî
 = 
π
->
˛ass_¨øy
[
p
->
˛ass_id
].finalizer;

5238 i‡(
föÆizî
)

5239 (*
föÆizî
)(
π
, 
	`JS_MKPTR
(
JS_TAG_OBJECT
, 
p
));

5242 
p
->
˛ass_id
 = 0;

5243 
p
->
u
.
›aque
 = 
NULL
;

5244 
p
->
u
.
func
.
v¨_ªfs
 = 
NULL
;

5245 
p
->
u
.
func
.
home_obje˘
 = 
NULL
;

5247 
	`ªmove_gc_obje˘
(&
p
->
hódî
);

5248 i‡(
π
->
gc_pha£
 =
JS_GC_PHASE_REMOVE_CYCLES
 && 
p
->
hódî
.
ªf_cou¡
 != 0) {

5249 
	`li°_add_èû
(&
p
->
hódî
.
lök
, &
π
->
gc_zîo_ªf_cou¡_li°
);

5251 
	`js_‰ì_π
(
π
, 
p
);

5253 
	}
}

5255 
	$‰ì_gc_obje˘
(
JSRu¡ime
 *
π
, 
JSGCObje˘Hódî
 *
gp
)

5257 
gp
->
gc_obj_ty≥
) {

5258 
JS_GC_OBJ_TYPE_JS_OBJECT
:

5259 
	`‰ì_obje˘
(
π
, (
JSObje˘
 *)
gp
);

5261 
JS_GC_OBJ_TYPE_FUNCTION_BYTECODE
:

5262 
	`‰ì_fun˘i⁄_byãcode
(
π
, (
JSFun˘i⁄Byãcode
 *)
gp
);

5265 
	`ab‹t
();

5267 
	}
}

5269 
	$‰ì_zîo_ªfcou¡
(
JSRu¡ime
 *
π
)

5271 
li°_hód
 *
ñ
;

5272 
JSGCObje˘Hódî
 *
p
;

5274 
π
->
gc_pha£
 = 
JS_GC_PHASE_DECREF
;

5276 
ñ
 = 
π
->
gc_zîo_ªf_cou¡_li°
.
√xt
;

5277 i‡(
ñ
 =&
π
->
gc_zîo_ªf_cou¡_li°
)

5279 
p
 = 
	`li°_íåy
(
ñ
, 
JSGCObje˘Hódî
, 
lök
);

5280 
	`as£π
(
p
->
ªf_cou¡
 == 0);

5281 
	`‰ì_gc_obje˘
(
π
, 
p
);

5283 
π
->
gc_pha£
 = 
JS_GC_PHASE_NONE
;

5284 
	}
}

5287 
	$__JS_FªeVÆueRT
(
JSRu¡ime
 *
π
, 
JSVÆue
 
v
)

5289 
uöt32_t
 
èg
 = 
	`JS_VALUE_GET_TAG
(
v
);

5291 #ifde‡
DUMP_FREE


5293 
	`¥ötf
("Freeing ");

5294 i‡(
èg
 =
JS_TAG_OBJECT
) {

5295 
	`JS_DumpObje˘
(
π
, 
	`JS_VALUE_GET_OBJ
(
v
));

5297 
	`JS_DumpVÆueSh‹t
(
π
, 
v
);

5298 
	`¥ötf
("\n");

5303 
èg
) {

5304 
JS_TAG_STRING
:

5306 
JSSåög
 *
p
 = 
	`JS_VALUE_GET_STRING
(
v
);

5307 i‡(
p
->
©om_ty≥
) {

5308 
	`JS_FªeAtomSåu˘
(
π
, 
p
);

5310 #ifde‡
DUMP_LEAKS


5311 
	`li°_dñ
(&
p
->
lök
);

5313 
	`js_‰ì_π
(
π
, 
p
);

5317 
JS_TAG_OBJECT
:

5318 
JS_TAG_FUNCTION_BYTECODE
:

5320 
JSGCObje˘Hódî
 *
p
 = 
	`JS_VALUE_GET_PTR
(
v
);

5321 i‡(
π
->
gc_pha£
 !
JS_GC_PHASE_REMOVE_CYCLES
) {

5322 
	`li°_dñ
(&
p
->
lök
);

5323 
	`li°_add
(&
p
->
lök
, &
π
->
gc_zîo_ªf_cou¡_li°
);

5324 i‡(
π
->
gc_pha£
 =
JS_GC_PHASE_NONE
) {

5325 
	`‰ì_zîo_ªfcou¡
(
π
);

5330 
JS_TAG_MODULE
:

5331 
	`ab‹t
();

5333 #ifde‡
CONFIG_BIGNUM


5334 
JS_TAG_BIG_INT
:

5335 
JS_TAG_BIG_FLOAT
:

5337 
JSBigFlﬂt
 *
bf
 = 
	`JS_VALUE_GET_PTR
(
v
);

5338 
	`bf_dñëe
(&
bf
->
num
);

5339 
	`js_‰ì_π
(
π
, 
bf
);

5342 
JS_TAG_BIG_DECIMAL
:

5344 
JSBigDecimÆ
 *
bf
 = 
	`JS_VALUE_GET_PTR
(
v
);

5345 
	`bfdec_dñëe
(&
bf
->
num
);

5346 
	`js_‰ì_π
(
π
, 
bf
);

5350 
JS_TAG_SYMBOL
:

5352 
JSAtomSåu˘
 *
p
 = 
	`JS_VALUE_GET_PTR
(
v
);

5353 
	`JS_FªeAtomSåu˘
(
π
, 
p
);

5357 
	`¥ötf
("__JS_FªeVÆue: unknow¿èg=%d\n", 
èg
);

5358 
	`ab‹t
();

5360 
	}
}

5362 
	$__JS_FªeVÆue
(
JSC⁄ãxt
 *
˘x
, 
JSVÆue
 
v
)

5364 
	`__JS_FªeVÆueRT
(
˘x
->
π
, 
v
);

5365 
	}
}

5369 
	$add_gc_obje˘
(
JSRu¡ime
 *
π
, 
JSGCObje˘Hódî
 *
h
,

5370 
JSGCObje˘Ty≥Enum
 
ty≥
)

5372 
h
->
m¨k
 = 0;

5373 
h
->
gc_obj_ty≥
 = 
ty≥
;

5374 
	`li°_add_èû
(&
h
->
lök
, &
π
->
gc_obj_li°
);

5375 
	}
}

5377 
	$ªmove_gc_obje˘
(
JSGCObje˘Hódî
 *
h
)

5379 
	`li°_dñ
(&
h
->
lök
);

5380 
	}
}

5382 
	$JS_M¨kVÆue
(
JSRu¡ime
 *
π
, 
JSVÆueC⁄°
 
vÆ
, 
JS_M¨kFunc
 *
m¨k_func
)

5384 i‡(
	`JS_VALUE_HAS_REF_COUNT
(
vÆ
)) {

5385 
	`JS_VALUE_GET_TAG
(
vÆ
)) {

5386 
JS_TAG_OBJECT
:

5387 
JS_TAG_FUNCTION_BYTECODE
:

5388 
	`m¨k_func
(
π
, 
	`JS_VALUE_GET_PTR
(
vÆ
));

5394 
	}
}

5396 
	$m¨k_chûdªn
(
JSRu¡ime
 *
π
, 
JSGCObje˘Hódî
 *
gp
,

5397 
JS_M¨kFunc
 *
m¨k_func
)

5399 
gp
->
gc_obj_ty≥
) {

5400 
JS_GC_OBJ_TYPE_JS_OBJECT
:

5402 
JSObje˘
 *
p
 = (JSObje˘ *)
gp
;

5403 
JSSh≠ePr›îty
 *
¥s
;

5404 
JSSh≠e
 *
sh
;

5405 
i
;

5406 
sh
 = 
p
->
sh≠e
;

5407 
	`m¨k_func
(
π
, &
sh
->
hódî
);

5409 
¥s
 = 
	`gë_sh≠e_¥›
(
sh
);

5410 
i
 = 0; i < 
sh
->
¥›_cou¡
; i++) {

5411 
JSPr›îty
 *
¥
 = &
p
->
¥›
[
i
];

5412 i‡(
¥s
->
©om
 !
JS_ATOM_NULL
) {

5413 i‡(
¥s
->
Êags
 & 
JS_PROP_TMASK
) {

5414 i‡((
¥s
->
Êags
 & 
JS_PROP_TMASK
Ë=
JS_PROP_GETSET
) {

5415 i‡(
¥
->
u
.
gë£t
.
gëãr
)

5416 
	`m¨k_func
(
π
, &
¥
->
u
.
gë£t
.
gëãr
->
hódî
);

5417 i‡(
¥
->
u
.
gë£t
.
£âî
)

5418 
	`m¨k_func
(
π
, &
¥
->
u
.
gë£t
.
£âî
->
hódî
);

5419 } i‡((
¥s
->
Êags
 & 
JS_PROP_TMASK
Ë=
JS_PROP_VARREF
) {

5420 i‡(
¥
->
u
.
v¨_ªf
->
is_dëached
) {

5423 
	`m¨k_func
(
π
, &
¥
->
u
.
v¨_ªf
->
hódî
);

5425 } i‡((
¥s
->
Êags
 & 
JS_PROP_TMASK
Ë=
JS_PROP_AUTOINIT
) {

5426 
	`js_autoöô_m¨k
(
π
, 
¥
, 
m¨k_func
);

5429 
	`JS_M¨kVÆue
(
π
, 
¥
->
u
.
vÆue
, 
m¨k_func
);

5432 
¥s
++;

5435 i‡(
p
->
˛ass_id
 !
JS_CLASS_OBJECT
) {

5436 
JSCœssGCM¨k
 *
gc_m¨k
;

5437 
gc_m¨k
 = 
π
->
˛ass_¨øy
[
p
->
˛ass_id
].gc_mark;

5438 i‡(
gc_m¨k
)

5439 
	`gc_m¨k
(
π
, 
	`JS_MKPTR
(
JS_TAG_OBJECT
, 
p
), 
m¨k_func
);

5443 
JS_GC_OBJ_TYPE_FUNCTION_BYTECODE
:

5446 
JSFun˘i⁄Byãcode
 *
b
 = (JSFun˘i⁄Byãcodê*)
gp
;

5447 
i
;

5448 
i
 = 0; i < 
b
->
˝oﬁ_cou¡
; i++) {

5449 
	`JS_M¨kVÆue
(
π
, 
b
->
˝oﬁ
[
i
], 
m¨k_func
);

5451 i‡(
b
->
ªÆm
)

5452 
	`m¨k_func
(
π
, &
b
->
ªÆm
->
hódî
);

5455 
JS_GC_OBJ_TYPE_VAR_REF
:

5457 
JSV¨Ref
 *
v¨_ªf
 = (JSV¨Re‡*)
gp
;

5459 
	`as£π
(
v¨_ªf
->
is_dëached
);

5460 
	`JS_M¨kVÆue
(
π
, *
v¨_ªf
->
pvÆue
, 
m¨k_func
);

5463 
JS_GC_OBJ_TYPE_ASYNC_FUNCTION
:

5465 
JSAsyncFun˘i⁄D©a
 *
s
 = (JSAsyncFun˘i⁄D©®*)
gp
;

5466 i‡(
s
->
is_a˘ive
)

5467 
	`async_func_m¨k
(
π
, &
s
->
func_°©e
, 
m¨k_func
);

5468 
	`JS_M¨kVÆue
(
π
, 
s
->
ªsﬁvög_funcs
[0], 
m¨k_func
);

5469 
	`JS_M¨kVÆue
(
π
, 
s
->
ªsﬁvög_funcs
[1], 
m¨k_func
);

5472 
JS_GC_OBJ_TYPE_SHAPE
:

5474 
JSSh≠e
 *
sh
 = (JSSh≠ê*)
gp
;

5475 i‡(
sh
->
¥Ÿo
 !
NULL
) {

5476 
	`m¨k_func
(
π
, &
sh
->
¥Ÿo
->
hódî
);

5480 
JS_GC_OBJ_TYPE_JS_CONTEXT
:

5482 
JSC⁄ãxt
 *
˘x
 = (JSC⁄ãxà*)
gp
;

5483 
	`JS_M¨kC⁄ãxt
(
π
, 
˘x
, 
m¨k_func
);

5487 
	`ab‹t
();

5489 
	}
}

5491 
	$gc_de¸ef_chûd
(
JSRu¡ime
 *
π
, 
JSGCObje˘Hódî
 *
p
)

5493 
	`as£π
(
p
->
ªf_cou¡
 > 0);

5494 
p
->
ªf_cou¡
--;

5495 i‡(
p
->
ªf_cou¡
 =0 &&Ö->
m¨k
 == 1) {

5496 
	`li°_dñ
(&
p
->
lök
);

5497 
	`li°_add_èû
(&
p
->
lök
, &
π
->
tmp_obj_li°
);

5499 
	}
}

5501 
	$gc_de¸ef
(
JSRu¡ime
 *
π
)

5503 
li°_hód
 *
ñ
, *
ñ1
;

5504 
JSGCObje˘Hódî
 *
p
;

5506 
	`öô_li°_hód
(&
π
->
tmp_obj_li°
);

5511 
	`li°_f‹_óch_ß„
(
ñ
, 
ñ1
, &
π
->
gc_obj_li°
) {

5512 
p
 = 
	`li°_íåy
(
ñ
, 
JSGCObje˘Hódî
, 
lök
);

5513 
	`as£π
(
p
->
m¨k
 == 0);

5514 
	`m¨k_chûdªn
(
π
, 
p
, 
gc_de¸ef_chûd
);

5515 
p
->
m¨k
 = 1;

5516 i‡(
p
->
ªf_cou¡
 == 0) {

5517 
	`li°_dñ
(&
p
->
lök
);

5518 
	`li°_add_èû
(&
p
->
lök
, &
π
->
tmp_obj_li°
);

5521 
	}
}

5523 
	$gc_sˇn_ö¸ef_chûd
(
JSRu¡ime
 *
π
, 
JSGCObje˘Hódî
 *
p
)

5525 
p
->
ªf_cou¡
++;

5526 i‡(
p
->
ªf_cou¡
 == 1) {

5529 
	`li°_dñ
(&
p
->
lök
);

5530 
	`li°_add_èû
(&
p
->
lök
, &
π
->
gc_obj_li°
);

5531 
p
->
m¨k
 = 0;

5533 
	}
}

5535 
	$gc_sˇn_ö¸ef_chûd2
(
JSRu¡ime
 *
π
, 
JSGCObje˘Hódî
 *
p
)

5537 
p
->
ªf_cou¡
++;

5538 
	}
}

5540 
	$gc_sˇn
(
JSRu¡ime
 *
π
)

5542 
li°_hód
 *
ñ
;

5543 
JSGCObje˘Hódî
 *
p
;

5546 
	`li°_f‹_óch
(
ñ
, &
π
->
gc_obj_li°
) {

5547 
p
 = 
	`li°_íåy
(
ñ
, 
JSGCObje˘Hódî
, 
lök
);

5548 
	`as£π
(
p
->
ªf_cou¡
 > 0);

5549 
p
->
m¨k
 = 0;

5550 
	`m¨k_chûdªn
(
π
, 
p
, 
gc_sˇn_ö¸ef_chûd
);

5554 
	`li°_f‹_óch
(
ñ
, &
π
->
tmp_obj_li°
) {

5555 
p
 = 
	`li°_íåy
(
ñ
, 
JSGCObje˘Hódî
, 
lök
);

5556 
	`m¨k_chûdªn
(
π
, 
p
, 
gc_sˇn_ö¸ef_chûd2
);

5558 
	}
}

5560 
	$gc_‰ì_cy˛es
(
JSRu¡ime
 *
π
)

5562 
li°_hód
 *
ñ
, *
ñ1
;

5563 
JSGCObje˘Hódî
 *
p
;

5564 #ifde‡
DUMP_GC_FREE


5565 
BOOL
 
hódî_d⁄e
 = 
FALSE
;

5568 
π
->
gc_pha£
 = 
JS_GC_PHASE_REMOVE_CYCLES
;

5571 
ñ
 = 
π
->
tmp_obj_li°
.
√xt
;

5572 i‡(
ñ
 =&
π
->
tmp_obj_li°
)

5574 
p
 = 
	`li°_íåy
(
ñ
, 
JSGCObje˘Hódî
, 
lök
);

5578 
p
->
gc_obj_ty≥
) {

5579 
JS_GC_OBJ_TYPE_JS_OBJECT
:

5580 
JS_GC_OBJ_TYPE_FUNCTION_BYTECODE
:

5581 #ifde‡
DUMP_GC_FREE


5582 i‡(!
hódî_d⁄e
) {

5583 
	`¥ötf
("Freeing cycles:\n");

5584 
	`JS_DumpObje˘Hódî
(
π
);

5585 
hódî_d⁄e
 = 
TRUE
;

5587 
	`JS_DumpGCObje˘
(
π
, 
p
);

5589 
	`‰ì_gc_obje˘
(
π
, 
p
);

5592 
	`li°_dñ
(&
p
->
lök
);

5593 
	`li°_add_èû
(&
p
->
lök
, &
π
->
gc_zîo_ªf_cou¡_li°
);

5597 
π
->
gc_pha£
 = 
JS_GC_PHASE_NONE
;

5599 
	`li°_f‹_óch_ß„
(
ñ
, 
ñ1
, &
π
->
gc_zîo_ªf_cou¡_li°
) {

5600 
p
 = 
	`li°_íåy
(
ñ
, 
JSGCObje˘Hódî
, 
lök
);

5601 
	`as£π
(
p
->
gc_obj_ty≥
 =
JS_GC_OBJ_TYPE_JS_OBJECT
 ||

5602 
p
->
gc_obj_ty≥
 =
JS_GC_OBJ_TYPE_FUNCTION_BYTECODE
);

5603 
	`js_‰ì_π
(
π
, 
p
);

5606 
	`öô_li°_hód
(&
π
->
gc_zîo_ªf_cou¡_li°
);

5607 
	}
}

5609 
	$JS_RunGC
(
JSRu¡ime
 *
π
)

5613 
	`gc_de¸ef
(
π
);

5616 
	`gc_sˇn
(
π
);

5619 
	`gc_‰ì_cy˛es
(
π
);

5620 
	}
}

5625 
BOOL
 
	$JS_IsLiveObje˘
(
JSRu¡ime
 *
π
, 
JSVÆueC⁄°
 
obj
)

5627 
JSObje˘
 *
p
;

5628 i‡(!
	`JS_IsObje˘
(
obj
))

5629  
FALSE
;

5630 
p
 = 
	`JS_VALUE_GET_OBJ
(
obj
);

5631  !
p
->
‰ì_m¨k
;

5632 
	}
}

5636 
	sJSMem‹yUßge_hñ≥r
 {

5637 
	mmem‹y_u£d_cou¡
;

5638 
	m°r_cou¡
;

5639 
	m°r_size
;

5640 
söt64_t
 
	mjs_func_cou¡
;

5641 
	mjs_func_size
;

5642 
söt64_t
 
	mjs_func_code_size
;

5643 
söt64_t
 
	mjs_func_pc2löe_cou¡
;

5644 
söt64_t
 
	mjs_func_pc2löe_size
;

5645 } 
	tJSMem‹yUßge_hñ≥r
;

5647 
compuã_vÆue_size
(
JSVÆueC⁄°
 
vÆ
, 
JSMem‹yUßge_hñ≥r
 *
hp
);

5649 
	$compuã_js°rög_size
(
JSSåög
 *
°r
, 
JSMem‹yUßge_hñ≥r
 *
hp
)

5651 i‡(!
°r
->
©om_ty≥
) {

5652 
s_ªf_cou¡
 = 
°r
->
hódî
.
ªf_cou¡
;

5653 
hp
->
°r_cou¡
 +1 / 
s_ªf_cou¡
;

5654 
hp
->
°r_size
 +(((*
°r
Ë+ (°r->
Àn
 << så->
is_wide_ch¨
) +

5655 1 - 
°r
->
is_wide_ch¨
Ë/ 
s_ªf_cou¡
);

5657 
	}
}

5659 
	$compuã_byãcode_size
(
JSFun˘i⁄Byãcode
 *
b
, 
JSMem‹yUßge_hñ≥r
 *
hp
)

5661 
mem‹y_u£d_cou¡
, 
js_func_size
, 
i
;

5663 
mem‹y_u£d_cou¡
 = 0;

5664 
js_func_size
 = 
	`off£tof
(
JSFun˘i⁄Byãcode
, 
debug
);

5665 i‡(
b
->
v¨defs
) {

5666 
js_func_size
 +(
b
->
¨g_cou¡
 + b->
v¨_cou¡
Ë* (*b->
v¨defs
);

5668 i‡(
b
->
˝oﬁ
) {

5669 
js_func_size
 +
b
->
˝oﬁ_cou¡
 * (*b->
˝oﬁ
);

5670 
i
 = 0; i < 
b
->
˝oﬁ_cou¡
; i++) {

5671 
JSVÆueC⁄°
 
vÆ
 = 
b
->
˝oﬁ
[
i
];

5672 
	`compuã_vÆue_size
(
vÆ
, 
hp
);

5675 i‡(
b
->
˛osuª_v¨
) {

5676 
js_func_size
 +
b
->
˛osuª_v¨_cou¡
 * (*b->
˛osuª_v¨
);

5678 i‡(!
b
->
ªad_⁄ly_byãcode
 && b->
byã_code_buf
) {

5679 
hp
->
js_func_code_size
 +
b
->
byã_code_Àn
;

5681 i‡(
b
->
has_debug
) {

5682 
js_func_size
 +(*
b
Ë- 
	`off£tof
(
JSFun˘i⁄Byãcode
, 
debug
);

5683 i‡(
b
->
debug
.
sour˚
) {

5684 
mem‹y_u£d_cou¡
++;

5685 
js_func_size
 +
b
->
debug
.
sour˚_Àn
 + 1;

5687 i‡(
b
->
debug
.
pc2löe_Àn
) {

5688 
mem‹y_u£d_cou¡
++;

5689 
hp
->
js_func_pc2löe_cou¡
 += 1;

5690 
hp
->
js_func_pc2löe_size
 +
b
->
debug
.
pc2löe_Àn
;

5693 
hp
->
js_func_size
 += js_func_size;

5694 
hp
->
js_func_cou¡
 += 1;

5695 
hp
->
mem‹y_u£d_cou¡
 += memory_used_count;

5696 
	}
}

5698 
	$compuã_vÆue_size
(
JSVÆueC⁄°
 
vÆ
, 
JSMem‹yUßge_hñ≥r
 *
hp
)

5700 
	`JS_VALUE_GET_TAG
(
vÆ
)) {

5701 
JS_TAG_STRING
:

5702 
	`compuã_js°rög_size
(
	`JS_VALUE_GET_STRING
(
vÆ
), 
hp
);

5704 #ifde‡
CONFIG_BIGNUM


5705 
JS_TAG_BIG_INT
:

5706 
JS_TAG_BIG_FLOAT
:

5707 
JS_TAG_BIG_DECIMAL
:

5712 
	}
}

5714 
	$JS_CompuãMem‹yUßge
(
JSRu¡ime
 *
π
, 
JSMem‹yUßge
 *
s
)

5716 
li°_hód
 *
ñ
, *
ñ1
;

5717 
i
;

5718 
JSMem‹yUßge_hñ≥r
 
mem
 = { 0 }, *
hp
 = &mem;

5720 
	`mem£t
(
s
, 0, (*s));

5721 
s
->
mÆloc_cou¡
 = 
π
->
mÆloc_°©e
.malloc_count;

5722 
s
->
mÆloc_size
 = 
π
->
mÆloc_°©e
.malloc_size;

5723 
s
->
mÆloc_limô
 = 
π
->
mÆloc_°©e
.malloc_limit;

5725 
s
->
mem‹y_u£d_cou¡
 = 2;

5726 
s
->
mem‹y_u£d_size
 = (
JSRu¡ime
Ë+ (
JSVÆue
Ë* 
π
->
˛ass_cou¡
;

5728 
	`li°_f‹_óch
(
ñ
, &
π
->
c⁄ãxt_li°
) {

5729 
JSC⁄ãxt
 *
˘x
 = 
	`li°_íåy
(
ñ
, JSC⁄ãxt, 
lök
);

5730 
JSSh≠e
 *
sh
 = 
˘x
->
¨øy_sh≠e
;

5731 
s
->
mem‹y_u£d_cou¡
 += 2;

5732 
s
->
mem‹y_u£d_size
 +(
JSC⁄ãxt
) +

5733 (
JSVÆue
Ë* 
π
->
˛ass_cou¡
;

5734 
s
->
bö¨y_obje˘_cou¡
 +
˘x
->binary_object_count;

5735 
s
->
bö¨y_obje˘_size
 +
˘x
->binary_object_size;

5738 i‡(
sh
 && !sh->
is_hashed
) {

5739 
hash_size
 = 
sh
->
¥›_hash_mask
 + 1;

5740 
s
->
sh≠e_cou¡
++;

5741 
s
->
sh≠e_size
 +
	`gë_sh≠e_size
(
hash_size
, 
sh
->
¥›_size
);

5743 
	`li°_f‹_óch
(
ñ1
, &
˘x
->
lﬂded_moduÀs
) {

5744 
JSModuÀDef
 *
m
 = 
	`li°_íåy
(
ñ1
, JSModuÀDef, 
lök
);

5745 
s
->
mem‹y_u£d_cou¡
 += 1;

5746 
s
->
mem‹y_u£d_size
 +(*
m
);

5747 i‡(
m
->
ªq_moduÀ_íåõs
) {

5748 
s
->
mem‹y_u£d_cou¡
 += 1;

5749 
s
->
mem‹y_u£d_size
 +
m
->
ªq_moduÀ_íåõs_cou¡
 * (*m->
ªq_moduÀ_íåõs
);

5751 i‡(
m
->
exp‹t_íåõs
) {

5752 
s
->
mem‹y_u£d_cou¡
 += 1;

5753 
s
->
mem‹y_u£d_size
 +
m
->
exp‹t_íåõs_cou¡
 * (*m->
exp‹t_íåõs
);

5754 
i
 = 0; i < 
m
->
exp‹t_íåõs_cou¡
; i++) {

5755 
JSExp‹tE¡ry
 *
me
 = &
m
->
exp‹t_íåõs
[
i
];

5756 i‡(
me
->
exp‹t_ty≥
 =
JS_EXPORT_TYPE_LOCAL
 && me->
u
.
loˇl
.
v¨_ªf
) {

5758 
s
->
mem‹y_u£d_cou¡
 += 1;

5759 
	`compuã_vÆue_size
(
me
->
u
.
loˇl
.
v¨_ªf
->
vÆue
, 
hp
);

5763 i‡(
m
->
°¨_exp‹t_íåõs
) {

5764 
s
->
mem‹y_u£d_cou¡
 += 1;

5765 
s
->
mem‹y_u£d_size
 +
m
->
°¨_exp‹t_íåõs_cou¡
 * (*m->
°¨_exp‹t_íåõs
);

5767 i‡(
m
->
imp‹t_íåõs
) {

5768 
s
->
mem‹y_u£d_cou¡
 += 1;

5769 
s
->
mem‹y_u£d_size
 +
m
->
imp‹t_íåõs_cou¡
 * (*m->
imp‹t_íåõs
);

5771 
	`compuã_vÆue_size
(
m
->
moduÀ_ns
, 
hp
);

5772 
	`compuã_vÆue_size
(
m
->
func_obj
, 
hp
);

5776 
	`li°_f‹_óch
(
ñ
, &
π
->
gc_obj_li°
) {

5777 
JSGCObje˘Hódî
 *
gp
 = 
	`li°_íåy
(
ñ
, JSGCObje˘Hódî, 
lök
);

5778 
JSObje˘
 *
p
;

5779 
JSSh≠e
 *
sh
;

5780 
JSSh≠ePr›îty
 *
¥s
;

5783 i‡(
gp
->
gc_obj_ty≥
 =
JS_GC_OBJ_TYPE_FUNCTION_BYTECODE
) {

5784 
	`compuã_byãcode_size
((
JSFun˘i⁄Byãcode
 *)
gp
, 
hp
);

5786 } i‡(
gp
->
gc_obj_ty≥
 !
JS_GC_OBJ_TYPE_JS_OBJECT
) {

5789 
p
 = (
JSObje˘
 *)
gp
;

5790 
sh
 = 
p
->
sh≠e
;

5791 
s
->
obj_cou¡
++;

5792 i‡(
p
->
¥›
) {

5793 
s
->
mem‹y_u£d_cou¡
++;

5794 
s
->
¥›_size
 +
sh
->¥›_sizê* (*
p
->
¥›
);

5795 
s
->
¥›_cou¡
 +
sh
->prop_count;

5796 
¥s
 = 
	`gë_sh≠e_¥›
(
sh
);

5797 
i
 = 0; i < 
sh
->
¥›_cou¡
; i++) {

5798 
JSPr›îty
 *
¥
 = &
p
->
¥›
[
i
];

5799 i‡(
¥s
->
©om
 !
JS_ATOM_NULL
 && !’rs->
Êags
 & 
JS_PROP_TMASK
)) {

5800 
	`compuã_vÆue_size
(
¥
->
u
.
vÆue
, 
hp
);

5802 
¥s
++;

5806 i‡(!
sh
->
is_hashed
) {

5807 
hash_size
 = 
sh
->
¥›_hash_mask
 + 1;

5808 
s
->
sh≠e_cou¡
++;

5809 
s
->
sh≠e_size
 +
	`gë_sh≠e_size
(
hash_size
, 
sh
->
¥›_size
);

5812 
p
->
˛ass_id
) {

5813 
JS_CLASS_ARRAY
:

5814 
JS_CLASS_ARGUMENTS
:

5815 
s
->
¨øy_cou¡
++;

5816 i‡(
p
->
Á°_¨øy
) {

5817 
s
->
Á°_¨øy_cou¡
++;

5818 i‡(
p
->
u
.
¨øy
.u.
vÆues
) {

5819 
s
->
mem‹y_u£d_cou¡
++;

5820 
s
->
mem‹y_u£d_size
 +
p
->
u
.
¨øy
.
cou¡
 *

5821 (*
p
->
u
.
¨øy
.u.
vÆues
);

5822 
s
->
Á°_¨øy_ñemíts
 +
p
->
u
.
¨øy
.
cou¡
;

5823 
i
 = 0; i < 
p
->
u
.
¨øy
.
cou¡
; i++) {

5824 
	`compuã_vÆue_size
(
p
->
u
.
¨øy
.u.
vÆues
[
i
], 
hp
);

5829 
JS_CLASS_NUMBER
:

5830 
JS_CLASS_STRING
:

5831 
JS_CLASS_BOOLEAN
:

5832 
JS_CLASS_SYMBOL
:

5833 
JS_CLASS_DATE
:

5834 #ifde‡
CONFIG_BIGNUM


5835 
JS_CLASS_BIG_INT
:

5836 
JS_CLASS_BIG_FLOAT
:

5837 
JS_CLASS_BIG_DECIMAL
:

5839 
	`compuã_vÆue_size
(
p
->
u
.
obje˘_d©a
, 
hp
);

5841 
JS_CLASS_C_FUNCTION
:

5842 
s
->
c_func_cou¡
++;

5844 
JS_CLASS_BYTECODE_FUNCTION
:

5846 
JSFun˘i⁄Byãcode
 *
b
 = 
p
->
u
.
func
.
fun˘i⁄_byãcode
;

5847 
JSV¨Ref
 **
v¨_ªfs
 = 
p
->
u
.
func
.var_refs;

5849 i‡(
v¨_ªfs
) {

5850 
s
->
mem‹y_u£d_cou¡
++;

5851 
s
->
js_func_size
 +
b
->
˛osuª_v¨_cou¡
 * (*
v¨_ªfs
);

5852 
i
 = 0; i < 
b
->
˛osuª_v¨_cou¡
; i++) {

5853 i‡(
v¨_ªfs
[
i
]) {

5854 
ªf_cou¡
 = 
v¨_ªfs
[
i
]->
hódî
.ref_count;

5855 
s
->
mem‹y_u£d_cou¡
 +1 / 
ªf_cou¡
;

5856 
s
->
js_func_size
 +(*
v¨_ªfs
[
i
]Ë/ 
ªf_cou¡
;

5858 i‡(
v¨_ªfs
[
i
]->
pvÆue
 =&v¨_ªfs[i]->
vÆue
) {

5860 
	`compuã_vÆue_size
(
v¨_ªfs
[
i
]->
vÆue
, 
hp
);

5867 
JS_CLASS_BOUND_FUNCTION
:

5869 
JSBoundFun˘i⁄
 *
bf
 = 
p
->
u
.
bound_fun˘i⁄
;

5871 
i
 = 0; i < 
bf
->
¨gc
; i++) {

5872 
	`compuã_vÆue_size
(
bf
->
¨gv
[
i
], 
hp
);

5874 
s
->
mem‹y_u£d_cou¡
 += 1;

5875 
s
->
mem‹y_u£d_size
 +(*
bf
Ë+ bf->
¨gc
 * (*bf->
¨gv
);

5878 
JS_CLASS_C_FUNCTION_DATA
:

5880 
JSCFun˘i⁄D©aRec‹d
 *
fd
 = 
p
->
u
.
c_fun˘i⁄_d©a_ªc‹d
;

5881 i‡(
fd
) {

5882 
i
 = 0; i < 
fd
->
d©a_Àn
; i++) {

5883 
	`compuã_vÆue_size
(
fd
->
d©a
[
i
], 
hp
);

5885 
s
->
mem‹y_u£d_cou¡
 += 1;

5886 
s
->
mem‹y_u£d_size
 +(*
fd
Ë+ fd->
d©a_Àn
 * (*fd->
d©a
);

5890 
JS_CLASS_REGEXP
:

5891 
	`compuã_js°rög_size
(
p
->
u
.
ªgexp
.
∑âîn
, 
hp
);

5892 
	`compuã_js°rög_size
(
p
->
u
.
ªgexp
.
byãcode
, 
hp
);

5895 
JS_CLASS_FOR_IN_ITERATOR
:

5897 
JSF‹InIãøt‹
 *
ô
 = 
p
->
u
.
f‹_ö_ôî©‹
;

5898 i‡(
ô
) {

5899 
	`compuã_vÆue_size
(
ô
->
obj
, 
hp
);

5900 
s
->
mem‹y_u£d_cou¡
 += 1;

5901 
s
->
mem‹y_u£d_size
 +(*
ô
);

5905 
JS_CLASS_ARRAY_BUFFER
:

5906 
JS_CLASS_SHARED_ARRAY_BUFFER
:

5908 
JSAºayBuf„r
 *
abuf
 = 
p
->
u
.
¨øy_buf„r
;

5909 i‡(
abuf
) {

5910 
s
->
mem‹y_u£d_cou¡
 += 1;

5911 
s
->
mem‹y_u£d_size
 +(*
abuf
);

5912 i‡(
abuf
->
d©a
) {

5913 
s
->
mem‹y_u£d_cou¡
 += 1;

5914 
s
->
mem‹y_u£d_size
 +
abuf
->
byã_Àngth
;

5919 
JS_CLASS_GENERATOR
:

5920 
JS_CLASS_UINT8C_ARRAY
:

5921 
JS_CLASS_INT8_ARRAY
:

5922 
JS_CLASS_UINT8_ARRAY
:

5923 
JS_CLASS_INT16_ARRAY
:

5924 
JS_CLASS_UINT16_ARRAY
:

5925 
JS_CLASS_INT32_ARRAY
:

5926 
JS_CLASS_UINT32_ARRAY
:

5927 #ifde‡
CONFIG_BIGNUM


5928 
JS_CLASS_BIG_INT64_ARRAY
:

5929 
JS_CLASS_BIG_UINT64_ARRAY
:

5931 
JS_CLASS_FLOAT32_ARRAY
:

5932 
JS_CLASS_FLOAT64_ARRAY
:

5933 
JS_CLASS_DATAVIEW
:

5934 #ifde‡
CONFIG_BIGNUM


5935 
JS_CLASS_FLOAT_ENV
:

5937 
JS_CLASS_MAP
:

5938 
JS_CLASS_SET
:

5939 
JS_CLASS_WEAKMAP
:

5940 
JS_CLASS_WEAKSET
:

5941 
JS_CLASS_MAP_ITERATOR
:

5942 
JS_CLASS_SET_ITERATOR
:

5943 
JS_CLASS_ARRAY_ITERATOR
:

5944 
JS_CLASS_STRING_ITERATOR
:

5945 
JS_CLASS_PROXY
:

5946 
JS_CLASS_PROMISE
:

5947 
JS_CLASS_PROMISE_RESOLVE_FUNCTION
:

5948 
JS_CLASS_PROMISE_REJECT_FUNCTION
:

5949 
JS_CLASS_ASYNC_FUNCTION_RESOLVE
:

5950 
JS_CLASS_ASYNC_FUNCTION_REJECT
:

5951 
JS_CLASS_ASYNC_FROM_SYNC_ITERATOR
:

5952 
JS_CLASS_ASYNC_GENERATOR
:

5956 i‡(
p
->
u
.
›aque
) {

5957 
s
->
mem‹y_u£d_cou¡
 += 1;

5962 
s
->
obj_size
 +s->
obj_cou¡
 * (
JSObje˘
);

5965 
s
->
mem‹y_u£d_cou¡
++;

5966 
s
->
mem‹y_u£d_size
 +(
π
->
sh≠e_hash
[0]Ë*Ñt->
sh≠e_hash_size
;

5967 
i
 = 0; i < 
π
->
sh≠e_hash_size
; i++) {

5968 
JSSh≠e
 *
sh
;

5969 
sh
 = 
π
->
sh≠e_hash
[
i
]; sh !
NULL
; sh = sh->
sh≠e_hash_√xt
) {

5970 
hash_size
 = 
sh
->
¥›_hash_mask
 + 1;

5971 
s
->
sh≠e_cou¡
++;

5972 
s
->
sh≠e_size
 +
	`gë_sh≠e_size
(
hash_size
, 
sh
->
¥›_size
);

5977 
s
->
mem‹y_u£d_cou¡
 += 2;

5978 
s
->
©om_cou¡
 = 
π
->atom_count;

5979 
s
->
©om_size
 = (
π
->
©om_¨øy
[0]) *Ñt->atom_size +

5980 (
π
->
©om_hash
[0]Ë*Ñt->
©om_hash_size
;

5981 
i
 = 0; i < 
π
->
©om_size
; i++) {

5982 
JSAtomSåu˘
 *
p
 = 
π
->
©om_¨øy
[
i
];

5983 i‡(!
	`©om_is_‰ì
(
p
)) {

5984 
s
->
©om_size
 +((*
p
Ë+ (p->
Àn
 <<Ö->
is_wide_ch¨
) +

5985 1 - 
p
->
is_wide_ch¨
);

5988 
s
->
°r_cou¡
 = 
	`round
(
mem
.str_count);

5989 
s
->
°r_size
 = 
	`round
(
mem
.str_size);

5990 
s
->
js_func_cou¡
 = 
mem
.js_func_count;

5991 
s
->
js_func_size
 = 
	`round
(
mem
.js_func_size);

5992 
s
->
js_func_code_size
 = 
mem
.js_func_code_size;

5993 
s
->
js_func_pc2löe_cou¡
 = 
mem
.js_func_pc2line_count;

5994 
s
->
js_func_pc2löe_size
 = 
mem
.js_func_pc2line_size;

5995 
s
->
mem‹y_u£d_cou¡
 +
	`round
(
mem
.memory_used_count) +

5996 
s
->
©om_cou¡
 + s->
°r_cou¡
 +

5997 
s
->
obj_cou¡
 + s->
sh≠e_cou¡
 +

5998 
s
->
js_func_cou¡
 + s->
js_func_pc2löe_cou¡
;

5999 
s
->
mem‹y_u£d_size
 +s->
©om_size
 + s->
°r_size
 +

6000 
s
->
obj_size
 + s->
¥›_size
 + s->
sh≠e_size
 +

6001 
s
->
js_func_size
 + s->
js_func_code_size
 + s->
js_func_pc2löe_size
;

6002 
	}
}

6004 
	$JS_DumpMem‹yUßge
(
FILE
 *
Â
, c⁄° 
JSMem‹yUßge
 *
s
, 
JSRu¡ime
 *
π
)

6006 
	`Ârötf
(
Â
, "QuickJS memory usage -- "

6007 #ifde‡
CONFIG_BIGNUM


6010 "%†vîsi⁄, %d-bô, mÆlo¯limô: %"
PRId64
"\n\n",

6011 
CONFIG_VERSION
, ()(*Ë* 8, (
söt64_t
)(
ssize_t
)
s
->
mÆloc_limô
);

6013 i‡(
π
) {

6015 c⁄° *
«me
;

6016 
size_t
 
size
;

6017 } 
obje˘_ty≥s
[] = {

6018 { "JSRu¡ime", (
JSRu¡ime
) },

6019 { "JSC⁄ãxt", (
JSC⁄ãxt
) },

6020 { "JSObje˘", (
JSObje˘
) },

6021 { "JSSåög", (
JSSåög
) },

6022 { "JSFun˘i⁄Byãcode", (
JSFun˘i⁄Byãcode
) },

6024 
i
, 
ußge_size_ok
 = 0;

6025 
i
 = 0; i < 
	`cou¡of
(
obje˘_ty≥s
); i++) {

6026 
size
 = 
obje˘_ty≥s
[
i
].size;

6027 *
p
 = 
	`js_mÆloc_π
(
π
, 
size
);

6028 i‡(
p
) {

6029 
size1
 = 
	`js_mÆloc_ußbÀ_size_π
(
π
, 
p
);

6030 i‡(
size1
 >
size
) {

6031 
ußge_size_ok
 = 1;

6032 
	`Ârötf
(
Â
, " %3u + %-2u %s\n",

6033 
size
, 
size1
 - size, 
obje˘_ty≥s
[
i
].
«me
);

6035 
	`js_‰ì_π
(
π
, 
p
);

6038 i‡(!
ußge_size_ok
) {

6039 
	`Ârötf
(
Â
, " malloc_usable_size unavailable\n");

6042 
obj_˛as£s
[
JS_CLASS_INIT_COUNT
 + 1] = { 0 };

6043 
˛ass_id
;

6044 
li°_hód
 *
ñ
;

6045 
	`li°_f‹_óch
(
ñ
, &
π
->
gc_obj_li°
) {

6046 
JSGCObje˘Hódî
 *
gp
 = 
	`li°_íåy
(
ñ
, JSGCObje˘Hódî, 
lök
);

6047 
JSObje˘
 *
p
;

6048 i‡(
gp
->
gc_obj_ty≥
 =
JS_GC_OBJ_TYPE_JS_OBJECT
) {

6049 
p
 = (
JSObje˘
 *)
gp
;

6050 
obj_˛as£s
[
	`mö_uöt32
(
p
->
˛ass_id
, 
JS_CLASS_INIT_COUNT
)]++;

6053 
	`Ârötf
(
Â
, "\n" "JSObject classes\n");

6054 i‡(
obj_˛as£s
[0])

6055 
	`Ârötf
(
Â
, " %5d %2.0d %s\n", 
obj_˛as£s
[0], 0, "none");

6056 
˛ass_id
 = 1; cœss_id < 
JS_CLASS_INIT_COUNT
; class_id++) {

6057 i‡(
obj_˛as£s
[
˛ass_id
]) {

6058 
buf
[
ATOM_GET_STR_BUF_SIZE
];

6059 
	`Ârötf
(
Â
, " %5d %2.0d %s\n", 
obj_˛as£s
[
˛ass_id
], class_id,

6060 
	`JS_AtomGëSåRT
(
π
, 
buf
, (buf), 
js_°d_˛ass_def
[
˛ass_id
 - 1].
˛ass_«me
));

6063 i‡(
obj_˛as£s
[
JS_CLASS_INIT_COUNT
])

6064 
	`Ârötf
(
Â
, " %5d %2.0d %s\n", 
obj_˛as£s
[
JS_CLASS_INIT_COUNT
], 0, "other");

6066 
	`Ârötf
(
Â
, "\n");

6069 
	`Ârötf
(
Â
, "%-20s %8s %8s\n", "NAME", "COUNT", "SIZE");

6071 i‡(
s
->
mÆloc_cou¡
) {

6072 
	`Ârötf
(
Â
, "%-20†%8"
PRId64
" %8"PRId64" (%0.1fÖer block)\n",

6073 "mem‹yáŒoˇãd", 
s
->
mÆloc_cou¡
, s->
mÆloc_size
,

6074 ()
s
->
mÆloc_size
 / s->
mÆloc_cou¡
);

6075 
	`Ârötf
(
Â
, "%-20†%8"
PRId64
" %8"PRId64" (%d overhead, %0.1fáverage slack)\n",

6076 "mem‹y u£d", 
s
->
mem‹y_u£d_cou¡
, s->
mem‹y_u£d_size
,

6077 
MALLOC_OVERHEAD
, (()(
s
->
mÆloc_size
 - s->
mem‹y_u£d_size
) /

6078 
s
->
mem‹y_u£d_cou¡
));

6080 i‡(
s
->
©om_cou¡
) {

6081 
	`Ârötf
(
Â
, "%-20†%8"
PRId64
" %8"PRId64" (%0.1fÖerátom)\n",

6082 "©oms", 
s
->
©om_cou¡
, s->
©om_size
,

6083 ()
s
->
©om_size
 / s->
©om_cou¡
);

6085 i‡(
s
->
°r_cou¡
) {

6086 
	`Ârötf
(
Â
, "%-20†%8"
PRId64
" %8"PRId64" (%0.1fÖer string)\n",

6087 "°rögs", 
s
->
°r_cou¡
, s->
°r_size
,

6088 ()
s
->
°r_size
 / s->
°r_cou¡
);

6090 i‡(
s
->
obj_cou¡
) {

6091 
	`Ârötf
(
Â
, "%-20†%8"
PRId64
" %8"PRId64" (%0.1fÖer object)\n",

6092 "obje˘s", 
s
->
obj_cou¡
, s->
obj_size
,

6093 ()
s
->
obj_size
 / s->
obj_cou¡
);

6094 
	`Ârötf
(
Â
, "%-20†%8"
PRId64
" %8"PRId64" (%0.1fÖer object)\n",

6095 "Ör›îtõs", 
s
->
¥›_cou¡
, s->
¥›_size
,

6096 ()
s
->
¥›_cou¡
 / s->
obj_cou¡
);

6097 
	`Ârötf
(
Â
, "%-20†%8"
PRId64
" %8"PRId64" (%0.1fÖer shape)\n",

6098 " sh≠es", 
s
->
sh≠e_cou¡
, s->
sh≠e_size
,

6099 ()
s
->
sh≠e_size
 / s->
sh≠e_cou¡
);

6101 i‡(
s
->
js_func_cou¡
) {

6102 
	`Ârötf
(
Â
, "%-20†%8"
PRId64
" %8"PRId64"\n",

6103 "byãcodêfun˘i⁄s", 
s
->
js_func_cou¡
, s->
js_func_size
);

6104 
	`Ârötf
(
Â
, "%-20†%8"
PRId64
" %8"PRId64" (%0.1fÖer function)\n",

6105 " byãcode", 
s
->
js_func_cou¡
, s->
js_func_code_size
,

6106 ()
s
->
js_func_code_size
 / s->
js_func_cou¡
);

6107 i‡(
s
->
js_func_pc2löe_cou¡
) {

6108 
	`Ârötf
(
Â
, "%-20†%8"
PRId64
" %8"PRId64" (%0.1fÖer function)\n",

6109 "Öc2löe", 
s
->
js_func_pc2löe_cou¡
,

6110 
s
->
js_func_pc2löe_size
,

6111 ()
s
->
js_func_pc2löe_size
 / s->
js_func_pc2löe_cou¡
);

6114 i‡(
s
->
c_func_cou¡
) {

6115 
	`Ârötf
(
Â
, "%-20†%8"
PRId64
"\n", "C fun˘i⁄s", 
s
->
c_func_cou¡
);

6117 i‡(
s
->
¨øy_cou¡
) {

6118 
	`Ârötf
(
Â
, "%-20†%8"
PRId64
"\n", "¨øys", 
s
->
¨øy_cou¡
);

6119 i‡(
s
->
Á°_¨øy_cou¡
) {

6120 
	`Ârötf
(
Â
, "%-20†%8"
PRId64
"\n", " fa°áºays", 
s
->
Á°_¨øy_cou¡
);

6121 
	`Ârötf
(
Â
, "%-20†%8"
PRId64
" %8"PRId64" (%0.1fÖer fastárray)\n",

6122 "ÉÀmíts", 
s
->
Á°_¨øy_ñemíts
,

6123 
s
->
Á°_¨øy_ñemíts
 * ()(
JSVÆue
),

6124 ()
s
->
Á°_¨øy_ñemíts
 / s->
Á°_¨øy_cou¡
);

6127 i‡(
s
->
bö¨y_obje˘_cou¡
) {

6128 
	`Ârötf
(
Â
, "%-20†%8"
PRId64
" %8"PRId64"\n",

6129 "bö¨y obje˘s", 
s
->
bö¨y_obje˘_cou¡
, s->
bö¨y_obje˘_size
);

6131 
	}
}

6133 
JSVÆue
 
	$JS_GëGlobÆObje˘
(
JSC⁄ãxt
 *
˘x
)

6135  
	`JS_DupVÆue
(
˘x
, ctx->
globÆ_obj
);

6136 
	}
}

6139 
JSVÆue
 
	$JS_Throw
(
JSC⁄ãxt
 *
˘x
, 
JSVÆue
 
obj
)

6141 
JSRu¡ime
 *
π
 = 
˘x
->rt;

6142 
	`JS_FªeVÆue
(
˘x
, 
π
->
cuºít_ex˚±i⁄
);

6143 
π
->
cuºít_ex˚±i⁄
 = 
obj
;

6144  
JS_EXCEPTION
;

6145 
	}
}

6148 
JSVÆue
 
	$JS_GëEx˚±i⁄
(
JSC⁄ãxt
 *
˘x
)

6150 
JSVÆue
 
vÆ
;

6151 
JSRu¡ime
 *
π
 = 
˘x
->rt;

6152 
vÆ
 = 
π
->
cuºít_ex˚±i⁄
;

6153 
π
->
cuºít_ex˚±i⁄
 = 
JS_NULL
;

6154  
vÆ
;

6155 
	}
}

6157 
	$dbuf_put_Àb128
(
DynBuf
 *
s
, 
uöt32_t
 
v
)

6159 
uöt32_t
 
a
;

6161 
a
 = 
v
 & 0x7f;

6162 
v
 >>= 7;

6163 i‡(
v
 != 0) {

6164 
	`dbuf_putc
(
s
, 
a
 | 0x80);

6166 
	`dbuf_putc
(
s
, 
a
);

6170 
	}
}

6172 
	$dbuf_put_¶eb128
(
DynBuf
 *
s
, 
öt32_t
 
v1
)

6174 
uöt32_t
 
v
 = 
v1
;

6175 
	`dbuf_put_Àb128
(
s
, (2 * 
v
) ^ -(v >> 31));

6176 
	}
}

6178 
	$gë_Àb128
(
uöt32_t
 *
pvÆ
, c⁄° 
uöt8_t
 *
buf
,

6179 c⁄° 
uöt8_t
 *
buf_íd
)

6181 c⁄° 
uöt8_t
 *
±r
 = 
buf
;

6182 
uöt32_t
 
v
, 
a
, 
i
;

6183 
v
 = 0;

6184 
i
 = 0; i < 5; i++) {

6185 i‡(
	`u∆ikñy
(
±r
 >
buf_íd
))

6187 
a
 = *
±r
++;

6188 
v
 |(
a
 & 0x7fË<< (
i
 * 7);

6189 i‡(!(
a
 & 0x80)) {

6190 *
pvÆ
 = 
v
;

6191  
±r
 - 
buf
;

6194 *
pvÆ
 = 0;

6196 
	}
}

6198 
	$gë_¶eb128
(
öt32_t
 *
pvÆ
, c⁄° 
uöt8_t
 *
buf
,

6199 c⁄° 
uöt8_t
 *
buf_íd
)

6201 
ªt
;

6202 
uöt32_t
 
vÆ
;

6203 
ªt
 = 
	`gë_Àb128
(&
vÆ
, 
buf
, 
buf_íd
);

6204 i‡(
ªt
 < 0) {

6205 *
pvÆ
 = 0;

6208 *
pvÆ
 = (
vÆ
 >> 1) ^ -(val & 1);

6209  
ªt
;

6210 
	}
}

6212 
	$föd_löe_num
(
JSC⁄ãxt
 *
˘x
, 
JSFun˘i⁄Byãcode
 *
b
,

6213 
uöt32_t
 
pc_vÆue
)

6215 c⁄° 
uöt8_t
 *
p_íd
, *
p
;

6216 
√w_löe_num
, 
löe_num
, 
pc
, 
v
, 
ªt
;

6217 
›
;

6219 i‡(!
b
->
has_debug
 || !b->
debug
.
pc2löe_buf
) {

6224 
p
 = 
b
->
debug
.
pc2löe_buf
;

6225 
p_íd
 = 
p
 + 
b
->
debug
.
pc2löe_Àn
;

6226 
pc
 = 0;

6227 
löe_num
 = 
b
->
debug
.line_num;

6228 
p
 < 
p_íd
) {

6229 
›
 = *
p
++;

6230 i‡(
›
 == 0) {

6231 
uöt32_t
 
vÆ
;

6232 
ªt
 = 
	`gë_Àb128
(&
vÆ
, 
p
, 
p_íd
);

6233 i‡(
ªt
 < 0)

6234 
Áû
;

6235 
pc
 +
vÆ
;

6236 
p
 +
ªt
;

6237 
ªt
 = 
	`gë_¶eb128
(&
v
, 
p
, 
p_íd
);

6238 i‡(
ªt
 < 0) {

6239 
Áû
:

6241  
b
->
debug
.
löe_num
;

6243 
p
 +
ªt
;

6244 
√w_löe_num
 = 
löe_num
 + 
v
;

6246 
›
 -
PC2LINE_OP_FIRST
;

6247 
pc
 +(
›
 / 
PC2LINE_RANGE
);

6248 
√w_löe_num
 = 
löe_num
 + (
›
 % 
PC2LINE_RANGE
Ë+ 
PC2LINE_BASE
;

6250 i‡(
pc_vÆue
 < 
pc
)

6251  
löe_num
;

6252 
löe_num
 = 
√w_löe_num
;

6254  
löe_num
;

6255 
	}
}

6260 c⁄° *
	$gë_func_«me
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
func
)

6262 
JSPr›îty
 *
¥
;

6263 
JSSh≠ePr›îty
 *
¥s
;

6264 
JSVÆueC⁄°
 
vÆ
;

6266 i‡(
	`JS_VALUE_GET_TAG
(
func
Ë!
JS_TAG_OBJECT
)

6267  
NULL
;

6268 
¥s
 = 
	`föd_own_¥›îty
(&
¥
, 
	`JS_VALUE_GET_OBJ
(
func
), 
JS_ATOM_«me
);

6269 i‡(!
¥s
)

6270  
NULL
;

6271 i‡((
¥s
->
Êags
 & 
JS_PROP_TMASK
Ë!
JS_PROP_NORMAL
)

6272  
NULL
;

6273 
vÆ
 = 
¥
->
u
.
vÆue
;

6274 i‡(
	`JS_VALUE_GET_TAG
(
vÆ
Ë!
JS_TAG_STRING
)

6275  
NULL
;

6276  
	`JS_ToCSåög
(
˘x
, 
vÆ
);

6277 
	}
}

6279 
	#JS_BACKTRACE_FLAG_SKIP_FIRST_LEVEL
 (1 << 0)

	)

6281 
	#JS_BACKTRACE_FLAG_SINGLE_LEVEL
 (1 << 1)

	)

6285 
	$buûd_backåa˚
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
îr‹_obj
,

6286 c⁄° *
fûíame
, 
löe_num
,

6287 
backåa˚_Êags
)

6289 
JSSèckFøme
 *
sf
;

6290 
JSVÆue
 
°r
;

6291 
DynBuf
 
dbuf
;

6292 c⁄° *
func_«me_°r
;

6293 c⁄° *
°r1
;

6294 
JSObje˘
 *
p
;

6295 
BOOL
 
backåa˚_b¨rõr
;

6297 
	`js_dbuf_öô
(
˘x
, &
dbuf
);

6298 i‡(
fûíame
) {

6299 
	`dbuf_¥ötf
(&
dbuf
, "áà%s", 
fûíame
);

6300 i‡(
löe_num
 != -1)

6301 
	`dbuf_¥ötf
(&
dbuf
, ":%d", 
löe_num
);

6302 
	`dbuf_putc
(&
dbuf
, '\n');

6303 
°r
 = 
	`JS_NewSåög
(
˘x
, 
fûíame
);

6304 
	`JS_DeföePr›îtyVÆue
(
˘x
, 
îr‹_obj
, 
JS_ATOM_fûeName
, 
°r
,

6305 
JS_PROP_WRITABLE
 | 
JS_PROP_CONFIGURABLE
);

6306 
	`JS_DeföePr›îtyVÆue
(
˘x
, 
îr‹_obj
, 
JS_ATOM_löeNumbî
, 
	`JS_NewI¡32
(˘x, 
löe_num
),

6307 
JS_PROP_WRITABLE
 | 
JS_PROP_CONFIGURABLE
);

6308 i‡(
backåa˚_Êags
 & 
JS_BACKTRACE_FLAG_SINGLE_LEVEL
)

6309 
d⁄e
;

6311 
sf
 = 
˘x
->
π
->
cuºít_°ack_‰ame
; s‡!
NULL
; s‡sf->
¥ev_‰ame
) {

6312 i‡(
backåa˚_Êags
 & 
JS_BACKTRACE_FLAG_SKIP_FIRST_LEVEL
) {

6313 
backåa˚_Êags
 &~
JS_BACKTRACE_FLAG_SKIP_FIRST_LEVEL
;

6316 
func_«me_°r
 = 
	`gë_func_«me
(
˘x
, 
sf
->
cur_func
);

6317 i‡(!
func_«me_°r
 || func_name_str[0] == '\0')

6318 
°r1
 = "<anonymous>";

6320 
°r1
 = 
func_«me_°r
;

6321 
	`dbuf_¥ötf
(&
dbuf
, "áà%s", 
°r1
);

6322 
	`JS_FªeCSåög
(
˘x
, 
func_«me_°r
);

6324 
p
 = 
	`JS_VALUE_GET_OBJ
(
sf
->
cur_func
);

6325 
backåa˚_b¨rõr
 = 
FALSE
;

6326 i‡(
	`js_˛ass_has_byãcode
(
p
->
˛ass_id
)) {

6327 
JSFun˘i⁄Byãcode
 *
b
;

6328 
©om_buf
[
ATOM_GET_STR_BUF_SIZE
];

6329 
löe_num1
;

6331 
b
 = 
p
->
u
.
func
.
fun˘i⁄_byãcode
;

6332 
backåa˚_b¨rõr
 = 
b
->backtrace_barrier;

6333 i‡(
b
->
has_debug
) {

6334 
löe_num1
 = 
	`föd_löe_num
(
˘x
, 
b
,

6335 
sf
->
cur_pc
 - 
b
->
byã_code_buf
 - 1);

6336 
	`dbuf_¥ötf
(&
dbuf
, " (%s",

6337 
	`JS_AtomGëSå
(
˘x
, 
©om_buf
, (atom_buf),

6338 
b
->
debug
.
fûíame
));

6339 i‡(
löe_num1
 != -1)

6340 
	`dbuf_¥ötf
(&
dbuf
, ":%d", 
löe_num1
);

6341 
	`dbuf_putc
(&
dbuf
, ')');

6344 
	`dbuf_¥ötf
(&
dbuf
, " (native)");

6346 
	`dbuf_putc
(&
dbuf
, '\n');

6348 i‡(
backåa˚_b¨rõr
)

6351 
d⁄e
:

6352 
	`dbuf_putc
(&
dbuf
, '\0');

6353 i‡(
	`dbuf_îr‹
(&
dbuf
))

6354 
°r
 = 
JS_NULL
;

6356 
°r
 = 
	`JS_NewSåög
(
˘x
, (*)
dbuf
.
buf
);

6357 
	`dbuf_‰ì
(&
dbuf
);

6358 
	`JS_DeföePr›îtyVÆue
(
˘x
, 
îr‹_obj
, 
JS_ATOM_°ack
, 
°r
,

6359 
JS_PROP_WRITABLE
 | 
JS_PROP_CONFIGURABLE
);

6360 
	}
}

6363 
BOOL
 
	$is_backåa˚_√eded
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
obj
)

6365 
JSObje˘
 *
p
;

6366 i‡(
	`JS_VALUE_GET_TAG
(
obj
Ë!
JS_TAG_OBJECT
)

6367  
FALSE
;

6368 
p
 = 
	`JS_VALUE_GET_OBJ
(
obj
);

6369 i‡(
p
->
˛ass_id
 !
JS_CLASS_ERROR
)

6370  
FALSE
;

6371 i‡(
	`föd_own_¥›îty1
(
p
, 
JS_ATOM_°ack
))

6372  
FALSE
;

6373  
TRUE
;

6374 
	}
}

6376 
JSVÆue
 
	$JS_NewEº‹
(
JSC⁄ãxt
 *
˘x
)

6378  
	`JS_NewObje˘Cœss
(
˘x
, 
JS_CLASS_ERROR
);

6379 
	}
}

6381 
JSVÆue
 
	$JS_ThrowEº‹2
(
JSC⁄ãxt
 *
˘x
, 
JSEº‹Enum
 
îr‹_num
,

6382 c⁄° *
fmt
, 
va_li°
 
≠
, 
BOOL
 
add_backåa˚
)

6384 
buf
[256];

6385 
JSVÆue
 
obj
, 
ªt
;

6387 
	`v¢¥ötf
(
buf
, (buf), 
fmt
, 
≠
);

6388 
obj
 = 
	`JS_NewObje˘PrŸoCœss
(
˘x
, ctx->
«tive_îr‹_¥Ÿo
[
îr‹_num
],

6389 
JS_CLASS_ERROR
);

6390 i‡(
	`u∆ikñy
(
	`JS_IsEx˚±i⁄
(
obj
))) {

6392 
obj
 = 
JS_NULL
;

6394 
	`JS_DeföePr›îtyVÆue
(
˘x
, 
obj
, 
JS_ATOM_mesßge
,

6395 
	`JS_NewSåög
(
˘x
, 
buf
),

6396 
JS_PROP_WRITABLE
 | 
JS_PROP_CONFIGURABLE
);

6398 i‡(
add_backåa˚
) {

6399 
	`buûd_backåa˚
(
˘x
, 
obj
, 
NULL
, 0, 0);

6401 
ªt
 = 
	`JS_Throw
(
˘x
, 
obj
);

6402  
ªt
;

6403 
	}
}

6405 
JSVÆue
 
	$JS_ThrowEº‹
(
JSC⁄ãxt
 *
˘x
, 
JSEº‹Enum
 
îr‹_num
,

6406 c⁄° *
fmt
, 
va_li°
 
≠
)

6408 
JSRu¡ime
 *
π
 = 
˘x
->rt;

6409 
JSSèckFøme
 *
sf
;

6410 
BOOL
 
add_backåa˚
;

6413 
sf
 = 
π
->
cuºít_°ack_‰ame
;

6414 
add_backåa˚
 = !
π
->
ö_out_of_mem‹y
 &&

6415 (!
sf
 || (
	`JS_GëFun˘i⁄Byãcode
(sf->
cur_func
Ë=
NULL
));

6416  
	`JS_ThrowEº‹2
(
˘x
, 
îr‹_num
, 
fmt
, 
≠
, 
add_backåa˚
);

6417 
	}
}

6419 
JSVÆue
 
__©åibuã__
((
	$f‹m©
(
¥ötf
, 2, 3))Ë
	$JS_ThrowSy¡axEº‹
(
JSC⁄ãxt
 *
˘x
, c⁄° *
fmt
, ...)

6421 
JSVÆue
 
vÆ
;

6422 
va_li°
 
≠
;

6424 
	`va_°¨t
(
≠
, 
fmt
);

6425 
vÆ
 = 
	`JS_ThrowEº‹
(
˘x
, 
JS_SYNTAX_ERROR
, 
fmt
, 
≠
);

6426 
	`va_íd
(
≠
);

6427  
vÆ
;

6428 
	}
}

6430 
JSVÆue
 
__©åibuã__
((
	$f‹m©
(
¥ötf
, 2, 3))Ë
	$JS_ThrowTy≥Eº‹
(
JSC⁄ãxt
 *
˘x
, c⁄° *
fmt
, ...)

6432 
JSVÆue
 
vÆ
;

6433 
va_li°
 
≠
;

6435 
	`va_°¨t
(
≠
, 
fmt
);

6436 
vÆ
 = 
	`JS_ThrowEº‹
(
˘x
, 
JS_TYPE_ERROR
, 
fmt
, 
≠
);

6437 
	`va_íd
(
≠
);

6438  
vÆ
;

6439 
	}
}

6441 
__©åibuã__
((
	$f‹m©
(
¥ötf
, 3, 4))Ë
	$JS_ThrowTy≥Eº‹OrFÆ£
(
JSC⁄ãxt
 *
˘x
, 
Êags
, c⁄° *
fmt
, ...)

6443 
va_li°
 
≠
;

6445 i‡((
Êags
 & 
JS_PROP_THROW
) ||

6446 ((
Êags
 & 
JS_PROP_THROW_STRICT
Ë&& 
	`is_°ri˘_mode
(
˘x
))) {

6447 
	`va_°¨t
(
≠
, 
fmt
);

6448 
	`JS_ThrowEº‹
(
˘x
, 
JS_TYPE_ERROR
, 
fmt
, 
≠
);

6449 
	`va_íd
(
≠
);

6452  
FALSE
;

6454 
	}
}

6456 
	$JS_ThrowTy≥Eº‹RódO∆y
(
JSC⁄ãxt
 *
˘x
, 
Êags
, 
JSAtom
 
©om
)

6458 i‡((
Êags
 & 
JS_PROP_THROW
) ||

6459 ((
Êags
 & 
JS_PROP_THROW_STRICT
Ë&& 
	`is_°ri˘_mode
(
˘x
))) {

6460 
buf
[
ATOM_GET_STR_BUF_SIZE
];

6461 
	`JS_ThrowTy≥Eº‹
(
˘x
, "%s isÑead-only",

6462 
	`JS_AtomGëSå
(
˘x
, 
buf
, (buf), 
©om
));

6465  
FALSE
;

6467 
	}
}

6469 
JSVÆue
 
__©åibuã__
((
	$f‹m©
(
¥ötf
, 2, 3))Ë
	$JS_ThrowRe„ªn˚Eº‹
(
JSC⁄ãxt
 *
˘x
, c⁄° *
fmt
, ...)

6471 
JSVÆue
 
vÆ
;

6472 
va_li°
 
≠
;

6474 
	`va_°¨t
(
≠
, 
fmt
);

6475 
vÆ
 = 
	`JS_ThrowEº‹
(
˘x
, 
JS_REFERENCE_ERROR
, 
fmt
, 
≠
);

6476 
	`va_íd
(
≠
);

6477  
vÆ
;

6478 
	}
}

6480 
JSVÆue
 
__©åibuã__
((
	$f‹m©
(
¥ötf
, 2, 3))Ë
	$JS_ThrowR™geEº‹
(
JSC⁄ãxt
 *
˘x
, c⁄° *
fmt
, ...)

6482 
JSVÆue
 
vÆ
;

6483 
va_li°
 
≠
;

6485 
	`va_°¨t
(
≠
, 
fmt
);

6486 
vÆ
 = 
	`JS_ThrowEº‹
(
˘x
, 
JS_RANGE_ERROR
, 
fmt
, 
≠
);

6487 
	`va_íd
(
≠
);

6488  
vÆ
;

6489 
	}
}

6491 
JSVÆue
 
__©åibuã__
((
	$f‹m©
(
¥ötf
, 2, 3))Ë
	$JS_ThrowI¡î«lEº‹
(
JSC⁄ãxt
 *
˘x
, c⁄° *
fmt
, ...)

6493 
JSVÆue
 
vÆ
;

6494 
va_li°
 
≠
;

6496 
	`va_°¨t
(
≠
, 
fmt
);

6497 
vÆ
 = 
	`JS_ThrowEº‹
(
˘x
, 
JS_INTERNAL_ERROR
, 
fmt
, 
≠
);

6498 
	`va_íd
(
≠
);

6499  
vÆ
;

6500 
	}
}

6502 
JSVÆue
 
	$JS_ThrowOutOfMem‹y
(
JSC⁄ãxt
 *
˘x
)

6504 
JSRu¡ime
 *
π
 = 
˘x
->rt;

6505 i‡(!
π
->
ö_out_of_mem‹y
) {

6506 
π
->
ö_out_of_mem‹y
 = 
TRUE
;

6507 
	`JS_ThrowI¡î«lEº‹
(
˘x
, "out of memory");

6508 
π
->
ö_out_of_mem‹y
 = 
FALSE
;

6510  
JS_EXCEPTION
;

6511 
	}
}

6513 
JSVÆue
 
	$JS_ThrowSèckOvîÊow
(
JSC⁄ãxt
 *
˘x
)

6515  
	`JS_ThrowI¡î«lEº‹
(
˘x
, "stack overflow");

6516 
	}
}

6518 
JSVÆue
 
	$JS_ThrowTy≥Eº‹NŸAnObje˘
(
JSC⁄ãxt
 *
˘x
)

6520  
	`JS_ThrowTy≥Eº‹
(
˘x
, "notán object");

6521 
	}
}

6523 
JSVÆue
 
	$JS_ThrowTy≥Eº‹NŸASymbﬁ
(
JSC⁄ãxt
 *
˘x
)

6525  
	`JS_ThrowTy≥Eº‹
(
˘x
, "notá symbol");

6526 
	}
}

6528 
JSVÆue
 
	$JS_ThrowRe„ªn˚Eº‹NŸDeföed
(
JSC⁄ãxt
 *
˘x
, 
JSAtom
 
«me
)

6530 
buf
[
ATOM_GET_STR_BUF_SIZE
];

6531  
	`JS_ThrowRe„ªn˚Eº‹
(
˘x
, "%s isÇot defined",

6532 
	`JS_AtomGëSå
(
˘x
, 
buf
, (buf), 
«me
));

6533 
	}
}

6535 
JSVÆue
 
	$JS_ThrowRe„ªn˚Eº‹Unöôülized
(
JSC⁄ãxt
 *
˘x
, 
JSAtom
 
«me
)

6537 
buf
[
ATOM_GET_STR_BUF_SIZE
];

6538  
	`JS_ThrowRe„ªn˚Eº‹
(
˘x
, "%s isÇot initialized",

6539 
«me
 =
JS_ATOM_NULL
 ? "lexical variable" :

6540 
	`JS_AtomGëSå
(
˘x
, 
buf
, (buf), 
«me
));

6541 
	}
}

6543 
JSVÆue
 
	$JS_ThrowTy≥Eº‹InvÆidCœss
(
JSC⁄ãxt
 *
˘x
, 
˛ass_id
)

6545 
JSRu¡ime
 *
π
 = 
˘x
->rt;

6546 
buf
[
ATOM_GET_STR_BUF_SIZE
];

6547 
JSAtom
 
«me
;

6548 
«me
 = 
π
->
˛ass_¨øy
[
˛ass_id
].
˛ass_«me
;

6549  
	`JS_ThrowTy≥Eº‹
(
˘x
, "%s objectÉxpected",

6550 
	`JS_AtomGëSå
(
˘x
, 
buf
, (buf), 
«me
));

6551 
	}
}

6554 
	$JS_SëPrŸŸy≥I¡î«l
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
obj
,

6555 
JSVÆueC⁄°
 
¥Ÿo_vÆ
,

6556 
BOOL
 
throw_Êag
)

6558 
JSObje˘
 *
¥Ÿo
, *
p
, *
p1
;

6559 
JSSh≠e
 *
sh
;

6561 i‡(
throw_Êag
) {

6562 i‡(
	`JS_VALUE_GET_TAG
(
obj
Ë=
JS_TAG_NULL
 ||

6563 
	`JS_VALUE_GET_TAG
(
obj
Ë=
JS_TAG_UNDEFINED
)

6564 
nŸ_obj
;

6566 i‡(
	`JS_VALUE_GET_TAG
(
obj
Ë!
JS_TAG_OBJECT
)

6567 
nŸ_obj
;

6569 
p
 = 
	`JS_VALUE_GET_OBJ
(
obj
);

6570 i‡(
	`JS_VALUE_GET_TAG
(
¥Ÿo_vÆ
Ë!
JS_TAG_OBJECT
) {

6571 i‡(
	`JS_VALUE_GET_TAG
(
¥Ÿo_vÆ
Ë!
JS_TAG_NULL
) {

6572 
nŸ_obj
:

6573 
	`JS_ThrowTy≥Eº‹NŸAnObje˘
(
˘x
);

6576 
¥Ÿo
 = 
NULL
;

6578 
¥Ÿo
 = 
	`JS_VALUE_GET_OBJ
(
¥Ÿo_vÆ
);

6581 i‡(
throw_Êag
 && 
	`JS_VALUE_GET_TAG
(
obj
Ë!
JS_TAG_OBJECT
)

6582  
TRUE
;

6584 i‡(
	`u∆ikñy
(
p
->
˛ass_id
 =
JS_CLASS_PROXY
))

6585  
	`js_¥oxy_£tPrŸŸy≥Of
(
˘x
, 
obj
, 
¥Ÿo_vÆ
, 
throw_Êag
);

6586 
sh
 = 
p
->
sh≠e
;

6587 i‡(
sh
->
¥Ÿo
 ==Öroto)

6588  
TRUE
;

6589 i‡(!
p
->
exãnsibÀ
) {

6590 i‡(
throw_Êag
) {

6591 
	`JS_ThrowTy≥Eº‹
(
˘x
, "object isÇotÉxtensible");

6594  
FALSE
;

6597 i‡(
¥Ÿo
) {

6599 
p1
 = 
¥Ÿo
;

6601 i‡(
p1
 =
p
) {

6602 i‡(
throw_Êag
) {

6603 
	`JS_ThrowTy≥Eº‹
(
˘x
, "circularÖrototype chain");

6606  
FALSE
;

6610 
p1
 =Ö1->
sh≠e
->
¥Ÿo
;

6611 } 
p1
 !
NULL
);

6612 
	`JS_DupVÆue
(
˘x
, 
¥Ÿo_vÆ
);

6615 i‡(
	`js_sh≠e_¥ï¨e_upd©e
(
˘x
, 
p
, 
NULL
))

6617 
sh
 = 
p
->
sh≠e
;

6618 i‡(
sh
->
¥Ÿo
)

6619 
	`JS_FªeVÆue
(
˘x
, 
	`JS_MKPTR
(
JS_TAG_OBJECT
, 
sh
->
¥Ÿo
));

6620 
sh
->
¥Ÿo
 =Öroto;

6621  
TRUE
;

6622 
	}
}

6625 
	$JS_SëPrŸŸy≥
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
obj
, JSVÆueC⁄° 
¥Ÿo_vÆ
)

6627  
	`JS_SëPrŸŸy≥I¡î«l
(
˘x
, 
obj
, 
¥Ÿo_vÆ
, 
TRUE
);

6628 
	}
}

6631 
JSVÆueC⁄°
 
	$JS_GëPrŸŸy≥
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
vÆ
)

6633 
JSObje˘
 *
p
;

6635 
	`JS_VALUE_GET_NORM_TAG
(
vÆ
)) {

6636 #ifde‡
CONFIG_BIGNUM


6637 
JS_TAG_BIG_INT
:

6638 
vÆ
 = 
˘x
->
˛ass_¥Ÿo
[
JS_CLASS_BIG_INT
];

6640 
JS_TAG_BIG_FLOAT
:

6641 
vÆ
 = 
˘x
->
˛ass_¥Ÿo
[
JS_CLASS_BIG_FLOAT
];

6643 
JS_TAG_BIG_DECIMAL
:

6644 
vÆ
 = 
˘x
->
˛ass_¥Ÿo
[
JS_CLASS_BIG_DECIMAL
];

6647 
JS_TAG_INT
:

6648 
JS_TAG_FLOAT64
:

6649 
vÆ
 = 
˘x
->
˛ass_¥Ÿo
[
JS_CLASS_NUMBER
];

6651 
JS_TAG_BOOL
:

6652 
vÆ
 = 
˘x
->
˛ass_¥Ÿo
[
JS_CLASS_BOOLEAN
];

6654 
JS_TAG_STRING
:

6655 
vÆ
 = 
˘x
->
˛ass_¥Ÿo
[
JS_CLASS_STRING
];

6657 
JS_TAG_SYMBOL
:

6658 
vÆ
 = 
˘x
->
˛ass_¥Ÿo
[
JS_CLASS_SYMBOL
];

6660 
JS_TAG_OBJECT
:

6661 
p
 = 
	`JS_VALUE_GET_OBJ
(
vÆ
);

6662 i‡(
	`u∆ikñy
(
p
->
˛ass_id
 =
JS_CLASS_PROXY
)) {

6663 
vÆ
 = 
	`js_¥oxy_gëPrŸŸy≥Of
(
˘x
, val);

6665 
p
 =Ö->
sh≠e
->
¥Ÿo
;

6666 i‡(!
p
)

6667 
vÆ
 = 
JS_NULL
;

6669 
vÆ
 = 
	`JS_MKPTR
(
JS_TAG_OBJECT
, 
p
);

6672 
JS_TAG_NULL
:

6673 
JS_TAG_UNDEFINED
:

6675 
vÆ
 = 
JS_NULL
;

6678  
vÆ
;

6679 
	}
}

6682 
	$JS_Ordö¨yIsIn°™˚Of
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
vÆ
,

6683 
JSVÆueC⁄°
 
obj
)

6685 
JSVÆue
 
obj_¥Ÿo
;

6686 
JSObje˘
 *
¥Ÿo
;

6687 c⁄° 
JSObje˘
 *
p
, *
¥Ÿo1
;

6688 
BOOL
 
ªt
;

6690 i‡(!
	`JS_IsFun˘i⁄
(
˘x
, 
obj
))

6691  
FALSE
;

6692 
p
 = 
	`JS_VALUE_GET_OBJ
(
obj
);

6693 i‡(
p
->
˛ass_id
 =
JS_CLASS_BOUND_FUNCTION
) {

6694 
JSBoundFun˘i⁄
 *
s
 = 
p
->
u
.
bound_fun˘i⁄
;

6695  
	`JS_IsIn°™˚Of
(
˘x
, 
vÆ
, 
s
->
func_obj
);

6699 i‡(
	`JS_VALUE_GET_TAG
(
vÆ
Ë!
JS_TAG_OBJECT
)

6700  
FALSE
;

6701 
ªt
 = 
FALSE
;

6702 
obj_¥Ÿo
 = 
	`JS_GëPr›îty
(
˘x
, 
obj
, 
JS_ATOM_¥ŸŸy≥
);

6703 i‡(
	`JS_VALUE_GET_TAG
(
obj_¥Ÿo
Ë!
JS_TAG_OBJECT
) {

6704 i‡(!
	`JS_IsEx˚±i⁄
(
obj_¥Ÿo
))

6705 
	`JS_ThrowTy≥Eº‹
(
˘x
, "operand 'prototype'Öroperty isÇotán object");

6706 
ªt
 = -1;

6707 
d⁄e
;

6709 
¥Ÿo
 = 
	`JS_VALUE_GET_OBJ
(
obj_¥Ÿo
);

6710 
p
 = 
	`JS_VALUE_GET_OBJ
(
vÆ
);

6712 
¥Ÿo1
 = 
p
->
sh≠e
->
¥Ÿo
;

6713 i‡(!
¥Ÿo1
) {

6714 i‡(
p
->
˛ass_id
 =
JS_CLASS_PROXY
) {

6715 
JSVÆueC⁄°
 
¥Ÿo_vÆ
;

6716 
¥Ÿo_vÆ
 = 
	`JS_GëPrŸŸy≥
(
˘x
, 
	`JS_MKPTR
(
JS_TAG_OBJECT
, (
JSObje˘
 *)
p
));

6717 i‡(
	`JS_IsEx˚±i⁄
(
¥Ÿo_vÆ
)) {

6718 
ªt
 = -1;

6719 
d⁄e
;

6721 
¥Ÿo1
 = 
	`JS_VALUE_GET_OBJ
(
¥Ÿo_vÆ
);

6722 i‡(!
¥Ÿo1
)

6728 
p
 = 
¥Ÿo1
;

6729 i‡(
¥Ÿo
 =
p
) {

6730 
ªt
 = 
TRUE
;

6734 
d⁄e
:

6735 
	`JS_FªeVÆue
(
˘x
, 
obj_¥Ÿo
);

6736  
ªt
;

6737 
	}
}

6740 
	$JS_IsIn°™˚Of
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
vÆ
, JSVÆueC⁄° 
obj
)

6742 
JSVÆue
 
mëhod
;

6744 i‡(!
	`JS_IsObje˘
(
obj
))

6745 
Áû
;

6746 
mëhod
 = 
	`JS_GëPr›îty
(
˘x
, 
obj
, 
JS_ATOM_Symbﬁ_hasIn°™˚
);

6747 i‡(
	`JS_IsEx˚±i⁄
(
mëhod
))

6749 i‡(!
	`JS_IsNuŒ
(
mëhod
Ë&& !
	`JS_IsUndeföed
(method)) {

6750 
JSVÆue
 
ªt
;

6751 
ªt
 = 
	`JS_CÆlFªe
(
˘x
, 
mëhod
, 
obj
, 1, &
vÆ
);

6752  
	`JS_ToBoﬁFªe
(
˘x
, 
ªt
);

6756 i‡(!
	`JS_IsFun˘i⁄
(
˘x
, 
obj
)) {

6757 
Áû
:

6758 
	`JS_ThrowTy≥Eº‹
(
˘x
, "invalid 'instanceof'Ñight operand");

6761  
	`JS_Ordö¨yIsIn°™˚Of
(
˘x
, 
vÆ
, 
obj
);

6762 
	}
}

6764 
	$JS_AutoInôPr›îty
(
JSC⁄ãxt
 *
˘x
, 
JSObje˘
 *
p
, 
JSAtom
 
¥›
, 
JSPr›îty
 *
¥
)

6766 
ªt
;

6767 
JSC⁄ãxt
 *
ªÆm
;

6769 i‡(
¥
->
u
.
öô
.u.
öô_id
 >
JS_AUTOINIT_ID_PROP
) {

6770 
ªÆm
 = 
¥
->
u
.
öô
.u.realm;

6771 
ªt
 = 
	`JS_In°™tüãFun˘i⁄Li°Iãm
(
ªÆm
, 
p
, 
¥›
, 
¥
->
u
.
öô
.
›aque
);

6772 i‡(
ªt
)

6773  
ªt
;

6775 
¥
->
u
.
öô
.u.
öô_id
) {

6776 
JS_AUTOINIT_ID_PROTOTYPE
:

6777 
ªt
 = 
	`js_ö°™tüã_¥ŸŸy≥
(
˘x
, 
p
, 
¥›
, 
¥
->
u
.
öô
.
›aque
);

6779 
JS_AUTOINIT_ID_MODULE_NS
:

6780 
ªt
 = 
	`js_moduÀ_ns_autoöô
(
˘x
, 
p
, 
¥›
, 
¥
->
u
.
öô
.
›aque
);

6783 
	`ab‹t
();

6786  
ªt
;

6787 
	}
}

6789 
JSVÆue
 
	$JS_GëPr›îtyI¡î«l
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
obj
,

6790 
JSAtom
 
¥›
, 
JSVÆueC⁄°
 
this_obj
,

6791 
BOOL
 
throw_ªf_îr‹
)

6793 
JSObje˘
 *
p
;

6794 
JSPr›îty
 *
¥
;

6795 
JSSh≠ePr›îty
 *
¥s
;

6796 
uöt32_t
 
èg
;

6798 
èg
 = 
	`JS_VALUE_GET_TAG
(
obj
);

6799 i‡(
	`u∆ikñy
(
èg
 !
JS_TAG_OBJECT
)) {

6800 
èg
) {

6801 
JS_TAG_NULL
:

6802 
JS_TAG_UNDEFINED
:

6803  
	`JS_ThrowTy≥Eº‹
(
˘x
, "value hasÇoÖroperty");

6804 
JS_TAG_EXCEPTION
:

6805  
JS_EXCEPTION
;

6806 
JS_TAG_STRING
:

6808 
JSSåög
 *
p1
 = 
	`JS_VALUE_GET_STRING
(
obj
);

6809 i‡(
	`__JS_AtomIsTaggedI¡
(
¥›
)) {

6810 
uöt32_t
 
idx
, 
ch
;

6811 
idx
 = 
	`__JS_AtomToUI¡32
(
¥›
);

6812 i‡(
idx
 < 
p1
->
Àn
) {

6813 i‡(
p1
->
is_wide_ch¨
)

6814 
ch
 = 
p1
->
u
.
°r16
[
idx
];

6816 
ch
 = 
p1
->
u
.
°r8
[
idx
];

6817  
	`js_√w_°rög_ch¨
(
˘x
, 
ch
);

6819 } i‡(
¥›
 =
JS_ATOM_Àngth
) {

6820  
	`JS_NewI¡32
(
˘x
, 
p1
->
Àn
);

6828 
p
 = 
	`JS_VALUE_GET_OBJ
(
	`JS_GëPrŸŸy≥
(
˘x
, 
obj
));

6829 i‡(!
p
)

6830  
JS_UNDEFINED
;

6832 
p
 = 
	`JS_VALUE_GET_OBJ
(
obj
);

6836 
¥s
 = 
	`föd_own_¥›îty
(&
¥
, 
p
, 
¥›
);

6837 i‡(
¥s
) {

6839 i‡(
	`u∆ikñy
(
¥s
->
Êags
 & 
JS_PROP_TMASK
)) {

6840 i‡((
¥s
->
Êags
 & 
JS_PROP_TMASK
Ë=
JS_PROP_GETSET
) {

6841 i‡(
	`u∆ikñy
(!
¥
->
u
.
gë£t
.
gëãr
)) {

6842  
JS_UNDEFINED
;

6844 
JSVÆue
 
func
 = 
	`JS_MKPTR
(
JS_TAG_OBJECT
, 
¥
->
u
.
gë£t
.
gëãr
);

6846 
func
 = 
	`JS_DupVÆue
(
˘x
, func);

6847  
	`JS_CÆlFªe
(
˘x
, 
func
, 
this_obj
, 0, 
NULL
);

6849 } i‡((
¥s
->
Êags
 & 
JS_PROP_TMASK
Ë=
JS_PROP_VARREF
) {

6850 
JSVÆue
 
vÆ
 = *
¥
->
u
.
v¨_ªf
->
pvÆue
;

6851 i‡(
	`u∆ikñy
(
	`JS_IsUnöôülized
(
vÆ
)))

6852  
	`JS_ThrowRe„ªn˚Eº‹Unöôülized
(
˘x
, 
¥s
->
©om
);

6853  
	`JS_DupVÆue
(
˘x
, 
vÆ
);

6854 } i‡((
¥s
->
Êags
 & 
JS_PROP_TMASK
Ë=
JS_PROP_AUTOINIT
) {

6856 i‡(
	`JS_AutoInôPr›îty
(
˘x
, 
p
, 
¥›
, 
¥
))

6857  
JS_EXCEPTION
;

6861  
	`JS_DupVÆue
(
˘x
, 
¥
->
u
.
vÆue
);

6864 i‡(
	`u∆ikñy
(
p
->
is_exŸic
)) {

6866 i‡(
p
->
Á°_¨øy
) {

6867 i‡(
	`__JS_AtomIsTaggedI¡
(
¥›
)) {

6868 
uöt32_t
 
idx
 = 
	`__JS_AtomToUI¡32
(
¥›
);

6869 i‡(
idx
 < 
p
->
u
.
¨øy
.
cou¡
) {

6871  
	`JS_GëPr›îtyUöt32
(
˘x
, 
	`JS_MKPTR
(
JS_TAG_OBJECT
, 
p
), 
idx
);

6872 } i‡(
p
->
˛ass_id
 >
JS_CLASS_UINT8C_ARRAY
 &&

6873 
p
->
˛ass_id
 <
JS_CLASS_FLOAT64_ARRAY
) {

6874 
ty≥d_¨øy_oob
;

6876 } i‡(
p
->
˛ass_id
 >
JS_CLASS_UINT8C_ARRAY
 &&

6877 
p
->
˛ass_id
 <
JS_CLASS_FLOAT64_ARRAY
) {

6878 
ªt
;

6879 
ªt
 = 
	`JS_AtomIsNumîicIndex
(
˘x
, 
¥›
);

6880 i‡(
ªt
 != 0) {

6881 i‡(
ªt
 < 0)

6882  
JS_EXCEPTION
;

6883 
ty≥d_¨øy_oob
:

6884 i‡(
	`ty≥d_¨øy_is_dëached
(
˘x
, 
p
))

6885  
	`JS_ThrowTy≥Eº‹DëachedAºayBuf„r
(
˘x
);

6886  
JS_UNDEFINED
;

6890 c⁄° 
JSCœssExŸicMëhods
 *
em
 = 
˘x
->
π
->
˛ass_¨øy
[
p
->
˛ass_id
].
exŸic
;

6891 i‡(
em
) {

6892 i‡(
em
->
gë_¥›îty
) {

6894  
em
->
	`gë_¥›îty
(
˘x
, 
	`JS_MKPTR
(
JS_TAG_OBJECT
, 
p
),

6895 
¥›
, 
this_obj
);

6897 i‡(
em
->
gë_own_¥›îty
) {

6898 
JSPr›îtyDes¸ùt‹
 
desc
;

6899 
ªt
;

6901 
ªt
 = 
em
->
	`gë_own_¥›îty
(
˘x
, &
desc
, 
	`JS_MKPTR
(
JS_TAG_OBJECT
, 
p
), 
¥›
);

6902 i‡(
ªt
 < 0)

6903  
JS_EXCEPTION
;

6904 i‡(
ªt
) {

6905 i‡(
desc
.
Êags
 & 
JS_PROP_GETSET
) {

6906 
	`JS_FªeVÆue
(
˘x
, 
desc
.
£âî
);

6907  
	`JS_CÆlFªe
(
˘x
, 
desc
.
gëãr
, 
this_obj
, 0, 
NULL
);

6909  
desc
.
vÆue
;

6916 
p
 =Ö->
sh≠e
->
¥Ÿo
;

6917 i‡(!
p
)

6920 i‡(
	`u∆ikñy
(
throw_ªf_îr‹
)) {

6921  
	`JS_ThrowRe„ªn˚Eº‹NŸDeföed
(
˘x
, 
¥›
);

6923  
JS_UNDEFINED
;

6925 
	}
}

6927 
JSVÆue
 
	$JS_ThrowTy≥Eº‹Priv©eNŸFound
(
JSC⁄ãxt
 *
˘x
, 
JSAtom
 
©om
)

6929 
buf
[
ATOM_GET_STR_BUF_SIZE
];

6930  
	`JS_ThrowTy≥Eº‹
(
˘x
, "private class field %s doesÇotÉxist",

6931 
	`JS_AtomGëSå
(
˘x
, 
buf
, (buf), 
©om
));

6932 
	}
}

6936 
	$JS_DeföePriv©eFõld
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
obj
,

6937 
JSVÆueC⁄°
 
«me
, 
JSVÆue
 
vÆ
)

6939 
JSObje˘
 *
p
;

6940 
JSSh≠ePr›îty
 *
¥s
;

6941 
JSPr›îty
 *
¥
;

6942 
JSAtom
 
¥›
;

6944 i‡(
	`u∆ikñy
(
	`JS_VALUE_GET_TAG
(
obj
Ë!
JS_TAG_OBJECT
)) {

6945 
	`JS_ThrowTy≥Eº‹NŸAnObje˘
(
˘x
);

6946 
Áû
;

6949 i‡(
	`u∆ikñy
(
	`JS_VALUE_GET_TAG
(
«me
Ë!
JS_TAG_SYMBOL
)) {

6950 
	`JS_ThrowTy≥Eº‹NŸASymbﬁ
(
˘x
);

6951 
Áû
;

6953 
¥›
 = 
	`js_symbﬁ_to_©om
(
˘x
, (
JSVÆue
)
«me
);

6954 
p
 = 
	`JS_VALUE_GET_OBJ
(
obj
);

6955 
¥s
 = 
	`föd_own_¥›îty
(&
¥
, 
p
, 
¥›
);

6956 i‡(
¥s
) {

6957 
buf
[
ATOM_GET_STR_BUF_SIZE
];

6958 
	`JS_ThrowTy≥Eº‹
(
˘x
, "private class field %sálreadyÉxists",

6959 
	`JS_AtomGëSå
(
˘x
, 
buf
, (buf), 
¥›
));

6960 
Áû
;

6962 
¥
 = 
	`add_¥›îty
(
˘x
, 
p
, 
¥›
, 
JS_PROP_C_W_E
);

6963 i‡(
	`u∆ikñy
(!
¥
)) {

6964 
Áû
:

6965 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

6968 
¥
->
u
.
vÆue
 = 
vÆ
;

6970 
	}
}

6972 
JSVÆue
 
	$JS_GëPriv©eFõld
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
obj
,

6973 
JSVÆueC⁄°
 
«me
)

6975 
JSObje˘
 *
p
;

6976 
JSSh≠ePr›îty
 *
¥s
;

6977 
JSPr›îty
 *
¥
;

6978 
JSAtom
 
¥›
;

6980 i‡(
	`u∆ikñy
(
	`JS_VALUE_GET_TAG
(
obj
Ë!
JS_TAG_OBJECT
))

6981  
	`JS_ThrowTy≥Eº‹NŸAnObje˘
(
˘x
);

6983 i‡(
	`u∆ikñy
(
	`JS_VALUE_GET_TAG
(
«me
Ë!
JS_TAG_SYMBOL
))

6984  
	`JS_ThrowTy≥Eº‹NŸASymbﬁ
(
˘x
);

6985 
¥›
 = 
	`js_symbﬁ_to_©om
(
˘x
, (
JSVÆue
)
«me
);

6986 
p
 = 
	`JS_VALUE_GET_OBJ
(
obj
);

6987 
¥s
 = 
	`föd_own_¥›îty
(&
¥
, 
p
, 
¥›
);

6988 i‡(!
¥s
) {

6989 
	`JS_ThrowTy≥Eº‹Priv©eNŸFound
(
˘x
, 
¥›
);

6990  
JS_EXCEPTION
;

6992  
	`JS_DupVÆue
(
˘x
, 
¥
->
u
.
vÆue
);

6993 
	}
}

6995 
	$JS_SëPriv©eFõld
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
obj
,

6996 
JSVÆueC⁄°
 
«me
, 
JSVÆue
 
vÆ
)

6998 
JSObje˘
 *
p
;

6999 
JSSh≠ePr›îty
 *
¥s
;

7000 
JSPr›îty
 *
¥
;

7001 
JSAtom
 
¥›
;

7003 i‡(
	`u∆ikñy
(
	`JS_VALUE_GET_TAG
(
obj
Ë!
JS_TAG_OBJECT
)) {

7004 
	`JS_ThrowTy≥Eº‹NŸAnObje˘
(
˘x
);

7005 
Áû
;

7008 i‡(
	`u∆ikñy
(
	`JS_VALUE_GET_TAG
(
«me
Ë!
JS_TAG_SYMBOL
)) {

7009 
	`JS_ThrowTy≥Eº‹NŸASymbﬁ
(
˘x
);

7010 
Áû
;

7012 
¥›
 = 
	`js_symbﬁ_to_©om
(
˘x
, (
JSVÆue
)
«me
);

7013 
p
 = 
	`JS_VALUE_GET_OBJ
(
obj
);

7014 
¥s
 = 
	`föd_own_¥›îty
(&
¥
, 
p
, 
¥›
);

7015 i‡(!
¥s
) {

7016 
	`JS_ThrowTy≥Eº‹Priv©eNŸFound
(
˘x
, 
¥›
);

7017 
Áû
:

7018 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

7021 
	`£t_vÆue
(
˘x
, &
¥
->
u
.
vÆue
, 
vÆ
);

7023 
	}
}

7025 
	$JS_AddBønd
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
obj
, JSVÆueC⁄° 
home_obj
)

7027 
JSObje˘
 *
p
, *
p1
;

7028 
JSSh≠ePr›îty
 *
¥s
;

7029 
JSPr›îty
 *
¥
;

7030 
JSVÆue
 
bønd
;

7031 
JSAtom
 
bønd_©om
;

7033 i‡(
	`u∆ikñy
(
	`JS_VALUE_GET_TAG
(
home_obj
Ë!
JS_TAG_OBJECT
)) {

7034 
	`JS_ThrowTy≥Eº‹NŸAnObje˘
(
˘x
);

7037 
p
 = 
	`JS_VALUE_GET_OBJ
(
home_obj
);

7038 
¥s
 = 
	`föd_own_¥›îty
(&
¥
, 
p
, 
JS_ATOM_Priv©e_bønd
);

7039 i‡(!
¥s
) {

7040 
bønd
 = 
	`JS_NewSymbﬁFromAtom
(
˘x
, 
JS_ATOM_bønd
, 
JS_ATOM_TYPE_PRIVATE
);

7041 i‡(
	`JS_IsEx˚±i⁄
(
bønd
))

7044 
¥
 = 
	`add_¥›îty
(
˘x
, 
p
, 
JS_ATOM_Priv©e_bønd
, 
JS_PROP_C_W_E
);

7045 i‡(!
¥
) {

7046 
	`JS_FªeVÆue
(
˘x
, 
bønd
);

7049 
¥
->
u
.
vÆue
 = 
	`JS_DupVÆue
(
˘x
, 
bønd
);

7051 
bønd
 = 
	`JS_DupVÆue
(
˘x
, 
¥
->
u
.
vÆue
);

7053 
bønd_©om
 = 
	`js_symbﬁ_to_©om
(
˘x
, 
bønd
);

7055 i‡(
	`u∆ikñy
(
	`JS_VALUE_GET_TAG
(
obj
Ë!
JS_TAG_OBJECT
)) {

7056 
	`JS_ThrowTy≥Eº‹NŸAnObje˘
(
˘x
);

7057 
	`JS_FªeAtom
(
˘x
, 
bønd_©om
);

7060 
p1
 = 
	`JS_VALUE_GET_OBJ
(
obj
);

7061 
¥
 = 
	`add_¥›îty
(
˘x
, 
p1
, 
bønd_©om
, 
JS_PROP_C_W_E
);

7062 
	`JS_FªeAtom
(
˘x
, 
bønd_©om
);

7063 i‡(!
¥
)

7065 
¥
->
u
.
vÆue
 = 
JS_UNDEFINED
;

7067 
	}
}

7069 
	$JS_CheckBønd
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
obj
, JSVÆueC⁄° 
func
)

7071 
JSObje˘
 *
p
, *
p1
, *
home_obj
;

7072 
JSSh≠ePr›îty
 *
¥s
;

7073 
JSPr›îty
 *
¥
;

7074 
JSVÆueC⁄°
 
bønd
;

7077 i‡(
	`u∆ikñy
(
	`JS_VALUE_GET_TAG
(
func
Ë!
JS_TAG_OBJECT
)) {

7078 
nŸ_obj
:

7079 
	`JS_ThrowTy≥Eº‹NŸAnObje˘
(
˘x
);

7082 
p1
 = 
	`JS_VALUE_GET_OBJ
(
func
);

7083 i‡(!
	`js_˛ass_has_byãcode
(
p1
->
˛ass_id
))

7084 
nŸ_obj
;

7085 
home_obj
 = 
p1
->
u
.
func
.
home_obje˘
;

7086 i‡(!
home_obj
)

7087 
nŸ_obj
;

7088 
¥s
 = 
	`föd_own_¥›îty
(&
¥
, 
home_obj
, 
JS_ATOM_Priv©e_bønd
);

7089 i‡(!
¥s
) {

7090 
	`JS_ThrowTy≥Eº‹
(
˘x
, "expecting <brand>Örivate field");

7093 
bønd
 = 
¥
->
u
.
vÆue
;

7095 i‡(
	`u∆ikñy
(
	`JS_VALUE_GET_TAG
(
bønd
Ë!
JS_TAG_SYMBOL
))

7096 
nŸ_obj
;

7099 i‡(
	`u∆ikñy
(
	`JS_VALUE_GET_TAG
(
obj
Ë!
JS_TAG_OBJECT
))

7100 
nŸ_obj
;

7101 
p
 = 
	`JS_VALUE_GET_OBJ
(
obj
);

7102 
¥s
 = 
	`föd_own_¥›îty
(&
¥
, 
p
, 
	`js_symbﬁ_to_©om
(
˘x
, (
JSVÆue
)
bønd
));

7103 i‡(!
¥s
) {

7104 
	`JS_ThrowTy≥Eº‹
(
˘x
, "invalid brand on object");

7108 
	}
}

7110 
	$num_keys_cmp
(c⁄° *
p1
, c⁄° *
p2
, *
›aque
)

7112 
JSC⁄ãxt
 *
˘x
 = 
›aque
;

7113 
JSAtom
 
©om1
 = ((c⁄° 
JSPr›îtyEnum
 *)
p1
)->
©om
;

7114 
JSAtom
 
©om2
 = ((c⁄° 
JSPr›îtyEnum
 *)
p2
)->
©om
;

7115 
uöt32_t
 
v1
, 
v2
;

7116 
BOOL
 
©om1_is_öãgî
, 
©om2_is_öãgî
;

7118 
©om1_is_öãgî
 = 
	`JS_AtomIsAºayIndex
(
˘x
, &
v1
, 
©om1
);

7119 
©om2_is_öãgî
 = 
	`JS_AtomIsAºayIndex
(
˘x
, &
v2
, 
©om2
);

7120 
	`as£π
(
©om1_is_öãgî
 && 
©om2_is_öãgî
);

7121 i‡(
v1
 < 
v2
)

7123 i‡(
v1
 =
v2
)

7127 
	}
}

7129 
	$js_‰ì_¥›_íum
(
JSC⁄ãxt
 *
˘x
, 
JSPr›îtyEnum
 *
èb
, 
uöt32_t
 
Àn
)

7131 
uöt32_t
 
i
;

7132 i‡(
èb
) {

7133 
i
 = 0; i < 
Àn
; i++)

7134 
	`JS_FªeAtom
(
˘x
, 
èb
[
i
].
©om
);

7135 
	`js_‰ì
(
˘x
, 
èb
);

7137 
	}
}

7141 
__ex˚±i⁄
 
	$JS_GëOwnPr›îtyNamesI¡î«l
(
JSC⁄ãxt
 *
˘x
,

7142 
JSPr›îtyEnum
 **
±ab
,

7143 
uöt32_t
 *
∂í
,

7144 
JSObje˘
 *
p
, 
Êags
)

7146 
i
, 
j
;

7147 
JSSh≠e
 *
sh
;

7148 
JSSh≠ePr›îty
 *
¥s
;

7149 
JSPr›îtyEnum
 *
èb_©om
, *
èb_exŸic
;

7150 
JSAtom
 
©om
;

7151 
uöt32_t
 
num_keys_cou¡
, 
°r_keys_cou¡
, 
sym_keys_cou¡
, 
©om_cou¡
;

7152 
uöt32_t
 
num_ödex
, 
°r_ödex
, 
sym_ödex
, 
exŸic_cou¡
;

7153 
BOOL
 
is_íumîabÀ
, 
num_s‹ãd
;

7154 
uöt32_t
 
num_key
;

7155 
JSAtomKödEnum
 
köd
;

7158 *
±ab
 = 
NULL
;

7159 *
∂í
 = 0;

7162 
num_keys_cou¡
 = 0;

7163 
°r_keys_cou¡
 = 0;

7164 
sym_keys_cou¡
 = 0;

7165 
exŸic_cou¡
 = 0;

7166 
èb_exŸic
 = 
NULL
;

7167 
sh
 = 
p
->
sh≠e
;

7168 
i
 = 0, 
¥s
 = 
	`gë_sh≠e_¥›
(
sh
); i < sh->
¥›_cou¡
; i++,Örs++) {

7169 
©om
 = 
¥s
->atom;

7170 i‡(
©om
 !
JS_ATOM_NULL
) {

7171 
is_íumîabÀ
 = ((
¥s
->
Êags
 & 
JS_PROP_ENUMERABLE
) != 0);

7172 
köd
 = 
	`JS_AtomGëKöd
(
˘x
, 
©om
);

7173 i‡((!(
Êags
 & 
JS_GPN_ENUM_ONLY
Ë|| 
is_íumîabÀ
) &&

7174 ((
Êags
 >> 
köd
) & 1) != 0) {

7177 i‡(
	`u∆ikñy
((
¥s
->
Êags
 & 
JS_PROP_TMASK
Ë=
JS_PROP_VARREF
) &&

7178 (
Êags
 & (
JS_GPN_SET_ENUM
 | 
JS_GPN_ENUM_ONLY
))) {

7179 
JSV¨Ref
 *
v¨_ªf
 = 
p
->
¥›
[
i
].
u
.var_ref;

7180 i‡(
	`u∆ikñy
(
	`JS_IsUnöôülized
(*
v¨_ªf
->
pvÆue
))) {

7181 
	`JS_ThrowRe„ªn˚Eº‹Unöôülized
(
˘x
, 
¥s
->
©om
);

7185 i‡(
	`JS_AtomIsAºayIndex
(
˘x
, &
num_key
, 
©om
)) {

7186 
num_keys_cou¡
++;

7187 } i‡(
köd
 =
JS_ATOM_KIND_STRING
) {

7188 
°r_keys_cou¡
++;

7190 
sym_keys_cou¡
++;

7196 i‡(
p
->
is_exŸic
) {

7197 i‡(
p
->
Á°_¨øy
) {

7200 i‡((
Êags
 & (
JS_GPN_SET_ENUM
 | 
JS_GPN_ENUM_ONLY
)) &&

7201 (
p
->
˛ass_id
 >
JS_CLASS_UINT8C_ARRAY
 &&

7202 
p
->
˛ass_id
 <
JS_CLASS_FLOAT64_ARRAY
) &&

7203 
	`ty≥d_¨øy_is_dëached
(
˘x
, 
p
) &&

7204 
	`ty≥d_¨øy_gë_Àngth
(
˘x
, 
p
) != 0) {

7205 
	`JS_ThrowTy≥Eº‹DëachedAºayBuf„r
(
˘x
);

7208 
num_keys_cou¡
 +
p
->
u
.
¨øy
.
cou¡
;

7210 c⁄° 
JSCœssExŸicMëhods
 *
em
 = 
˘x
->
π
->
˛ass_¨øy
[
p
->
˛ass_id
].
exŸic
;

7211 i‡(
em
 &&Ém->
gë_own_¥›îty_«mes
) {

7212 i‡(
em
->
	`gë_own_¥›îty_«mes
(
˘x
, &
èb_exŸic
, &
exŸic_cou¡
,

7213 
	`JS_MKPTR
(
JS_TAG_OBJECT
, 
p
)))

7215 
i
 = 0; i < 
exŸic_cou¡
; i++) {

7216 
©om
 = 
èb_exŸic
[
i
].atom;

7217 
köd
 = 
	`JS_AtomGëKöd
(
˘x
, 
©om
);

7218 i‡(((
Êags
 >> 
köd
) & 1) != 0) {

7219 
is_íumîabÀ
 = 
FALSE
;

7220 i‡(
Êags
 & (
JS_GPN_SET_ENUM
 | 
JS_GPN_ENUM_ONLY
)) {

7221 
JSPr›îtyDes¸ùt‹
 
desc
;

7222 
ªs
;

7224 
ªs
 = 
	`JS_GëOwnPr›îtyI¡î«l
(
˘x
, &
desc
, 
p
, 
©om
);

7225 i‡(
ªs
 < 0) {

7226 
	`js_‰ì_¥›_íum
(
˘x
, 
èb_exŸic
, 
exŸic_cou¡
);

7229 i‡(
ªs
) {

7230 
is_íumîabÀ
 =

7231 ((
desc
.
Êags
 & 
JS_PROP_ENUMERABLE
) != 0);

7232 
	`js_‰ì_desc
(
˘x
, &
desc
);

7234 
èb_exŸic
[
i
].
is_íumîabÀ
 = is_enumerable;

7236 i‡(!(
Êags
 & 
JS_GPN_ENUM_ONLY
Ë|| 
is_íumîabÀ
) {

7237 i‡(
	`JS_AtomIsAºayIndex
(
˘x
, &
num_key
, 
©om
)) {

7238 
num_keys_cou¡
++;

7239 } i‡(
köd
 =
JS_ATOM_KIND_STRING
) {

7240 
°r_keys_cou¡
++;

7242 
sym_keys_cou¡
++;

7253 
©om_cou¡
 = 
num_keys_cou¡
 + 
°r_keys_cou¡
 + 
sym_keys_cou¡
;

7255 
èb_©om
 = 
	`js_mÆloc
(
˘x
, —ab_©om[0]Ë* 
	`max_öt
(
©om_cou¡
, 1));

7256 i‡(!
èb_©om
) {

7257 
	`js_‰ì_¥›_íum
(
˘x
, 
èb_exŸic
, 
exŸic_cou¡
);

7261 
num_ödex
 = 0;

7262 
°r_ödex
 = 
num_keys_cou¡
;

7263 
sym_ödex
 = 
°r_ödex
 + 
°r_keys_cou¡
;

7265 
num_s‹ãd
 = 
TRUE
;

7266 
sh
 = 
p
->
sh≠e
;

7267 
i
 = 0, 
¥s
 = 
	`gë_sh≠e_¥›
(
sh
); i < sh->
¥›_cou¡
; i++,Örs++) {

7268 
©om
 = 
¥s
->atom;

7269 i‡(
©om
 !
JS_ATOM_NULL
) {

7270 
is_íumîabÀ
 = ((
¥s
->
Êags
 & 
JS_PROP_ENUMERABLE
) != 0);

7271 
köd
 = 
	`JS_AtomGëKöd
(
˘x
, 
©om
);

7272 i‡((!(
Êags
 & 
JS_GPN_ENUM_ONLY
Ë|| 
is_íumîabÀ
) &&

7273 ((
Êags
 >> 
köd
) & 1) != 0) {

7274 i‡(
	`JS_AtomIsAºayIndex
(
˘x
, &
num_key
, 
©om
)) {

7275 
j
 = 
num_ödex
++;

7276 
num_s‹ãd
 = 
FALSE
;

7277 } i‡(
köd
 =
JS_ATOM_KIND_STRING
) {

7278 
j
 = 
°r_ödex
++;

7280 
j
 = 
sym_ödex
++;

7282 
èb_©om
[
j
].
©om
 = 
	`JS_DupAtom
(
˘x
,átom);

7283 
èb_©om
[
j
].
is_íumîabÀ
 = is_enumerable;

7288 i‡(
p
->
is_exŸic
) {

7289 i‡(
p
->
Á°_¨øy
) {

7290 
i
 = 0; i < 
p
->
u
.
¨øy
.
cou¡
; i++) {

7291 
èb_©om
[
num_ödex
].
©om
 = 
	`__JS_AtomFromUI¡32
(
i
);

7292 i‡(
èb_©om
[
num_ödex
].
©om
 =
JS_ATOM_NULL
) {

7293 
	`js_‰ì_¥›_íum
(
˘x
, 
èb_exŸic
, 
exŸic_cou¡
);

7294 
	`js_‰ì_¥›_íum
(
˘x
, 
èb_©om
, 
num_ödex
);

7297 
èb_©om
[
num_ödex
].
is_íumîabÀ
 = 
TRUE
;

7298 
num_ödex
++;

7301 i‡(
exŸic_cou¡
 > 0) {

7302 
i
 = 0; i < 
exŸic_cou¡
; i++) {

7303 
©om
 = 
èb_exŸic
[
i
].atom;

7304 
is_íumîabÀ
 = 
èb_exŸic
[
i
].is_enumerable;

7305 
köd
 = 
	`JS_AtomGëKöd
(
˘x
, 
©om
);

7306 i‡((!(
Êags
 & 
JS_GPN_ENUM_ONLY
Ë|| 
is_íumîabÀ
) &&

7307 ((
Êags
 >> 
köd
) & 1) != 0) {

7308 i‡(
	`JS_AtomIsAºayIndex
(
˘x
, &
num_key
, 
©om
)) {

7309 
j
 = 
num_ödex
++;

7310 
num_s‹ãd
 = 
FALSE
;

7311 } i‡(
köd
 =
JS_ATOM_KIND_STRING
) {

7312 
j
 = 
°r_ödex
++;

7314 
j
 = 
sym_ödex
++;

7316 
èb_©om
[
j
].
©om
 =átom;

7317 
èb_©om
[
j
].
is_íumîabÀ
 = is_enumerable;

7319 
	`JS_FªeAtom
(
˘x
, 
©om
);

7323 
	`js_‰ì
(
˘x
, 
èb_exŸic
);

7326 
	`as£π
(
num_ödex
 =
num_keys_cou¡
);

7327 
	`as£π
(
°r_ödex
 =
num_keys_cou¡
 + 
°r_keys_cou¡
);

7328 
	`as£π
(
sym_ödex
 =
©om_cou¡
);

7330 i‡(
num_keys_cou¡
 !0 && !
num_s‹ãd
) {

7331 
	`rqs‹t
(
èb_©om
, 
num_keys_cou¡
, —ab_©om[0]), 
num_keys_cmp
,

7332 
˘x
);

7334 *
±ab
 = 
èb_©om
;

7335 *
∂í
 = 
©om_cou¡
;

7337 
	}
}

7339 
	$JS_GëOwnPr›îtyNames
(
JSC⁄ãxt
 *
˘x
, 
JSPr›îtyEnum
 **
±ab
,

7340 
uöt32_t
 *
∂í
, 
JSVÆueC⁄°
 
obj
, 
Êags
)

7342 i‡(
	`JS_VALUE_GET_TAG
(
obj
Ë!
JS_TAG_OBJECT
) {

7343 
	`JS_ThrowTy≥Eº‹NŸAnObje˘
(
˘x
);

7346  
	`JS_GëOwnPr›îtyNamesI¡î«l
(
˘x
, 
±ab
, 
∂í
,

7347 
	`JS_VALUE_GET_OBJ
(
obj
), 
Êags
);

7348 
	}
}

7353 
	$JS_GëOwnPr›îtyI¡î«l
(
JSC⁄ãxt
 *
˘x
, 
JSPr›îtyDes¸ùt‹
 *
desc
,

7354 
JSObje˘
 *
p
, 
JSAtom
 
¥›
)

7356 
JSSh≠ePr›îty
 *
¥s
;

7357 
JSPr›îty
 *
¥
;

7359 
ªåy
:

7360 
¥s
 = 
	`föd_own_¥›îty
(&
¥
, 
p
, 
¥›
);

7361 i‡(
¥s
) {

7362 i‡(
desc
) {

7363 
desc
->
Êags
 = 
¥s
->Êag†& 
JS_PROP_C_W_E
;

7364 
desc
->
gëãr
 = 
JS_UNDEFINED
;

7365 
desc
->
£âî
 = 
JS_UNDEFINED
;

7366 
desc
->
vÆue
 = 
JS_UNDEFINED
;

7367 i‡(
	`u∆ikñy
(
¥s
->
Êags
 & 
JS_PROP_TMASK
)) {

7368 i‡((
¥s
->
Êags
 & 
JS_PROP_TMASK
Ë=
JS_PROP_GETSET
) {

7369 
desc
->
Êags
 |
JS_PROP_GETSET
;

7370 i‡(
¥
->
u
.
gë£t
.
gëãr
)

7371 
desc
->
gëãr
 = 
	`JS_DupVÆue
(
˘x
, 
	`JS_MKPTR
(
JS_TAG_OBJECT
, 
¥
->
u
.
gë£t
.getter));

7372 i‡(
¥
->
u
.
gë£t
.
£âî
)

7373 
desc
->
£âî
 = 
	`JS_DupVÆue
(
˘x
, 
	`JS_MKPTR
(
JS_TAG_OBJECT
, 
¥
->
u
.
gë£t
.setter));

7374 } i‡((
¥s
->
Êags
 & 
JS_PROP_TMASK
Ë=
JS_PROP_VARREF
) {

7375 
JSVÆue
 
vÆ
 = *
¥
->
u
.
v¨_ªf
->
pvÆue
;

7376 i‡(
	`u∆ikñy
(
	`JS_IsUnöôülized
(
vÆ
))) {

7377 
	`JS_ThrowRe„ªn˚Eº‹Unöôülized
(
˘x
, 
¥s
->
©om
);

7380 
desc
->
vÆue
 = 
	`JS_DupVÆue
(
˘x
, 
vÆ
);

7381 } i‡((
¥s
->
Êags
 & 
JS_PROP_TMASK
Ë=
JS_PROP_AUTOINIT
) {

7383 i‡(
	`JS_AutoInôPr›îty
(
˘x
, 
p
, 
¥›
, 
¥
))

7385 
ªåy
;

7388 
desc
->
vÆue
 = 
	`JS_DupVÆue
(
˘x
, 
¥
->
u
.value);

7392 i‡(
	`u∆ikñy
((
¥s
->
Êags
 & 
JS_PROP_TMASK
Ë=
JS_PROP_VARREF
)) {

7393 i‡(
	`u∆ikñy
(
	`JS_IsUnöôülized
(*
¥
->
u
.
v¨_ªf
->
pvÆue
))) {

7394 
	`JS_ThrowRe„ªn˚Eº‹Unöôülized
(
˘x
, 
¥s
->
©om
);

7397 } i‡((
¥s
->
Êags
 & 
JS_PROP_TMASK
Ë=
JS_PROP_AUTOINIT
) {

7401  
TRUE
;

7403 i‡(
p
->
is_exŸic
) {

7404 i‡(
p
->
Á°_¨øy
) {

7406 i‡(
	`__JS_AtomIsTaggedI¡
(
¥›
)) {

7407 
uöt32_t
 
idx
;

7408 
idx
 = 
	`__JS_AtomToUI¡32
(
¥›
);

7409 i‡(
idx
 < 
p
->
u
.
¨øy
.
cou¡
) {

7410 i‡(
desc
) {

7411 
desc
->
Êags
 = 
JS_PROP_WRITABLE
 | 
JS_PROP_ENUMERABLE
;

7412 i‡(
p
->
˛ass_id
 =
JS_CLASS_ARRAY
 ||

7413 
p
->
˛ass_id
 =
JS_CLASS_ARGUMENTS
)

7414 
desc
->
Êags
 |
JS_PROP_CONFIGURABLE
;

7415 
desc
->
gëãr
 = 
JS_UNDEFINED
;

7416 
desc
->
£âî
 = 
JS_UNDEFINED
;

7417 
desc
->
vÆue
 = 
	`JS_GëPr›îtyUöt32
(
˘x
, 
	`JS_MKPTR
(
JS_TAG_OBJECT
, 
p
), 
idx
);

7419  
TRUE
;

7422 i‡(
p
->
˛ass_id
 >
JS_CLASS_UINT8C_ARRAY
 &&

7423 
p
->
˛ass_id
 <
JS_CLASS_FLOAT64_ARRAY
) {

7424 
ªt
;

7425 
ªt
 = 
	`JS_AtomIsNumîicIndex
(
˘x
, 
¥›
);

7426 i‡(
ªt
 != 0) {

7427 i‡(
ªt
 < 0)

7429 i‡(
	`ty≥d_¨øy_is_dëached
(
˘x
, 
p
)) {

7430 
	`JS_ThrowTy≥Eº‹DëachedAºayBuf„r
(
˘x
);

7436 c⁄° 
JSCœssExŸicMëhods
 *
em
 = 
˘x
->
π
->
˛ass_¨øy
[
p
->
˛ass_id
].
exŸic
;

7437 i‡(
em
 &&Ém->
gë_own_¥›îty
) {

7438  
em
->
	`gë_own_¥›îty
(
˘x
, 
desc
,

7439 
	`JS_MKPTR
(
JS_TAG_OBJECT
, 
p
), 
¥›
);

7443  
FALSE
;

7444 
	}
}

7446 
	$JS_GëOwnPr›îty
(
JSC⁄ãxt
 *
˘x
, 
JSPr›îtyDes¸ùt‹
 *
desc
,

7447 
JSVÆueC⁄°
 
obj
, 
JSAtom
 
¥›
)

7449 i‡(
	`JS_VALUE_GET_TAG
(
obj
Ë!
JS_TAG_OBJECT
) {

7450 
	`JS_ThrowTy≥Eº‹NŸAnObje˘
(
˘x
);

7453  
	`JS_GëOwnPr›îtyI¡î«l
(
˘x
, 
desc
, 
	`JS_VALUE_GET_OBJ
(
obj
), 
¥›
);

7454 
	}
}

7457 
	$JS_IsExãnsibÀ
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
obj
)

7459 
JSObje˘
 *
p
;

7461 i‡(
	`u∆ikñy
(
	`JS_VALUE_GET_TAG
(
obj
Ë!
JS_TAG_OBJECT
))

7462  
FALSE
;

7463 
p
 = 
	`JS_VALUE_GET_OBJ
(
obj
);

7464 i‡(
	`u∆ikñy
(
p
->
˛ass_id
 =
JS_CLASS_PROXY
))

7465  
	`js_¥oxy_isExãnsibÀ
(
˘x
, 
obj
);

7467  
p
->
exãnsibÀ
;

7468 
	}
}

7471 
	$JS_PªvítExãnsi⁄s
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
obj
)

7473 
JSObje˘
 *
p
;

7475 i‡(
	`u∆ikñy
(
	`JS_VALUE_GET_TAG
(
obj
Ë!
JS_TAG_OBJECT
))

7476  
FALSE
;

7477 
p
 = 
	`JS_VALUE_GET_OBJ
(
obj
);

7478 i‡(
	`u∆ikñy
(
p
->
˛ass_id
 =
JS_CLASS_PROXY
))

7479  
	`js_¥oxy_¥evítExãnsi⁄s
(
˘x
, 
obj
);

7480 
p
->
exãnsibÀ
 = 
FALSE
;

7481  
TRUE
;

7482 
	}
}

7485 
	$JS_HasPr›îty
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
obj
, 
JSAtom
 
¥›
)

7487 
JSObje˘
 *
p
;

7488 
ªt
;

7490 i‡(
	`u∆ikñy
(
	`JS_VALUE_GET_TAG
(
obj
Ë!
JS_TAG_OBJECT
))

7491  
FALSE
;

7492 
p
 = 
	`JS_VALUE_GET_OBJ
(
obj
);

7494 i‡(
p
->
is_exŸic
) {

7495 c⁄° 
JSCœssExŸicMëhods
 *
em
 = 
˘x
->
π
->
˛ass_¨øy
[
p
->
˛ass_id
].
exŸic
;

7496 i‡(
em
 &&Ém->
has_¥›îty
)

7497  
em
->
	`has_¥›îty
(
˘x
, 
	`JS_MKPTR
(
JS_TAG_OBJECT
, 
p
), 
¥›
);

7499 
ªt
 = 
	`JS_GëOwnPr›îtyI¡î«l
(
˘x
, 
NULL
, 
p
, 
¥›
);

7500 i‡(
ªt
 != 0)

7501  
ªt
;

7502 i‡(
p
->
˛ass_id
 >
JS_CLASS_UINT8C_ARRAY
 &&

7503 
p
->
˛ass_id
 <
JS_CLASS_FLOAT64_ARRAY
) {

7504 
ªt
 = 
	`JS_AtomIsNumîicIndex
(
˘x
, 
¥›
);

7505 i‡(
ªt
 != 0) {

7506 i‡(
ªt
 < 0)

7510  
FALSE
;

7513 
p
 =Ö->
sh≠e
->
¥Ÿo
;

7514 i‡(!
p
)

7517  
FALSE
;

7518 
	}
}

7521 
JSAtom
 
	$js_symbﬁ_to_©om
(
JSC⁄ãxt
 *
˘x
, 
JSVÆue
 
vÆ
)

7523 
JSAtomSåu˘
 *
p
 = 
	`JS_VALUE_GET_PTR
(
vÆ
);

7524  
	`js_gë_©om_ödex
(
˘x
->
π
, 
p
);

7525 
	}
}

7528 
JSAtom
 
	$JS_VÆueToAtom
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
vÆ
)

7530 
JSAtom
 
©om
;

7531 
uöt32_t
 
èg
;

7532 
èg
 = 
	`JS_VALUE_GET_TAG
(
vÆ
);

7533 i‡(
èg
 =
JS_TAG_INT
 &&

7534 (
uöt32_t
)
	`JS_VALUE_GET_INT
(
vÆ
Ë<
JS_ATOM_MAX_INT
) {

7536 
©om
 = 
	`__JS_AtomFromUI¡32
(
	`JS_VALUE_GET_INT
(
vÆ
));

7537 } i‡(
èg
 =
JS_TAG_SYMBOL
) {

7538 
JSAtomSåu˘
 *
p
 = 
	`JS_VALUE_GET_PTR
(
vÆ
);

7539 
©om
 = 
	`JS_DupAtom
(
˘x
, 
	`js_gë_©om_ödex
(˘x->
π
, 
p
));

7541 
JSVÆue
 
°r
;

7542 
°r
 = 
	`JS_ToPr›îtyKey
(
˘x
, 
vÆ
);

7543 i‡(
	`JS_IsEx˚±i⁄
(
°r
))

7544  
JS_ATOM_NULL
;

7545 i‡(
	`JS_VALUE_GET_TAG
(
°r
Ë=
JS_TAG_SYMBOL
) {

7546 
©om
 = 
	`js_symbﬁ_to_©om
(
˘x
, 
°r
);

7548 
©om
 = 
	`JS_NewAtomSå
(
˘x
, 
	`JS_VALUE_GET_STRING
(
°r
));

7551  
©om
;

7552 
	}
}

7554 
JSVÆue
 
	$JS_GëPr›îtyVÆue
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_obj
,

7555 
JSVÆue
 
¥›
)

7557 
JSAtom
 
©om
;

7558 
JSVÆue
 
ªt
;

7560 i‡(
	`likñy
(
	`JS_VALUE_GET_TAG
(
this_obj
Ë=
JS_TAG_OBJECT
 &&

7561 
	`JS_VALUE_GET_TAG
(
¥›
Ë=
JS_TAG_INT
)) {

7562 
JSObje˘
 *
p
;

7563 
uöt32_t
 
idx
, 
Àn
;

7565 
p
 = 
	`JS_VALUE_GET_OBJ
(
this_obj
);

7566 
idx
 = 
	`JS_VALUE_GET_INT
(
¥›
);

7567 
Àn
 = (
uöt32_t
)
p
->
u
.
¨øy
.
cou¡
;

7568 i‡(
	`u∆ikñy
(
idx
 >
Àn
))

7569 
¶ow_∑th
;

7570 
p
->
˛ass_id
) {

7571 
JS_CLASS_ARRAY
:

7572 
JS_CLASS_ARGUMENTS
:

7573  
	`JS_DupVÆue
(
˘x
, 
p
->
u
.
¨øy
.u.
vÆues
[
idx
]);

7574 
JS_CLASS_INT8_ARRAY
:

7575  
	`JS_NewI¡32
(
˘x
, 
p
->
u
.
¨øy
.u.
öt8_±r
[
idx
]);

7576 
JS_CLASS_UINT8C_ARRAY
:

7577 
JS_CLASS_UINT8_ARRAY
:

7578  
	`JS_NewI¡32
(
˘x
, 
p
->
u
.
¨øy
.u.
uöt8_±r
[
idx
]);

7579 
JS_CLASS_INT16_ARRAY
:

7580  
	`JS_NewI¡32
(
˘x
, 
p
->
u
.
¨øy
.u.
öt16_±r
[
idx
]);

7581 
JS_CLASS_UINT16_ARRAY
:

7582  
	`JS_NewI¡32
(
˘x
, 
p
->
u
.
¨øy
.u.
uöt16_±r
[
idx
]);

7583 
JS_CLASS_INT32_ARRAY
:

7584  
	`JS_NewI¡32
(
˘x
, 
p
->
u
.
¨øy
.u.
öt32_±r
[
idx
]);

7585 
JS_CLASS_UINT32_ARRAY
:

7586  
	`JS_NewUöt32
(
˘x
, 
p
->
u
.
¨øy
.u.
uöt32_±r
[
idx
]);

7587 #ifde‡
CONFIG_BIGNUM


7588 
JS_CLASS_BIG_INT64_ARRAY
:

7589  
	`JS_NewBigI¡64
(
˘x
, 
p
->
u
.
¨øy
.u.
öt64_±r
[
idx
]);

7590 
JS_CLASS_BIG_UINT64_ARRAY
:

7591  
	`JS_NewBigUöt64
(
˘x
, 
p
->
u
.
¨øy
.u.
uöt64_±r
[
idx
]);

7593 
JS_CLASS_FLOAT32_ARRAY
:

7594  
	`__JS_NewFlﬂt64
(
˘x
, 
p
->
u
.
¨øy
.u.
Êﬂt_±r
[
idx
]);

7595 
JS_CLASS_FLOAT64_ARRAY
:

7596  
	`__JS_NewFlﬂt64
(
˘x
, 
p
->
u
.
¨øy
.u.
doubÀ_±r
[
idx
]);

7598 
¶ow_∑th
;

7601 
¶ow_∑th
:

7602 
©om
 = 
	`JS_VÆueToAtom
(
˘x
, 
¥›
);

7603 
	`JS_FªeVÆue
(
˘x
, 
¥›
);

7604 i‡(
	`u∆ikñy
(
©om
 =
JS_ATOM_NULL
))

7605  
JS_EXCEPTION
;

7606 
ªt
 = 
	`JS_GëPr›îty
(
˘x
, 
this_obj
, 
©om
);

7607 
	`JS_FªeAtom
(
˘x
, 
©om
);

7608  
ªt
;

7610 
	}
}

7612 
JSVÆue
 
	$JS_GëPr›îtyUöt32
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_obj
,

7613 
uöt32_t
 
idx
)

7615  
	`JS_GëPr›îtyVÆue
(
˘x
, 
this_obj
, 
	`JS_NewUöt32
(˘x, 
idx
));

7616 
	}
}

7623 
	$JS_TryGëPr›îtyI¡64
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
obj
, 
söt64_t
 
idx
, 
JSVÆue
 *
pvÆ
)

7625 
JSVÆue
 
vÆ
 = 
JS_UNDEFINED
;

7626 
JSAtom
 
¥›
;

7627 
¥e£¡
;

7629 i‡(
	`likñy
((
uöt64_t
)
idx
 <
JS_ATOM_MAX_INT
)) {

7631 
¥e£¡
 = 
	`JS_HasPr›îty
(
˘x
, 
obj
, 
	`__JS_AtomFromUI¡32
(
idx
));

7632 i‡(
¥e£¡
 > 0) {

7633 
vÆ
 = 
	`JS_GëPr›îtyVÆue
(
˘x
, 
obj
, 
	`JS_NewI¡32
(˘x, 
idx
));

7634 i‡(
	`u∆ikñy
(
	`JS_IsEx˚±i⁄
(
vÆ
)))

7635 
¥e£¡
 = -1;

7638 
¥›
 = 
	`JS_NewAtomI¡64
(
˘x
, 
idx
);

7639 
¥e£¡
 = -1;

7640 i‡(
	`likñy
(
¥›
 !
JS_ATOM_NULL
)) {

7641 
¥e£¡
 = 
	`JS_HasPr›îty
(
˘x
, 
obj
, 
¥›
);

7642 i‡(
¥e£¡
 > 0) {

7643 
vÆ
 = 
	`JS_GëPr›îty
(
˘x
, 
obj
, 
¥›
);

7644 i‡(
	`u∆ikñy
(
	`JS_IsEx˚±i⁄
(
vÆ
)))

7645 
¥e£¡
 = -1;

7647 
	`JS_FªeAtom
(
˘x
, 
¥›
);

7650 *
pvÆ
 = 
vÆ
;

7651  
¥e£¡
;

7652 
	}
}

7654 
JSVÆue
 
	$JS_GëPr›îtyI¡64
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
obj
, 
söt64_t
 
idx
)

7656 
JSAtom
 
¥›
;

7657 
JSVÆue
 
vÆ
;

7659 i‡((
uöt64_t
)
idx
 <
INT32_MAX
) {

7661  
	`JS_GëPr›îtyVÆue
(
˘x
, 
obj
, 
	`JS_NewI¡32
(˘x, 
idx
));

7663 
¥›
 = 
	`JS_NewAtomI¡64
(
˘x
, 
idx
);

7664 i‡(
¥›
 =
JS_ATOM_NULL
)

7665  
JS_EXCEPTION
;

7667 
vÆ
 = 
	`JS_GëPr›îty
(
˘x
, 
obj
, 
¥›
);

7668 
	`JS_FªeAtom
(
˘x
, 
¥›
);

7669  
vÆ
;

7670 
	}
}

7672 
JSVÆue
 
	$JS_GëPr›îtySå
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_obj
,

7673 c⁄° *
¥›
)

7675 
JSAtom
 
©om
;

7676 
JSVÆue
 
ªt
;

7677 
©om
 = 
	`JS_NewAtom
(
˘x
, 
¥›
);

7678 
ªt
 = 
	`JS_GëPr›îty
(
˘x
, 
this_obj
, 
©om
);

7679 
	`JS_FªeAtom
(
˘x
, 
©om
);

7680  
ªt
;

7681 
	}
}

7685 
JSPr›îty
 *
	$add_¥›îty
(
JSC⁄ãxt
 *
˘x
,

7686 
JSObje˘
 *
p
, 
JSAtom
 
¥›
, 
¥›_Êags
)

7688 
JSSh≠e
 *
sh
, *
√w_sh
;

7690 
sh
 = 
p
->
sh≠e
;

7691 i‡(
sh
->
is_hashed
) {

7693 
√w_sh
 = 
	`föd_hashed_sh≠e_¥›
(
˘x
->
π
, 
sh
, 
¥›
, 
¥›_Êags
);

7694 i‡(
√w_sh
) {

7697 i‡(
√w_sh
->
¥›_size
 !
sh
->prop_size) {

7698 
JSPr›îty
 *
√w_¥›
;

7699 
√w_¥›
 = 
	`js_ªÆloc
(
˘x
, 
p
->
¥›
, (p->prop[0]) *

7700 
√w_sh
->
¥›_size
);

7701 i‡(!
√w_¥›
)

7702  
NULL
;

7703 
p
->
¥›
 = 
√w_¥›
;

7705 
p
->
sh≠e
 = 
	`js_dup_sh≠e
(
√w_sh
);

7706 
	`js_‰ì_sh≠e
(
˘x
->
π
, 
sh
);

7707  &
p
->
¥›
[
√w_sh
->
¥›_cou¡
 - 1];

7708 } i‡(
sh
->
hódî
.
ªf_cou¡
 != 1) {

7710 
√w_sh
 = 
	`js_˛⁄e_sh≠e
(
˘x
, 
sh
);

7711 i‡(!
√w_sh
)

7712  
NULL
;

7714 
√w_sh
->
is_hashed
 = 
TRUE
;

7715 
	`js_sh≠e_hash_lök
(
˘x
->
π
, 
√w_sh
);

7716 
	`js_‰ì_sh≠e
(
˘x
->
π
, 
p
->
sh≠e
);

7717 
p
->
sh≠e
 = 
√w_sh
;

7720 
	`as£π
(
p
->
sh≠e
->
hódî
.
ªf_cou¡
 == 1);

7721 i‡(
	`add_sh≠e_¥›îty
(
˘x
, &
p
->
sh≠e
,Ö, 
¥›
, 
¥›_Êags
))

7722  
NULL
;

7723  &
p
->
¥›
[p->
sh≠e
->
¥›_cou¡
 - 1];

7724 
	}
}

7728 
no_ölöe
 
__ex˚±i⁄
 
	$c⁄vît_Á°_¨øy_to_¨øy
(
JSC⁄ãxt
 *
˘x
,

7729 
JSObje˘
 *
p
)

7731 
JSPr›îty
 *
¥
;

7732 
JSSh≠e
 *
sh
;

7733 
JSVÆue
 *
èb
;

7734 
uöt32_t
 
i
, 
Àn
, 
√w_cou¡
;

7736 i‡(
	`js_sh≠e_¥ï¨e_upd©e
(
˘x
, 
p
, 
NULL
))

7738 
Àn
 = 
p
->
u
.
¨øy
.
cou¡
;

7740 
sh
 = 
p
->
sh≠e
;

7741 
√w_cou¡
 = 
sh
->
¥›_cou¡
 + 
Àn
;

7742 i‡(
√w_cou¡
 > 
sh
->
¥›_size
) {

7743 i‡(
	`ªsize_¥›îtõs
(
˘x
, &
p
->
sh≠e
,Ö, 
√w_cou¡
))

7747 
èb
 = 
p
->
u
.
¨øy
.u.
vÆues
;

7748 
i
 = 0; i < 
Àn
; i++) {

7751 
¥
 = 
	`add_¥›îty
(
˘x
, 
p
, 
	`__JS_AtomFromUI¡32
(
i
), 
JS_PROP_C_W_E
);

7752 
¥
->
u
.
vÆue
 = *
èb
++;

7754 
	`js_‰ì
(
˘x
, 
p
->
u
.
¨øy
.u.
vÆues
);

7755 
p
->
u
.
¨øy
.
cou¡
 = 0;

7756 
p
->
u
.
¨øy
.u.
vÆues
 = 
NULL
;

7757 
p
->
u
.
¨øy
.
u1
.
size
 = 0;

7758 
p
->
Á°_¨øy
 = 0;

7760 
	}
}

7762 
	$dñëe_¥›îty
(
JSC⁄ãxt
 *
˘x
, 
JSObje˘
 *
p
, 
JSAtom
 
©om
)

7764 
JSSh≠e
 *
sh
;

7765 
JSSh≠ePr›îty
 *
¥
, *
Õr
, *
¥›
;

7766 
JSPr›îty
 *
¥1
;

7767 
uöt32_t
 
Õr_idx
;

7768 
öçå_t
 
h
, 
h1
;

7770 
ªdo
:

7771 
sh
 = 
p
->
sh≠e
;

7772 
h1
 = 
©om
 & 
sh
->
¥›_hash_mask
;

7773 
h
 = 
sh
->
¥›_hash_íd
[-
h1
 - 1];

7774 
¥›
 = 
	`gë_sh≠e_¥›
(
sh
);

7775 
Õr
 = 
NULL
;

7776 
Õr_idx
 = 0;

7777 
h
 != 0) {

7778 
¥
 = &
¥›
[
h
 - 1];

7779 i‡(
	`likñy
(
¥
->
©om
 ==átom)) {

7781 i‡(!(
¥
->
Êags
 & 
JS_PROP_CONFIGURABLE
))

7782  
FALSE
;

7784 i‡(
Õr
)

7785 
Õr_idx
 = 
Õr
 - 
	`gë_sh≠e_¥›
(
sh
);

7786 i‡(
	`js_sh≠e_¥ï¨e_upd©e
(
˘x
, 
p
, &
¥
))

7788 
sh
 = 
p
->
sh≠e
;

7790 i‡(
Õr
) {

7791 
Õr
 = 
	`gë_sh≠e_¥›
(
sh
Ë+ 
Õr_idx
;

7792 
Õr
->
hash_√xt
 = 
¥
->hash_next;

7794 
sh
->
¥›_hash_íd
[-
h1
 - 1] = 
¥
->
hash_√xt
;

7797 
¥1
 = &
p
->
¥›
[
h
 - 1];

7798 
	`‰ì_¥›îty
(
˘x
->
π
, 
¥1
, 
¥
->
Êags
);

7799 
	`JS_FªeAtom
(
˘x
, 
¥
->
©om
);

7801 
¥
->
Êags
 = 0;

7802 
¥
->
©om
 = 
JS_ATOM_NULL
;

7803 
¥1
->
u
.
vÆue
 = 
JS_UNDEFINED
;

7804  
TRUE
;

7806 
Õr
 = 
¥
;

7807 
h
 = 
¥
->
hash_√xt
;

7810 i‡(
p
->
is_exŸic
) {

7811 i‡(
p
->
Á°_¨øy
) {

7812 
uöt32_t
 
idx
;

7813 i‡(
	`JS_AtomIsAºayIndex
(
˘x
, &
idx
, 
©om
) &&

7814 
idx
 < 
p
->
u
.
¨øy
.
cou¡
) {

7815 i‡(
p
->
˛ass_id
 =
JS_CLASS_ARRAY
 ||

7816 
p
->
˛ass_id
 =
JS_CLASS_ARGUMENTS
) {

7818 i‡(
idx
 =
p
->
u
.
¨øy
.
cou¡
 - 1) {

7819 
	`JS_FªeVÆue
(
˘x
, 
p
->
u
.
¨øy
.u.
vÆues
[
idx
]);

7820 
p
->
u
.
¨øy
.
cou¡
 = 
idx
;

7821  
TRUE
;

7823 i‡(
	`c⁄vît_Á°_¨øy_to_¨øy
(
˘x
, 
p
))

7825 
ªdo
;

7827  
FALSE
;

7831 c⁄° 
JSCœssExŸicMëhods
 *
em
 = 
˘x
->
π
->
˛ass_¨øy
[
p
->
˛ass_id
].
exŸic
;

7832 i‡(
em
 &&Ém->
dñëe_¥›îty
) {

7833  
em
->
	`dñëe_¥›îty
(
˘x
, 
	`JS_MKPTR
(
JS_TAG_OBJECT
, 
p
), 
©om
);

7838  
TRUE
;

7839 
	}
}

7841 
	$ˇŒ_£âî
(
JSC⁄ãxt
 *
˘x
, 
JSObje˘
 *
£âî
,

7842 
JSVÆueC⁄°
 
this_obj
, 
JSVÆue
 
vÆ
, 
Êags
)

7844 
JSVÆue
 
ªt
, 
func
;

7845 i‡(
	`likñy
(
£âî
)) {

7846 
func
 = 
	`JS_MKPTR
(
JS_TAG_OBJECT
, 
£âî
);

7848 
func
 = 
	`JS_DupVÆue
(
˘x
, func);

7849 
ªt
 = 
	`JS_CÆlFªe
(
˘x
, 
func
, 
this_obj
, 1, (
JSVÆueC⁄°
 *)&
vÆ
);

7850 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

7851 i‡(
	`JS_IsEx˚±i⁄
(
ªt
))

7853 
	`JS_FªeVÆue
(
˘x
, 
ªt
);

7854  
TRUE
;

7856 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

7857 i‡((
Êags
 & 
JS_PROP_THROW
) ||

7858 ((
Êags
 & 
JS_PROP_THROW_STRICT
Ë&& 
	`is_°ri˘_mode
(
˘x
))) {

7859 
	`JS_ThrowTy≥Eº‹
(
˘x
, "no setter forÖroperty");

7862  
FALSE
;

7864 
	}
}

7867 
	$£t_¨øy_Àngth
(
JSC⁄ãxt
 *
˘x
, 
JSObje˘
 *
p
, 
JSPr›îty
 *
¥›
,

7868 
JSVÆue
 
vÆ
, 
Êags
)

7870 
uöt32_t
 
Àn
, 
idx
, 
cur_Àn
;

7871 
i
, 
ªt
;

7873 
ªt
 = 
	`JS_ToAºayLígthFªe
(
˘x
, &
Àn
, 
vÆ
);

7874 i‡(
ªt
)

7876 i‡(
	`likñy
(
p
->
Á°_¨øy
)) {

7877 
uöt32_t
 
ﬁd_Àn
 = 
p
->
u
.
¨øy
.
cou¡
;

7878 i‡(
Àn
 < 
ﬁd_Àn
) {

7879 
i
 = 
Àn
; i < 
ﬁd_Àn
; i++) {

7880 
	`JS_FªeVÆue
(
˘x
, 
p
->
u
.
¨øy
.u.
vÆues
[
i
]);

7882 
p
->
u
.
¨øy
.
cou¡
 = 
Àn
;

7884 
¥›
->
u
.
vÆue
 = 
	`JS_NewUöt32
(
˘x
, 
Àn
);

7888 
	`JS_ToUöt32
(
˘x
, &
cur_Àn
, 
¥›
->
u
.
vÆue
);

7889 i‡(
Àn
 < 
cur_Àn
) {

7890 
uöt32_t
 
d
;

7891 
JSSh≠e
 *
sh
;

7892 
JSSh≠ePr›îty
 *
¥
;

7894 
d
 = 
cur_Àn
 - 
Àn
;

7895 
sh
 = 
p
->
sh≠e
;

7896 i‡(
d
 <
sh
->
¥›_cou¡
) {

7897 
JSAtom
 
©om
;

7900 
cur_Àn
 > 
Àn
) {

7901 
©om
 = 
	`JS_NewAtomUI¡32
(
˘x
, 
cur_Àn
 - 1);

7902 
ªt
 = 
	`dñëe_¥›îty
(
˘x
, 
p
, 
©om
);

7903 
	`JS_FªeAtom
(
˘x
, 
©om
);

7904 i‡(
	`u∆ikñy
(!
ªt
)) {

7909 
cur_Àn
--;

7915 
cur_Àn
 = 
Àn
;

7916 
i
 = 0, 
¥
 = 
	`gë_sh≠e_¥›
(
sh
); i < sh->
¥›_cou¡
;

7917 
i
++, 
¥
++) {

7918 i‡(
¥
->
©om
 !
JS_ATOM_NULL
 &&

7919 
	`JS_AtomIsAºayIndex
(
˘x
, &
idx
, 
¥
->
©om
)) {

7920 i‡(
idx
 >
cur_Àn
 &&

7921 !(
¥
->
Êags
 & 
JS_PROP_CONFIGURABLE
)) {

7922 
cur_Àn
 = 
idx
 + 1;

7927 
i
 = 0, 
¥
 = 
	`gë_sh≠e_¥›
(
sh
); i < sh->
¥›_cou¡
;

7928 
i
++, 
¥
++) {

7929 i‡(
¥
->
©om
 !
JS_ATOM_NULL
 &&

7930 
	`JS_AtomIsAºayIndex
(
˘x
, &
idx
, 
¥
->
©om
)) {

7931 i‡(
idx
 >
cur_Àn
) {

7933 
	`dñëe_¥›îty
(
˘x
, 
p
, 
¥
->
©om
);

7935 
sh
 = 
p
->
sh≠e
;

7936 
¥
 = 
	`gë_sh≠e_¥›
(
sh
Ë+ 
i
;

7942 
cur_Àn
 = 
Àn
;

7944 
	`£t_vÆue
(
˘x
, &
p
->
¥›
[0].
u
.
vÆue
, 
	`JS_NewUöt32
(˘x, 
cur_Àn
));

7945 i‡(
	`u∆ikñy
(
cur_Àn
 > 
Àn
)) {

7946  
	`JS_ThrowTy≥Eº‹OrFÆ£
(
˘x
, 
Êags
, "not configurable");

7949  
TRUE
;

7950 
	}
}

7954 
	$add_Á°_¨øy_ñemít
(
JSC⁄ãxt
 *
˘x
, 
JSObje˘
 *
p
,

7955 
JSVÆue
 
vÆ
, 
Êags
)

7957 
uöt32_t
 
√w_Àn
, 
¨øy_Àn
;

7960 
√w_Àn
 = 
p
->
u
.
¨øy
.
cou¡
 + 1;

7963 i‡(
	`likñy
(
	`JS_VALUE_GET_TAG
(
p
->
¥›
[0].
u
.
vÆue
Ë=
JS_TAG_INT
)) {

7964 
¨øy_Àn
 = 
	`JS_VALUE_GET_INT
(
p
->
¥›
[0].
u
.
vÆue
);

7965 i‡(
√w_Àn
 > 
¨øy_Àn
) {

7966 i‡(
	`u∆ikñy
(!(
	`gë_sh≠e_¥›
(
p
->
sh≠e
)->
Êags
 & 
JS_PROP_WRITABLE
))) {

7967 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

7968  
	`JS_ThrowTy≥Eº‹RódO∆y
(
˘x
, 
Êags
, 
JS_ATOM_Àngth
);

7970 
p
->
¥›
[0].
u
.
vÆue
 = 
	`JS_NewI¡32
(
˘x
, 
√w_Àn
);

7973 i‡(
	`u∆ikñy
(
√w_Àn
 > 
p
->
u
.
¨øy
.
u1
.
size
)) {

7974 
uöt32_t
 
√w_size
;

7975 
size_t
 
¶ack
;

7976 
JSVÆue
 *
√w_¨øy_¥›
;

7978 
√w_size
 = 
	`max_öt
(
√w_Àn
, 
p
->
u
.
¨øy
.
u1
.
size
 * 3 / 2);

7979 
√w_¨øy_¥›
 = 
	`js_ªÆloc2
(
˘x
, 
p
->
u
.
¨øy
.u.
vÆues
, (
JSVÆue
Ë* 
√w_size
, &
¶ack
);

7980 i‡(!
√w_¨øy_¥›
) {

7981 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

7984 
√w_size
 +
¶ack
 / (*
√w_¨øy_¥›
);

7985 
p
->
u
.
¨øy
.u.
vÆues
 = 
√w_¨øy_¥›
;

7986 
p
->
u
.
¨øy
.
u1
.
size
 = 
√w_size
;

7988 
p
->
u
.
¨øy
.u.
vÆues
[
√w_Àn
 - 1] = 
vÆ
;

7989 
p
->
u
.
¨øy
.
cou¡
 = 
√w_Àn
;

7990  
TRUE
;

7991 
	}
}

7993 
	$js_‰ì_desc
(
JSC⁄ãxt
 *
˘x
, 
JSPr›îtyDes¸ùt‹
 *
desc
)

7995 
	`JS_FªeVÆue
(
˘x
, 
desc
->
gëãr
);

7996 
	`JS_FªeVÆue
(
˘x
, 
desc
->
£âî
);

7997 
	`JS_FªeVÆue
(
˘x
, 
desc
->
vÆue
);

7998 
	}
}

8001 
	$JS_SëPr›îtyGíîic
(
JSC⁄ãxt
 *
˘x
,

8002 
JSObje˘
 *
p
, 
JSAtom
 
¥›
,

8003 
JSVÆue
 
vÆ
, 
JSVÆueC⁄°
 
this_obj
,

8004 
Êags
)

8006 
ªt
;

8007 
JSPr›îtyDes¸ùt‹
 
desc
;

8009 
p
 !
NULL
) {

8010 i‡(
p
->
is_exŸic
) {

8011 c⁄° 
JSCœssExŸicMëhods
 *
em
 = 
˘x
->
π
->
˛ass_¨øy
[
p
->
˛ass_id
].
exŸic
;

8012 i‡(
em
 &&Ém->
£t_¥›îty
) {

8013 
ªt
 = 
em
->
	`£t_¥›îty
(
˘x
, 
	`JS_MKPTR
(
JS_TAG_OBJECT
, 
p
), 
¥›
,

8014 
vÆ
, 
this_obj
, 
Êags
);

8015 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

8016  
ªt
;

8020 
ªt
 = 
	`JS_GëOwnPr›îtyI¡î«l
(
˘x
, &
desc
, 
p
, 
¥›
);

8021 i‡(
ªt
 < 0)

8022  
ªt
;

8023 i‡(
ªt
) {

8024 i‡(
desc
.
Êags
 & 
JS_PROP_GETSET
) {

8025 
JSObje˘
 *
£âî
;

8026 i‡(
	`JS_IsUndeföed
(
desc
.
£âî
))

8027 
£âî
 = 
NULL
;

8029 
£âî
 = 
	`JS_VALUE_GET_OBJ
(
desc
.setter);

8030 
ªt
 = 
	`ˇŒ_£âî
(
˘x
, 
£âî
, 
this_obj
, 
vÆ
, 
Êags
);

8031 
	`JS_FªeVÆue
(
˘x
, 
desc
.
gëãr
);

8032 
	`JS_FªeVÆue
(
˘x
, 
desc
.
£âî
);

8033  
ªt
;

8035 
	`JS_FªeVÆue
(
˘x
, 
desc
.
vÆue
);

8036 i‡(!(
desc
.
Êags
 & 
JS_PROP_WRITABLE
)) {

8037 
ªad_⁄ly_îr‹
;

8042 
p
 =Ö->
sh≠e
->
¥Ÿo
;

8045 i‡(!
	`JS_IsObje˘
(
this_obj
))

8046  
	`JS_ThrowTy≥Eº‹OrFÆ£
(
˘x
, 
Êags
, "receiver isÇotán object");

8048 
p
 = 
	`JS_VALUE_GET_OBJ
(
this_obj
);

8051 
ªt
 = 
	`JS_GëOwnPr›îtyI¡î«l
(
˘x
, &
desc
, 
p
, 
¥›
);

8052 i‡(
ªt
 < 0)

8053  
ªt
;

8054 i‡(
ªt
) {

8055 i‡(
desc
.
Êags
 & 
JS_PROP_GETSET
) {

8056 
	`JS_FªeVÆue
(
˘x
, 
desc
.
gëãr
);

8057 
	`JS_FªeVÆue
(
˘x
, 
desc
.
£âî
);

8058 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

8059  
	`JS_ThrowTy≥Eº‹OrFÆ£
(
˘x
, 
Êags
, "setter is forbidden");

8061 
	`JS_FªeVÆue
(
˘x
, 
desc
.
vÆue
);

8062 i‡(!(
desc
.
Êags
 & 
JS_PROP_WRITABLE
) ||

8063 
p
->
˛ass_id
 =
JS_CLASS_MODULE_NS
) {

8064 
ªad_⁄ly_îr‹
:

8065 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

8066  
	`JS_ThrowTy≥Eº‹RódO∆y
(
˘x
, 
Êags
, 
¥›
);

8069 
ªt
 = 
	`JS_DeföePr›îty
(
˘x
, 
this_obj
, 
¥›
, 
vÆ
,

8070 
JS_UNDEFINED
, JS_UNDEFINED,

8071 
JS_PROP_HAS_VALUE
);

8072 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

8073  
ªt
;

8076 
ªt
 = 
	`JS_Cª©ePr›îty
(
˘x
, 
p
, 
¥›
, 
vÆ
, 
JS_UNDEFINED
, JS_UNDEFINED,

8077 
Êags
 |

8078 
JS_PROP_HAS_VALUE
 |

8079 
JS_PROP_HAS_ENUMERABLE
 |

8080 
JS_PROP_HAS_WRITABLE
 |

8081 
JS_PROP_HAS_CONFIGURABLE
 |

8082 
JS_PROP_C_W_E
);

8083 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

8084  
ªt
;

8085 
	}
}

8091 
	$JS_SëPr›îtyI¡î«l
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_obj
,

8092 
JSAtom
 
¥›
, 
JSVÆue
 
vÆ
, 
Êags
)

8094 
JSObje˘
 *
p
, *
p1
;

8095 
JSSh≠ePr›îty
 *
¥s
;

8096 
JSPr›îty
 *
¥
;

8097 
uöt32_t
 
èg
;

8098 
JSPr›îtyDes¸ùt‹
 
desc
;

8099 
ªt
;

8101 
	`¥ötf
("JS_SëPr›îtyI¡î«l: "); 
	`¥öt_©om
(
˘x
, 
¥›
);Örintf("\n");

8103 
èg
 = 
	`JS_VALUE_GET_TAG
(
this_obj
);

8104 i‡(
	`u∆ikñy
(
èg
 !
JS_TAG_OBJECT
)) {

8105 
èg
) {

8106 
JS_TAG_NULL
:

8107 
JS_TAG_UNDEFINED
:

8108 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

8109 
	`JS_ThrowTy≥Eº‹
(
˘x
, "value hasÇoÖroperty");

8113 
p
 = 
NULL
;

8114 
p1
 = 
	`JS_VALUE_GET_OBJ
(
	`JS_GëPrŸŸy≥
(
˘x
, 
this_obj
));

8115 
¥ŸŸy≥_lookup
;

8118 
p
 = 
	`JS_VALUE_GET_OBJ
(
this_obj
);

8119 
ªåy
:

8120 
¥s
 = 
	`föd_own_¥›îty
(&
¥
, 
p
, 
¥›
);

8121 i‡(
¥s
) {

8122 i‡(
	`likñy
((
¥s
->
Êags
 & (
JS_PROP_TMASK
 | 
JS_PROP_WRITABLE
 |

8123 
JS_PROP_LENGTH
)Ë=
JS_PROP_WRITABLE
)) {

8125 
	`£t_vÆue
(
˘x
, &
¥
->
u
.
vÆue
, 
vÆ
);

8126  
TRUE
;

8127 } i‡((
¥s
->
Êags
 & (
JS_PROP_LENGTH
 | 
JS_PROP_WRITABLE
)) ==

8128 (
JS_PROP_LENGTH
 | 
JS_PROP_WRITABLE
)) {

8129 
	`as£π
(
p
->
˛ass_id
 =
JS_CLASS_ARRAY
);

8130 
	`as£π
(
¥›
 =
JS_ATOM_Àngth
);

8131  
	`£t_¨øy_Àngth
(
˘x
, 
p
, 
¥
, 
vÆ
, 
Êags
);

8132 } i‡((
¥s
->
Êags
 & 
JS_PROP_TMASK
Ë=
JS_PROP_GETSET
) {

8133  
	`ˇŒ_£âî
(
˘x
, 
¥
->
u
.
gë£t
.
£âî
, 
this_obj
, 
vÆ
, 
Êags
);

8134 } i‡((
¥s
->
Êags
 & 
JS_PROP_TMASK
Ë=
JS_PROP_VARREF
) {

8138 i‡(
p
->
˛ass_id
 =
JS_CLASS_MODULE_NS
)

8139 
ªad_⁄ly_¥›
;

8140 
	`£t_vÆue
(
˘x
, 
¥
->
u
.
v¨_ªf
->
pvÆue
, 
vÆ
);

8141  
TRUE
;

8142 } i‡((
¥s
->
Êags
 & 
JS_PROP_TMASK
Ë=
JS_PROP_AUTOINIT
) {

8144 i‡(
	`JS_AutoInôPr›îty
(
˘x
, 
p
, 
¥›
, 
¥
)) {

8145 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

8148 
ªåy
;

8150 
ªad_⁄ly_¥›
;

8154 
p1
 = 
p
;

8156 i‡(
p1
->
is_exŸic
) {

8157 i‡(
p1
->
Á°_¨øy
) {

8158 i‡(
	`__JS_AtomIsTaggedI¡
(
¥›
)) {

8159 
uöt32_t
 
idx
 = 
	`__JS_AtomToUI¡32
(
¥›
);

8160 i‡(
idx
 < 
p1
->
u
.
¨øy
.
cou¡
) {

8161 i‡(
	`u∆ikñy
(
p
 =
p1
))

8162  
	`JS_SëPr›îtyVÆue
(
˘x
, 
this_obj
, 
	`JS_NewI¡32
(˘x, 
idx
), 
vÆ
, 
Êags
);

8165 } i‡(
p1
->
˛ass_id
 >
JS_CLASS_UINT8C_ARRAY
 &&

8166 
p1
->
˛ass_id
 <
JS_CLASS_FLOAT64_ARRAY
) {

8167 
ty≥d_¨øy_oob
;

8169 } i‡(
p1
->
˛ass_id
 >
JS_CLASS_UINT8C_ARRAY
 &&

8170 
p1
->
˛ass_id
 <
JS_CLASS_FLOAT64_ARRAY
) {

8171 
ªt
 = 
	`JS_AtomIsNumîicIndex
(
˘x
, 
¥›
);

8172 i‡(
ªt
 != 0) {

8173 i‡(
ªt
 < 0) {

8174 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

8177 
ty≥d_¨øy_oob
:

8178 
vÆ
 = 
	`JS_ToNumbîFªe
(
˘x
, val);

8179 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

8180 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

8182 i‡(
	`ty≥d_¨øy_is_dëached
(
˘x
, 
p1
)) {

8183 
	`JS_ThrowTy≥Eº‹DëachedAºayBuf„r
(
˘x
);

8186  
	`JS_ThrowTy≥Eº‹OrFÆ£
(
˘x
, 
Êags
, "out-of-boundÇumeric index");

8190 c⁄° 
JSCœssExŸicMëhods
 *
em
 = 
˘x
->
π
->
˛ass_¨øy
[
p1
->
˛ass_id
].
exŸic
;

8191 i‡(
em
) {

8192 i‡(
em
->
£t_¥›îty
) {

8193 
ªt
 = 
em
->
	`£t_¥›îty
(
˘x
, 
	`JS_MKPTR
(
JS_TAG_OBJECT
, 
p1
), 
¥›
,

8194 
vÆ
, 
this_obj
, 
Êags
);

8195 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

8196  
ªt
;

8198 i‡(
em
->
gë_own_¥›îty
) {

8199 
ªt
 = 
em
->
	`gë_own_¥›îty
(
˘x
, &
desc
,

8200 
	`JS_MKPTR
(
JS_TAG_OBJECT
, 
p1
), 
¥›
);

8201 i‡(
ªt
 < 0) {

8202 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

8203  
ªt
;

8205 i‡(
ªt
) {

8206 i‡(
desc
.
Êags
 & 
JS_PROP_GETSET
) {

8207 
JSObje˘
 *
£âî
;

8208 i‡(
	`JS_IsUndeföed
(
desc
.
£âî
))

8209 
£âî
 = 
NULL
;

8211 
£âî
 = 
	`JS_VALUE_GET_OBJ
(
desc
.setter);

8212 
ªt
 = 
	`ˇŒ_£âî
(
˘x
, 
£âî
, 
this_obj
, 
vÆ
, 
Êags
);

8213 
	`JS_FªeVÆue
(
˘x
, 
desc
.
gëãr
);

8214 
	`JS_FªeVÆue
(
˘x
, 
desc
.
£âî
);

8215  
ªt
;

8217 
	`JS_FªeVÆue
(
˘x
, 
desc
.
vÆue
);

8218 i‡(!(
desc
.
Êags
 & 
JS_PROP_WRITABLE
))

8219 
ªad_⁄ly_¥›
;

8220 i‡(
	`likñy
(
p
 =
p1
)) {

8221 
ªt
 = 
	`JS_DeföePr›îty
(
˘x
, 
this_obj
, 
¥›
, 
vÆ
,

8222 
JS_UNDEFINED
, JS_UNDEFINED,

8223 
JS_PROP_HAS_VALUE
);

8224 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

8225  
ªt
;

8235 
p1
 =Ö1->
sh≠e
->
¥Ÿo
;

8236 
¥ŸŸy≥_lookup
:

8237 i‡(!
p1
)

8240 
ªåy2
:

8241 
¥s
 = 
	`föd_own_¥›îty
(&
¥
, 
p1
, 
¥›
);

8242 i‡(
¥s
) {

8243 i‡((
¥s
->
Êags
 & 
JS_PROP_TMASK
Ë=
JS_PROP_GETSET
) {

8244  
	`ˇŒ_£âî
(
˘x
, 
¥
->
u
.
gë£t
.
£âî
, 
this_obj
, 
vÆ
, 
Êags
);

8245 } i‡((
¥s
->
Êags
 & 
JS_PROP_TMASK
Ë=
JS_PROP_AUTOINIT
) {

8247 i‡(
	`JS_AutoInôPr›îty
(
˘x
, 
p1
, 
¥›
, 
¥
))

8249 
ªåy2
;

8250 } i‡(!(
¥s
->
Êags
 & 
JS_PROP_WRITABLE
)) {

8251 
ªad_⁄ly_¥›
:

8252 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

8253  
	`JS_ThrowTy≥Eº‹RódO∆y
(
˘x
, 
Êags
, 
¥›
);

8258 i‡(
	`u∆ikñy
(
Êags
 & 
JS_PROP_NO_ADD
)) {

8259 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

8260 
	`JS_ThrowRe„ªn˚Eº‹NŸDeföed
(
˘x
, 
¥›
);

8264 i‡(
	`u∆ikñy
(!
p
)) {

8265 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

8266  
	`JS_ThrowTy≥Eº‹OrFÆ£
(
˘x
, 
Êags
, "notán object");

8269 i‡(
	`u∆ikñy
(!
p
->
exãnsibÀ
)) {

8270 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

8271  
	`JS_ThrowTy≥Eº‹OrFÆ£
(
˘x
, 
Êags
, "object isÇotÉxtensible");

8274 i‡(
p
->
is_exŸic
) {

8275 i‡(
p
->
˛ass_id
 =
JS_CLASS_ARRAY
 &&Ö->
Á°_¨øy
 &&

8276 
	`__JS_AtomIsTaggedI¡
(
¥›
)) {

8277 
uöt32_t
 
idx
 = 
	`__JS_AtomToUI¡32
(
¥›
);

8278 i‡(
idx
 =
p
->
u
.
¨øy
.
cou¡
) {

8280  
	`add_Á°_¨øy_ñemít
(
˘x
, 
p
, 
vÆ
, 
Êags
);

8282 
gíîic_¸óã_¥›
;

8285 
gíîic_¸óã_¥›
:

8286 
ªt
 = 
	`JS_Cª©ePr›îty
(
˘x
, 
p
, 
¥›
, 
vÆ
, 
JS_UNDEFINED
, JS_UNDEFINED,

8287 
Êags
 |

8288 
JS_PROP_HAS_VALUE
 |

8289 
JS_PROP_HAS_ENUMERABLE
 |

8290 
JS_PROP_HAS_WRITABLE
 |

8291 
JS_PROP_HAS_CONFIGURABLE
 |

8292 
JS_PROP_C_W_E
);

8293 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

8294  
ªt
;

8298 
¥
 = 
	`add_¥›îty
(
˘x
, 
p
, 
¥›
, 
JS_PROP_C_W_E
);

8299 i‡(
	`u∆ikñy
(!
¥
)) {

8300 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

8303 
¥
->
u
.
vÆue
 = 
vÆ
;

8304  
TRUE
;

8305 
	}
}

8308 
	$JS_SëPr›îtyVÆue
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_obj
,

8309 
JSVÆue
 
¥›
, JSVÆuê
vÆ
, 
Êags
)

8311 i‡(
	`likñy
(
	`JS_VALUE_GET_TAG
(
this_obj
Ë=
JS_TAG_OBJECT
 &&

8312 
	`JS_VALUE_GET_TAG
(
¥›
Ë=
JS_TAG_INT
)) {

8313 
JSObje˘
 *
p
;

8314 
uöt32_t
 
idx
;

8315 
d
;

8316 
öt32_t
 
v
;

8319 
p
 = 
	`JS_VALUE_GET_OBJ
(
this_obj
);

8320 
idx
 = 
	`JS_VALUE_GET_INT
(
¥›
);

8321 
p
->
˛ass_id
) {

8322 
JS_CLASS_ARRAY
:

8323 i‡(
	`u∆ikñy
(
idx
 >(
uöt32_t
)
p
->
u
.
¨øy
.
cou¡
)) {

8324 
JSObje˘
 *
p1
;

8325 
JSSh≠e
 *
sh1
;

8328 i‡(
idx
 !(
uöt32_t
)
p
->
u
.
¨øy
.
cou¡
 ||

8329 !
p
->
Á°_¨øy
 || !p->
exãnsibÀ
)

8330 
¶ow_∑th
;

8332 
p1
 = 
p
->
sh≠e
->
¥Ÿo
;

8333 
p1
 !
NULL
) {

8334 
sh1
 = 
p1
->
sh≠e
;

8335 i‡(
p1
->
˛ass_id
 =
JS_CLASS_ARRAY
) {

8336 i‡(
	`u∆ikñy
(!
p1
->
Á°_¨øy
))

8337 
¶ow_∑th
;

8338 } i‡(
p1
->
˛ass_id
 =
JS_CLASS_OBJECT
) {

8339 i‡(
	`u∆ikñy
(
sh1
->
has_smÆl_¨øy_ödex
))

8340 
¶ow_∑th
;

8342 
¶ow_∑th
;

8344 
p1
 = 
sh1
->
¥Ÿo
;

8347  
	`add_Á°_¨øy_ñemít
(
˘x
, 
p
, 
vÆ
, 
Êags
);

8349 
	`£t_vÆue
(
˘x
, &
p
->
u
.
¨øy
.u.
vÆues
[
idx
], 
vÆ
);

8351 
JS_CLASS_ARGUMENTS
:

8352 i‡(
	`u∆ikñy
(
idx
 >(
uöt32_t
)
p
->
u
.
¨øy
.
cou¡
))

8353 
¶ow_∑th
;

8354 
	`£t_vÆue
(
˘x
, &
p
->
u
.
¨øy
.u.
vÆues
[
idx
], 
vÆ
);

8356 
JS_CLASS_UINT8C_ARRAY
:

8357 i‡(
	`JS_ToUöt8CœmpFªe
(
˘x
, &
v
, 
vÆ
))

8361 i‡(
	`u∆ikñy
(
idx
 >(
uöt32_t
)
p
->
u
.
¨øy
.
cou¡
))

8362 
è_out_of_bound
;

8363 
p
->
u
.
¨øy
.u.
uöt8_±r
[
idx
] = 
v
;

8365 
JS_CLASS_INT8_ARRAY
:

8366 
JS_CLASS_UINT8_ARRAY
:

8367 i‡(
	`JS_ToI¡32Fªe
(
˘x
, &
v
, 
vÆ
))

8369 i‡(
	`u∆ikñy
(
idx
 >(
uöt32_t
)
p
->
u
.
¨øy
.
cou¡
))

8370 
è_out_of_bound
;

8371 
p
->
u
.
¨øy
.u.
uöt8_±r
[
idx
] = 
v
;

8373 
JS_CLASS_INT16_ARRAY
:

8374 
JS_CLASS_UINT16_ARRAY
:

8375 i‡(
	`JS_ToI¡32Fªe
(
˘x
, &
v
, 
vÆ
))

8377 i‡(
	`u∆ikñy
(
idx
 >(
uöt32_t
)
p
->
u
.
¨øy
.
cou¡
))

8378 
è_out_of_bound
;

8379 
p
->
u
.
¨øy
.u.
uöt16_±r
[
idx
] = 
v
;

8381 
JS_CLASS_INT32_ARRAY
:

8382 
JS_CLASS_UINT32_ARRAY
:

8383 i‡(
	`JS_ToI¡32Fªe
(
˘x
, &
v
, 
vÆ
))

8385 i‡(
	`u∆ikñy
(
idx
 >(
uöt32_t
)
p
->
u
.
¨øy
.
cou¡
))

8386 
è_out_of_bound
;

8387 
p
->
u
.
¨øy
.u.
uöt32_±r
[
idx
] = 
v
;

8389 #ifde‡
CONFIG_BIGNUM


8390 
JS_CLASS_BIG_INT64_ARRAY
:

8391 
JS_CLASS_BIG_UINT64_ARRAY
:

8394 
öt64_t
 
v
;

8395 i‡(
	`JS_ToBigI¡64Fªe
(
˘x
, &
v
, 
vÆ
))

8397 i‡(
	`u∆ikñy
(
idx
 >(
uöt32_t
)
p
->
u
.
¨øy
.
cou¡
))

8398 
è_out_of_bound
;

8399 
p
->
u
.
¨øy
.u.
uöt64_±r
[
idx
] = 
v
;

8403 
JS_CLASS_FLOAT32_ARRAY
:

8404 i‡(
	`JS_ToFlﬂt64Fªe
(
˘x
, &
d
, 
vÆ
))

8406 i‡(
	`u∆ikñy
(
idx
 >(
uöt32_t
)
p
->
u
.
¨øy
.
cou¡
))

8407 
è_out_of_bound
;

8408 
p
->
u
.
¨øy
.u.
Êﬂt_±r
[
idx
] = 
d
;

8410 
JS_CLASS_FLOAT64_ARRAY
:

8411 i‡(
	`JS_ToFlﬂt64Fªe
(
˘x
, &
d
, 
vÆ
))

8413 i‡(
	`u∆ikñy
(
idx
 >(
uöt32_t
)
p
->
u
.
¨øy
.
cou¡
)) {

8414 
è_out_of_bound
:

8415 i‡(
	`ty≥d_¨øy_is_dëached
(
˘x
, 
p
)) {

8416 
	`JS_ThrowTy≥Eº‹DëachedAºayBuf„r
(
˘x
);

8419  
	`JS_ThrowTy≥Eº‹OrFÆ£
(
˘x
, 
Êags
, "out-of-boundÇumeric index");

8422 
p
->
u
.
¨øy
.u.
doubÀ_±r
[
idx
] = 
d
;

8425 
¶ow_∑th
;

8427  
TRUE
;

8429 
JSAtom
 
©om
;

8430 
ªt
;

8431 
¶ow_∑th
:

8432 
©om
 = 
	`JS_VÆueToAtom
(
˘x
, 
¥›
);

8433 
	`JS_FªeVÆue
(
˘x
, 
¥›
);

8434 i‡(
	`u∆ikñy
(
©om
 =
JS_ATOM_NULL
)) {

8435 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

8438 
ªt
 = 
	`JS_SëPr›îtyI¡î«l
(
˘x
, 
this_obj
, 
©om
, 
vÆ
, 
Êags
);

8439 
	`JS_FªeAtom
(
˘x
, 
©om
);

8440  
ªt
;

8442 
	}
}

8444 
	$JS_SëPr›îtyUöt32
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_obj
,

8445 
uöt32_t
 
idx
, 
JSVÆue
 
vÆ
)

8447  
	`JS_SëPr›îtyVÆue
(
˘x
, 
this_obj
, 
	`JS_NewUöt32
(˘x, 
idx
), 
vÆ
,

8448 
JS_PROP_THROW
);

8449 
	}
}

8451 
	$JS_SëPr›îtyI¡64
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_obj
,

8452 
söt64_t
 
idx
, 
JSVÆue
 
vÆ
)

8454 
JSAtom
 
¥›
;

8455 
ªs
;

8457 i‡((
uöt64_t
)
idx
 <
INT32_MAX
) {

8459  
	`JS_SëPr›îtyVÆue
(
˘x
, 
this_obj
, 
	`JS_NewI¡32
(˘x, 
idx
), 
vÆ
,

8460 
JS_PROP_THROW
);

8462 
¥›
 = 
	`JS_NewAtomI¡64
(
˘x
, 
idx
);

8463 i‡(
¥›
 =
JS_ATOM_NULL
) {

8464 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

8467 
ªs
 = 
	`JS_SëPr›îty
(
˘x
, 
this_obj
, 
¥›
, 
vÆ
);

8468 
	`JS_FªeAtom
(
˘x
, 
¥›
);

8469  
ªs
;

8470 
	}
}

8472 
	$JS_SëPr›îtySå
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_obj
,

8473 c⁄° *
¥›
, 
JSVÆue
 
vÆ
)

8475 
JSAtom
 
©om
;

8476 
ªt
;

8477 
©om
 = 
	`JS_NewAtom
(
˘x
, 
¥›
);

8478 
ªt
 = 
	`JS_SëPr›îtyI¡î«l
(
˘x
, 
this_obj
, 
©om
, 
vÆ
, 
JS_PROP_THROW
);

8479 
	`JS_FªeAtom
(
˘x
, 
©om
);

8480  
ªt
;

8481 
	}
}

8487 
	$gë_¥›_Êags
(
Êags
, 
def_Êags
)

8489 
mask
;

8490 
mask
 = (
Êags
 >> 
JS_PROP_HAS_SHIFT
Ë& 
JS_PROP_C_W_E
;

8491  (
Êags
 & 
mask
Ë| (
def_Êags
 & ~mask);

8492 
	}
}

8494 
	$JS_Cª©ePr›îty
(
JSC⁄ãxt
 *
˘x
, 
JSObje˘
 *
p
,

8495 
JSAtom
 
¥›
, 
JSVÆueC⁄°
 
vÆ
,

8496 
JSVÆueC⁄°
 
gëãr
, JSVÆueC⁄° 
£âî
,

8497 
Êags
)

8499 
JSPr›îty
 *
¥
;

8500 
ªt
, 
¥›_Êags
;

8503 i‡(
p
->
is_exŸic
) {

8504 i‡(
p
->
˛ass_id
 =
JS_CLASS_ARRAY
) {

8505 
uöt32_t
 
idx
, 
Àn
;

8507 i‡(
p
->
Á°_¨øy
) {

8508 i‡(
	`__JS_AtomIsTaggedI¡
(
¥›
)) {

8509 
idx
 = 
	`__JS_AtomToUI¡32
(
¥›
);

8510 i‡(
idx
 =
p
->
u
.
¨øy
.
cou¡
) {

8511 i‡(!
p
->
exãnsibÀ
)

8512 
nŸ_exãnsibÀ
;

8513 i‡(
Êags
 & (
JS_PROP_HAS_GET
 | 
JS_PROP_HAS_SET
))

8514 
c⁄vît_to_¨øy
;

8515 
¥›_Êags
 = 
	`gë_¥›_Êags
(
Êags
, 0);

8516 i‡(
¥›_Êags
 !
JS_PROP_C_W_E
)

8517 
c⁄vît_to_¨øy
;

8518  
	`add_Á°_¨øy_ñemít
(
˘x
, 
p
,

8519 
	`JS_DupVÆue
(
˘x
, 
vÆ
), 
Êags
);

8521 
c⁄vît_to_¨øy
;

8523 } i‡(
	`JS_AtomIsAºayIndex
(
˘x
, &
idx
, 
¥›
)) {

8525 
c⁄vît_to_¨øy
:

8526 i‡(
	`c⁄vît_Á°_¨øy_to_¨øy
(
˘x
, 
p
))

8528 
gíîic_¨øy
;

8530 } i‡(
	`JS_AtomIsAºayIndex
(
˘x
, &
idx
, 
¥›
)) {

8531 
JSPr›îty
 *
∂í
;

8532 
JSSh≠ePr›îty
 *
p¶í
;

8533 
gíîic_¨øy
:

8535 
∂í
 = &
p
->
¥›
[0];

8536 
	`JS_ToUöt32
(
˘x
, &
Àn
, 
∂í
->
u
.
vÆue
);

8537 i‡((
idx
 + 1Ë> 
Àn
) {

8538 
p¶í
 = 
	`gë_sh≠e_¥›
(
p
->
sh≠e
);

8539 i‡(
	`u∆ikñy
(!(
p¶í
->
Êags
 & 
JS_PROP_WRITABLE
)))

8540  
	`JS_ThrowTy≥Eº‹RódO∆y
(
˘x
, 
Êags
, 
JS_ATOM_Àngth
);

8543 
Àn
 = 
idx
 + 1;

8544 
	`£t_vÆue
(
˘x
, &
∂í
->
u
.
vÆue
, 
	`JS_NewUöt32
(˘x, 
Àn
));

8547 } i‡(
p
->
˛ass_id
 >
JS_CLASS_UINT8C_ARRAY
 &&

8548 
p
->
˛ass_id
 <
JS_CLASS_FLOAT64_ARRAY
) {

8549 
ªt
 = 
	`JS_AtomIsNumîicIndex
(
˘x
, 
¥›
);

8550 i‡(
ªt
 != 0) {

8551 i‡(
ªt
 < 0)

8553  
	`JS_ThrowTy≥Eº‹OrFÆ£
(
˘x
, 
Êags
, "cannot createÇumeric index inÅypedárray");

8555 } i‡(!(
Êags
 & 
JS_PROP_NO_EXOTIC
)) {

8556 c⁄° 
JSCœssExŸicMëhods
 *
em
 = 
˘x
->
π
->
˛ass_¨øy
[
p
->
˛ass_id
].
exŸic
;

8557 i‡(
em
) {

8558 i‡(
em
->
deföe_own_¥›îty
) {

8559  
em
->
	`deföe_own_¥›îty
(
˘x
, 
	`JS_MKPTR
(
JS_TAG_OBJECT
, 
p
),

8560 
¥›
, 
vÆ
, 
gëãr
, 
£âî
, 
Êags
);

8562 
ªt
 = 
	`JS_IsExãnsibÀ
(
˘x
, 
	`JS_MKPTR
(
JS_TAG_OBJECT
, 
p
));

8563 i‡(
ªt
 < 0)

8565 i‡(!
ªt
)

8566 
nŸ_exãnsibÀ
;

8571 i‡(!
p
->
exãnsibÀ
) {

8572 
nŸ_exãnsibÀ
:

8573  
	`JS_ThrowTy≥Eº‹OrFÆ£
(
˘x
, 
Êags
, "object isÇotÉxtensible");

8576 i‡(
Êags
 & (
JS_PROP_HAS_GET
 | 
JS_PROP_HAS_SET
)) {

8577 
¥›_Êags
 = (
Êags
 & (
JS_PROP_CONFIGURABLE
 | 
JS_PROP_ENUMERABLE
)) |

8578 
JS_PROP_GETSET
;

8580 
¥›_Êags
 = 
Êags
 & 
JS_PROP_C_W_E
;

8582 
¥
 = 
	`add_¥›îty
(
˘x
, 
p
, 
¥›
, 
¥›_Êags
);

8583 i‡(
	`u∆ikñy
(!
¥
))

8585 i‡(
Êags
 & (
JS_PROP_HAS_GET
 | 
JS_PROP_HAS_SET
)) {

8586 
¥
->
u
.
gë£t
.
gëãr
 = 
NULL
;

8587 i‡((
Êags
 & 
JS_PROP_HAS_GET
Ë&& 
	`JS_IsFun˘i⁄
(
˘x
, 
gëãr
)) {

8588 
¥
->
u
.
gë£t
.
gëãr
 =

8589 
	`JS_VALUE_GET_OBJ
(
	`JS_DupVÆue
(
˘x
, 
gëãr
));

8591 
¥
->
u
.
gë£t
.
£âî
 = 
NULL
;

8592 i‡((
Êags
 & 
JS_PROP_HAS_SET
Ë&& 
	`JS_IsFun˘i⁄
(
˘x
, 
£âî
)) {

8593 
¥
->
u
.
gë£t
.
£âî
 =

8594 
	`JS_VALUE_GET_OBJ
(
	`JS_DupVÆue
(
˘x
, 
£âî
));

8597 i‡(
Êags
 & 
JS_PROP_HAS_VALUE
) {

8598 
¥
->
u
.
vÆue
 = 
	`JS_DupVÆue
(
˘x
, 
vÆ
);

8600 
¥
->
u
.
vÆue
 = 
JS_UNDEFINED
;

8603  
TRUE
;

8604 
	}
}

8607 
BOOL
 
	$check_deföe_¥›_Êags
(
¥›_Êags
, 
Êags
)

8609 
BOOL
 
has_ac˚ss‹
, 
is_gë£t
;

8611 i‡(!(
¥›_Êags
 & 
JS_PROP_CONFIGURABLE
)) {

8612 i‡((
Êags
 & (
JS_PROP_HAS_CONFIGURABLE
 | 
JS_PROP_CONFIGURABLE
)) ==

8613 (
JS_PROP_HAS_CONFIGURABLE
 | 
JS_PROP_CONFIGURABLE
)) {

8614  
FALSE
;

8616 i‡((
Êags
 & 
JS_PROP_HAS_ENUMERABLE
) &&

8617 (
Êags
 & 
JS_PROP_ENUMERABLE
Ë!(
¥›_Êags
 & JS_PROP_ENUMERABLE))

8618  
FALSE
;

8620 i‡(
Êags
 & (
JS_PROP_HAS_VALUE
 | 
JS_PROP_HAS_WRITABLE
 |

8621 
JS_PROP_HAS_GET
 | 
JS_PROP_HAS_SET
)) {

8622 i‡(!(
¥›_Êags
 & 
JS_PROP_CONFIGURABLE
)) {

8623 
has_ac˚ss‹
 = ((
Êags
 & (
JS_PROP_HAS_GET
 | 
JS_PROP_HAS_SET
)) != 0);

8624 
is_gë£t
 = ((
¥›_Êags
 & 
JS_PROP_TMASK
Ë=
JS_PROP_GETSET
);

8625 i‡(
has_ac˚ss‹
 !
is_gë£t
)

8626  
FALSE
;

8627 i‡(!
has_ac˚ss‹
 && !
is_gë£t
 && !(
¥›_Êags
 & 
JS_PROP_WRITABLE
)) {

8629 i‡((
Êags
 & (
JS_PROP_HAS_WRITABLE
 | 
JS_PROP_WRITABLE
)) ==

8630 (
JS_PROP_HAS_WRITABLE
 | 
JS_PROP_WRITABLE
))

8631  
FALSE
;

8635  
TRUE
;

8636 
	}
}

8639 
	$js_sh≠e_¥ï¨e_upd©e
(
JSC⁄ãxt
 *
˘x
, 
JSObje˘
 *
p
,

8640 
JSSh≠ePr›îty
 **
µrs
)

8642 
JSSh≠e
 *
sh
;

8643 
uöt32_t
 
idx
 = 0;

8645 
sh
 = 
p
->
sh≠e
;

8646 i‡(
sh
->
is_hashed
) {

8647 i‡(
sh
->
hódî
.
ªf_cou¡
 != 1) {

8648 i‡(
µrs
)

8649 
idx
 = *
µrs
 - 
	`gë_sh≠e_¥›
(
sh
);

8651 
sh
 = 
	`js_˛⁄e_sh≠e
(
˘x
, sh);

8652 i‡(!
sh
)

8654 
	`js_‰ì_sh≠e
(
˘x
->
π
, 
p
->
sh≠e
);

8655 
p
->
sh≠e
 = 
sh
;

8656 i‡(
µrs
)

8657 *
µrs
 = 
	`gë_sh≠e_¥›
(
sh
Ë+ 
idx
;

8659 
	`js_sh≠e_hash_u∆ök
(
˘x
->
π
, 
sh
);

8660 
sh
->
is_hashed
 = 
FALSE
;

8664 
	}
}

8666 
	$js_upd©e_¥›îty_Êags
(
JSC⁄ãxt
 *
˘x
, 
JSObje˘
 *
p
,

8667 
JSSh≠ePr›îty
 **
µrs
, 
Êags
)

8669 i‡(
Êags
 !(*
µrs
)->flags) {

8670 i‡(
	`js_sh≠e_¥ï¨e_upd©e
(
˘x
, 
p
, 
µrs
))

8672 (*
µrs
)->
Êags
 = flags;

8675 
	}
}

8687 
	$JS_DeföePr›îty
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_obj
,

8688 
JSAtom
 
¥›
, 
JSVÆueC⁄°
 
vÆ
,

8689 
JSVÆueC⁄°
 
gëãr
, JSVÆueC⁄° 
£âî
, 
Êags
)

8691 
JSObje˘
 *
p
;

8692 
JSSh≠ePr›îty
 *
¥s
;

8693 
JSPr›îty
 *
¥
;

8694 
mask
, 
ªs
;

8696 i‡(
	`JS_VALUE_GET_TAG
(
this_obj
Ë!
JS_TAG_OBJECT
) {

8697 
	`JS_ThrowTy≥Eº‹NŸAnObje˘
(
˘x
);

8700 
p
 = 
	`JS_VALUE_GET_OBJ
(
this_obj
);

8702 
ªdo_¥›_upd©e
:

8703 
¥s
 = 
	`föd_own_¥›îty
(&
¥
, 
p
, 
¥›
);

8704 i‡(
¥s
) {

8706 i‡(!
	`check_deföe_¥›_Êags
(
¥s
->
Êags
, flags)) {

8707 
nŸ_c⁄figuøbÀ
:

8708  
	`JS_ThrowTy≥Eº‹OrFÆ£
(
˘x
, 
Êags
, "property isÇot configurable");

8711 
ªåy
:

8712 i‡(
Êags
 & (
JS_PROP_HAS_VALUE
 | 
JS_PROP_HAS_WRITABLE
 |

8713 
JS_PROP_HAS_GET
 | 
JS_PROP_HAS_SET
)) {

8714 i‡(
Êags
 & (
JS_PROP_HAS_GET
 | 
JS_PROP_HAS_SET
)) {

8715 
JSObje˘
 *
√w_gëãr
, *
√w_£âî
;

8717 i‡(
	`JS_IsFun˘i⁄
(
˘x
, 
gëãr
)) {

8718 
√w_gëãr
 = 
	`JS_VALUE_GET_OBJ
(
gëãr
);

8720 
√w_gëãr
 = 
NULL
;

8722 i‡(
	`JS_IsFun˘i⁄
(
˘x
, 
£âî
)) {

8723 
√w_£âî
 = 
	`JS_VALUE_GET_OBJ
(
£âî
);

8725 
√w_£âî
 = 
NULL
;

8728 i‡((
¥s
->
Êags
 & 
JS_PROP_TMASK
Ë!
JS_PROP_GETSET
) {

8729 i‡(
	`js_sh≠e_¥ï¨e_upd©e
(
˘x
, 
p
, &
¥s
))

8732 i‡((
¥s
->
Êags
 & 
JS_PROP_TMASK
Ë=
JS_PROP_VARREF
) {

8733 
	`‰ì_v¨_ªf
(
˘x
->
π
, 
¥
->
u
.
v¨_ªf
);

8734 } i‡((
¥s
->
Êags
 & 
JS_PROP_TMASK
Ë=
JS_PROP_AUTOINIT
) {

8736 i‡(
	`js_sh≠e_¥ï¨e_upd©e
(
˘x
, 
p
, &
¥s
))

8738 
	`js_autoöô_‰ì
(
˘x
->
π
, 
¥
);

8739 
¥s
->
Êags
 &~
JS_PROP_TMASK
;

8740 
¥
->
u
.
vÆue
 = 
JS_UNDEFINED
;

8741 
ªåy
;

8743 
	`JS_FªeVÆue
(
˘x
, 
¥
->
u
.
vÆue
);

8745 
¥s
->
Êags
 = (prs->flags &

8746 (
JS_PROP_CONFIGURABLE
 | 
JS_PROP_ENUMERABLE
)) |

8747 
JS_PROP_GETSET
;

8748 
¥
->
u
.
gë£t
.
gëãr
 = 
NULL
;

8749 
¥
->
u
.
gë£t
.
£âî
 = 
NULL
;

8751 i‡(!(
¥s
->
Êags
 & 
JS_PROP_CONFIGURABLE
)) {

8752 i‡((
Êags
 & 
JS_PROP_HAS_GET
) &&

8753 
√w_gëãr
 !
¥
->
u
.
gë£t
.
gëãr
) {

8754 
nŸ_c⁄figuøbÀ
;

8756 i‡((
Êags
 & 
JS_PROP_HAS_SET
) &&

8757 
√w_£âî
 !
¥
->
u
.
gë£t
.
£âî
) {

8758 
nŸ_c⁄figuøbÀ
;

8762 i‡(
Êags
 & 
JS_PROP_HAS_GET
) {

8763 i‡(
¥
->
u
.
gë£t
.
gëãr
)

8764 
	`JS_FªeVÆue
(
˘x
, 
	`JS_MKPTR
(
JS_TAG_OBJECT
, 
¥
->
u
.
gë£t
.
gëãr
));

8765 i‡(
√w_gëãr
)

8766 
	`JS_DupVÆue
(
˘x
, 
gëãr
);

8767 
¥
->
u
.
gë£t
.
gëãr
 = 
√w_gëãr
;

8769 i‡(
Êags
 & 
JS_PROP_HAS_SET
) {

8770 i‡(
¥
->
u
.
gë£t
.
£âî
)

8771 
	`JS_FªeVÆue
(
˘x
, 
	`JS_MKPTR
(
JS_TAG_OBJECT
, 
¥
->
u
.
gë£t
.
£âî
));

8772 i‡(
√w_£âî
)

8773 
	`JS_DupVÆue
(
˘x
, 
£âî
);

8774 
¥
->
u
.
gë£t
.
£âî
 = 
√w_£âî
;

8777 i‡((
¥s
->
Êags
 & 
JS_PROP_TMASK
Ë=
JS_PROP_GETSET
) {

8779 i‡(
	`js_sh≠e_¥ï¨e_upd©e
(
˘x
, 
p
, &
¥s
))

8781 i‡(
¥
->
u
.
gë£t
.
gëãr
)

8782 
	`JS_FªeVÆue
(
˘x
, 
	`JS_MKPTR
(
JS_TAG_OBJECT
, 
¥
->
u
.
gë£t
.
gëãr
));

8783 i‡(
¥
->
u
.
gë£t
.
£âî
)

8784 
	`JS_FªeVÆue
(
˘x
, 
	`JS_MKPTR
(
JS_TAG_OBJECT
, 
¥
->
u
.
gë£t
.
£âî
));

8785 
¥s
->
Êags
 &~(
JS_PROP_TMASK
 | 
JS_PROP_WRITABLE
);

8786 
¥
->
u
.
vÆue
 = 
JS_UNDEFINED
;

8787 } i‡((
¥s
->
Êags
 & 
JS_PROP_TMASK
Ë=
JS_PROP_VARREF
) {

8789 } i‡((
¥s
->
Êags
 & 
JS_PROP_TMASK
Ë=
JS_PROP_AUTOINIT
) {

8791 i‡(
	`js_sh≠e_¥ï¨e_upd©e
(
˘x
, 
p
, &
¥s
))

8793 
	`js_autoöô_‰ì
(
˘x
->
π
, 
¥
);

8794 
¥s
->
Êags
 &~
JS_PROP_TMASK
;

8795 
¥
->
u
.
vÆue
 = 
JS_UNDEFINED
;

8797 i‡((
¥s
->
Êags
 & (
JS_PROP_CONFIGURABLE
 | 
JS_PROP_WRITABLE
)) == 0 &&

8798 (
Êags
 & 
JS_PROP_HAS_VALUE
) &&

8799 !
	`js_ßme_vÆue
(
˘x
, 
vÆ
, 
¥
->
u
.
vÆue
)) {

8800 
nŸ_c⁄figuøbÀ
;

8803 i‡(
¥s
->
Êags
 & 
JS_PROP_LENGTH
) {

8804 i‡(
Êags
 & 
JS_PROP_HAS_VALUE
) {

8805 
ªs
 = 
	`£t_¨øy_Àngth
(
˘x
, 
p
, 
¥
, 
	`JS_DupVÆue
(˘x, 
vÆ
),

8806 
Êags
);

8808 
ªs
 = 
TRUE
;

8813 i‡((
Êags
 & (
JS_PROP_HAS_WRITABLE
 | 
JS_PROP_WRITABLE
)) ==

8814 
JS_PROP_HAS_WRITABLE
) {

8815 
¥s
 = 
	`gë_sh≠e_¥›
(
p
->
sh≠e
);

8816 i‡(
	`js_upd©e_¥›îty_Êags
(
˘x
, 
p
, &
¥s
,

8817 
¥s
->
Êags
 & ~(
JS_PROP_WRITABLE
 | 
JS_PROP_LENGTH
)))

8820  
ªs
;

8821 } i‡((
¥s
->
Êags
 & 
JS_PROP_TMASK
Ë=
JS_PROP_VARREF
) {

8822 i‡(
Êags
 & 
JS_PROP_HAS_VALUE
) {

8823 i‡(
p
->
˛ass_id
 =
JS_CLASS_MODULE_NS
) {

8827 i‡(!
	`js_ßme_vÆue
(
˘x
, 
vÆ
, *
¥
->
u
.
v¨_ªf
->
pvÆue
))

8828 
nŸ_c⁄figuøbÀ
;

8831 
	`£t_vÆue
(
˘x
, 
¥
->
u
.
v¨_ªf
->
pvÆue
,

8832 
	`JS_DupVÆue
(
˘x
, 
vÆ
));

8836 i‡((
Êags
 & (
JS_PROP_HAS_WRITABLE
 | 
JS_PROP_WRITABLE
)) == JS_PROP_HAS_WRITABLE) {

8837 
JSVÆue
 
vÆ1
;

8838 i‡(
	`js_sh≠e_¥ï¨e_upd©e
(
˘x
, 
p
, &
¥s
))

8840 
vÆ1
 = 
	`JS_DupVÆue
(
˘x
, *
¥
->
u
.
v¨_ªf
->
pvÆue
);

8841 
	`‰ì_v¨_ªf
(
˘x
->
π
, 
¥
->
u
.
v¨_ªf
);

8842 
¥
->
u
.
vÆue
 = 
vÆ1
;

8843 
¥s
->
Êags
 &~(
JS_PROP_TMASK
 | 
JS_PROP_WRITABLE
);

8845 } i‡((
¥s
->
Êags
 & 
JS_PROP_TMASK
Ë=
JS_PROP_AUTOINIT
) {

8847 
	`ab‹t
();

8849 i‡(
Êags
 & 
JS_PROP_HAS_VALUE
) {

8850 
	`JS_FªeVÆue
(
˘x
, 
¥
->
u
.
vÆue
);

8851 
¥
->
u
.
vÆue
 = 
	`JS_DupVÆue
(
˘x
, 
vÆ
);

8853 i‡(
Êags
 & 
JS_PROP_HAS_WRITABLE
) {

8854 i‡(
	`js_upd©e_¥›îty_Êags
(
˘x
, 
p
, &
¥s
,

8855 (
¥s
->
Êags
 & ~
JS_PROP_WRITABLE
) |

8856 (
Êags
 & 
JS_PROP_WRITABLE
)))

8862 
mask
 = 0;

8863 i‡(
Êags
 & 
JS_PROP_HAS_CONFIGURABLE
)

8864 
mask
 |
JS_PROP_CONFIGURABLE
;

8865 i‡(
Êags
 & 
JS_PROP_HAS_ENUMERABLE
)

8866 
mask
 |
JS_PROP_ENUMERABLE
;

8867 i‡(
	`js_upd©e_¥›îty_Êags
(
˘x
, 
p
, &
¥s
,

8868 (
¥s
->
Êags
 & ~
mask
) | (flags & mask)))

8870  
TRUE
;

8874 i‡(
p
->
Á°_¨øy
) {

8875 
uöt32_t
 
idx
;

8876 
uöt32_t
 
¥›_Êags
;

8877 i‡(
p
->
˛ass_id
 =
JS_CLASS_ARRAY
) {

8878 i‡(
	`__JS_AtomIsTaggedI¡
(
¥›
)) {

8879 
idx
 = 
	`__JS_AtomToUI¡32
(
¥›
);

8880 i‡(
idx
 < 
p
->
u
.
¨øy
.
cou¡
) {

8881 
¥›_Êags
 = 
	`gë_¥›_Êags
(
Êags
, 
JS_PROP_C_W_E
);

8882 i‡(
¥›_Êags
 !
JS_PROP_C_W_E
)

8883 
c⁄vît_to_¶ow_¨øy
;

8884 i‡(
Êags
 & (
JS_PROP_HAS_GET
 | 
JS_PROP_HAS_SET
)) {

8885 
c⁄vît_to_¶ow_¨øy
:

8886 i‡(
	`c⁄vît_Á°_¨øy_to_¨øy
(
˘x
, 
p
))

8889 
ªdo_¥›_upd©e
;

8891 i‡(
Êags
 & 
JS_PROP_HAS_VALUE
) {

8892 
	`£t_vÆue
(
˘x
, &
p
->
u
.
¨øy
.u.
vÆues
[
idx
], 
	`JS_DupVÆue
(˘x, 
vÆ
));

8894  
TRUE
;

8897 } i‡(
p
->
˛ass_id
 >
JS_CLASS_UINT8C_ARRAY
 &&

8898 
p
->
˛ass_id
 <
JS_CLASS_FLOAT64_ARRAY
) {

8899 
JSVÆue
 
num
;

8900 
ªt
;

8902 i‡(!
	`__JS_AtomIsTaggedI¡
(
¥›
)) {

8904 
num
 = 
	`JS_AtomIsNumîicIndex1
(
˘x
, 
¥›
);

8905 i‡(
	`JS_IsUndeföed
(
num
))

8906 
ty≥d_¨øy_d⁄e
;

8907 i‡(
	`JS_IsEx˚±i⁄
(
num
))

8909 
ªt
 = 
	`JS_NumbîIsI¡egî
(
˘x
, 
num
);

8910 i‡(
ªt
 < 0) {

8911 
	`JS_FªeVÆue
(
˘x
, 
num
);

8914 i‡(!
ªt
) {

8915 
	`JS_FªeVÆue
(
˘x
, 
num
);

8916  
	`JS_ThrowTy≥Eº‹OrFÆ£
(
˘x
, 
Êags
, "non integer index inÅypedárray");

8918 
ªt
 = 
	`JS_NumbîIsNeg©iveOrMöusZîo
(
˘x
, 
num
);

8919 
	`JS_FªeVÆue
(
˘x
, 
num
);

8920 i‡(
ªt
) {

8921  
	`JS_ThrowTy≥Eº‹OrFÆ£
(
˘x
, 
Êags
, "negative index inÅypedárray");

8923 i‡(!
	`__JS_AtomIsTaggedI¡
(
¥›
))

8924 
ty≥d_¨øy_oob
;

8926 
idx
 = 
	`__JS_AtomToUI¡32
(
¥›
);

8928 i‡(
idx
 >
	`ty≥d_¨øy_gë_Àngth
(
˘x
, 
p
)) {

8929 
ty≥d_¨øy_oob
:

8930  
	`JS_ThrowTy≥Eº‹OrFÆ£
(
˘x
, 
Êags
, "out-of-bound index inÅypedárray");

8932 
¥›_Êags
 = 
	`gë_¥›_Êags
(
Êags
, 
JS_PROP_ENUMERABLE
 | 
JS_PROP_WRITABLE
);

8933 i‡(
Êags
 & (
JS_PROP_HAS_GET
 | 
JS_PROP_HAS_SET
) ||

8934 
¥›_Êags
 !(
JS_PROP_ENUMERABLE
 | 
JS_PROP_WRITABLE
)) {

8935  
	`JS_ThrowTy≥Eº‹OrFÆ£
(
˘x
, 
Êags
, "invalid descriptor flags");

8937 i‡(
Êags
 & 
JS_PROP_HAS_VALUE
) {

8938  
	`JS_SëPr›îtyVÆue
(
˘x
, 
this_obj
, 
	`JS_NewI¡32
(˘x, 
idx
), 
	`JS_DupVÆue
(˘x, 
vÆ
), 
Êags
);

8940  
TRUE
;

8941 
ty≥d_¨øy_d⁄e
: ;

8945  
	`JS_Cª©ePr›îty
(
˘x
, 
p
, 
¥›
, 
vÆ
, 
gëãr
, 
£âî
, 
Êags
);

8946 
	}
}

8948 
	$JS_DeföeAutoInôPr›îty
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_obj
,

8949 
JSAtom
 
¥›
, 
JSAutoInôIDEnum
 
id
,

8950 *
›aque
, 
Êags
)

8952 
JSObje˘
 *
p
;

8953 
JSPr›îty
 *
¥
;

8955 i‡(
	`JS_VALUE_GET_TAG
(
this_obj
Ë!
JS_TAG_OBJECT
)

8956  
FALSE
;

8958 
p
 = 
	`JS_VALUE_GET_OBJ
(
this_obj
);

8960 i‡(
	`föd_own_¥›îty
(&
¥
, 
p
, 
¥›
)) {

8962 
	`ab‹t
();

8963  
FALSE
;

8967 
¥
 = 
	`add_¥›îty
(
˘x
, 
p
, 
¥›
, (
Êags
 & 
JS_PROP_C_W_E
Ë| 
JS_PROP_AUTOINIT
);

8968 i‡(
	`u∆ikñy
(!
¥
))

8970 i‡(
id
 =
JS_AUTOINIT_ID_PROP
) {

8971 
¥
->
u
.
öô
.u.
ªÆm
 = 
	`JS_DupC⁄ãxt
(
˘x
);

8973 
¥
->
u
.
öô
.u.
öô_id
 = 
id
;

8975 
¥
->
u
.
öô
.
›aque
 = opaque;

8976  
TRUE
;

8977 
	}
}

8980 
	$JS_DeföePr›îtyVÆue
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_obj
,

8981 
JSAtom
 
¥›
, 
JSVÆue
 
vÆ
, 
Êags
)

8983 
ªt
;

8984 
ªt
 = 
	`JS_DeföePr›îty
(
˘x
, 
this_obj
, 
¥›
, 
vÆ
, 
JS_UNDEFINED
, JS_UNDEFINED,

8985 
Êags
 | 
JS_PROP_HAS_VALUE
 | 
JS_PROP_HAS_CONFIGURABLE
 | 
JS_PROP_HAS_WRITABLE
 | 
JS_PROP_HAS_ENUMERABLE
);

8986 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

8987  
ªt
;

8988 
	}
}

8990 
	$JS_DeföePr›îtyVÆueVÆue
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_obj
,

8991 
JSVÆue
 
¥›
, JSVÆuê
vÆ
, 
Êags
)

8993 
JSAtom
 
©om
;

8994 
ªt
;

8995 
©om
 = 
	`JS_VÆueToAtom
(
˘x
, 
¥›
);

8996 
	`JS_FªeVÆue
(
˘x
, 
¥›
);

8997 i‡(
	`u∆ikñy
(
©om
 =
JS_ATOM_NULL
)) {

8998 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

9001 
ªt
 = 
	`JS_DeföePr›îtyVÆue
(
˘x
, 
this_obj
, 
©om
, 
vÆ
, 
Êags
);

9002 
	`JS_FªeAtom
(
˘x
, 
©om
);

9003  
ªt
;

9004 
	}
}

9006 
	$JS_DeföePr›îtyVÆueUöt32
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_obj
,

9007 
uöt32_t
 
idx
, 
JSVÆue
 
vÆ
, 
Êags
)

9009  
	`JS_DeföePr›îtyVÆueVÆue
(
˘x
, 
this_obj
, 
	`JS_NewUöt32
(˘x, 
idx
),

9010 
vÆ
, 
Êags
);

9011 
	}
}

9013 
	$JS_DeföePr›îtyVÆueI¡64
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_obj
,

9014 
söt64_t
 
idx
, 
JSVÆue
 
vÆ
, 
Êags
)

9016  
	`JS_DeföePr›îtyVÆueVÆue
(
˘x
, 
this_obj
, 
	`JS_NewI¡64
(˘x, 
idx
),

9017 
vÆ
, 
Êags
);

9018 
	}
}

9020 
	$JS_DeföePr›îtyVÆueSå
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_obj
,

9021 c⁄° *
¥›
, 
JSVÆue
 
vÆ
, 
Êags
)

9023 
JSAtom
 
©om
;

9024 
ªt
;

9025 
©om
 = 
	`JS_NewAtom
(
˘x
, 
¥›
);

9026 
ªt
 = 
	`JS_DeföePr›îtyVÆue
(
˘x
, 
this_obj
, 
©om
, 
vÆ
, 
Êags
);

9027 
	`JS_FªeAtom
(
˘x
, 
©om
);

9028  
ªt
;

9029 
	}
}

9032 
	$JS_DeföePr›îtyGëSë
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_obj
,

9033 
JSAtom
 
¥›
, 
JSVÆue
 
gëãr
, JSVÆuê
£âî
,

9034 
Êags
)

9036 
ªt
;

9037 
ªt
 = 
	`JS_DeföePr›îty
(
˘x
, 
this_obj
, 
¥›
, 
JS_UNDEFINED
, 
gëãr
, 
£âî
,

9038 
Êags
 | 
JS_PROP_HAS_GET
 | 
JS_PROP_HAS_SET
 |

9039 
JS_PROP_HAS_CONFIGURABLE
 | 
JS_PROP_HAS_ENUMERABLE
);

9040 
	`JS_FªeVÆue
(
˘x
, 
gëãr
);

9041 
	`JS_FªeVÆue
(
˘x
, 
£âî
);

9042  
ªt
;

9043 
	}
}

9045 
	$JS_Cª©eD©aPr›îtyUöt32
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_obj
,

9046 
söt64_t
 
idx
, 
JSVÆue
 
vÆ
, 
Êags
)

9048  
	`JS_DeföePr›îtyVÆueVÆue
(
˘x
, 
this_obj
, 
	`JS_NewI¡64
(˘x, 
idx
),

9049 
vÆ
, 
Êags
 | 
JS_PROP_CONFIGURABLE
 |

9050 
JS_PROP_ENUMERABLE
 | 
JS_PROP_WRITABLE
);

9051 
	}
}

9055 
BOOL
 
	$js_obje˘_has_«me
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
obj
)

9057 
JSPr›îty
 *
¥
;

9058 
JSSh≠ePr›îty
 *
¥s
;

9059 
JSVÆueC⁄°
 
vÆ
;

9060 
JSSåög
 *
p
;

9062 
¥s
 = 
	`föd_own_¥›îty
(&
¥
, 
	`JS_VALUE_GET_OBJ
(
obj
), 
JS_ATOM_«me
);

9063 i‡(!
¥s
)

9064  
FALSE
;

9065 i‡((
¥s
->
Êags
 & 
JS_PROP_TMASK
Ë!
JS_PROP_NORMAL
)

9066  
TRUE
;

9067 
vÆ
 = 
¥
->
u
.
vÆue
;

9068 i‡(
	`JS_VALUE_GET_TAG
(
vÆ
Ë!
JS_TAG_STRING
)

9069  
TRUE
;

9070 
p
 = 
	`JS_VALUE_GET_STRING
(
vÆ
);

9071  (
p
->
Àn
 != 0);

9072 
	}
}

9074 
	$JS_DeföeObje˘Name
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
obj
,

9075 
JSAtom
 
«me
, 
Êags
)

9077 i‡(
«me
 !
JS_ATOM_NULL


9078 && 
	`JS_IsObje˘
(
obj
)

9079 && !
	`js_obje˘_has_«me
(
˘x
, 
obj
)

9080 && 
	`JS_DeföePr›îtyVÆue
(
˘x
, 
obj
, 
JS_ATOM_«me
, 
	`JS_AtomToSåög
(˘x, 
«me
), 
Êags
) < 0) {

9084 
	}
}

9086 
	$JS_DeföeObje˘NameCompuãd
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
obj
,

9087 
JSVÆueC⁄°
 
°r
, 
Êags
)

9089 i‡(
	`JS_IsObje˘
(
obj
) &&

9090 !
	`js_obje˘_has_«me
(
˘x
, 
obj
)) {

9091 
JSAtom
 
¥›
;

9092 
JSVÆue
 
«me_°r
;

9093 
¥›
 = 
	`JS_VÆueToAtom
(
˘x
, 
°r
);

9094 i‡(
¥›
 =
JS_ATOM_NULL
)

9096 
«me_°r
 = 
	`js_gë_fun˘i⁄_«me
(
˘x
, 
¥›
);

9097 
	`JS_FªeAtom
(
˘x
, 
¥›
);

9098 i‡(
	`JS_IsEx˚±i⁄
(
«me_°r
))

9100 i‡(
	`JS_DeföePr›îtyVÆue
(
˘x
, 
obj
, 
JS_ATOM_«me
, 
«me_°r
, 
Êags
) < 0)

9104 
	}
}

9106 
	#DEFINE_GLOBAL_LEX_VAR
 (1 << 7)

	)

9107 
	#DEFINE_GLOBAL_FUNC_VAR
 (1 << 6)

	)

9109 
JSVÆue
 
	$JS_ThrowSy¡axEº‹V¨Rede˛¨©i⁄
(
JSC⁄ãxt
 *
˘x
, 
JSAtom
 
¥›
)

9111 
buf
[
ATOM_GET_STR_BUF_SIZE
];

9112  
	`JS_ThrowSy¡axEº‹
(
˘x
, "redeclaration of %s",

9113 
	`JS_AtomGëSå
(
˘x
, 
buf
, (buf), 
¥›
));

9114 
	}
}

9118 
	$JS_CheckDeföeGlobÆV¨
(
JSC⁄ãxt
 *
˘x
, 
JSAtom
 
¥›
, 
Êags
)

9120 
JSObje˘
 *
p
;

9121 
JSSh≠ePr›îty
 *
¥s
;

9122 
buf
[
ATOM_GET_STR_BUF_SIZE
];

9124 
p
 = 
	`JS_VALUE_GET_OBJ
(
˘x
->
globÆ_obj
);

9125 
¥s
 = 
	`föd_own_¥›îty1
(
p
, 
¥›
);

9127 i‡(
Êags
 & 
DEFINE_GLOBAL_LEX_VAR
) {

9128 i‡(
¥s
 && !’rs->
Êags
 & 
JS_PROP_CONFIGURABLE
))

9129 
Áû_ªde˛¨©i⁄
;

9131 i‡(!
¥s
 && !
p
->
exãnsibÀ
)

9132 
deföe_îr‹
;

9133 i‡(
Êags
 & 
DEFINE_GLOBAL_FUNC_VAR
) {

9134 i‡(
¥s
) {

9135 i‡(!(
¥s
->
Êags
 & 
JS_PROP_CONFIGURABLE
) &&

9136 ((
¥s
->
Êags
 & 
JS_PROP_TMASK
Ë=
JS_PROP_GETSET
 ||

9137 ((
¥s
->
Êags
 & (
JS_PROP_WRITABLE
 | 
JS_PROP_ENUMERABLE
)) !=

9138 (
JS_PROP_WRITABLE
 | 
JS_PROP_ENUMERABLE
)))) {

9139 
deföe_îr‹
:

9140 
	`JS_ThrowTy≥Eº‹
(
˘x
, "cannot define variable %s",

9141 
	`JS_AtomGëSå
(
˘x
, 
buf
, (buf), 
¥›
));

9148 
p
 = 
	`JS_VALUE_GET_OBJ
(
˘x
->
globÆ_v¨_obj
);

9149 
¥s
 = 
	`föd_own_¥›îty1
(
p
, 
¥›
);

9150 i‡(
¥s
) {

9151 
Áû_ªde˛¨©i⁄
:

9152 
	`JS_ThrowSy¡axEº‹V¨Rede˛¨©i⁄
(
˘x
, 
¥›
);

9156 
	}
}

9161 
	$JS_DeföeGlobÆV¨
(
JSC⁄ãxt
 *
˘x
, 
JSAtom
 
¥›
, 
def_Êags
)

9163 
JSObje˘
 *
p
;

9164 
JSSh≠ePr›îty
 *
¥s
;

9165 
JSPr›îty
 *
¥
;

9166 
JSVÆue
 
vÆ
;

9167 
Êags
;

9169 i‡(
def_Êags
 & 
DEFINE_GLOBAL_LEX_VAR
) {

9170 
p
 = 
	`JS_VALUE_GET_OBJ
(
˘x
->
globÆ_v¨_obj
);

9171 
Êags
 = 
JS_PROP_ENUMERABLE
 | (
def_Êags
 & 
JS_PROP_WRITABLE
) |

9172 
JS_PROP_CONFIGURABLE
;

9173 
vÆ
 = 
JS_UNINITIALIZED
;

9175 
p
 = 
	`JS_VALUE_GET_OBJ
(
˘x
->
globÆ_obj
);

9176 
Êags
 = 
JS_PROP_ENUMERABLE
 | 
JS_PROP_WRITABLE
 |

9177 (
def_Êags
 & 
JS_PROP_CONFIGURABLE
);

9178 
vÆ
 = 
JS_UNDEFINED
;

9180 
¥s
 = 
	`föd_own_¥›îty1
(
p
, 
¥›
);

9181 i‡(
¥s
)

9183 i‡(!
p
->
exãnsibÀ
)

9185 
¥
 = 
	`add_¥›îty
(
˘x
, 
p
, 
¥›
, 
Êags
);

9186 i‡(
	`u∆ikñy
(!
¥
))

9188 
¥
->
u
.
vÆue
 = 
vÆ
;

9190 
	}
}

9194 
	$JS_DeföeGlobÆFun˘i⁄
(
JSC⁄ãxt
 *
˘x
, 
JSAtom
 
¥›
,

9195 
JSVÆueC⁄°
 
func
, 
def_Êags
)

9198 
JSObje˘
 *
p
;

9199 
JSSh≠ePr›îty
 *
¥s
;

9200 
Êags
;

9202 
p
 = 
	`JS_VALUE_GET_OBJ
(
˘x
->
globÆ_obj
);

9203 
¥s
 = 
	`föd_own_¥›îty1
(
p
, 
¥›
);

9204 
Êags
 = 
JS_PROP_HAS_VALUE
 | 
JS_PROP_THROW
;

9205 i‡(!
¥s
 || (¥s->
Êags
 & 
JS_PROP_CONFIGURABLE
)) {

9206 
Êags
 |
JS_PROP_ENUMERABLE
 | 
JS_PROP_WRITABLE
 | 
def_Êags
 |

9207 
JS_PROP_HAS_CONFIGURABLE
 | 
JS_PROP_HAS_WRITABLE
 | 
JS_PROP_HAS_ENUMERABLE
;

9209 i‡(
	`JS_DeföePr›îty
(
˘x
, ctx->
globÆ_obj
, 
¥›
, 
func
,

9210 
JS_UNDEFINED
, JS_UNDEFINED, 
Êags
) < 0)

9213 
	}
}

9215 
JSVÆue
 
	$JS_GëGlobÆV¨
(
JSC⁄ãxt
 *
˘x
, 
JSAtom
 
¥›
,

9216 
BOOL
 
throw_ªf_îr‹
)

9218 
JSObje˘
 *
p
;

9219 
JSSh≠ePr›îty
 *
¥s
;

9220 
JSPr›îty
 *
¥
;

9223 
p
 = 
	`JS_VALUE_GET_OBJ
(
˘x
->
globÆ_v¨_obj
);

9224 
¥s
 = 
	`föd_own_¥›îty
(&
¥
, 
p
, 
¥›
);

9225 i‡(
¥s
) {

9227 i‡(
	`u∆ikñy
(
	`JS_IsUnöôülized
(
¥
->
u
.
vÆue
)))

9228  
	`JS_ThrowRe„ªn˚Eº‹Unöôülized
(
˘x
, 
¥s
->
©om
);

9229  
	`JS_DupVÆue
(
˘x
, 
¥
->
u
.
vÆue
);

9231  
	`JS_GëPr›îtyI¡î«l
(
˘x
, ctx->
globÆ_obj
, 
¥›
,

9232 
˘x
->
globÆ_obj
, 
throw_ªf_îr‹
);

9233 
	}
}

9236 
	$JS_GëGlobÆV¨Ref
(
JSC⁄ãxt
 *
˘x
, 
JSAtom
 
¥›
, 
JSVÆue
 *
•
)

9238 
JSObje˘
 *
p
;

9239 
JSSh≠ePr›îty
 *
¥s
;

9240 
JSPr›îty
 *
¥
;

9243 
p
 = 
	`JS_VALUE_GET_OBJ
(
˘x
->
globÆ_v¨_obj
);

9244 
¥s
 = 
	`föd_own_¥›îty
(&
¥
, 
p
, 
¥›
);

9245 i‡(
¥s
) {

9249 i‡(
	`u∆ikñy
(
	`JS_IsUnöôülized
(
¥
->
u
.
vÆue
))) {

9250 
	`JS_ThrowRe„ªn˚Eº‹Unöôülized
(
˘x
, 
¥s
->
©om
);

9253 i‡(
	`u∆ikñy
(!(
¥s
->
Êags
 & 
JS_PROP_WRITABLE
))) {

9254  
	`JS_ThrowTy≥Eº‹RódO∆y
(
˘x
, 
JS_PROP_THROW
, 
¥›
);

9256 
•
[0] = 
	`JS_DupVÆue
(
˘x
, ctx->
globÆ_v¨_obj
);

9258 
ªt
;

9259 
ªt
 = 
	`JS_HasPr›îty
(
˘x
, ctx->
globÆ_obj
, 
¥›
);

9260 i‡(
ªt
 < 0)

9262 i‡(
ªt
) {

9263 
•
[0] = 
	`JS_DupVÆue
(
˘x
, ctx->
globÆ_obj
);

9265 
•
[0] = 
JS_UNDEFINED
;

9268 
•
[1] = 
	`JS_AtomToVÆue
(
˘x
, 
¥›
);

9270 
	}
}

9273 
	$JS_CheckGlobÆV¨
(
JSC⁄ãxt
 *
˘x
, 
JSAtom
 
¥›
)

9275 
JSObje˘
 *
p
;

9276 
JSSh≠ePr›îty
 *
¥s
;

9277 
ªt
;

9280 
p
 = 
	`JS_VALUE_GET_OBJ
(
˘x
->
globÆ_v¨_obj
);

9281 
¥s
 = 
	`föd_own_¥›îty1
(
p
, 
¥›
);

9282 i‡(
¥s
) {

9283 
ªt
 = 
TRUE
;

9285 
ªt
 = 
	`JS_HasPr›îty
(
˘x
, ctx->
globÆ_obj
, 
¥›
);

9286 i‡(
ªt
 < 0)

9289  
ªt
;

9290 
	}
}

9296 
	$JS_SëGlobÆV¨
(
JSC⁄ãxt
 *
˘x
, 
JSAtom
 
¥›
, 
JSVÆue
 
vÆ
,

9297 
Êag
)

9299 
JSObje˘
 *
p
;

9300 
JSSh≠ePr›îty
 *
¥s
;

9301 
JSPr›îty
 *
¥
;

9302 
Êags
;

9305 
p
 = 
	`JS_VALUE_GET_OBJ
(
˘x
->
globÆ_v¨_obj
);

9306 
¥s
 = 
	`föd_own_¥›îty
(&
¥
, 
p
, 
¥›
);

9307 i‡(
¥s
) {

9309 i‡(
Êag
 != 1) {

9310 i‡(
	`u∆ikñy
(
	`JS_IsUnöôülized
(
¥
->
u
.
vÆue
))) {

9311 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

9312 
	`JS_ThrowRe„ªn˚Eº‹Unöôülized
(
˘x
, 
¥s
->
©om
);

9315 i‡(
	`u∆ikñy
(!(
¥s
->
Êags
 & 
JS_PROP_WRITABLE
))) {

9316 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

9317  
	`JS_ThrowTy≥Eº‹RódO∆y
(
˘x
, 
JS_PROP_THROW
, 
¥›
);

9320 
	`£t_vÆue
(
˘x
, &
¥
->
u
.
vÆue
, 
vÆ
);

9324 
Êags
 = 
JS_PROP_THROW_STRICT
;

9325 i‡(
Êag
 !2 && 
	`is_°ri˘_mode
(
˘x
))

9326 
Êags
 |
JS_PROP_NO_ADD
;

9327  
	`JS_SëPr›îtyI¡î«l
(
˘x
, ctx->
globÆ_obj
, 
¥›
, 
vÆ
, 
Êags
);

9328 
	}
}

9333 
	$JS_DñëePr›îty
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
obj
, 
JSAtom
 
¥›
, 
Êags
)

9335 
JSVÆue
 
obj1
;

9336 
JSObje˘
 *
p
;

9337 
ªs
;

9339 
obj1
 = 
	`JS_ToObje˘
(
˘x
, 
obj
);

9340 i‡(
	`JS_IsEx˚±i⁄
(
obj1
))

9342 
p
 = 
	`JS_VALUE_GET_OBJ
(
obj1
);

9343 
ªs
 = 
	`dñëe_¥›îty
(
˘x
, 
p
, 
¥›
);

9344 
	`JS_FªeVÆue
(
˘x
, 
obj1
);

9345 i‡(
ªs
 !
FALSE
)

9346  
ªs
;

9347 i‡((
Êags
 & 
JS_PROP_THROW
) ||

9348 ((
Êags
 & 
JS_PROP_THROW_STRICT
Ë&& 
	`is_°ri˘_mode
(
˘x
))) {

9349 
	`JS_ThrowTy≥Eº‹
(
˘x
, "couldÇot deleteÖroperty");

9352  
FALSE
;

9353 
	}
}

9355 
	$JS_DñëePr›îtyI¡64
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
obj
, 
söt64_t
 
idx
, 
Êags
)

9357 
JSAtom
 
¥›
;

9358 
ªs
;

9360 i‡((
uöt64_t
)
idx
 <
JS_ATOM_MAX_INT
) {

9362  
	`JS_DñëePr›îty
(
˘x
, 
obj
, 
	`__JS_AtomFromUI¡32
(
idx
), 
Êags
);

9364 
¥›
 = 
	`JS_NewAtomI¡64
(
˘x
, 
idx
);

9365 i‡(
¥›
 =
JS_ATOM_NULL
)

9367 
ªs
 = 
	`JS_DñëePr›îty
(
˘x
, 
obj
, 
¥›
, 
Êags
);

9368 
	`JS_FªeAtom
(
˘x
, 
¥›
);

9369  
ªs
;

9370 
	}
}

9372 
BOOL
 
	$JS_IsFun˘i⁄
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
vÆ
)

9374 
JSObje˘
 *
p
;

9375 i‡(
	`JS_VALUE_GET_TAG
(
vÆ
Ë!
JS_TAG_OBJECT
)

9376  
FALSE
;

9377 
p
 = 
	`JS_VALUE_GET_OBJ
(
vÆ
);

9378 
p
->
˛ass_id
) {

9379 
JS_CLASS_BYTECODE_FUNCTION
:

9380  
TRUE
;

9381 
JS_CLASS_PROXY
:

9382  
p
->
u
.
¥oxy_d©a
->
is_func
;

9384  (
˘x
->
π
->
˛ass_¨øy
[
p
->
˛ass_id
].
ˇŒ
 !
NULL
);

9386 
	}
}

9388 
BOOL
 
	$JS_IsCFun˘i⁄
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
vÆ
, 
JSCFun˘i⁄
 *
func
, 
magic
)

9390 
JSObje˘
 *
p
;

9391 i‡(
	`JS_VALUE_GET_TAG
(
vÆ
Ë!
JS_TAG_OBJECT
)

9392  
FALSE
;

9393 
p
 = 
	`JS_VALUE_GET_OBJ
(
vÆ
);

9394 i‡(
p
->
˛ass_id
 =
JS_CLASS_C_FUNCTION
)

9395  (
p
->
u
.
cfunc
.
c_fun˘i⁄
.
gíîic
 =
func
 &&Ö->u.cfunc.
magic
 == magic);

9397  
FALSE
;

9398 
	}
}

9400 
BOOL
 
	$JS_IsC⁄°ru˘‹
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
vÆ
)

9402 
JSObje˘
 *
p
;

9403 i‡(
	`JS_VALUE_GET_TAG
(
vÆ
Ë!
JS_TAG_OBJECT
)

9404  
FALSE
;

9405 
p
 = 
	`JS_VALUE_GET_OBJ
(
vÆ
);

9406  
p
->
is_c⁄°ru˘‹
;

9407 
	}
}

9409 
BOOL
 
	$JS_SëC⁄°ru˘‹Bô
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
func_obj
, 
BOOL
 
vÆ
)

9411 
JSObje˘
 *
p
;

9412 i‡(
	`JS_VALUE_GET_TAG
(
func_obj
Ë!
JS_TAG_OBJECT
)

9413  
FALSE
;

9414 
p
 = 
	`JS_VALUE_GET_OBJ
(
func_obj
);

9415 
p
->
is_c⁄°ru˘‹
 = 
vÆ
;

9416  
TRUE
;

9417 
	}
}

9419 
BOOL
 
	$JS_IsEº‹
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
vÆ
)

9421 
JSObje˘
 *
p
;

9422 i‡(
	`JS_VALUE_GET_TAG
(
vÆ
Ë!
JS_TAG_OBJECT
)

9423  
FALSE
;

9424 
p
 = 
	`JS_VALUE_GET_OBJ
(
vÆ
);

9425  (
p
->
˛ass_id
 =
JS_CLASS_ERROR
);

9426 
	}
}

9429 
BOOL
 
	$JS_IsUnˇtchabÀEº‹
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
vÆ
)

9431 
JSObje˘
 *
p
;

9432 i‡(
	`JS_VALUE_GET_TAG
(
vÆ
Ë!
JS_TAG_OBJECT
)

9433  
FALSE
;

9434 
p
 = 
	`JS_VALUE_GET_OBJ
(
vÆ
);

9435  
p
->
˛ass_id
 =
JS_CLASS_ERROR
 &&Ö->
is_unˇtchabÀ_îr‹
;

9436 
	}
}

9438 
	$JS_SëUnˇtchabÀEº‹
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
vÆ
, 
BOOL
 
Êag
)

9440 
JSObje˘
 *
p
;

9441 i‡(
	`JS_VALUE_GET_TAG
(
vÆ
Ë!
JS_TAG_OBJECT
)

9443 
p
 = 
	`JS_VALUE_GET_OBJ
(
vÆ
);

9444 i‡(
p
->
˛ass_id
 =
JS_CLASS_ERROR
)

9445 
p
->
is_unˇtchabÀ_îr‹
 = 
Êag
;

9446 
	}
}

9448 
	$JS_Re£tUnˇtchabÀEº‹
(
JSC⁄ãxt
 *
˘x
)

9450 
	`JS_SëUnˇtchabÀEº‹
(
˘x
, ctx->
π
->
cuºít_ex˚±i⁄
, 
FALSE
);

9451 
	}
}

9453 
	$JS_SëO∑que
(
JSVÆue
 
obj
, *
›aque
)

9455 
JSObje˘
 *
p
;

9456 i‡(
	`JS_VALUE_GET_TAG
(
obj
Ë=
JS_TAG_OBJECT
) {

9457 
p
 = 
	`JS_VALUE_GET_OBJ
(
obj
);

9458 
p
->
u
.
›aque
 = opaque;

9460 
	}
}

9463 *
	$JS_GëO∑que
(
JSVÆueC⁄°
 
obj
, 
JSCœssID
 
˛ass_id
)

9465 
JSObje˘
 *
p
;

9466 i‡(
	`JS_VALUE_GET_TAG
(
obj
Ë!
JS_TAG_OBJECT
)

9467  
NULL
;

9468 
p
 = 
	`JS_VALUE_GET_OBJ
(
obj
);

9469 i‡(
p
->
˛ass_id
 != class_id)

9470  
NULL
;

9471  
p
->
u
.
›aque
;

9472 
	}
}

9474 *
	$JS_GëO∑que2
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
obj
, 
JSCœssID
 
˛ass_id
)

9476 *
p
 = 
	`JS_GëO∑que
(
obj
, 
˛ass_id
);

9477 i‡(
	`u∆ikñy
(!
p
)) {

9478 
	`JS_ThrowTy≥Eº‹InvÆidCœss
(
˘x
, 
˛ass_id
);

9480  
p
;

9481 
	}
}

9483 
	#HINT_STRING
 0

	)

9484 
	#HINT_NUMBER
 1

	)

9485 
	#HINT_NONE
 2

	)

9487 
	#HINT_FORCE_ORDINARY
 (1 << 4)

	)

9489 
JSVÆue
 
	$JS_ToPrimôiveFªe
(
JSC⁄ãxt
 *
˘x
, 
JSVÆue
 
vÆ
, 
höt
)

9491 
i
;

9492 
BOOL
 
f‹˚_‹dö¨y
;

9494 
JSAtom
 
mëhod_«me
;

9495 
JSVÆue
 
mëhod
, 
ªt
;

9496 i‡(
	`JS_VALUE_GET_TAG
(
vÆ
Ë!
JS_TAG_OBJECT
)

9497  
vÆ
;

9498 
f‹˚_‹dö¨y
 = 
höt
 & 
HINT_FORCE_ORDINARY
;

9499 
höt
 &~
HINT_FORCE_ORDINARY
;

9500 i‡(!
f‹˚_‹dö¨y
) {

9501 
mëhod
 = 
	`JS_GëPr›îty
(
˘x
, 
vÆ
, 
JS_ATOM_Symbﬁ_toPrimôive
);

9502 i‡(
	`JS_IsEx˚±i⁄
(
mëhod
))

9503 
ex˚±i⁄
;

9506 i‡(!
	`JS_IsUndeföed
(
mëhod
Ë&& !
	`JS_IsNuŒ
(method)) {

9507 
JSAtom
 
©om
;

9508 
JSVÆue
 
¨g
;

9509 
höt
) {

9510 
HINT_STRING
:

9511 
©om
 = 
JS_ATOM_°rög
;

9513 
HINT_NUMBER
:

9514 
©om
 = 
JS_ATOM_numbî
;

9517 
HINT_NONE
:

9518 
©om
 = 
JS_ATOM_deÁu…
;

9521 
¨g
 = 
	`JS_AtomToSåög
(
˘x
, 
©om
);

9522 
ªt
 = 
	`JS_CÆlFªe
(
˘x
, 
mëhod
, 
vÆ
, 1, (
JSVÆueC⁄°
 *)&
¨g
);

9523 
	`JS_FªeVÆue
(
˘x
, 
¨g
);

9524 i‡(
	`JS_IsEx˚±i⁄
(
ªt
))

9525 
ex˚±i⁄
;

9526 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

9527 i‡(
	`JS_VALUE_GET_TAG
(
ªt
Ë!
JS_TAG_OBJECT
)

9528  
ªt
;

9529 
	`JS_FªeVÆue
(
˘x
, 
ªt
);

9530  
	`JS_ThrowTy≥Eº‹
(
˘x
, "toPrimitive");

9533 i‡(
höt
 !
HINT_STRING
)

9534 
höt
 = 
HINT_NUMBER
;

9535 
i
 = 0; i < 2; i++) {

9536 i‡((
i
 ^ 
höt
) == 0) {

9537 
mëhod_«me
 = 
JS_ATOM_toSåög
;

9539 
mëhod_«me
 = 
JS_ATOM_vÆueOf
;

9541 
mëhod
 = 
	`JS_GëPr›îty
(
˘x
, 
vÆ
, 
mëhod_«me
);

9542 i‡(
	`JS_IsEx˚±i⁄
(
mëhod
))

9543 
ex˚±i⁄
;

9544 i‡(
	`JS_IsFun˘i⁄
(
˘x
, 
mëhod
)) {

9545 
ªt
 = 
	`JS_CÆlFªe
(
˘x
, 
mëhod
, 
vÆ
, 0, 
NULL
);

9546 i‡(
	`JS_IsEx˚±i⁄
(
ªt
))

9547 
ex˚±i⁄
;

9548 i‡(
	`JS_VALUE_GET_TAG
(
ªt
Ë!
JS_TAG_OBJECT
) {

9549 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

9550  
ªt
;

9552 
	`JS_FªeVÆue
(
˘x
, 
ªt
);

9554 
	`JS_FªeVÆue
(
˘x
, 
mëhod
);

9557 
	`JS_ThrowTy≥Eº‹
(
˘x
, "toPrimitive");

9558 
ex˚±i⁄
:

9559 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

9560  
JS_EXCEPTION
;

9561 
	}
}

9563 
JSVÆue
 
	$JS_ToPrimôive
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
vÆ
, 
höt
)

9565  
	`JS_ToPrimôiveFªe
(
˘x
, 
	`JS_DupVÆue
(˘x, 
vÆ
), 
höt
);

9566 
	}
}

9568 
	$JS_ToBoﬁFªe
(
JSC⁄ãxt
 *
˘x
, 
JSVÆue
 
vÆ
)

9570 
uöt32_t
 
èg
 = 
	`JS_VALUE_GET_TAG
(
vÆ
);

9571 
èg
) {

9572 
JS_TAG_INT
:

9573  
	`JS_VALUE_GET_INT
(
vÆ
) != 0;

9574 
JS_TAG_BOOL
:

9575 
JS_TAG_NULL
:

9576 
JS_TAG_UNDEFINED
:

9577  
	`JS_VALUE_GET_INT
(
vÆ
);

9578 
JS_TAG_EXCEPTION
:

9580 
JS_TAG_STRING
:

9582 
BOOL
 
ªt
 = 
	`JS_VALUE_GET_STRING
(
vÆ
)->
Àn
 != 0;

9583 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

9584  
ªt
;

9586 #ifde‡
CONFIG_BIGNUM


9587 
JS_TAG_BIG_INT
:

9588 
JS_TAG_BIG_FLOAT
:

9590 
JSBigFlﬂt
 *
p
 = 
	`JS_VALUE_GET_PTR
(
vÆ
);

9591 
BOOL
 
ªt
;

9592 
ªt
 = 
p
->
num
.
ex≤
 !
BF_EXP_ZERO
 &&Ö->num.ex≤ !
BF_EXP_NAN
;

9593 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

9594  
ªt
;

9596 
JS_TAG_BIG_DECIMAL
:

9598 
JSBigDecimÆ
 *
p
 = 
	`JS_VALUE_GET_PTR
(
vÆ
);

9599 
BOOL
 
ªt
;

9600 
ªt
 = 
p
->
num
.
ex≤
 !
BF_EXP_ZERO
 &&Ö->num.ex≤ !
BF_EXP_NAN
;

9601 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

9602  
ªt
;

9606 i‡(
	`JS_TAG_IS_FLOAT64
(
èg
)) {

9607 
d
 = 
	`JS_VALUE_GET_FLOAT64
(
vÆ
);

9608  !
	`i¢™
(
d
) && d != 0;

9610 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

9611  
TRUE
;

9614 
	}
}

9616 
	$JS_ToBoﬁ
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
vÆ
)

9618  
	`JS_ToBoﬁFªe
(
˘x
, 
	`JS_DupVÆue
(˘x, 
vÆ
));

9619 
	}
}

9621 
	$skù_•a˚s
(c⁄° *
pc
)

9623 c⁄° 
uöt8_t
 *
p
, *
p_√xt
, *
p_°¨t
;

9624 
uöt32_t
 
c
;

9626 
p
 = 
p_°¨t
 = (c⁄° 
uöt8_t
 *)
pc
;

9628 
c
 = *
p
;

9629 i‡(
c
 < 128) {

9630 i‡(!((
c
 >= 0x09 && c <= 0x0d) || (c == 0x20)))

9632 
p
++;

9634 
c
 = 
	`unicode_‰om_utf8
(
p
, 
UTF8_CHAR_LEN_MAX
, &
p_√xt
);

9635 i‡(!
	`Ãe_is_•a˚
(
c
))

9637 
p
 = 
p_√xt
;

9640  
p
 - 
p_°¨t
;

9641 
	}
}

9643 
ölöe
 
	$to_digô
(
c
)

9645 i‡(
c
 >= '0' && c <= '9')

9646  
c
 - '0';

9647 i‡(
c
 >= 'A' && c <= 'Z')

9648  
c
 - 'A' + 10;

9649 i‡(
c
 >= 'a' && c <= 'z')

9650  
c
 - 'a' + 10;

9653 
	}
}

9656 
	$js_°πod
(c⁄° *
p
, 
ødix
, 
BOOL
 
is_Êﬂt
)

9658 
d
;

9659 
c
;

9661 i‡(!
is_Êﬂt
 || 
ødix
 != 10) {

9662 
uöt64_t
 
n_max
, 
n
;

9663 
öt_exp
, 
is_√g
;

9665 
is_√g
 = 0;

9666 i‡(*
p
 == '-') {

9667 
is_√g
 = 1;

9668 
p
++;

9672 *
p
 == '0')

9673 
p
++;

9674 
n
 = 0;

9675 i‡(
ødix
 == 10)

9676 
n_max
 = ((
uöt64_t
)-1 - 9) / 10;

9678 
n_max
 = ((
uöt64_t
)-1 - (
ødix
 - 1)) /Ñadix;

9680 
öt_exp
 = 0;

9681 *
p
 != '\0') {

9682 
c
 = 
	`to_digô
((
uöt8_t
)*
p
);

9683 i‡(
c
 >
ødix
)

9685 i‡(
n
 <
n_max
) {

9686 
n
 =Ç * 
ødix
 + 
c
;

9688 
öt_exp
++;

9690 
p
++;

9692 
d
 = 
n
;

9693 i‡(
öt_exp
 != 0) {

9694 
d
 *
	`pow
(
ødix
, 
öt_exp
);

9696 i‡(
is_√g
)

9697 
d
 = -d;

9699 
d
 = 
	`°πod
(
p
, 
NULL
);

9701  
d
;

9702 
	}
}

9704 
	#ATOD_INT_ONLY
 (1 << 0)

	)

9706 
	#ATOD_ACCEPT_BIN_OCT
 (1 << 2)

	)

9708 
	#ATOD_ACCEPT_LEGACY_OCTAL
 (1 << 4)

	)

9710 
	#ATOD_ACCEPT_UNDERSCORES
 (1 << 5)

	)

9712 
	#ATOD_ACCEPT_SUFFIX
 (1 << 6)

	)

9714 
	#ATOD_TYPE_MASK
 (3 << 7)

	)

9715 
	#ATOD_TYPE_FLOAT64
 (0 << 7)

	)

9716 
	#ATOD_TYPE_BIG_INT
 (1 << 7)

	)

9717 
	#ATOD_TYPE_BIG_FLOAT
 (2 << 7)

	)

9718 
	#ATOD_TYPE_BIG_DECIMAL
 (3 << 7)

	)

9721 
	#ATOD_MODE_BIGINT
 (1 << 9)

	)

9723 
	#ATOD_ACCEPT_PREFIX_AFTER_SIGN
 (1 << 10)

	)

9725 #ifde‡
CONFIG_BIGNUM


9726 
JSVÆue
 
	$js_°rög_to_bigöt
(
JSC⁄ãxt
 *
˘x
, c⁄° *
buf
,

9727 
ødix
, 
Êags
, 
¶imb_t
 *
≥xp⁄ít
)

9729 
bf_t
 
a_s
, *
a
 = &a_s;

9730 
ªt
;

9731 
JSVÆue
 
vÆ
;

9732 
vÆ
 = 
	`JS_NewBigI¡
(
˘x
);

9733 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

9734  
vÆ
;

9735 
a
 = 
	`JS_GëBigI¡
(
vÆ
);

9736 
ªt
 = 
	`bf_©of
(
a
, 
buf
, 
NULL
, 
ødix
, 
BF_PREC_INF
, 
BF_RNDZ
);

9737 i‡(
ªt
 & 
BF_ST_MEM_ERROR
) {

9738 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

9739  
	`JS_ThrowOutOfMem‹y
(
˘x
);

9741 
vÆ
 = 
	`JS_Com∑˘BigI¡1
(
˘x
, vÆ, (
Êags
 & 
ATOD_MODE_BIGINT
) != 0);

9742  
vÆ
;

9743 
	}
}

9745 
JSVÆue
 
	$js_°rög_to_bigÊﬂt
(
JSC⁄ãxt
 *
˘x
, c⁄° *
buf
,

9746 
ødix
, 
Êags
, 
¶imb_t
 *
≥xp⁄ít
)

9748 
bf_t
 *
a
;

9749 
ªt
;

9750 
JSVÆue
 
vÆ
;

9752 
vÆ
 = 
	`JS_NewBigFlﬂt
(
˘x
);

9753 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

9754  
vÆ
;

9755 
a
 = 
	`JS_GëBigFlﬂt
(
vÆ
);

9756 i‡(
Êags
 & 
ATOD_ACCEPT_SUFFIX
) {

9758 
ªt
 = 
	`bf_©of2
(
a
, 
≥xp⁄ít
, 
buf
, 
NULL
, 
ødix
, 
BF_PREC_INF
,

9759 
BF_RNDZ
 | 
BF_ATOF_EXPONENT
);

9761 
ªt
 = 
	`bf_©of
(
a
, 
buf
, 
NULL
, 
ødix
, 
˘x
->
Â_ív
.
¥ec
,

9762 
˘x
->
Â_ív
.
Êags
);

9764 i‡(
ªt
 & 
BF_ST_MEM_ERROR
) {

9765 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

9766  
	`JS_ThrowOutOfMem‹y
(
˘x
);

9768  
vÆ
;

9769 
	}
}

9771 
JSVÆue
 
	$js_°rög_to_bigdecimÆ
(
JSC⁄ãxt
 *
˘x
, c⁄° *
buf
,

9772 
ødix
, 
Êags
, 
¶imb_t
 *
≥xp⁄ít
)

9774 
bfdec_t
 *
a
;

9775 
ªt
;

9776 
JSVÆue
 
vÆ
;

9778 
vÆ
 = 
	`JS_NewBigDecimÆ
(
˘x
);

9779 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

9780  
vÆ
;

9781 
a
 = 
	`JS_GëBigDecimÆ
(
vÆ
);

9782 
ªt
 = 
	`bfdec_©of
(
a
, 
buf
, 
NULL
, 
BF_PREC_INF
,

9783 
BF_RNDZ
 | 
BF_ATOF_NO_NAN_INF
);

9784 i‡(
ªt
 & 
BF_ST_MEM_ERROR
) {

9785 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

9786  
	`JS_ThrowOutOfMem‹y
(
˘x
);

9788  
vÆ
;

9789 
	}
}

9795 #ifde‡
CONFIG_BIGNUM


9796 
JSVÆue
 
	$js_©of2
(
JSC⁄ãxt
 *
˘x
, c⁄° *
°r
, c⁄° **
µ
,

9797 
ødix
, 
Êags
, 
¶imb_t
 *
≥xp⁄ít
)

9799 
JSVÆue
 
	$js_©of
(
JSC⁄ãxt
 *
˘x
, c⁄° *
°r
, c⁄° **
µ
,

9800 
ødix
, 
Êags
)

9803 c⁄° *
p
, *
p_°¨t
;

9804 
£p
, 
is_√g
;

9805 
BOOL
 
is_Êﬂt
, 
has_Àgacy_o˘Æ
;

9806 
©od_ty≥
 = 
Êags
 & 
ATOD_TYPE_MASK
;

9807 
buf1
[64], *
buf
;

9808 
i
, 
j
, 
Àn
;

9809 
BOOL
 
buf_Æloˇãd
 = 
FALSE
;

9810 
JSVÆue
 
vÆ
;

9813 
£p
 = (
Êags
 & 
ATOD_ACCEPT_UNDERSCORES
) ? '_' : 256;

9814 
has_Àgacy_o˘Æ
 = 
FALSE
;

9816 
p
 = 
°r
;

9817 
p_°¨t
 = 
p
;

9818 
is_√g
 = 0;

9819 i‡(
p
[0] == '+') {

9820 
p
++;

9821 
p_°¨t
++;

9822 i‡(!(
Êags
 & 
ATOD_ACCEPT_PREFIX_AFTER_SIGN
))

9823 
no_ødix_¥efix
;

9824 } i‡(
p
[0] == '-') {

9825 
p
++;

9826 
p_°¨t
++;

9827 
is_√g
 = 1;

9828 i‡(!(
Êags
 & 
ATOD_ACCEPT_PREFIX_AFTER_SIGN
))

9829 
no_ødix_¥efix
;

9831 i‡(
p
[0] == '0') {

9832 i‡((
p
[1] == 'x' ||Ö[1] == 'X') &&

9833 (
ødix
 == 0 ||Ñadix == 16)) {

9834 
p
 += 2;

9835 
ødix
 = 16;

9836 } i‡((
p
[1] == 'o' ||Ö[1] == 'O') &&

9837 
ødix
 =0 && (
Êags
 & 
ATOD_ACCEPT_BIN_OCT
)) {

9838 
p
 += 2;

9839 
ødix
 = 8;

9840 } i‡((
p
[1] == 'b' ||Ö[1] == 'B') &&

9841 
ødix
 =0 && (
Êags
 & 
ATOD_ACCEPT_BIN_OCT
)) {

9842 
p
 += 2;

9843 
ødix
 = 2;

9844 } i‡((
p
[1] >= '0' &&Ö[1] <= '9') &&

9845 
ødix
 =0 && (
Êags
 & 
ATOD_ACCEPT_LEGACY_OCTAL
)) {

9846 
i
;

9847 
has_Àgacy_o˘Æ
 = 
TRUE
;

9848 
£p
 = 256;

9849 
i
 = 1; (
p
[i] >= '0' &&Ö[i] <= '7'); i++)

9851 i‡(
p
[
i
] == '8' ||Ö[i] == '9')

9852 
no_¥efix
;

9853 
p
 += 1;

9854 
ødix
 = 8;

9856 
no_¥efix
;

9859 i‡(
	`to_digô
((
uöt8_t
)*
p
Ë>
ødix
)

9860 
Áû
;

9861 
no_¥efix
: ;

9863 
no_ødix_¥efix
:

9864 i‡(!(
Êags
 & 
ATOD_INT_ONLY
) &&

9865 (
©od_ty≥
 =
ATOD_TYPE_FLOAT64
 ||

9866 
©od_ty≥
 =
ATOD_TYPE_BIG_FLOAT
) &&

9867 
	`°r°¨t
(
p
, "Infinity", &p)) {

9868 #ifde‡
CONFIG_BIGNUM


9869 i‡(
©od_ty≥
 =
ATOD_TYPE_BIG_FLOAT
) {

9870 
bf_t
 *
a
;

9871 
vÆ
 = 
	`JS_NewBigFlﬂt
(
˘x
);

9872 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

9873 
d⁄e
;

9874 
a
 = 
	`JS_GëBigFlﬂt
(
vÆ
);

9875 
	`bf_£t_öf
(
a
, 
is_√g
);

9879 
d
 = 1.0 / 0.0;

9880 i‡(
is_√g
)

9881 
d
 = -d;

9882 
vÆ
 = 
	`JS_NewFlﬂt64
(
˘x
, 
d
);

9884 
d⁄e
;

9887 i‡(
ødix
 == 0)

9888 
ødix
 = 10;

9889 
is_Êﬂt
 = 
FALSE
;

9890 
p_°¨t
 = 
p
;

9891 
	`to_digô
((
uöt8_t
)*
p
Ë< 
ødix


9892 || (*
p
 =
£p
 && (
ødix
 != 10 ||

9893 
p
 !
p_°¨t
 + 1 ||Ö[-1] != '0') &&

9894 
	`to_digô
((
uöt8_t
)
p
[1]Ë< 
ødix
)) {

9895 
p
++;

9897 i‡(!(
Êags
 & 
ATOD_INT_ONLY
)) {

9898 i‡(*
p
 ='.' && (∞> 
p_°¨t
 || 
	`to_digô
((
uöt8_t
Ì[1]Ë< 
ødix
)) {

9899 
is_Êﬂt
 = 
TRUE
;

9900 
p
++;

9901 i‡(*
p
 =
£p
)

9902 
Áû
;

9903 
	`to_digô
((
uöt8_t
)*
p
Ë< 
ødix
 ||

9904 (*
p
 =
£p
 && 
	`to_digô
((
uöt8_t
Ì[1]Ë< 
ødix
))

9905 
p
++;

9907 i‡(
p
 > 
p_°¨t
 &&

9908 (((*
p
 ='e' || *∞='E'Ë&& 
ødix
 == 10) ||

9909 ((*
p
 ='p' || *∞='P'Ë&& (
ødix
 == 2 ||Ñadix == 8 ||Ñadix == 16)))) {

9910 c⁄° *
p1
 = 
p
 + 1;

9911 
is_Êﬂt
 = 
TRUE
;

9912 i‡(*
p1
 == '+') {

9913 
p1
++;

9914 } i‡(*
p1
 == '-') {

9915 
p1
++;

9917 i‡(
	`is_digô
((
uöt8_t
)*
p1
)) {

9918 
p
 = 
p1
 + 1;

9919 
	`is_digô
((
uöt8_t
)*
p
Ë|| (*∞=
£p
 && is_digit((uint8_t)p[1])))

9920 
p
++;

9924 i‡(
p
 =
p_°¨t
)

9925 
Áû
;

9927 
buf
 = 
buf1
;

9928 
buf_Æloˇãd
 = 
FALSE
;

9929 
Àn
 = 
p
 - 
p_°¨t
;

9930 i‡(
	`u∆ikñy
((
Àn
 + 2Ë> (
buf1
))) {

9931 
buf
 = 
	`js_mÆloc_π
(
˘x
->
π
, 
Àn
 + 2);

9932 i‡(!
buf
)

9933 
mem_îr‹
;

9934 
buf_Æloˇãd
 = 
TRUE
;

9937 
j
 = 0;

9938 i‡(
is_√g
)

9939 
buf
[
j
++] = '-';

9940 
i
 = 0; i < 
Àn
; i++) {

9941 i‡(
p_°¨t
[
i
] != '_')

9942 
buf
[
j
++] = 
p_°¨t
[
i
];

9944 
buf
[
j
] = '\0';

9946 #ifde‡
CONFIG_BIGNUM


9947 i‡(
Êags
 & 
ATOD_ACCEPT_SUFFIX
) {

9948 i‡(*
p
 == 'n') {

9949 
p
++;

9950 
©od_ty≥
 = 
ATOD_TYPE_BIG_INT
;

9951 } i‡(*
p
 == 'l') {

9952 
p
++;

9953 
©od_ty≥
 = 
ATOD_TYPE_BIG_FLOAT
;

9954 } i‡(*
p
 == 'm') {

9955 
p
++;

9956 
©od_ty≥
 = 
ATOD_TYPE_BIG_DECIMAL
;

9958 i‡(
Êags
 & 
ATOD_MODE_BIGINT
) {

9959 i‡(!
is_Êﬂt
)

9960 
©od_ty≥
 = 
ATOD_TYPE_BIG_INT
;

9961 i‡(
has_Àgacy_o˘Æ
)

9962 
Áû
;

9964 i‡(
is_Êﬂt
 && 
ødix
 != 10)

9965 
Áû
;

9969 i‡(
©od_ty≥
 =
ATOD_TYPE_FLOAT64
) {

9970 i‡(
Êags
 & 
ATOD_MODE_BIGINT
) {

9971 i‡(!
is_Êﬂt
)

9972 
©od_ty≥
 = 
ATOD_TYPE_BIG_INT
;

9973 i‡(
has_Àgacy_o˘Æ
)

9974 
Áû
;

9976 i‡(
is_Êﬂt
 && 
ødix
 != 10)

9977 
Áû
;

9982 
©od_ty≥
) {

9983 
ATOD_TYPE_FLOAT64
:

9985 
d
;

9986 
d
 = 
	`js_°πod
(
buf
, 
ødix
, 
is_Êﬂt
);

9988 
vÆ
 = 
	`JS_NewFlﬂt64
(
˘x
, 
d
);

9991 
ATOD_TYPE_BIG_INT
:

9992 i‡(
has_Àgacy_o˘Æ
 || 
is_Êﬂt
)

9993 
Áû
;

9994 
vÆ
 = 
˘x
->
π
->
bigöt_›s
.
	`‰om_°rög
(˘x, 
buf
, 
ødix
, 
Êags
, 
NULL
);

9996 
ATOD_TYPE_BIG_FLOAT
:

9997 i‡(
has_Àgacy_o˘Æ
)

9998 
Áû
;

9999 
vÆ
 = 
˘x
->
π
->
bigÊﬂt_›s
.
	`‰om_°rög
(˘x, 
buf
, 
ødix
, 
Êags
,

10000 
≥xp⁄ít
);

10002 
ATOD_TYPE_BIG_DECIMAL
:

10003 i‡(
ødix
 != 10)

10004 
Áû
;

10005 
vÆ
 = 
˘x
->
π
->
bigdecimÆ_›s
.
	`‰om_°rög
(˘x, 
buf
, 
ødix
, 
Êags
, 
NULL
);

10008 
	`ab‹t
();

10012 
d
;

10013 ()
has_Àgacy_o˘Æ
;

10014 i‡(
is_Êﬂt
 && 
ødix
 != 10)

10015 
Áû
;

10016 
d
 = 
	`js_°πod
(
buf
, 
ødix
, 
is_Êﬂt
);

10017 
vÆ
 = 
	`JS_NewFlﬂt64
(
˘x
, 
d
);

10021 
d⁄e
:

10022 i‡(
buf_Æloˇãd
)

10023 
	`js_‰ì_π
(
˘x
->
π
, 
buf
);

10024 i‡(
µ
)

10025 *
µ
 = 
p
;

10026  
vÆ
;

10027 
Áû
:

10028 
vÆ
 = 
JS_NAN
;

10029 
d⁄e
;

10030 
mem_îr‹
:

10031 
vÆ
 = 
	`JS_ThrowOutOfMem‹y
(
˘x
);

10032 
d⁄e
;

10033 
	}
}

10035 #ifde‡
CONFIG_BIGNUM


10036 
JSVÆue
 
	$js_©of
(
JSC⁄ãxt
 *
˘x
, c⁄° *
°r
, c⁄° **
µ
,

10037 
ødix
, 
Êags
)

10039  
	`js_©of2
(
˘x
, 
°r
, 
µ
, 
ødix
, 
Êags
, 
NULL
);

10040 
	}
}

10043 
	eJSToNumbîHötEnum
 {

10044 
	mTON_FLAG_NUMBER
,

10045 
	mTON_FLAG_NUMERIC
,

10046 } 
	tJSToNumbîHötEnum
;

10048 
JSVÆue
 
	$JS_ToNumbîHötFªe
(
JSC⁄ãxt
 *
˘x
, 
JSVÆue
 
vÆ
,

10049 
JSToNumbîHötEnum
 
Êag
)

10051 
uöt32_t
 
èg
;

10052 
JSVÆue
 
ªt
;

10054 
ªdo
:

10055 
èg
 = 
	`JS_VALUE_GET_NORM_TAG
(
vÆ
);

10056 
èg
) {

10057 #ifde‡
CONFIG_BIGNUM


10058 
JS_TAG_BIG_DECIMAL
:

10059 i‡(
Êag
 !
TON_FLAG_NUMERIC
) {

10060 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

10061  
	`JS_ThrowTy≥Eº‹
(
˘x
, "cannot convert bigdecimalÅoÇumber");

10063 
ªt
 = 
vÆ
;

10065 
JS_TAG_BIG_INT
:

10066 i‡(
Êag
 !
TON_FLAG_NUMERIC
) {

10067 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

10068  
	`JS_ThrowTy≥Eº‹
(
˘x
, "cannot convert bigintÅoÇumber");

10070 
ªt
 = 
vÆ
;

10072 
JS_TAG_BIG_FLOAT
:

10073 i‡(
Êag
 !
TON_FLAG_NUMERIC
) {

10074 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

10075  
	`JS_ThrowTy≥Eº‹
(
˘x
, "cannot convert bigfloatÅoÇumber");

10077 
ªt
 = 
vÆ
;

10080 
JS_TAG_FLOAT64
:

10081 
JS_TAG_INT
:

10082 
JS_TAG_EXCEPTION
:

10083 
ªt
 = 
vÆ
;

10085 
JS_TAG_BOOL
:

10086 
JS_TAG_NULL
:

10087 
ªt
 = 
	`JS_NewI¡32
(
˘x
, 
	`JS_VALUE_GET_INT
(
vÆ
));

10089 
JS_TAG_UNDEFINED
:

10090 
ªt
 = 
JS_NAN
;

10092 
JS_TAG_OBJECT
:

10093 
vÆ
 = 
	`JS_ToPrimôiveFªe
(
˘x
, vÆ, 
HINT_NUMBER
);

10094 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

10095  
JS_EXCEPTION
;

10096 
ªdo
;

10097 
JS_TAG_STRING
:

10099 c⁄° *
°r
;

10100 c⁄° *
p
;

10101 
size_t
 
Àn
;

10103 
°r
 = 
	`JS_ToCSåögLí
(
˘x
, &
Àn
, 
vÆ
);

10104 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

10105 i‡(!
°r
)

10106  
JS_EXCEPTION
;

10107 
p
 = 
°r
;

10108 
p
 +
	`skù_•a˚s
(p);

10109 i‡((
p
 - 
°r
Ë=
Àn
) {

10110 
ªt
 = 
	`JS_NewI¡32
(
˘x
, 0);

10112 
Êags
 = 
ATOD_ACCEPT_BIN_OCT
;

10113 
ªt
 = 
	`js_©of
(
˘x
, 
p
, &p, 0, 
Êags
);

10114 i‡(!
	`JS_IsEx˚±i⁄
(
ªt
)) {

10115 
p
 +
	`skù_•a˚s
(p);

10116 i‡((
p
 - 
°r
Ë!
Àn
) {

10117 
	`JS_FªeVÆue
(
˘x
, 
ªt
);

10118 
ªt
 = 
JS_NAN
;

10122 
	`JS_FªeCSåög
(
˘x
, 
°r
);

10125 
JS_TAG_SYMBOL
:

10126 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

10127  
	`JS_ThrowTy≥Eº‹
(
˘x
, "cannot convert symbolÅoÇumber");

10129 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

10130 
ªt
 = 
JS_NAN
;

10133  
ªt
;

10134 
	}
}

10136 
JSVÆue
 
	$JS_ToNumbîFªe
(
JSC⁄ãxt
 *
˘x
, 
JSVÆue
 
vÆ
)

10138  
	`JS_ToNumbîHötFªe
(
˘x
, 
vÆ
, 
TON_FLAG_NUMBER
);

10139 
	}
}

10141 
JSVÆue
 
	$JS_ToNumîicFªe
(
JSC⁄ãxt
 *
˘x
, 
JSVÆue
 
vÆ
)

10143  
	`JS_ToNumbîHötFªe
(
˘x
, 
vÆ
, 
TON_FLAG_NUMERIC
);

10144 
	}
}

10146 
JSVÆue
 
	$JS_ToNumîic
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
vÆ
)

10148  
	`JS_ToNumîicFªe
(
˘x
, 
	`JS_DupVÆue
(˘x, 
vÆ
));

10149 
	}
}

10151 
__ex˚±i⁄
 
	$__JS_ToFlﬂt64Fªe
(
JSC⁄ãxt
 *
˘x
, *
¥es
,

10152 
JSVÆue
 
vÆ
)

10154 
d
;

10155 
uöt32_t
 
èg
;

10157 
vÆ
 = 
	`JS_ToNumbîFªe
(
˘x
, val);

10158 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
)) {

10159 *
¥es
 = 
JS_FLOAT64_NAN
;

10162 
èg
 = 
	`JS_VALUE_GET_NORM_TAG
(
vÆ
);

10163 
èg
) {

10164 
JS_TAG_INT
:

10165 
d
 = 
	`JS_VALUE_GET_INT
(
vÆ
);

10167 
JS_TAG_FLOAT64
:

10168 
d
 = 
	`JS_VALUE_GET_FLOAT64
(
vÆ
);

10170 #ifde‡
CONFIG_BIGNUM


10171 
JS_TAG_BIG_INT
:

10172 
JS_TAG_BIG_FLOAT
:

10174 
JSBigFlﬂt
 *
p
 = 
	`JS_VALUE_GET_PTR
(
vÆ
);

10178 
	`bf_gë_Êﬂt64
(&
p
->
num
, &
d
, 
BF_RNDN
);

10179 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

10184 
	`ab‹t
();

10186 *
¥es
 = 
d
;

10188 
	}
}

10190 
ölöe
 
	$JS_ToFlﬂt64Fªe
(
JSC⁄ãxt
 *
˘x
, *
¥es
, 
JSVÆue
 
vÆ
)

10192 
uöt32_t
 
èg
;

10194 
èg
 = 
	`JS_VALUE_GET_TAG
(
vÆ
);

10195 i‡(
èg
 <
JS_TAG_NULL
) {

10196 *
¥es
 = 
	`JS_VALUE_GET_INT
(
vÆ
);

10198 } i‡(
	`JS_TAG_IS_FLOAT64
(
èg
)) {

10199 *
¥es
 = 
	`JS_VALUE_GET_FLOAT64
(
vÆ
);

10202  
	`__JS_ToFlﬂt64Fªe
(
˘x
, 
¥es
, 
vÆ
);

10204 
	}
}

10206 
	$JS_ToFlﬂt64
(
JSC⁄ãxt
 *
˘x
, *
¥es
, 
JSVÆueC⁄°
 
vÆ
)

10208  
	`JS_ToFlﬂt64Fªe
(
˘x
, 
¥es
, 
	`JS_DupVÆue
(˘x, 
vÆ
));

10209 
	}
}

10211 
JSVÆue
 
	$JS_ToNumbî
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
vÆ
)

10213  
	`JS_ToNumbîFªe
(
˘x
, 
	`JS_DupVÆue
(˘x, 
vÆ
));

10214 
	}
}

10217 
__maybe_unu£d
 
JSVÆue
 
	$JS_ToI¡egîFªe
(
JSC⁄ãxt
 *
˘x
, 
JSVÆue
 
vÆ
)

10219 
uöt32_t
 
èg
;

10220 
JSVÆue
 
ªt
;

10222 
ªdo
:

10223 
èg
 = 
	`JS_VALUE_GET_NORM_TAG
(
vÆ
);

10224 
èg
) {

10225 
JS_TAG_INT
:

10226 
JS_TAG_BOOL
:

10227 
JS_TAG_NULL
:

10228 
JS_TAG_UNDEFINED
:

10229 
ªt
 = 
	`JS_NewI¡32
(
˘x
, 
	`JS_VALUE_GET_INT
(
vÆ
));

10231 
JS_TAG_FLOAT64
:

10233 
d
 = 
	`JS_VALUE_GET_FLOAT64
(
vÆ
);

10234 i‡(
	`i¢™
(
d
)) {

10235 
ªt
 = 
	`JS_NewI¡32
(
˘x
, 0);

10238 
d
 = 
	`åunc
(d) + 0.0;

10239 
ªt
 = 
	`JS_NewFlﬂt64
(
˘x
, 
d
);

10243 #ifde‡
CONFIG_BIGNUM


10244 
JS_TAG_BIG_FLOAT
:

10246 
bf_t
 
a_s
, *
a
, 
r_s
, *
r
 = &r_s;

10247 
BOOL
 
is_«n
;

10249 
a
 = 
	`JS_ToBigFlﬂt
(
˘x
, &
a_s
, 
vÆ
);

10250 i‡(!
	`bf_is_föôe
(
a
)) {

10251 
is_«n
 = 
	`bf_is_«n
(
a
);

10252 i‡(
is_«n
)

10253 
ªt
 = 
	`JS_NewI¡32
(
˘x
, 0);

10255 
ªt
 = 
	`JS_DupVÆue
(
˘x
, 
vÆ
);

10257 
ªt
 = 
	`JS_NewBigI¡
(
˘x
);

10258 i‡(!
	`JS_IsEx˚±i⁄
(
ªt
)) {

10259 
r
 = 
	`JS_GëBigI¡
(
ªt
);

10260 
	`bf_£t
(
r
, 
a
);

10261 
	`bf_röt
(
r
, 
BF_RNDZ
);

10262 
ªt
 = 
	`JS_Com∑˘BigI¡
(
˘x
,Ñet);

10265 i‡(
a
 =&
a_s
)

10266 
	`bf_dñëe
(
a
);

10267 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

10272 
vÆ
 = 
	`JS_ToNumbîFªe
(
˘x
, val);

10273 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

10274  
vÆ
;

10275 
ªdo
;

10277  
ªt
;

10278 
	}
}

10281 
	$JS_ToI¡32S©Fªe
(
JSC⁄ãxt
 *
˘x
, *
¥es
, 
JSVÆue
 
vÆ
)

10283 
uöt32_t
 
èg
;

10284 
ªt
;

10286 
ªdo
:

10287 
èg
 = 
	`JS_VALUE_GET_NORM_TAG
(
vÆ
);

10288 
èg
) {

10289 
JS_TAG_INT
:

10290 
JS_TAG_BOOL
:

10291 
JS_TAG_NULL
:

10292 
JS_TAG_UNDEFINED
:

10293 
ªt
 = 
	`JS_VALUE_GET_INT
(
vÆ
);

10295 
JS_TAG_EXCEPTION
:

10296 *
¥es
 = 0;

10298 
JS_TAG_FLOAT64
:

10300 
d
 = 
	`JS_VALUE_GET_FLOAT64
(
vÆ
);

10301 i‡(
	`i¢™
(
d
)) {

10302 
ªt
 = 0;

10304 i‡(
d
 < 
INT32_MIN
)

10305 
ªt
 = 
INT32_MIN
;

10306 i‡(
d
 > 
INT32_MAX
)

10307 
ªt
 = 
INT32_MAX
;

10309 
ªt
 = ()
d
;

10313 #ifde‡
CONFIG_BIGNUM


10314 
JS_TAG_BIG_FLOAT
:

10316 
JSBigFlﬂt
 *
p
 = 
	`JS_VALUE_GET_PTR
(
vÆ
);

10317 
	`bf_gë_öt32
(&
ªt
, &
p
->
num
, 0);

10318 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

10323 
vÆ
 = 
	`JS_ToNumbîFªe
(
˘x
, val);

10324 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
)) {

10325 *
¥es
 = 0;

10328 
ªdo
;

10330 *
¥es
 = 
ªt
;

10332 
	}
}

10334 
	$JS_ToI¡32S©
(
JSC⁄ãxt
 *
˘x
, *
¥es
, 
JSVÆueC⁄°
 
vÆ
)

10336  
	`JS_ToI¡32S©Fªe
(
˘x
, 
¥es
, 
	`JS_DupVÆue
(˘x, 
vÆ
));

10337 
	}
}

10339 
	$JS_ToI¡32Cœmp
(
JSC⁄ãxt
 *
˘x
, *
¥es
, 
JSVÆueC⁄°
 
vÆ
,

10340 
mö
, 
max
, 
mö_off£t
)

10342 
ªs
 = 
	`JS_ToI¡32S©Fªe
(
˘x
, 
¥es
, 
	`JS_DupVÆue
(˘x, 
vÆ
));

10343 i‡(
ªs
 == 0) {

10344 i‡(*
¥es
 < 
mö
) {

10345 *
¥es
 +
mö_off£t
;

10346 i‡(*
¥es
 < 
mö
)

10347 *
¥es
 = 
mö
;

10349 i‡(*
¥es
 > 
max
)

10350 *
¥es
 = 
max
;

10353  
ªs
;

10354 
	}
}

10356 
	$JS_ToI¡64S©Fªe
(
JSC⁄ãxt
 *
˘x
, 
öt64_t
 *
¥es
, 
JSVÆue
 
vÆ
)

10358 
uöt32_t
 
èg
;

10360 
ªdo
:

10361 
èg
 = 
	`JS_VALUE_GET_NORM_TAG
(
vÆ
);

10362 
èg
) {

10363 
JS_TAG_INT
:

10364 
JS_TAG_BOOL
:

10365 
JS_TAG_NULL
:

10366 
JS_TAG_UNDEFINED
:

10367 *
¥es
 = 
	`JS_VALUE_GET_INT
(
vÆ
);

10369 
JS_TAG_EXCEPTION
:

10370 *
¥es
 = 0;

10372 
JS_TAG_FLOAT64
:

10374 
d
 = 
	`JS_VALUE_GET_FLOAT64
(
vÆ
);

10375 i‡(
	`i¢™
(
d
)) {

10376 *
¥es
 = 0;

10378 i‡(
d
 < 
INT64_MIN
)

10379 *
¥es
 = 
INT64_MIN
;

10380 i‡(
d
 > 
INT64_MAX
)

10381 *
¥es
 = 
INT64_MAX
;

10383 *
¥es
 = (
söt64_t
)
d
;

10387 #ifde‡
CONFIG_BIGNUM


10388 
JS_TAG_BIG_FLOAT
:

10390 
JSBigFlﬂt
 *
p
 = 
	`JS_VALUE_GET_PTR
(
vÆ
);

10391 
	`bf_gë_öt64
(
¥es
, &
p
->
num
, 0);

10392 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

10397 
vÆ
 = 
	`JS_ToNumbîFªe
(
˘x
, val);

10398 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
)) {

10399 *
¥es
 = 0;

10402 
ªdo
;

10404 
	}
}

10406 
	$JS_ToI¡64S©
(
JSC⁄ãxt
 *
˘x
, 
söt64_t
 *
¥es
, 
JSVÆueC⁄°
 
vÆ
)

10408  
	`JS_ToI¡64S©Fªe
(
˘x
, 
¥es
, 
	`JS_DupVÆue
(˘x, 
vÆ
));

10409 
	}
}

10411 
	$JS_ToI¡64Cœmp
(
JSC⁄ãxt
 *
˘x
, 
söt64_t
 *
¥es
, 
JSVÆueC⁄°
 
vÆ
,

10412 
söt64_t
 
mö
, söt64_à
max
, 
öt64_t
 
√g_off£t
)

10414 
ªs
 = 
	`JS_ToI¡64S©Fªe
(
˘x
, 
¥es
, 
	`JS_DupVÆue
(˘x, 
vÆ
));

10415 i‡(
ªs
 == 0) {

10416 i‡(*
¥es
 < 0)

10417 *
¥es
 +
√g_off£t
;

10418 i‡(*
¥es
 < 
mö
)

10419 *
¥es
 = 
mö
;

10420 i‡(*
¥es
 > 
max
)

10421 *
¥es
 = 
max
;

10423  
ªs
;

10424 
	}
}

10428 
	$JS_ToI¡64Fªe
(
JSC⁄ãxt
 *
˘x
, 
söt64_t
 *
¥es
, 
JSVÆue
 
vÆ
)

10430 
uöt32_t
 
èg
;

10431 
söt64_t
 
ªt
;

10433 
ªdo
:

10434 
èg
 = 
	`JS_VALUE_GET_NORM_TAG
(
vÆ
);

10435 
èg
) {

10436 
JS_TAG_INT
:

10437 
JS_TAG_BOOL
:

10438 
JS_TAG_NULL
:

10439 
JS_TAG_UNDEFINED
:

10440 
ªt
 = 
	`JS_VALUE_GET_INT
(
vÆ
);

10442 
JS_TAG_FLOAT64
:

10444 
JSFlﬂt64Uni⁄
 
u
;

10445 
d
;

10446 
e
;

10447 
d
 = 
	`JS_VALUE_GET_FLOAT64
(
vÆ
);

10448 
u
.
d
 = d;

10450 
e
 = (
u
.
u64
 >> 52) & 0x7ff;

10451 i‡(
	`likñy
(
e
 <= (1023 + 62))) {

10453 
ªt
 = (
söt64_t
)
d
;

10454 } i‡(
e
 <= (1023 + 62 + 53)) {

10455 
uöt64_t
 
v
;

10457 
v
 = (
u
.
u64
 & (((
uöt64_t
)1 << 52) - 1)) | ((uint64_t)1 << 52);

10458 
ªt
 = 
v
 << ((
e
 - 1023) - 52);

10460 i‡(
u
.
u64
 >> 63)

10461 
ªt
 = -ret;

10463 
ªt
 = 0;

10467 #ifde‡
CONFIG_BIGNUM


10468 
JS_TAG_BIG_FLOAT
:

10470 
JSBigFlﬂt
 *
p
 = 
	`JS_VALUE_GET_PTR
(
vÆ
);

10471 
	`bf_gë_öt64
(&
ªt
, &
p
->
num
, 
BF_GET_INT_MOD
);

10472 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

10477 
vÆ
 = 
	`JS_ToNumbîFªe
(
˘x
, val);

10478 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
)) {

10479 *
¥es
 = 0;

10482 
ªdo
;

10484 *
¥es
 = 
ªt
;

10486 
	}
}

10488 
	$JS_ToI¡64
(
JSC⁄ãxt
 *
˘x
, 
söt64_t
 *
¥es
, 
JSVÆueC⁄°
 
vÆ
)

10490  
	`JS_ToI¡64Fªe
(
˘x
, 
¥es
, 
	`JS_DupVÆue
(˘x, 
vÆ
));

10491 
	}
}

10493 
	$JS_ToI¡64Ext
(
JSC⁄ãxt
 *
˘x
, 
söt64_t
 *
¥es
, 
JSVÆueC⁄°
 
vÆ
)

10495 i‡(
	`JS_IsBigI¡
(
˘x
, 
vÆ
))

10496  
	`JS_ToBigI¡64
(
˘x
, 
¥es
, 
vÆ
);

10498  
	`JS_ToI¡64
(
˘x
, 
¥es
, 
vÆ
);

10499 
	}
}

10502 
	$JS_ToI¡32Fªe
(
JSC⁄ãxt
 *
˘x
, 
öt32_t
 *
¥es
, 
JSVÆue
 
vÆ
)

10504 
uöt32_t
 
èg
;

10505 
öt32_t
 
ªt
;

10507 
ªdo
:

10508 
èg
 = 
	`JS_VALUE_GET_NORM_TAG
(
vÆ
);

10509 
èg
) {

10510 
JS_TAG_INT
:

10511 
JS_TAG_BOOL
:

10512 
JS_TAG_NULL
:

10513 
JS_TAG_UNDEFINED
:

10514 
ªt
 = 
	`JS_VALUE_GET_INT
(
vÆ
);

10516 
JS_TAG_FLOAT64
:

10518 
JSFlﬂt64Uni⁄
 
u
;

10519 
d
;

10520 
e
;

10521 
d
 = 
	`JS_VALUE_GET_FLOAT64
(
vÆ
);

10522 
u
.
d
 = d;

10524 
e
 = (
u
.
u64
 >> 52) & 0x7ff;

10525 i‡(
	`likñy
(
e
 <= (1023 + 30))) {

10527 
ªt
 = (
öt32_t
)
d
;

10528 } i‡(
e
 <= (1023 + 30 + 53)) {

10529 
uöt64_t
 
v
;

10531 
v
 = (
u
.
u64
 & (((
uöt64_t
)1 << 52) - 1)) | ((uint64_t)1 << 52);

10532 
v
 = v << ((
e
 - 1023) - 52 + 32);

10533 
ªt
 = 
v
 >> 32;

10535 i‡(
u
.
u64
 >> 63)

10536 
ªt
 = -ret;

10538 
ªt
 = 0;

10542 #ifde‡
CONFIG_BIGNUM


10543 
JS_TAG_BIG_FLOAT
:

10545 
JSBigFlﬂt
 *
p
 = 
	`JS_VALUE_GET_PTR
(
vÆ
);

10546 
	`bf_gë_öt32
(&
ªt
, &
p
->
num
, 
BF_GET_INT_MOD
);

10547 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

10552 
vÆ
 = 
	`JS_ToNumbîFªe
(
˘x
, val);

10553 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
)) {

10554 *
¥es
 = 0;

10557 
ªdo
;

10559 *
¥es
 = 
ªt
;

10561 
	}
}

10563 
	$JS_ToI¡32
(
JSC⁄ãxt
 *
˘x
, 
öt32_t
 *
¥es
, 
JSVÆueC⁄°
 
vÆ
)

10565  
	`JS_ToI¡32Fªe
(
˘x
, 
¥es
, 
	`JS_DupVÆue
(˘x, 
vÆ
));

10566 
	}
}

10568 
ölöe
 
	$JS_ToUöt32Fªe
(
JSC⁄ãxt
 *
˘x
, 
uöt32_t
 *
¥es
, 
JSVÆue
 
vÆ
)

10570  
	`JS_ToI¡32Fªe
(
˘x
, (
öt32_t
 *)
¥es
, 
vÆ
);

10571 
	}
}

10573 
	$JS_ToUöt8CœmpFªe
(
JSC⁄ãxt
 *
˘x
, 
öt32_t
 *
¥es
, 
JSVÆue
 
vÆ
)

10575 
uöt32_t
 
èg
;

10576 
ªs
;

10578 
ªdo
:

10579 
èg
 = 
	`JS_VALUE_GET_NORM_TAG
(
vÆ
);

10580 
èg
) {

10581 
JS_TAG_INT
:

10582 
JS_TAG_BOOL
:

10583 
JS_TAG_NULL
:

10584 
JS_TAG_UNDEFINED
:

10585 
ªs
 = 
	`JS_VALUE_GET_INT
(
vÆ
);

10586 #ifde‡
CONFIG_BIGNUM


10587 
öt_˛amp
:

10589 
ªs
 = 
	`max_öt
(0, 
	`mö_öt
(255,Ñes));

10591 
JS_TAG_FLOAT64
:

10593 
d
 = 
	`JS_VALUE_GET_FLOAT64
(
vÆ
);

10594 i‡(
	`i¢™
(
d
)) {

10595 
ªs
 = 0;

10597 i‡(
d
 < 0)

10598 
ªs
 = 0;

10599 i‡(
d
 > 255)

10600 
ªs
 = 255;

10602 
ªs
 = 
	`Ãöt
(
d
);

10606 #ifde‡
CONFIG_BIGNUM


10607 
JS_TAG_BIG_FLOAT
:

10609 
JSBigFlﬂt
 *
p
 = 
	`JS_VALUE_GET_PTR
(
vÆ
);

10610 
bf_t
 
r_s
, *
r
 = &r_s;

10611 
	`bf_öô
(
˘x
->
bf_˘x
, 
r
);

10612 
	`bf_£t
(
r
, &
p
->
num
);

10613 
	`bf_röt
(
r
, 
BF_RNDN
);

10614 
	`bf_gë_öt32
(&
ªs
, 
r
, 0);

10615 
	`bf_dñëe
(
r
);

10616 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

10618 
öt_˛amp
;

10621 
vÆ
 = 
	`JS_ToNumbîFªe
(
˘x
, val);

10622 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
)) {

10623 *
¥es
 = 0;

10626 
ªdo
;

10628 *
¥es
 = 
ªs
;

10630 
	}
}

10632 
__ex˚±i⁄
 
	$JS_ToAºayLígthFªe
(
JSC⁄ãxt
 *
˘x
, 
uöt32_t
 *
∂í
,

10633 
JSVÆue
 
vÆ
)

10635 
uöt32_t
 
èg
, 
Àn
;

10637 
ªdo
:

10638 
èg
 = 
	`JS_VALUE_GET_TAG
(
vÆ
);

10639 
èg
) {

10640 
JS_TAG_INT
:

10641 
JS_TAG_BOOL
:

10642 
JS_TAG_NULL
:

10644 
v
;

10645 
v
 = 
	`JS_VALUE_GET_INT
(
vÆ
);

10646 i‡(
v
 < 0)

10647 
Áû
;

10648 
Àn
 = 
v
;

10651 #ifde‡
CONFIG_BIGNUM


10652 
JS_TAG_BIG_INT
:

10653 
JS_TAG_BIG_FLOAT
:

10655 
JSBigFlﬂt
 *
p
 = 
	`JS_VALUE_GET_PTR
(
vÆ
);

10656 
bf_t
 
a
;

10657 
BOOL
 
ªs
;

10658 
	`bf_gë_öt32
((
öt32_t
 *)&
Àn
, &
p
->
num
, 
BF_GET_INT_MOD
);

10659 
	`bf_öô
(
˘x
->
bf_˘x
, &
a
);

10660 
	`bf_£t_ui
(&
a
, 
Àn
);

10661 
ªs
 = 
	`bf_cmp_eq
(&
a
, &
p
->
num
);

10662 
	`bf_dñëe
(&
a
);

10663 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

10664 i‡(!
ªs
)

10665 
Áû
;

10670 i‡(
	`JS_TAG_IS_FLOAT64
(
èg
)) {

10671 
d
;

10672 
d
 = 
	`JS_VALUE_GET_FLOAT64
(
vÆ
);

10673 
Àn
 = (
uöt32_t
)
d
;

10674 i‡(
Àn
 !
d
) {

10675 
Áû
:

10676 
	`JS_ThrowR™geEº‹
(
˘x
, "invalidárrayÜength");

10680 
vÆ
 = 
	`JS_ToNumbîFªe
(
˘x
, val);

10681 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

10683 
ªdo
;

10687 *
∂í
 = 
Àn
;

10689 
	}
}

10691 
	#MAX_SAFE_INTEGER
 (((
öt64_t
)1 << 53Ë- 1)

	)

10693 
BOOL
 
	$is_ß„_öãgî
(
d
)

10695  
	`isföôe
(
d
Ë&& 
	`Êo‹
(d) == d &&

10696 
	`Ábs
(
d
Ë<()
MAX_SAFE_INTEGER
;

10697 
	}
}

10699 
	$JS_ToIndex
(
JSC⁄ãxt
 *
˘x
, 
uöt64_t
 *
∂í
, 
JSVÆueC⁄°
 
vÆ
)

10701 
söt64_t
 
v
;

10702 i‡(
	`JS_ToI¡64S©
(
˘x
, &
v
, 
vÆ
))

10704 i‡(
v
 < 0 || v > 
MAX_SAFE_INTEGER
) {

10705 
	`JS_ThrowR™geEº‹
(
˘x
, "invalidárray index");

10706 *
∂í
 = 0;

10709 *
∂í
 = 
v
;

10711 
	}
}

10715 
__ex˚±i⁄
 
	$JS_ToLígthFªe
(
JSC⁄ãxt
 *
˘x
, 
söt64_t
 *
∂í
,

10716 
JSVÆue
 
vÆ
)

10718 
ªs
 = 
	`JS_ToI¡64Cœmp
(
˘x
, 
∂í
, 
vÆ
, 0, 
MAX_SAFE_INTEGER
, 0);

10719 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

10720  
ªs
;

10721 
	}
}

10724 
	$JS_NumbîIsI¡egî
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
vÆ
)

10726 
d
;

10727 i‡(!
	`JS_IsNumbî
(
vÆ
))

10728  
FALSE
;

10729 i‡(
	`u∆ikñy
(
	`JS_ToFlﬂt64
(
˘x
, &
d
, 
vÆ
)))

10731  
	`isföôe
(
d
Ë&& 
	`Êo‹
(d) == d;

10732 
	}
}

10734 
BOOL
 
	$JS_NumbîIsNeg©iveOrMöusZîo
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
vÆ
)

10736 
uöt32_t
 
èg
;

10738 
èg
 = 
	`JS_VALUE_GET_NORM_TAG
(
vÆ
);

10739 
èg
) {

10740 
JS_TAG_INT
:

10742 
v
;

10743 
v
 = 
	`JS_VALUE_GET_INT
(
vÆ
);

10744  (
v
 < 0);

10746 
JS_TAG_FLOAT64
:

10748 
JSFlﬂt64Uni⁄
 
u
;

10749 
u
.
d
 = 
	`JS_VALUE_GET_FLOAT64
(
vÆ
);

10750  (
u
.
u64
 >> 63);

10752 #ifde‡
CONFIG_BIGNUM


10753 
JS_TAG_BIG_INT
:

10755 
JSBigFlﬂt
 *
p
 = 
	`JS_VALUE_GET_PTR
(
vÆ
);

10757  
p
->
num
.
sign
 && !
	`bf_is_zîo
(&p->num);

10759 
JS_TAG_BIG_FLOAT
:

10761 
JSBigFlﬂt
 *
p
 = 
	`JS_VALUE_GET_PTR
(
vÆ
);

10762  
p
->
num
.
sign
;

10765 
JS_TAG_BIG_DECIMAL
:

10767 
JSBigDecimÆ
 *
p
 = 
	`JS_VALUE_GET_PTR
(
vÆ
);

10768  
p
->
num
.
sign
;

10773  
FALSE
;

10775 
	}
}

10777 #ifde‡
CONFIG_BIGNUM


10779 
JSVÆue
 
	$js_bigöt_to_°rög1
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
vÆ
, 
ødix
)

10781 
JSVÆue
 
ªt
;

10782 
bf_t
 
a_s
, *
a
;

10783 *
°r
;

10784 
ßved_sign
;

10786 
a
 = 
	`JS_ToBigI¡
(
˘x
, &
a_s
, 
vÆ
);

10787 i‡(!
a
)

10788  
JS_EXCEPTION
;

10789 
ßved_sign
 = 
a
->
sign
;

10790 i‡(
a
->
ex≤
 =
BF_EXP_ZERO
)

10791 
a
->
sign
 = 0;

10792 
°r
 = 
	`bf_·ﬂ
(
NULL
, 
a
, 
ødix
, 0, 
BF_RNDZ
 | 
BF_FTOA_FORMAT_FRAC
 |

10793 
BF_FTOA_JS_QUIRKS
);

10794 
a
->
sign
 = 
ßved_sign
;

10795 
	`JS_FªeBigI¡
(
˘x
, 
a
, &
a_s
);

10796 i‡(!
°r
)

10797  
	`JS_ThrowOutOfMem‹y
(
˘x
);

10798 
ªt
 = 
	`JS_NewSåög
(
˘x
, 
°r
);

10799 
	`bf_‰ì
(
˘x
->
bf_˘x
, 
°r
);

10800  
ªt
;

10801 
	}
}

10803 
JSVÆue
 
	$js_bigöt_to_°rög
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
vÆ
)

10805  
	`js_bigöt_to_°rög1
(
˘x
, 
vÆ
, 10);

10806 
	}
}

10808 
JSVÆue
 
	$js_·ﬂ
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
vÆ1
, 
ødix
,

10809 
limb_t
 
¥ec
, 
bf_Êags_t
 
Êags
)

10811 
JSVÆue
 
vÆ
, 
ªt
;

10812 
bf_t
 
a_s
, *
a
;

10813 *
°r
;

10814 
ßved_sign
;

10816 
vÆ
 = 
	`JS_ToNumîic
(
˘x
, 
vÆ1
);

10817 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

10818  
vÆ
;

10819 
a
 = 
	`JS_ToBigFlﬂt
(
˘x
, &
a_s
, 
vÆ
);

10820 
ßved_sign
 = 
a
->
sign
;

10821 i‡(
a
->
ex≤
 =
BF_EXP_ZERO
)

10822 
a
->
sign
 = 0;

10823 
Êags
 |
BF_FTOA_JS_QUIRKS
;

10824 i‡((
Êags
 & 
BF_FTOA_FORMAT_MASK
Ë=
BF_FTOA_FORMAT_FREE_MIN
) {

10828 i‡((
ødix
 & (radix - 1)) != 0) {

10829 
bf_t
 
r_s
, *
r
 = &r_s;

10830 
¥ec
, 
Êags1
;

10832 i‡(
	`JS_VALUE_GET_TAG
(
vÆ
Ë=
JS_TAG_BIG_FLOAT
) {

10833 
¥ec
 = 
˘x
->
Â_ív
.prec;

10834 
Êags1
 = 
˘x
->
Â_ív
.
Êags
 &

10835 (
BF_FLAG_SUBNORMAL
 | (
BF_EXP_BITS_MASK
 << 
BF_EXP_BITS_SHIFT
));

10837 
¥ec
 = 53;

10838 
Êags1
 = 
	`bf_£t_exp_bôs
(11Ë| 
BF_FLAG_SUBNORMAL
;

10840 
	`bf_öô
(
˘x
->
bf_˘x
, 
r
);

10841 
	`bf_£t
(
r
, 
a
);

10842 
	`bf_round
(
r
, 
¥ec
, 
Êags1
 | 
BF_RNDN
);

10843 
°r
 = 
	`bf_·ﬂ
(
NULL
, 
r
, 
ødix
, 
¥ec
, 
Êags1
 | 
Êags
);

10844 
	`bf_dñëe
(
r
);

10846 
°r
 = 
	`bf_·ﬂ
(
NULL
, 
a
, 
ødix
, 
BF_PREC_INF
, 
Êags
);

10849 
°r
 = 
	`bf_·ﬂ
(
NULL
, 
a
, 
ødix
, 
¥ec
, 
Êags
);

10851 
a
->
sign
 = 
ßved_sign
;

10852 i‡(
a
 =&
a_s
)

10853 
	`bf_dñëe
(
a
);

10854 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

10855 i‡(!
°r
)

10856  
	`JS_ThrowOutOfMem‹y
(
˘x
);

10857 
ªt
 = 
	`JS_NewSåög
(
˘x
, 
°r
);

10858 
	`bf_‰ì
(
˘x
->
bf_˘x
, 
°r
);

10859  
ªt
;

10860 
	}
}

10862 
JSVÆue
 
	$js_bigÊﬂt_to_°rög
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
vÆ
)

10864  
	`js_·ﬂ
(
˘x
, 
vÆ
, 10, 0, 
BF_RNDN
 | 
BF_FTOA_FORMAT_FREE_MIN
);

10865 
	}
}

10867 
JSVÆue
 
	$js_bigdecimÆ_to_°rög1
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
vÆ
,

10868 
limb_t
 
¥ec
, 
Êags
)

10870 
JSVÆue
 
ªt
;

10871 
bfdec_t
 *
a
;

10872 *
°r
;

10873 
ßved_sign
;

10875 
a
 = 
	`JS_ToBigDecimÆ
(
˘x
, 
vÆ
);

10876 
ßved_sign
 = 
a
->
sign
;

10877 i‡(
a
->
ex≤
 =
BF_EXP_ZERO
)

10878 
a
->
sign
 = 0;

10879 
°r
 = 
	`bfdec_·ﬂ
(
NULL
, 
a
, 
¥ec
, 
Êags
 | 
BF_FTOA_JS_QUIRKS
);

10880 
a
->
sign
 = 
ßved_sign
;

10881 i‡(!
°r
)

10882  
	`JS_ThrowOutOfMem‹y
(
˘x
);

10883 
ªt
 = 
	`JS_NewSåög
(
˘x
, 
°r
);

10884 
	`bf_‰ì
(
˘x
->
bf_˘x
, 
°r
);

10885  
ªt
;

10886 
	}
}

10888 
JSVÆue
 
	$js_bigdecimÆ_to_°rög
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
vÆ
)

10890  
	`js_bigdecimÆ_to_°rög1
(
˘x
, 
vÆ
, 0,

10891 
BF_RNDZ
 | 
BF_FTOA_FORMAT_FREE
);

10892 
	}
}

10897 *
	$i64tﬂ
(*
buf_íd
, 
söt64_t
 
n
, 
ba£
)

10899 *
q
 = 
buf_íd
;

10900 
digô
, 
is_√g
;

10902 
is_√g
 = 0;

10903 i‡(
n
 < 0) {

10904 
is_√g
 = 1;

10905 
n
 = -n;

10907 *--
q
 = '\0';

10909 
digô
 = (
uöt64_t
)
n
 % 
ba£
;

10910 
n
 = (
uöt64_t
Í / 
ba£
;

10911 i‡(
digô
 < 10)

10912 
digô
 += '0';

10914 
digô
 += 'a' - 10;

10915 *--
q
 = 
digô
;

10916 } 
n
 != 0);

10917 i‡(
is_√g
)

10918 *--
q
 = '-';

10919  
q
;

10920 
	}
}

10923 
	$js_ecvt1
(
d
, 
n_digôs
, *
de˝t
, *
sign
, *
buf
,

10924 
roundög_mode
, *
buf1
, 
buf1_size
)

10926 i‡(
roundög_mode
 !
FE_TONEAREST
)

10927 
	`„£åound
(
roundög_mode
);

10928 
	`¢¥ötf
(
buf1
, 
buf1_size
, "%+.*e", 
n_digôs
 - 1, 
d
);

10929 i‡(
roundög_mode
 !
FE_TONEAREST
)

10930 
	`„£åound
(
FE_TONEAREST
);

10931 *
sign
 = (
buf1
[0] == '-');

10933 
buf
[0] = 
buf1
[1];

10934 i‡(
n_digôs
 > 1)

10935 
	`mem˝y
(
buf
 + 1, 
buf1
 + 3, 
n_digôs
 - 1);

10936 
buf
[
n_digôs
] = '\0';

10938 *
de˝t
 = 
	`©oi
(
buf1
 + 
n_digôs
 + 2 + (n_digits > 1)) + 1;

10939 
	}
}

10942 
	#JS_DTOA_BUF_SIZE
 128

	)

10946 
	$js_ecvt
(
d
, 
n_digôs
, *
de˝t
, *
sign
, *
buf
,

10947 
BOOL
 
is_fixed
)

10949 
roundög_mode
;

10950 
buf_tmp
[
JS_DTOA_BUF_SIZE
];

10952 i‡(!
is_fixed
) {

10953 
n_digôs_mö
, 
n_digôs_max
;

10955 
n_digôs_mö
 = 1;

10956 
n_digôs_max
 = 17;

10957 
n_digôs_mö
 < 
n_digôs_max
) {

10958 
n_digôs
 = (
n_digôs_mö
 + 
n_digôs_max
) / 2;

10959 
	`js_ecvt1
(
d
, 
n_digôs
, 
de˝t
, 
sign
, 
buf
, 
FE_TONEAREST
,

10960 
buf_tmp
, (buf_tmp));

10961 i‡(
	`°πod
(
buf_tmp
, 
NULL
Ë=
d
) {

10963 
n_digôs
 >2 && 
buf
[n_digits - 1] == '0')

10964 
n_digôs
--;

10965 
n_digôs_max
 = 
n_digôs
;

10967 
n_digôs_mö
 = 
n_digôs
 + 1;

10970 
n_digôs
 = 
n_digôs_max
;

10971 
roundög_mode
 = 
FE_TONEAREST
;

10973 
roundög_mode
 = 
FE_TONEAREST
;

10974 #ifde‡
CONFIG_PRINTF_RNDN


10976 
buf1
[
JS_DTOA_BUF_SIZE
], 
buf2
[JS_DTOA_BUF_SIZE];

10977 
de˝t1
, 
sign1
, 
de˝t2
, 
sign2
;

10982 
	`js_ecvt1
(
d
, 
n_digôs
 + 1, &
de˝t1
, &
sign1
, 
buf1
, 
FE_TONEAREST
,

10983 
buf_tmp
, (buf_tmp));

10985 i‡(
buf1
[
n_digôs
] == '5') {

10986 
	`js_ecvt1
(
d
, 
n_digôs
 + 1, &
de˝t1
, &
sign1
, 
buf1
, 
FE_DOWNWARD
,

10987 
buf_tmp
, (buf_tmp));

10988 
	`js_ecvt1
(
d
, 
n_digôs
 + 1, &
de˝t2
, &
sign2
, 
buf2
, 
FE_UPWARD
,

10989 
buf_tmp
, (buf_tmp));

10990 i‡(
	`memcmp
(
buf1
, 
buf2
, 
n_digôs
 + 1Ë=0 && 
de˝t1
 =
de˝t2
) {

10992 i‡(
sign1
)

10993 
roundög_mode
 = 
FE_DOWNWARD
;

10995 
roundög_mode
 = 
FE_UPWARD
;

11001 
	`js_ecvt1
(
d
, 
n_digôs
, 
de˝t
, 
sign
, 
buf
, 
roundög_mode
,

11002 
buf_tmp
, (buf_tmp));

11003  
n_digôs
;

11004 
	}
}

11006 
	$js_fcvt1
(*
buf
, 
buf_size
, 
d
, 
n_digôs
,

11007 
roundög_mode
)

11009 
n
;

11010 i‡(
roundög_mode
 !
FE_TONEAREST
)

11011 
	`„£åound
(
roundög_mode
);

11012 
n
 = 
	`¢¥ötf
(
buf
, 
buf_size
, "%.*f", 
n_digôs
, 
d
);

11013 i‡(
roundög_mode
 !
FE_TONEAREST
)

11014 
	`„£åound
(
FE_TONEAREST
);

11015 
	`as£π
(
n
 < 
buf_size
);

11016  
n
;

11017 
	}
}

11019 
	$js_fcvt
(*
buf
, 
buf_size
, 
d
, 
n_digôs
)

11021 
roundög_mode
;

11022 
roundög_mode
 = 
FE_TONEAREST
;

11023 #ifde‡
CONFIG_PRINTF_RNDN


11025 
n1
, 
n2
;

11026 
buf1
[
JS_DTOA_BUF_SIZE
];

11027 
buf2
[
JS_DTOA_BUF_SIZE
];

11033 
n1
 = 
	`js_fcvt1
(
buf1
, (buf1), 
d
, 
n_digôs
 + 1, 
FE_TONEAREST
);

11034 
roundög_mode
 = 
FE_TONEAREST
;

11036 i‡(
buf1
[
n1
 - 1] == '5') {

11037 
n1
 = 
	`js_fcvt1
(
buf1
, (buf1), 
d
, 
n_digôs
 + 1, 
FE_DOWNWARD
);

11038 
n2
 = 
	`js_fcvt1
(
buf2
, (buf2), 
d
, 
n_digôs
 + 1, 
FE_UPWARD
);

11039 i‡(
n1
 =
n2
 && 
	`memcmp
(
buf1
, 
buf2
,Ç1) == 0) {

11041 i‡(
buf1
[0] == '-')

11042 
roundög_mode
 = 
FE_DOWNWARD
;

11044 
roundög_mode
 = 
FE_UPWARD
;

11049 
	`js_fcvt1
(
buf
, 
buf_size
, 
d
, 
n_digôs
, 
roundög_mode
);

11050 
	}
}

11054 
	#JS_DTOA_VAR_FORMAT
 (0 << 0)

	)

11056 
	#JS_DTOA_FIXED_FORMAT
 (1 << 0)

	)

11058 
	#JS_DTOA_FRAC_FORMAT
 (2 << 0)

	)

11060 
	#JS_DTOA_FORCE_EXP
 (1 << 2)

	)

11065 
	$js_dtﬂ1
(*
buf
, 
d
, 
ødix
, 
n_digôs
, 
Êags
)

11067 *
q
;

11069 i‡(!
	`isföôe
(
d
)) {

11070 i‡(
	`i¢™
(
d
)) {

11071 
	`°r˝y
(
buf
, "NaN");

11073 
q
 = 
buf
;

11074 i‡(
d
 < 0)

11075 *
q
++ = '-';

11076 
	`°r˝y
(
q
, "Infinity");

11078 } i‡(
Êags
 =
JS_DTOA_VAR_FORMAT
) {

11079 
söt64_t
 
i64
;

11080 
buf1
[70], *
±r
;

11081 
i64
 = (
söt64_t
)
d
;

11082 i‡(
d
 !
i64
 || i64 > 
MAX_SAFE_INTEGER
 || i64 < -MAX_SAFE_INTEGER)

11083 
gíîic_c⁄v
;

11085 
±r
 = 
	`i64tﬂ
(
buf1
 + (buf1), 
i64
, 
ødix
);

11086 
	`°r˝y
(
buf
, 
±r
);

11088 i‡(
d
 == 0.0)

11089 
d
 = 0.0;

11090 i‡(
Êags
 =
JS_DTOA_FRAC_FORMAT
) {

11091 
	`js_fcvt
(
buf
, 
JS_DTOA_BUF_SIZE
, 
d
, 
n_digôs
);

11093 
buf1
[
JS_DTOA_BUF_SIZE
];

11094 
sign
, 
de˝t
, 
k
, 
n
, 
i
, 
p
, 
n_max
;

11095 
BOOL
 
is_fixed
;

11096 
gíîic_c⁄v
:

11097 
is_fixed
 = ((
Êags
 & 3Ë=
JS_DTOA_FIXED_FORMAT
);

11098 i‡(
is_fixed
) {

11099 
n_max
 = 
n_digôs
;

11101 
n_max
 = 21;

11104 
k
 = 
	`js_ecvt
(
d
, 
n_digôs
, &
de˝t
, &
sign
, 
buf1
, 
is_fixed
);

11105 
n
 = 
de˝t
;

11106 
q
 = 
buf
;

11107 i‡(
sign
)

11108 *
q
++ = '-';

11109 i‡(
Êags
 & 
JS_DTOA_FORCE_EXP
)

11110 
f‹˚_exp
;

11111 i‡(
n
 >1 &&Ç <
n_max
) {

11112 i‡(
k
 <
n
) {

11113 
	`mem˝y
(
q
, 
buf1
, 
k
);

11114 
q
 +
k
;

11115 
i
 = 0; i < (
n
 - 
k
); i++)

11116 *
q
++ = '0';

11117 *
q
 = '\0';

11120 
	`mem˝y
(
q
, 
buf1
, 
n
);

11121 
q
 +
n
;

11122 *
q
++ = '.';

11123 
i
 = 0; i < (
k
 - 
n
); i++)

11124 *
q
++ = 
buf1
[
n
 + 
i
];

11125 *
q
 = '\0';

11127 } i‡(
n
 >= -5 &&Ç <= 0) {

11128 *
q
++ = '0';

11129 *
q
++ = '.';

11130 
i
 = 0; i < -
n
; i++)

11131 *
q
++ = '0';

11132 
	`mem˝y
(
q
, 
buf1
, 
k
);

11133 
q
 +
k
;

11134 *
q
 = '\0';

11136 
f‹˚_exp
:

11138 *
q
++ = 
buf1
[0];

11139 i‡(
k
 > 1) {

11140 *
q
++ = '.';

11141 
i
 = 1; i < 
k
; i++)

11142 *
q
++ = 
buf1
[
i
];

11144 *
q
++ = 'e';

11145 
p
 = 
n
 - 1;

11146 i‡(
p
 >= 0)

11147 *
q
++ = '+';

11148 
	`•rötf
(
q
, "%d", 
p
);

11152 
	}
}

11154 
JSVÆue
 
	$js_dtﬂ
(
JSC⁄ãxt
 *
˘x
,

11155 
d
, 
ødix
, 
n_digôs
, 
Êags
)

11157 
buf
[
JS_DTOA_BUF_SIZE
];

11158 
	`js_dtﬂ1
(
buf
, 
d
, 
ødix
, 
n_digôs
, 
Êags
);

11159  
	`JS_NewSåög
(
˘x
, 
buf
);

11160 
	}
}

11162 
JSVÆue
 
	$JS_ToSåögI¡î«l
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
vÆ
, 
BOOL
 
is_ToPr›îtyKey
)

11164 
uöt32_t
 
èg
;

11165 c⁄° *
°r
;

11166 
buf
[32];

11168 
èg
 = 
	`JS_VALUE_GET_NORM_TAG
(
vÆ
);

11169 
èg
) {

11170 
JS_TAG_STRING
:

11171  
	`JS_DupVÆue
(
˘x
, 
vÆ
);

11172 
JS_TAG_INT
:

11173 
	`¢¥ötf
(
buf
, (buf), "%d", 
	`JS_VALUE_GET_INT
(
vÆ
));

11174 
°r
 = 
buf
;

11175 
√w_°rög
;

11176 
JS_TAG_BOOL
:

11177  
	`JS_AtomToSåög
(
˘x
, 
	`JS_VALUE_GET_BOOL
(
vÆ
) ?

11178 
JS_ATOM_åue
 : 
JS_ATOM_Ál£
);

11179 
JS_TAG_NULL
:

11180  
	`JS_AtomToSåög
(
˘x
, 
JS_ATOM_nuŒ
);

11181 
JS_TAG_UNDEFINED
:

11182  
	`JS_AtomToSåög
(
˘x
, 
JS_ATOM_undeföed
);

11183 
JS_TAG_EXCEPTION
:

11184  
JS_EXCEPTION
;

11185 
JS_TAG_OBJECT
:

11187 
JSVÆue
 
vÆ1
, 
ªt
;

11188 
vÆ1
 = 
	`JS_ToPrimôive
(
˘x
, 
vÆ
, 
HINT_STRING
);

11189 i‡(
	`JS_IsEx˚±i⁄
(
vÆ1
))

11190  
vÆ1
;

11191 
ªt
 = 
	`JS_ToSåögI¡î«l
(
˘x
, 
vÆ1
, 
is_ToPr›îtyKey
);

11192 
	`JS_FªeVÆue
(
˘x
, 
vÆ1
);

11193  
ªt
;

11196 
JS_TAG_FUNCTION_BYTECODE
:

11197 
°r
 = "[function bytecode]";

11198 
√w_°rög
;

11199 
JS_TAG_SYMBOL
:

11200 i‡(
is_ToPr›îtyKey
) {

11201  
	`JS_DupVÆue
(
˘x
, 
vÆ
);

11203  
	`JS_ThrowTy≥Eº‹
(
˘x
, "cannot convert symbolÅo string");

11205 
JS_TAG_FLOAT64
:

11206  
	`js_dtﬂ
(
˘x
, 
	`JS_VALUE_GET_FLOAT64
(
vÆ
), 10, 0,

11207 
JS_DTOA_VAR_FORMAT
);

11208 #ifde‡
CONFIG_BIGNUM


11209 
JS_TAG_BIG_INT
:

11210  
˘x
->
π
->
bigöt_›s
.
	`to_°rög
(˘x, 
vÆ
);

11211 
JS_TAG_BIG_FLOAT
:

11212  
˘x
->
π
->
bigÊﬂt_›s
.
	`to_°rög
(˘x, 
vÆ
);

11213 
JS_TAG_BIG_DECIMAL
:

11214  
˘x
->
π
->
bigdecimÆ_›s
.
	`to_°rög
(˘x, 
vÆ
);

11217 
°r
 = "[unsupportedÅype]";

11218 
√w_°rög
:

11219  
	`JS_NewSåög
(
˘x
, 
°r
);

11221 
	}
}

11223 
JSVÆue
 
	$JS_ToSåög
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
vÆ
)

11225  
	`JS_ToSåögI¡î«l
(
˘x
, 
vÆ
, 
FALSE
);

11226 
	}
}

11228 
JSVÆue
 
	$JS_ToSåögFªe
(
JSC⁄ãxt
 *
˘x
, 
JSVÆue
 
vÆ
)

11230 
JSVÆue
 
ªt
;

11231 
ªt
 = 
	`JS_ToSåög
(
˘x
, 
vÆ
);

11232 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

11233  
ªt
;

11234 
	}
}

11236 
JSVÆue
 
	$JS_ToLoˇÀSåögFªe
(
JSC⁄ãxt
 *
˘x
, 
JSVÆue
 
vÆ
)

11238 i‡(
	`JS_IsUndeföed
(
vÆ
Ë|| 
	`JS_IsNuŒ
(val))

11239  
	`JS_ToSåögFªe
(
˘x
, 
vÆ
);

11240  
	`JS_InvokeFªe
(
˘x
, 
vÆ
, 
JS_ATOM_toLoˇÀSåög
, 0, 
NULL
);

11241 
	}
}

11243 
JSVÆue
 
	$JS_ToPr›îtyKey
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
vÆ
)

11245  
	`JS_ToSåögI¡î«l
(
˘x
, 
vÆ
, 
TRUE
);

11246 
	}
}

11248 
JSVÆue
 
	$JS_ToSåögCheckObje˘
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
vÆ
)

11250 
uöt32_t
 
èg
 = 
	`JS_VALUE_GET_TAG
(
vÆ
);

11251 i‡(
èg
 =
JS_TAG_NULL
 ||Åag =
JS_TAG_UNDEFINED
)

11252  
	`JS_ThrowTy≥Eº‹
(
˘x
, "null or undefinedáre forbidden");

11253  
	`JS_ToSåög
(
˘x
, 
vÆ
);

11254 
	}
}

11256 
JSVÆue
 
	$JS_ToQuŸedSåög
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
vÆ1
)

11258 
JSVÆue
 
vÆ
;

11259 
JSSåög
 *
p
;

11260 
i
;

11261 
uöt32_t
 
c
;

11262 
SåögBuf„r
 
b_s
, *
b
 = &b_s;

11263 
buf
[16];

11265 
vÆ
 = 
	`JS_ToSåögCheckObje˘
(
˘x
, 
vÆ1
);

11266 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

11267  
vÆ
;

11268 
p
 = 
	`JS_VALUE_GET_STRING
(
vÆ
);

11270 i‡(
	`°rög_buf„r_öô
(
˘x
, 
b
, 
p
->
Àn
 + 2))

11271 
Áû
;

11273 i‡(
	`°rög_buf„r_putc8
(
b
, '\"'))

11274 
Áû
;

11275 
i
 = 0; i < 
p
->
Àn
; ) {

11276 
c
 = 
	`°rög_gëc
(
p
, &
i
);

11277 
c
) {

11279 
c
 = 't';

11280 
quŸe
;

11282 
c
 = 'r';

11283 
quŸe
;

11285 
c
 = 'n';

11286 
quŸe
;

11288 
c
 = 'b';

11289 
quŸe
;

11291 
c
 = 'f';

11292 
quŸe
;

11295 
quŸe
:

11296 i‡(
	`°rög_buf„r_putc8
(
b
, '\\'))

11297 
Áû
;

11298 i‡(
	`°rög_buf„r_putc8
(
b
, 
c
))

11299 
Áû
;

11302 i‡(
c
 < 32 || (c >= 0xd800 && c < 0xe000)) {

11303 
	`¢¥ötf
(
buf
, (buf), "\\u%04x", 
c
);

11304 i‡(
	`°rög_buf„r_puts8
(
b
, 
buf
))

11305 
Áû
;

11307 i‡(
	`°rög_buf„r_putc
(
b
, 
c
))

11308 
Áû
;

11313 i‡(
	`°rög_buf„r_putc8
(
b
, '\"'))

11314 
Áû
;

11315 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

11316  
	`°rög_buf„r_íd
(
b
);

11317 
Áû
:

11318 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

11319 
	`°rög_buf„r_‰ì
(
b
);

11320  
JS_EXCEPTION
;

11321 
	}
}

11323 
__maybe_unu£d
 
	$JS_DumpObje˘Hódî
(
JSRu¡ime
 *
π
)

11325 
	`¥ötf
("%14s %4s %4s %14s %10s %s\n",

11327 
	}
}

11330 
__maybe_unu£d
 
	$JS_DumpObje˘
(
JSRu¡ime
 *
π
, 
JSObje˘
 *
p
)

11332 
uöt32_t
 
i
;

11333 
©om_buf
[
ATOM_GET_STR_BUF_SIZE
];

11334 
JSSh≠e
 *
sh
;

11335 
JSSh≠ePr›îty
 *
¥s
;

11336 
JSPr›îty
 *
¥
;

11337 
BOOL
 
is_fú°
 = 
TRUE
;

11340 
sh
 = 
p
->
sh≠e
;

11341 
	`¥ötf
("%14p %4d ",

11342 (*)
p
,

11343 
p
->
hódî
.
ªf_cou¡
);

11344 i‡(
sh
) {

11345 
	`¥ötf
("%3d%c %14p ",

11346 
sh
->
hódî
.
ªf_cou¡
,

11347 " *"[
sh
->
is_hashed
],

11348 (*)
sh
->
¥Ÿo
);

11350 
	`¥ötf
("%3s %14s ", "-", "-");

11352 
	`¥ötf
("%10s ",

11353 
	`JS_AtomGëSåRT
(
π
, 
©om_buf
, ◊tom_buf),Ñt->
˛ass_¨øy
[
p
->
˛ass_id
].
˛ass_«me
));

11354 i‡(
p
->
is_exŸic
 &&Ö->
Á°_¨øy
) {

11355 
	`¥ötf
("[ ");

11356 
i
 = 0; i < 
p
->
u
.
¨øy
.
cou¡
; i++) {

11357 i‡(
i
 != 0)

11358 
	`¥ötf
(", ");

11359 
p
->
˛ass_id
) {

11360 
JS_CLASS_ARRAY
:

11361 
JS_CLASS_ARGUMENTS
:

11362 
	`JS_DumpVÆueSh‹t
(
π
, 
p
->
u
.
¨øy
.u.
vÆues
[
i
]);

11364 
JS_CLASS_UINT8C_ARRAY
 ... 
JS_CLASS_FLOAT64_ARRAY
:

11366 
size
 = 1 << 
	`ty≥d_¨øy_size_log2
(
p
->
˛ass_id
);

11367 c⁄° 
uöt8_t
 *
b
 = 
p
->
u
.
¨øy
.u.
uöt8_±r
 + 
i
 * 
size
;

11368 
size
-- > 0)

11369 
	`¥ötf
("%02X", *
b
++);

11374 
	`¥ötf
(" ] ");

11377 i‡(
sh
) {

11378 
	`¥ötf
("{ ");

11379 
i
 = 0, 
¥s
 = 
	`gë_sh≠e_¥›
(
sh
); i < sh->
¥›_cou¡
; i++,Örs++) {

11380 i‡(
¥s
->
©om
 !
JS_ATOM_NULL
) {

11381 
¥
 = &
p
->
¥›
[
i
];

11382 i‡(!
is_fú°
)

11383 
	`¥ötf
(", ");

11384 
	`¥ötf
("%s: ",

11385 
	`JS_AtomGëSåRT
(
π
, 
©om_buf
, ◊tom_buf), 
¥s
->
©om
));

11386 i‡((
¥s
->
Êags
 & 
JS_PROP_TMASK
Ë=
JS_PROP_GETSET
) {

11387 
	`¥ötf
("[gë£à%∞%p]", (*)
¥
->
u
.
gë£t
.
gëãr
,

11388 (*)
¥
->
u
.
gë£t
.
£âî
);

11389 } i‡((
¥s
->
Êags
 & 
JS_PROP_TMASK
Ë=
JS_PROP_VARREF
) {

11390 
	`¥ötf
("[v¨ª‡%p]", (*)
¥
->
u
.
v¨_ªf
);

11391 } i‡((
¥s
->
Êags
 & 
JS_PROP_TMASK
Ë=
JS_PROP_AUTOINIT
) {

11392 
	`¥ötf
("[autoöô %∞%p]", (*)
¥
->
u
.
öô
.u.
ªÆm
,

11393 (*)
¥
->
u
.
öô
.
›aque
);

11395 
	`JS_DumpVÆueSh‹t
(
π
, 
¥
->
u
.
vÆue
);

11397 
is_fú°
 = 
FALSE
;

11400 
	`¥ötf
(" }");

11403 i‡(
	`js_˛ass_has_byãcode
(
p
->
˛ass_id
)) {

11404 
JSFun˘i⁄Byãcode
 *
b
 = 
p
->
u
.
func
.
fun˘i⁄_byãcode
;

11405 
JSV¨Ref
 **
v¨_ªfs
;

11406 i‡(
b
->
˛osuª_v¨_cou¡
) {

11407 
v¨_ªfs
 = 
p
->
u
.
func
.var_refs;

11408 
	`¥ötf
(" Closure:");

11409 
i
 = 0; i < 
b
->
˛osuª_v¨_cou¡
; i++) {

11410 
	`¥ötf
(" ");

11411 
	`JS_DumpVÆueSh‹t
(
π
, 
v¨_ªfs
[
i
]->
vÆue
);

11413 i‡(
p
->
u
.
func
.
home_obje˘
) {

11414 
	`¥ötf
(" HomeObject: ");

11415 
	`JS_DumpVÆueSh‹t
(
π
, 
	`JS_MKPTR
(
JS_TAG_OBJECT
, 
p
->
u
.
func
.
home_obje˘
));

11419 
	`¥ötf
("\n");

11420 
	}
}

11422 
__maybe_unu£d
 
	$JS_DumpGCObje˘
(
JSRu¡ime
 *
π
, 
JSGCObje˘Hódî
 *
p
)

11424 i‡(
p
->
gc_obj_ty≥
 =
JS_GC_OBJ_TYPE_JS_OBJECT
) {

11425 
	`JS_DumpObje˘
(
π
, (
JSObje˘
 *)
p
);

11427 
	`¥ötf
("%14p %4d ",

11428 (*)
p
,

11429 
p
->
ªf_cou¡
);

11430 
p
->
gc_obj_ty≥
) {

11431 
JS_GC_OBJ_TYPE_FUNCTION_BYTECODE
:

11432 
	`¥ötf
("[function bytecode]");

11434 
JS_GC_OBJ_TYPE_SHAPE
:

11435 
	`¥ötf
("[shape]");

11437 
JS_GC_OBJ_TYPE_VAR_REF
:

11438 
	`¥ötf
("[var_ref]");

11440 
JS_GC_OBJ_TYPE_ASYNC_FUNCTION
:

11441 
	`¥ötf
("[async_function]");

11443 
JS_GC_OBJ_TYPE_JS_CONTEXT
:

11444 
	`¥ötf
("[js_context]");

11447 
	`¥ötf
("[unknow¿%d]", 
p
->
gc_obj_ty≥
);

11450 
	`¥ötf
("\n");

11452 
	}
}

11454 
__maybe_unu£d
 
	$JS_DumpVÆueSh‹t
(
JSRu¡ime
 *
π
,

11455 
JSVÆueC⁄°
 
vÆ
)

11457 
uöt32_t
 
èg
 = 
	`JS_VALUE_GET_NORM_TAG
(
vÆ
);

11458 c⁄° *
°r
;

11460 
èg
) {

11461 
JS_TAG_INT
:

11462 
	`¥ötf
("%d", 
	`JS_VALUE_GET_INT
(
vÆ
));

11464 
JS_TAG_BOOL
:

11465 i‡(
	`JS_VALUE_GET_BOOL
(
vÆ
))

11466 
°r
 = "true";

11468 
°r
 = "false";

11469 
¥öt_°r
;

11470 
JS_TAG_NULL
:

11471 
°r
 = "null";

11472 
¥öt_°r
;

11473 
JS_TAG_EXCEPTION
:

11474 
°r
 = "exception";

11475 
¥öt_°r
;

11476 
JS_TAG_UNINITIALIZED
:

11477 
°r
 = "uninitialized";

11478 
¥öt_°r
;

11479 
JS_TAG_UNDEFINED
:

11480 
°r
 = "undefined";

11481 
¥öt_°r
:

11482 
	`¥ötf
("%s", 
°r
);

11484 
JS_TAG_FLOAT64
:

11485 
	`¥ötf
("%.14g", 
	`JS_VALUE_GET_FLOAT64
(
vÆ
));

11487 #ifde‡
CONFIG_BIGNUM


11488 
JS_TAG_BIG_INT
:

11490 
JSBigFlﬂt
 *
p
 = 
	`JS_VALUE_GET_PTR
(
vÆ
);

11491 *
°r
;

11492 
°r
 = 
	`bf_·ﬂ
(
NULL
, &
p
->
num
, 10, 0,

11493 
BF_RNDZ
 | 
BF_FTOA_FORMAT_FRAC
);

11494 
	`¥ötf
("%¢", 
°r
);

11495 
	`bf_ªÆloc
(&
π
->
bf_˘x
, 
°r
, 0);

11498 
JS_TAG_BIG_FLOAT
:

11500 
JSBigFlﬂt
 *
p
 = 
	`JS_VALUE_GET_PTR
(
vÆ
);

11501 *
°r
;

11502 
°r
 = 
	`bf_·ﬂ
(
NULL
, &
p
->
num
, 16, 
BF_PREC_INF
,

11503 
BF_RNDZ
 | 
BF_FTOA_FORMAT_FREE
 | 
BF_FTOA_ADD_PREFIX
);

11504 
	`¥ötf
("%¶", 
°r
);

11505 
	`bf_‰ì
(&
π
->
bf_˘x
, 
°r
);

11508 
JS_TAG_BIG_DECIMAL
:

11510 
JSBigDecimÆ
 *
p
 = 
	`JS_VALUE_GET_PTR
(
vÆ
);

11511 *
°r
;

11512 
°r
 = 
	`bfdec_·ﬂ
(
NULL
, &
p
->
num
, 
BF_PREC_INF
,

11513 
BF_RNDZ
 | 
BF_FTOA_FORMAT_FREE
);

11514 
	`¥ötf
("%sm", 
°r
);

11515 
	`bf_‰ì
(&
π
->
bf_˘x
, 
°r
);

11519 
JS_TAG_STRING
:

11521 
JSSåög
 *
p
;

11522 
p
 = 
	`JS_VALUE_GET_STRING
(
vÆ
);

11523 
	`JS_DumpSåög
(
π
, 
p
);

11526 
JS_TAG_FUNCTION_BYTECODE
:

11528 
JSFun˘i⁄Byãcode
 *
b
 = 
	`JS_VALUE_GET_PTR
(
vÆ
);

11529 
buf
[
ATOM_GET_STR_BUF_SIZE
];

11530 
	`¥ötf
("[byãcodê%s]", 
	`JS_AtomGëSåRT
(
π
, 
buf
, (buf), 
b
->
func_«me
));

11533 
JS_TAG_OBJECT
:

11535 
JSObje˘
 *
p
 = 
	`JS_VALUE_GET_OBJ
(
vÆ
);

11536 
JSAtom
 
©om
 = 
π
->
˛ass_¨øy
[
p
->
˛ass_id
].
˛ass_«me
;

11537 
©om_buf
[
ATOM_GET_STR_BUF_SIZE
];

11538 
	`¥ötf
("[%s %p]",

11539 
	`JS_AtomGëSåRT
(
π
, 
©om_buf
, ◊tom_buf), 
©om
), (*)
p
);

11542 
JS_TAG_SYMBOL
:

11544 
JSAtomSåu˘
 *
p
 = 
	`JS_VALUE_GET_PTR
(
vÆ
);

11545 
©om_buf
[
ATOM_GET_STR_BUF_SIZE
];

11546 
	`¥ötf
("Symbol(%s)",

11547 
	`JS_AtomGëSåRT
(
π
, 
©om_buf
, ◊tom_buf), 
	`js_gë_©om_ödex
‘t, 
p
)));

11550 
JS_TAG_MODULE
:

11551 
	`¥ötf
("[module]");

11554 
	`¥ötf
("[unknow¿èg %d]", 
èg
);

11557 
	}
}

11559 
__maybe_unu£d
 
	$JS_DumpVÆue
(
JSC⁄ãxt
 *
˘x
,

11560 
JSVÆueC⁄°
 
vÆ
)

11562 
	`JS_DumpVÆueSh‹t
(
˘x
->
π
, 
vÆ
);

11563 
	}
}

11565 
__maybe_unu£d
 
	$JS_PrötVÆue
(
JSC⁄ãxt
 *
˘x
,

11566 c⁄° *
°r
,

11567 
JSVÆueC⁄°
 
vÆ
)

11569 
	`¥ötf
("%s=", 
°r
);

11570 
	`JS_DumpVÆueSh‹t
(
˘x
->
π
, 
vÆ
);

11571 
	`¥ötf
("\n");

11572 
	}
}

11575 
	$JS_IsAºay
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
vÆ
)

11577 
JSObje˘
 *
p
;

11578 i‡(
	`JS_VALUE_GET_TAG
(
vÆ
Ë=
JS_TAG_OBJECT
) {

11579 
p
 = 
	`JS_VALUE_GET_OBJ
(
vÆ
);

11580 i‡(
	`u∆ikñy
(
p
->
˛ass_id
 =
JS_CLASS_PROXY
))

11581  
	`js_¥oxy_isAºay
(
˘x
, 
vÆ
);

11583  
p
->
˛ass_id
 =
JS_CLASS_ARRAY
;

11585  
FALSE
;

11587 
	}
}

11589 
	$js_pow
(
a
, 
b
)

11591 i‡(
	`u∆ikñy
(!
	`isföôe
(
b
)Ë&& 
	`Ábs
(
a
) == 1) {

11593  
JS_FLOAT64_NAN
;

11595  
	`pow
(
a
, 
b
);

11597 
	}
}

11599 #ifde‡
CONFIG_BIGNUM


11601 
JSVÆue
 
	$JS_NewBigI¡64_1
(
JSC⁄ãxt
 *
˘x
, 
öt64_t
 
v
)

11603 
JSVÆue
 
vÆ
;

11604 
bf_t
 *
a
;

11605 
vÆ
 = 
	`JS_NewBigI¡
(
˘x
);

11606 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

11607  
vÆ
;

11608 
a
 = 
	`JS_GëBigI¡
(
vÆ
);

11609 i‡(
	`bf_£t_si
(
a
, 
v
)) {

11610 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

11611  
	`JS_ThrowOutOfMem‹y
(
˘x
);

11613  
vÆ
;

11614 
	}
}

11616 
JSVÆue
 
	$JS_NewBigI¡64
(
JSC⁄ãxt
 *
˘x
, 
öt64_t
 
v
)

11618 i‡(
	`is_m©h_mode
(
˘x
) &&

11619 
v
 >-
MAX_SAFE_INTEGER
 && v <= MAX_SAFE_INTEGER) {

11620  
	`JS_NewI¡64
(
˘x
, 
v
);

11622  
	`JS_NewBigI¡64_1
(
˘x
, 
v
);

11624 
	}
}

11626 
JSVÆue
 
	$JS_NewBigUöt64
(
JSC⁄ãxt
 *
˘x
, 
uöt64_t
 
v
)

11628 
JSVÆue
 
vÆ
;

11629 i‡(
	`is_m©h_mode
(
˘x
Ë&& 
v
 <
MAX_SAFE_INTEGER
) {

11630 
vÆ
 = 
	`JS_NewI¡64
(
˘x
, 
v
);

11632 
bf_t
 *
a
;

11633 
vÆ
 = 
	`JS_NewBigI¡
(
˘x
);

11634 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

11635  
vÆ
;

11636 
a
 = 
	`JS_GëBigI¡
(
vÆ
);

11637 i‡(
	`bf_£t_ui
(
a
, 
v
)) {

11638 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

11639  
	`JS_ThrowOutOfMem‹y
(
˘x
);

11642  
vÆ
;

11643 
	}
}

11648 
bf_t
 *
	$JS_ToBigFlﬂt
(
JSC⁄ãxt
 *
˘x
, 
bf_t
 *
buf
, 
JSVÆueC⁄°
 
vÆ
)

11650 
uöt32_t
 
èg
;

11651 
bf_t
 *
r
;

11652 
JSBigFlﬂt
 *
p
;

11654 
èg
 = 
	`JS_VALUE_GET_NORM_TAG
(
vÆ
);

11655 
èg
) {

11656 
JS_TAG_INT
:

11657 
JS_TAG_BOOL
:

11658 
JS_TAG_NULL
:

11659 
r
 = 
buf
;

11660 
	`bf_öô
(
˘x
->
bf_˘x
, 
r
);

11661 i‡(
	`bf_£t_si
(
r
, 
	`JS_VALUE_GET_INT
(
vÆ
)))

11662 
Áû
;

11664 
JS_TAG_FLOAT64
:

11665 
r
 = 
buf
;

11666 
	`bf_öô
(
˘x
->
bf_˘x
, 
r
);

11667 i‡(
	`bf_£t_Êﬂt64
(
r
, 
	`JS_VALUE_GET_FLOAT64
(
vÆ
))) {

11668 
Áû
:

11669 
	`bf_dñëe
(
r
);

11670  
NULL
;

11673 
JS_TAG_BIG_INT
:

11674 
JS_TAG_BIG_FLOAT
:

11675 
p
 = 
	`JS_VALUE_GET_PTR
(
vÆ
);

11676 
r
 = &
p
->
num
;

11678 
JS_TAG_UNDEFINED
:

11680 
r
 = 
buf
;

11681 
	`bf_öô
(
˘x
->
bf_˘x
, 
r
);

11682 
	`bf_£t_«n
(
r
);

11685  
r
;

11686 
	}
}

11689 
bfdec_t
 *
	$JS_ToBigDecimÆ
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
vÆ
)

11691 
uöt32_t
 
èg
;

11692 
JSBigDecimÆ
 *
p
;

11693 
bfdec_t
 *
r
;

11695 
èg
 = 
	`JS_VALUE_GET_NORM_TAG
(
vÆ
);

11696 
èg
) {

11697 
JS_TAG_BIG_DECIMAL
:

11698 
p
 = 
	`JS_VALUE_GET_PTR
(
vÆ
);

11699 
r
 = &
p
->
num
;

11702 
	`JS_ThrowTy≥Eº‹
(
˘x
, "bigdecimalÉxpected");

11703 
r
 = 
NULL
;

11706  
r
;

11707 
	}
}

11710 
JSVÆue
 
	$JS_SåögToBigI¡
(
JSC⁄ãxt
 *
˘x
, 
JSVÆue
 
vÆ
)

11712 c⁄° *
°r
, *
p
;

11713 
size_t
 
Àn
;

11714 
Êags
;

11716 
°r
 = 
	`JS_ToCSåögLí
(
˘x
, &
Àn
, 
vÆ
);

11717 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

11718 i‡(!
°r
)

11719  
JS_EXCEPTION
;

11720 
p
 = 
°r
;

11721 
p
 +
	`skù_•a˚s
(p);

11722 i‡((
p
 - 
°r
Ë=
Àn
) {

11723 
vÆ
 = 
	`JS_NewBigI¡64
(
˘x
, 0);

11725 
Êags
 = 
ATOD_INT_ONLY
 | 
ATOD_ACCEPT_BIN_OCT
 | 
ATOD_TYPE_BIG_INT
;

11726 i‡(
	`is_m©h_mode
(
˘x
))

11727 
Êags
 |
ATOD_MODE_BIGINT
;

11728 
vÆ
 = 
	`js_©of
(
˘x
, 
p
, &p, 0, 
Êags
);

11729 
p
 +
	`skù_•a˚s
(p);

11730 i‡(!
	`JS_IsEx˚±i⁄
(
vÆ
)) {

11731 i‡((
p
 - 
°r
Ë!
Àn
) {

11732 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

11733 
vÆ
 = 
JS_NAN
;

11737 
	`JS_FªeCSåög
(
˘x
, 
°r
);

11738  
vÆ
;

11739 
	}
}

11741 
JSVÆue
 
	$JS_SåögToBigI¡Eº
(
JSC⁄ãxt
 *
˘x
, 
JSVÆue
 
vÆ
)

11743 
vÆ
 = 
	`JS_SåögToBigI¡
(
˘x
, val);

11744 i‡(
	`JS_VALUE_IS_NAN
(
vÆ
))

11745  
	`JS_ThrowSy¡axEº‹
(
˘x
, "invalid bigintÜiteral");

11746  
vÆ
;

11747 
	}
}

11751 
bf_t
 *
	$JS_ToBigI¡Fªe
(
JSC⁄ãxt
 *
˘x
, 
bf_t
 *
buf
, 
JSVÆue
 
vÆ
)

11753 
uöt32_t
 
èg
;

11754 
bf_t
 *
r
;

11755 
JSBigFlﬂt
 *
p
;

11757 
ªdo
:

11758 
èg
 = 
	`JS_VALUE_GET_NORM_TAG
(
vÆ
);

11759 
èg
) {

11760 
JS_TAG_INT
:

11761 
JS_TAG_NULL
:

11762 
JS_TAG_UNDEFINED
:

11763 i‡(!
	`is_m©h_mode
(
˘x
))

11764 
Áû
;

11766 
JS_TAG_BOOL
:

11767 
r
 = 
buf
;

11768 
	`bf_öô
(
˘x
->
bf_˘x
, 
r
);

11769 
	`bf_£t_si
(
r
, 
	`JS_VALUE_GET_INT
(
vÆ
));

11771 
JS_TAG_FLOAT64
:

11773 
d
 = 
	`JS_VALUE_GET_FLOAT64
(
vÆ
);

11774 i‡(!
	`is_m©h_mode
(
˘x
))

11775 
Áû
;

11776 i‡(!
	`isföôe
(
d
))

11777 
Áû
;

11778 
r
 = 
buf
;

11779 
	`bf_öô
(
˘x
->
bf_˘x
, 
r
);

11780 
d
 = 
	`åunc
(d);

11781 
	`bf_£t_Êﬂt64
(
r
, 
d
);

11784 
JS_TAG_BIG_INT
:

11785 
p
 = 
	`JS_VALUE_GET_PTR
(
vÆ
);

11786 
r
 = &
p
->
num
;

11788 
JS_TAG_BIG_FLOAT
:

11789 i‡(!
	`is_m©h_mode
(
˘x
))

11790 
Áû
;

11791 
p
 = 
	`JS_VALUE_GET_PTR
(
vÆ
);

11792 i‡(!
	`bf_is_föôe
(&
p
->
num
))

11793 
Áû
;

11794 
r
 = 
buf
;

11795 
	`bf_öô
(
˘x
->
bf_˘x
, 
r
);

11796 
	`bf_£t
(
r
, &
p
->
num
);

11797 
	`bf_röt
(
r
, 
BF_RNDZ
);

11798 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

11800 
JS_TAG_STRING
:

11801 
vÆ
 = 
	`JS_SåögToBigI¡Eº
(
˘x
, val);

11802 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

11803  
NULL
;

11804 
ªdo
;

11805 
JS_TAG_OBJECT
:

11806 
vÆ
 = 
	`JS_ToPrimôiveFªe
(
˘x
, vÆ, 
HINT_NUMBER
);

11807 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

11808  
NULL
;

11809 
ªdo
;

11811 
Áû
:

11812 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

11813 
	`JS_ThrowTy≥Eº‹
(
˘x
, "cannot convertÅo bigint");

11814  
NULL
;

11816  
r
;

11817 
	}
}

11819 
bf_t
 *
	$JS_ToBigI¡
(
JSC⁄ãxt
 *
˘x
, 
bf_t
 *
buf
, 
JSVÆueC⁄°
 
vÆ
)

11821  
	`JS_ToBigI¡Fªe
(
˘x
, 
buf
, 
	`JS_DupVÆue
(˘x, 
vÆ
));

11822 
	}
}

11824 
__maybe_unu£d
 
JSVÆue
 
	$JS_ToBigI¡VÆueFªe
(
JSC⁄ãxt
 *
˘x
, 
JSVÆue
 
vÆ
)

11826 i‡(
	`JS_VALUE_GET_TAG
(
vÆ
Ë=
JS_TAG_BIG_INT
) {

11827  
vÆ
;

11829 
bf_t
 
a_s
, *
a
, *
r
;

11830 
ªt
;

11831 
JSVÆue
 
ªs
;

11833 
ªs
 = 
	`JS_NewBigI¡
(
˘x
);

11834 i‡(
	`JS_IsEx˚±i⁄
(
ªs
))

11835  
JS_EXCEPTION
;

11836 
a
 = 
	`JS_ToBigI¡Fªe
(
˘x
, &
a_s
, 
vÆ
);

11837 i‡(!
a
) {

11838 
	`JS_FªeVÆue
(
˘x
, 
ªs
);

11839  
JS_EXCEPTION
;

11841 
r
 = 
	`JS_GëBigI¡
(
ªs
);

11842 
ªt
 = 
	`bf_£t
(
r
, 
a
);

11843 
	`JS_FªeBigI¡
(
˘x
, 
a
, &
a_s
);

11844 i‡(
ªt
) {

11845 
	`JS_FªeVÆue
(
˘x
, 
ªs
);

11846  
	`JS_ThrowOutOfMem‹y
(
˘x
);

11848  
	`JS_Com∑˘BigI¡
(
˘x
, 
ªs
);

11850 
	}
}

11853 
	$JS_FªeBigI¡
(
JSC⁄ãxt
 *
˘x
, 
bf_t
 *
a
, bf_à*
buf
)

11855 i‡(
a
 =
buf
) {

11856 
	`bf_dñëe
(
a
);

11858 
JSBigFlﬂt
 *
p
 = (JSBigFlﬂà*)((
uöt8_t
 *)
a
 -

11859 
	`off£tof
(
JSBigFlﬂt
, 
num
));

11860 
	`JS_FªeVÆue
(
˘x
, 
	`JS_MKPTR
(
JS_TAG_BIG_FLOAT
, 
p
));

11862 
	}
}

11865 
	$JS_ToBigI¡64Fªe
(
JSC⁄ãxt
 *
˘x
, 
öt64_t
 *
¥es
, 
JSVÆue
 
vÆ
)

11867 
bf_t
 
a_s
, *
a
;

11869 
a
 = 
	`JS_ToBigI¡Fªe
(
˘x
, &
a_s
, 
vÆ
);

11870 i‡(!
a
) {

11871 *
¥es
 = 0;

11874 
	`bf_gë_öt64
(
¥es
, 
a
, 
BF_GET_INT_MOD
);

11875 
	`JS_FªeBigI¡
(
˘x
, 
a
, &
a_s
);

11877 
	}
}

11879 
	$JS_ToBigI¡64
(
JSC⁄ãxt
 *
˘x
, 
öt64_t
 *
¥es
, 
JSVÆueC⁄°
 
vÆ
)

11881  
	`JS_ToBigI¡64Fªe
(
˘x
, 
¥es
, 
	`JS_DupVÆue
(˘x, 
vÆ
));

11882 
	}
}

11884 
JSBigFlﬂt
 *
	$js_√w_bf
(
JSC⁄ãxt
 *
˘x
)

11886 
JSBigFlﬂt
 *
p
;

11887 
p
 = 
	`js_mÆloc
(
˘x
, (*p));

11888 i‡(!
p
)

11889  
NULL
;

11890 
p
->
hódî
.
ªf_cou¡
 = 1;

11891 
	`bf_öô
(
˘x
->
bf_˘x
, &
p
->
num
);

11892  
p
;

11893 
	}
}

11895 
JSVÆue
 
	$JS_NewBigFlﬂt
(
JSC⁄ãxt
 *
˘x
)

11897 
JSBigFlﬂt
 *
p
;

11898 
p
 = 
	`js_mÆloc
(
˘x
, (*p));

11899 i‡(!
p
)

11900  
JS_EXCEPTION
;

11901 
p
->
hódî
.
ªf_cou¡
 = 1;

11902 
	`bf_öô
(
˘x
->
bf_˘x
, &
p
->
num
);

11903  
	`JS_MKPTR
(
JS_TAG_BIG_FLOAT
, 
p
);

11904 
	}
}

11906 
JSVÆue
 
	$JS_NewBigDecimÆ
(
JSC⁄ãxt
 *
˘x
)

11908 
JSBigDecimÆ
 *
p
;

11909 
p
 = 
	`js_mÆloc
(
˘x
, (*p));

11910 i‡(!
p
)

11911  
JS_EXCEPTION
;

11912 
p
->
hódî
.
ªf_cou¡
 = 1;

11913 
	`bfdec_öô
(
˘x
->
bf_˘x
, &
p
->
num
);

11914  
	`JS_MKPTR
(
JS_TAG_BIG_DECIMAL
, 
p
);

11915 
	}
}

11917 
JSVÆue
 
	$JS_NewBigI¡
(
JSC⁄ãxt
 *
˘x
)

11919 
JSBigFlﬂt
 *
p
;

11920 
p
 = 
	`js_mÆloc
(
˘x
, (*p));

11921 i‡(!
p
)

11922  
JS_EXCEPTION
;

11923 
p
->
hódî
.
ªf_cou¡
 = 1;

11924 
	`bf_öô
(
˘x
->
bf_˘x
, &
p
->
num
);

11925  
	`JS_MKPTR
(
JS_TAG_BIG_INT
, 
p
);

11926 
	}
}

11928 
JSVÆue
 
	$JS_Com∑˘BigI¡1
(
JSC⁄ãxt
 *
˘x
, 
JSVÆue
 
vÆ
,

11929 
BOOL
 
c⁄vît_to_ß„_öãgî
)

11931 
öt64_t
 
v
;

11932 
bf_t
 *
a
;

11934 i‡(
	`JS_VALUE_GET_TAG
(
vÆ
Ë!
JS_TAG_BIG_INT
)

11935  
vÆ
;

11936 
a
 = 
	`JS_GëBigI¡
(
vÆ
);

11937 i‡(
c⁄vît_to_ß„_öãgî
 && 
	`bf_gë_öt64
(&
v
, 
a
, 0) == 0 &&

11938 
v
 >-
MAX_SAFE_INTEGER
 && v <= MAX_SAFE_INTEGER) {

11939 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

11940  
	`JS_NewI¡64
(
˘x
, 
v
);

11941 } i‡(
a
->
ex≤
 =
BF_EXP_ZERO
 &&á->
sign
) {

11942 
JSBigFlﬂt
 *
p
 = 
	`JS_VALUE_GET_PTR
(
vÆ
);

11943 
	`as£π
(
p
->
hódî
.
ªf_cou¡
 == 1);

11944 
a
->
sign
 = 0;

11946  
vÆ
;

11947 
	}
}

11953 
JSVÆue
 
	$JS_Com∑˘BigI¡
(
JSC⁄ãxt
 *
˘x
, 
JSVÆue
 
vÆ
)

11955  
	`JS_Com∑˘BigI¡1
(
˘x
, 
vÆ
, 
	`is_m©h_mode
(ctx));

11956 
	}
}

11960 c⁄° 
	gjs_ovîlﬂdabÀ_›î©‹_«mes
[
JS_OVOP_COUNT
][4] = {

11982 
	$gë_ov›_‰om_›code
(
OPCodeEnum
 
›
)

11984 
›
) {

11985 
OP_add
:

11986  
JS_OVOP_ADD
;

11987 
OP_sub
:

11988  
JS_OVOP_SUB
;

11989 
OP_mul
:

11990  
JS_OVOP_MUL
;

11991 
OP_div
:

11992  
JS_OVOP_DIV
;

11993 
OP_mod
:

11994 
OP_m©h_mod
:

11995  
JS_OVOP_MOD
;

11996 
OP_pow
:

11997  
JS_OVOP_POW
;

11998 
OP_‹
:

11999  
JS_OVOP_OR
;

12000 
OP_™d
:

12001  
JS_OVOP_AND
;

12002 
OP_x‹
:

12003  
JS_OVOP_XOR
;

12004 
OP_shl
:

12005  
JS_OVOP_SHL
;

12006 
OP_ßr
:

12007  
JS_OVOP_SAR
;

12008 
OP_shr
:

12009  
JS_OVOP_SHR
;

12010 
OP_eq
:

12011 
OP_√q
:

12012  
JS_OVOP_EQ
;

12013 
OP_…
:

12014 
OP_…e
:

12015 
OP_gt
:

12016 
OP_gã
:

12017  
JS_OVOP_LESS
;

12018 
OP_∂us
:

12019  
JS_OVOP_POS
;

12020 
OP_√g
:

12021  
JS_OVOP_NEG
;

12022 
OP_öc
:

12023  
JS_OVOP_INC
;

12024 
OP_dec
:

12025  
JS_OVOP_DEC
;

12027 
	`ab‹t
();

12029 
	}
}

12032 
JSObje˘
 *
	$föd_bö¨y_›
(
JSBö¨yO≥øt‹Def
 *
def
,

12033 
uöt32_t
 
›î©‹_ödex
,

12034 
JSOvîlﬂdabÀO≥øt‹Enum
 
›
)

12036 
JSBö¨yO≥øt‹DefE¡ry
 *
ít
;

12037 
i
;

12038 
i
 = 0; i < 
def
->
cou¡
; i++) {

12039 
ít
 = &
def
->
èb
[
i
];

12040 i‡(
ít
->
›î©‹_ödex
 == operator_index)

12041  
ít
->
›s
[
›
];

12043  
NULL
;

12044 
	}
}

12048 
__ex˚±i⁄
 
	$js_ˇŒ_bö¨y_›_ÁŒback
(
JSC⁄ãxt
 *
˘x
,

12049 
JSVÆue
 *
¥ë
,

12050 
JSVÆueC⁄°
 
›1
,

12051 
JSVÆueC⁄°
 
›2
,

12052 
OPCodeEnum
 
›
,

12053 
BOOL
 
is_numîic
,

12054 
höt
)

12056 
JSVÆue
 
›£t1_obj
, 
›£t2_obj
, 
mëhod
, 
ªt
, 
√w_›1
, 
√w_›2
;

12057 
JSO≥øt‹SëD©a
 *
›£t1
, *
›£t2
;

12058 
JSOvîlﬂdabÀO≥øt‹Enum
 
ov›
;

12059 
JSObje˘
 *
p
;

12060 
JSVÆueC⁄°
 
¨gs
[2];

12062 i‡(!
˘x
->
Ælow_›î©‹_ovîlﬂdög
)

12065 
›£t2_obj
 = 
JS_UNDEFINED
;

12066 
›£t1_obj
 = 
	`JS_GëPr›îty
(
˘x
, 
›1
, 
JS_ATOM_Symbﬁ_›î©‹Së
);

12067 i‡(
	`JS_IsEx˚±i⁄
(
›£t1_obj
))

12068 
ex˚±i⁄
;

12069 i‡(
	`JS_IsUndeföed
(
›£t1_obj
))

12071 
›£t1
 = 
	`JS_GëO∑que2
(
˘x
, 
›£t1_obj
, 
JS_CLASS_OPERATOR_SET
);

12072 i‡(!
›£t1
)

12073 
ex˚±i⁄
;

12075 
›£t2_obj
 = 
	`JS_GëPr›îty
(
˘x
, 
›2
, 
JS_ATOM_Symbﬁ_›î©‹Së
);

12076 i‡(
	`JS_IsEx˚±i⁄
(
›£t2_obj
))

12077 
ex˚±i⁄
;

12078 i‡(
	`JS_IsUndeföed
(
›£t2_obj
)) {

12079 
	`JS_FªeVÆue
(
˘x
, 
›£t1_obj
);

12082 
›£t2
 = 
	`JS_GëO∑que2
(
˘x
, 
›£t2_obj
, 
JS_CLASS_OPERATOR_SET
);

12083 i‡(!
›£t2
)

12084 
ex˚±i⁄
;

12086 i‡(
›£t1
->
is_¥imôive
 && 
›£t2
->is_primitive) {

12087 
	`JS_FªeVÆue
(
˘x
, 
›£t1_obj
);

12088 
	`JS_FªeVÆue
(
˘x
, 
›£t2_obj
);

12092 
ov›
 = 
	`gë_ov›_‰om_›code
(
›
);

12094 i‡(
›£t1
->
›î©‹_cou¡î
 =
›£t2
->operator_counter) {

12095 
p
 = 
›£t1
->
£lf_›s
[
ov›
];

12096 } i‡(
›£t1
->
›î©‹_cou¡î
 > 
›£t2
->operator_counter) {

12097 
p
 = 
	`föd_bö¨y_›
(&
›£t1
->
À·
, 
›£t2
->
›î©‹_cou¡î
, 
ov›
);

12099 
p
 = 
	`föd_bö¨y_›
(&
›£t2
->
right
, 
›£t1
->
›î©‹_cou¡î
, 
ov›
);

12101 i‡(!
p
) {

12102 
	`JS_ThrowTy≥Eº‹
(
˘x
, "operator %s:Ço function defined",

12103 
js_ovîlﬂdabÀ_›î©‹_«mes
[
ov›
]);

12104 
ex˚±i⁄
;

12107 i‡(
›£t1
->
is_¥imôive
) {

12108 i‡(
is_numîic
) {

12109 
√w_›1
 = 
	`JS_ToNumîic
(
˘x
, 
›1
);

12111 
√w_›1
 = 
	`JS_ToPrimôive
(
˘x
, 
›1
, 
höt
);

12113 i‡(
	`JS_IsEx˚±i⁄
(
√w_›1
))

12114 
ex˚±i⁄
;

12116 
√w_›1
 = 
	`JS_DupVÆue
(
˘x
, 
›1
);

12119 i‡(
›£t2
->
is_¥imôive
) {

12120 i‡(
is_numîic
) {

12121 
√w_›2
 = 
	`JS_ToNumîic
(
˘x
, 
›2
);

12123 
√w_›2
 = 
	`JS_ToPrimôive
(
˘x
, 
›2
, 
höt
);

12125 i‡(
	`JS_IsEx˚±i⁄
(
√w_›2
)) {

12126 
	`JS_FªeVÆue
(
˘x
, 
√w_›1
);

12127 
ex˚±i⁄
;

12130 
√w_›2
 = 
	`JS_DupVÆue
(
˘x
, 
›2
);

12136 
mëhod
 = 
	`JS_DupVÆue
(
˘x
, 
	`JS_MKPTR
(
JS_TAG_OBJECT
, 
p
));

12137 i‡(
ov›
 =
JS_OVOP_LESS
 && (
›
 =
OP_…e
 || o∞=
OP_gt
)) {

12138 
¨gs
[0] = 
√w_›2
;

12139 
¨gs
[1] = 
√w_›1
;

12141 
¨gs
[0] = 
√w_›1
;

12142 
¨gs
[1] = 
√w_›2
;

12144 
ªt
 = 
	`JS_CÆlFªe
(
˘x
, 
mëhod
, 
JS_UNDEFINED
, 2, 
¨gs
);

12145 
	`JS_FªeVÆue
(
˘x
, 
√w_›1
);

12146 
	`JS_FªeVÆue
(
˘x
, 
√w_›2
);

12147 i‡(
	`JS_IsEx˚±i⁄
(
ªt
))

12148 
ex˚±i⁄
;

12149 i‡(
ov›
 =
JS_OVOP_EQ
) {

12150 
BOOL
 
ªs
 = 
	`JS_ToBoﬁFªe
(
˘x
, 
ªt
);

12151 i‡(
›
 =
OP_√q
)

12152 
ªs
 ^= 1;

12153 
ªt
 = 
	`JS_NewBoﬁ
(
˘x
, 
ªs
);

12154 } i‡(
ov›
 =
JS_OVOP_LESS
) {

12155 i‡(
	`JS_IsUndeföed
(
ªt
)) {

12156 
ªt
 = 
JS_FALSE
;

12158 
BOOL
 
ªs
 = 
	`JS_ToBoﬁFªe
(
˘x
, 
ªt
);

12159 i‡(
›
 =
OP_…e
 || o∞=
OP_gã
)

12160 
ªs
 ^= 1;

12161 
ªt
 = 
	`JS_NewBoﬁ
(
˘x
, 
ªs
);

12164 
	`JS_FªeVÆue
(
˘x
, 
›£t1_obj
);

12165 
	`JS_FªeVÆue
(
˘x
, 
›£t2_obj
);

12166 *
¥ë
 = 
ªt
;

12168 
ex˚±i⁄
:

12169 
	`JS_FªeVÆue
(
˘x
, 
›£t1_obj
);

12170 
	`JS_FªeVÆue
(
˘x
, 
›£t2_obj
);

12171 *
¥ë
 = 
JS_UNDEFINED
;

12173 
	}
}

12177 
__ex˚±i⁄
 
	$js_ˇŒ_bö¨y_›_sim∂e
(
JSC⁄ãxt
 *
˘x
,

12178 
JSVÆue
 *
¥ë
,

12179 
JSVÆueC⁄°
 
obj
,

12180 
JSVÆueC⁄°
 
›1
,

12181 
JSVÆueC⁄°
 
›2
,

12182 
OPCodeEnum
 
›
)

12184 
JSVÆue
 
›£t1_obj
, 
mëhod
, 
ªt
, 
√w_›1
, 
√w_›2
;

12185 
JSO≥øt‹SëD©a
 *
›£t1
;

12186 
JSOvîlﬂdabÀO≥øt‹Enum
 
ov›
;

12187 
JSObje˘
 *
p
;

12188 
JSVÆueC⁄°
 
¨gs
[2];

12190 
›£t1_obj
 = 
	`JS_GëPr›îty
(
˘x
, 
obj
, 
JS_ATOM_Symbﬁ_›î©‹Së
);

12191 i‡(
	`JS_IsEx˚±i⁄
(
›£t1_obj
))

12192 
ex˚±i⁄
;

12193 i‡(
	`JS_IsUndeföed
(
›£t1_obj
))

12195 
›£t1
 = 
	`JS_GëO∑que2
(
˘x
, 
›£t1_obj
, 
JS_CLASS_OPERATOR_SET
);

12196 i‡(!
›£t1
)

12197 
ex˚±i⁄
;

12198 
ov›
 = 
	`gë_ov›_‰om_›code
(
›
);

12200 
p
 = 
›£t1
->
£lf_›s
[
ov›
];

12201 i‡(!
p
) {

12202 
	`JS_FªeVÆue
(
˘x
, 
›£t1_obj
);

12206 
√w_›1
 = 
	`JS_ToNumîic
(
˘x
, 
›1
);

12207 i‡(
	`JS_IsEx˚±i⁄
(
√w_›1
))

12208 
ex˚±i⁄
;

12209 
√w_›2
 = 
	`JS_ToNumîic
(
˘x
, 
›2
);

12210 i‡(
	`JS_IsEx˚±i⁄
(
√w_›2
)) {

12211 
	`JS_FªeVÆue
(
˘x
, 
√w_›1
);

12212 
ex˚±i⁄
;

12215 
mëhod
 = 
	`JS_DupVÆue
(
˘x
, 
	`JS_MKPTR
(
JS_TAG_OBJECT
, 
p
));

12216 
¨gs
[0] = 
√w_›1
;

12217 
¨gs
[1] = 
√w_›2
;

12218 
ªt
 = 
	`JS_CÆlFªe
(
˘x
, 
mëhod
, 
JS_UNDEFINED
, 2, 
¨gs
);

12219 
	`JS_FªeVÆue
(
˘x
, 
√w_›1
);

12220 
	`JS_FªeVÆue
(
˘x
, 
√w_›2
);

12221 i‡(
	`JS_IsEx˚±i⁄
(
ªt
))

12222 
ex˚±i⁄
;

12223 
	`JS_FªeVÆue
(
˘x
, 
›£t1_obj
);

12224 *
¥ë
 = 
ªt
;

12226 
ex˚±i⁄
:

12227 
	`JS_FªeVÆue
(
˘x
, 
›£t1_obj
);

12228 *
¥ë
 = 
JS_UNDEFINED
;

12230 
	}
}

12234 
__ex˚±i⁄
 
	$js_ˇŒ_u«ry_›_ÁŒback
(
JSC⁄ãxt
 *
˘x
,

12235 
JSVÆue
 *
¥ë
,

12236 
JSVÆueC⁄°
 
›1
,

12237 
OPCodeEnum
 
›
)

12239 
JSVÆue
 
›£t1_obj
, 
mëhod
, 
ªt
;

12240 
JSO≥øt‹SëD©a
 *
›£t1
;

12241 
JSOvîlﬂdabÀO≥øt‹Enum
 
ov›
;

12242 
JSObje˘
 *
p
;

12244 i‡(!
˘x
->
Ælow_›î©‹_ovîlﬂdög
)

12247 
›£t1_obj
 = 
	`JS_GëPr›îty
(
˘x
, 
›1
, 
JS_ATOM_Symbﬁ_›î©‹Së
);

12248 i‡(
	`JS_IsEx˚±i⁄
(
›£t1_obj
))

12249 
ex˚±i⁄
;

12250 i‡(
	`JS_IsUndeföed
(
›£t1_obj
))

12252 
›£t1
 = 
	`JS_GëO∑que2
(
˘x
, 
›£t1_obj
, 
JS_CLASS_OPERATOR_SET
);

12253 i‡(!
›£t1
)

12254 
ex˚±i⁄
;

12255 i‡(
›£t1
->
is_¥imôive
) {

12256 
	`JS_FªeVÆue
(
˘x
, 
›£t1_obj
);

12260 
ov›
 = 
	`gë_ov›_‰om_›code
(
›
);

12262 
p
 = 
›£t1
->
£lf_›s
[
ov›
];

12263 i‡(!
p
) {

12264 
	`JS_ThrowTy≥Eº‹
(
˘x
, "no overloaded operator %s",

12265 
js_ovîlﬂdabÀ_›î©‹_«mes
[
ov›
]);

12266 
ex˚±i⁄
;

12268 
mëhod
 = 
	`JS_DupVÆue
(
˘x
, 
	`JS_MKPTR
(
JS_TAG_OBJECT
, 
p
));

12269 
ªt
 = 
	`JS_CÆlFªe
(
˘x
, 
mëhod
, 
JS_UNDEFINED
, 1, &
›1
);

12270 i‡(
	`JS_IsEx˚±i⁄
(
ªt
))

12271 
ex˚±i⁄
;

12272 
	`JS_FªeVÆue
(
˘x
, 
›£t1_obj
);

12273 *
¥ë
 = 
ªt
;

12275 
ex˚±i⁄
:

12276 
	`JS_FªeVÆue
(
˘x
, 
›£t1_obj
);

12277 *
¥ë
 = 
JS_UNDEFINED
;

12279 
	}
}

12281 
JSVÆue
 
	$throw_bf_ex˚±i⁄
(
JSC⁄ãxt
 *
˘x
, 
°©us
)

12283 c⁄° *
°r
;

12284 i‡(
°©us
 & 
BF_ST_MEM_ERROR
)

12285  
	`JS_ThrowOutOfMem‹y
(
˘x
);

12286 i‡(
°©us
 & 
BF_ST_DIVIDE_ZERO
) {

12287 
°r
 = "division by zero";

12288 } i‡(
°©us
 & 
BF_ST_INVALID_OP
) {

12289 
°r
 = "invalid operation";

12291 
°r
 = "integer overflow";

12293  
	`JS_ThrowR™geEº‹
(
˘x
, "%s", 
°r
);

12294 
	}
}

12296 
	$js_u«ry_¨ôh_bigöt
(
JSC⁄ãxt
 *
˘x
,

12297 
JSVÆue
 *
¥es
, 
OPCodeEnum
 
›
, JSVÆuê
›1
)

12299 
bf_t
 
a_s
, *
r
, *
a
;

12300 
ªt
, 
v
;

12301 
JSVÆue
 
ªs
;

12303 i‡(
›
 =
OP_∂us
 && !
	`is_m©h_mode
(
˘x
)) {

12304 
	`JS_ThrowTy≥Eº‹
(
˘x
, "bigintárgument with unary +");

12305 
	`JS_FªeVÆue
(
˘x
, 
›1
);

12308 
ªs
 = 
	`JS_NewBigI¡
(
˘x
);

12309 i‡(
	`JS_IsEx˚±i⁄
(
ªs
)) {

12310 
	`JS_FªeVÆue
(
˘x
, 
›1
);

12313 
r
 = 
	`JS_GëBigI¡
(
ªs
);

12314 
a
 = 
	`JS_ToBigI¡
(
˘x
, &
a_s
, 
›1
);

12315 
ªt
 = 0;

12316 
›
) {

12317 
OP_öc
:

12318 
OP_dec
:

12319 
v
 = 2 * (
›
 - 
OP_dec
) - 1;

12320 
ªt
 = 
	`bf_add_si
(
r
, 
a
, 
v
, 
BF_PREC_INF
, 
BF_RNDZ
);

12322 
OP_∂us
:

12323 
ªt
 = 
	`bf_£t
(
r
, 
a
);

12325 
OP_√g
:

12326 
ªt
 = 
	`bf_£t
(
r
, 
a
);

12327 
	`bf_√g
(
r
);

12329 
OP_nŸ
:

12330 
ªt
 = 
	`bf_add_si
(
r
, 
a
, 1, 
BF_PREC_INF
, 
BF_RNDZ
);

12331 
	`bf_√g
(
r
);

12334 
	`ab‹t
();

12336 
	`JS_FªeBigI¡
(
˘x
, 
a
, &
a_s
);

12337 
	`JS_FªeVÆue
(
˘x
, 
›1
);

12338 i‡(
	`u∆ikñy
(
ªt
)) {

12339 
	`JS_FªeVÆue
(
˘x
, 
ªs
);

12340 
	`throw_bf_ex˚±i⁄
(
˘x
, 
ªt
);

12343 
ªs
 = 
	`JS_Com∑˘BigI¡
(
˘x
,Ñes);

12344 *
¥es
 = 
ªs
;

12346 
	}
}

12348 
	$js_u«ry_¨ôh_bigÊﬂt
(
JSC⁄ãxt
 *
˘x
,

12349 
JSVÆue
 *
¥es
, 
OPCodeEnum
 
›
, JSVÆuê
›1
)

12351 
bf_t
 
a_s
, *
r
, *
a
;

12352 
ªt
, 
v
;

12353 
JSVÆue
 
ªs
;

12355 i‡(
›
 =
OP_∂us
 && !
	`is_m©h_mode
(
˘x
)) {

12356 
	`JS_ThrowTy≥Eº‹
(
˘x
, "bigfloatárgument with unary +");

12357 
	`JS_FªeVÆue
(
˘x
, 
›1
);

12361 
ªs
 = 
	`JS_NewBigFlﬂt
(
˘x
);

12362 i‡(
	`JS_IsEx˚±i⁄
(
ªs
)) {

12363 
	`JS_FªeVÆue
(
˘x
, 
›1
);

12366 
r
 = 
	`JS_GëBigFlﬂt
(
ªs
);

12367 
a
 = 
	`JS_ToBigFlﬂt
(
˘x
, &
a_s
, 
›1
);

12368 
ªt
 = 0;

12369 
›
) {

12370 
OP_öc
:

12371 
OP_dec
:

12372 
v
 = 2 * (
›
 - 
OP_dec
) - 1;

12373 
ªt
 = 
	`bf_add_si
(
r
, 
a
, 
v
, 
˘x
->
Â_ív
.
¥ec
, ctx->Â_ív.
Êags
);

12375 
OP_∂us
:

12376 
ªt
 = 
	`bf_£t
(
r
, 
a
);

12378 
OP_√g
:

12379 
ªt
 = 
	`bf_£t
(
r
, 
a
);

12380 
	`bf_√g
(
r
);

12383 
	`ab‹t
();

12385 i‡(
a
 =&
a_s
)

12386 
	`bf_dñëe
(
a
);

12387 
	`JS_FªeVÆue
(
˘x
, 
›1
);

12388 i‡(
	`u∆ikñy
(
ªt
 & 
BF_ST_MEM_ERROR
)) {

12389 
	`JS_FªeVÆue
(
˘x
, 
ªs
);

12390 
	`throw_bf_ex˚±i⁄
(
˘x
, 
ªt
);

12393 *
¥es
 = 
ªs
;

12395 
	}
}

12397 
	$js_u«ry_¨ôh_bigdecimÆ
(
JSC⁄ãxt
 *
˘x
,

12398 
JSVÆue
 *
¥es
, 
OPCodeEnum
 
›
, JSVÆuê
›1
)

12400 
bfdec_t
 *
r
, *
a
;

12401 
ªt
, 
v
;

12402 
JSVÆue
 
ªs
;

12404 i‡(
›
 =
OP_∂us
 && !
	`is_m©h_mode
(
˘x
)) {

12405 
	`JS_ThrowTy≥Eº‹
(
˘x
, "bigdecimalárgument with unary +");

12406 
	`JS_FªeVÆue
(
˘x
, 
›1
);

12410 
ªs
 = 
	`JS_NewBigDecimÆ
(
˘x
);

12411 i‡(
	`JS_IsEx˚±i⁄
(
ªs
)) {

12412 
	`JS_FªeVÆue
(
˘x
, 
›1
);

12415 
r
 = 
	`JS_GëBigDecimÆ
(
ªs
);

12416 
a
 = 
	`JS_ToBigDecimÆ
(
˘x
, 
›1
);

12417 
ªt
 = 0;

12418 
›
) {

12419 
OP_öc
:

12420 
OP_dec
:

12421 
v
 = 2 * (
›
 - 
OP_dec
) - 1;

12422 
ªt
 = 
	`bfdec_add_si
(
r
, 
a
, 
v
, 
BF_PREC_INF
, 
BF_RNDZ
);

12424 
OP_∂us
:

12425 
ªt
 = 
	`bfdec_£t
(
r
, 
a
);

12427 
OP_√g
:

12428 
ªt
 = 
	`bfdec_£t
(
r
, 
a
);

12429 
	`bfdec_√g
(
r
);

12432 
	`ab‹t
();

12434 
	`JS_FªeVÆue
(
˘x
, 
›1
);

12435 i‡(
	`u∆ikñy
(
ªt
)) {

12436 
	`JS_FªeVÆue
(
˘x
, 
ªs
);

12437 
	`throw_bf_ex˚±i⁄
(
˘x
, 
ªt
);

12440 *
¥es
 = 
ªs
;

12442 
	}
}

12444 
no_ölöe
 
__ex˚±i⁄
 
	$js_u«ry_¨ôh_¶ow
(
JSC⁄ãxt
 *
˘x
,

12445 
JSVÆue
 *
•
,

12446 
OPCodeEnum
 
›
)

12448 
JSVÆue
 
›1
, 
vÆ
;

12449 
v
, 
ªt
;

12450 
uöt32_t
 
èg
;

12452 
›1
 = 
•
[-1];

12454 i‡(
	`JS_TAG_IS_FLOAT64
(
	`JS_VALUE_GET_TAG
(
›1
)))

12455 
h™dÀ_Êﬂt64
;

12456 i‡(
	`JS_IsObje˘
(
›1
)) {

12457 
ªt
 = 
	`js_ˇŒ_u«ry_›_ÁŒback
(
˘x
, &
vÆ
, 
›1
, 
›
);

12458 i‡(
ªt
 < 0)

12460 i‡(
ªt
) {

12461 
	`JS_FªeVÆue
(
˘x
, 
›1
);

12462 
•
[-1] = 
vÆ
;

12467 
›1
 = 
	`JS_ToNumîicFªe
(
˘x
, op1);

12468 i‡(
	`JS_IsEx˚±i⁄
(
›1
))

12469 
ex˚±i⁄
;

12470 
èg
 = 
	`JS_VALUE_GET_TAG
(
›1
);

12471 
èg
) {

12472 
JS_TAG_INT
:

12474 
öt64_t
 
v64
;

12475 
v64
 = 
	`JS_VALUE_GET_INT
(
›1
);

12476 
›
) {

12477 
OP_öc
:

12478 
OP_dec
:

12479 
v
 = 2 * (
›
 - 
OP_dec
) - 1;

12480 
v64
 +
v
;

12482 
OP_∂us
:

12484 
OP_√g
:

12485 i‡(
v64
 == 0) {

12486 
•
[-1] = 
	`__JS_NewFlﬂt64
(
˘x
, -0.0);

12489 
v64
 = -v64;

12493 
	`ab‹t
();

12495 
•
[-1] = 
	`JS_NewI¡64
(
˘x
, 
v64
);

12498 
JS_TAG_BIG_INT
:

12499 
h™dÀ_bigöt
:

12500 i‡(
˘x
->
π
->
bigöt_›s
.
	`u«ry_¨ôh
(˘x, 
•
 - 1, 
›
, 
›1
))

12501 
ex˚±i⁄
;

12503 
JS_TAG_BIG_FLOAT
:

12504 i‡(
˘x
->
π
->
bigÊﬂt_›s
.
	`u«ry_¨ôh
(˘x, 
•
 - 1, 
›
, 
›1
))

12505 
ex˚±i⁄
;

12507 
JS_TAG_BIG_DECIMAL
:

12508 i‡(
˘x
->
π
->
bigdecimÆ_›s
.
	`u«ry_¨ôh
(˘x, 
•
 - 1, 
›
, 
›1
))

12509 
ex˚±i⁄
;

12512 
h™dÀ_Êﬂt64
:

12514 
d
;

12515 i‡(
	`is_m©h_mode
(
˘x
))

12516 
h™dÀ_bigöt
;

12517 
d
 = 
	`JS_VALUE_GET_FLOAT64
(
›1
);

12518 
›
) {

12519 
OP_öc
:

12520 
OP_dec
:

12521 
v
 = 2 * (
›
 - 
OP_dec
) - 1;

12522 
d
 +
v
;

12524 
OP_∂us
:

12526 
OP_√g
:

12527 
d
 = -d;

12530 
	`ab‹t
();

12532 
•
[-1] = 
	`__JS_NewFlﬂt64
(
˘x
, 
d
);

12537 
ex˚±i⁄
:

12538 
•
[-1] = 
JS_UNDEFINED
;

12540 
	}
}

12542 
__ex˚±i⁄
 
	$js_po°_öc_¶ow
(
JSC⁄ãxt
 *
˘x
,

12543 
JSVÆue
 *
•
, 
OPCodeEnum
 
›
)

12545 
JSVÆue
 
›1
;

12548 
›1
 = 
•
[-1];

12549 
›1
 = 
	`JS_ToNumîicFªe
(
˘x
, op1);

12550 i‡(
	`JS_IsEx˚±i⁄
(
›1
)) {

12551 
•
[-1] = 
JS_UNDEFINED
;

12554 
•
[-1] = 
›1
;

12555 
•
[0] = 
	`JS_DupVÆue
(
˘x
, 
›1
);

12556  
	`js_u«ry_¨ôh_¶ow
(
˘x
, 
•
 + 1, 
›
 - 
OP_po°_dec
 + 
OP_dec
);

12557 
	}
}

12559 
no_ölöe
 
	$js_nŸ_¶ow
(
JSC⁄ãxt
 *
˘x
, 
JSVÆue
 *
•
)

12561 
JSVÆue
 
›1
, 
vÆ
;

12562 
ªt
;

12564 
›1
 = 
•
[-1];

12565 i‡(
	`JS_IsObje˘
(
›1
)) {

12566 
ªt
 = 
	`js_ˇŒ_u«ry_›_ÁŒback
(
˘x
, &
vÆ
, 
›1
, 
OP_nŸ
);

12567 i‡(
ªt
 < 0)

12569 i‡(
ªt
) {

12570 
	`JS_FªeVÆue
(
˘x
, 
›1
);

12571 
•
[-1] = 
vÆ
;

12576 
›1
 = 
	`JS_ToNumîicFªe
(
˘x
, op1);

12577 i‡(
	`JS_IsEx˚±i⁄
(
›1
))

12578 
ex˚±i⁄
;

12579 i‡(
	`is_m©h_mode
(
˘x
Ë|| 
	`JS_VALUE_GET_TAG
(
›1
Ë=
JS_TAG_BIG_INT
) {

12580 i‡(
˘x
->
π
->
bigöt_›s
.
	`u«ry_¨ôh
(˘x, 
•
 - 1, 
OP_nŸ
, 
›1
))

12581 
ex˚±i⁄
;

12583 
öt32_t
 
v1
;

12584 i‡(
	`u∆ikñy
(
	`JS_ToI¡32Fªe
(
˘x
, &
v1
, 
›1
)))

12585 
ex˚±i⁄
;

12586 
•
[-1] = 
	`JS_NewI¡32
(
˘x
, ~
v1
);

12589 
ex˚±i⁄
:

12590 
•
[-1] = 
JS_UNDEFINED
;

12592 
	}
}

12594 
	$js_bö¨y_¨ôh_bigÊﬂt
(
JSC⁄ãxt
 *
˘x
, 
OPCodeEnum
 
›
,

12595 
JSVÆue
 *
¥es
, JSVÆuê
›1
, JSVÆuê
›2
)

12597 
bf_t
 
a_s
, 
b_s
, *
r
, *
a
, *
b
;

12598 
ªt
;

12599 
JSVÆue
 
ªs
;

12601 
ªs
 = 
	`JS_NewBigFlﬂt
(
˘x
);

12602 i‡(
	`JS_IsEx˚±i⁄
(
ªs
)) {

12603 
	`JS_FªeVÆue
(
˘x
, 
›1
);

12604 
	`JS_FªeVÆue
(
˘x
, 
›2
);

12607 
r
 = 
	`JS_GëBigFlﬂt
(
ªs
);

12608 
a
 = 
	`JS_ToBigFlﬂt
(
˘x
, &
a_s
, 
›1
);

12609 
b
 = 
	`JS_ToBigFlﬂt
(
˘x
, &
b_s
, 
›2
);

12610 
	`bf_öô
(
˘x
->
bf_˘x
, 
r
);

12611 
›
) {

12612 
OP_add
:

12613 
ªt
 = 
	`bf_add
(
r
, 
a
, 
b
, 
˘x
->
Â_ív
.
¥ec
, ctx->Â_ív.
Êags
);

12615 
OP_sub
:

12616 
ªt
 = 
	`bf_sub
(
r
, 
a
, 
b
, 
˘x
->
Â_ív
.
¥ec
, ctx->Â_ív.
Êags
);

12618 
OP_mul
:

12619 
ªt
 = 
	`bf_mul
(
r
, 
a
, 
b
, 
˘x
->
Â_ív
.
¥ec
, ctx->Â_ív.
Êags
);

12621 
OP_div
:

12622 
ªt
 = 
	`bf_div
(
r
, 
a
, 
b
, 
˘x
->
Â_ív
.
¥ec
, ctx->Â_ív.
Êags
);

12624 
OP_m©h_mod
:

12626 
ªt
 = 
	`bf_ªm
(
r
, 
a
, 
b
, 
˘x
->
Â_ív
.
¥ec
, ctx->Â_ív.
Êags
,

12627 
BF_DIVREM_EUCLIDIAN
);

12629 
OP_mod
:

12630 
ªt
 = 
	`bf_ªm
(
r
, 
a
, 
b
, 
˘x
->
Â_ív
.
¥ec
, ctx->Â_ív.
Êags
,

12631 
BF_RNDZ
);

12633 
OP_pow
:

12634 
ªt
 = 
	`bf_pow
(
r
, 
a
, 
b
, 
˘x
->
Â_ív
.
¥ec
,

12635 
˘x
->
Â_ív
.
Êags
 | 
BF_POW_JS_QUIRKS
);

12638 
	`ab‹t
();

12640 i‡(
a
 =&
a_s
)

12641 
	`bf_dñëe
(
a
);

12642 i‡(
b
 =&
b_s
)

12643 
	`bf_dñëe
(
b
);

12644 
	`JS_FªeVÆue
(
˘x
, 
›1
);

12645 
	`JS_FªeVÆue
(
˘x
, 
›2
);

12646 i‡(
	`u∆ikñy
(
ªt
 & 
BF_ST_MEM_ERROR
)) {

12647 
	`JS_FªeVÆue
(
˘x
, 
ªs
);

12648 
	`throw_bf_ex˚±i⁄
(
˘x
, 
ªt
);

12651 *
¥es
 = 
ªs
;

12653 
	}
}

12655 
	$js_bö¨y_¨ôh_bigöt
(
JSC⁄ãxt
 *
˘x
, 
OPCodeEnum
 
›
,

12656 
JSVÆue
 *
¥es
, JSVÆuê
›1
, JSVÆuê
›2
)

12658 
bf_t
 
a_s
, 
b_s
, *
r
, *
a
, *
b
;

12659 
ªt
;

12660 
JSVÆue
 
ªs
;

12662 
ªs
 = 
	`JS_NewBigI¡
(
˘x
);

12663 i‡(
	`JS_IsEx˚±i⁄
(
ªs
))

12664 
Áû
;

12665 
a
 = 
	`JS_ToBigI¡
(
˘x
, &
a_s
, 
›1
);

12666 i‡(!
a
)

12667 
Áû
;

12668 
b
 = 
	`JS_ToBigI¡
(
˘x
, &
b_s
, 
›2
);

12669 i‡(!
b
) {

12670 
	`JS_FªeBigI¡
(
˘x
, 
a
, &
a_s
);

12671 
Áû
;

12673 
r
 = 
	`JS_GëBigI¡
(
ªs
);

12674 
ªt
 = 0;

12675 
›
) {

12676 
OP_add
:

12677 
ªt
 = 
	`bf_add
(
r
, 
a
, 
b
, 
BF_PREC_INF
, 
BF_RNDZ
);

12679 
OP_sub
:

12680 
ªt
 = 
	`bf_sub
(
r
, 
a
, 
b
, 
BF_PREC_INF
, 
BF_RNDZ
);

12682 
OP_mul
:

12683 
ªt
 = 
	`bf_mul
(
r
, 
a
, 
b
, 
BF_PREC_INF
, 
BF_RNDZ
);

12685 
OP_div
:

12686 i‡(!
	`is_m©h_mode
(
˘x
)) {

12687 
bf_t
 
ªm_s
, *
ªm
 = &rem_s;

12688 
	`bf_öô
(
˘x
->
bf_˘x
, 
ªm
);

12689 
ªt
 = 
	`bf_divªm
(
r
, 
ªm
, 
a
, 
b
, 
BF_PREC_INF
, 
BF_RNDZ
,

12690 
BF_RNDZ
);

12691 
	`bf_dñëe
(
ªm
);

12693 
m©h_mode_div_pow
;

12696 
OP_m©h_mod
:

12698 
ªt
 = 
	`bf_ªm
(
r
, 
a
, 
b
, 
BF_PREC_INF
, 
BF_RNDZ
,

12699 
BF_DIVREM_EUCLIDIAN
Ë& 
BF_ST_INVALID_OP
;

12701 
OP_mod
:

12702 
ªt
 = 
	`bf_ªm
(
r
, 
a
, 
b
, 
BF_PREC_INF
, 
BF_RNDZ
,

12703 
BF_RNDZ
Ë& 
BF_ST_INVALID_OP
;

12705 
OP_pow
:

12706 i‡(
b
->
sign
) {

12707 i‡(!
	`is_m©h_mode
(
˘x
)) {

12708 
ªt
 = 
BF_ST_INVALID_OP
;

12710 
m©h_mode_div_pow
:

12711 
	`JS_FªeVÆue
(
˘x
, 
ªs
);

12712 
ªt
 = 
	`js_ˇŒ_bö¨y_›_sim∂e
(
˘x
, &
ªs
, ctx->
˛ass_¥Ÿo
[
JS_CLASS_BIG_INT
], 
›1
, 
›2
, 
›
);

12713 i‡(
ªt
 != 0) {

12714 
	`JS_FªeBigI¡
(
˘x
, 
a
, &
a_s
);

12715 
	`JS_FªeBigI¡
(
˘x
, 
b
, &
b_s
);

12716 
	`JS_FªeVÆue
(
˘x
, 
›1
);

12717 
	`JS_FªeVÆue
(
˘x
, 
›2
);

12718 i‡(
ªt
 < 0) {

12721 *
¥es
 = 
ªs
;

12727 
ªs
 = 
	`JS_NewBigFlﬂt
(
˘x
);

12728 i‡(
	`JS_IsEx˚±i⁄
(
ªs
)) {

12729 
	`JS_FªeBigI¡
(
˘x
, 
a
, &
a_s
);

12730 
	`JS_FªeBigI¡
(
˘x
, 
b
, &
b_s
);

12731 
Áû
;

12733 
r
 = 
	`JS_GëBigFlﬂt
(
ªs
);

12734 i‡(
›
 =
OP_div
) {

12735 
ªt
 = 
	`bf_div
(
r
, 
a
, 
b
, 
˘x
->
Â_ív
.
¥ec
, ctx->Â_ív.
Êags
Ë& 
BF_ST_MEM_ERROR
;

12737 
ªt
 = 
	`bf_pow
(
r
, 
a
, 
b
, 
˘x
->
Â_ív
.
¥ec
,

12738 
˘x
->
Â_ív
.
Êags
 | 
BF_POW_JS_QUIRKS
Ë& 
BF_ST_MEM_ERROR
;

12740 
	`JS_FªeBigI¡
(
˘x
, 
a
, &
a_s
);

12741 
	`JS_FªeBigI¡
(
˘x
, 
b
, &
b_s
);

12742 
	`JS_FªeVÆue
(
˘x
, 
›1
);

12743 
	`JS_FªeVÆue
(
˘x
, 
›2
);

12744 i‡(
	`u∆ikñy
(
ªt
)) {

12745 
	`JS_FªeVÆue
(
˘x
, 
ªs
);

12746 
	`throw_bf_ex˚±i⁄
(
˘x
, 
ªt
);

12749 *
¥es
 = 
ªs
;

12753 
ªt
 = 
	`bf_pow
(
r
, 
a
, 
b
, 
BF_PREC_INF
, 
BF_RNDZ
 | 
BF_POW_JS_QUIRKS
);

12758 
OP_shl
:

12759 
OP_ßr
:

12761 
¶imb_t
 
v2
;

12762 #i‡
LIMB_BITS
 == 32

12763 
	`bf_gë_öt32
(&
v2
, 
b
, 0);

12764 i‡(
v2
 =
INT32_MIN
)

12765 
v2
 = 
INT32_MIN
 + 1;

12767 
	`bf_gë_öt64
(&
v2
, 
b
, 0);

12768 i‡(
v2
 =
INT64_MIN
)

12769 
v2
 = 
INT64_MIN
 + 1;

12771 i‡(
›
 =
OP_ßr
)

12772 
v2
 = -v2;

12773 
ªt
 = 
	`bf_£t
(
r
, 
a
);

12774 
ªt
 |
	`bf_mul_2exp
(
r
, 
v2
, 
BF_PREC_INF
, 
BF_RNDZ
);

12775 i‡(
v2
 < 0) {

12776 
ªt
 |
	`bf_röt
(
r
, 
BF_RNDD
Ë& (
BF_ST_OVERFLOW
 | 
BF_ST_MEM_ERROR
);

12780 
OP_™d
:

12781 
ªt
 = 
	`bf_logic_™d
(
r
, 
a
, 
b
);

12783 
OP_‹
:

12784 
ªt
 = 
	`bf_logic_‹
(
r
, 
a
, 
b
);

12786 
OP_x‹
:

12787 
ªt
 = 
	`bf_logic_x‹
(
r
, 
a
, 
b
);

12790 
	`ab‹t
();

12792 
	`JS_FªeBigI¡
(
˘x
, 
a
, &
a_s
);

12793 
	`JS_FªeBigI¡
(
˘x
, 
b
, &
b_s
);

12794 
	`JS_FªeVÆue
(
˘x
, 
›1
);

12795 
	`JS_FªeVÆue
(
˘x
, 
›2
);

12796 i‡(
	`u∆ikñy
(
ªt
)) {

12797 
	`JS_FªeVÆue
(
˘x
, 
ªs
);

12798 
	`throw_bf_ex˚±i⁄
(
˘x
, 
ªt
);

12801 *
¥es
 = 
	`JS_Com∑˘BigI¡
(
˘x
, 
ªs
);

12803 
Áû
:

12804 
	`JS_FªeVÆue
(
˘x
, 
ªs
);

12805 
	`JS_FªeVÆue
(
˘x
, 
›1
);

12806 
	`JS_FªeVÆue
(
˘x
, 
›2
);

12808 
	}
}

12811 
	$js_bfdec_pow
(
bfdec_t
 *
r
, c⁄° bfdec_à*
a
, c⁄° bfdec_à*
b
)

12813 
bfdec_t
 
b1
;

12814 
öt32_t
 
b2
;

12815 
ªt
;

12817 
	`bfdec_öô
(
b
->
˘x
, &
b1
);

12818 
ªt
 = 
	`bfdec_£t
(&
b1
, 
b
);

12819 i‡(
ªt
) {

12820 
	`bfdec_dñëe
(&
b1
);

12821  
ªt
;

12823 
ªt
 = 
	`bfdec_röt
(&
b1
, 
BF_RNDZ
);

12824 i‡(
ªt
) {

12825 
	`bfdec_dñëe
(&
b1
);

12826  
BF_ST_INVALID_OP
;

12828 
ªt
 = 
	`bfdec_gë_öt32
(&
b2
, &
b1
);

12829 
	`bfdec_dñëe
(&
b1
);

12830 i‡(
ªt
)

12831  
ªt
;

12832 i‡(
b2
 < 0)

12833  
BF_ST_INVALID_OP
;

12834  
	`bfdec_pow_ui
(
r
, 
a
, 
b2
);

12835 
	}
}

12837 
	$js_bö¨y_¨ôh_bigdecimÆ
(
JSC⁄ãxt
 *
˘x
, 
OPCodeEnum
 
›
,

12838 
JSVÆue
 *
¥es
, JSVÆuê
›1
, JSVÆuê
›2
)

12840 
bfdec_t
 *
r
, *
a
, *
b
;

12841 
ªt
;

12842 
JSVÆue
 
ªs
;

12844 
ªs
 = 
	`JS_NewBigDecimÆ
(
˘x
);

12845 i‡(
	`JS_IsEx˚±i⁄
(
ªs
))

12846 
Áû
;

12847 
r
 = 
	`JS_GëBigDecimÆ
(
ªs
);

12849 
a
 = 
	`JS_ToBigDecimÆ
(
˘x
, 
›1
);

12850 i‡(!
a
)

12851 
Áû
;

12852 
b
 = 
	`JS_ToBigDecimÆ
(
˘x
, 
›2
);

12853 i‡(!
b
)

12854 
Áû
;

12855 
›
) {

12856 
OP_add
:

12857 
ªt
 = 
	`bfdec_add
(
r
, 
a
, 
b
, 
BF_PREC_INF
, 
BF_RNDZ
);

12859 
OP_sub
:

12860 
ªt
 = 
	`bfdec_sub
(
r
, 
a
, 
b
, 
BF_PREC_INF
, 
BF_RNDZ
);

12862 
OP_mul
:

12863 
ªt
 = 
	`bfdec_mul
(
r
, 
a
, 
b
, 
BF_PREC_INF
, 
BF_RNDZ
);

12865 
OP_div
:

12866 
ªt
 = 
	`bfdec_div
(
r
, 
a
, 
b
, 
BF_PREC_INF
, 
BF_RNDZ
);

12868 
OP_m©h_mod
:

12870 
ªt
 = 
	`bfdec_ªm
(
r
, 
a
, 
b
, 
BF_PREC_INF
, 
BF_RNDZ
, 
BF_DIVREM_EUCLIDIAN
);

12872 
OP_mod
:

12873 
ªt
 = 
	`bfdec_ªm
(
r
, 
a
, 
b
, 
BF_PREC_INF
, 
BF_RNDZ
, BF_RNDZ);

12875 
OP_pow
:

12876 
ªt
 = 
	`js_bfdec_pow
(
r
, 
a
, 
b
);

12879 
	`ab‹t
();

12881 
	`JS_FªeVÆue
(
˘x
, 
›1
);

12882 
	`JS_FªeVÆue
(
˘x
, 
›2
);

12883 i‡(
	`u∆ikñy
(
ªt
)) {

12884 
	`JS_FªeVÆue
(
˘x
, 
ªs
);

12885 
	`throw_bf_ex˚±i⁄
(
˘x
, 
ªt
);

12888 *
¥es
 = 
ªs
;

12890 
Áû
:

12891 
	`JS_FªeVÆue
(
˘x
, 
ªs
);

12892 
	`JS_FªeVÆue
(
˘x
, 
›1
);

12893 
	`JS_FªeVÆue
(
˘x
, 
›2
);

12895 
	}
}

12897 
no_ölöe
 
__ex˚±i⁄
 
	$js_bö¨y_¨ôh_¶ow
(
JSC⁄ãxt
 *
˘x
, 
JSVÆue
 *
•
,

12898 
OPCodeEnum
 
›
)

12900 
JSVÆue
 
›1
, 
›2
, 
ªs
;

12901 
uöt32_t
 
èg1
, 
èg2
;

12902 
ªt
;

12903 
d1
, 
d2
;

12905 
›1
 = 
•
[-2];

12906 
›2
 = 
•
[-1];

12907 
èg1
 = 
	`JS_VALUE_GET_NORM_TAG
(
›1
);

12908 
èg2
 = 
	`JS_VALUE_GET_NORM_TAG
(
›2
);

12910 i‡(
èg1
 =
JS_TAG_FLOAT64
 && 
èg2
 == JS_TAG_FLOAT64) {

12911 
d1
 = 
	`JS_VALUE_GET_FLOAT64
(
›1
);

12912 
d2
 = 
	`JS_VALUE_GET_FLOAT64
(
›2
);

12913 
h™dÀ_Êﬂt64
;

12917 i‡((
èg1
 =
JS_TAG_OBJECT
 &&

12918 (
èg2
 !
JS_TAG_NULL
 &&Åag2 !
JS_TAG_UNDEFINED
)) ||

12919 (
èg2
 =
JS_TAG_OBJECT
 &&

12920 (
èg1
 !
JS_TAG_NULL
 &&Åag1 !
JS_TAG_UNDEFINED
))) {

12921 
ªt
 = 
	`js_ˇŒ_bö¨y_›_ÁŒback
(
˘x
, &
ªs
, 
›1
, 
›2
, 
›
, 
TRUE
, 0);

12922 i‡(
ªt
 != 0) {

12923 
	`JS_FªeVÆue
(
˘x
, 
›1
);

12924 
	`JS_FªeVÆue
(
˘x
, 
›2
);

12925 i‡(
ªt
 < 0) {

12926 
ex˚±i⁄
;

12928 
•
[-2] = 
ªs
;

12934 
›1
 = 
	`JS_ToNumîicFªe
(
˘x
, op1);

12935 i‡(
	`JS_IsEx˚±i⁄
(
›1
)) {

12936 
	`JS_FªeVÆue
(
˘x
, 
›2
);

12937 
ex˚±i⁄
;

12939 
›2
 = 
	`JS_ToNumîicFªe
(
˘x
, op2);

12940 i‡(
	`JS_IsEx˚±i⁄
(
›2
)) {

12941 
	`JS_FªeVÆue
(
˘x
, 
›1
);

12942 
ex˚±i⁄
;

12944 
èg1
 = 
	`JS_VALUE_GET_NORM_TAG
(
›1
);

12945 
èg2
 = 
	`JS_VALUE_GET_NORM_TAG
(
›2
);

12947 i‡(
èg1
 =
JS_TAG_INT
 && 
èg2
 == JS_TAG_INT) {

12948 
öt32_t
 
v1
, 
v2
;

12949 
öt64_t
 
v
;

12950 
v1
 = 
	`JS_VALUE_GET_INT
(
›1
);

12951 
v2
 = 
	`JS_VALUE_GET_INT
(
›2
);

12952 
›
) {

12953 
OP_sub
:

12954 
v
 = (
öt64_t
)
v1
 - (öt64_t)
v2
;

12956 
OP_mul
:

12957 
v
 = (
öt64_t
)
v1
 * (öt64_t)
v2
;

12958 i‡(
	`is_m©h_mode
(
˘x
) &&

12959 (
v
 < -
MAX_SAFE_INTEGER
 || v > MAX_SAFE_INTEGER))

12960 
h™dÀ_bigöt
;

12961 i‡(
v
 =0 && (
v1
 | 
v2
) < 0) {

12962 
•
[-2] = 
	`__JS_NewFlﬂt64
(
˘x
, -0.0);

12966 
OP_div
:

12967 i‡(
	`is_m©h_mode
(
˘x
))

12968 
h™dÀ_bigöt
;

12969 
•
[-2] = 
	`__JS_NewFlﬂt64
(
˘x
, ()
v1
 / ()
v2
);

12971 
OP_m©h_mod
:

12972 i‡(
	`u∆ikñy
(
v2
 == 0)) {

12973 
	`throw_bf_ex˚±i⁄
(
˘x
, 
BF_ST_DIVIDE_ZERO
);

12974 
ex˚±i⁄
;

12976 
v
 = (
öt64_t
)
v1
 % (öt64_t)
v2
;

12977 i‡(
v
 < 0) {

12978 i‡(
v2
 < 0)

12979 
v
 -
v2
;

12981 
v
 +
v2
;

12984 
OP_mod
:

12985 i‡(
v1
 < 0 || 
v2
 <= 0) {

12986 
•
[-2] = 
	`JS_NewFlﬂt64
(
˘x
, 
	`fmod
(
v1
, 
v2
));

12989 
v
 = (
öt64_t
)
v1
 % (öt64_t)
v2
;

12992 
OP_pow
:

12993 i‡(!
	`is_m©h_mode
(
˘x
)) {

12994 
•
[-2] = 
	`JS_NewFlﬂt64
(
˘x
, 
	`js_pow
(
v1
, 
v2
));

12997 
h™dÀ_bigöt
;

13001 
	`ab‹t
();

13003 
•
[-2] = 
	`JS_NewI¡64
(
˘x
, 
v
);

13004 } i‡(
èg1
 =
JS_TAG_BIG_DECIMAL
 || 
èg2
 == JS_TAG_BIG_DECIMAL) {

13005 i‡(
˘x
->
π
->
bigdecimÆ_›s
.
	`bö¨y_¨ôh
(˘x, 
›
, 
•
 - 2, 
›1
, 
›2
))

13006 
ex˚±i⁄
;

13007 } i‡(
èg1
 =
JS_TAG_BIG_FLOAT
 || 
èg2
 == JS_TAG_BIG_FLOAT) {

13008 i‡(
˘x
->
π
->
bigÊﬂt_›s
.
	`bö¨y_¨ôh
(˘x, 
›
, 
•
 - 2, 
›1
, 
›2
))

13009 
ex˚±i⁄
;

13010 } i‡(
èg1
 =
JS_TAG_BIG_INT
 || 
èg2
 == JS_TAG_BIG_INT) {

13011 
h™dÀ_bigöt
:

13012 i‡(
˘x
->
π
->
bigöt_›s
.
	`bö¨y_¨ôh
(˘x, 
›
, 
•
 - 2, 
›1
, 
›2
))

13013 
ex˚±i⁄
;

13015 
dr
;

13017 i‡(
	`JS_ToFlﬂt64Fªe
(
˘x
, &
d1
, 
›1
)) {

13018 
	`JS_FªeVÆue
(
˘x
, 
›2
);

13019 
ex˚±i⁄
;

13021 i‡(
	`JS_ToFlﬂt64Fªe
(
˘x
, &
d2
, 
›2
))

13022 
ex˚±i⁄
;

13023 
h™dÀ_Êﬂt64
:

13024 i‡(
	`is_m©h_mode
(
˘x
Ë&& 
	`is_ß„_öãgî
(
d1
Ë&& is_ß„_öãgî(
d2
))

13025 
h™dÀ_bigöt
;

13026 
›
) {

13027 
OP_sub
:

13028 
dr
 = 
d1
 - 
d2
;

13030 
OP_mul
:

13031 
dr
 = 
d1
 * 
d2
;

13033 
OP_div
:

13034 
dr
 = 
d1
 / 
d2
;

13036 
OP_mod
:

13037 
dr
 = 
	`fmod
(
d1
, 
d2
);

13039 
OP_m©h_mod
:

13040 
d2
 = 
	`Ábs
(d2);

13041 
dr
 = 
	`fmod
(
d1
, 
d2
);

13043 i‡(
dr
 < 0)

13044 
dr
 +
d2
;

13046 
OP_pow
:

13047 
dr
 = 
	`js_pow
(
d1
, 
d2
);

13050 
	`ab‹t
();

13052 
•
[-2] = 
	`__JS_NewFlﬂt64
(
˘x
, 
dr
);

13055 
ex˚±i⁄
:

13056 
•
[-2] = 
JS_UNDEFINED
;

13057 
•
[-1] = 
JS_UNDEFINED
;

13059 
	}
}

13061 
no_ölöe
 
__ex˚±i⁄
 
	$js_add_¶ow
(
JSC⁄ãxt
 *
˘x
, 
JSVÆue
 *
•
)

13063 
JSVÆue
 
›1
, 
›2
, 
ªs
;

13064 
uöt32_t
 
èg1
, 
èg2
;

13065 
ªt
;

13067 
›1
 = 
•
[-2];

13068 
›2
 = 
•
[-1];

13070 
èg1
 = 
	`JS_VALUE_GET_NORM_TAG
(
›1
);

13071 
èg2
 = 
	`JS_VALUE_GET_NORM_TAG
(
›2
);

13073 i‡(
èg1
 =
JS_TAG_FLOAT64
 && 
èg2
 == JS_TAG_FLOAT64) {

13074 
d1
, 
d2
;

13075 
d1
 = 
	`JS_VALUE_GET_FLOAT64
(
›1
);

13076 
d2
 = 
	`JS_VALUE_GET_FLOAT64
(
›2
);

13077 
•
[-2] = 
	`__JS_NewFlﬂt64
(
˘x
, 
d1
 + 
d2
);

13081 i‡(
èg1
 =
JS_TAG_OBJECT
 || 
èg2
 == JS_TAG_OBJECT) {

13083 i‡((
èg1
 =
JS_TAG_OBJECT
 &&

13084 (
èg2
 !
JS_TAG_NULL
 &&Åag2 !
JS_TAG_UNDEFINED
 &&

13085 
èg2
 !
JS_TAG_STRING
)) ||

13086 (
èg2
 =
JS_TAG_OBJECT
 &&

13087 (
èg1
 !
JS_TAG_NULL
 &&Åag1 !
JS_TAG_UNDEFINED
 &&

13088 
èg1
 !
JS_TAG_STRING
))) {

13089 
ªt
 = 
	`js_ˇŒ_bö¨y_›_ÁŒback
(
˘x
, &
ªs
, 
›1
, 
›2
, 
OP_add
,

13090 
FALSE
, 
HINT_NONE
);

13091 i‡(
ªt
 != 0) {

13092 
	`JS_FªeVÆue
(
˘x
, 
›1
);

13093 
	`JS_FªeVÆue
(
˘x
, 
›2
);

13094 i‡(
ªt
 < 0) {

13095 
ex˚±i⁄
;

13097 
•
[-2] = 
ªs
;

13103 
›1
 = 
	`JS_ToPrimôiveFªe
(
˘x
, op1, 
HINT_NONE
);

13104 i‡(
	`JS_IsEx˚±i⁄
(
›1
)) {

13105 
	`JS_FªeVÆue
(
˘x
, 
›2
);

13106 
ex˚±i⁄
;

13109 
›2
 = 
	`JS_ToPrimôiveFªe
(
˘x
, op2, 
HINT_NONE
);

13110 i‡(
	`JS_IsEx˚±i⁄
(
›2
)) {

13111 
	`JS_FªeVÆue
(
˘x
, 
›1
);

13112 
ex˚±i⁄
;

13114 
èg1
 = 
	`JS_VALUE_GET_NORM_TAG
(
›1
);

13115 
èg2
 = 
	`JS_VALUE_GET_NORM_TAG
(
›2
);

13118 i‡(
èg1
 =
JS_TAG_STRING
 || 
èg2
 == JS_TAG_STRING) {

13119 
•
[-2] = 
	`JS_C⁄ˇtSåög
(
˘x
, 
›1
, 
›2
);

13120 i‡(
	`JS_IsEx˚±i⁄
(
•
[-2]))

13121 
ex˚±i⁄
;

13125 
›1
 = 
	`JS_ToNumîicFªe
(
˘x
, op1);

13126 i‡(
	`JS_IsEx˚±i⁄
(
›1
)) {

13127 
	`JS_FªeVÆue
(
˘x
, 
›2
);

13128 
ex˚±i⁄
;

13130 
›2
 = 
	`JS_ToNumîicFªe
(
˘x
, op2);

13131 i‡(
	`JS_IsEx˚±i⁄
(
›2
)) {

13132 
	`JS_FªeVÆue
(
˘x
, 
›1
);

13133 
ex˚±i⁄
;

13135 
èg1
 = 
	`JS_VALUE_GET_NORM_TAG
(
›1
);

13136 
èg2
 = 
	`JS_VALUE_GET_NORM_TAG
(
›2
);

13138 i‡(
èg1
 =
JS_TAG_INT
 && 
èg2
 == JS_TAG_INT) {

13139 
öt32_t
 
v1
, 
v2
;

13140 
öt64_t
 
v
;

13141 
v1
 = 
	`JS_VALUE_GET_INT
(
›1
);

13142 
v2
 = 
	`JS_VALUE_GET_INT
(
›2
);

13143 
v
 = (
öt64_t
)
v1
 + (öt64_t)
v2
;

13144 
•
[-2] = 
	`JS_NewI¡64
(
˘x
, 
v
);

13145 } i‡(
èg1
 =
JS_TAG_BIG_DECIMAL
 || 
èg2
 == JS_TAG_BIG_DECIMAL) {

13146 i‡(
˘x
->
π
->
bigdecimÆ_›s
.
	`bö¨y_¨ôh
(˘x, 
OP_add
, 
•
 - 2, 
›1
, 
›2
))

13147 
ex˚±i⁄
;

13148 } i‡(
èg1
 =
JS_TAG_BIG_FLOAT
 || 
èg2
 == JS_TAG_BIG_FLOAT) {

13149 i‡(
˘x
->
π
->
bigÊﬂt_›s
.
	`bö¨y_¨ôh
(˘x, 
OP_add
, 
•
 - 2, 
›1
, 
›2
))

13150 
ex˚±i⁄
;

13151 } i‡(
èg1
 =
JS_TAG_BIG_INT
 || 
èg2
 == JS_TAG_BIG_INT) {

13152 
h™dÀ_bigöt
:

13153 i‡(
˘x
->
π
->
bigöt_›s
.
	`bö¨y_¨ôh
(˘x, 
OP_add
, 
•
 - 2, 
›1
, 
›2
))

13154 
ex˚±i⁄
;

13156 
d1
, 
d2
;

13158 i‡(
	`JS_ToFlﬂt64Fªe
(
˘x
, &
d1
, 
›1
)) {

13159 
	`JS_FªeVÆue
(
˘x
, 
›2
);

13160 
ex˚±i⁄
;

13162 i‡(
	`JS_ToFlﬂt64Fªe
(
˘x
, &
d2
, 
›2
))

13163 
ex˚±i⁄
;

13164 i‡(
	`is_m©h_mode
(
˘x
Ë&& 
	`is_ß„_öãgî
(
d1
Ë&& is_ß„_öãgî(
d2
))

13165 
h™dÀ_bigöt
;

13166 
•
[-2] = 
	`__JS_NewFlﬂt64
(
˘x
, 
d1
 + 
d2
);

13169 
ex˚±i⁄
:

13170 
•
[-2] = 
JS_UNDEFINED
;

13171 
•
[-1] = 
JS_UNDEFINED
;

13173 
	}
}

13175 
no_ölöe
 
__ex˚±i⁄
 
	$js_bö¨y_logic_¶ow
(
JSC⁄ãxt
 *
˘x
,

13176 
JSVÆue
 *
•
,

13177 
OPCodeEnum
 
›
)

13179 
JSVÆue
 
›1
, 
›2
, 
ªs
;

13180 
ªt
;

13181 
uöt32_t
 
èg1
, 
èg2
;

13182 
uöt32_t
 
v1
, 
v2
, 
r
;

13184 
›1
 = 
•
[-2];

13185 
›2
 = 
•
[-1];

13186 
èg1
 = 
	`JS_VALUE_GET_NORM_TAG
(
›1
);

13187 
èg2
 = 
	`JS_VALUE_GET_NORM_TAG
(
›2
);

13190 i‡((
èg1
 =
JS_TAG_OBJECT
 &&

13191 (
èg2
 !
JS_TAG_NULL
 &&Åag2 !
JS_TAG_UNDEFINED
)) ||

13192 (
èg2
 =
JS_TAG_OBJECT
 &&

13193 (
èg1
 !
JS_TAG_NULL
 &&Åag1 !
JS_TAG_UNDEFINED
))) {

13194 
ªt
 = 
	`js_ˇŒ_bö¨y_›_ÁŒback
(
˘x
, &
ªs
, 
›1
, 
›2
, 
›
, 
TRUE
, 0);

13195 i‡(
ªt
 != 0) {

13196 
	`JS_FªeVÆue
(
˘x
, 
›1
);

13197 
	`JS_FªeVÆue
(
˘x
, 
›2
);

13198 i‡(
ªt
 < 0) {

13199 
ex˚±i⁄
;

13201 
•
[-2] = 
ªs
;

13207 
›1
 = 
	`JS_ToNumîicFªe
(
˘x
, op1);

13208 i‡(
	`JS_IsEx˚±i⁄
(
›1
)) {

13209 
	`JS_FªeVÆue
(
˘x
, 
›2
);

13210 
ex˚±i⁄
;

13212 
›2
 = 
	`JS_ToNumîicFªe
(
˘x
, op2);

13213 i‡(
	`JS_IsEx˚±i⁄
(
›2
)) {

13214 
	`JS_FªeVÆue
(
˘x
, 
›1
);

13215 
ex˚±i⁄
;

13218 i‡(
	`is_m©h_mode
(
˘x
))

13219 
bigöt_›
;

13221 
èg1
 = 
	`JS_VALUE_GET_TAG
(
›1
);

13222 
èg2
 = 
	`JS_VALUE_GET_TAG
(
›2
);

13223 i‡(
èg1
 =
JS_TAG_BIG_INT
 || 
èg2
 == JS_TAG_BIG_INT) {

13224 i‡(
èg1
 !
èg2
) {

13225 
	`JS_FªeVÆue
(
˘x
, 
›1
);

13226 
	`JS_FªeVÆue
(
˘x
, 
›2
);

13227 
	`JS_ThrowTy≥Eº‹
(
˘x
, "both operands must be bigint");

13228 
ex˚±i⁄
;

13230 
bigöt_›
:

13231 i‡(
˘x
->
π
->
bigöt_›s
.
	`bö¨y_¨ôh
(˘x, 
›
, 
•
 - 2, 
›1
, 
›2
))

13232 
ex˚±i⁄
;

13235 i‡(
	`u∆ikñy
(
	`JS_ToI¡32Fªe
(
˘x
, (
öt32_t
 *)&
v1
, 
›1
))) {

13236 
	`JS_FªeVÆue
(
˘x
, 
›2
);

13237 
ex˚±i⁄
;

13239 i‡(
	`u∆ikñy
(
	`JS_ToI¡32Fªe
(
˘x
, (
öt32_t
 *)&
v2
, 
›2
)))

13240 
ex˚±i⁄
;

13241 
›
) {

13242 
OP_shl
:

13243 
r
 = 
v1
 << (
v2
 & 0x1f);

13245 
OP_ßr
:

13246 
r
 = ()
v1
 >> (
v2
 & 0x1f);

13248 
OP_™d
:

13249 
r
 = 
v1
 & 
v2
;

13251 
OP_‹
:

13252 
r
 = 
v1
 | 
v2
;

13254 
OP_x‹
:

13255 
r
 = 
v1
 ^ 
v2
;

13258 
	`ab‹t
();

13260 
•
[-2] = 
	`JS_NewI¡32
(
˘x
, 
r
);

13263 
ex˚±i⁄
:

13264 
•
[-2] = 
JS_UNDEFINED
;

13265 
•
[-1] = 
JS_UNDEFINED
;

13267 
	}
}

13270 
	$js_com∑ª_bigÊﬂt
(
JSC⁄ãxt
 *
˘x
, 
OPCodeEnum
 
›
,

13271 
JSVÆue
 
›1
, JSVÆuê
›2
)

13273 
bf_t
 
a_s
, 
b_s
, *
a
, *
b
;

13274 
ªs
;

13276 
a
 = 
	`JS_ToBigFlﬂt
(
˘x
, &
a_s
, 
›1
);

13277 i‡(!
a
) {

13278 
	`JS_FªeVÆue
(
˘x
, 
›2
);

13281 
b
 = 
	`JS_ToBigFlﬂt
(
˘x
, &
b_s
, 
›2
);

13282 i‡(!
b
) {

13283 i‡(
a
 =&
a_s
)

13284 
	`bf_dñëe
(
a
);

13285 
	`JS_FªeVÆue
(
˘x
, 
›1
);

13288 
›
) {

13289 
OP_…
:

13290 
ªs
 = 
	`bf_cmp_…
(
a
, 
b
);

13292 
OP_…e
:

13293 
ªs
 = 
	`bf_cmp_À
(
a
, 
b
);

13295 
OP_gt
:

13296 
ªs
 = 
	`bf_cmp_…
(
b
, 
a
);

13298 
OP_gã
:

13299 
ªs
 = 
	`bf_cmp_À
(
b
, 
a
);

13301 
OP_eq
:

13302 
ªs
 = 
	`bf_cmp_eq
(
a
, 
b
);

13305 
	`ab‹t
();

13307 i‡(
a
 =&
a_s
)

13308 
	`bf_dñëe
(
a
);

13309 i‡(
b
 =&
b_s
)

13310 
	`bf_dñëe
(
b
);

13311 
	`JS_FªeVÆue
(
˘x
, 
›1
);

13312 
	`JS_FªeVÆue
(
˘x
, 
›2
);

13313  
ªs
;

13314 
	}
}

13316 
	$js_com∑ª_bigdecimÆ
(
JSC⁄ãxt
 *
˘x
, 
OPCodeEnum
 
›
,

13317 
JSVÆue
 
›1
, JSVÆuê
›2
)

13319 
bfdec_t
 *
a
, *
b
;

13320 
ªs
;

13325 
›1
 = 
	`JS_ToBigDecimÆFªe
(
˘x
, op1, 
TRUE
);

13326 i‡(
	`JS_IsEx˚±i⁄
(
›1
)) {

13327 
	`JS_FªeVÆue
(
˘x
, 
›2
);

13330 
›2
 = 
	`JS_ToBigDecimÆFªe
(
˘x
, op2, 
TRUE
);

13331 i‡(
	`JS_IsEx˚±i⁄
(
›2
)) {

13332 
	`JS_FªeVÆue
(
˘x
, 
›1
);

13335 
a
 = 
	`JS_ToBigDecimÆ
(
˘x
, 
›1
);

13336 
b
 = 
	`JS_ToBigDecimÆ
(
˘x
, 
›2
);

13338 
›
) {

13339 
OP_…
:

13340 
ªs
 = 
	`bfdec_cmp_…
(
a
, 
b
);

13342 
OP_…e
:

13343 
ªs
 = 
	`bfdec_cmp_À
(
a
, 
b
);

13345 
OP_gt
:

13346 
ªs
 = 
	`bfdec_cmp_…
(
b
, 
a
);

13348 
OP_gã
:

13349 
ªs
 = 
	`bfdec_cmp_À
(
b
, 
a
);

13351 
OP_eq
:

13352 
ªs
 = 
	`bfdec_cmp_eq
(
a
, 
b
);

13355 
	`ab‹t
();

13357 
	`JS_FªeVÆue
(
˘x
, 
›1
);

13358 
	`JS_FªeVÆue
(
˘x
, 
›2
);

13359  
ªs
;

13360 
	}
}

13362 
no_ölöe
 
	$js_ªœti⁄Æ_¶ow
(
JSC⁄ãxt
 *
˘x
, 
JSVÆue
 *
•
,

13363 
OPCodeEnum
 
›
)

13365 
JSVÆue
 
›1
, 
›2
, 
ªt
;

13366 
ªs
;

13367 
uöt32_t
 
èg1
, 
èg2
;

13369 
›1
 = 
•
[-2];

13370 
›2
 = 
•
[-1];

13371 
èg1
 = 
	`JS_VALUE_GET_NORM_TAG
(
›1
);

13372 
èg2
 = 
	`JS_VALUE_GET_NORM_TAG
(
›2
);

13374 i‡((
èg1
 =
JS_TAG_OBJECT
 &&

13375 (
èg2
 !
JS_TAG_NULL
 &&Åag2 !
JS_TAG_UNDEFINED
)) ||

13376 (
èg2
 =
JS_TAG_OBJECT
 &&

13377 (
èg1
 !
JS_TAG_NULL
 &&Åag1 !
JS_TAG_UNDEFINED
))) {

13378 
ªs
 = 
	`js_ˇŒ_bö¨y_›_ÁŒback
(
˘x
, &
ªt
, 
›1
, 
›2
, 
›
,

13379 
FALSE
, 
HINT_NUMBER
);

13380 i‡(
ªs
 != 0) {

13381 
	`JS_FªeVÆue
(
˘x
, 
›1
);

13382 
	`JS_FªeVÆue
(
˘x
, 
›2
);

13383 i‡(
ªs
 < 0) {

13384 
ex˚±i⁄
;

13386 
•
[-2] = 
ªt
;

13391 
›1
 = 
	`JS_ToPrimôiveFªe
(
˘x
, op1, 
HINT_NUMBER
);

13392 i‡(
	`JS_IsEx˚±i⁄
(
›1
)) {

13393 
	`JS_FªeVÆue
(
˘x
, 
›2
);

13394 
ex˚±i⁄
;

13396 
›2
 = 
	`JS_ToPrimôiveFªe
(
˘x
, op2, 
HINT_NUMBER
);

13397 i‡(
	`JS_IsEx˚±i⁄
(
›2
)) {

13398 
	`JS_FªeVÆue
(
˘x
, 
›1
);

13399 
ex˚±i⁄
;

13401 
èg1
 = 
	`JS_VALUE_GET_NORM_TAG
(
›1
);

13402 
èg2
 = 
	`JS_VALUE_GET_NORM_TAG
(
›2
);

13404 i‡(
èg1
 =
JS_TAG_STRING
 && 
èg2
 == JS_TAG_STRING) {

13405 
JSSåög
 *
p1
, *
p2
;

13406 
p1
 = 
	`JS_VALUE_GET_STRING
(
›1
);

13407 
p2
 = 
	`JS_VALUE_GET_STRING
(
›2
);

13408 
ªs
 = 
	`js_°rög_com∑ª
(
˘x
, 
p1
, 
p2
);

13409 
›
) {

13410 
OP_…
:

13411 
ªs
 = (res < 0);

13413 
OP_…e
:

13414 
ªs
 = (res <= 0);

13416 
OP_gt
:

13417 
ªs
 = (res > 0);

13420 
OP_gã
:

13421 
ªs
 = (res >= 0);

13424 
	`JS_FªeVÆue
(
˘x
, 
›1
);

13425 
	`JS_FªeVÆue
(
˘x
, 
›2
);

13426 } i‡((
èg1
 <
JS_TAG_NULL
 ||Åag1 =
JS_TAG_FLOAT64
) &&

13427 (
èg2
 <
JS_TAG_NULL
 ||Åag2 =
JS_TAG_FLOAT64
)) {

13429 
d1
, 
d2
;

13430 i‡(
èg1
 =
JS_TAG_FLOAT64
) {

13431 
d1
 = 
	`JS_VALUE_GET_FLOAT64
(
›1
);

13433 
d1
 = 
	`JS_VALUE_GET_INT
(
›1
);

13435 i‡(
èg2
 =
JS_TAG_FLOAT64
) {

13436 
d2
 = 
	`JS_VALUE_GET_FLOAT64
(
›2
);

13438 
d2
 = 
	`JS_VALUE_GET_INT
(
›2
);

13440 
›
) {

13441 
OP_…
:

13442 
ªs
 = (
d1
 < 
d2
);

13444 
OP_…e
:

13445 
ªs
 = (
d1
 <
d2
);

13447 
OP_gt
:

13448 
ªs
 = (
d1
 > 
d2
);

13451 
OP_gã
:

13452 
ªs
 = (
d1
 >
d2
);

13456 i‡(((
èg1
 =
JS_TAG_BIG_INT
 && 
èg2
 =
JS_TAG_STRING
) ||

13457 (
èg2
 =
JS_TAG_BIG_INT
 && 
èg1
 =
JS_TAG_STRING
)) &&

13458 !
	`is_m©h_mode
(
˘x
)) {

13459 i‡(
èg1
 =
JS_TAG_STRING
) {

13460 
›1
 = 
	`JS_SåögToBigI¡
(
˘x
, op1);

13461 i‡(
	`JS_VALUE_GET_TAG
(
›1
Ë!
JS_TAG_BIG_INT
)

13462 
övÆid_bigöt_°rög
;

13464 i‡(
èg2
 =
JS_TAG_STRING
) {

13465 
›2
 = 
	`JS_SåögToBigI¡
(
˘x
, op2);

13466 i‡(
	`JS_VALUE_GET_TAG
(
›2
Ë!
JS_TAG_BIG_INT
) {

13467 
övÆid_bigöt_°rög
:

13468 
	`JS_FªeVÆue
(
˘x
, 
›1
);

13469 
	`JS_FªeVÆue
(
˘x
, 
›2
);

13470 
ªs
 = 
FALSE
;

13471 
d⁄e
;

13475 
›1
 = 
	`JS_ToNumîicFªe
(
˘x
, op1);

13476 i‡(
	`JS_IsEx˚±i⁄
(
›1
)) {

13477 
	`JS_FªeVÆue
(
˘x
, 
›2
);

13478 
ex˚±i⁄
;

13480 
›2
 = 
	`JS_ToNumîicFªe
(
˘x
, op2);

13481 i‡(
	`JS_IsEx˚±i⁄
(
›2
)) {

13482 
	`JS_FªeVÆue
(
˘x
, 
›1
);

13483 
ex˚±i⁄
;

13487 i‡(
	`JS_VALUE_GET_TAG
(
›1
Ë=
JS_TAG_BIG_DECIMAL
 ||

13488 
	`JS_VALUE_GET_TAG
(
›2
Ë=
JS_TAG_BIG_DECIMAL
) {

13489 
ªs
 = 
˘x
->
π
->
bigdecimÆ_›s
.
	`com∑ª
(˘x, 
›
, 
›1
, 
›2
);

13490 i‡(
ªs
 < 0)

13491 
ex˚±i⁄
;

13492 } i‡(
	`JS_VALUE_GET_TAG
(
›1
Ë=
JS_TAG_BIG_FLOAT
 ||

13493 
	`JS_VALUE_GET_TAG
(
›2
Ë=
JS_TAG_BIG_FLOAT
) {

13494 
ªs
 = 
˘x
->
π
->
bigÊﬂt_›s
.
	`com∑ª
(˘x, 
›
, 
›1
, 
›2
);

13495 i‡(
ªs
 < 0)

13496 
ex˚±i⁄
;

13498 
ªs
 = 
˘x
->
π
->
bigöt_›s
.
	`com∑ª
(˘x, 
›
, 
›1
, 
›2
);

13499 i‡(
ªs
 < 0)

13500 
ex˚±i⁄
;

13503 
d⁄e
:

13504 
•
[-2] = 
	`JS_NewBoﬁ
(
˘x
, 
ªs
);

13506 
ex˚±i⁄
:

13507 
•
[-2] = 
JS_UNDEFINED
;

13508 
•
[-1] = 
JS_UNDEFINED
;

13510 
	}
}

13512 
BOOL
 
	$èg_is_numbî
(
uöt32_t
 
èg
)

13514  (
èg
 =
JS_TAG_INT
 ||Åag =
JS_TAG_BIG_INT
 ||

13515 
èg
 =
JS_TAG_FLOAT64
 ||Åag =
JS_TAG_BIG_FLOAT
 ||

13516 
èg
 =
JS_TAG_BIG_DECIMAL
);

13517 
	}
}

13519 
no_ölöe
 
__ex˚±i⁄
 
	$js_eq_¶ow
(
JSC⁄ãxt
 *
˘x
, 
JSVÆue
 *
•
,

13520 
BOOL
 
is_√q
)

13522 
JSVÆue
 
›1
, 
›2
, 
ªt
;

13523 
ªs
;

13524 
uöt32_t
 
èg1
, 
èg2
;

13526 
›1
 = 
•
[-2];

13527 
›2
 = 
•
[-1];

13528 
ªdo
:

13529 
èg1
 = 
	`JS_VALUE_GET_NORM_TAG
(
›1
);

13530 
èg2
 = 
	`JS_VALUE_GET_NORM_TAG
(
›2
);

13531 i‡(
	`èg_is_numbî
(
èg1
Ë&&Åag_is_numbî(
èg2
)) {

13532 i‡(
èg1
 =
JS_TAG_INT
 && 
èg2
 == JS_TAG_INT) {

13533 
ªs
 = 
	`JS_VALUE_GET_INT
(
›1
Ë=JS_VALUE_GET_INT(
›2
);

13534 } i‡((
èg1
 =
JS_TAG_FLOAT64
 &&

13535 (
èg2
 =
JS_TAG_INT
 ||Åag2 =
JS_TAG_FLOAT64
)) ||

13536 (
èg2
 =
JS_TAG_FLOAT64
 &&

13537 (
èg1
 =
JS_TAG_INT
 ||Åag1 =
JS_TAG_FLOAT64
))) {

13538 
d1
, 
d2
;

13539 i‡(
èg1
 =
JS_TAG_FLOAT64
) {

13540 
d1
 = 
	`JS_VALUE_GET_FLOAT64
(
›1
);

13542 
d1
 = 
	`JS_VALUE_GET_INT
(
›1
);

13544 i‡(
èg2
 =
JS_TAG_FLOAT64
) {

13545 
d2
 = 
	`JS_VALUE_GET_FLOAT64
(
›2
);

13547 
d2
 = 
	`JS_VALUE_GET_INT
(
›2
);

13549 
ªs
 = (
d1
 =
d2
);

13550 } i‡(
èg1
 =
JS_TAG_BIG_DECIMAL
 || 
èg2
 == JS_TAG_BIG_DECIMAL) {

13551 
ªs
 = 
˘x
->
π
->
bigdecimÆ_›s
.
	`com∑ª
(˘x, 
OP_eq
, 
›1
, 
›2
);

13552 i‡(
ªs
 < 0)

13553 
ex˚±i⁄
;

13554 } i‡(
èg1
 =
JS_TAG_BIG_FLOAT
 || 
èg2
 == JS_TAG_BIG_FLOAT) {

13555 
ªs
 = 
˘x
->
π
->
bigÊﬂt_›s
.
	`com∑ª
(˘x, 
OP_eq
, 
›1
, 
›2
);

13556 i‡(
ªs
 < 0)

13557 
ex˚±i⁄
;

13559 
ªs
 = 
˘x
->
π
->
bigöt_›s
.
	`com∑ª
(˘x, 
OP_eq
, 
›1
, 
›2
);

13560 i‡(
ªs
 < 0)

13561 
ex˚±i⁄
;

13563 } i‡(
èg1
 =
èg2
) {

13564 i‡(
èg1
 =
JS_TAG_OBJECT
) {

13566 
ªs
 = 
	`js_ˇŒ_bö¨y_›_ÁŒback
(
˘x
, &
ªt
, 
›1
, 
›2
,

13567 
is_√q
 ? 
OP_√q
 : 
OP_eq
,

13568 
FALSE
, 
HINT_NONE
);

13569 i‡(
ªs
 != 0) {

13570 
	`JS_FªeVÆue
(
˘x
, 
›1
);

13571 
	`JS_FªeVÆue
(
˘x
, 
›2
);

13572 i‡(
ªs
 < 0) {

13573 
ex˚±i⁄
;

13575 
•
[-2] = 
ªt
;

13580 
ªs
 = 
	`js_°ri˘_eq2
(
˘x
, 
›1
, 
›2
, 
JS_EQ_STRICT
);

13581 } i‡((
èg1
 =
JS_TAG_NULL
 && 
èg2
 =
JS_TAG_UNDEFINED
) ||

13582 (
èg2
 =
JS_TAG_NULL
 && 
èg1
 =
JS_TAG_UNDEFINED
)) {

13583 
ªs
 = 
TRUE
;

13584 } i‡((
èg1
 =
JS_TAG_STRING
 && 
	`èg_is_numbî
(
èg2
)) ||

13585 (
èg2
 =
JS_TAG_STRING
 && 
	`èg_is_numbî
(
èg1
))) {

13587 i‡((
èg1
 =
JS_TAG_BIG_INT
 || 
èg2
 == JS_TAG_BIG_INT) &&

13588 !
	`is_m©h_mode
(
˘x
)) {

13589 i‡(
èg1
 =
JS_TAG_STRING
) {

13590 
›1
 = 
	`JS_SåögToBigI¡
(
˘x
, op1);

13591 i‡(
	`JS_VALUE_GET_TAG
(
›1
Ë!
JS_TAG_BIG_INT
)

13592 
övÆid_bigöt_°rög
;

13594 i‡(
èg2
 =
JS_TAG_STRING
) {

13595 
›2
 = 
	`JS_SåögToBigI¡
(
˘x
, op2);

13596 i‡(
	`JS_VALUE_GET_TAG
(
›2
Ë!
JS_TAG_BIG_INT
) {

13597 
övÆid_bigöt_°rög
:

13598 
	`JS_FªeVÆue
(
˘x
, 
›1
);

13599 
	`JS_FªeVÆue
(
˘x
, 
›2
);

13600 
ªs
 = 
FALSE
;

13601 
d⁄e
;

13605 
›1
 = 
	`JS_ToNumîicFªe
(
˘x
, op1);

13606 i‡(
	`JS_IsEx˚±i⁄
(
›1
)) {

13607 
	`JS_FªeVÆue
(
˘x
, 
›2
);

13608 
ex˚±i⁄
;

13610 
›2
 = 
	`JS_ToNumîicFªe
(
˘x
, op2);

13611 i‡(
	`JS_IsEx˚±i⁄
(
›2
)) {

13612 
	`JS_FªeVÆue
(
˘x
, 
›1
);

13613 
ex˚±i⁄
;

13616 
ªs
 = 
	`js_°ri˘_eq
(
˘x
, 
›1
, 
›2
);

13617 } i‡(
èg1
 =
JS_TAG_BOOL
) {

13618 
›1
 = 
	`JS_NewI¡32
(
˘x
, 
	`JS_VALUE_GET_INT
(op1));

13619 
ªdo
;

13620 } i‡(
èg2
 =
JS_TAG_BOOL
) {

13621 
›2
 = 
	`JS_NewI¡32
(
˘x
, 
	`JS_VALUE_GET_INT
(op2));

13622 
ªdo
;

13623 } i‡((
èg1
 =
JS_TAG_OBJECT
 &&

13624 (
	`èg_is_numbî
(
èg2
Ë||Åag2 =
JS_TAG_STRING
 ||Åag2 =
JS_TAG_SYMBOL
)) ||

13625 (
èg2
 =
JS_TAG_OBJECT
 &&

13626 (
	`èg_is_numbî
(
èg1
Ë||Åag1 =
JS_TAG_STRING
 ||Åag1 =
JS_TAG_SYMBOL
))) {

13629 
ªs
 = 
	`js_ˇŒ_bö¨y_›_ÁŒback
(
˘x
, &
ªt
, 
›1
, 
›2
,

13630 
is_√q
 ? 
OP_√q
 : 
OP_eq
,

13631 
FALSE
, 
HINT_NONE
);

13632 i‡(
ªs
 != 0) {

13633 
	`JS_FªeVÆue
(
˘x
, 
›1
);

13634 
	`JS_FªeVÆue
(
˘x
, 
›2
);

13635 i‡(
ªs
 < 0) {

13636 
ex˚±i⁄
;

13638 
•
[-2] = 
ªt
;

13643 
›1
 = 
	`JS_ToPrimôiveFªe
(
˘x
, op1, 
HINT_NONE
);

13644 i‡(
	`JS_IsEx˚±i⁄
(
›1
)) {

13645 
	`JS_FªeVÆue
(
˘x
, 
›2
);

13646 
ex˚±i⁄
;

13648 
›2
 = 
	`JS_ToPrimôiveFªe
(
˘x
, op2, 
HINT_NONE
);

13649 i‡(
	`JS_IsEx˚±i⁄
(
›2
)) {

13650 
	`JS_FªeVÆue
(
˘x
, 
›1
);

13651 
ex˚±i⁄
;

13653 
ªdo
;

13655 
	`JS_FªeVÆue
(
˘x
, 
›1
);

13656 
	`JS_FªeVÆue
(
˘x
, 
›2
);

13657 
ªs
 = 
FALSE
;

13659 
d⁄e
:

13660 
•
[-2] = 
	`JS_NewBoﬁ
(
˘x
, 
ªs
 ^ 
is_√q
);

13662 
ex˚±i⁄
:

13663 
•
[-2] = 
JS_UNDEFINED
;

13664 
•
[-1] = 
JS_UNDEFINED
;

13666 
	}
}

13668 
no_ölöe
 
	$js_shr_¶ow
(
JSC⁄ãxt
 *
˘x
, 
JSVÆue
 *
•
)

13670 
JSVÆue
 
›1
, 
›2
;

13671 
uöt32_t
 
v1
, 
v2
, 
r
;

13673 
›1
 = 
•
[-2];

13674 
›2
 = 
•
[-1];

13675 
›1
 = 
	`JS_ToNumîicFªe
(
˘x
, op1);

13676 i‡(
	`JS_IsEx˚±i⁄
(
›1
)) {

13677 
	`JS_FªeVÆue
(
˘x
, 
›2
);

13678 
ex˚±i⁄
;

13680 
›2
 = 
	`JS_ToNumîicFªe
(
˘x
, op2);

13681 i‡(
	`JS_IsEx˚±i⁄
(
›2
)) {

13682 
	`JS_FªeVÆue
(
˘x
, 
›1
);

13683 
ex˚±i⁄
;

13686 i‡(!
	`is_m©h_mode
(
˘x
) &&

13687 (
	`JS_VALUE_GET_TAG
(
›1
Ë=
JS_TAG_BIG_INT
 ||

13688 
	`JS_VALUE_GET_TAG
(
›2
Ë=
JS_TAG_BIG_INT
)) {

13689 
	`JS_ThrowTy≥Eº‹
(
˘x
, "bigint operandsáre forbidden for >>>");

13690 
	`JS_FªeVÆue
(
˘x
, 
›1
);

13691 
	`JS_FªeVÆue
(
˘x
, 
›2
);

13692 
ex˚±i⁄
;

13695 
	`JS_ToUöt32Fªe
(
˘x
, &
v1
, 
›1
);

13696 
	`JS_ToUöt32Fªe
(
˘x
, &
v2
, 
›2
);

13697 
r
 = 
v1
 >> (
v2
 & 0x1f);

13698 
•
[-2] = 
	`JS_NewUöt32
(
˘x
, 
r
);

13700 
ex˚±i⁄
:

13701 
•
[-2] = 
JS_UNDEFINED
;

13702 
•
[-1] = 
JS_UNDEFINED
;

13704 
	}
}

13706 
JSVÆue
 
	$js_mul_pow10_to_Êﬂt64
(
JSC⁄ãxt
 *
˘x
, c⁄° 
bf_t
 *
a
,

13707 
öt64_t
 
exp⁄ít
)

13709 
bf_t
 
r_s
, *
r
 = &r_s;

13710 
d
;

13711 
ªt
;

13714 
	`bf_öô
(
˘x
->
bf_˘x
, 
r
);

13715 
ªt
 = 
	`bf_mul_pow_ødix
(
r
, 
a
, 10, 
exp⁄ít
,

13716 53, 
	`bf_£t_exp_bôs
(11Ë| 
BF_RNDN
 |

13717 
BF_FLAG_SUBNORMAL
);

13718 
	`bf_gë_Êﬂt64
(
r
, &
d
, 
BF_RNDN
);

13719 
	`bf_dñëe
(
r
);

13720 i‡(
ªt
 & 
BF_ST_MEM_ERROR
)

13721  
	`JS_ThrowOutOfMem‹y
(
˘x
);

13723  
	`__JS_NewFlﬂt64
(
˘x
, 
d
);

13724 
	}
}

13726 
no_ölöe
 
	$js_mul_pow10
(
JSC⁄ãxt
 *
˘x
, 
JSVÆue
 *
•
)

13728 
bf_t
 
a_s
, *
a
, *
r
;

13729 
JSVÆue
 
›1
, 
›2
, 
ªs
;

13730 
öt64_t
 
e
;

13731 
ªt
;

13733 
ªs
 = 
	`JS_NewBigFlﬂt
(
˘x
);

13734 i‡(
	`JS_IsEx˚±i⁄
(
ªs
))

13736 
r
 = 
	`JS_GëBigFlﬂt
(
ªs
);

13737 
›1
 = 
•
[-2];

13738 
›2
 = 
•
[-1];

13739 
a
 = 
	`JS_ToBigFlﬂt
(
˘x
, &
a_s
, 
›1
);

13740 i‡(!
a
)

13742 i‡(
	`JS_IsBigI¡
(
˘x
, 
›2
)) {

13743 
ªt
 = 
	`JS_ToBigI¡64
(
˘x
, &
e
, 
›2
);

13745 
ªt
 = 
	`JS_ToI¡64
(
˘x
, &
e
, 
›2
);

13747 i‡(
ªt
) {

13748 i‡(
a
 =&
a_s
)

13749 
	`bf_dñëe
(
a
);

13750 
	`JS_FªeVÆue
(
˘x
, 
ªs
);

13754 
	`bf_mul_pow_ødix
(
r
, 
a
, 10, 
e
, 
˘x
->
Â_ív
.
¥ec
, ctx->Â_ív.
Êags
);

13755 i‡(
a
 =&
a_s
)

13756 
	`bf_dñëe
(
a
);

13757 
	`JS_FªeVÆue
(
˘x
, 
›1
);

13758 
	`JS_FªeVÆue
(
˘x
, 
›2
);

13759 
•
[-2] = 
ªs
;

13761 
	}
}

13765 
JSVÆue
 
	$JS_ThrowUnsuµ‹ãdBigöt
(
JSC⁄ãxt
 *
˘x
)

13767  
	`JS_ThrowTy≥Eº‹
(
˘x
, "bigint isÇot supported");

13768 
	}
}

13770 
JSVÆue
 
	$JS_NewBigI¡64
(
JSC⁄ãxt
 *
˘x
, 
söt64_t
 
v
)

13772  
	`JS_ThrowUnsuµ‹ãdBigöt
(
˘x
);

13773 
	}
}

13775 
JSVÆue
 
	$JS_NewBigUöt64
(
JSC⁄ãxt
 *
˘x
, 
uöt64_t
 
v
)

13777  
	`JS_ThrowUnsuµ‹ãdBigöt
(
˘x
);

13778 
	}
}

13780 
	$JS_ToBigI¡64
(
JSC⁄ãxt
 *
˘x
, 
söt64_t
 *
¥es
, 
JSVÆueC⁄°
 
vÆ
)

13782 
	`JS_ThrowUnsuµ‹ãdBigöt
(
˘x
);

13783 *
¥es
 = 0;

13785 
	}
}

13787 
no_ölöe
 
__ex˚±i⁄
 
	$js_u«ry_¨ôh_¶ow
(
JSC⁄ãxt
 *
˘x
,

13788 
JSVÆue
 *
•
,

13789 
OPCodeEnum
 
›
)

13791 
JSVÆue
 
›1
;

13792 
d
;

13794 
›1
 = 
•
[-1];

13795 i‡(
	`u∆ikñy
(
	`JS_ToFlﬂt64Fªe
(
˘x
, &
d
, 
›1
))) {

13796 
•
[-1] = 
JS_UNDEFINED
;

13799 
›
) {

13800 
OP_öc
:

13801 
d
++;

13803 
OP_dec
:

13804 
d
--;

13806 
OP_∂us
:

13808 
OP_√g
:

13809 
d
 = -d;

13812 
	`ab‹t
();

13814 
•
[-1] = 
	`JS_NewFlﬂt64
(
˘x
, 
d
);

13816 
	}
}

13819 
__ex˚±i⁄
 
	$js_po°_öc_¶ow
(
JSC⁄ãxt
 *
˘x
,

13820 
JSVÆue
 *
•
, 
OPCodeEnum
 
›
)

13822 
JSVÆue
 
›1
;

13823 
d
, 
r
;

13825 
›1
 = 
•
[-1];

13826 i‡(
	`u∆ikñy
(
	`JS_ToFlﬂt64Fªe
(
˘x
, &
d
, 
›1
))) {

13827 
•
[-1] = 
JS_UNDEFINED
;

13830 
r
 = 
d
 + 2 * (
›
 - 
OP_po°_dec
) - 1;

13831 
•
[0] = 
	`JS_NewFlﬂt64
(
˘x
, 
r
);

13832 
•
[-1] = 
	`JS_NewFlﬂt64
(
˘x
, 
d
);

13834 
	}
}

13836 
no_ölöe
 
__ex˚±i⁄
 
	$js_bö¨y_¨ôh_¶ow
(
JSC⁄ãxt
 *
˘x
, 
JSVÆue
 *
•
,

13837 
OPCodeEnum
 
›
)

13839 
JSVÆue
 
›1
, 
›2
;

13840 
d1
, 
d2
, 
r
;

13842 
›1
 = 
•
[-2];

13843 
›2
 = 
•
[-1];

13844 i‡(
	`u∆ikñy
(
	`JS_ToFlﬂt64Fªe
(
˘x
, &
d1
, 
›1
))) {

13845 
	`JS_FªeVÆue
(
˘x
, 
›2
);

13846 
ex˚±i⁄
;

13848 i‡(
	`u∆ikñy
(
	`JS_ToFlﬂt64Fªe
(
˘x
, &
d2
, 
›2
))) {

13849 
ex˚±i⁄
;

13851 
›
) {

13852 
OP_sub
:

13853 
r
 = 
d1
 - 
d2
;

13855 
OP_mul
:

13856 
r
 = 
d1
 * 
d2
;

13858 
OP_div
:

13859 
r
 = 
d1
 / 
d2
;

13861 
OP_mod
:

13862 
r
 = 
	`fmod
(
d1
, 
d2
);

13864 
OP_pow
:

13865 
r
 = 
	`js_pow
(
d1
, 
d2
);

13868 
	`ab‹t
();

13870 
•
[-2] = 
	`JS_NewFlﬂt64
(
˘x
, 
r
);

13872 
ex˚±i⁄
:

13873 
•
[-2] = 
JS_UNDEFINED
;

13874 
•
[-1] = 
JS_UNDEFINED
;

13876 
	}
}

13878 
no_ölöe
 
__ex˚±i⁄
 
	$js_add_¶ow
(
JSC⁄ãxt
 *
˘x
, 
JSVÆue
 *
•
)

13880 
JSVÆue
 
›1
, 
›2
;

13881 
uöt32_t
 
èg1
, 
èg2
;

13883 
›1
 = 
•
[-2];

13884 
›2
 = 
•
[-1];

13885 
èg1
 = 
	`JS_VALUE_GET_TAG
(
›1
);

13886 
èg2
 = 
	`JS_VALUE_GET_TAG
(
›2
);

13887 i‡((
èg1
 =
JS_TAG_INT
 || 
	`JS_TAG_IS_FLOAT64
(tag1)) &&

13888 (
èg2
 =
JS_TAG_INT
 || 
	`JS_TAG_IS_FLOAT64
(tag2))) {

13889 
add_numbîs
;

13891 
›1
 = 
	`JS_ToPrimôiveFªe
(
˘x
, op1, 
HINT_NONE
);

13892 i‡(
	`JS_IsEx˚±i⁄
(
›1
)) {

13893 
	`JS_FªeVÆue
(
˘x
, 
›2
);

13894 
ex˚±i⁄
;

13896 
›2
 = 
	`JS_ToPrimôiveFªe
(
˘x
, op2, 
HINT_NONE
);

13897 i‡(
	`JS_IsEx˚±i⁄
(
›2
)) {

13898 
	`JS_FªeVÆue
(
˘x
, 
›1
);

13899 
ex˚±i⁄
;

13901 
èg1
 = 
	`JS_VALUE_GET_TAG
(
›1
);

13902 
èg2
 = 
	`JS_VALUE_GET_TAG
(
›2
);

13903 i‡(
èg1
 =
JS_TAG_STRING
 || 
èg2
 == JS_TAG_STRING) {

13904 
•
[-2] = 
	`JS_C⁄ˇtSåög
(
˘x
, 
›1
, 
›2
);

13905 i‡(
	`JS_IsEx˚±i⁄
(
•
[-2]))

13906 
ex˚±i⁄
;

13908 
d1
, 
d2
;

13909 
add_numbîs
:

13910 i‡(
	`JS_ToFlﬂt64Fªe
(
˘x
, &
d1
, 
›1
)) {

13911 
	`JS_FªeVÆue
(
˘x
, 
›2
);

13912 
ex˚±i⁄
;

13914 i‡(
	`JS_ToFlﬂt64Fªe
(
˘x
, &
d2
, 
›2
))

13915 
ex˚±i⁄
;

13916 
•
[-2] = 
	`JS_NewFlﬂt64
(
˘x
, 
d1
 + 
d2
);

13920 
ex˚±i⁄
:

13921 
•
[-2] = 
JS_UNDEFINED
;

13922 
•
[-1] = 
JS_UNDEFINED
;

13924 
	}
}

13926 
no_ölöe
 
__ex˚±i⁄
 
	$js_bö¨y_logic_¶ow
(
JSC⁄ãxt
 *
˘x
,

13927 
JSVÆue
 *
•
,

13928 
OPCodeEnum
 
›
)

13930 
JSVÆue
 
›1
, 
›2
;

13931 
uöt32_t
 
v1
, 
v2
, 
r
;

13933 
›1
 = 
•
[-2];

13934 
›2
 = 
•
[-1];

13935 i‡(
	`u∆ikñy
(
	`JS_ToI¡32Fªe
(
˘x
, (
öt32_t
 *)&
v1
, 
›1
))) {

13936 
	`JS_FªeVÆue
(
˘x
, 
›2
);

13937 
ex˚±i⁄
;

13939 i‡(
	`u∆ikñy
(
	`JS_ToI¡32Fªe
(
˘x
, (
öt32_t
 *)&
v2
, 
›2
)))

13940 
ex˚±i⁄
;

13941 
›
) {

13942 
OP_shl
:

13943 
r
 = 
v1
 << (
v2
 & 0x1f);

13945 
OP_ßr
:

13946 
r
 = ()
v1
 >> (
v2
 & 0x1f);

13948 
OP_™d
:

13949 
r
 = 
v1
 & 
v2
;

13951 
OP_‹
:

13952 
r
 = 
v1
 | 
v2
;

13954 
OP_x‹
:

13955 
r
 = 
v1
 ^ 
v2
;

13958 
	`ab‹t
();

13960 
•
[-2] = 
	`JS_NewI¡32
(
˘x
, 
r
);

13962 
ex˚±i⁄
:

13963 
•
[-2] = 
JS_UNDEFINED
;

13964 
•
[-1] = 
JS_UNDEFINED
;

13966 
	}
}

13968 
no_ölöe
 
	$js_nŸ_¶ow
(
JSC⁄ãxt
 *
˘x
, 
JSVÆue
 *
•
)

13970 
öt32_t
 
v1
;

13972 i‡(
	`u∆ikñy
(
	`JS_ToI¡32Fªe
(
˘x
, &
v1
, 
•
[-1]))) {

13973 
•
[-1] = 
JS_UNDEFINED
;

13976 
•
[-1] = 
	`JS_NewI¡32
(
˘x
, ~
v1
);

13978 
	}
}

13980 
no_ölöe
 
	$js_ªœti⁄Æ_¶ow
(
JSC⁄ãxt
 *
˘x
, 
JSVÆue
 *
•
,

13981 
OPCodeEnum
 
›
)

13983 
JSVÆue
 
›1
, 
›2
;

13984 
ªs
;

13986 
›1
 = 
•
[-2];

13987 
›2
 = 
•
[-1];

13988 
›1
 = 
	`JS_ToPrimôiveFªe
(
˘x
, op1, 
HINT_NUMBER
);

13989 i‡(
	`JS_IsEx˚±i⁄
(
›1
)) {

13990 
	`JS_FªeVÆue
(
˘x
, 
›2
);

13991 
ex˚±i⁄
;

13993 
›2
 = 
	`JS_ToPrimôiveFªe
(
˘x
, op2, 
HINT_NUMBER
);

13994 i‡(
	`JS_IsEx˚±i⁄
(
›2
)) {

13995 
	`JS_FªeVÆue
(
˘x
, 
›1
);

13996 
ex˚±i⁄
;

13998 i‡(
	`JS_VALUE_GET_TAG
(
›1
Ë=
JS_TAG_STRING
 &&

13999 
	`JS_VALUE_GET_TAG
(
›2
Ë=
JS_TAG_STRING
) {

14000 
JSSåög
 *
p1
, *
p2
;

14001 
p1
 = 
	`JS_VALUE_GET_STRING
(
›1
);

14002 
p2
 = 
	`JS_VALUE_GET_STRING
(
›2
);

14003 
ªs
 = 
	`js_°rög_com∑ª
(
˘x
, 
p1
, 
p2
);

14004 
	`JS_FªeVÆue
(
˘x
, 
›1
);

14005 
	`JS_FªeVÆue
(
˘x
, 
›2
);

14006 
›
) {

14007 
OP_…
:

14008 
ªs
 = (res < 0);

14010 
OP_…e
:

14011 
ªs
 = (res <= 0);

14013 
OP_gt
:

14014 
ªs
 = (res > 0);

14017 
OP_gã
:

14018 
ªs
 = (res >= 0);

14022 
d1
, 
d2
;

14023 i‡(
	`JS_ToFlﬂt64Fªe
(
˘x
, &
d1
, 
›1
)) {

14024 
	`JS_FªeVÆue
(
˘x
, 
›2
);

14025 
ex˚±i⁄
;

14027 i‡(
	`JS_ToFlﬂt64Fªe
(
˘x
, &
d2
, 
›2
))

14028 
ex˚±i⁄
;

14029 
›
) {

14030 
OP_…
:

14031 
ªs
 = (
d1
 < 
d2
);

14033 
OP_…e
:

14034 
ªs
 = (
d1
 <
d2
);

14036 
OP_gt
:

14037 
ªs
 = (
d1
 > 
d2
);

14040 
OP_gã
:

14041 
ªs
 = (
d1
 >
d2
);

14045 
•
[-2] = 
	`JS_NewBoﬁ
(
˘x
, 
ªs
);

14047 
ex˚±i⁄
:

14048 
•
[-2] = 
JS_UNDEFINED
;

14049 
•
[-1] = 
JS_UNDEFINED
;

14051 
	}
}

14053 
no_ölöe
 
__ex˚±i⁄
 
	$js_eq_¶ow
(
JSC⁄ãxt
 *
˘x
, 
JSVÆue
 *
•
,

14054 
BOOL
 
is_√q
)

14056 
JSVÆue
 
›1
, 
›2
;

14057 
èg1
, 
èg2
;

14058 
BOOL
 
ªs
;

14060 
›1
 = 
•
[-2];

14061 
›2
 = 
•
[-1];

14062 
ªdo
:

14063 
èg1
 = 
	`JS_VALUE_GET_NORM_TAG
(
›1
);

14064 
èg2
 = 
	`JS_VALUE_GET_NORM_TAG
(
›2
);

14065 i‡(
èg1
 =
èg2
 ||

14066 (
èg1
 =
JS_TAG_INT
 && 
èg2
 =
JS_TAG_FLOAT64
) ||

14067 (
èg2
 =
JS_TAG_INT
 && 
èg1
 =
JS_TAG_FLOAT64
)) {

14068 
ªs
 = 
	`js_°ri˘_eq
(
˘x
, 
›1
, 
›2
);

14069 } i‡((
èg1
 =
JS_TAG_NULL
 && 
èg2
 =
JS_TAG_UNDEFINED
) ||

14070 (
èg2
 =
JS_TAG_NULL
 && 
èg1
 =
JS_TAG_UNDEFINED
)) {

14071 
ªs
 = 
TRUE
;

14072 } i‡((
èg1
 =
JS_TAG_STRING
 && (
èg2
 =
JS_TAG_INT
 ||

14073 
èg2
 =
JS_TAG_FLOAT64
)) ||

14074 (
èg2
 =
JS_TAG_STRING
 && (
èg1
 =
JS_TAG_INT
 ||

14075 
èg1
 =
JS_TAG_FLOAT64
))) {

14076 
d1
;

14077 
d2
;

14078 i‡(
	`JS_ToFlﬂt64Fªe
(
˘x
, &
d1
, 
›1
)) {

14079 
	`JS_FªeVÆue
(
˘x
, 
›2
);

14080 
ex˚±i⁄
;

14082 i‡(
	`JS_ToFlﬂt64Fªe
(
˘x
, &
d2
, 
›2
))

14083 
ex˚±i⁄
;

14084 
ªs
 = (
d1
 =
d2
);

14085 } i‡(
èg1
 =
JS_TAG_BOOL
) {

14086 
›1
 = 
	`JS_NewI¡32
(
˘x
, 
	`JS_VALUE_GET_INT
(op1));

14087 
ªdo
;

14088 } i‡(
èg2
 =
JS_TAG_BOOL
) {

14089 
›2
 = 
	`JS_NewI¡32
(
˘x
, 
	`JS_VALUE_GET_INT
(op2));

14090 
ªdo
;

14091 } i‡(
èg1
 =
JS_TAG_OBJECT
 &&

14092 (
èg2
 =
JS_TAG_INT
 ||Åag2 =
JS_TAG_FLOAT64
 ||Åag2 =
JS_TAG_STRING
 ||Åag2 =
JS_TAG_SYMBOL
)) {

14093 
›1
 = 
	`JS_ToPrimôiveFªe
(
˘x
, op1, 
HINT_NONE
);

14094 i‡(
	`JS_IsEx˚±i⁄
(
›1
)) {

14095 
	`JS_FªeVÆue
(
˘x
, 
›2
);

14096 
ex˚±i⁄
;

14098 
ªdo
;

14099 } i‡(
èg2
 =
JS_TAG_OBJECT
 &&

14100 (
èg1
 =
JS_TAG_INT
 ||Åag1 =
JS_TAG_FLOAT64
 ||Åag1 =
JS_TAG_STRING
 ||Åag1 =
JS_TAG_SYMBOL
)) {

14101 
›2
 = 
	`JS_ToPrimôiveFªe
(
˘x
, op2, 
HINT_NONE
);

14102 i‡(
	`JS_IsEx˚±i⁄
(
›2
)) {

14103 
	`JS_FªeVÆue
(
˘x
, 
›1
);

14104 
ex˚±i⁄
;

14106 
ªdo
;

14108 
	`JS_FªeVÆue
(
˘x
, 
›1
);

14109 
	`JS_FªeVÆue
(
˘x
, 
›2
);

14110 
ªs
 = 
FALSE
;

14112 
•
[-2] = 
	`JS_NewBoﬁ
(
˘x
, 
ªs
 ^ 
is_√q
);

14114 
ex˚±i⁄
:

14115 
•
[-2] = 
JS_UNDEFINED
;

14116 
•
[-1] = 
JS_UNDEFINED
;

14118 
	}
}

14120 
no_ölöe
 
	$js_shr_¶ow
(
JSC⁄ãxt
 *
˘x
, 
JSVÆue
 *
•
)

14122 
JSVÆue
 
›1
, 
›2
;

14123 
uöt32_t
 
v1
, 
v2
, 
r
;

14125 
›1
 = 
•
[-2];

14126 
›2
 = 
•
[-1];

14127 i‡(
	`u∆ikñy
(
	`JS_ToUöt32Fªe
(
˘x
, &
v1
, 
›1
))) {

14128 
	`JS_FªeVÆue
(
˘x
, 
›2
);

14129 
ex˚±i⁄
;

14131 i‡(
	`u∆ikñy
(
	`JS_ToUöt32Fªe
(
˘x
, &
v2
, 
›2
)))

14132 
ex˚±i⁄
;

14133 
r
 = 
v1
 >> (
v2
 & 0x1f);

14134 
•
[-2] = 
	`JS_NewUöt32
(
˘x
, 
r
);

14136 
ex˚±i⁄
:

14137 
•
[-2] = 
JS_UNDEFINED
;

14138 
•
[-1] = 
JS_UNDEFINED
;

14140 
	}
}

14145 
BOOL
 
	$js_°ri˘_eq2
(
JSC⁄ãxt
 *
˘x
, 
JSVÆue
 
›1
, JSVÆuê
›2
,

14146 
JSSåi˘EqModeEnum
 
eq_mode
)

14148 
BOOL
 
ªs
;

14149 
èg1
, 
èg2
;

14150 
d1
, 
d2
;

14152 
èg1
 = 
	`JS_VALUE_GET_NORM_TAG
(
›1
);

14153 
èg2
 = 
	`JS_VALUE_GET_NORM_TAG
(
›2
);

14154 
èg1
) {

14155 
JS_TAG_BOOL
:

14156 i‡(
èg1
 !
èg2
) {

14157 
ªs
 = 
FALSE
;

14159 
ªs
 = 
	`JS_VALUE_GET_INT
(
›1
Ë=JS_VALUE_GET_INT(
›2
);

14160 
d⁄e_no_‰ì
;

14163 
JS_TAG_NULL
:

14164 
JS_TAG_UNDEFINED
:

14165 
ªs
 = (
èg1
 =
èg2
);

14167 
JS_TAG_STRING
:

14169 
JSSåög
 *
p1
, *
p2
;

14170 i‡(
èg1
 !
èg2
) {

14171 
ªs
 = 
FALSE
;

14173 
p1
 = 
	`JS_VALUE_GET_STRING
(
›1
);

14174 
p2
 = 
	`JS_VALUE_GET_STRING
(
›2
);

14175 
ªs
 = (
	`js_°rög_com∑ª
(
˘x
, 
p1
, 
p2
) == 0);

14179 
JS_TAG_SYMBOL
:

14181 
JSAtomSåu˘
 *
p1
, *
p2
;

14182 i‡(
èg1
 !
èg2
) {

14183 
ªs
 = 
FALSE
;

14185 
p1
 = 
	`JS_VALUE_GET_PTR
(
›1
);

14186 
p2
 = 
	`JS_VALUE_GET_PTR
(
›2
);

14187 
ªs
 = (
p1
 =
p2
);

14191 
JS_TAG_OBJECT
:

14192 i‡(
èg1
 !
èg2
)

14193 
ªs
 = 
FALSE
;

14195 
ªs
 = 
	`JS_VALUE_GET_OBJ
(
›1
Ë=JS_VALUE_GET_OBJ(
›2
);

14197 
JS_TAG_INT
:

14198 
d1
 = 
	`JS_VALUE_GET_INT
(
›1
);

14199 i‡(
èg2
 =
JS_TAG_INT
) {

14200 
d2
 = 
	`JS_VALUE_GET_INT
(
›2
);

14201 
numbî_ã°
;

14202 } i‡(
èg2
 =
JS_TAG_FLOAT64
) {

14203 
d2
 = 
	`JS_VALUE_GET_FLOAT64
(
›2
);

14204 
numbî_ã°
;

14206 
ªs
 = 
FALSE
;

14209 
JS_TAG_FLOAT64
:

14210 
d1
 = 
	`JS_VALUE_GET_FLOAT64
(
›1
);

14211 i‡(
èg2
 =
JS_TAG_FLOAT64
) {

14212 
d2
 = 
	`JS_VALUE_GET_FLOAT64
(
›2
);

14213 } i‡(
èg2
 =
JS_TAG_INT
) {

14214 
d2
 = 
	`JS_VALUE_GET_INT
(
›2
);

14216 
ªs
 = 
FALSE
;

14219 
numbî_ã°
:

14220 i‡(
	`u∆ikñy
(
eq_mode
 >
JS_EQ_SAME_VALUE
)) {

14221 
JSFlﬂt64Uni⁄
 
u1
, 
u2
;

14223 i‡(
	`i¢™
(
d1
Ë|| i¢™(
d2
)) {

14224 
ªs
 = 
	`i¢™
(
d1
Ë=i¢™(
d2
);

14225 } i‡(
eq_mode
 =
JS_EQ_SAME_VALUE_ZERO
) {

14226 
ªs
 = (
d1
 =
d2
);

14228 
u1
.
d
 = 
d1
;

14229 
u2
.
d
 = 
d2
;

14230 
ªs
 = (
u1
.
u64
 =
u2
.u64);

14233 
ªs
 = (
d1
 =
d2
);

14235 
d⁄e_no_‰ì
;

14236 #ifde‡
CONFIG_BIGNUM


14237 
JS_TAG_BIG_INT
:

14239 
bf_t
 
a_s
, *
a
, 
b_s
, *
b
;

14240 i‡(
èg1
 !
èg2
) {

14241 
ªs
 = 
FALSE
;

14244 
a
 = 
	`JS_ToBigFlﬂt
(
˘x
, &
a_s
, 
›1
);

14245 
b
 = 
	`JS_ToBigFlﬂt
(
˘x
, &
b_s
, 
›2
);

14246 
ªs
 = 
	`bf_cmp_eq
(
a
, 
b
);

14247 i‡(
a
 =&
a_s
)

14248 
	`bf_dñëe
(
a
);

14249 i‡(
b
 =&
b_s
)

14250 
	`bf_dñëe
(
b
);

14253 
JS_TAG_BIG_FLOAT
:

14255 
JSBigFlﬂt
 *
p1
, *
p2
;

14256 c⁄° 
bf_t
 *
a
, *
b
;

14257 i‡(
èg1
 !
èg2
) {

14258 
ªs
 = 
FALSE
;

14261 
p1
 = 
	`JS_VALUE_GET_PTR
(
›1
);

14262 
p2
 = 
	`JS_VALUE_GET_PTR
(
›2
);

14263 
a
 = &
p1
->
num
;

14264 
b
 = &
p2
->
num
;

14265 i‡(
	`u∆ikñy
(
eq_mode
 >
JS_EQ_SAME_VALUE
)) {

14266 i‡(
eq_mode
 =
JS_EQ_SAME_VALUE_ZERO
 &&

14267 
a
->
ex≤
 =
BF_EXP_ZERO
 && 
b
->expn == BF_EXP_ZERO) {

14268 
ªs
 = 
TRUE
;

14270 
ªs
 = (
	`bf_cmp_fuŒ
(
a
, 
b
) == 0);

14273 
ªs
 = 
	`bf_cmp_eq
(
a
, 
b
);

14277 
JS_TAG_BIG_DECIMAL
:

14279 
JSBigDecimÆ
 *
p1
, *
p2
;

14280 c⁄° 
bfdec_t
 *
a
, *
b
;

14281 i‡(
èg1
 !
èg2
) {

14282 
ªs
 = 
FALSE
;

14285 
p1
 = 
	`JS_VALUE_GET_PTR
(
›1
);

14286 
p2
 = 
	`JS_VALUE_GET_PTR
(
›2
);

14287 
a
 = &
p1
->
num
;

14288 
b
 = &
p2
->
num
;

14289 
ªs
 = 
	`bfdec_cmp_eq
(
a
, 
b
);

14294 
ªs
 = 
FALSE
;

14297 
	`JS_FªeVÆue
(
˘x
, 
›1
);

14298 
	`JS_FªeVÆue
(
˘x
, 
›2
);

14299 
d⁄e_no_‰ì
:

14300  
ªs
;

14301 
	}
}

14303 
BOOL
 
	$js_°ri˘_eq
(
JSC⁄ãxt
 *
˘x
, 
JSVÆue
 
›1
, JSVÆuê
›2
)

14305  
	`js_°ri˘_eq2
(
˘x
, 
›1
, 
›2
, 
JS_EQ_STRICT
);

14306 
	}
}

14308 
BOOL
 
	$js_ßme_vÆue
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
›1
, JSVÆueC⁄° 
›2
)

14310  
	`js_°ri˘_eq2
(
˘x
,

14311 
	`JS_DupVÆue
(
˘x
, 
›1
), JS_DupVÆue(˘x, 
›2
),

14312 
JS_EQ_SAME_VALUE
);

14313 
	}
}

14315 
BOOL
 
	$js_ßme_vÆue_zîo
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
›1
, JSVÆueC⁄° 
›2
)

14317  
	`js_°ri˘_eq2
(
˘x
,

14318 
	`JS_DupVÆue
(
˘x
, 
›1
), JS_DupVÆue(˘x, 
›2
),

14319 
JS_EQ_SAME_VALUE_ZERO
);

14320 
	}
}

14322 
no_ölöe
 
	$js_°ri˘_eq_¶ow
(
JSC⁄ãxt
 *
˘x
, 
JSVÆue
 *
•
,

14323 
BOOL
 
is_√q
)

14325 
BOOL
 
ªs
;

14326 
ªs
 = 
	`js_°ri˘_eq
(
˘x
, 
•
[-2], sp[-1]);

14327 
•
[-2] = 
	`JS_NewBoﬁ
(
˘x
, 
ªs
 ^ 
is_√q
);

14329 
	}
}

14331 
__ex˚±i⁄
 
	$js_›î©‹_ö
(
JSC⁄ãxt
 *
˘x
, 
JSVÆue
 *
•
)

14333 
JSVÆue
 
›1
, 
›2
;

14334 
JSAtom
 
©om
;

14335 
ªt
;

14337 
›1
 = 
•
[-2];

14338 
›2
 = 
•
[-1];

14340 i‡(
	`JS_VALUE_GET_TAG
(
›2
Ë!
JS_TAG_OBJECT
) {

14341 
	`JS_ThrowTy≥Eº‹
(
˘x
, "invalid 'in' operand");

14344 
©om
 = 
	`JS_VÆueToAtom
(
˘x
, 
›1
);

14345 i‡(
	`u∆ikñy
(
©om
 =
JS_ATOM_NULL
))

14347 
ªt
 = 
	`JS_HasPr›îty
(
˘x
, 
›2
, 
©om
);

14348 
	`JS_FªeAtom
(
˘x
, 
©om
);

14349 i‡(
ªt
 < 0)

14351 
	`JS_FªeVÆue
(
˘x
, 
›1
);

14352 
	`JS_FªeVÆue
(
˘x
, 
›2
);

14353 
•
[-2] = 
	`JS_NewBoﬁ
(
˘x
, 
ªt
);

14355 
	}
}

14357 
__ex˚±i⁄
 
	$js_has_unsc›abÀ
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
obj
,

14358 
JSAtom
 
©om
)

14360 
JSVÆue
 
¨r
, 
vÆ
;

14361 
ªt
;

14363 
¨r
 = 
	`JS_GëPr›îty
(
˘x
, 
obj
, 
JS_ATOM_Symbﬁ_unsc›abÀs
);

14364 i‡(
	`JS_IsEx˚±i⁄
(
¨r
))

14366 
ªt
 = 0;

14367 i‡(
	`JS_IsObje˘
(
¨r
)) {

14368 
vÆ
 = 
	`JS_GëPr›îty
(
˘x
, 
¨r
, 
©om
);

14369 
ªt
 = 
	`JS_ToBoﬁFªe
(
˘x
, 
vÆ
);

14371 
	`JS_FªeVÆue
(
˘x
, 
¨r
);

14372  
ªt
;

14373 
	}
}

14375 
__ex˚±i⁄
 
	$js_›î©‹_ö°™˚of
(
JSC⁄ãxt
 *
˘x
, 
JSVÆue
 *
•
)

14377 
JSVÆue
 
›1
, 
›2
;

14378 
BOOL
 
ªt
;

14380 
›1
 = 
•
[-2];

14381 
›2
 = 
•
[-1];

14382 
ªt
 = 
	`JS_IsIn°™˚Of
(
˘x
, 
›1
, 
›2
);

14383 i‡(
ªt
 < 0)

14384  
ªt
;

14385 
	`JS_FªeVÆue
(
˘x
, 
›1
);

14386 
	`JS_FªeVÆue
(
˘x
, 
›2
);

14387 
•
[-2] = 
	`JS_NewBoﬁ
(
˘x
, 
ªt
);

14389 
	}
}

14391 
__ex˚±i⁄
 
	$js_›î©‹_ty≥of
(
JSC⁄ãxt
 *
˘x
, 
JSVÆue
 
›1
)

14393 
JSAtom
 
©om
;

14394 
uöt32_t
 
èg
;

14396 
èg
 = 
	`JS_VALUE_GET_NORM_TAG
(
›1
);

14397 
èg
) {

14398 #ifde‡
CONFIG_BIGNUM


14399 
JS_TAG_BIG_INT
:

14400 
©om
 = 
JS_ATOM_bigöt
;

14402 
JS_TAG_BIG_FLOAT
:

14403 
©om
 = 
JS_ATOM_bigÊﬂt
;

14405 
JS_TAG_BIG_DECIMAL
:

14406 
©om
 = 
JS_ATOM_bigdecimÆ
;

14409 
JS_TAG_INT
:

14410 
JS_TAG_FLOAT64
:

14411 
©om
 = 
JS_ATOM_numbî
;

14413 
JS_TAG_UNDEFINED
:

14414 
©om
 = 
JS_ATOM_undeföed
;

14416 
JS_TAG_BOOL
:

14417 
©om
 = 
JS_ATOM_boﬁón
;

14419 
JS_TAG_STRING
:

14420 
©om
 = 
JS_ATOM_°rög
;

14422 
JS_TAG_OBJECT
:

14423 i‡(
	`JS_IsFun˘i⁄
(
˘x
, 
›1
))

14424 
©om
 = 
JS_ATOM_fun˘i⁄
;

14426 
obj_ty≥
;

14428 
JS_TAG_NULL
:

14429 
obj_ty≥
:

14430 
©om
 = 
JS_ATOM_obje˘
;

14432 
JS_TAG_SYMBOL
:

14433 
©om
 = 
JS_ATOM_symbﬁ
;

14436 
©om
 = 
JS_ATOM_unknown
;

14439  
©om
;

14440 
	}
}

14442 
__ex˚±i⁄
 
	$js_›î©‹_dñëe
(
JSC⁄ãxt
 *
˘x
, 
JSVÆue
 *
•
)

14444 
JSVÆue
 
›1
, 
›2
;

14445 
JSAtom
 
©om
;

14446 
ªt
;

14448 
›1
 = 
•
[-2];

14449 
›2
 = 
•
[-1];

14450 
©om
 = 
	`JS_VÆueToAtom
(
˘x
, 
›2
);

14451 i‡(
	`u∆ikñy
(
©om
 =
JS_ATOM_NULL
))

14453 
ªt
 = 
	`JS_DñëePr›îty
(
˘x
, 
›1
, 
©om
, 
JS_PROP_THROW_STRICT
);

14454 
	`JS_FªeAtom
(
˘x
, 
©om
);

14455 i‡(
	`u∆ikñy
(
ªt
 < 0))

14457 
	`JS_FªeVÆue
(
˘x
, 
›1
);

14458 
	`JS_FªeVÆue
(
˘x
, 
›2
);

14459 
•
[-2] = 
	`JS_NewBoﬁ
(
˘x
, 
ªt
);

14461 
	}
}

14463 
JSVÆue
 
	$js_throw_ty≥_îr‹
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

14464 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

14466  
	`JS_ThrowTy≥Eº‹
(
˘x
, "invalidÖropertyáccess");

14467 
	}
}

14472 
JSVÆue
 
	$js_fun˘i⁄_¥Ÿo_ˇŒî
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

14473 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

14475 
JSFun˘i⁄Byãcode
 *
b
 = 
	`JS_GëFun˘i⁄Byãcode
(
this_vÆ
);

14476 i‡(!
b
 || (b->
js_mode
 & 
JS_MODE_STRICT
Ë|| !b->
has_¥ŸŸy≥
) {

14477  
	`js_throw_ty≥_îr‹
(
˘x
, 
this_vÆ
, 0, 
NULL
);

14479  
JS_UNDEFINED
;

14480 
	}
}

14482 
JSVÆue
 
	$js_fun˘i⁄_¥Ÿo_fûeName
(
JSC⁄ãxt
 *
˘x
,

14483 
JSVÆueC⁄°
 
this_vÆ
)

14485 
JSFun˘i⁄Byãcode
 *
b
 = 
	`JS_GëFun˘i⁄Byãcode
(
this_vÆ
);

14486 i‡(
b
 && b->
has_debug
) {

14487  
	`JS_AtomToSåög
(
˘x
, 
b
->
debug
.
fûíame
);

14489  
JS_UNDEFINED
;

14490 
	}
}

14492 
JSVÆue
 
	$js_fun˘i⁄_¥Ÿo_löeNumbî
(
JSC⁄ãxt
 *
˘x
,

14493 
JSVÆueC⁄°
 
this_vÆ
)

14495 
JSFun˘i⁄Byãcode
 *
b
 = 
	`JS_GëFun˘i⁄Byãcode
(
this_vÆ
);

14496 i‡(
b
 && b->
has_debug
) {

14497  
	`JS_NewI¡32
(
˘x
, 
b
->
debug
.
löe_num
);

14499  
JS_UNDEFINED
;

14500 
	}
}

14502 
	$js_¨gumíts_deföe_own_¥›îty
(
JSC⁄ãxt
 *
˘x
,

14503 
JSVÆueC⁄°
 
this_obj
,

14504 
JSAtom
 
¥›
, 
JSVÆueC⁄°
 
vÆ
,

14505 
JSVÆueC⁄°
 
gëãr
, JSVÆueC⁄° 
£âî
, 
Êags
)

14507 
JSObje˘
 *
p
;

14508 
uöt32_t
 
idx
;

14509 
p
 = 
	`JS_VALUE_GET_OBJ
(
this_obj
);

14511 i‡(
p
->
Á°_¨øy
 && 
	`JS_AtomIsAºayIndex
(
˘x
, &
idx
, 
¥›
) &&

14512 
idx
 < 
p
->
u
.
¨øy
.
cou¡
) {

14513 i‡(
	`c⁄vît_Á°_¨øy_to_¨øy
(
˘x
, 
p
))

14517  
	`JS_DeföePr›îty
(
˘x
, 
this_obj
, 
¥›
, 
vÆ
, 
gëãr
, 
£âî
,

14518 
Êags
 | 
JS_PROP_NO_EXOTIC
);

14519 
	}
}

14521 c⁄° 
JSCœssExŸicMëhods
 
	gjs_¨gumíts_exŸic_mëhods
 = {

14522 .
deföe_own_¥›îty
 = 
js_¨gumíts_deföe_own_¥›îty
,

14525 
JSVÆue
 
	$js_buûd_¨gumíts
(
JSC⁄ãxt
 *
˘x
, 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

14527 
JSVÆue
 
vÆ
, *
èb
;

14528 
JSPr›îty
 *
¥
;

14529 
JSObje˘
 *
p
;

14530 
i
;

14532 
vÆ
 = 
	`JS_NewObje˘PrŸoCœss
(
˘x
, ctx->
˛ass_¥Ÿo
[
JS_CLASS_OBJECT
],

14533 
JS_CLASS_ARGUMENTS
);

14534 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

14535  
vÆ
;

14536 
p
 = 
	`JS_VALUE_GET_OBJ
(
vÆ
);

14539 
¥
 = 
	`add_¥›îty
(
˘x
, 
p
, 
JS_ATOM_Àngth
,

14540 
JS_PROP_WRITABLE
 | 
JS_PROP_CONFIGURABLE
);

14541 
¥
->
u
.
vÆue
 = 
	`JS_NewI¡32
(
˘x
, 
¨gc
);

14544 
èb
 = 
NULL
;

14545 i‡(
¨gc
 > 0) {

14546 
èb
 = 
	`js_mÆloc
(
˘x
, —ab[0]Ë* 
¨gc
);

14547 i‡(!
èb
) {

14548 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

14549  
JS_EXCEPTION
;

14551 
i
 = 0; i < 
¨gc
; i++) {

14552 
èb
[
i
] = 
	`JS_DupVÆue
(
˘x
, 
¨gv
[i]);

14555 
p
->
u
.
¨øy
.u.
vÆues
 = 
èb
;

14556 
p
->
u
.
¨øy
.
cou¡
 = 
¨gc
;

14558 
	`JS_DeföePr›îtyVÆue
(
˘x
, 
vÆ
, 
JS_ATOM_Symbﬁ_ôî©‹
,

14559 
	`JS_DupVÆue
(
˘x
, ctx->
¨øy_¥Ÿo_vÆues
),

14560 
JS_PROP_CONFIGURABLE
 | 
JS_PROP_WRITABLE
);

14562 
	`JS_DeföePr›îty
(
˘x
, 
vÆ
, 
JS_ATOM_ˇŒì
, 
JS_UNDEFINED
,

14563 
˘x
->
throw_ty≥_îr‹
, ctx->throw_type_error,

14564 
JS_PROP_HAS_GET
 | 
JS_PROP_HAS_SET
);

14565  
vÆ
;

14566 
	}
}

14568 
	#GLOBAL_VAR_OFFSET
 0x40000000

	)

14569 
	#ARGUMENT_VAR_OFFSET
 0x20000000

	)

14572 
JSVÆue
 
	$js_buûd_m≠≥d_¨gumíts
(
JSC⁄ãxt
 *
˘x
, 
¨gc
,

14573 
JSVÆueC⁄°
 *
¨gv
,

14574 
JSSèckFøme
 *
sf
, 
¨g_cou¡
)

14576 
JSVÆue
 
vÆ
;

14577 
JSPr›îty
 *
¥
;

14578 
JSObje˘
 *
p
;

14579 
i
;

14581 
vÆ
 = 
	`JS_NewObje˘PrŸoCœss
(
˘x
, ctx->
˛ass_¥Ÿo
[
JS_CLASS_OBJECT
],

14582 
JS_CLASS_MAPPED_ARGUMENTS
);

14583 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

14584  
vÆ
;

14585 
p
 = 
	`JS_VALUE_GET_OBJ
(
vÆ
);

14588 
¥
 = 
	`add_¥›îty
(
˘x
, 
p
, 
JS_ATOM_Àngth
,

14589 
JS_PROP_WRITABLE
 | 
JS_PROP_CONFIGURABLE
);

14590 
¥
->
u
.
vÆue
 = 
	`JS_NewI¡32
(
˘x
, 
¨gc
);

14592 
i
 = 0; i < 
¨g_cou¡
; i++) {

14593 
JSV¨Ref
 *
v¨_ªf
;

14594 
v¨_ªf
 = 
	`gë_v¨_ªf
(
˘x
, 
sf
, 
i
, 
TRUE
);

14595 i‡(!
v¨_ªf
)

14596 
Áû
;

14597 
¥
 = 
	`add_¥›îty
(
˘x
, 
p
, 
	`__JS_AtomFromUI¡32
(
i
), 
JS_PROP_C_W_E
 | 
JS_PROP_VARREF
);

14598 i‡(!
¥
) {

14599 
	`‰ì_v¨_ªf
(
˘x
->
π
, 
v¨_ªf
);

14600 
Áû
;

14602 
¥
->
u
.
v¨_ªf
 = var_ref;

14607 
i
 = 
¨g_cou¡
; i < 
¨gc
; i++) {

14608 i‡(
	`JS_DeföePr›îtyVÆueUöt32
(
˘x
, 
vÆ
, 
i
,

14609 
	`JS_DupVÆue
(
˘x
, 
¨gv
[
i
]),

14610 
JS_PROP_C_W_E
) < 0)

14611 
Áû
;

14614 
	`JS_DeföePr›îtyVÆue
(
˘x
, 
vÆ
, 
JS_ATOM_Symbﬁ_ôî©‹
,

14615 
	`JS_DupVÆue
(
˘x
, ctx->
¨øy_¥Ÿo_vÆues
),

14616 
JS_PROP_CONFIGURABLE
 | 
JS_PROP_WRITABLE
);

14618 
	`JS_DeföePr›îtyVÆue
(
˘x
, 
vÆ
, 
JS_ATOM_ˇŒì
,

14619 
	`JS_DupVÆue
(
˘x
, ctx->
π
->
cuºít_°ack_‰ame
->
cur_func
),

14620 
JS_PROP_CONFIGURABLE
 | 
JS_PROP_WRITABLE
);

14621  
vÆ
;

14622 
Áû
:

14623 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

14624  
JS_EXCEPTION
;

14625 
	}
}

14627 
JSVÆue
 
	$js_buûd_ª°
(
JSC⁄ãxt
 *
˘x
, 
fú°
, 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

14629 
JSVÆue
 
vÆ
;

14630 
i
, 
ªt
;

14632 
vÆ
 = 
	`JS_NewAºay
(
˘x
);

14633 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

14634  
vÆ
;

14635 
i
 = 
fú°
; i < 
¨gc
; i++) {

14636 
ªt
 = 
	`JS_DeföePr›îtyVÆueUöt32
(
˘x
, 
vÆ
, 
i
 - 
fú°
,

14637 
	`JS_DupVÆue
(
˘x
, 
¨gv
[
i
]),

14638 
JS_PROP_C_W_E
);

14639 i‡(
ªt
 < 0) {

14640 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

14641  
JS_EXCEPTION
;

14644  
vÆ
;

14645 
	}
}

14647 
JSVÆue
 
	$buûd_f‹_ö_ôî©‹
(
JSC⁄ãxt
 *
˘x
, 
JSVÆue
 
obj
)

14649 
JSObje˘
 *
p
, *
p1
;

14650 
JSPr›îtyEnum
 *
èb_©om
;

14651 
i
;

14652 
JSVÆue
 
íum_obj
;

14653 
JSF‹InIãøt‹
 *
ô
;

14654 
uöt32_t
 
èg
, 
èb_©om_cou¡
;

14656 
èg
 = 
	`JS_VALUE_GET_TAG
(
obj
);

14657 i‡(
èg
 !
JS_TAG_OBJECT
 &&Åag !
JS_TAG_NULL
 &&Åag !
JS_TAG_UNDEFINED
) {

14658 
obj
 = 
	`JS_ToObje˘Fªe
(
˘x
, obj);

14661 
ô
 = 
	`js_mÆloc
(
˘x
, (*it));

14662 i‡(!
ô
) {

14663 
	`JS_FªeVÆue
(
˘x
, 
obj
);

14664  
JS_EXCEPTION
;

14666 
íum_obj
 = 
	`JS_NewObje˘PrŸoCœss
(
˘x
, 
JS_NULL
, 
JS_CLASS_FOR_IN_ITERATOR
);

14667 i‡(
	`JS_IsEx˚±i⁄
(
íum_obj
)) {

14668 
	`js_‰ì
(
˘x
, 
ô
);

14669 
	`JS_FªeVÆue
(
˘x
, 
obj
);

14670  
JS_EXCEPTION
;

14672 
ô
->
is_¨øy
 = 
FALSE
;

14673 
ô
->
obj
 = obj;

14674 
ô
->
idx
 = 0;

14675 
p
 = 
	`JS_VALUE_GET_OBJ
(
íum_obj
);

14676 
p
->
u
.
f‹_ö_ôî©‹
 = 
ô
;

14678 i‡(
èg
 =
JS_TAG_NULL
 ||Åag =
JS_TAG_UNDEFINED
)

14679  
íum_obj
;

14681 
p
 = 
	`JS_VALUE_GET_OBJ
(
obj
);

14684 
p1
 = 
p
->
sh≠e
->
¥Ÿo
;

14685 
p1
 !
NULL
) {

14686 i‡(
	`JS_GëOwnPr›îtyNamesI¡î«l
(
˘x
, &
èb_©om
, &
èb_©om_cou¡
, 
p1
,

14687 
JS_GPN_STRING_MASK
 | 
JS_GPN_ENUM_ONLY
))

14688 
Áû
;

14689 
	`js_‰ì_¥›_íum
(
˘x
, 
èb_©om
, 
èb_©om_cou¡
);

14690 i‡(
èb_©om_cou¡
 != 0) {

14691 
¶ow_∑th
;

14693 
p1
 =Ö1->
sh≠e
->
¥Ÿo
;

14695 i‡(
p
->
Á°_¨øy
) {

14696 
JSSh≠e
 *
sh
;

14697 
JSSh≠ePr›îty
 *
¥s
;

14699 
sh
 = 
p
->
sh≠e
;

14700 
i
 = 0, 
¥s
 = 
	`gë_sh≠e_¥›
(
sh
); i < sh->
¥›_cou¡
; i++,Örs++) {

14701 i‡(
¥s
->
Êags
 & 
JS_PROP_ENUMERABLE
)

14702 
n‹mÆ_ˇ£
;

14706 i‡((
p
->
˛ass_id
 >
JS_CLASS_UINT8C_ARRAY
 &&

14707 
p
->
˛ass_id
 <
JS_CLASS_FLOAT64_ARRAY
) &&

14708 
	`ty≥d_¨øy_is_dëached
(
˘x
, 
p
) &&

14709 
	`ty≥d_¨øy_gë_Àngth
(
˘x
, 
p
) != 0) {

14710 
	`JS_ThrowTy≥Eº‹DëachedAºayBuf„r
(
˘x
);

14711 
Áû
;

14714 
ô
->
is_¨øy
 = 
TRUE
;

14715 
ô
->
¨øy_Àngth
 = 
p
->
u
.
¨øy
.
cou¡
;

14717 
n‹mÆ_ˇ£
:

14718 i‡(
	`JS_GëOwnPr›îtyNamesI¡î«l
(
˘x
, &
èb_©om
, &
èb_©om_cou¡
, 
p
,

14719 
JS_GPN_STRING_MASK
 | 
JS_GPN_ENUM_ONLY
))

14720 
Áû
;

14721 
i
 = 0; i < 
èb_©om_cou¡
; i++) {

14722 
	`JS_SëPr›îtyI¡î«l
(
˘x
, 
íum_obj
, 
èb_©om
[
i
].
©om
, 
JS_NULL
, 0);

14724 
	`js_‰ì_¥›_íum
(
˘x
, 
èb_©om
, 
èb_©om_cou¡
);

14726  
íum_obj
;

14728 
¶ow_∑th
:

14731 
p
 !
NULL
) {

14732 i‡(
	`JS_GëOwnPr›îtyNamesI¡î«l
(
˘x
, &
èb_©om
, &
èb_©om_cou¡
, 
p
,

14733 
JS_GPN_STRING_MASK
 | 
JS_GPN_SET_ENUM
))

14734 
Áû
;

14735 
i
 = 0; i < 
èb_©om_cou¡
; i++) {

14736 
	`JS_DeföePr›îtyVÆue
(
˘x
, 
íum_obj
, 
èb_©om
[
i
].
©om
, 
JS_NULL
,

14737 (
èb_©om
[
i
].
is_íumîabÀ
 ?

14738 
JS_PROP_ENUMERABLE
 : 0));

14740 
	`js_‰ì_¥›_íum
(
˘x
, 
èb_©om
, 
èb_©om_cou¡
);

14741 
p
 =Ö->
sh≠e
->
¥Ÿo
;

14743  
íum_obj
;

14745 
Áû
:

14746 
	`JS_FªeVÆue
(
˘x
, 
íum_obj
);

14747  
JS_EXCEPTION
;

14748 
	}
}

14751 
__ex˚±i⁄
 
	$js_f‹_ö_°¨t
(
JSC⁄ãxt
 *
˘x
, 
JSVÆue
 *
•
)

14753 
•
[-1] = 
	`buûd_f‹_ö_ôî©‹
(
˘x
, sp[-1]);

14754 i‡(
	`JS_IsEx˚±i⁄
(
•
[-1]))

14757 
	}
}

14760 
__ex˚±i⁄
 
	$js_f‹_ö_√xt
(
JSC⁄ãxt
 *
˘x
, 
JSVÆue
 *
•
)

14762 
JSVÆueC⁄°
 
íum_obj
;

14763 
JSObje˘
 *
p
;

14764 
JSAtom
 
¥›
;

14765 
JSF‹InIãøt‹
 *
ô
;

14766 
ªt
;

14768 
íum_obj
 = 
•
[-1];

14770 i‡(
	`JS_VALUE_GET_TAG
(
íum_obj
Ë!
JS_TAG_OBJECT
)

14771 
d⁄e
;

14772 
p
 = 
	`JS_VALUE_GET_OBJ
(
íum_obj
);

14773 i‡(
p
->
˛ass_id
 !
JS_CLASS_FOR_IN_ITERATOR
)

14774 
d⁄e
;

14775 
ô
 = 
p
->
u
.
f‹_ö_ôî©‹
;

14778 i‡(
ô
->
is_¨øy
) {

14779 i‡(
ô
->
idx
 >ô->
¨øy_Àngth
)

14780 
d⁄e
;

14781 
¥›
 = 
	`__JS_AtomFromUI¡32
(
ô
->
idx
);

14782 
ô
->
idx
++;

14784 
JSSh≠e
 *
sh
 = 
p
->
sh≠e
;

14785 
JSSh≠ePr›îty
 *
¥s
;

14786 i‡(
ô
->
idx
 >
sh
->
¥›_cou¡
)

14787 
d⁄e
;

14788 
¥s
 = 
	`gë_sh≠e_¥›
(
sh
Ë+ 
ô
->
idx
;

14789 
¥›
 = 
¥s
->
©om
;

14790 
ô
->
idx
++;

14791 i‡(
¥›
 =
JS_ATOM_NULL
 || !(
¥s
->
Êags
 & 
JS_PROP_ENUMERABLE
))

14795 
ªt
 = 
	`JS_HasPr›îty
(
˘x
, 
ô
->
obj
, 
¥›
);

14796 i‡(
ªt
 < 0)

14797  
ªt
;

14798 i‡(
ªt
)

14802 
•
[0] = 
	`JS_AtomToVÆue
(
˘x
, 
¥›
);

14803 
•
[1] = 
JS_FALSE
;

14805 
d⁄e
:

14807 
•
[0] = 
JS_UNDEFINED
;

14808 
•
[1] = 
JS_TRUE
;

14810 
	}
}

14812 
JSVÆue
 
	$JS_GëIãøt‹2
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
obj
,

14813 
JSVÆueC⁄°
 
mëhod
)

14815 
JSVÆue
 
íum_obj
;

14817 
íum_obj
 = 
	`JS_CÆl
(
˘x
, 
mëhod
, 
obj
, 0, 
NULL
);

14818 i‡(
	`JS_IsEx˚±i⁄
(
íum_obj
))

14819  
íum_obj
;

14820 i‡(!
	`JS_IsObje˘
(
íum_obj
)) {

14821 
	`JS_FªeVÆue
(
˘x
, 
íum_obj
);

14822  
	`JS_ThrowTy≥Eº‹NŸAnObje˘
(
˘x
);

14824  
íum_obj
;

14825 
	}
}

14827 
JSVÆue
 
	$JS_GëIãøt‹
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
obj
, 
BOOL
 
is_async
)

14829 
JSVÆue
 
mëhod
, 
ªt
, 
sync_ôî
;

14831 i‡(
is_async
) {

14832 
mëhod
 = 
	`JS_GëPr›îty
(
˘x
, 
obj
, 
JS_ATOM_Symbﬁ_asyncIãøt‹
);

14833 i‡(
	`JS_IsEx˚±i⁄
(
mëhod
))

14834  
mëhod
;

14835 i‡(
	`JS_IsUndeföed
(
mëhod
Ë|| 
	`JS_IsNuŒ
(method)) {

14836 
mëhod
 = 
	`JS_GëPr›îty
(
˘x
, 
obj
, 
JS_ATOM_Symbﬁ_ôî©‹
);

14837 i‡(
	`JS_IsEx˚±i⁄
(
mëhod
))

14838  
mëhod
;

14839 
sync_ôî
 = 
	`JS_GëIãøt‹2
(
˘x
, 
obj
, 
mëhod
);

14840 
	`JS_FªeVÆue
(
˘x
, 
mëhod
);

14841 i‡(
	`JS_IsEx˚±i⁄
(
sync_ôî
))

14842  
sync_ôî
;

14843 
ªt
 = 
	`JS_Cª©eAsyncFromSyncIãøt‹
(
˘x
, 
sync_ôî
);

14844 
	`JS_FªeVÆue
(
˘x
, 
sync_ôî
);

14845  
ªt
;

14848 
mëhod
 = 
	`JS_GëPr›îty
(
˘x
, 
obj
, 
JS_ATOM_Symbﬁ_ôî©‹
);

14849 i‡(
	`JS_IsEx˚±i⁄
(
mëhod
))

14850  
mëhod
;

14852 i‡(!
	`JS_IsFun˘i⁄
(
˘x
, 
mëhod
)) {

14853 
	`JS_FªeVÆue
(
˘x
, 
mëhod
);

14854  
	`JS_ThrowTy≥Eº‹
(
˘x
, "value isÇot iterable");

14856 
ªt
 = 
	`JS_GëIãøt‹2
(
˘x
, 
obj
, 
mëhod
);

14857 
	`JS_FªeVÆue
(
˘x
, 
mëhod
);

14858  
ªt
;

14859 
	}
}

14862 
JSVÆue
 
	$JS_Iãøt‹Next2
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
íum_obj
,

14863 
JSVÆueC⁄°
 
mëhod
,

14864 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
, *
pd⁄e
)

14866 
JSVÆue
 
obj
;

14870 i‡(
	`JS_IsObje˘
(
mëhod
)) {

14871 
JSObje˘
 *
p
 = 
	`JS_VALUE_GET_OBJ
(
mëhod
);

14872 i‡(
p
->
˛ass_id
 =
JS_CLASS_C_FUNCTION
 &&

14873 
p
->
u
.
cfunc
.
˝rŸo
 =
JS_CFUNC_ôî©‹_√xt
) {

14874 
JSCFun˘i⁄Ty≥
 
func
;

14875 
JSVÆueC⁄°
 
¨gs
[1];

14878 i‡(
¨gc
 == 0) {

14879 
¨gs
[0] = 
JS_UNDEFINED
;

14880 
¨gv
 = 
¨gs
;

14882 
func
 = 
p
->
u
.
cfunc
.
c_fun˘i⁄
;

14883  
func
.
	`ôî©‹_√xt
(
˘x
, 
íum_obj
, 
¨gc
, 
¨gv
,

14884 
pd⁄e
, 
p
->
u
.
cfunc
.
magic
);

14887 
obj
 = 
	`JS_CÆl
(
˘x
, 
mëhod
, 
íum_obj
, 
¨gc
, 
¨gv
);

14888 i‡(
	`JS_IsEx˚±i⁄
(
obj
))

14889 
Áû
;

14890 i‡(!
	`JS_IsObje˘
(
obj
)) {

14891 
	`JS_FªeVÆue
(
˘x
, 
obj
);

14892 
	`JS_ThrowTy≥Eº‹
(
˘x
, "iterator mustÑeturnán object");

14893 
Áû
;

14895 *
pd⁄e
 = 2;

14896  
obj
;

14897 
Áû
:

14898 *
pd⁄e
 = 
FALSE
;

14899  
JS_EXCEPTION
;

14900 
	}
}

14902 
JSVÆue
 
	$JS_Iãøt‹Next
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
íum_obj
,

14903 
JSVÆueC⁄°
 
mëhod
,

14904 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
, 
BOOL
 *
pd⁄e
)

14906 
JSVÆue
 
obj
, 
vÆue
, 
d⁄e_vÆ
;

14907 
d⁄e
;

14909 
obj
 = 
	`JS_Iãøt‹Next2
(
˘x
, 
íum_obj
, 
mëhod
, 
¨gc
, 
¨gv
, &
d⁄e
);

14910 i‡(
	`JS_IsEx˚±i⁄
(
obj
))

14911 
Áû
;

14912 i‡(
d⁄e
 != 2) {

14913 *
pd⁄e
 = 
d⁄e
;

14914  
obj
;

14916 
d⁄e_vÆ
 = 
	`JS_GëPr›îty
(
˘x
, 
obj
, 
JS_ATOM_d⁄e
);

14917 i‡(
	`JS_IsEx˚±i⁄
(
d⁄e_vÆ
))

14918 
Áû
;

14919 *
pd⁄e
 = 
	`JS_ToBoﬁFªe
(
˘x
, 
d⁄e_vÆ
);

14920 
vÆue
 = 
JS_UNDEFINED
;

14921 i‡(!*
pd⁄e
) {

14922 
vÆue
 = 
	`JS_GëPr›îty
(
˘x
, 
obj
, 
JS_ATOM_vÆue
);

14924 
	`JS_FªeVÆue
(
˘x
, 
obj
);

14925  
vÆue
;

14927 
Áû
:

14928 
	`JS_FªeVÆue
(
˘x
, 
obj
);

14929 *
pd⁄e
 = 
FALSE
;

14930  
JS_EXCEPTION
;

14931 
	}
}

14934 
	$JS_Iãøt‹Clo£
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
íum_obj
,

14935 
BOOL
 
is_ex˚±i⁄_≥ndög
)

14937 
JSVÆue
 
mëhod
, 
ªt
, 
ex_obj
;

14938 
ªs
;

14940 i‡(
is_ex˚±i⁄_≥ndög
) {

14941 
ex_obj
 = 
˘x
->
π
->
cuºít_ex˚±i⁄
;

14942 
˘x
->
π
->
cuºít_ex˚±i⁄
 = 
JS_NULL
;

14943 
ªs
 = -1;

14945 
ex_obj
 = 
JS_UNDEFINED
;

14946 
ªs
 = 0;

14948 
mëhod
 = 
	`JS_GëPr›îty
(
˘x
, 
íum_obj
, 
JS_ATOM_ªtu∫
);

14949 i‡(
	`JS_IsEx˚±i⁄
(
mëhod
)) {

14950 
ªs
 = -1;

14951 
d⁄e
;

14953 i‡(
	`JS_IsUndeföed
(
mëhod
Ë|| 
	`JS_IsNuŒ
(method)) {

14954 
d⁄e
;

14956 
ªt
 = 
	`JS_CÆlFªe
(
˘x
, 
mëhod
, 
íum_obj
, 0, 
NULL
);

14957 i‡(!
is_ex˚±i⁄_≥ndög
) {

14958 i‡(
	`JS_IsEx˚±i⁄
(
ªt
)) {

14959 
ªs
 = -1;

14960 } i‡(!
	`JS_IsObje˘
(
ªt
)) {

14961 
	`JS_ThrowTy≥Eº‹NŸAnObje˘
(
˘x
);

14962 
ªs
 = -1;

14965 
	`JS_FªeVÆue
(
˘x
, 
ªt
);

14966 
d⁄e
:

14967 i‡(
is_ex˚±i⁄_≥ndög
) {

14968 
	`JS_Throw
(
˘x
, 
ex_obj
);

14970  
ªs
;

14971 
	}
}

14974 
__ex˚±i⁄
 
	$js_f‹_of_°¨t
(
JSC⁄ãxt
 *
˘x
, 
JSVÆue
 *
•
,

14975 
BOOL
 
is_async
)

14977 
JSVÆue
 
›1
, 
obj
, 
mëhod
;

14978 
›1
 = 
•
[-1];

14979 
obj
 = 
	`JS_GëIãøt‹
(
˘x
, 
›1
, 
is_async
);

14980 i‡(
	`JS_IsEx˚±i⁄
(
obj
))

14982 
	`JS_FªeVÆue
(
˘x
, 
›1
);

14983 
•
[-1] = 
obj
;

14984 
mëhod
 = 
	`JS_GëPr›îty
(
˘x
, 
obj
, 
JS_ATOM_√xt
);

14985 i‡(
	`JS_IsEx˚±i⁄
(
mëhod
))

14987 
•
[0] = 
mëhod
;

14989 
	}
}

14992 
__ex˚±i⁄
 
	$js_f‹_of_√xt
(
JSC⁄ãxt
 *
˘x
, 
JSVÆue
 *
•
, 
off£t
)

14994 
JSVÆue
 
vÆue
 = 
JS_UNDEFINED
;

14995 
d⁄e
 = 1;

14997 i‡(
	`likñy
(!
	`JS_IsUndeföed
(
•
[
off£t
]))) {

14998 
vÆue
 = 
	`JS_Iãøt‹Next
(
˘x
, 
•
[
off£t
], sp[off£à+ 1], 0, 
NULL
, &
d⁄e
);

14999 i‡(
	`JS_IsEx˚±i⁄
(
vÆue
))

15000 
d⁄e
 = -1;

15001 i‡(
d⁄e
) {

15004 
	`JS_FªeVÆue
(
˘x
, 
•
[
off£t
]);

15005 
•
[
off£t
] = 
JS_UNDEFINED
;

15006 i‡(
d⁄e
 < 0)

15010 
•
[0] = 
vÆue
;

15011 
•
[1] = 
	`JS_NewBoﬁ
(
˘x
, 
d⁄e
);

15013 
	}
}

15015 
__ex˚±i⁄
 
	$js_f‹_awaô_of_√xt
(
JSC⁄ãxt
 *
˘x
, 
JSVÆue
 *
•
)

15017 
JSVÆue
 
ªsu…
;

15018 
ªsu…
 = 
	`JS_CÆl
(
˘x
, 
•
[-2], sp[-3], 0, 
NULL
);

15019 i‡(
	`JS_IsEx˚±i⁄
(
ªsu…
))

15021 
•
[0] = 
ªsu…
;

15023 
	}
}

15025 
JSVÆue
 
	$JS_Iãøt‹GëCom∂ëeVÆue
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
obj
,

15026 
BOOL
 *
pd⁄e
)

15028 
JSVÆue
 
d⁄e_vÆ
, 
vÆue
;

15029 
BOOL
 
d⁄e
;

15030 
d⁄e_vÆ
 = 
	`JS_GëPr›îty
(
˘x
, 
obj
, 
JS_ATOM_d⁄e
);

15031 i‡(
	`JS_IsEx˚±i⁄
(
d⁄e_vÆ
))

15032 
Áû
;

15033 
d⁄e
 = 
	`JS_ToBoﬁFªe
(
˘x
, 
d⁄e_vÆ
);

15034 
vÆue
 = 
	`JS_GëPr›îty
(
˘x
, 
obj
, 
JS_ATOM_vÆue
);

15035 i‡(
	`JS_IsEx˚±i⁄
(
vÆue
))

15036 
Áû
;

15037 *
pd⁄e
 = 
d⁄e
;

15038  
vÆue
;

15039 
Áû
:

15040 *
pd⁄e
 = 
FALSE
;

15041  
JS_EXCEPTION
;

15042 
	}
}

15044 
__ex˚±i⁄
 
	$js_ôî©‹_gë_vÆue_d⁄e
(
JSC⁄ãxt
 *
˘x
, 
JSVÆue
 *
•
)

15046 
JSVÆue
 
obj
, 
vÆue
;

15047 
BOOL
 
d⁄e
;

15048 
obj
 = 
•
[-1];

15049 i‡(!
	`JS_IsObje˘
(
obj
)) {

15050 
	`JS_ThrowTy≥Eº‹
(
˘x
, "iterator mustÑeturnán object");

15053 
vÆue
 = 
	`JS_Iãøt‹GëCom∂ëeVÆue
(
˘x
, 
obj
, &
d⁄e
);

15054 i‡(
	`JS_IsEx˚±i⁄
(
vÆue
))

15056 
	`JS_FªeVÆue
(
˘x
, 
obj
);

15057 
•
[-1] = 
vÆue
;

15058 
•
[0] = 
	`JS_NewBoﬁ
(
˘x
, 
d⁄e
);

15060 
	}
}

15062 
JSVÆue
 
	$js_¸óã_ôî©‹_ªsu…
(
JSC⁄ãxt
 *
˘x
,

15063 
JSVÆue
 
vÆ
,

15064 
BOOL
 
d⁄e
)

15066 
JSVÆue
 
obj
;

15067 
obj
 = 
	`JS_NewObje˘
(
˘x
);

15068 i‡(
	`JS_IsEx˚±i⁄
(
obj
)) {

15069 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

15070  
obj
;

15072 i‡(
	`JS_DeföePr›îtyVÆue
(
˘x
, 
obj
, 
JS_ATOM_vÆue
,

15073 
vÆ
, 
JS_PROP_C_W_E
) < 0) {

15074 
Áû
;

15076 i‡(
	`JS_DeföePr›îtyVÆue
(
˘x
, 
obj
, 
JS_ATOM_d⁄e
,

15077 
	`JS_NewBoﬁ
(
˘x
, 
d⁄e
), 
JS_PROP_C_W_E
) < 0) {

15078 
Áû
:

15079 
	`JS_FªeVÆue
(
˘x
, 
obj
);

15080  
JS_EXCEPTION
;

15082  
obj
;

15083 
	}
}

15085 
JSVÆue
 
js_¨øy_ôî©‹_√xt
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

15086 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
,

15087 
BOOL
 *
pd⁄e
, 
magic
);

15089 
JSVÆue
 
js_¸óã_¨øy_ôî©‹
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

15090 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
, 
magic
);

15092 
BOOL
 
	$js_is_Á°_¨øy
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
obj
)

15095 i‡(
	`JS_VALUE_GET_TAG
(
obj
Ë=
JS_TAG_OBJECT
) {

15096 
JSObje˘
 *
p
 = 
	`JS_VALUE_GET_OBJ
(
obj
);

15097 i‡(
p
->
˛ass_id
 =
JS_CLASS_ARRAY
 &&Ö->
Á°_¨øy
) {

15098  
TRUE
;

15101  
FALSE
;

15102 
	}
}

15105 
BOOL
 
	$js_gë_Á°_¨øy
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
obj
,

15106 
JSVÆue
 **
¨Ωp
, 
uöt32_t
 *
cou¡p
)

15109 i‡(
	`JS_VALUE_GET_TAG
(
obj
Ë=
JS_TAG_OBJECT
) {

15110 
JSObje˘
 *
p
 = 
	`JS_VALUE_GET_OBJ
(
obj
);

15111 i‡(
p
->
˛ass_id
 =
JS_CLASS_ARRAY
 &&Ö->
Á°_¨øy
) {

15112 *
cou¡p
 = 
p
->
u
.
¨øy
.
cou¡
;

15113 *
¨Ωp
 = 
p
->
u
.
¨øy
.u.
vÆues
;

15114  
TRUE
;

15117  
FALSE
;

15118 
	}
}

15120 
__ex˚±i⁄
 
	$js_≠≥nd_íumî©e
(
JSC⁄ãxt
 *
˘x
, 
JSVÆue
 *
•
)

15122 
JSVÆue
 
ôî©‹
, 
íumobj
, 
mëhod
, 
vÆue
;

15123 
pos
, 
is_¨øy_ôî©‹
;

15124 
JSVÆue
 *
¨Ω
;

15125 
uöt32_t
 
i
, 
cou¡32
;

15127 i‡(
	`JS_VALUE_GET_TAG
(
•
[-2]Ë!
JS_TAG_INT
) {

15128 
	`JS_ThrowI¡î«lEº‹
(
˘x
, "invalid index foráppend");

15132 
pos
 = 
	`JS_VALUE_GET_INT
(
•
[-2]);

15140 
ôî©‹
 = 
	`JS_GëPr›îty
(
˘x
, 
•
[-1], 
JS_ATOM_Symbﬁ_ôî©‹
);

15141 i‡(
	`JS_IsEx˚±i⁄
(
ôî©‹
))

15143 
is_¨øy_ôî©‹
 = 
	`JS_IsCFun˘i⁄
(
˘x
, 
ôî©‹
,

15144 (
JSCFun˘i⁄
 *)
js_¸óã_¨øy_ôî©‹
,

15145 
JS_ITERATOR_KIND_VALUE
);

15146 
	`JS_FªeVÆue
(
˘x
, 
ôî©‹
);

15148 
íumobj
 = 
	`JS_GëIãøt‹
(
˘x
, 
•
[-1], 
FALSE
);

15149 i‡(
	`JS_IsEx˚±i⁄
(
íumobj
))

15151 
mëhod
 = 
	`JS_GëPr›îty
(
˘x
, 
íumobj
, 
JS_ATOM_√xt
);

15152 i‡(
	`JS_IsEx˚±i⁄
(
mëhod
)) {

15153 
	`JS_FªeVÆue
(
˘x
, 
íumobj
);

15156 i‡(
is_¨øy_ôî©‹


15157 && 
	`JS_IsCFun˘i⁄
(
˘x
, 
mëhod
, (
JSCFun˘i⁄
 *)
js_¨øy_ôî©‹_√xt
, 0)

15158 && 
	`js_gë_Á°_¨øy
(
˘x
, 
•
[-1], &
¨Ω
, &
cou¡32
)) {

15159 
söt64_t
 
Àn
;

15161 i‡(
	`js_gë_Àngth64
(
˘x
, &
Àn
, 
•
[-1]))

15162 
ex˚±i⁄
;

15163 
i
 = 0; i < 
cou¡32
; i++) {

15164 i‡(
	`JS_DeföePr›îtyVÆueUöt32
(
˘x
, 
•
[-3], 
pos
++,

15165 
	`JS_DupVÆue
(
˘x
, 
¨Ω
[
i
]), 
JS_PROP_C_W_E
) < 0)

15166 
ex˚±i⁄
;

15168 i‡(
Àn
 > 
cou¡32
) {

15172 
pos
 +
Àn
 - 
cou¡32
;

15173 i‡(
	`JS_SëPr›îty
(
˘x
, 
•
[-3], 
JS_ATOM_Àngth
, 
	`JS_NewUöt32
(˘x, 
pos
)) < 0)

15174 
ex˚±i⁄
;

15178 
BOOL
 
d⁄e
;

15179 
vÆue
 = 
	`JS_Iãøt‹Next
(
˘x
, 
íumobj
, 
mëhod
, 0, 
NULL
, &
d⁄e
);

15180 i‡(
	`JS_IsEx˚±i⁄
(
vÆue
))

15181 
ex˚±i⁄
;

15182 i‡(
d⁄e
) {

15186 i‡(
	`JS_DeföePr›îtyVÆueUöt32
(
˘x
, 
•
[-3], 
pos
++, 
vÆue
, 
JS_PROP_C_W_E
) < 0)

15187 
ex˚±i⁄
;

15190 
•
[-2] = 
	`JS_NewI¡32
(
˘x
, 
pos
);

15191 
	`JS_FªeVÆue
(
˘x
, 
íumobj
);

15192 
	`JS_FªeVÆue
(
˘x
, 
mëhod
);

15195 
ex˚±i⁄
:

15196 
	`JS_Iãøt‹Clo£
(
˘x
, 
íumobj
, 
TRUE
);

15197 
	`JS_FªeVÆue
(
˘x
, 
íumobj
);

15198 
	`JS_FªeVÆue
(
˘x
, 
mëhod
);

15200 
	}
}

15202 
__ex˚±i⁄
 
	$JS_C›yD©aPr›îtõs
(
JSC⁄ãxt
 *
˘x
,

15203 
JSVÆueC⁄°
 
èrgë
,

15204 
JSVÆueC⁄°
 
sour˚
,

15205 
JSVÆueC⁄°
 
ex˛uded
,

15206 
BOOL
 
£çr›
)

15208 
JSPr›îtyEnum
 *
èb_©om
;

15209 
JSVÆue
 
vÆ
;

15210 
uöt32_t
 
i
, 
èb_©om_cou¡
;

15211 
JSObje˘
 *
p
;

15212 
JSObje˘
 *
≥x˛
 = 
NULL
;

15213 
ªt
 = 0, 
Êags
;

15215 i‡(
	`JS_VALUE_GET_TAG
(
sour˚
Ë!
JS_TAG_OBJECT
)

15218 i‡(
	`JS_VALUE_GET_TAG
(
ex˛uded
Ë=
JS_TAG_OBJECT
)

15219 
≥x˛
 = 
	`JS_VALUE_GET_OBJ
(
ex˛uded
);

15221 
p
 = 
	`JS_VALUE_GET_OBJ
(
sour˚
);

15222 i‡(
	`JS_GëOwnPr›îtyNamesI¡î«l
(
˘x
, &
èb_©om
, &
èb_©om_cou¡
, 
p
,

15223 
JS_GPN_STRING_MASK
 | 
JS_GPN_SYMBOL_MASK
 |

15224 
JS_GPN_ENUM_ONLY
))

15227 
Êags
 = 
JS_PROP_C_W_E
;

15229 
i
 = 0; i < 
èb_©om_cou¡
; i++) {

15230 i‡(
≥x˛
) {

15231 
ªt
 = 
	`JS_GëOwnPr›îtyI¡î«l
(
˘x
, 
NULL
, 
≥x˛
, 
èb_©om
[
i
].
©om
);

15232 i‡(
ªt
) {

15233 i‡(
ªt
 < 0)

15235 
ªt
 = 0;

15239 
ªt
 = -1;

15240 
vÆ
 = 
	`JS_GëPr›îty
(
˘x
, 
sour˚
, 
èb_©om
[
i
].
©om
);

15241 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

15243 i‡(
£çr›
)

15244 
ªt
 = 
	`JS_SëPr›îty
(
˘x
, 
èrgë
, 
èb_©om
[
i
].
©om
, 
vÆ
);

15246 
ªt
 = 
	`JS_DeföePr›îtyVÆue
(
˘x
, 
èrgë
, 
èb_©om
[
i
].
©om
, 
vÆ
, 
Êags
);

15247 i‡(
ªt
 < 0)

15249 
ªt
 = 0;

15251 
	`js_‰ì_¥›_íum
(
˘x
, 
èb_©om
, 
èb_©om_cou¡
);

15252  
ªt
;

15253 
	}
}

15256 
JSVÆueC⁄°
 
	$JS_GëA˘iveFun˘i⁄
(
JSC⁄ãxt
 *
˘x
)

15258  
˘x
->
π
->
cuºít_°ack_‰ame
->
cur_func
;

15259 
	}
}

15261 
JSV¨Ref
 *
	$gë_v¨_ªf
(
JSC⁄ãxt
 *
˘x
, 
JSSèckFøme
 *
sf
,

15262 
v¨_idx
, 
BOOL
 
is_¨g
)

15264 
JSV¨Ref
 *
v¨_ªf
;

15265 
li°_hód
 *
ñ
;

15267 
	`li°_f‹_óch
(
ñ
, &
sf
->
v¨_ªf_li°
) {

15268 
v¨_ªf
 = 
	`li°_íåy
(
ñ
, 
JSV¨Ref
, 
hódî
.
lök
);

15269 i‡(
v¨_ªf
->
v¨_idx
 =v¨_idx && v¨_ªf->
is_¨g
 == is_arg) {

15270 
v¨_ªf
->
hódî
.
ªf_cou¡
++;

15271  
v¨_ªf
;

15275 
v¨_ªf
 = 
	`js_mÆloc
(
˘x
, (
JSV¨Ref
));

15276 i‡(!
v¨_ªf
)

15277  
NULL
;

15278 
v¨_ªf
->
hódî
.
ªf_cou¡
 = 1;

15279 
v¨_ªf
->
is_dëached
 = 
FALSE
;

15280 
v¨_ªf
->
is_¨g
 = is_arg;

15281 
v¨_ªf
->
v¨_idx
 = var_idx;

15282 
	`li°_add_èû
(&
v¨_ªf
->
hódî
.
lök
, &
sf
->
v¨_ªf_li°
);

15283 i‡(
is_¨g
)

15284 
v¨_ªf
->
pvÆue
 = &
sf
->
¨g_buf
[
v¨_idx
];

15286 
v¨_ªf
->
pvÆue
 = &
sf
->
v¨_buf
[
v¨_idx
];

15287 
v¨_ªf
->
vÆue
 = 
JS_UNDEFINED
;

15288  
v¨_ªf
;

15289 
	}
}

15291 
JSVÆue
 
	$js_˛osuª2
(
JSC⁄ãxt
 *
˘x
, 
JSVÆue
 
func_obj
,

15292 
JSFun˘i⁄Byãcode
 *
b
,

15293 
JSV¨Ref
 **
cur_v¨_ªfs
,

15294 
JSSèckFøme
 *
sf
)

15296 
JSObje˘
 *
p
;

15297 
JSV¨Ref
 **
v¨_ªfs
;

15298 
i
;

15300 
p
 = 
	`JS_VALUE_GET_OBJ
(
func_obj
);

15301 
p
->
u
.
func
.
fun˘i⁄_byãcode
 = 
b
;

15302 
p
->
u
.
func
.
home_obje˘
 = 
NULL
;

15303 
p
->
u
.
func
.
v¨_ªfs
 = 
NULL
;

15304 i‡(
b
->
˛osuª_v¨_cou¡
) {

15305 
v¨_ªfs
 = 
	`js_mÆlocz
(
˘x
, (v¨_ªfs[0]Ë* 
b
->
˛osuª_v¨_cou¡
);

15306 i‡(!
v¨_ªfs
)

15307 
Áû
;

15308 
p
->
u
.
func
.
v¨_ªfs
 = var_refs;

15309 
i
 = 0; i < 
b
->
˛osuª_v¨_cou¡
; i++) {

15310 
JSClosuªV¨
 *
cv
 = &
b
->
˛osuª_v¨
[
i
];

15311 
JSV¨Ref
 *
v¨_ªf
;

15312 i‡(
cv
->
is_loˇl
) {

15314 
v¨_ªf
 = 
	`gë_v¨_ªf
(
˘x
, 
sf
, 
cv
->
v¨_idx
, cv->
is_¨g
);

15315 i‡(!
v¨_ªf
)

15316 
Áû
;

15318 
v¨_ªf
 = 
cur_v¨_ªfs
[
cv
->
v¨_idx
];

15319 
v¨_ªf
->
hódî
.
ªf_cou¡
++;

15321 
v¨_ªfs
[
i
] = 
v¨_ªf
;

15324  
func_obj
;

15325 
Áû
:

15327 
	`JS_FªeVÆue
(
˘x
, 
func_obj
);

15328  
JS_EXCEPTION
;

15329 
	}
}

15331 
	$js_ö°™tüã_¥ŸŸy≥
(
JSC⁄ãxt
 *
˘x
, 
JSObje˘
 *
p
, 
JSAtom
 
©om
, *
›aque
)

15333 
JSVÆue
 
obj
, 
this_vÆ
;

15334 
ªt
;

15336 
this_vÆ
 = 
	`JS_MKPTR
(
JS_TAG_OBJECT
, 
p
);

15337 
obj
 = 
	`JS_NewObje˘
(
˘x
);

15338 i‡(
	`JS_IsEx˚±i⁄
(
obj
))

15340 
	`£t_cy˛e_Êag
(
˘x
, 
obj
);

15341 
	`£t_cy˛e_Êag
(
˘x
, 
this_vÆ
);

15342 
ªt
 = 
	`JS_DeföePr›îtyVÆue
(
˘x
, 
obj
, 
JS_ATOM_c⁄°ru˘‹
,

15343 
	`JS_DupVÆue
(
˘x
, 
this_vÆ
),

15344 
JS_PROP_WRITABLE
 | 
JS_PROP_CONFIGURABLE
);

15345 i‡(
	`JS_DeföePr›îtyVÆue
(
˘x
, 
this_vÆ
, 
©om
, 
obj
, 
JS_PROP_WRITABLE
Ë< 0 || 
ªt
 < 0)

15348 
	}
}

15350 c⁄° 
uöt16_t
 
	gfunc_köd_to_˛ass_id
[] = {

15351 [
JS_FUNC_NORMAL
] = 
JS_CLASS_BYTECODE_FUNCTION
,

15352 [
JS_FUNC_GENERATOR
] = 
JS_CLASS_GENERATOR_FUNCTION
,

15353 [
JS_FUNC_ASYNC
] = 
JS_CLASS_ASYNC_FUNCTION
,

15354 [
JS_FUNC_ASYNC_GENERATOR
] = 
JS_CLASS_ASYNC_GENERATOR_FUNCTION
,

15357 
JSVÆue
 
	$js_˛osuª
(
JSC⁄ãxt
 *
˘x
, 
JSVÆue
 
bfunc
,

15358 
JSV¨Ref
 **
cur_v¨_ªfs
,

15359 
JSSèckFøme
 *
sf
)

15361 
JSFun˘i⁄Byãcode
 *
b
;

15362 
JSVÆue
 
func_obj
;

15363 
JSAtom
 
«me_©om
;

15365 
b
 = 
	`JS_VALUE_GET_PTR
(
bfunc
);

15366 
func_obj
 = 
	`JS_NewObje˘Cœss
(
˘x
, 
func_köd_to_˛ass_id
[
b
->
func_köd
]);

15367 i‡(
	`JS_IsEx˚±i⁄
(
func_obj
)) {

15368 
	`JS_FªeVÆue
(
˘x
, 
bfunc
);

15369  
JS_EXCEPTION
;

15371 
func_obj
 = 
	`js_˛osuª2
(
˘x
, func_obj, 
b
, 
cur_v¨_ªfs
, 
sf
);

15372 i‡(
	`JS_IsEx˚±i⁄
(
func_obj
)) {

15374 
Áû
;

15376 
«me_©om
 = 
b
->
func_«me
;

15377 i‡(
«me_©om
 =
JS_ATOM_NULL
)

15378 
«me_©om
 = 
JS_ATOM_em±y_°rög
;

15379 
	`js_fun˘i⁄_£t_¥›îtõs
(
˘x
, 
func_obj
, 
«me_©om
,

15380 
b
->
deföed_¨g_cou¡
);

15382 i‡(
b
->
func_köd
 & 
JS_FUNC_GENERATOR
) {

15383 
JSVÆue
 
¥Ÿo
;

15384 
¥Ÿo_˛ass_id
;

15387 i‡(
b
->
func_köd
 =
JS_FUNC_ASYNC_GENERATOR
)

15388 
¥Ÿo_˛ass_id
 = 
JS_CLASS_ASYNC_GENERATOR
;

15390 
¥Ÿo_˛ass_id
 = 
JS_CLASS_GENERATOR
;

15391 
¥Ÿo
 = 
	`JS_NewObje˘PrŸo
(
˘x
, ctx->
˛ass_¥Ÿo
[
¥Ÿo_˛ass_id
]);

15392 i‡(
	`JS_IsEx˚±i⁄
(
¥Ÿo
))

15393 
Áû
;

15394 
	`JS_DeföePr›îtyVÆue
(
˘x
, 
func_obj
, 
JS_ATOM_¥ŸŸy≥
, 
¥Ÿo
,

15395 
JS_PROP_WRITABLE
);

15396 } i‡(
b
->
has_¥ŸŸy≥
) {

15400 
	`JS_SëC⁄°ru˘‹Bô
(
˘x
, 
func_obj
, 
TRUE
);

15401 
	`JS_DeföeAutoInôPr›îty
(
˘x
, 
func_obj
, 
JS_ATOM_¥ŸŸy≥
,

15402 
JS_AUTOINIT_ID_PROTOTYPE
, 
NULL
,

15403 
JS_PROP_WRITABLE
);

15405  
func_obj
;

15406 
Áû
:

15408 
	`JS_FªeVÆue
(
˘x
, 
func_obj
);

15409  
JS_EXCEPTION
;

15410 
	}
}

15412 
	#JS_DEFINE_CLASS_HAS_HERITAGE
 (1 << 0)

	)

15414 
	$js_›_deföe_˛ass
(
JSC⁄ãxt
 *
˘x
, 
JSVÆue
 *
•
,

15415 
JSAtom
 
˛ass_«me
, 
˛ass_Êags
,

15416 
JSV¨Ref
 **
cur_v¨_ªfs
,

15417 
JSSèckFøme
 *
sf
, 
BOOL
 
is_compuãd_«me
)

15419 
JSVÆue
 
bfunc
, 
∑ª¡_˛ass
, 
¥Ÿo
 = 
JS_UNDEFINED
;

15420 
JSVÆue
 
˘‹
 = 
JS_UNDEFINED
, 
∑ª¡_¥Ÿo
 = JS_UNDEFINED;

15421 
JSFun˘i⁄Byãcode
 *
b
;

15423 
∑ª¡_˛ass
 = 
•
[-2];

15424 
bfunc
 = 
•
[-1];

15426 i‡(
˛ass_Êags
 & 
JS_DEFINE_CLASS_HAS_HERITAGE
) {

15427 i‡(
	`JS_IsNuŒ
(
∑ª¡_˛ass
)) {

15428 
∑ª¡_¥Ÿo
 = 
JS_NULL
;

15429 
∑ª¡_˛ass
 = 
	`JS_DupVÆue
(
˘x
, ctx->
fun˘i⁄_¥Ÿo
);

15431 i‡(!
	`JS_IsC⁄°ru˘‹
(
˘x
, 
∑ª¡_˛ass
)) {

15432 
	`JS_ThrowTy≥Eº‹
(
˘x
, "parent class must be constructor");

15433 
Áû
;

15435 
∑ª¡_¥Ÿo
 = 
	`JS_GëPr›îty
(
˘x
, 
∑ª¡_˛ass
, 
JS_ATOM_¥ŸŸy≥
);

15436 i‡(
	`JS_IsEx˚±i⁄
(
∑ª¡_¥Ÿo
))

15437 
Áû
;

15438 i‡(!
	`JS_IsNuŒ
(
∑ª¡_¥Ÿo
Ë&& !
	`JS_IsObje˘
(parent_proto)) {

15439 
	`JS_ThrowTy≥Eº‹
(
˘x
, "parentÖrototype must beán object orÇull");

15440 
Áû
;

15445 
∑ª¡_¥Ÿo
 = 
	`JS_DupVÆue
(
˘x
, ctx->
˛ass_¥Ÿo
[
JS_CLASS_OBJECT
]);

15446 
∑ª¡_˛ass
 = 
	`JS_DupVÆue
(
˘x
, ctx->
fun˘i⁄_¥Ÿo
);

15448 
¥Ÿo
 = 
	`JS_NewObje˘PrŸo
(
˘x
, 
∑ª¡_¥Ÿo
);

15449 i‡(
	`JS_IsEx˚±i⁄
(
¥Ÿo
))

15450 
Áû
;

15452 
b
 = 
	`JS_VALUE_GET_PTR
(
bfunc
);

15453 
	`as£π
(
b
->
func_köd
 =
JS_FUNC_NORMAL
);

15454 
˘‹
 = 
	`JS_NewObje˘PrŸoCœss
(
˘x
, 
∑ª¡_˛ass
,

15455 
JS_CLASS_BYTECODE_FUNCTION
);

15456 i‡(
	`JS_IsEx˚±i⁄
(
˘‹
))

15457 
Áû
;

15458 
˘‹
 = 
	`js_˛osuª2
(
˘x
, ct‹, 
b
, 
cur_v¨_ªfs
, 
sf
);

15459 
bfunc
 = 
JS_UNDEFINED
;

15460 i‡(
	`JS_IsEx˚±i⁄
(
˘‹
))

15461 
Áû
;

15462 
	`js_mëhod_£t_home_obje˘
(
˘x
, 
˘‹
, 
¥Ÿo
);

15463 
	`JS_SëC⁄°ru˘‹Bô
(
˘x
, 
˘‹
, 
TRUE
);

15465 
	`JS_DeföePr›îtyVÆue
(
˘x
, 
˘‹
, 
JS_ATOM_Àngth
,

15466 
	`JS_NewI¡32
(
˘x
, 
b
->
deföed_¨g_cou¡
),

15467 
JS_PROP_CONFIGURABLE
);

15469 i‡(
is_compuãd_«me
) {

15470 i‡(
	`JS_DeföeObje˘NameCompuãd
(
˘x
, 
˘‹
, 
•
[-3],

15471 
JS_PROP_CONFIGURABLE
) < 0)

15472 
Áû
;

15474 i‡(
	`JS_DeföeObje˘Name
(
˘x
, 
˘‹
, 
˛ass_«me
, 
JS_PROP_CONFIGURABLE
) < 0)

15475 
Áû
;

15480 i‡(
	`JS_DeföePr›îtyVÆue
(
˘x
, 
¥Ÿo
, 
JS_ATOM_c⁄°ru˘‹
,

15481 
	`JS_DupVÆue
(
˘x
, 
˘‹
),

15482 
JS_PROP_CONFIGURABLE
 |

15483 
JS_PROP_WRITABLE
 | 
JS_PROP_THROW
) < 0)

15484 
Áû
;

15486 i‡(
	`JS_DeföePr›îtyVÆue
(
˘x
, 
˘‹
, 
JS_ATOM_¥ŸŸy≥
,

15487 
	`JS_DupVÆue
(
˘x
, 
¥Ÿo
), 
JS_PROP_THROW
) < 0)

15488 
Áû
;

15489 
	`£t_cy˛e_Êag
(
˘x
, 
˘‹
);

15490 
	`£t_cy˛e_Êag
(
˘x
, 
¥Ÿo
);

15492 
	`JS_FªeVÆue
(
˘x
, 
∑ª¡_¥Ÿo
);

15493 
	`JS_FªeVÆue
(
˘x
, 
∑ª¡_˛ass
);

15495 
•
[-2] = 
˘‹
;

15496 
•
[-1] = 
¥Ÿo
;

15498 
Áû
:

15499 
	`JS_FªeVÆue
(
˘x
, 
∑ª¡_˛ass
);

15500 
	`JS_FªeVÆue
(
˘x
, 
∑ª¡_¥Ÿo
);

15501 
	`JS_FªeVÆue
(
˘x
, 
bfunc
);

15502 
	`JS_FªeVÆue
(
˘x
, 
¥Ÿo
);

15503 
	`JS_FªeVÆue
(
˘x
, 
˘‹
);

15504 
•
[-2] = 
JS_UNDEFINED
;

15505 
•
[-1] = 
JS_UNDEFINED
;

15507 
	}
}

15509 
	$˛o£_v¨_ªfs
(
JSRu¡ime
 *
π
, 
JSSèckFøme
 *
sf
)

15511 
li°_hód
 *
ñ
, *
ñ1
;

15512 
JSV¨Ref
 *
v¨_ªf
;

15513 
v¨_idx
;

15515 
	`li°_f‹_óch_ß„
(
ñ
, 
ñ1
, &
sf
->
v¨_ªf_li°
) {

15516 
v¨_ªf
 = 
	`li°_íåy
(
ñ
, 
JSV¨Ref
, 
hódî
.
lök
);

15517 
v¨_idx
 = 
v¨_ªf
->var_idx;

15518 i‡(
v¨_ªf
->
is_¨g
)

15519 
v¨_ªf
->
vÆue
 = 
	`JS_DupVÆueRT
(
π
, 
sf
->
¨g_buf
[
v¨_idx
]);

15521 
v¨_ªf
->
vÆue
 = 
	`JS_DupVÆueRT
(
π
, 
sf
->
v¨_buf
[
v¨_idx
]);

15522 
v¨_ªf
->
pvÆue
 = &v¨_ªf->
vÆue
;

15524 
v¨_ªf
->
is_dëached
 = 
TRUE
;

15525 
	`add_gc_obje˘
(
π
, &
v¨_ªf
->
hódî
, 
JS_GC_OBJ_TYPE_VAR_REF
);

15527 
	}
}

15529 
	$˛o£_Àxiˇl_v¨
(
JSC⁄ãxt
 *
˘x
, 
JSSèckFøme
 *
sf
, 
idx
, 
is_¨g
)

15531 
li°_hód
 *
ñ
, *
ñ1
;

15532 
JSV¨Ref
 *
v¨_ªf
;

15533 
v¨_idx
 = 
idx
;

15535 
	`li°_f‹_óch_ß„
(
ñ
, 
ñ1
, &
sf
->
v¨_ªf_li°
) {

15536 
v¨_ªf
 = 
	`li°_íåy
(
ñ
, 
JSV¨Ref
, 
hódî
.
lök
);

15537 i‡(
v¨_idx
 =
v¨_ªf
->v¨_idx && v¨_ªf->
is_¨g
 == is_arg) {

15538 
v¨_ªf
->
vÆue
 = 
	`JS_DupVÆue
(
˘x
, 
sf
->
v¨_buf
[
v¨_idx
]);

15539 
v¨_ªf
->
pvÆue
 = &v¨_ªf->
vÆue
;

15540 
	`li°_dñ
(&
v¨_ªf
->
hódî
.
lök
);

15542 
v¨_ªf
->
is_dëached
 = 
TRUE
;

15543 
	`add_gc_obje˘
(
˘x
->
π
, &
v¨_ªf
->
hódî
, 
JS_GC_OBJ_TYPE_VAR_REF
);

15546 
	}
}

15548 
	#JS_CALL_FLAG_COPY_ARGV
 (1 << 1)

	)

15549 
	#JS_CALL_FLAG_GENERATOR
 (1 << 2)

	)

15551 
JSVÆue
 
	$js_ˇŒ_c_fun˘i⁄
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
func_obj
,

15552 
JSVÆueC⁄°
 
this_obj
,

15553 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
, 
Êags
)

15555 
JSRu¡ime
 *
π
 = 
˘x
->rt;

15556 
JSCFun˘i⁄Ty≥
 
func
;

15557 
JSObje˘
 *
p
;

15558 
JSSèckFøme
 
sf_s
, *
sf
 = &sf_s, *
¥ev_sf
;

15559 
JSVÆue
 
ªt_vÆ
;

15560 
JSVÆueC⁄°
 *
¨g_buf
;

15561 
¨g_cou¡
, 
i
;

15562 
JSCFun˘i⁄Enum
 
˝rŸo
;

15564 
p
 = 
	`JS_VALUE_GET_OBJ
(
func_obj
);

15565 
˝rŸo
 = 
p
->
u
.
cfunc
.cproto;

15566 
¨g_cou¡
 = 
p
->
u
.
cfunc
.
Àngth
;

15569 i‡(
	`js_check_°ack_ovîÊow
(
π
, (
¨g_buf
[0]Ë* 
¨g_cou¡
))

15570  
	`JS_ThrowSèckOvîÊow
(
˘x
);

15572 
¥ev_sf
 = 
π
->
cuºít_°ack_‰ame
;

15573 
sf
->
¥ev_‰ame
 = 
¥ev_sf
;

15574 
π
->
cuºít_°ack_‰ame
 = 
sf
;

15575 
˘x
 = 
p
->
u
.
cfunc
.
ªÆm
;

15577 #ifde‡
CONFIG_BIGNUM


15580 i‡(
¥ev_sf
)

15581 
sf
->
js_mode
 = 
¥ev_sf
->js_modê& 
JS_MODE_MATH
;

15583 
sf
->
js_mode
 = 0;

15585 
sf
->
js_mode
 = 0;

15587 
sf
->
cur_func
 = (
JSVÆue
)
func_obj
;

15588 
sf
->
¨g_cou¡
 = 
¨gc
;

15589 
¨g_buf
 = 
¨gv
;

15591 i‡(
	`u∆ikñy
(
¨gc
 < 
¨g_cou¡
)) {

15593 
¨g_buf
 = 
	`Æloˇ
(◊rg_buf[0]Ë* 
¨g_cou¡
);

15594 
i
 = 0; i < 
¨gc
; i++)

15595 
¨g_buf
[
i
] = 
¨gv
[i];

15596 
i
 = 
¨gc
; i < 
¨g_cou¡
; i++)

15597 
¨g_buf
[
i
] = 
JS_UNDEFINED
;

15598 
sf
->
¨g_cou¡
 =árg_count;

15600 
sf
->
¨g_buf
 = (
JSVÆue
*)arg_buf;

15602 
func
 = 
p
->
u
.
cfunc
.
c_fun˘i⁄
;

15603 
˝rŸo
) {

15604 
JS_CFUNC_c⁄°ru˘‹
:

15605 
JS_CFUNC_c⁄°ru˘‹_‹_func
:

15606 i‡(!(
Êags
 & 
JS_CALL_FLAG_CONSTRUCTOR
)) {

15607 i‡(
˝rŸo
 =
JS_CFUNC_c⁄°ru˘‹
) {

15608 
nŸ_a_c⁄°ru˘‹
:

15609 
ªt_vÆ
 = 
	`JS_ThrowTy≥Eº‹
(
˘x
, "must be called withÇew");

15612 
this_obj
 = 
JS_UNDEFINED
;

15617 
JS_CFUNC_gíîic
:

15618 
ªt_vÆ
 = 
func
.
	`gíîic
(
˘x
, 
this_obj
, 
¨gc
, 
¨g_buf
);

15620 
JS_CFUNC_c⁄°ru˘‹_magic
:

15621 
JS_CFUNC_c⁄°ru˘‹_‹_func_magic
:

15622 i‡(!(
Êags
 & 
JS_CALL_FLAG_CONSTRUCTOR
)) {

15623 i‡(
˝rŸo
 =
JS_CFUNC_c⁄°ru˘‹_magic
) {

15624 
nŸ_a_c⁄°ru˘‹
;

15626 
this_obj
 = 
JS_UNDEFINED
;

15630 
JS_CFUNC_gíîic_magic
:

15631 
ªt_vÆ
 = 
func
.
	`gíîic_magic
(
˘x
, 
this_obj
, 
¨gc
, 
¨g_buf
,

15632 
p
->
u
.
cfunc
.
magic
);

15634 
JS_CFUNC_gëãr
:

15635 
ªt_vÆ
 = 
func
.
	`gëãr
(
˘x
, 
this_obj
);

15637 
JS_CFUNC_£âî
:

15638 
ªt_vÆ
 = 
func
.
	`£âî
(
˘x
, 
this_obj
, 
¨g_buf
[0]);

15640 
JS_CFUNC_gëãr_magic
:

15641 
ªt_vÆ
 = 
func
.
	`gëãr_magic
(
˘x
, 
this_obj
, 
p
->
u
.
cfunc
.
magic
);

15643 
JS_CFUNC_£âî_magic
:

15644 
ªt_vÆ
 = 
func
.
	`£âî_magic
(
˘x
, 
this_obj
, 
¨g_buf
[0], 
p
->
u
.
cfunc
.
magic
);

15646 
JS_CFUNC_f_f
:

15648 
d1
;

15650 i‡(
	`u∆ikñy
(
	`JS_ToFlﬂt64
(
˘x
, &
d1
, 
¨g_buf
[0]))) {

15651 
ªt_vÆ
 = 
JS_EXCEPTION
;

15654 
ªt_vÆ
 = 
	`JS_NewFlﬂt64
(
˘x
, 
func
.
	`f_f
(
d1
));

15657 
JS_CFUNC_f_f_f
:

15659 
d1
, 
d2
;

15661 i‡(
	`u∆ikñy
(
	`JS_ToFlﬂt64
(
˘x
, &
d1
, 
¨g_buf
[0]))) {

15662 
ªt_vÆ
 = 
JS_EXCEPTION
;

15665 i‡(
	`u∆ikñy
(
	`JS_ToFlﬂt64
(
˘x
, &
d2
, 
¨g_buf
[1]))) {

15666 
ªt_vÆ
 = 
JS_EXCEPTION
;

15669 
ªt_vÆ
 = 
	`JS_NewFlﬂt64
(
˘x
, 
func
.
	`f_f_f
(
d1
, 
d2
));

15672 
JS_CFUNC_ôî©‹_√xt
:

15674 
d⁄e
;

15675 
ªt_vÆ
 = 
func
.
	`ôî©‹_√xt
(
˘x
, 
this_obj
, 
¨gc
, 
¨g_buf
,

15676 &
d⁄e
, 
p
->
u
.
cfunc
.
magic
);

15677 i‡(!
	`JS_IsEx˚±i⁄
(
ªt_vÆ
Ë&& 
d⁄e
 != 2) {

15678 
ªt_vÆ
 = 
	`js_¸óã_ôî©‹_ªsu…
(
˘x
,Ñë_vÆ, 
d⁄e
);

15683 
	`ab‹t
();

15686 
π
->
cuºít_°ack_‰ame
 = 
sf
->
¥ev_‰ame
;

15687  
ªt_vÆ
;

15688 
	}
}

15690 
JSVÆue
 
	$js_ˇŒ_bound_fun˘i⁄
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
func_obj
,

15691 
JSVÆueC⁄°
 
this_obj
,

15692 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
, 
Êags
)

15694 
JSObje˘
 *
p
;

15695 
JSBoundFun˘i⁄
 *
bf
;

15696 
JSVÆueC⁄°
 *
¨g_buf
, 
√w_èrgë
;

15697 
¨g_cou¡
, 
i
;

15699 
p
 = 
	`JS_VALUE_GET_OBJ
(
func_obj
);

15700 
bf
 = 
p
->
u
.
bound_fun˘i⁄
;

15701 
¨g_cou¡
 = 
bf
->
¨gc
 +árgc;

15702 i‡(
	`js_check_°ack_ovîÊow
(
˘x
->
π
, (
JSVÆue
Ë* 
¨g_cou¡
))

15703  
	`JS_ThrowSèckOvîÊow
(
˘x
);

15704 
¨g_buf
 = 
	`Æloˇ
((
JSVÆue
Ë* 
¨g_cou¡
);

15705 
i
 = 0; i < 
bf
->
¨gc
; i++) {

15706 
¨g_buf
[
i
] = 
bf
->
¨gv
[i];

15708 
i
 = 0; i < 
¨gc
; i++) {

15709 
¨g_buf
[
bf
->
¨gc
 + 
i
] = 
¨gv
[i];

15711 i‡(
Êags
 & 
JS_CALL_FLAG_CONSTRUCTOR
) {

15712 
√w_èrgë
 = 
this_obj
;

15713 i‡(
	`js_ßme_vÆue
(
˘x
, 
func_obj
, 
√w_èrgë
))

15714 
√w_èrgë
 = 
bf
->
func_obj
;

15715  
	`JS_CÆlC⁄°ru˘‹2
(
˘x
, 
bf
->
func_obj
, 
√w_èrgë
,

15716 
¨g_cou¡
, 
¨g_buf
);

15718  
	`JS_CÆl
(
˘x
, 
bf
->
func_obj
, bf->
this_vÆ
,

15719 
¨g_cou¡
, 
¨g_buf
);

15721 
	}
}

15723 
no_ölöe
 
__ex˚±i⁄
 
	$__js_pﬁl_öãºu±s
(
JSC⁄ãxt
 *
˘x
)

15725 
JSRu¡ime
 *
π
 = 
˘x
->rt;

15726 
˘x
->
öãºu±_cou¡î
 = 
JS_INTERRUPT_COUNTER_INIT
;

15727 i‡(
π
->
öãºu±_h™dÀr
) {

15728 i‡(
π
->
	`öãºu±_h™dÀr
‘t,Ñt->
öãºu±_›aque
)) {

15730 
	`JS_ThrowI¡î«lEº‹
(
˘x
, "interrupted");

15731 
	`JS_SëUnˇtchabÀEº‹
(
˘x
, ctx->
π
->
cuºít_ex˚±i⁄
, 
TRUE
);

15736 
	}
}

15738 
ölöe
 
__ex˚±i⁄
 
	$js_pﬁl_öãºu±s
(
JSC⁄ãxt
 *
˘x
)

15740 i‡(
	`u∆ikñy
(--
˘x
->
öãºu±_cou¡î
 <= 0)) {

15741  
	`__js_pﬁl_öãºu±s
(
˘x
);

15745 
	}
}

15749 
	mOP_SPECIAL_OBJECT_ARGUMENTS
,

15750 
	mOP_SPECIAL_OBJECT_MAPPED_ARGUMENTS
,

15751 
	mOP_SPECIAL_OBJECT_THIS_FUNC
,

15752 
	mOP_SPECIAL_OBJECT_NEW_TARGET
,

15753 
	mOP_SPECIAL_OBJECT_HOME_OBJECT
,

15754 
	mOP_SPECIAL_OBJECT_VAR_OBJECT
,

15755 
	mOP_SPECIAL_OBJECT_IMPORT_META
,

15756 } 
	tOPS≥cülObje˘Enum
;

15758 
	#FUNC_RET_AWAIT
 0

	)

15759 
	#FUNC_RET_YIELD
 1

	)

15760 
	#FUNC_RET_YIELD_STAR
 2

	)

15763 
JSVÆue
 
	$JS_CÆlI¡î«l
(
JSC⁄ãxt
 *
ˇŒî_˘x
, 
JSVÆueC⁄°
 
func_obj
,

15764 
JSVÆueC⁄°
 
this_obj
, JSVÆueC⁄° 
√w_èrgë
,

15765 
¨gc
, 
JSVÆue
 *
¨gv
, 
Êags
)

15767 
JSRu¡ime
 *
π
 = 
ˇŒî_˘x
->rt;

15768 
JSC⁄ãxt
 *
˘x
;

15769 
JSObje˘
 *
p
;

15770 
JSFun˘i⁄Byãcode
 *
b
;

15771 
JSSèckFøme
 
sf_s
, *
sf
 = &sf_s;

15772 c⁄° 
uöt8_t
 *
pc
;

15773 
›code
, 
¨g_Æloˇãd_size
, 
i
;

15774 
JSVÆue
 *
loˇl_buf
, *
°ack_buf
, *
v¨_buf
, *
¨g_buf
, *
•
, 
ªt_vÆ
, *
pvÆ
;

15775 
JSV¨Ref
 **
v¨_ªfs
;

15776 
size_t
 
Æloˇ_size
;

15778 #i‡!
DIRECT_DISPATCH


15779 
	#SWITCH
(
pc
Ë
›code
 = *pc++)

	)

15780 
	#CASE
(
›
Ë
	)
op

15781 
	#DEFAULT
 

	)

15782 
	#BREAK
 

	)

15784 c⁄° * c⁄° 
di•©ch_èbÀ
[256] = {

15785 
	#DEF
(
id
, 
size
, 
n_p›
, 
n_push
, 
f
Ë&& 
ˇ£_OP_
 ## id,

	)

15786 #i‡
SHORT_OPCODES


15787 
	#def
(
id
, 
size
, 
n_p›
, 
n_push
, 
f
)

	)

15789 
	#def
(
id
, 
size
, 
n_p›
, 
n_push
, 
f
Ë&& 
ˇ£_deÁu…
,

	)

15791 
	~<π/js/quickjs-›code.h
>

15792 [ 
OP_COUNT
 ... 255 ] = &&
ˇ£_deÁu…


15794 
	#SWITCH
(
pc
Ë*
di•©ch_èbÀ
[
›code
 = *pc++];

	)

15795 
	#CASE
(
›
Ë
ˇ£_
 ## 
	)
op

15796 
	#DEFAULT
 
ˇ£_deÁu…


	)

15797 
	#BREAK
 
	`SWITCH
(
pc
)

	)

15800 i‡(
	`js_pﬁl_öãºu±s
(
ˇŒî_˘x
))

15801  
JS_EXCEPTION
;

15802 i‡(
	`u∆ikñy
(
	`JS_VALUE_GET_TAG
(
func_obj
Ë!
JS_TAG_OBJECT
)) {

15803 i‡(
Êags
 & 
JS_CALL_FLAG_GENERATOR
) {

15804 
JSAsyncFun˘i⁄Sèã
 *
s
 = 
	`JS_VALUE_GET_PTR
(
func_obj
);

15807 
sf
 = &
s
->
‰ame
;

15808 
p
 = 
	`JS_VALUE_GET_OBJ
(
sf
->
cur_func
);

15809 
b
 = 
p
->
u
.
func
.
fun˘i⁄_byãcode
;

15810 
˘x
 = 
b
->
ªÆm
;

15811 
v¨_ªfs
 = 
p
->
u
.
func
.var_refs;

15812 
loˇl_buf
 = 
¨g_buf
 = 
sf
->arg_buf;

15813 
v¨_buf
 = 
sf
->var_buf;

15814 
°ack_buf
 = 
sf
->
v¨_buf
 + 
b
->
v¨_cou¡
;

15815 
•
 = 
sf
->
cur_•
;

15816 
sf
->
cur_•
 = 
NULL
;

15817 
pc
 = 
sf
->
cur_pc
;

15818 
sf
->
¥ev_‰ame
 = 
π
->
cuºít_°ack_‰ame
;

15819 
π
->
cuºít_°ack_‰ame
 = 
sf
;

15820 i‡(
s
->
throw_Êag
)

15821 
ex˚±i⁄
;

15823 
ª°¨t
;

15825 
nŸ_a_fun˘i⁄
;

15828 
p
 = 
	`JS_VALUE_GET_OBJ
(
func_obj
);

15829 i‡(
	`u∆ikñy
(
p
->
˛ass_id
 !
JS_CLASS_BYTECODE_FUNCTION
)) {

15830 
JSCœssCÆl
 *
ˇŒ_func
;

15831 
ˇŒ_func
 = 
π
->
˛ass_¨øy
[
p
->
˛ass_id
].
ˇŒ
;

15832 i‡(!
ˇŒ_func
) {

15833 
nŸ_a_fun˘i⁄
:

15834  
	`JS_ThrowTy≥Eº‹
(
ˇŒî_˘x
, "notá function");

15836  
	`ˇŒ_func
(
ˇŒî_˘x
, 
func_obj
, 
this_obj
, 
¨gc
,

15837 (
JSVÆueC⁄°
 *)
¨gv
, 
Êags
);

15839 
b
 = 
p
->
u
.
func
.
fun˘i⁄_byãcode
;

15841 i‡(
	`u∆ikñy
(
¨gc
 < 
b
->
¨g_cou¡
 || (
Êags
 & 
JS_CALL_FLAG_COPY_ARGV
))) {

15842 
¨g_Æloˇãd_size
 = 
b
->
¨g_cou¡
;

15844 
¨g_Æloˇãd_size
 = 0;

15847 
Æloˇ_size
 = (
JSVÆue
Ë* (
¨g_Æloˇãd_size
 + 
b
->
v¨_cou¡
 +

15848 
b
->
°ack_size
);

15849 i‡(
	`js_check_°ack_ovîÊow
(
π
, 
Æloˇ_size
))

15850  
	`JS_ThrowSèckOvîÊow
(
ˇŒî_˘x
);

15852 
sf
->
js_mode
 = 
b
->js_mode;

15853 
¨g_buf
 = 
¨gv
;

15854 
sf
->
¨g_cou¡
 = 
¨gc
;

15855 
sf
->
cur_func
 = (
JSVÆue
)
func_obj
;

15856 
	`öô_li°_hód
(&
sf
->
v¨_ªf_li°
);

15857 
v¨_ªfs
 = 
p
->
u
.
func
.var_refs;

15859 
loˇl_buf
 = 
	`Æloˇ
(
Æloˇ_size
);

15860 i‡(
	`u∆ikñy
(
¨g_Æloˇãd_size
)) {

15861 
n
 = 
	`mö_öt
(
¨gc
, 
b
->
¨g_cou¡
);

15862 
¨g_buf
 = 
loˇl_buf
;

15863 
i
 = 0; i < 
n
; i++)

15864 
¨g_buf
[
i
] = 
	`JS_DupVÆue
(
ˇŒî_˘x
, 
¨gv
[i]);

15865 ; 
i
 < 
b
->
¨g_cou¡
; i++)

15866 
¨g_buf
[
i
] = 
JS_UNDEFINED
;

15867 
sf
->
¨g_cou¡
 = 
b
->arg_count;

15869 
v¨_buf
 = 
loˇl_buf
 + 
¨g_Æloˇãd_size
;

15870 
sf
->
v¨_buf
 = var_buf;

15871 
sf
->
¨g_buf
 =árg_buf;

15873 
i
 = 0; i < 
b
->
v¨_cou¡
; i++)

15874 
v¨_buf
[
i
] = 
JS_UNDEFINED
;

15876 
°ack_buf
 = 
v¨_buf
 + 
b
->
v¨_cou¡
;

15877 
•
 = 
°ack_buf
;

15878 
pc
 = 
b
->
byã_code_buf
;

15879 
sf
->
¥ev_‰ame
 = 
π
->
cuºít_°ack_‰ame
;

15880 
π
->
cuºít_°ack_‰ame
 = 
sf
;

15881 
˘x
 = 
b
->
ªÆm
;

15883 
ª°¨t
:

15885 
ˇŒ_¨gc
;

15886 
JSVÆue
 *
ˇŒ_¨gv
;

15888 
	`SWITCH
(
pc
) {

15889 
	`CASE
(
OP_push_i32
):

15890 *
•
++ = 
	`JS_NewI¡32
(
˘x
, 
	`gë_u32
(
pc
));

15891 
pc
 += 4;

15892 
BREAK
;

15893 
	`CASE
(
OP_push_c⁄°
):

15894 *
•
++ = 
	`JS_DupVÆue
(
˘x
, 
b
->
˝oﬁ
[
	`gë_u32
(
pc
)]);

15895 
pc
 += 4;

15896 
BREAK
;

15897 #i‡
SHORT_OPCODES


15898 
	`CASE
(
OP_push_möus1
):

15899 
	`CASE
(
OP_push_0
):

15900 
	`CASE
(
OP_push_1
):

15901 
	`CASE
(
OP_push_2
):

15902 
	`CASE
(
OP_push_3
):

15903 
	`CASE
(
OP_push_4
):

15904 
	`CASE
(
OP_push_5
):

15905 
	`CASE
(
OP_push_6
):

15906 
	`CASE
(
OP_push_7
):

15907 *
•
++ = 
	`JS_NewI¡32
(
˘x
, 
›code
 - 
OP_push_0
);

15908 
BREAK
;

15909 
	`CASE
(
OP_push_i8
):

15910 *
•
++ = 
	`JS_NewI¡32
(
˘x
, 
	`gë_i8
(
pc
));

15911 
pc
 += 1;

15912 
BREAK
;

15913 
	`CASE
(
OP_push_i16
):

15914 *
•
++ = 
	`JS_NewI¡32
(
˘x
, 
	`gë_i16
(
pc
));

15915 
pc
 += 2;

15916 
BREAK
;

15917 
	`CASE
(
OP_push_c⁄°8
):

15918 *
•
++ = 
	`JS_DupVÆue
(
˘x
, 
b
->
˝oﬁ
[*
pc
++]);

15919 
BREAK
;

15920 
	`CASE
(
OP_f˛osuª8
):

15921 *
•
++ = 
	`js_˛osuª
(
˘x
, 
	`JS_DupVÆue
(˘x, 
b
->
˝oﬁ
[*
pc
++]), 
v¨_ªfs
, 
sf
);

15922 i‡(
	`u∆ikñy
(
	`JS_IsEx˚±i⁄
(
•
[-1])))

15923 
ex˚±i⁄
;

15924 
BREAK
;

15925 
	`CASE
(
OP_push_em±y_°rög
):

15926 *
•
++ = 
	`JS_AtomToSåög
(
˘x
, 
JS_ATOM_em±y_°rög
);

15927 
BREAK
;

15928 
	`CASE
(
OP_gë_Àngth
):

15930 
JSVÆue
 
vÆ
;

15932 
vÆ
 = 
	`JS_GëPr›îty
(
˘x
, 
•
[-1], 
JS_ATOM_Àngth
);

15933 i‡(
	`u∆ikñy
(
	`JS_IsEx˚±i⁄
(
vÆ
)))

15934 
ex˚±i⁄
;

15935 
	`JS_FªeVÆue
(
˘x
, 
•
[-1]);

15936 
•
[-1] = 
vÆ
;

15938 
BREAK
;

15940 
	`CASE
(
OP_push_©om_vÆue
):

15941 *
•
++ = 
	`JS_AtomToVÆue
(
˘x
, 
	`gë_u32
(
pc
));

15942 
pc
 += 4;

15943 
BREAK
;

15944 
	`CASE
(
OP_undeföed
):

15945 *
•
++ = 
JS_UNDEFINED
;

15946 
BREAK
;

15947 
	`CASE
(
OP_nuŒ
):

15948 *
•
++ = 
JS_NULL
;

15949 
BREAK
;

15950 
	`CASE
(
OP_push_this
):

15953 
JSVÆue
 
vÆ
;

15954 i‡(!(
b
->
js_mode
 & 
JS_MODE_STRICT
)) {

15955 
uöt32_t
 
èg
 = 
	`JS_VALUE_GET_TAG
(
this_obj
);

15956 i‡(
	`likñy
(
èg
 =
JS_TAG_OBJECT
))

15957 
n‹mÆ_this
;

15958 i‡(
èg
 =
JS_TAG_NULL
 ||Åag =
JS_TAG_UNDEFINED
) {

15959 
vÆ
 = 
	`JS_DupVÆue
(
˘x
, ctx->
globÆ_obj
);

15961 
vÆ
 = 
	`JS_ToObje˘
(
˘x
, 
this_obj
);

15962 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

15963 
ex˚±i⁄
;

15966 
n‹mÆ_this
:

15967 
vÆ
 = 
	`JS_DupVÆue
(
˘x
, 
this_obj
);

15969 *
•
++ = 
vÆ
;

15971 
BREAK
;

15972 
	`CASE
(
OP_push_Ál£
):

15973 *
•
++ = 
JS_FALSE
;

15974 
BREAK
;

15975 
	`CASE
(
OP_push_åue
):

15976 *
•
++ = 
JS_TRUE
;

15977 
BREAK
;

15978 
	`CASE
(
OP_obje˘
):

15979 *
•
++ = 
	`JS_NewObje˘
(
˘x
);

15980 i‡(
	`u∆ikñy
(
	`JS_IsEx˚±i⁄
(
•
[-1])))

15981 
ex˚±i⁄
;

15982 
BREAK
;

15983 
	`CASE
(
OP_•ecül_obje˘
):

15985 
¨g
 = *
pc
++;

15986 
¨g
) {

15987 
OP_SPECIAL_OBJECT_ARGUMENTS
:

15988 *
•
++ = 
	`js_buûd_¨gumíts
(
˘x
, 
¨gc
, (
JSVÆueC⁄°
 *)
¨gv
);

15989 i‡(
	`u∆ikñy
(
	`JS_IsEx˚±i⁄
(
•
[-1])))

15990 
ex˚±i⁄
;

15992 
OP_SPECIAL_OBJECT_MAPPED_ARGUMENTS
:

15993 *
•
++ = 
	`js_buûd_m≠≥d_¨gumíts
(
˘x
, 
¨gc
, (
JSVÆueC⁄°
 *)
¨gv
,

15994 
sf
, 
	`mö_öt
(
¨gc
, 
b
->
¨g_cou¡
));

15995 i‡(
	`u∆ikñy
(
	`JS_IsEx˚±i⁄
(
•
[-1])))

15996 
ex˚±i⁄
;

15998 
OP_SPECIAL_OBJECT_THIS_FUNC
:

15999 *
•
++ = 
	`JS_DupVÆue
(
˘x
, 
sf
->
cur_func
);

16001 
OP_SPECIAL_OBJECT_NEW_TARGET
:

16002 *
•
++ = 
	`JS_DupVÆue
(
˘x
, 
√w_èrgë
);

16004 
OP_SPECIAL_OBJECT_HOME_OBJECT
:

16006 
JSObje˘
 *
p1
;

16007 
p1
 = 
p
->
u
.
func
.
home_obje˘
;

16008 i‡(
	`u∆ikñy
(!
p1
))

16009 *
•
++ = 
JS_UNDEFINED
;

16011 *
•
++ = 
	`JS_DupVÆue
(
˘x
, 
	`JS_MKPTR
(
JS_TAG_OBJECT
, 
p1
));

16014 
OP_SPECIAL_OBJECT_VAR_OBJECT
:

16015 *
•
++ = 
	`JS_NewObje˘PrŸo
(
˘x
, 
JS_NULL
);

16016 i‡(
	`u∆ikñy
(
	`JS_IsEx˚±i⁄
(
•
[-1])))

16017 
ex˚±i⁄
;

16019 
OP_SPECIAL_OBJECT_IMPORT_META
:

16020 *
•
++ = 
	`js_imp‹t_mëa
(
˘x
);

16021 i‡(
	`u∆ikñy
(
	`JS_IsEx˚±i⁄
(
•
[-1])))

16022 
ex˚±i⁄
;

16025 
	`ab‹t
();

16028 
BREAK
;

16029 
	`CASE
(
OP_ª°
):

16031 
fú°
 = 
	`gë_u16
(
pc
);

16032 
pc
 += 2;

16033 *
•
++ = 
	`js_buûd_ª°
(
˘x
, 
fú°
, 
¨gc
, (
JSVÆueC⁄°
 *)
¨gv
);

16034 i‡(
	`u∆ikñy
(
	`JS_IsEx˚±i⁄
(
•
[-1])))

16035 
ex˚±i⁄
;

16037 
BREAK
;

16039 
	`CASE
(
OP_dr›
):

16040 
	`JS_FªeVÆue
(
˘x
, 
•
[-1]);

16041 
•
--;

16042 
BREAK
;

16043 
	`CASE
(
OP_nù
):

16044 
	`JS_FªeVÆue
(
˘x
, 
•
[-2]);

16045 
•
[-2] = sp[-1];

16046 
•
--;

16047 
BREAK
;

16048 
	`CASE
(
OP_nù1
):

16049 
	`JS_FªeVÆue
(
˘x
, 
•
[-3]);

16050 
•
[-3] = sp[-2];

16051 
•
[-2] = sp[-1];

16052 
•
--;

16053 
BREAK
;

16054 
	`CASE
(
OP_dup
):

16055 
•
[0] = 
	`JS_DupVÆue
(
˘x
, sp[-1]);

16056 
•
++;

16057 
BREAK
;

16058 
	`CASE
(
OP_dup2
):

16059 
•
[0] = 
	`JS_DupVÆue
(
˘x
, sp[-2]);

16060 
•
[1] = 
	`JS_DupVÆue
(
˘x
, sp[-1]);

16061 
•
 += 2;

16062 
BREAK
;

16063 
	`CASE
(
OP_dup3
):

16064 
•
[0] = 
	`JS_DupVÆue
(
˘x
, sp[-3]);

16065 
•
[1] = 
	`JS_DupVÆue
(
˘x
, sp[-2]);

16066 
•
[2] = 
	`JS_DupVÆue
(
˘x
, sp[-1]);

16067 
•
 += 3;

16068 
BREAK
;

16069 
	`CASE
(
OP_dup1
):

16070 
•
[0] = sp[-1];

16071 
•
[-1] = 
	`JS_DupVÆue
(
˘x
, sp[-2]);

16072 
•
++;

16073 
BREAK
;

16074 
	`CASE
(
OP_ö£π2
):

16075 
•
[0] = sp[-1];

16076 
•
[-1] = sp[-2];

16077 
•
[-2] = 
	`JS_DupVÆue
(
˘x
, sp[0]);

16078 
•
++;

16079 
BREAK
;

16080 
	`CASE
(
OP_ö£π3
):

16081 
•
[0] = sp[-1];

16082 
•
[-1] = sp[-2];

16083 
•
[-2] = sp[-3];

16084 
•
[-3] = 
	`JS_DupVÆue
(
˘x
, sp[0]);

16085 
•
++;

16086 
BREAK
;

16087 
	`CASE
(
OP_ö£π4
):

16088 
•
[0] = sp[-1];

16089 
•
[-1] = sp[-2];

16090 
•
[-2] = sp[-3];

16091 
•
[-3] = sp[-4];

16092 
•
[-4] = 
	`JS_DupVÆue
(
˘x
, sp[0]);

16093 
•
++;

16094 
BREAK
;

16095 
	`CASE
(
OP_≥rm3
):

16097 
JSVÆue
 
tmp
;

16098 
tmp
 = 
•
[-2];

16099 
•
[-2] = sp[-3];

16100 
•
[-3] = 
tmp
;

16102 
BREAK
;

16103 
	`CASE
(
OP_rŸ3l
):

16105 
JSVÆue
 
tmp
;

16106 
tmp
 = 
•
[-3];

16107 
•
[-3] = sp[-2];

16108 
•
[-2] = sp[-1];

16109 
•
[-1] = 
tmp
;

16111 
BREAK
;

16112 
	`CASE
(
OP_rŸ4l
):

16114 
JSVÆue
 
tmp
;

16115 
tmp
 = 
•
[-4];

16116 
•
[-4] = sp[-3];

16117 
•
[-3] = sp[-2];

16118 
•
[-2] = sp[-1];

16119 
•
[-1] = 
tmp
;

16121 
BREAK
;

16122 
	`CASE
(
OP_rŸ5l
):

16124 
JSVÆue
 
tmp
;

16125 
tmp
 = 
•
[-5];

16126 
•
[-5] = sp[-4];

16127 
•
[-4] = sp[-3];

16128 
•
[-3] = sp[-2];

16129 
•
[-2] = sp[-1];

16130 
•
[-1] = 
tmp
;

16132 
BREAK
;

16133 
	`CASE
(
OP_rŸ3r
):

16135 
JSVÆue
 
tmp
;

16136 
tmp
 = 
•
[-1];

16137 
•
[-1] = sp[-2];

16138 
•
[-2] = sp[-3];

16139 
•
[-3] = 
tmp
;

16141 
BREAK
;

16142 
	`CASE
(
OP_≥rm4
):

16144 
JSVÆue
 
tmp
;

16145 
tmp
 = 
•
[-2];

16146 
•
[-2] = sp[-3];

16147 
•
[-3] = sp[-4];

16148 
•
[-4] = 
tmp
;

16150 
BREAK
;

16151 
	`CASE
(
OP_≥rm5
):

16153 
JSVÆue
 
tmp
;

16154 
tmp
 = 
•
[-2];

16155 
•
[-2] = sp[-3];

16156 
•
[-3] = sp[-4];

16157 
•
[-4] = sp[-5];

16158 
•
[-5] = 
tmp
;

16160 
BREAK
;

16161 
	`CASE
(
OP_sw≠
):

16163 
JSVÆue
 
tmp
;

16164 
tmp
 = 
•
[-2];

16165 
•
[-2] = sp[-1];

16166 
•
[-1] = 
tmp
;

16168 
BREAK
;

16169 
	`CASE
(
OP_sw≠2
):

16171 
JSVÆue
 
tmp1
, 
tmp2
;

16172 
tmp1
 = 
•
[-4];

16173 
tmp2
 = 
•
[-3];

16174 
•
[-4] = sp[-2];

16175 
•
[-3] = sp[-1];

16176 
•
[-2] = 
tmp1
;

16177 
•
[-1] = 
tmp2
;

16179 
BREAK
;

16181 
	`CASE
(
OP_f˛osuª
):

16183 
JSVÆue
 
bfunc
 = 
	`JS_DupVÆue
(
˘x
, 
b
->
˝oﬁ
[
	`gë_u32
(
pc
)]);

16184 
pc
 += 4;

16185 *
•
++ = 
	`js_˛osuª
(
˘x
, 
bfunc
, 
v¨_ªfs
, 
sf
);

16186 i‡(
	`u∆ikñy
(
	`JS_IsEx˚±i⁄
(
•
[-1])))

16187 
ex˚±i⁄
;

16189 
BREAK
;

16190 #i‡
SHORT_OPCODES


16191 
	`CASE
(
OP_ˇŒ0
):

16192 
	`CASE
(
OP_ˇŒ1
):

16193 
	`CASE
(
OP_ˇŒ2
):

16194 
	`CASE
(
OP_ˇŒ3
):

16195 
ˇŒ_¨gc
 = 
›code
 - 
OP_ˇŒ0
;

16196 
has_ˇŒ_¨gc
;

16198 
	`CASE
(
OP_ˇŒ
):

16199 
	`CASE
(
OP_èû_ˇŒ
):

16201 
ˇŒ_¨gc
 = 
	`gë_u16
(
pc
);

16202 
pc
 += 2;

16203 
has_ˇŒ_¨gc
;

16204 
has_ˇŒ_¨gc
:

16205 
ˇŒ_¨gv
 = 
•
 - 
ˇŒ_¨gc
;

16206 
sf
->
cur_pc
 = 
pc
;

16207 
ªt_vÆ
 = 
	`JS_CÆlI¡î«l
(
˘x
, 
ˇŒ_¨gv
[-1], 
JS_UNDEFINED
,

16208 
JS_UNDEFINED
, 
ˇŒ_¨gc
, 
ˇŒ_¨gv
, 0);

16209 i‡(
	`u∆ikñy
(
	`JS_IsEx˚±i⁄
(
ªt_vÆ
)))

16210 
ex˚±i⁄
;

16211 i‡(
›code
 =
OP_èû_ˇŒ
)

16212 
d⁄e
;

16213 
i
 = -1; i < 
ˇŒ_¨gc
; i++)

16214 
	`JS_FªeVÆue
(
˘x
, 
ˇŒ_¨gv
[
i
]);

16215 
•
 -
ˇŒ_¨gc
 + 1;

16216 *
•
++ = 
ªt_vÆ
;

16218 
BREAK
;

16219 
	`CASE
(
OP_ˇŒ_c⁄°ru˘‹
):

16221 
ˇŒ_¨gc
 = 
	`gë_u16
(
pc
);

16222 
pc
 += 2;

16223 
ˇŒ_¨gv
 = 
•
 - 
ˇŒ_¨gc
;

16224 
sf
->
cur_pc
 = 
pc
;

16225 
ªt_vÆ
 = 
	`JS_CÆlC⁄°ru˘‹I¡î«l
(
˘x
, 
ˇŒ_¨gv
[-2],

16226 
ˇŒ_¨gv
[-1],

16227 
ˇŒ_¨gc
, 
ˇŒ_¨gv
, 0);

16228 i‡(
	`u∆ikñy
(
	`JS_IsEx˚±i⁄
(
ªt_vÆ
)))

16229 
ex˚±i⁄
;

16230 
i
 = -2; i < 
ˇŒ_¨gc
; i++)

16231 
	`JS_FªeVÆue
(
˘x
, 
ˇŒ_¨gv
[
i
]);

16232 
•
 -
ˇŒ_¨gc
 + 2;

16233 *
•
++ = 
ªt_vÆ
;

16235 
BREAK
;

16236 
	`CASE
(
OP_ˇŒ_mëhod
):

16237 
	`CASE
(
OP_èû_ˇŒ_mëhod
):

16239 
ˇŒ_¨gc
 = 
	`gë_u16
(
pc
);

16240 
pc
 += 2;

16241 
ˇŒ_¨gv
 = 
•
 - 
ˇŒ_¨gc
;

16242 
sf
->
cur_pc
 = 
pc
;

16243 
ªt_vÆ
 = 
	`JS_CÆlI¡î«l
(
˘x
, 
ˇŒ_¨gv
[-1], call_argv[-2],

16244 
JS_UNDEFINED
, 
ˇŒ_¨gc
, 
ˇŒ_¨gv
, 0);

16245 i‡(
	`u∆ikñy
(
	`JS_IsEx˚±i⁄
(
ªt_vÆ
)))

16246 
ex˚±i⁄
;

16247 i‡(
›code
 =
OP_èû_ˇŒ_mëhod
)

16248 
d⁄e
;

16249 
i
 = -2; i < 
ˇŒ_¨gc
; i++)

16250 
	`JS_FªeVÆue
(
˘x
, 
ˇŒ_¨gv
[
i
]);

16251 
•
 -
ˇŒ_¨gc
 + 2;

16252 *
•
++ = 
ªt_vÆ
;

16254 
BREAK
;

16255 
	`CASE
(
OP_¨øy_‰om
):

16257 
i
, 
ªt
;

16259 
ˇŒ_¨gc
 = 
	`gë_u16
(
pc
);

16260 
pc
 += 2;

16261 
ªt_vÆ
 = 
	`JS_NewAºay
(
˘x
);

16262 i‡(
	`u∆ikñy
(
	`JS_IsEx˚±i⁄
(
ªt_vÆ
)))

16263 
ex˚±i⁄
;

16264 
ˇŒ_¨gv
 = 
•
 - 
ˇŒ_¨gc
;

16265 
i
 = 0; i < 
ˇŒ_¨gc
; i++) {

16266 
ªt
 = 
	`JS_DeföePr›îtyVÆue
(
˘x
, 
ªt_vÆ
, 
	`__JS_AtomFromUI¡32
(
i
), 
ˇŒ_¨gv
[i],

16267 
JS_PROP_C_W_E
 | 
JS_PROP_THROW
);

16268 
ˇŒ_¨gv
[
i
] = 
JS_UNDEFINED
;

16269 i‡(
ªt
 < 0) {

16270 
	`JS_FªeVÆue
(
˘x
, 
ªt_vÆ
);

16271 
ex˚±i⁄
;

16274 
•
 -
ˇŒ_¨gc
;

16275 *
•
++ = 
ªt_vÆ
;

16277 
BREAK
;

16279 
	`CASE
(
OP_≠∂y
):

16281 
magic
;

16282 
magic
 = 
	`gë_u16
(
pc
);

16283 
pc
 += 2;

16285 
ªt_vÆ
 = 
	`js_fun˘i⁄_≠∂y
(
˘x
, 
•
[-3], 2, (
JSVÆueC⁄°
 *)&•[-2], 
magic
);

16286 i‡(
	`u∆ikñy
(
	`JS_IsEx˚±i⁄
(
ªt_vÆ
)))

16287 
ex˚±i⁄
;

16288 
	`JS_FªeVÆue
(
˘x
, 
•
[-3]);

16289 
	`JS_FªeVÆue
(
˘x
, 
•
[-2]);

16290 
	`JS_FªeVÆue
(
˘x
, 
•
[-1]);

16291 
•
 -= 3;

16292 *
•
++ = 
ªt_vÆ
;

16294 
BREAK
;

16295 
	`CASE
(
OP_ªtu∫
):

16296 
ªt_vÆ
 = *--
•
;

16297 
d⁄e
;

16298 
	`CASE
(
OP_ªtu∫_undef
):

16299 
ªt_vÆ
 = 
JS_UNDEFINED
;

16300 
d⁄e
;

16302 
	`CASE
(
OP_check_˘‹_ªtu∫
):

16304 i‡(!
	`JS_IsObje˘
(
•
[-1])) {

16305 i‡(!
	`JS_IsUndeföed
(
•
[-1])) {

16306 
	`JS_ThrowTy≥Eº‹
(
ˇŒî_˘x
, "derived class constructor mustÑeturnán object or undefined");

16307 
ex˚±i⁄
;

16309 
•
[0] = 
JS_TRUE
;

16311 
•
[0] = 
JS_FALSE
;

16313 
•
++;

16314 
BREAK
;

16315 
	`CASE
(
OP_check_˘‹
):

16316 i‡(
	`JS_IsUndeföed
(
√w_èrgë
)) {

16317 
	`JS_ThrowTy≥Eº‹
(
ˇŒî_˘x
, "class constructors must be invoked with 'new'");

16318 
ex˚±i⁄
;

16320 
BREAK
;

16321 
	`CASE
(
OP_check_bønd
):

16322 i‡(
	`JS_CheckBønd
(
˘x
, 
•
[-2], sp[-1]) < 0)

16323 
ex˚±i⁄
;

16324 
BREAK
;

16325 
	`CASE
(
OP_add_bønd
):

16326 i‡(
	`JS_AddBønd
(
˘x
, 
•
[-2], sp[-1]) < 0)

16327 
ex˚±i⁄
;

16328 
	`JS_FªeVÆue
(
˘x
, 
•
[-2]);

16329 
	`JS_FªeVÆue
(
˘x
, 
•
[-1]);

16330 
•
 -= 2;

16331 
BREAK
;

16333 
	`CASE
(
OP_throw
):

16334 
	`JS_Throw
(
˘x
, *--
•
);

16335 
ex˚±i⁄
;

16337 
	`CASE
(
OP_throw_v¨
):

16338 
	#JS_THROW_VAR_RO
 0

	)

16339 
	#JS_THROW_VAR_REDECL
 1

	)

16340 
	#JS_THROW_VAR_UNINITIALIZED
 2

	)

16341 
	#JS_THROW_VAR_DELETE_SUPER
 3

	)

16343 
JSAtom
 
©om
;

16344 
ty≥
;

16345 
©om
 = 
	`gë_u32
(
pc
);

16346 
ty≥
 = 
pc
[4];

16347 
pc
 += 5;

16348 i‡(
ty≥
 =
JS_THROW_VAR_RO
)

16349 
	`JS_ThrowTy≥Eº‹RódO∆y
(
˘x
, 
JS_PROP_THROW
, 
©om
);

16351 i‡(
ty≥
 =
JS_THROW_VAR_REDECL
)

16352 
	`JS_ThrowSy¡axEº‹V¨Rede˛¨©i⁄
(
˘x
, 
©om
);

16354 i‡(
ty≥
 =
JS_THROW_VAR_UNINITIALIZED
)

16355 
	`JS_ThrowRe„ªn˚Eº‹Unöôülized
(
˘x
, 
©om
);

16357 i‡(
ty≥
 =
JS_THROW_VAR_DELETE_SUPER
)

16358 
	`JS_ThrowRe„ªn˚Eº‹
(
˘x
, "unsupportedÑeferenceÅo 'super'");

16360 
	`JS_ThrowI¡î«lEº‹
(
˘x
, "övÆidÅhrow v¨Åy≥ %d", 
ty≥
);

16362 
ex˚±i⁄
;

16364 
	`CASE
(
OP_evÆ
):

16366 
JSVÆueC⁄°
 
obj
;

16367 
sc›e_idx
;

16368 
ˇŒ_¨gc
 = 
	`gë_u16
(
pc
);

16369 
sc›e_idx
 = 
	`gë_u16
(
pc
 + 2) - 1;

16370 
pc
 += 4;

16371 
ˇŒ_¨gv
 = 
•
 - 
ˇŒ_¨gc
;

16372 
sf
->
cur_pc
 = 
pc
;

16373 i‡(
	`js_ßme_vÆue
(
˘x
, 
ˇŒ_¨gv
[-1], ctx->
evÆ_obj
)) {

16374 i‡(
ˇŒ_¨gc
 >= 1)

16375 
obj
 = 
ˇŒ_¨gv
[0];

16377 
obj
 = 
JS_UNDEFINED
;

16378 
ªt_vÆ
 = 
	`JS_EvÆObje˘
(
˘x
, 
JS_UNDEFINED
, 
obj
,

16379 
JS_EVAL_TYPE_DIRECT
, 
sc›e_idx
);

16381 
ªt_vÆ
 = 
	`JS_CÆlI¡î«l
(
˘x
, 
ˇŒ_¨gv
[-1], 
JS_UNDEFINED
,

16382 
JS_UNDEFINED
, 
ˇŒ_¨gc
, 
ˇŒ_¨gv
, 0);

16384 i‡(
	`u∆ikñy
(
	`JS_IsEx˚±i⁄
(
ªt_vÆ
)))

16385 
ex˚±i⁄
;

16386 
i
 = -1; i < 
ˇŒ_¨gc
; i++)

16387 
	`JS_FªeVÆue
(
˘x
, 
ˇŒ_¨gv
[
i
]);

16388 
•
 -
ˇŒ_¨gc
 + 1;

16389 *
•
++ = 
ªt_vÆ
;

16391 
BREAK
;

16393 
	`CASE
(
OP_≠∂y_evÆ
):

16395 
sc›e_idx
;

16396 
uöt32_t
 
Àn
;

16397 
JSVÆue
 *
èb
;

16398 
JSVÆueC⁄°
 
obj
;

16400 
sc›e_idx
 = 
	`gë_u16
(
pc
) - 1;

16401 
pc
 += 2;

16402 
èb
 = 
	`buûd_¨g_li°
(
˘x
, &
Àn
, 
•
[-1]);

16403 i‡(!
èb
)

16404 
ex˚±i⁄
;

16405 i‡(
	`js_ßme_vÆue
(
˘x
, 
•
[-2], ctx->
evÆ_obj
)) {

16406 i‡(
Àn
 >= 1)

16407 
obj
 = 
èb
[0];

16409 
obj
 = 
JS_UNDEFINED
;

16410 
ªt_vÆ
 = 
	`JS_EvÆObje˘
(
˘x
, 
JS_UNDEFINED
, 
obj
,

16411 
JS_EVAL_TYPE_DIRECT
, 
sc›e_idx
);

16413 
ªt_vÆ
 = 
	`JS_CÆl
(
˘x
, 
•
[-2], 
JS_UNDEFINED
, 
Àn
,

16414 (
JSVÆueC⁄°
 *)
èb
);

16416 
	`‰ì_¨g_li°
(
˘x
, 
èb
, 
Àn
);

16417 i‡(
	`u∆ikñy
(
	`JS_IsEx˚±i⁄
(
ªt_vÆ
)))

16418 
ex˚±i⁄
;

16419 
	`JS_FªeVÆue
(
˘x
, 
•
[-2]);

16420 
	`JS_FªeVÆue
(
˘x
, 
•
[-1]);

16421 
•
 -= 2;

16422 *
•
++ = 
ªt_vÆ
;

16424 
BREAK
;

16426 
	`CASE
(
OP_ªgexp
):

16428 
•
[-2] = 
	`js_ªgexp_c⁄°ru˘‹_öã∫Æ
(
˘x
, 
JS_UNDEFINED
,

16429 
•
[-2], sp[-1]);

16430 
•
--;

16432 
BREAK
;

16434 
	`CASE
(
OP_gë_su≥r
):

16436 
JSVÆue
 
¥Ÿo
;

16437 
¥Ÿo
 = 
	`JS_DupVÆue
(
˘x
, 
	`JS_GëPrŸŸy≥
(˘x, 
•
[-1]));

16438 i‡(
	`JS_IsEx˚±i⁄
(
¥Ÿo
))

16439 
ex˚±i⁄
;

16440 
	`JS_FªeVÆue
(
˘x
, 
•
[-1]);

16441 
•
[-1] = 
¥Ÿo
;

16443 
BREAK
;

16445 
	`CASE
(
OP_imp‹t
):

16447 
JSVÆue
 
vÆ
;

16448 
vÆ
 = 
	`js_dy«mic_imp‹t
(
˘x
, 
•
[-1]);

16449 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

16450 
ex˚±i⁄
;

16451 
	`JS_FªeVÆue
(
˘x
, 
•
[-1]);

16452 
•
[-1] = 
vÆ
;

16454 
BREAK
;

16456 
	`CASE
(
OP_check_v¨
):

16458 
ªt
;

16459 
JSAtom
 
©om
;

16460 
©om
 = 
	`gë_u32
(
pc
);

16461 
pc
 += 4;

16463 
ªt
 = 
	`JS_CheckGlobÆV¨
(
˘x
, 
©om
);

16464 i‡(
ªt
 < 0)

16465 
ex˚±i⁄
;

16466 *
•
++ = 
	`JS_NewBoﬁ
(
˘x
, 
ªt
);

16468 
BREAK
;

16470 
	`CASE
(
OP_gë_v¨_undef
):

16471 
	`CASE
(
OP_gë_v¨
):

16473 
JSVÆue
 
vÆ
;

16474 
JSAtom
 
©om
;

16475 
©om
 = 
	`gë_u32
(
pc
);

16476 
pc
 += 4;

16478 
vÆ
 = 
	`JS_GëGlobÆV¨
(
˘x
, 
©om
, 
›code
 - 
OP_gë_v¨_undef
);

16479 i‡(
	`u∆ikñy
(
	`JS_IsEx˚±i⁄
(
vÆ
)))

16480 
ex˚±i⁄
;

16481 *
•
++ = 
vÆ
;

16483 
BREAK
;

16485 
	`CASE
(
OP_put_v¨
):

16486 
	`CASE
(
OP_put_v¨_öô
):

16488 
ªt
;

16489 
JSAtom
 
©om
;

16490 
©om
 = 
	`gë_u32
(
pc
);

16491 
pc
 += 4;

16493 
ªt
 = 
	`JS_SëGlobÆV¨
(
˘x
, 
©om
, 
•
[-1], 
›code
 - 
OP_put_v¨
);

16494 
•
--;

16495 i‡(
	`u∆ikñy
(
ªt
 < 0))

16496 
ex˚±i⁄
;

16498 
BREAK
;

16500 
	`CASE
(
OP_put_v¨_°ri˘
):

16502 
ªt
;

16503 
JSAtom
 
©om
;

16504 
©om
 = 
	`gë_u32
(
pc
);

16505 
pc
 += 4;

16508 i‡(
	`u∆ikñy
(!
	`JS_VALUE_GET_INT
(
•
[-2]))) {

16509 
	`JS_ThrowRe„ªn˚Eº‹NŸDeföed
(
˘x
, 
©om
);

16510 
ex˚±i⁄
;

16512 
ªt
 = 
	`JS_SëGlobÆV¨
(
˘x
, 
©om
, 
•
[-1], 2);

16513 
•
 -= 2;

16514 i‡(
	`u∆ikñy
(
ªt
 < 0))

16515 
ex˚±i⁄
;

16517 
BREAK
;

16519 
	`CASE
(
OP_check_deföe_v¨
):

16521 
JSAtom
 
©om
;

16522 
Êags
;

16523 
©om
 = 
	`gë_u32
(
pc
);

16524 
Êags
 = 
pc
[4];

16525 
pc
 += 5;

16526 i‡(
	`JS_CheckDeföeGlobÆV¨
(
˘x
, 
©om
, 
Êags
))

16527 
ex˚±i⁄
;

16529 
BREAK
;

16530 
	`CASE
(
OP_deföe_v¨
):

16532 
JSAtom
 
©om
;

16533 
Êags
;

16534 
©om
 = 
	`gë_u32
(
pc
);

16535 
Êags
 = 
pc
[4];

16536 
pc
 += 5;

16537 i‡(
	`JS_DeföeGlobÆV¨
(
˘x
, 
©om
, 
Êags
))

16538 
ex˚±i⁄
;

16540 
BREAK
;

16541 
	`CASE
(
OP_deföe_func
):

16543 
JSAtom
 
©om
;

16544 
Êags
;

16545 
©om
 = 
	`gë_u32
(
pc
);

16546 
Êags
 = 
pc
[4];

16547 
pc
 += 5;

16548 i‡(
	`JS_DeföeGlobÆFun˘i⁄
(
˘x
, 
©om
, 
•
[-1], 
Êags
))

16549 
ex˚±i⁄
;

16550 
	`JS_FªeVÆue
(
˘x
, 
•
[-1]);

16551 
•
--;

16553 
BREAK
;

16555 
	`CASE
(
OP_gë_loc
):

16557 
idx
;

16558 
idx
 = 
	`gë_u16
(
pc
);

16559 
pc
 += 2;

16560 
•
[0] = 
	`JS_DupVÆue
(
˘x
, 
v¨_buf
[
idx
]);

16561 
•
++;

16563 
BREAK
;

16564 
	`CASE
(
OP_put_loc
):

16566 
idx
;

16567 
idx
 = 
	`gë_u16
(
pc
);

16568 
pc
 += 2;

16569 
	`£t_vÆue
(
˘x
, &
v¨_buf
[
idx
], 
•
[-1]);

16570 
•
--;

16572 
BREAK
;

16573 
	`CASE
(
OP_£t_loc
):

16575 
idx
;

16576 
idx
 = 
	`gë_u16
(
pc
);

16577 
pc
 += 2;

16578 
	`£t_vÆue
(
˘x
, &
v¨_buf
[
idx
], 
	`JS_DupVÆue
(˘x, 
•
[-1]));

16580 
BREAK
;

16581 
	`CASE
(
OP_gë_¨g
):

16583 
idx
;

16584 
idx
 = 
	`gë_u16
(
pc
);

16585 
pc
 += 2;

16586 
•
[0] = 
	`JS_DupVÆue
(
˘x
, 
¨g_buf
[
idx
]);

16587 
•
++;

16589 
BREAK
;

16590 
	`CASE
(
OP_put_¨g
):

16592 
idx
;

16593 
idx
 = 
	`gë_u16
(
pc
);

16594 
pc
 += 2;

16595 
	`£t_vÆue
(
˘x
, &
¨g_buf
[
idx
], 
•
[-1]);

16596 
•
--;

16598 
BREAK
;

16599 
	`CASE
(
OP_£t_¨g
):

16601 
idx
;

16602 
idx
 = 
	`gë_u16
(
pc
);

16603 
pc
 += 2;

16604 
	`£t_vÆue
(
˘x
, &
¨g_buf
[
idx
], 
	`JS_DupVÆue
(˘x, 
•
[-1]));

16606 
BREAK
;

16608 #i‡
SHORT_OPCODES


16609 
	`CASE
(
OP_gë_loc8
): *
•
++ = 
	`JS_DupVÆue
(
˘x
, 
v¨_buf
[*
pc
++]); 
BREAK
;

16610 
	`CASE
(
OP_put_loc8
): 
	`£t_vÆue
(
˘x
, &
v¨_buf
[*
pc
++], *--
•
); 
BREAK
;

16611 
	`CASE
(
OP_£t_loc8
): 
	`£t_vÆue
(
˘x
, &
v¨_buf
[*
pc
++], 
	`JS_DupVÆue
(˘x, 
•
[-1])); 
BREAK
;

16613 
	`CASE
(
OP_gë_loc0
): *
•
++ = 
	`JS_DupVÆue
(
˘x
, 
v¨_buf
[0]); 
BREAK
;

16614 
	`CASE
(
OP_gë_loc1
): *
•
++ = 
	`JS_DupVÆue
(
˘x
, 
v¨_buf
[1]); 
BREAK
;

16615 
	`CASE
(
OP_gë_loc2
): *
•
++ = 
	`JS_DupVÆue
(
˘x
, 
v¨_buf
[2]); 
BREAK
;

16616 
	`CASE
(
OP_gë_loc3
): *
•
++ = 
	`JS_DupVÆue
(
˘x
, 
v¨_buf
[3]); 
BREAK
;

16617 
	`CASE
(
OP_put_loc0
): 
	`£t_vÆue
(
˘x
, &
v¨_buf
[0], *--
•
); 
BREAK
;

16618 
	`CASE
(
OP_put_loc1
): 
	`£t_vÆue
(
˘x
, &
v¨_buf
[1], *--
•
); 
BREAK
;

16619 
	`CASE
(
OP_put_loc2
): 
	`£t_vÆue
(
˘x
, &
v¨_buf
[2], *--
•
); 
BREAK
;

16620 
	`CASE
(
OP_put_loc3
): 
	`£t_vÆue
(
˘x
, &
v¨_buf
[3], *--
•
); 
BREAK
;

16621 
	`CASE
(
OP_£t_loc0
): 
	`£t_vÆue
(
˘x
, &
v¨_buf
[0], 
	`JS_DupVÆue
(˘x, 
•
[-1])); 
BREAK
;

16622 
	`CASE
(
OP_£t_loc1
): 
	`£t_vÆue
(
˘x
, &
v¨_buf
[1], 
	`JS_DupVÆue
(˘x, 
•
[-1])); 
BREAK
;

16623 
	`CASE
(
OP_£t_loc2
): 
	`£t_vÆue
(
˘x
, &
v¨_buf
[2], 
	`JS_DupVÆue
(˘x, 
•
[-1])); 
BREAK
;

16624 
	`CASE
(
OP_£t_loc3
): 
	`£t_vÆue
(
˘x
, &
v¨_buf
[3], 
	`JS_DupVÆue
(˘x, 
•
[-1])); 
BREAK
;

16625 
	`CASE
(
OP_gë_¨g0
): *
•
++ = 
	`JS_DupVÆue
(
˘x
, 
¨g_buf
[0]); 
BREAK
;

16626 
	`CASE
(
OP_gë_¨g1
): *
•
++ = 
	`JS_DupVÆue
(
˘x
, 
¨g_buf
[1]); 
BREAK
;

16627 
	`CASE
(
OP_gë_¨g2
): *
•
++ = 
	`JS_DupVÆue
(
˘x
, 
¨g_buf
[2]); 
BREAK
;

16628 
	`CASE
(
OP_gë_¨g3
): *
•
++ = 
	`JS_DupVÆue
(
˘x
, 
¨g_buf
[3]); 
BREAK
;

16629 
	`CASE
(
OP_put_¨g0
): 
	`£t_vÆue
(
˘x
, &
¨g_buf
[0], *--
•
); 
BREAK
;

16630 
	`CASE
(
OP_put_¨g1
): 
	`£t_vÆue
(
˘x
, &
¨g_buf
[1], *--
•
); 
BREAK
;

16631 
	`CASE
(
OP_put_¨g2
): 
	`£t_vÆue
(
˘x
, &
¨g_buf
[2], *--
•
); 
BREAK
;

16632 
	`CASE
(
OP_put_¨g3
): 
	`£t_vÆue
(
˘x
, &
¨g_buf
[3], *--
•
); 
BREAK
;

16633 
	`CASE
(
OP_£t_¨g0
): 
	`£t_vÆue
(
˘x
, &
¨g_buf
[0], 
	`JS_DupVÆue
(˘x, 
•
[-1])); 
BREAK
;

16634 
	`CASE
(
OP_£t_¨g1
): 
	`£t_vÆue
(
˘x
, &
¨g_buf
[1], 
	`JS_DupVÆue
(˘x, 
•
[-1])); 
BREAK
;

16635 
	`CASE
(
OP_£t_¨g2
): 
	`£t_vÆue
(
˘x
, &
¨g_buf
[2], 
	`JS_DupVÆue
(˘x, 
•
[-1])); 
BREAK
;

16636 
	`CASE
(
OP_£t_¨g3
): 
	`£t_vÆue
(
˘x
, &
¨g_buf
[3], 
	`JS_DupVÆue
(˘x, 
•
[-1])); 
BREAK
;

16637 
	`CASE
(
OP_gë_v¨_ªf0
): *
•
++ = 
	`JS_DupVÆue
(
˘x
, *
v¨_ªfs
[0]->
pvÆue
); 
BREAK
;

16638 
	`CASE
(
OP_gë_v¨_ªf1
): *
•
++ = 
	`JS_DupVÆue
(
˘x
, *
v¨_ªfs
[1]->
pvÆue
); 
BREAK
;

16639 
	`CASE
(
OP_gë_v¨_ªf2
): *
•
++ = 
	`JS_DupVÆue
(
˘x
, *
v¨_ªfs
[2]->
pvÆue
); 
BREAK
;

16640 
	`CASE
(
OP_gë_v¨_ªf3
): *
•
++ = 
	`JS_DupVÆue
(
˘x
, *
v¨_ªfs
[3]->
pvÆue
); 
BREAK
;

16641 
	`CASE
(
OP_put_v¨_ªf0
): 
	`£t_vÆue
(
˘x
, 
v¨_ªfs
[0]->
pvÆue
, *--
•
); 
BREAK
;

16642 
	`CASE
(
OP_put_v¨_ªf1
): 
	`£t_vÆue
(
˘x
, 
v¨_ªfs
[1]->
pvÆue
, *--
•
); 
BREAK
;

16643 
	`CASE
(
OP_put_v¨_ªf2
): 
	`£t_vÆue
(
˘x
, 
v¨_ªfs
[2]->
pvÆue
, *--
•
); 
BREAK
;

16644 
	`CASE
(
OP_put_v¨_ªf3
): 
	`£t_vÆue
(
˘x
, 
v¨_ªfs
[3]->
pvÆue
, *--
•
); 
BREAK
;

16645 
	`CASE
(
OP_£t_v¨_ªf0
): 
	`£t_vÆue
(
˘x
, 
v¨_ªfs
[0]->
pvÆue
, 
	`JS_DupVÆue
(˘x, 
•
[-1])); 
BREAK
;

16646 
	`CASE
(
OP_£t_v¨_ªf1
): 
	`£t_vÆue
(
˘x
, 
v¨_ªfs
[1]->
pvÆue
, 
	`JS_DupVÆue
(˘x, 
•
[-1])); 
BREAK
;

16647 
	`CASE
(
OP_£t_v¨_ªf2
): 
	`£t_vÆue
(
˘x
, 
v¨_ªfs
[2]->
pvÆue
, 
	`JS_DupVÆue
(˘x, 
•
[-1])); 
BREAK
;

16648 
	`CASE
(
OP_£t_v¨_ªf3
): 
	`£t_vÆue
(
˘x
, 
v¨_ªfs
[3]->
pvÆue
, 
	`JS_DupVÆue
(˘x, 
•
[-1])); 
BREAK
;

16651 
	`CASE
(
OP_gë_v¨_ªf
):

16653 
idx
;

16654 
JSVÆue
 
vÆ
;

16655 
idx
 = 
	`gë_u16
(
pc
);

16656 
pc
 += 2;

16657 
vÆ
 = *
v¨_ªfs
[
idx
]->
pvÆue
;

16658 
•
[0] = 
	`JS_DupVÆue
(
˘x
, 
vÆ
);

16659 
•
++;

16661 
BREAK
;

16662 
	`CASE
(
OP_put_v¨_ªf
):

16664 
idx
;

16665 
idx
 = 
	`gë_u16
(
pc
);

16666 
pc
 += 2;

16667 
	`£t_vÆue
(
˘x
, 
v¨_ªfs
[
idx
]->
pvÆue
, 
•
[-1]);

16668 
•
--;

16670 
BREAK
;

16671 
	`CASE
(
OP_£t_v¨_ªf
):

16673 
idx
;

16674 
idx
 = 
	`gë_u16
(
pc
);

16675 
pc
 += 2;

16676 
	`£t_vÆue
(
˘x
, 
v¨_ªfs
[
idx
]->
pvÆue
, 
	`JS_DupVÆue
(˘x, 
•
[-1]));

16678 
BREAK
;

16679 
	`CASE
(
OP_gë_v¨_ªf_check
):

16681 
idx
;

16682 
JSVÆue
 
vÆ
;

16683 
idx
 = 
	`gë_u16
(
pc
);

16684 
pc
 += 2;

16685 
vÆ
 = *
v¨_ªfs
[
idx
]->
pvÆue
;

16686 i‡(
	`u∆ikñy
(
	`JS_IsUnöôülized
(
vÆ
))) {

16687 
	`JS_ThrowRe„ªn˚Eº‹Unöôülized
(
˘x
, 
JS_ATOM_NULL
);

16688 
ex˚±i⁄
;

16690 
•
[0] = 
	`JS_DupVÆue
(
˘x
, 
vÆ
);

16691 
•
++;

16693 
BREAK
;

16694 
	`CASE
(
OP_put_v¨_ªf_check
):

16696 
idx
;

16697 
idx
 = 
	`gë_u16
(
pc
);

16698 
pc
 += 2;

16699 i‡(
	`u∆ikñy
(
	`JS_IsUnöôülized
(*
v¨_ªfs
[
idx
]->
pvÆue
))) {

16700 
	`JS_ThrowRe„ªn˚Eº‹Unöôülized
(
˘x
, 
JS_ATOM_NULL
);

16701 
ex˚±i⁄
;

16703 
	`£t_vÆue
(
˘x
, 
v¨_ªfs
[
idx
]->
pvÆue
, 
•
[-1]);

16704 
•
--;

16706 
BREAK
;

16707 
	`CASE
(
OP_put_v¨_ªf_check_öô
):

16709 
idx
;

16710 
idx
 = 
	`gë_u16
(
pc
);

16711 
pc
 += 2;

16712 i‡(
	`u∆ikñy
(!
	`JS_IsUnöôülized
(*
v¨_ªfs
[
idx
]->
pvÆue
))) {

16713 
	`JS_ThrowRe„ªn˚Eº‹Unöôülized
(
˘x
, 
JS_ATOM_NULL
);

16714 
ex˚±i⁄
;

16716 
	`£t_vÆue
(
˘x
, 
v¨_ªfs
[
idx
]->
pvÆue
, 
•
[-1]);

16717 
•
--;

16719 
BREAK
;

16720 
	`CASE
(
OP_£t_loc_unöôülized
):

16722 
idx
;

16723 
idx
 = 
	`gë_u16
(
pc
);

16724 
pc
 += 2;

16725 
	`£t_vÆue
(
˘x
, &
v¨_buf
[
idx
], 
JS_UNINITIALIZED
);

16727 
BREAK
;

16728 
	`CASE
(
OP_gë_loc_check
):

16730 
idx
;

16731 
idx
 = 
	`gë_u16
(
pc
);

16732 
pc
 += 2;

16733 i‡(
	`u∆ikñy
(
	`JS_IsUnöôülized
(
v¨_buf
[
idx
]))) {

16734 
	`JS_ThrowRe„ªn˚Eº‹Unöôülized
(
˘x
, 
JS_ATOM_NULL
);

16735 
ex˚±i⁄
;

16737 
•
[0] = 
	`JS_DupVÆue
(
˘x
, 
v¨_buf
[
idx
]);

16738 
•
++;

16740 
BREAK
;

16741 
	`CASE
(
OP_put_loc_check
):

16743 
idx
;

16744 
idx
 = 
	`gë_u16
(
pc
);

16745 
pc
 += 2;

16746 i‡(
	`u∆ikñy
(
	`JS_IsUnöôülized
(
v¨_buf
[
idx
]))) {

16747 
	`JS_ThrowRe„ªn˚Eº‹Unöôülized
(
˘x
, 
JS_ATOM_NULL
);

16748 
ex˚±i⁄
;

16750 
	`£t_vÆue
(
˘x
, &
v¨_buf
[
idx
], 
•
[-1]);

16751 
•
--;

16753 
BREAK
;

16754 
	`CASE
(
OP_put_loc_check_öô
):

16756 
idx
;

16757 
idx
 = 
	`gë_u16
(
pc
);

16758 
pc
 += 2;

16759 i‡(
	`u∆ikñy
(!
	`JS_IsUnöôülized
(
v¨_buf
[
idx
]))) {

16760 
	`JS_ThrowRe„ªn˚Eº‹
(
˘x
, "'this' can be initialized only once");

16761 
ex˚±i⁄
;

16763 
	`£t_vÆue
(
˘x
, &
v¨_buf
[
idx
], 
•
[-1]);

16764 
•
--;

16766 
BREAK
;

16767 
	`CASE
(
OP_˛o£_loc
):

16769 
idx
;

16770 
idx
 = 
	`gë_u16
(
pc
);

16771 
pc
 += 2;

16772 
	`˛o£_Àxiˇl_v¨
(
˘x
, 
sf
, 
idx
, 
FALSE
);

16774 
BREAK
;

16776 
	`CASE
(
OP_make_loc_ªf
):

16777 
	`CASE
(
OP_make_¨g_ªf
):

16778 
	`CASE
(
OP_make_v¨_ªf_ªf
):

16780 
JSV¨Ref
 *
v¨_ªf
;

16781 
JSPr›îty
 *
¥
;

16782 
JSAtom
 
©om
;

16783 
idx
;

16784 
©om
 = 
	`gë_u32
(
pc
);

16785 
idx
 = 
	`gë_u16
(
pc
 + 4);

16786 
pc
 += 6;

16787 *
•
++ = 
	`JS_NewObje˘PrŸo
(
˘x
, 
JS_NULL
);

16788 i‡(
	`u∆ikñy
(
	`JS_IsEx˚±i⁄
(
•
[-1])))

16789 
ex˚±i⁄
;

16790 i‡(
›code
 =
OP_make_v¨_ªf_ªf
) {

16791 
v¨_ªf
 = 
v¨_ªfs
[
idx
];

16792 
v¨_ªf
->
hódî
.
ªf_cou¡
++;

16794 
v¨_ªf
 = 
	`gë_v¨_ªf
(
˘x
, 
sf
, 
idx
, 
›code
 =
OP_make_¨g_ªf
);

16795 i‡(!
v¨_ªf
)

16796 
ex˚±i⁄
;

16798 
¥
 = 
	`add_¥›îty
(
˘x
, 
	`JS_VALUE_GET_OBJ
(
•
[-1]), 
©om
,

16799 
JS_PROP_WRITABLE
 | 
JS_PROP_VARREF
);

16800 i‡(!
¥
) {

16801 
	`‰ì_v¨_ªf
(
π
, 
v¨_ªf
);

16802 
ex˚±i⁄
;

16804 
¥
->
u
.
v¨_ªf
 = var_ref;

16805 *
•
++ = 
	`JS_AtomToVÆue
(
˘x
, 
©om
);

16807 
BREAK
;

16808 
	`CASE
(
OP_make_v¨_ªf
):

16810 
JSAtom
 
©om
;

16811 
©om
 = 
	`gë_u32
(
pc
);

16812 
pc
 += 4;

16814 i‡(
	`JS_GëGlobÆV¨Ref
(
˘x
, 
©om
, 
•
))

16815 
ex˚±i⁄
;

16816 
•
 += 2;

16818 
BREAK
;

16820 
	`CASE
(
OP_gŸo
):

16821 
pc
 +(
öt32_t
)
	`gë_u32
(pc);

16822 i‡(
	`u∆ikñy
(
	`js_pﬁl_öãºu±s
(
˘x
)))

16823 
ex˚±i⁄
;

16824 
BREAK
;

16825 #i‡
SHORT_OPCODES


16826 
	`CASE
(
OP_gŸo16
):

16827 
pc
 +(
öt16_t
)
	`gë_u16
(pc);

16828 i‡(
	`u∆ikñy
(
	`js_pﬁl_öãºu±s
(
˘x
)))

16829 
ex˚±i⁄
;

16830 
BREAK
;

16831 
	`CASE
(
OP_gŸo8
):

16832 
pc
 +(
öt8_t
)pc[0];

16833 i‡(
	`u∆ikñy
(
	`js_pﬁl_öãºu±s
(
˘x
)))

16834 
ex˚±i⁄
;

16835 
BREAK
;

16837 
	`CASE
(
OP_if_åue
):

16839 
ªs
;

16840 
JSVÆue
 
›1
;

16842 
›1
 = 
•
[-1];

16843 
pc
 += 4;

16844 i‡((
uöt32_t
)
	`JS_VALUE_GET_TAG
(
›1
Ë<
JS_TAG_UNDEFINED
) {

16845 
ªs
 = 
	`JS_VALUE_GET_INT
(
›1
);

16847 
ªs
 = 
	`JS_ToBoﬁFªe
(
˘x
, 
›1
);

16849 
•
--;

16850 i‡(
ªs
) {

16851 
pc
 +(
öt32_t
)
	`gë_u32
(pc - 4) - 4;

16853 i‡(
	`u∆ikñy
(
	`js_pﬁl_öãºu±s
(
˘x
)))

16854 
ex˚±i⁄
;

16856 
BREAK
;

16857 
	`CASE
(
OP_if_Ál£
):

16859 
ªs
;

16860 
JSVÆue
 
›1
;

16862 
›1
 = 
•
[-1];

16863 
pc
 += 4;

16864 i‡((
uöt32_t
)
	`JS_VALUE_GET_TAG
(
›1
Ë<
JS_TAG_UNDEFINED
) {

16865 
ªs
 = 
	`JS_VALUE_GET_INT
(
›1
);

16867 
ªs
 = 
	`JS_ToBoﬁFªe
(
˘x
, 
›1
);

16869 
•
--;

16870 i‡(!
ªs
) {

16871 
pc
 +(
öt32_t
)
	`gë_u32
(pc - 4) - 4;

16873 i‡(
	`u∆ikñy
(
	`js_pﬁl_öãºu±s
(
˘x
)))

16874 
ex˚±i⁄
;

16876 
BREAK
;

16877 #i‡
SHORT_OPCODES


16878 
	`CASE
(
OP_if_åue8
):

16880 
ªs
;

16881 
JSVÆue
 
›1
;

16883 
›1
 = 
•
[-1];

16884 
pc
 += 1;

16885 i‡((
uöt32_t
)
	`JS_VALUE_GET_TAG
(
›1
Ë<
JS_TAG_UNDEFINED
) {

16886 
ªs
 = 
	`JS_VALUE_GET_INT
(
›1
);

16888 
ªs
 = 
	`JS_ToBoﬁFªe
(
˘x
, 
›1
);

16890 
•
--;

16891 i‡(
ªs
) {

16892 
pc
 +(
öt8_t
)pc[-1] - 1;

16894 i‡(
	`u∆ikñy
(
	`js_pﬁl_öãºu±s
(
˘x
)))

16895 
ex˚±i⁄
;

16897 
BREAK
;

16898 
	`CASE
(
OP_if_Ál£8
):

16900 
ªs
;

16901 
JSVÆue
 
›1
;

16903 
›1
 = 
•
[-1];

16904 
pc
 += 1;

16905 i‡((
uöt32_t
)
	`JS_VALUE_GET_TAG
(
›1
Ë<
JS_TAG_UNDEFINED
) {

16906 
ªs
 = 
	`JS_VALUE_GET_INT
(
›1
);

16908 
ªs
 = 
	`JS_ToBoﬁFªe
(
˘x
, 
›1
);

16910 
•
--;

16911 i‡(!
ªs
) {

16912 
pc
 +(
öt8_t
)pc[-1] - 1;

16914 i‡(
	`u∆ikñy
(
	`js_pﬁl_öãºu±s
(
˘x
)))

16915 
ex˚±i⁄
;

16917 
BREAK
;

16919 
	`CASE
(
OP_ˇtch
):

16921 
öt32_t
 
diff
;

16922 
diff
 = 
	`gë_u32
(
pc
);

16923 
•
[0] = 
	`JS_NewC©chOff£t
(
˘x
, 
pc
 + 
diff
 - 
b
->
byã_code_buf
);

16924 
•
++;

16925 
pc
 += 4;

16927 
BREAK
;

16928 
	`CASE
(
OP_gosub
):

16930 
öt32_t
 
diff
;

16931 
diff
 = 
	`gë_u32
(
pc
);

16933 
•
[0] = 
	`JS_NewI¡32
(
˘x
, 
pc
 + 4 - 
b
->
byã_code_buf
);

16934 
•
++;

16935 
pc
 +
diff
;

16937 
BREAK
;

16938 
	`CASE
(
OP_ªt
):

16940 
JSVÆue
 
›1
;

16941 
uöt32_t
 
pos
;

16942 
›1
 = 
•
[-1];

16943 i‡(
	`u∆ikñy
(
	`JS_VALUE_GET_TAG
(
›1
Ë!
JS_TAG_INT
))

16944 
ªt_Áû
;

16945 
pos
 = 
	`JS_VALUE_GET_INT
(
›1
);

16946 i‡(
	`u∆ikñy
(
pos
 >
b
->
byã_code_Àn
)) {

16947 
ªt_Áû
:

16948 
	`JS_ThrowI¡î«lEº‹
(
˘x
, "invalidÑet value");

16949 
ex˚±i⁄
;

16951 
•
--;

16952 
pc
 = 
b
->
byã_code_buf
 + 
pos
;

16954 
BREAK
;

16956 
	`CASE
(
OP_f‹_ö_°¨t
):

16957 i‡(
	`js_f‹_ö_°¨t
(
˘x
, 
•
))

16958 
ex˚±i⁄
;

16959 
BREAK
;

16960 
	`CASE
(
OP_f‹_ö_√xt
):

16961 i‡(
	`js_f‹_ö_√xt
(
˘x
, 
•
))

16962 
ex˚±i⁄
;

16963 
•
 += 2;

16964 
BREAK
;

16965 
	`CASE
(
OP_f‹_of_°¨t
):

16966 i‡(
	`js_f‹_of_°¨t
(
˘x
, 
•
, 
FALSE
))

16967 
ex˚±i⁄
;

16968 
•
 += 1;

16969 *
•
++ = 
	`JS_NewC©chOff£t
(
˘x
, 0);

16970 
BREAK
;

16971 
	`CASE
(
OP_f‹_of_√xt
):

16973 
off£t
 = -3 - 
pc
[0];

16974 
pc
 += 1;

16975 i‡(
	`js_f‹_of_√xt
(
˘x
, 
•
, 
off£t
))

16976 
ex˚±i⁄
;

16977 
•
 += 2;

16979 
BREAK
;

16980 
	`CASE
(
OP_f‹_awaô_of_°¨t
):

16981 i‡(
	`js_f‹_of_°¨t
(
˘x
, 
•
, 
TRUE
))

16982 
ex˚±i⁄
;

16983 
•
 += 1;

16984 *
•
++ = 
	`JS_NewC©chOff£t
(
˘x
, 0);

16985 
BREAK
;

16986 
	`CASE
(
OP_f‹_awaô_of_√xt
):

16987 i‡(
	`js_f‹_awaô_of_√xt
(
˘x
, 
•
))

16988 
ex˚±i⁄
;

16989 
•
 += 1;

16990 
BREAK
;

16991 
	`CASE
(
OP_ôî©‹_gë_vÆue_d⁄e
):

16992 i‡(
	`js_ôî©‹_gë_vÆue_d⁄e
(
˘x
, 
•
))

16993 
ex˚±i⁄
;

16994 
•
 += 1;

16995 
BREAK
;

16997 
	`CASE
(
OP_ôî©‹_˛o£
):

16999 
•
--;

17000 
	`JS_FªeVÆue
(
˘x
, 
•
[-1]);

17001 
•
--;

17002 i‡(!
	`JS_IsUndeföed
(
•
[-1])) {

17003 i‡(
	`JS_Iãøt‹Clo£
(
˘x
, 
•
[-1], 
FALSE
))

17004 
ex˚±i⁄
;

17005 
	`JS_FªeVÆue
(
˘x
, 
•
[-1]);

17007 
•
--;

17008 
BREAK
;

17009 
	`CASE
(
OP_ôî©‹_˛o£_ªtu∫
):

17011 
JSVÆue
 
ªt_vÆ
;

17014 
ªt_vÆ
 = *--
•
;

17015 
•
 > 
°ack_buf
 &&

17016 
	`JS_VALUE_GET_TAG
(
•
[-1]Ë!
JS_TAG_CATCH_OFFSET
) {

17017 
	`JS_FªeVÆue
(
˘x
, *--
•
);

17019 i‡(
	`u∆ikñy
(
•
 < 
°ack_buf
 + 3)) {

17020 
	`JS_ThrowI¡î«lEº‹
(
˘x
, "iterator_close_return");

17021 
	`JS_FªeVÆue
(
˘x
, 
ªt_vÆ
);

17022 
ex˚±i⁄
;

17024 
•
[0] = sp[-1];

17025 
•
[-1] = sp[-2];

17026 
•
[-2] = sp[-3];

17027 
•
[-3] = 
ªt_vÆ
;

17028 
•
++;

17030 
BREAK
;

17032 
	`CASE
(
OP_async_ôî©‹_˛o£
):

17035 
JSVÆue
 
ªt
, 
mëhod
;

17036 
ªt_Êag
;

17037 
•
--;

17038 
mëhod
 = 
	`JS_GëPr›îty
(
˘x
, 
•
[-2], 
JS_ATOM_ªtu∫
);

17039 i‡(
	`JS_IsEx˚±i⁄
(
mëhod
))

17040 
ex˚±i⁄
;

17041 i‡(
	`JS_IsUndeföed
(
mëhod
Ë|| 
	`JS_IsNuŒ
(method)) {

17042 
ªt
 = 
JS_UNDEFINED
;

17043 
ªt_Êag
 = 
TRUE
;

17045 
ªt
 = 
	`JS_CÆlFªe
(
˘x
, 
mëhod
, 
•
[-2], 0, 
NULL
);

17046 i‡(
	`JS_IsEx˚±i⁄
(
ªt
))

17047 
ex˚±i⁄
;

17048 i‡(!
	`JS_IsObje˘
(
ªt
)) {

17049 
	`JS_FªeVÆue
(
˘x
, 
ªt
);

17050 
	`JS_ThrowTy≥Eº‹NŸAnObje˘
(
˘x
);

17051 
ex˚±i⁄
;

17053 
ªt_Êag
 = 
FALSE
;

17055 
	`JS_FªeVÆue
(
˘x
, 
•
[-2]);

17056 
	`JS_FªeVÆue
(
˘x
, 
•
[-1]);

17057 
•
[-2] = 
ªt
;

17058 
•
[-1] = 
	`JS_NewBoﬁ
(
˘x
, 
ªt_Êag
);

17060 
BREAK
;

17062 
	`CASE
(
OP_async_ôî©‹_√xt
):

17065 
JSVÆue
 
ªt
;

17066 
ªt
 = 
	`JS_CÆl
(
˘x
, 
•
[-3], sp[-4],

17067 1, (
JSVÆueC⁄°
 *)(
•
 - 1));

17068 i‡(
	`JS_IsEx˚±i⁄
(
ªt
))

17069 
ex˚±i⁄
;

17070 
	`JS_FªeVÆue
(
˘x
, 
•
[-1]);

17071 
•
[-1] = 
ªt
;

17073 
BREAK
;

17075 
	`CASE
(
OP_async_ôî©‹_gë
):

17078 
JSVÆue
 
mëhod
, 
ªt
;

17079 
BOOL
 
ªt_Êag
;

17080 
Êags
;

17081 
Êags
 = *
pc
++;

17083 i‡(
Êags
 == 2) {

17084 
	`JS_ThrowTy≥Eº‹
(
˘x
, "iterator doesÇot haveáÅhrow method");

17085 
ex˚±i⁄
;

17087 
mëhod
 = 
	`JS_GëPr›îty
(
˘x
, 
•
[-4], 
Êags
 ? 
JS_ATOM_throw
 : 
JS_ATOM_ªtu∫
);

17088 i‡(
	`JS_IsEx˚±i⁄
(
mëhod
))

17089 
ex˚±i⁄
;

17090 i‡(
	`JS_IsUndeföed
(
mëhod
Ë|| 
	`JS_IsNuŒ
(method)) {

17091 
ªt_Êag
 = 
TRUE
;

17093 
ªt
 = 
	`JS_CÆlFªe
(
˘x
, 
mëhod
, 
•
[-4],

17094 1, (
JSVÆueC⁄°
 *)(
•
 - 1));

17095 i‡(
	`JS_IsEx˚±i⁄
(
ªt
))

17096 
ex˚±i⁄
;

17097 
	`JS_FªeVÆue
(
˘x
, 
•
[-1]);

17098 
•
[-1] = 
ªt
;

17099 
ªt_Êag
 = 
FALSE
;

17101 
•
[0] = 
	`JS_NewBoﬁ
(
˘x
, 
ªt_Êag
);

17102 
•
 += 1;

17104 
BREAK
;

17106 
	`CASE
(
OP_ Ÿ
):

17108 
ªs
;

17109 
JSVÆue
 
›1
;

17111 
›1
 = 
•
[-1];

17112 i‡((
uöt32_t
)
	`JS_VALUE_GET_TAG
(
›1
Ë<
JS_TAG_UNDEFINED
) {

17113 
ªs
 = 
	`JS_VALUE_GET_INT
(
›1
) != 0;

17115 
ªs
 = 
	`JS_ToBoﬁFªe
(
˘x
, 
›1
);

17117 
•
[-1] = 
	`JS_NewBoﬁ
(
˘x
, !
ªs
);

17119 
BREAK
;

17121 
	`CASE
(
OP_gë_fõld
):

17123 
JSVÆue
 
vÆ
;

17124 
JSAtom
 
©om
;

17125 
©om
 = 
	`gë_u32
(
pc
);

17126 
pc
 += 4;

17128 
vÆ
 = 
	`JS_GëPr›îty
(
˘x
, 
•
[-1], 
©om
);

17129 i‡(
	`u∆ikñy
(
	`JS_IsEx˚±i⁄
(
vÆ
)))

17130 
ex˚±i⁄
;

17131 
	`JS_FªeVÆue
(
˘x
, 
•
[-1]);

17132 
•
[-1] = 
vÆ
;

17134 
BREAK
;

17136 
	`CASE
(
OP_gë_fõld2
):

17138 
JSVÆue
 
vÆ
;

17139 
JSAtom
 
©om
;

17140 
©om
 = 
	`gë_u32
(
pc
);

17141 
pc
 += 4;

17143 
vÆ
 = 
	`JS_GëPr›îty
(
˘x
, 
•
[-1], 
©om
);

17144 i‡(
	`u∆ikñy
(
	`JS_IsEx˚±i⁄
(
vÆ
)))

17145 
ex˚±i⁄
;

17146 *
•
++ = 
vÆ
;

17148 
BREAK
;

17150 
	`CASE
(
OP_put_fõld
):

17152 
ªt
;

17153 
JSAtom
 
©om
;

17154 
©om
 = 
	`gë_u32
(
pc
);

17155 
pc
 += 4;

17157 
ªt
 = 
	`JS_SëPr›îtyI¡î«l
(
˘x
, 
•
[-2], 
©om
, sp[-1],

17158 
JS_PROP_THROW_STRICT
);

17159 
	`JS_FªeVÆue
(
˘x
, 
•
[-2]);

17160 
•
 -= 2;

17161 i‡(
	`u∆ikñy
(
ªt
 < 0))

17162 
ex˚±i⁄
;

17164 
BREAK
;

17166 
	`CASE
(
OP_¥iv©e_symbﬁ
):

17168 
JSAtom
 
©om
;

17169 
JSVÆue
 
vÆ
;

17171 
©om
 = 
	`gë_u32
(
pc
);

17172 
pc
 += 4;

17173 
vÆ
 = 
	`JS_NewSymbﬁFromAtom
(
˘x
, 
©om
, 
JS_ATOM_TYPE_PRIVATE
);

17174 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

17175 
ex˚±i⁄
;

17176 *
•
++ = 
vÆ
;

17178 
BREAK
;

17180 
	`CASE
(
OP_gë_¥iv©e_fõld
):

17182 
JSVÆue
 
vÆ
;

17184 
vÆ
 = 
	`JS_GëPriv©eFõld
(
˘x
, 
•
[-2], sp[-1]);

17185 
	`JS_FªeVÆue
(
˘x
, 
•
[-1]);

17186 
	`JS_FªeVÆue
(
˘x
, 
•
[-2]);

17187 
•
[-2] = 
vÆ
;

17188 
•
--;

17189 i‡(
	`u∆ikñy
(
	`JS_IsEx˚±i⁄
(
vÆ
)))

17190 
ex˚±i⁄
;

17192 
BREAK
;

17194 
	`CASE
(
OP_put_¥iv©e_fõld
):

17196 
ªt
;

17197 
ªt
 = 
	`JS_SëPriv©eFõld
(
˘x
, 
•
[-3], sp[-1], sp[-2]);

17198 
	`JS_FªeVÆue
(
˘x
, 
•
[-3]);

17199 
	`JS_FªeVÆue
(
˘x
, 
•
[-1]);

17200 
•
 -= 3;

17201 i‡(
	`u∆ikñy
(
ªt
 < 0))

17202 
ex˚±i⁄
;

17204 
BREAK
;

17206 
	`CASE
(
OP_deföe_¥iv©e_fõld
):

17208 
ªt
;

17209 
ªt
 = 
	`JS_DeföePriv©eFõld
(
˘x
, 
•
[-3], sp[-2], sp[-1]);

17210 
	`JS_FªeVÆue
(
˘x
, 
•
[-2]);

17211 
•
 -= 2;

17212 i‡(
	`u∆ikñy
(
ªt
 < 0))

17213 
ex˚±i⁄
;

17215 
BREAK
;

17217 
	`CASE
(
OP_deföe_fõld
):

17219 
ªt
;

17220 
JSAtom
 
©om
;

17221 
©om
 = 
	`gë_u32
(
pc
);

17222 
pc
 += 4;

17224 
ªt
 = 
	`JS_DeföePr›îtyVÆue
(
˘x
, 
•
[-2], 
©om
, sp[-1],

17225 
JS_PROP_C_W_E
 | 
JS_PROP_THROW
);

17226 
•
--;

17227 i‡(
	`u∆ikñy
(
ªt
 < 0))

17228 
ex˚±i⁄
;

17230 
BREAK
;

17232 
	`CASE
(
OP_£t_«me
):

17234 
ªt
;

17235 
JSAtom
 
©om
;

17236 
©om
 = 
	`gë_u32
(
pc
);

17237 
pc
 += 4;

17239 
ªt
 = 
	`JS_DeföeObje˘Name
(
˘x
, 
•
[-1], 
©om
, 
JS_PROP_CONFIGURABLE
);

17240 i‡(
	`u∆ikñy
(
ªt
 < 0))

17241 
ex˚±i⁄
;

17243 
BREAK
;

17244 
	`CASE
(
OP_£t_«me_compuãd
):

17246 
ªt
;

17247 
ªt
 = 
	`JS_DeföeObje˘NameCompuãd
(
˘x
, 
•
[-1], sp[-2], 
JS_PROP_CONFIGURABLE
);

17248 i‡(
	`u∆ikñy
(
ªt
 < 0))

17249 
ex˚±i⁄
;

17251 
BREAK
;

17252 
	`CASE
(
OP_£t_¥Ÿo
):

17254 
JSVÆue
 
¥Ÿo
;

17255 
¥Ÿo
 = 
•
[-1];

17256 i‡(
	`JS_IsObje˘
(
¥Ÿo
Ë|| 
	`JS_IsNuŒ
(proto)) {

17257 i‡(
	`JS_SëPrŸŸy≥I¡î«l
(
˘x
, 
•
[-2], 
¥Ÿo
, 
TRUE
) < 0)

17258 
ex˚±i⁄
;

17260 
	`JS_FªeVÆue
(
˘x
, 
¥Ÿo
);

17261 
•
--;

17263 
BREAK
;

17264 
	`CASE
(
OP_£t_home_obje˘
):

17265 
	`js_mëhod_£t_home_obje˘
(
˘x
, 
•
[-1], sp[-2]);

17266 
BREAK
;

17267 
	`CASE
(
OP_deföe_mëhod
):

17268 
	`CASE
(
OP_deföe_mëhod_compuãd
):

17270 
JSVÆue
 
gëãr
, 
£âî
, 
vÆue
;

17271 
JSVÆueC⁄°
 
obj
;

17272 
JSAtom
 
©om
;

17273 
Êags
, 
ªt
, 
›_Êags
;

17274 
BOOL
 
is_compuãd
;

17275 
	#OP_DEFINE_METHOD_METHOD
 0

	)

17276 
	#OP_DEFINE_METHOD_GETTER
 1

	)

17277 
	#OP_DEFINE_METHOD_SETTER
 2

	)

17278 
	#OP_DEFINE_METHOD_ENUMERABLE
 4

	)

17280 
is_compuãd
 = (
›code
 =
OP_deföe_mëhod_compuãd
);

17281 i‡(
is_compuãd
) {

17282 
©om
 = 
	`JS_VÆueToAtom
(
˘x
, 
•
[-2]);

17283 i‡(
	`u∆ikñy
(
©om
 =
JS_ATOM_NULL
))

17284 
ex˚±i⁄
;

17285 
›code
 +
OP_deföe_mëhod
 - 
OP_deföe_mëhod_compuãd
;

17287 
©om
 = 
	`gë_u32
(
pc
);

17288 
pc
 += 4;

17290 
›_Êags
 = *
pc
++;

17292 
obj
 = 
•
[-2 - 
is_compuãd
];

17293 
Êags
 = 
JS_PROP_HAS_CONFIGURABLE
 | 
JS_PROP_CONFIGURABLE
 |

17294 
JS_PROP_HAS_ENUMERABLE
 | 
JS_PROP_THROW
;

17295 i‡(
›_Êags
 & 
OP_DEFINE_METHOD_ENUMERABLE
)

17296 
Êags
 |
JS_PROP_ENUMERABLE
;

17297 
›_Êags
 &= 3;

17298 
vÆue
 = 
JS_UNDEFINED
;

17299 
gëãr
 = 
JS_UNDEFINED
;

17300 
£âî
 = 
JS_UNDEFINED
;

17301 i‡(
›_Êags
 =
OP_DEFINE_METHOD_METHOD
) {

17302 
vÆue
 = 
•
[-1];

17303 
Êags
 |
JS_PROP_HAS_VALUE
 | 
JS_PROP_HAS_WRITABLE
 | 
JS_PROP_WRITABLE
;

17304 } i‡(
›_Êags
 =
OP_DEFINE_METHOD_GETTER
) {

17305 
gëãr
 = 
•
[-1];

17306 
Êags
 |
JS_PROP_HAS_GET
;

17308 
£âî
 = 
•
[-1];

17309 
Êags
 |
JS_PROP_HAS_SET
;

17311 
ªt
 = 
	`js_mëhod_£t_¥›îtõs
(
˘x
, 
•
[-1], 
©om
, 
Êags
, 
obj
);

17312 i‡(
ªt
 >= 0) {

17313 
ªt
 = 
	`JS_DeföePr›îty
(
˘x
, 
obj
, 
©om
, 
vÆue
,

17314 
gëãr
, 
£âî
, 
Êags
);

17316 
	`JS_FªeVÆue
(
˘x
, 
•
[-1]);

17317 i‡(
is_compuãd
) {

17318 
	`JS_FªeAtom
(
˘x
, 
©om
);

17319 
	`JS_FªeVÆue
(
˘x
, 
•
[-2]);

17321 
•
 -1 + 
is_compuãd
;

17322 i‡(
	`u∆ikñy
(
ªt
 < 0))

17323 
ex˚±i⁄
;

17325 
BREAK
;

17327 
	`CASE
(
OP_deföe_˛ass
):

17328 
	`CASE
(
OP_deföe_˛ass_compuãd
):

17330 
˛ass_Êags
;

17331 
JSAtom
 
©om
;

17333 
©om
 = 
	`gë_u32
(
pc
);

17334 
˛ass_Êags
 = 
pc
[4];

17335 
pc
 += 5;

17336 i‡(
	`js_›_deföe_˛ass
(
˘x
, 
•
, 
©om
, 
˛ass_Êags
,

17337 
v¨_ªfs
, 
sf
,

17338 (
›code
 =
OP_deföe_˛ass_compuãd
)) < 0)

17339 
ex˚±i⁄
;

17341 
BREAK
;

17343 
	`CASE
(
OP_gë_¨øy_ñ
):

17345 
JSVÆue
 
vÆ
;

17347 
vÆ
 = 
	`JS_GëPr›îtyVÆue
(
˘x
, 
•
[-2], sp[-1]);

17348 
	`JS_FªeVÆue
(
˘x
, 
•
[-2]);

17349 
•
[-2] = 
vÆ
;

17350 
•
--;

17351 i‡(
	`u∆ikñy
(
	`JS_IsEx˚±i⁄
(
vÆ
)))

17352 
ex˚±i⁄
;

17354 
BREAK
;

17356 
	`CASE
(
OP_gë_¨øy_ñ2
):

17358 
JSVÆue
 
vÆ
;

17360 
vÆ
 = 
	`JS_GëPr›îtyVÆue
(
˘x
, 
•
[-2], sp[-1]);

17361 
•
[-1] = 
vÆ
;

17362 i‡(
	`u∆ikñy
(
	`JS_IsEx˚±i⁄
(
vÆ
)))

17363 
ex˚±i⁄
;

17365 
BREAK
;

17367 
	`CASE
(
OP_gë_ªf_vÆue
):

17369 
JSVÆue
 
vÆ
;

17370 i‡(
	`u∆ikñy
(
	`JS_IsUndeföed
(
•
[-2]))) {

17371 
JSAtom
 
©om
 = 
	`JS_VÆueToAtom
(
˘x
, 
•
[-1]);

17372 i‡(
©om
 !
JS_ATOM_NULL
) {

17373 
	`JS_ThrowRe„ªn˚Eº‹NŸDeföed
(
˘x
, 
©om
);

17374 
	`JS_FªeAtom
(
˘x
, 
©om
);

17376 
ex˚±i⁄
;

17378 
vÆ
 = 
	`JS_GëPr›îtyVÆue
(
˘x
, 
•
[-2],

17379 
	`JS_DupVÆue
(
˘x
, 
•
[-1]));

17380 i‡(
	`u∆ikñy
(
	`JS_IsEx˚±i⁄
(
vÆ
)))

17381 
ex˚±i⁄
;

17382 
•
[0] = 
vÆ
;

17383 
•
++;

17385 
BREAK
;

17387 
	`CASE
(
OP_gë_su≥r_vÆue
):

17389 
JSVÆue
 
vÆ
;

17390 
JSAtom
 
©om
;

17391 
©om
 = 
	`JS_VÆueToAtom
(
˘x
, 
•
[-1]);

17392 i‡(
	`u∆ikñy
(
©om
 =
JS_ATOM_NULL
))

17393 
ex˚±i⁄
;

17394 
vÆ
 = 
	`JS_GëPr›îtyI¡î«l
(
˘x
, 
•
[-2], 
©om
, sp[-3], 
FALSE
);

17395 
	`JS_FªeAtom
(
˘x
, 
©om
);

17396 i‡(
	`u∆ikñy
(
	`JS_IsEx˚±i⁄
(
vÆ
)))

17397 
ex˚±i⁄
;

17398 
	`JS_FªeVÆue
(
˘x
, 
•
[-1]);

17399 
	`JS_FªeVÆue
(
˘x
, 
•
[-2]);

17400 
	`JS_FªeVÆue
(
˘x
, 
•
[-3]);

17401 
•
[-3] = 
vÆ
;

17402 
•
 -= 2;

17404 
BREAK
;

17406 
	`CASE
(
OP_put_¨øy_ñ
):

17408 
ªt
;

17410 
ªt
 = 
	`JS_SëPr›îtyVÆue
(
˘x
, 
•
[-3], sp[-2], sp[-1], 
JS_PROP_THROW_STRICT
);

17411 
	`JS_FªeVÆue
(
˘x
, 
•
[-3]);

17412 
•
 -= 3;

17413 i‡(
	`u∆ikñy
(
ªt
 < 0))

17414 
ex˚±i⁄
;

17416 
BREAK
;

17418 
	`CASE
(
OP_put_ªf_vÆue
):

17420 
ªt
;

17421 i‡(
	`u∆ikñy
(
	`JS_IsUndeföed
(
•
[-3]))) {

17422 i‡(
	`is_°ri˘_mode
(
˘x
)) {

17423 
JSAtom
 
©om
 = 
	`JS_VÆueToAtom
(
˘x
, 
•
[-2]);

17424 i‡(
©om
 !
JS_ATOM_NULL
) {

17425 
	`JS_ThrowRe„ªn˚Eº‹NŸDeföed
(
˘x
, 
©om
);

17426 
	`JS_FªeAtom
(
˘x
, 
©om
);

17428 
ex˚±i⁄
;

17430 
•
[-3] = 
	`JS_DupVÆue
(
˘x
, ctx->
globÆ_obj
);

17433 
ªt
 = 
	`JS_SëPr›îtyVÆue
(
˘x
, 
•
[-3], sp[-2], sp[-1], 
JS_PROP_THROW_STRICT
);

17434 
	`JS_FªeVÆue
(
˘x
, 
•
[-3]);

17435 
•
 -= 3;

17436 i‡(
	`u∆ikñy
(
ªt
 < 0))

17437 
ex˚±i⁄
;

17439 
BREAK
;

17441 
	`CASE
(
OP_put_su≥r_vÆue
):

17443 
ªt
;

17444 
JSAtom
 
©om
;

17445 i‡(
	`JS_VALUE_GET_TAG
(
•
[-3]Ë!
JS_TAG_OBJECT
) {

17446 
	`JS_ThrowTy≥Eº‹NŸAnObje˘
(
˘x
);

17447 
ex˚±i⁄
;

17449 
©om
 = 
	`JS_VÆueToAtom
(
˘x
, 
•
[-2]);

17450 i‡(
	`u∆ikñy
(
©om
 =
JS_ATOM_NULL
))

17451 
ex˚±i⁄
;

17452 
ªt
 = 
	`JS_SëPr›îtyGíîic
(
˘x
, 
	`JS_VALUE_GET_OBJ
(
•
[-3]),

17453 
©om
, 
•
[-1], sp[-4],

17454 
JS_PROP_THROW_STRICT
);

17455 
	`JS_FªeAtom
(
˘x
, 
©om
);

17456 
	`JS_FªeVÆue
(
˘x
, 
•
[-4]);

17457 
	`JS_FªeVÆue
(
˘x
, 
•
[-3]);

17458 
	`JS_FªeVÆue
(
˘x
, 
•
[-2]);

17459 
•
 -= 4;

17460 i‡(
ªt
 < 0)

17461 
ex˚±i⁄
;

17463 
BREAK
;

17465 
	`CASE
(
OP_deföe_¨øy_ñ
):

17467 
ªt
;

17468 
ªt
 = 
	`JS_DeföePr›îtyVÆueVÆue
(
˘x
, 
•
[-3], 
	`JS_DupVÆue
(ctx, sp[-2]), sp[-1],

17469 
JS_PROP_C_W_E
 | 
JS_PROP_THROW
);

17470 
•
 -= 1;

17471 i‡(
	`u∆ikñy
(
ªt
 < 0))

17472 
ex˚±i⁄
;

17474 
BREAK
;

17476 
	`CASE
(
OP_≠≥nd
):

17478 i‡(
	`js_≠≥nd_íumî©e
(
˘x
, 
•
))

17479 
ex˚±i⁄
;

17480 
	`JS_FªeVÆue
(
˘x
, *--
•
);

17482 
BREAK
;

17484 
	`CASE
(
OP_c›y_d©a_¥›îtõs
):

17490 
mask
;

17492 
mask
 = *
pc
++;

17493 i‡(
	`JS_C›yD©aPr›îtõs
(
˘x
, 
•
[-1 - (
mask
 & 3)],

17494 
•
[-1 - ((
mask
 >> 2) & 7)],

17495 
•
[-1 - ((
mask
 >> 5) & 7)], 0))

17496 
ex˚±i⁄
;

17498 
BREAK
;

17500 
	`CASE
(
OP_add
):

17502 
JSVÆue
 
›1
, 
›2
;

17503 
›1
 = 
•
[-2];

17504 
›2
 = 
•
[-1];

17505 i‡(
	`likñy
(
	`JS_VALUE_IS_BOTH_INT
(
›1
, 
›2
))) {

17506 
söt64_t
 
r
;

17507 
r
 = (
söt64_t
)
	`JS_VALUE_GET_INT
(
›1
Ë+ JS_VALUE_GET_INT(
›2
);

17508 i‡(
	`u∆ikñy
(()
r
 !=Ñ))

17509 
add_¶ow
;

17510 
•
[-2] = 
	`JS_NewI¡32
(
˘x
, 
r
);

17511 
•
--;

17512 } i‡(
	`JS_VALUE_IS_BOTH_FLOAT
(
›1
, 
›2
)) {

17513 
•
[-2] = 
	`__JS_NewFlﬂt64
(
˘x
, 
	`JS_VALUE_GET_FLOAT64
(
›1
) +

17514 
	`JS_VALUE_GET_FLOAT64
(
›2
));

17515 
•
--;

17517 
add_¶ow
:

17518 i‡(
	`js_add_¶ow
(
˘x
, 
•
))

17519 
ex˚±i⁄
;

17520 
•
--;

17523 
BREAK
;

17524 
	`CASE
(
OP_add_loc
):

17526 
JSVÆue
 
›s
[2];

17527 
idx
;

17528 
idx
 = *
pc
;

17529 
pc
 += 1;

17531 
›s
[0] = 
v¨_buf
[
idx
];

17532 
›s
[1] = 
•
[-1];

17533 i‡(
	`likñy
(
	`JS_VALUE_IS_BOTH_INT
(
›s
[0], ops[1]))) {

17534 
söt64_t
 
r
;

17535 
r
 = (
söt64_t
)
	`JS_VALUE_GET_INT
(
›s
[0]) + JS_VALUE_GET_INT(ops[1]);

17536 i‡(
	`u∆ikñy
(()
r
 !=Ñ))

17537 
add_loc_¶ow
;

17538 
v¨_buf
[
idx
] = 
	`JS_NewI¡32
(
˘x
, 
r
);

17539 
•
--;

17540 } i‡(
	`JS_VALUE_GET_TAG
(
›s
[0]Ë=
JS_TAG_STRING
) {

17541 
•
--;

17542 
›s
[1] = 
	`JS_ToPrimôiveFªe
(
˘x
, ops[1], 
HINT_NONE
);

17543 i‡(
	`JS_IsEx˚±i⁄
(
›s
[1])) {

17544 
ex˚±i⁄
;

17548 
›s
[0] = 
	`JS_C⁄ˇtSåög
(
˘x
, ops[0], ops[1]);

17549 i‡(
	`JS_IsEx˚±i⁄
(
›s
[0])) {

17550 
v¨_buf
[
idx
] = 
JS_UNDEFINED
;

17551 
ex˚±i⁄
;

17553 
v¨_buf
[
idx
] = 
›s
[0];

17555 
add_loc_¶ow
:

17558 
•
--;

17562 i‡(
	`js_add_¶ow
(
˘x
, 
›s
 + 2)) {

17563 
v¨_buf
[
idx
] = 
JS_UNDEFINED
;

17564 
ex˚±i⁄
;

17566 
v¨_buf
[
idx
] = 
›s
[0];

17569 
BREAK
;

17570 
	`CASE
(
OP_sub
):

17572 
JSVÆue
 
›1
, 
›2
;

17573 
›1
 = 
•
[-2];

17574 
›2
 = 
•
[-1];

17575 i‡(
	`likñy
(
	`JS_VALUE_IS_BOTH_INT
(
›1
, 
›2
))) {

17576 
söt64_t
 
r
;

17577 
r
 = (
söt64_t
)
	`JS_VALUE_GET_INT
(
›1
Ë- JS_VALUE_GET_INT(
›2
);

17578 i‡(
	`u∆ikñy
(()
r
 !=Ñ))

17579 
bö¨y_¨ôh_¶ow
;

17580 
•
[-2] = 
	`JS_NewI¡32
(
˘x
, 
r
);

17581 
•
--;

17582 } i‡(
	`JS_VALUE_IS_BOTH_FLOAT
(
›1
, 
›2
)) {

17583 
•
[-2] = 
	`__JS_NewFlﬂt64
(
˘x
, 
	`JS_VALUE_GET_FLOAT64
(
›1
) -

17584 
	`JS_VALUE_GET_FLOAT64
(
›2
));

17585 
•
--;

17587 
bö¨y_¨ôh_¶ow
;

17590 
BREAK
;

17591 
	`CASE
(
OP_mul
):

17593 
JSVÆue
 
›1
, 
›2
;

17594 
d
;

17595 
›1
 = 
•
[-2];

17596 
›2
 = 
•
[-1];

17597 i‡(
	`likñy
(
	`JS_VALUE_IS_BOTH_INT
(
›1
, 
›2
))) {

17598 
öt32_t
 
v1
, 
v2
;

17599 
söt64_t
 
r
;

17600 
v1
 = 
	`JS_VALUE_GET_INT
(
›1
);

17601 
v2
 = 
	`JS_VALUE_GET_INT
(
›2
);

17602 
r
 = (
söt64_t
)
v1
 * 
v2
;

17603 i‡(
	`u∆ikñy
(()
r
 !=Ñ)) {

17604 #ifde‡
CONFIG_BIGNUM


17605 i‡(
	`u∆ikñy
(
sf
->
js_mode
 & 
JS_MODE_MATH
) &&

17606 (
r
 < -
MAX_SAFE_INTEGER
 ||Ñ > MAX_SAFE_INTEGER))

17607 
bö¨y_¨ôh_¶ow
;

17609 
d
 = ()
r
;

17610 
mul_Â_ªs
;

17613 i‡(
	`u∆ikñy
(
r
 =0 && (
v1
 | 
v2
) < 0)) {

17614 
d
 = -0.0;

17615 
mul_Â_ªs
;

17617 
•
[-2] = 
	`JS_NewI¡32
(
˘x
, 
r
);

17618 
•
--;

17619 } i‡(
	`JS_VALUE_IS_BOTH_FLOAT
(
›1
, 
›2
)) {

17620 #ifde‡
CONFIG_BIGNUM


17621 i‡(
	`u∆ikñy
(
sf
->
js_mode
 & 
JS_MODE_MATH
))

17622 
bö¨y_¨ôh_¶ow
;

17624 
d
 = 
	`JS_VALUE_GET_FLOAT64
(
›1
Ë* JS_VALUE_GET_FLOAT64(
›2
);

17625 
mul_Â_ªs
:

17626 
•
[-2] = 
	`__JS_NewFlﬂt64
(
˘x
, 
d
);

17627 
•
--;

17629 
bö¨y_¨ôh_¶ow
;

17632 
BREAK
;

17633 
	`CASE
(
OP_div
):

17635 
JSVÆue
 
›1
, 
›2
;

17636 
›1
 = 
•
[-2];

17637 
›2
 = 
•
[-1];

17638 i‡(
	`likñy
(
	`JS_VALUE_IS_BOTH_INT
(
›1
, 
›2
))) {

17639 
v1
, 
v2
;

17640 i‡(
	`u∆ikñy
(
sf
->
js_mode
 & 
JS_MODE_MATH
))

17641 
bö¨y_¨ôh_¶ow
;

17642 
v1
 = 
	`JS_VALUE_GET_INT
(
›1
);

17643 
v2
 = 
	`JS_VALUE_GET_INT
(
›2
);

17644 
•
[-2] = 
	`JS_NewFlﬂt64
(
˘x
, ()
v1
 / ()
v2
);

17645 
•
--;

17647 
bö¨y_¨ôh_¶ow
;

17650 
BREAK
;

17651 
	`CASE
(
OP_mod
):

17652 #ifde‡
CONFIG_BIGNUM


17653 
	`CASE
(
OP_m©h_mod
):

17656 
JSVÆue
 
›1
, 
›2
;

17657 
›1
 = 
•
[-2];

17658 
›2
 = 
•
[-1];

17659 i‡(
	`likñy
(
	`JS_VALUE_IS_BOTH_INT
(
›1
, 
›2
))) {

17660 
v1
, 
v2
, 
r
;

17661 
v1
 = 
	`JS_VALUE_GET_INT
(
›1
);

17662 
v2
 = 
	`JS_VALUE_GET_INT
(
›2
);

17665 i‡(
	`u∆ikñy
(
v1
 < 0 || 
v2
 <= 0))

17666 
bö¨y_¨ôh_¶ow
;

17667 
r
 = 
v1
 % 
v2
;

17668 
•
[-2] = 
	`JS_NewI¡32
(
˘x
, 
r
);

17669 
•
--;

17671 
bö¨y_¨ôh_¶ow
;

17674 
BREAK
;

17675 
	`CASE
(
OP_pow
):

17676 
bö¨y_¨ôh_¶ow
:

17677 i‡(
	`js_bö¨y_¨ôh_¶ow
(
˘x
, 
•
, 
›code
))

17678 
ex˚±i⁄
;

17679 
•
--;

17680 
BREAK
;

17682 
	`CASE
(
OP_∂us
):

17684 
JSVÆue
 
›1
;

17685 
uöt32_t
 
èg
;

17686 
›1
 = 
•
[-1];

17687 
èg
 = 
	`JS_VALUE_GET_TAG
(
›1
);

17688 i‡(
èg
 =
JS_TAG_INT
 || 
	`JS_TAG_IS_FLOAT64
(tag)) {

17690 i‡(
	`js_u«ry_¨ôh_¶ow
(
˘x
, 
•
, 
›code
))

17691 
ex˚±i⁄
;

17694 
BREAK
;

17695 
	`CASE
(
OP_√g
):

17697 
JSVÆue
 
›1
;

17698 
uöt32_t
 
èg
;

17699 
vÆ
;

17700 
d
;

17701 
›1
 = 
•
[-1];

17702 
èg
 = 
	`JS_VALUE_GET_TAG
(
›1
);

17703 i‡(
èg
 =
JS_TAG_INT
) {

17704 
vÆ
 = 
	`JS_VALUE_GET_INT
(
›1
);

17706 i‡(
	`u∆ikñy
(
vÆ
 == 0)) {

17707 
d
 = -0.0;

17708 
√g_Â_ªs
;

17710 i‡(
	`u∆ikñy
(
vÆ
 =
INT32_MIN
)) {

17711 
d
 = -()
vÆ
;

17712 
√g_Â_ªs
;

17714 
•
[-1] = 
	`JS_NewI¡32
(
˘x
, -
vÆ
);

17715 } i‡(
	`JS_TAG_IS_FLOAT64
(
èg
)) {

17716 
d
 = -
	`JS_VALUE_GET_FLOAT64
(
›1
);

17717 
√g_Â_ªs
:

17718 
•
[-1] = 
	`__JS_NewFlﬂt64
(
˘x
, 
d
);

17720 i‡(
	`js_u«ry_¨ôh_¶ow
(
˘x
, 
•
, 
›code
))

17721 
ex˚±i⁄
;

17724 
BREAK
;

17725 
	`CASE
(
OP_öc
):

17727 
JSVÆue
 
›1
;

17728 
vÆ
;

17729 
›1
 = 
•
[-1];

17730 i‡(
	`JS_VALUE_GET_TAG
(
›1
Ë=
JS_TAG_INT
) {

17731 
vÆ
 = 
	`JS_VALUE_GET_INT
(
›1
);

17732 i‡(
	`u∆ikñy
(
vÆ
 =
INT32_MAX
))

17733 
öc_¶ow
;

17734 
•
[-1] = 
	`JS_NewI¡32
(
˘x
, 
vÆ
 + 1);

17736 
öc_¶ow
:

17737 i‡(
	`js_u«ry_¨ôh_¶ow
(
˘x
, 
•
, 
›code
))

17738 
ex˚±i⁄
;

17741 
BREAK
;

17742 
	`CASE
(
OP_dec
):

17744 
JSVÆue
 
›1
;

17745 
vÆ
;

17746 
›1
 = 
•
[-1];

17747 i‡(
	`JS_VALUE_GET_TAG
(
›1
Ë=
JS_TAG_INT
) {

17748 
vÆ
 = 
	`JS_VALUE_GET_INT
(
›1
);

17749 i‡(
	`u∆ikñy
(
vÆ
 =
INT32_MIN
))

17750 
dec_¶ow
;

17751 
•
[-1] = 
	`JS_NewI¡32
(
˘x
, 
vÆ
 - 1);

17753 
dec_¶ow
:

17754 i‡(
	`js_u«ry_¨ôh_¶ow
(
˘x
, 
•
, 
›code
))

17755 
ex˚±i⁄
;

17758 
BREAK
;

17759 
	`CASE
(
OP_po°_öc
):

17760 
	`CASE
(
OP_po°_dec
):

17761 i‡(
	`js_po°_öc_¶ow
(
˘x
, 
•
, 
›code
))

17762 
ex˚±i⁄
;

17763 
•
++;

17764 
BREAK
;

17765 
	`CASE
(
OP_öc_loc
):

17767 
JSVÆue
 
›1
;

17768 
vÆ
;

17769 
idx
;

17770 
idx
 = *
pc
;

17771 
pc
 += 1;

17773 
›1
 = 
v¨_buf
[
idx
];

17774 i‡(
	`JS_VALUE_GET_TAG
(
›1
Ë=
JS_TAG_INT
) {

17775 
vÆ
 = 
	`JS_VALUE_GET_INT
(
›1
);

17776 i‡(
	`u∆ikñy
(
vÆ
 =
INT32_MAX
))

17777 
öc_loc_¶ow
;

17778 
v¨_buf
[
idx
] = 
	`JS_NewI¡32
(
˘x
, 
vÆ
 + 1);

17780 
öc_loc_¶ow
:

17781 i‡(
	`js_u«ry_¨ôh_¶ow
(
˘x
, 
v¨_buf
 + 
idx
 + 1, 
OP_öc
))

17782 
ex˚±i⁄
;

17785 
BREAK
;

17786 
	`CASE
(
OP_dec_loc
):

17788 
JSVÆue
 
›1
;

17789 
vÆ
;

17790 
idx
;

17791 
idx
 = *
pc
;

17792 
pc
 += 1;

17794 
›1
 = 
v¨_buf
[
idx
];

17795 i‡(
	`JS_VALUE_GET_TAG
(
›1
Ë=
JS_TAG_INT
) {

17796 
vÆ
 = 
	`JS_VALUE_GET_INT
(
›1
);

17797 i‡(
	`u∆ikñy
(
vÆ
 =
INT32_MIN
))

17798 
dec_loc_¶ow
;

17799 
v¨_buf
[
idx
] = 
	`JS_NewI¡32
(
˘x
, 
vÆ
 - 1);

17801 
dec_loc_¶ow
:

17802 i‡(
	`js_u«ry_¨ôh_¶ow
(
˘x
, 
v¨_buf
 + 
idx
 + 1, 
OP_dec
))

17803 
ex˚±i⁄
;

17806 
BREAK
;

17807 
	`CASE
(
OP_nŸ
):

17809 
JSVÆue
 
›1
;

17810 
›1
 = 
•
[-1];

17811 i‡(
	`JS_VALUE_GET_TAG
(
›1
Ë=
JS_TAG_INT
) {

17812 
•
[-1] = 
	`JS_NewI¡32
(
˘x
, ~
	`JS_VALUE_GET_INT
(
›1
));

17814 i‡(
	`js_nŸ_¶ow
(
˘x
, 
•
))

17815 
ex˚±i⁄
;

17818 
BREAK
;

17820 
	`CASE
(
OP_shl
):

17822 
JSVÆue
 
›1
, 
›2
;

17823 
›1
 = 
•
[-2];

17824 
›2
 = 
•
[-1];

17825 i‡(
	`likñy
(
	`JS_VALUE_IS_BOTH_INT
(
›1
, 
›2
))) {

17826 
uöt32_t
 
v1
, 
v2
;

17827 
v1
 = 
	`JS_VALUE_GET_INT
(
›1
);

17828 
v2
 = 
	`JS_VALUE_GET_INT
(
›2
);

17829 #ifde‡
CONFIG_BIGNUM


17831 
öt64_t
 
r
;

17832 i‡(
	`u∆ikñy
(
sf
->
js_mode
 & 
JS_MODE_MATH
)) {

17833 i‡(
v2
 > 0x1f)

17834 
shl_¶ow
;

17835 
r
 = (
öt64_t
)
v1
 << 
v2
;

17836 i‡(()
r
 !=Ñ)

17837 
shl_¶ow
;

17839 
v2
 &= 0x1f;

17843 
v2
 &= 0x1f;

17845 
•
[-2] = 
	`JS_NewI¡32
(
˘x
, 
v1
 << 
v2
);

17846 
•
--;

17848 #ifde‡
CONFIG_BIGNUM


17849 
shl_¶ow
:

17851 i‡(
	`js_bö¨y_logic_¶ow
(
˘x
, 
•
, 
›code
))

17852 
ex˚±i⁄
;

17853 
•
--;

17856 
BREAK
;

17857 
	`CASE
(
OP_shr
):

17859 
JSVÆue
 
›1
, 
›2
;

17860 
›1
 = 
•
[-2];

17861 
›2
 = 
•
[-1];

17862 i‡(
	`likñy
(
	`JS_VALUE_IS_BOTH_INT
(
›1
, 
›2
))) {

17863 
uöt32_t
 
v2
;

17864 
v2
 = 
	`JS_VALUE_GET_INT
(
›2
);

17866 
v2
 &= 0x1f;

17867 
•
[-2] = 
	`JS_NewUöt32
(
˘x
,

17868 (
uöt32_t
)
	`JS_VALUE_GET_INT
(
›1
) >>

17869 
v2
);

17870 
•
--;

17872 i‡(
	`js_shr_¶ow
(
˘x
, 
•
))

17873 
ex˚±i⁄
;

17874 
•
--;

17877 
BREAK
;

17878 
	`CASE
(
OP_ßr
):

17880 
JSVÆue
 
›1
, 
›2
;

17881 
›1
 = 
•
[-2];

17882 
›2
 = 
•
[-1];

17883 i‡(
	`likñy
(
	`JS_VALUE_IS_BOTH_INT
(
›1
, 
›2
))) {

17884 
uöt32_t
 
v2
;

17885 
v2
 = 
	`JS_VALUE_GET_INT
(
›2
);

17886 #ifde‡
CONFIG_BIGNUM


17887 i‡(
	`u∆ikñy
(
v2
 > 0x1f)) {

17888 i‡(
	`u∆ikñy
(
sf
->
js_mode
 & 
JS_MODE_MATH
))

17889 
ßr_¶ow
;

17891 
v2
 &= 0x1f;

17894 
v2
 &= 0x1f;

17896 
•
[-2] = 
	`JS_NewI¡32
(
˘x
,

17897 ()
	`JS_VALUE_GET_INT
(
›1
Ë>> 
v2
);

17898 
•
--;

17900 #ifde‡
CONFIG_BIGNUM


17901 
ßr_¶ow
:

17903 i‡(
	`js_bö¨y_logic_¶ow
(
˘x
, 
•
, 
›code
))

17904 
ex˚±i⁄
;

17905 
•
--;

17908 
BREAK
;

17909 
	`CASE
(
OP_™d
):

17911 
JSVÆue
 
›1
, 
›2
;

17912 
›1
 = 
•
[-2];

17913 
›2
 = 
•
[-1];

17914 i‡(
	`likñy
(
	`JS_VALUE_IS_BOTH_INT
(
›1
, 
›2
))) {

17915 
•
[-2] = 
	`JS_NewI¡32
(
˘x
,

17916 
	`JS_VALUE_GET_INT
(
›1
) &

17917 
	`JS_VALUE_GET_INT
(
›2
));

17918 
•
--;

17920 i‡(
	`js_bö¨y_logic_¶ow
(
˘x
, 
•
, 
›code
))

17921 
ex˚±i⁄
;

17922 
•
--;

17925 
BREAK
;

17926 
	`CASE
(
OP_‹
):

17928 
JSVÆue
 
›1
, 
›2
;

17929 
›1
 = 
•
[-2];

17930 
›2
 = 
•
[-1];

17931 i‡(
	`likñy
(
	`JS_VALUE_IS_BOTH_INT
(
›1
, 
›2
))) {

17932 
•
[-2] = 
	`JS_NewI¡32
(
˘x
,

17933 
	`JS_VALUE_GET_INT
(
›1
) |

17934 
	`JS_VALUE_GET_INT
(
›2
));

17935 
•
--;

17937 i‡(
	`js_bö¨y_logic_¶ow
(
˘x
, 
•
, 
›code
))

17938 
ex˚±i⁄
;

17939 
•
--;

17942 
BREAK
;

17943 
	`CASE
(
OP_x‹
):

17945 
JSVÆue
 
›1
, 
›2
;

17946 
›1
 = 
•
[-2];

17947 
›2
 = 
•
[-1];

17948 i‡(
	`likñy
(
	`JS_VALUE_IS_BOTH_INT
(
›1
, 
›2
))) {

17949 
•
[-2] = 
	`JS_NewI¡32
(
˘x
,

17950 
	`JS_VALUE_GET_INT
(
›1
) ^

17951 
	`JS_VALUE_GET_INT
(
›2
));

17952 
•
--;

17954 i‡(
	`js_bö¨y_logic_¶ow
(
˘x
, 
•
, 
›code
))

17955 
ex˚±i⁄
;

17956 
•
--;

17959 
BREAK
;

17962 
	#OP_CMP
(
›code
, 
bö¨y_›
, 
¶ow_ˇŒ
) \

17963 
	`CASE
(
›code
): \

17965 
JSVÆue
 
›1
, 
›2
; \

17966 
›1
 = 
•
[-2]; \

17967 
›2
 = 
•
[-1]; \

17968 i‡(
	`likñy
(
	`JS_VALUE_IS_BOTH_INT
(
›1
, 
›2
))) { \

17969 
•
[-2] = 
	`JS_NewBoﬁ
(
˘x
, 
	`JS_VALUE_GET_INT
(
›1
Ë
bö¨y_›
 JS_VALUE_GET_INT(
›2
)); \

17970 
•
--; \

17972 i‡(
¶ow_ˇŒ
) \

17973 
ex˚±i⁄
; \

17974 
•
--; \

17977 
BREAK


	)

17979 
	`OP_CMP
(
OP_…
, <, 
	`js_ªœti⁄Æ_¶ow
(
˘x
, 
•
, 
›code
));

17980 
	`OP_CMP
(
OP_…e
, <=, 
	`js_ªœti⁄Æ_¶ow
(
˘x
, 
•
, 
›code
));

17981 
	`OP_CMP
(
OP_gt
, >, 
	`js_ªœti⁄Æ_¶ow
(
˘x
, 
•
, 
›code
));

17982 
	`OP_CMP
(
OP_gã
, >=, 
	`js_ªœti⁄Æ_¶ow
(
˘x
, 
•
, 
›code
));

17983 
	`OP_CMP
(
OP_eq
, ==, 
	`js_eq_¶ow
(
˘x
, 
•
, 0));

17984 
	`OP_CMP
(
OP_√q
, !=, 
	`js_eq_¶ow
(
˘x
, 
•
, 1));

17985 
	`OP_CMP
(
OP_°ri˘_eq
, ==, 
	`js_°ri˘_eq_¶ow
(
˘x
, 
•
, 0));

17986 
	`OP_CMP
(
OP_°ri˘_√q
, !=, 
	`js_°ri˘_eq_¶ow
(
˘x
, 
•
, 1));

17988 #ifde‡
CONFIG_BIGNUM


17989 
	`CASE
(
OP_mul_pow10
):

17990 i‡(
π
->
bigÊﬂt_›s
.
	`mul_pow10
(
˘x
, 
•
))

17991 
ex˚±i⁄
;

17992 
•
--;

17993 
BREAK
;

17995 
	`CASE
(
OP_ö
):

17996 i‡(
	`js_›î©‹_ö
(
˘x
, 
•
))

17997 
ex˚±i⁄
;

17998 
•
--;

17999 
BREAK
;

18000 
	`CASE
(
OP_ö°™˚of
):

18001 i‡(
	`js_›î©‹_ö°™˚of
(
˘x
, 
•
))

18002 
ex˚±i⁄
;

18003 
•
--;

18004 
BREAK
;

18005 
	`CASE
(
OP_ty≥of
):

18007 
JSVÆue
 
›1
;

18008 
JSAtom
 
©om
;

18010 
›1
 = 
•
[-1];

18011 
©om
 = 
	`js_›î©‹_ty≥of
(
˘x
, 
›1
);

18012 
	`JS_FªeVÆue
(
˘x
, 
›1
);

18013 
•
[-1] = 
	`JS_AtomToSåög
(
˘x
, 
©om
);

18015 
BREAK
;

18016 
	`CASE
(
OP_dñëe
):

18017 i‡(
	`js_›î©‹_dñëe
(
˘x
, 
•
))

18018 
ex˚±i⁄
;

18019 
•
--;

18020 
BREAK
;

18021 
	`CASE
(
OP_dñëe_v¨
):

18023 
JSAtom
 
©om
;

18024 
ªt
;

18026 
©om
 = 
	`gë_u32
(
pc
);

18027 
pc
 += 4;

18029 
ªt
 = 
	`JS_DñëePr›îty
(
˘x
, ctx->
globÆ_obj
, 
©om
, 0);

18030 i‡(
	`u∆ikñy
(
ªt
 < 0))

18031 
ex˚±i⁄
;

18032 *
•
++ = 
	`JS_NewBoﬁ
(
˘x
, 
ªt
);

18034 
BREAK
;

18036 
	`CASE
(
OP_to_obje˘
):

18037 i‡(
	`JS_VALUE_GET_TAG
(
•
[-1]Ë!
JS_TAG_OBJECT
) {

18038 
ªt_vÆ
 = 
	`JS_ToObje˘
(
˘x
, 
•
[-1]);

18039 i‡(
	`JS_IsEx˚±i⁄
(
ªt_vÆ
))

18040 
ex˚±i⁄
;

18041 
	`JS_FªeVÆue
(
˘x
, 
•
[-1]);

18042 
•
[-1] = 
ªt_vÆ
;

18044 
BREAK
;

18046 
	`CASE
(
OP_to_¥›key
):

18047 
	`JS_VALUE_GET_TAG
(
•
[-1])) {

18048 
JS_TAG_INT
:

18049 
JS_TAG_STRING
:

18050 
JS_TAG_SYMBOL
:

18053 
ªt_vÆ
 = 
	`JS_ToPr›îtyKey
(
˘x
, 
•
[-1]);

18054 i‡(
	`JS_IsEx˚±i⁄
(
ªt_vÆ
))

18055 
ex˚±i⁄
;

18056 
	`JS_FªeVÆue
(
˘x
, 
•
[-1]);

18057 
•
[-1] = 
ªt_vÆ
;

18060 
BREAK
;

18062 
	`CASE
(
OP_to_¥›key2
):

18064 i‡(
	`u∆ikñy
(
	`JS_IsUndeföed
(
•
[-2]Ë|| 
	`JS_IsNuŒ
(sp[-2]))) {

18065 
	`JS_ThrowTy≥Eº‹
(
˘x
, "value hasÇoÖroperty");

18066 
ex˚±i⁄
;

18068 
	`JS_VALUE_GET_TAG
(
•
[-1])) {

18069 
JS_TAG_INT
:

18070 
JS_TAG_STRING
:

18071 
JS_TAG_SYMBOL
:

18074 
ªt_vÆ
 = 
	`JS_ToPr›îtyKey
(
˘x
, 
•
[-1]);

18075 i‡(
	`JS_IsEx˚±i⁄
(
ªt_vÆ
))

18076 
ex˚±i⁄
;

18077 
	`JS_FªeVÆue
(
˘x
, 
•
[-1]);

18078 
•
[-1] = 
ªt_vÆ
;

18081 
BREAK
;

18083 
	`CASE
(
OP_to_°rög
):

18084 i‡(
	`JS_VALUE_GET_TAG
(
•
[-1]Ë!
JS_TAG_STRING
) {

18085 
ªt_vÆ
 = 
	`JS_ToSåög
(
˘x
, 
•
[-1]);

18086 i‡(
	`JS_IsEx˚±i⁄
(
ªt_vÆ
))

18087 
ex˚±i⁄
;

18088 
	`JS_FªeVÆue
(
˘x
, 
•
[-1]);

18089 
•
[-1] = 
ªt_vÆ
;

18091 
BREAK
;

18093 
	`CASE
(
OP_wôh_gë_v¨
):

18094 
	`CASE
(
OP_wôh_put_v¨
):

18095 
	`CASE
(
OP_wôh_dñëe_v¨
):

18096 
	`CASE
(
OP_wôh_make_ªf
):

18097 
	`CASE
(
OP_wôh_gë_ªf
):

18098 
	`CASE
(
OP_wôh_gë_ªf_undef
):

18100 
JSAtom
 
©om
;

18101 
öt32_t
 
diff
;

18102 
JSVÆue
 
obj
, 
vÆ
;

18103 
ªt
, 
is_wôh
;

18104 
©om
 = 
	`gë_u32
(
pc
);

18105 
diff
 = 
	`gë_u32
(
pc
 + 4);

18106 
is_wôh
 = 
pc
[8];

18107 
pc
 += 9;

18109 
obj
 = 
•
[-1];

18110 
ªt
 = 
	`JS_HasPr›îty
(
˘x
, 
obj
, 
©om
);

18111 i‡(
	`u∆ikñy
(
ªt
 < 0))

18112 
ex˚±i⁄
;

18113 i‡(
ªt
) {

18114 i‡(
is_wôh
) {

18115 
ªt
 = 
	`js_has_unsc›abÀ
(
˘x
, 
obj
, 
©om
);

18116 i‡(
	`u∆ikñy
(
ªt
 < 0))

18117 
ex˚±i⁄
;

18118 i‡(
ªt
)

18119 
no_wôh
;

18121 
›code
) {

18122 
OP_wôh_gë_v¨
:

18123 
vÆ
 = 
	`JS_GëPr›îty
(
˘x
, 
obj
, 
©om
);

18124 i‡(
	`u∆ikñy
(
	`JS_IsEx˚±i⁄
(
vÆ
)))

18125 
ex˚±i⁄
;

18126 
	`£t_vÆue
(
˘x
, &
•
[-1], 
vÆ
);

18128 
OP_wôh_put_v¨
:

18129 
ªt
 = 
	`JS_SëPr›îtyI¡î«l
(
˘x
, 
obj
, 
©om
, 
•
[-2],

18130 
JS_PROP_THROW_STRICT
);

18131 
	`JS_FªeVÆue
(
˘x
, 
•
[-1]);

18132 
•
 -= 2;

18133 i‡(
	`u∆ikñy
(
ªt
 < 0))

18134 
ex˚±i⁄
;

18136 
OP_wôh_dñëe_v¨
:

18137 
ªt
 = 
	`JS_DñëePr›îty
(
˘x
, 
obj
, 
©om
, 0);

18138 i‡(
	`u∆ikñy
(
ªt
 < 0))

18139 
ex˚±i⁄
;

18140 
	`JS_FªeVÆue
(
˘x
, 
•
[-1]);

18141 
•
[-1] = 
	`JS_NewBoﬁ
(
˘x
, 
ªt
);

18143 
OP_wôh_make_ªf
:

18145 *
•
++ = 
	`JS_AtomToVÆue
(
˘x
, 
©om
);

18147 
OP_wôh_gë_ªf
:

18149 
vÆ
 = 
	`JS_GëPr›îty
(
˘x
, 
obj
, 
©om
);

18150 i‡(
	`u∆ikñy
(
	`JS_IsEx˚±i⁄
(
vÆ
)))

18151 
ex˚±i⁄
;

18152 *
•
++ = 
vÆ
;

18154 
OP_wôh_gë_ªf_undef
:

18156 
vÆ
 = 
	`JS_GëPr›îty
(
˘x
, 
obj
, 
©om
);

18157 i‡(
	`u∆ikñy
(
	`JS_IsEx˚±i⁄
(
vÆ
)))

18158 
ex˚±i⁄
;

18159 
	`JS_FªeVÆue
(
˘x
, 
•
[-1]);

18160 
•
[-1] = 
JS_UNDEFINED
;

18161 *
•
++ = 
vÆ
;

18164 
pc
 +
diff
 - 5;

18166 
no_wôh
:

18168 
	`JS_FªeVÆue
(
˘x
, 
•
[-1]);

18169 
•
--;

18172 
BREAK
;

18174 
	`CASE
(
OP_awaô
):

18175 
ªt_vÆ
 = 
	`JS_NewI¡32
(
˘x
, 
FUNC_RET_AWAIT
);

18176 
d⁄e_gíî©‹
;

18177 
	`CASE
(
OP_yõld
):

18178 
ªt_vÆ
 = 
	`JS_NewI¡32
(
˘x
, 
FUNC_RET_YIELD
);

18179 
d⁄e_gíî©‹
;

18180 
	`CASE
(
OP_yõld_°¨
):

18181 
	`CASE
(
OP_async_yõld_°¨
):

18182 
ªt_vÆ
 = 
	`JS_NewI¡32
(
˘x
, 
FUNC_RET_YIELD_STAR
);

18183 
d⁄e_gíî©‹
;

18184 
	`CASE
(
OP_ªtu∫_async
):

18185 
	`CASE
(
OP_öôül_yõld
):

18186 
ªt_vÆ
 = 
JS_UNDEFINED
;

18187 
d⁄e_gíî©‹
;

18189 
	`CASE
(
OP_n›
):

18190 
BREAK
;

18191 
	`CASE
(
OP_is_undeföed_‹_nuŒ
):

18192 i‡(
	`JS_VALUE_GET_TAG
(
•
[-1]Ë=
JS_TAG_UNDEFINED
 ||

18193 
	`JS_VALUE_GET_TAG
(
•
[-1]Ë=
JS_TAG_NULL
) {

18194 
£t_åue
;

18196 
‰ì_™d_£t_Ál£
;

18198 #i‡
SHORT_OPCODES


18199 
	`CASE
(
OP_is_undeföed
):

18200 i‡(
	`JS_VALUE_GET_TAG
(
•
[-1]Ë=
JS_TAG_UNDEFINED
) {

18201 
£t_åue
;

18203 
‰ì_™d_£t_Ál£
;

18205 
	`CASE
(
OP_is_nuŒ
):

18206 i‡(
	`JS_VALUE_GET_TAG
(
•
[-1]Ë=
JS_TAG_NULL
) {

18207 
£t_åue
;

18209 
‰ì_™d_£t_Ál£
;

18211 
	`CASE
(
OP_is_fun˘i⁄
):

18212 i‡(
	`js_›î©‹_ty≥of
(
˘x
, 
•
[-1]Ë=
JS_ATOM_fun˘i⁄
) {

18213 
‰ì_™d_£t_åue
;

18215 
‰ì_™d_£t_Ál£
;

18217 
‰ì_™d_£t_åue
:

18218 
	`JS_FªeVÆue
(
˘x
, 
•
[-1]);

18220 
£t_åue
:

18221 
•
[-1] = 
JS_TRUE
;

18222 
BREAK
;

18223 
‰ì_™d_£t_Ál£
:

18224 
	`JS_FªeVÆue
(
˘x
, 
•
[-1]);

18225 
•
[-1] = 
JS_FALSE
;

18226 
BREAK
;

18227 
	`CASE
(
OP_övÆid
):

18228 
DEFAULT
:

18229 
	`JS_ThrowI¡î«lEº‹
(
˘x
, "invalid opcode:Öc=%u opcode=0x%02x",

18230 ()(
pc
 - 
b
->
byã_code_buf
 - 1), 
›code
);

18231 
ex˚±i⁄
;

18234 
ex˚±i⁄
:

18235 i‡(
	`is_backåa˚_√eded
(
˘x
, 
π
->
cuºít_ex˚±i⁄
)) {

18239 
sf
->
cur_pc
 = 
pc
;

18240 
	`buûd_backåa˚
(
˘x
, 
π
->
cuºít_ex˚±i⁄
, 
NULL
, 0, 0);

18242 i‡(!
	`JS_IsUnˇtchabÀEº‹
(
˘x
, 
π
->
cuºít_ex˚±i⁄
)) {

18243 
•
 > 
°ack_buf
) {

18244 
JSVÆue
 
vÆ
 = *--
•
;

18245 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

18246 i‡(
	`JS_VALUE_GET_TAG
(
vÆ
Ë=
JS_TAG_CATCH_OFFSET
) {

18247 
pos
 = 
	`JS_VALUE_GET_INT
(
vÆ
);

18248 i‡(
pos
 == 0) {

18250 
	`JS_FªeVÆue
(
˘x
, 
•
[-1]);

18251 
•
--;

18252 
	`JS_Iãøt‹Clo£
(
˘x
, 
•
[-1], 
TRUE
);

18254 *
•
++ = 
π
->
cuºít_ex˚±i⁄
;

18255 
π
->
cuºít_ex˚±i⁄
 = 
JS_NULL
;

18256 
pc
 = 
b
->
byã_code_buf
 + 
pos
;

18257 
ª°¨t
;

18262 
ªt_vÆ
 = 
JS_EXCEPTION
;

18266 i‡(
b
->
func_köd
 !
JS_FUNC_NORMAL
) {

18267 
d⁄e_gíî©‹
:

18268 
sf
->
cur_pc
 = 
pc
;

18269 
sf
->
cur_•
 = 
•
;

18271 
d⁄e
:

18272 i‡(
	`u∆ikñy
(!
	`li°_em±y
(&
sf
->
v¨_ªf_li°
))) {

18274 
	`˛o£_v¨_ªfs
(
π
, 
sf
);

18277 
pvÆ
 = 
loˇl_buf
;ÖvÆ < 
•
;Öval++) {

18278 
	`JS_FªeVÆue
(
˘x
, *
pvÆ
);

18281 
π
->
cuºít_°ack_‰ame
 = 
sf
->
¥ev_‰ame
;

18282  
ªt_vÆ
;

18283 
	}
}

18285 
JSVÆue
 
	$JS_CÆl
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
func_obj
, JSVÆueC⁄° 
this_obj
,

18286 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

18288  
	`JS_CÆlI¡î«l
(
˘x
, 
func_obj
, 
this_obj
, 
JS_UNDEFINED
,

18289 
¨gc
, (
JSVÆue
 *)
¨gv
, 
JS_CALL_FLAG_COPY_ARGV
);

18290 
	}
}

18292 
JSVÆue
 
	$JS_CÆlFªe
(
JSC⁄ãxt
 *
˘x
, 
JSVÆue
 
func_obj
, 
JSVÆueC⁄°
 
this_obj
,

18293 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

18295 
JSVÆue
 
ªs
 = 
	`JS_CÆlI¡î«l
(
˘x
, 
func_obj
, 
this_obj
, 
JS_UNDEFINED
,

18296 
¨gc
, (
JSVÆue
 *)
¨gv
, 
JS_CALL_FLAG_COPY_ARGV
);

18297 
	`JS_FªeVÆue
(
˘x
, 
func_obj
);

18298  
ªs
;

18299 
	}
}

18303 
JSC⁄ãxt
 *
	$JS_GëFun˘i⁄Rólm
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
func_obj
)

18305 
JSObje˘
 *
p
;

18306 
JSC⁄ãxt
 *
ªÆm
;

18308 i‡(
	`JS_VALUE_GET_TAG
(
func_obj
Ë!
JS_TAG_OBJECT
)

18309  
˘x
;

18310 
p
 = 
	`JS_VALUE_GET_OBJ
(
func_obj
);

18311 
p
->
˛ass_id
) {

18312 
JS_CLASS_C_FUNCTION
:

18313 
ªÆm
 = 
p
->
u
.
cfunc
.realm;

18315 
JS_CLASS_BYTECODE_FUNCTION
:

18316 
JS_CLASS_GENERATOR_FUNCTION
:

18317 
JS_CLASS_ASYNC_FUNCTION
:

18318 
JS_CLASS_ASYNC_GENERATOR_FUNCTION
:

18320 
JSFun˘i⁄Byãcode
 *
b
;

18321 
b
 = 
p
->
u
.
func
.
fun˘i⁄_byãcode
;

18322 
ªÆm
 = 
b
->realm;

18325 
JS_CLASS_PROXY
:

18327 
JSProxyD©a
 *
s
 = 
p
->
u
.
›aque
;

18328 i‡(!
s
)

18329  
˘x
;

18330 i‡(
s
->
is_ªvoked
) {

18331 
	`JS_ThrowTy≥Eº‹RevokedProxy
(
˘x
);

18332  
NULL
;

18334 
ªÆm
 = 
	`JS_GëFun˘i⁄Rólm
(
˘x
, 
s
->
èrgë
);

18338 
JS_CLASS_BOUND_FUNCTION
:

18340 
JSBoundFun˘i⁄
 *
bf
 = 
p
->
u
.
bound_fun˘i⁄
;

18341 
ªÆm
 = 
	`JS_GëFun˘i⁄Rólm
(
˘x
, 
bf
->
func_obj
);

18345 
ªÆm
 = 
˘x
;

18348  
ªÆm
;

18349 
	}
}

18351 
JSVÆue
 
	$js_¸óã_‰om_˘‹
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
˘‹
,

18352 
˛ass_id
)

18354 
JSVÆue
 
¥Ÿo
, 
obj
;

18355 
JSC⁄ãxt
 *
ªÆm
;

18357 i‡(
	`JS_IsUndeföed
(
˘‹
)) {

18358 
¥Ÿo
 = 
	`JS_DupVÆue
(
˘x
, ctx->
˛ass_¥Ÿo
[
˛ass_id
]);

18360 
¥Ÿo
 = 
	`JS_GëPr›îty
(
˘x
, 
˘‹
, 
JS_ATOM_¥ŸŸy≥
);

18361 i‡(
	`JS_IsEx˚±i⁄
(
¥Ÿo
))

18362  
¥Ÿo
;

18363 i‡(!
	`JS_IsObje˘
(
¥Ÿo
)) {

18364 
	`JS_FªeVÆue
(
˘x
, 
¥Ÿo
);

18365 
ªÆm
 = 
	`JS_GëFun˘i⁄Rólm
(
˘x
, 
˘‹
);

18366 i‡(!
ªÆm
)

18367  
JS_EXCEPTION
;

18368 
¥Ÿo
 = 
	`JS_DupVÆue
(
˘x
, 
ªÆm
->
˛ass_¥Ÿo
[
˛ass_id
]);

18371 
obj
 = 
	`JS_NewObje˘PrŸoCœss
(
˘x
, 
¥Ÿo
, 
˛ass_id
);

18372 
	`JS_FªeVÆue
(
˘x
, 
¥Ÿo
);

18373  
obj
;

18374 
	}
}

18377 
JSVÆue
 
	$JS_CÆlC⁄°ru˘‹I¡î«l
(
JSC⁄ãxt
 *
˘x
,

18378 
JSVÆueC⁄°
 
func_obj
,

18379 
JSVÆueC⁄°
 
√w_èrgë
,

18380 
¨gc
, 
JSVÆue
 *
¨gv
, 
Êags
)

18382 
JSObje˘
 *
p
;

18383 
JSFun˘i⁄Byãcode
 *
b
;

18385 i‡(
	`js_pﬁl_öãºu±s
(
˘x
))

18386  
JS_EXCEPTION
;

18387 
Êags
 |
JS_CALL_FLAG_CONSTRUCTOR
;

18388 i‡(
	`u∆ikñy
(
	`JS_VALUE_GET_TAG
(
func_obj
Ë!
JS_TAG_OBJECT
))

18389 
nŸ_a_fun˘i⁄
;

18390 
p
 = 
	`JS_VALUE_GET_OBJ
(
func_obj
);

18391 i‡(
	`u∆ikñy
(!
p
->
is_c⁄°ru˘‹
))

18392  
	`JS_ThrowTy≥Eº‹
(
˘x
, "notá constructor");

18393 i‡(
	`u∆ikñy
(
p
->
˛ass_id
 !
JS_CLASS_BYTECODE_FUNCTION
)) {

18394 
JSCœssCÆl
 *
ˇŒ_func
;

18395 
ˇŒ_func
 = 
˘x
->
π
->
˛ass_¨øy
[
p
->
˛ass_id
].
ˇŒ
;

18396 i‡(!
ˇŒ_func
) {

18397 
nŸ_a_fun˘i⁄
:

18398  
	`JS_ThrowTy≥Eº‹
(
˘x
, "notá function");

18400  
	`ˇŒ_func
(
˘x
, 
func_obj
, 
√w_èrgë
, 
¨gc
,

18401 (
JSVÆueC⁄°
 *)
¨gv
, 
Êags
);

18404 
b
 = 
p
->
u
.
func
.
fun˘i⁄_byãcode
;

18405 i‡(
b
->
is_dîived_˛ass_c⁄°ru˘‹
) {

18406  
	`JS_CÆlI¡î«l
(
˘x
, 
func_obj
, 
JS_UNDEFINED
, 
√w_èrgë
, 
¨gc
, 
¨gv
, 
Êags
);

18408 
JSVÆue
 
obj
, 
ªt
;

18410 
obj
 = 
	`js_¸óã_‰om_˘‹
(
˘x
, 
√w_èrgë
, 
JS_CLASS_OBJECT
);

18411 i‡(
	`JS_IsEx˚±i⁄
(
obj
))

18412  
JS_EXCEPTION
;

18413 
ªt
 = 
	`JS_CÆlI¡î«l
(
˘x
, 
func_obj
, 
obj
, 
√w_èrgë
, 
¨gc
, 
¨gv
, 
Êags
);

18414 i‡(
	`JS_VALUE_GET_TAG
(
ªt
Ë=
JS_TAG_OBJECT
 ||

18415 
	`JS_IsEx˚±i⁄
(
ªt
)) {

18416 
	`JS_FªeVÆue
(
˘x
, 
obj
);

18417  
ªt
;

18419 
	`JS_FªeVÆue
(
˘x
, 
ªt
);

18420  
obj
;

18423 
	}
}

18425 
JSVÆue
 
	$JS_CÆlC⁄°ru˘‹2
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
func_obj
,

18426 
JSVÆueC⁄°
 
√w_èrgë
,

18427 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

18429  
	`JS_CÆlC⁄°ru˘‹I¡î«l
(
˘x
, 
func_obj
, 
√w_èrgë
,

18430 
¨gc
, (
JSVÆue
 *)
¨gv
,

18431 
JS_CALL_FLAG_COPY_ARGV
);

18432 
	}
}

18434 
JSVÆue
 
	$JS_CÆlC⁄°ru˘‹
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
func_obj
,

18435 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

18437  
	`JS_CÆlC⁄°ru˘‹I¡î«l
(
˘x
, 
func_obj
, func_obj,

18438 
¨gc
, (
JSVÆue
 *)
¨gv
,

18439 
JS_CALL_FLAG_COPY_ARGV
);

18440 
	}
}

18442 
JSVÆue
 
	$JS_Invoke
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
, 
JSAtom
 
©om
,

18443 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

18445 
JSVÆue
 
func_obj
;

18446 
func_obj
 = 
	`JS_GëPr›îty
(
˘x
, 
this_vÆ
, 
©om
);

18447 i‡(
	`JS_IsEx˚±i⁄
(
func_obj
))

18448  
func_obj
;

18449  
	`JS_CÆlFªe
(
˘x
, 
func_obj
, 
this_vÆ
, 
¨gc
, 
¨gv
);

18450 
	}
}

18452 
JSVÆue
 
	$JS_InvokeFªe
(
JSC⁄ãxt
 *
˘x
, 
JSVÆue
 
this_vÆ
, 
JSAtom
 
©om
,

18453 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

18455 
JSVÆue
 
ªs
 = 
	`JS_Invoke
(
˘x
, 
this_vÆ
, 
©om
, 
¨gc
, 
¨gv
);

18456 
	`JS_FªeVÆue
(
˘x
, 
this_vÆ
);

18457  
ªs
;

18458 
	}
}

18461 
__ex˚±i⁄
 
	$async_func_öô
(
JSC⁄ãxt
 *
˘x
, 
JSAsyncFun˘i⁄Sèã
 *
s
,

18462 
JSVÆueC⁄°
 
func_obj
, JSVÆueC⁄° 
this_obj
,

18463 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

18465 
JSObje˘
 *
p
;

18466 
JSFun˘i⁄Byãcode
 *
b
;

18467 
JSSèckFøme
 *
sf
;

18468 
loˇl_cou¡
, 
i
, 
¨g_buf_Àn
, 
n
;

18470 
sf
 = &
s
->
‰ame
;

18471 
	`öô_li°_hód
(&
sf
->
v¨_ªf_li°
);

18472 
p
 = 
	`JS_VALUE_GET_OBJ
(
func_obj
);

18473 
b
 = 
p
->
u
.
func
.
fun˘i⁄_byãcode
;

18474 
sf
->
js_mode
 = 
b
->js_mode;

18475 
sf
->
cur_pc
 = 
b
->
byã_code_buf
;

18476 
¨g_buf_Àn
 = 
	`max_öt
(
b
->
¨g_cou¡
, 
¨gc
);

18477 
loˇl_cou¡
 = 
¨g_buf_Àn
 + 
b
->
v¨_cou¡
 + b->
°ack_size
;

18478 
sf
->
¨g_buf
 = 
	`js_mÆloc
(
˘x
, (
JSVÆue
Ë* 
	`max_öt
(
loˇl_cou¡
, 1));

18479 i‡(!
sf
->
¨g_buf
)

18481 
sf
->
cur_func
 = 
	`JS_DupVÆue
(
˘x
, 
func_obj
);

18482 
s
->
this_vÆ
 = 
	`JS_DupVÆue
(
˘x
, 
this_obj
);

18483 
s
->
¨gc
 =árgc;

18484 
sf
->
¨g_cou¡
 = 
¨g_buf_Àn
;

18485 
sf
->
v¨_buf
 = sf->
¨g_buf
 + 
¨g_buf_Àn
;

18486 
sf
->
cur_•
 = sf->
v¨_buf
 + 
b
->
v¨_cou¡
;

18487 
i
 = 0; i < 
¨gc
; i++)

18488 
sf
->
¨g_buf
[
i
] = 
	`JS_DupVÆue
(
˘x
, 
¨gv
[i]);

18489 
n
 = 
¨g_buf_Àn
 + 
b
->
v¨_cou¡
;

18490 
i
 = 
¨gc
; i < 
n
; i++)

18491 
sf
->
¨g_buf
[
i
] = 
JS_UNDEFINED
;

18493 
	}
}

18495 
	$async_func_m¨k
(
JSRu¡ime
 *
π
, 
JSAsyncFun˘i⁄Sèã
 *
s
,

18496 
JS_M¨kFunc
 *
m¨k_func
)

18498 
JSSèckFøme
 *
sf
;

18499 
JSVÆue
 *
•
;

18501 
sf
 = &
s
->
‰ame
;

18502 
	`JS_M¨kVÆue
(
π
, 
sf
->
cur_func
, 
m¨k_func
);

18503 
	`JS_M¨kVÆue
(
π
, 
s
->
this_vÆ
, 
m¨k_func
);

18504 i‡(
sf
->
cur_•
) {

18509 
•
 = 
sf
->
¨g_buf
; s∞< sf->
cur_•
; sp++)

18510 
	`JS_M¨kVÆue
(
π
, *
•
, 
m¨k_func
);

18512 
	}
}

18514 
	$async_func_‰ì
(
JSRu¡ime
 *
π
, 
JSAsyncFun˘i⁄Sèã
 *
s
)

18516 
JSSèckFøme
 *
sf
;

18517 
JSVÆue
 *
•
;

18519 
sf
 = &
s
->
‰ame
;

18522 
	`˛o£_v¨_ªfs
(
π
, 
sf
);

18524 i‡(
sf
->
¨g_buf
) {

18526 
	`as£π
(
sf
->
cur_•
 !
NULL
);

18527 
•
 = 
sf
->
¨g_buf
; s∞< sf->
cur_•
; sp++) {

18528 
	`JS_FªeVÆueRT
(
π
, *
•
);

18530 
	`js_‰ì_π
(
π
, 
sf
->
¨g_buf
);

18532 
	`JS_FªeVÆueRT
(
π
, 
sf
->
cur_func
);

18533 
	`JS_FªeVÆueRT
(
π
, 
s
->
this_vÆ
);

18534 
	}
}

18536 
JSVÆue
 
	$async_func_ªsume
(
JSC⁄ãxt
 *
˘x
, 
JSAsyncFun˘i⁄Sèã
 *
s
)

18538 
JSVÆue
 
func_obj
;

18541 
func_obj
 = 
	`JS_MKPTR
(
JS_TAG_INT
, 
s
);

18542  
	`JS_CÆlI¡î«l
(
˘x
, 
func_obj
, 
s
->
this_vÆ
, 
JS_UNDEFINED
,

18543 
s
->
¨gc
, s->
‰ame
.
¨g_buf
, 
JS_CALL_FLAG_GENERATOR
);

18544 
	}
}

18549 
	eJSGíî©‹SèãEnum
 {

18550 
	mJS_GENERATOR_STATE_SUSPENDED_START
,

18551 
	mJS_GENERATOR_STATE_SUSPENDED_YIELD
,

18552 
	mJS_GENERATOR_STATE_SUSPENDED_YIELD_STAR
,

18553 
	mJS_GENERATOR_STATE_EXECUTING
,

18554 
	mJS_GENERATOR_STATE_COMPLETED
,

18555 } 
	tJSGíî©‹SèãEnum
;

18557 
	sJSGíî©‹D©a
 {

18558 
JSGíî©‹SèãEnum
 
	m°©e
;

18559 
JSAsyncFun˘i⁄Sèã
 
	mfunc_°©e
;

18560 } 
	tJSGíî©‹D©a
;

18562 
	$‰ì_gíî©‹_°ack_π
(
JSRu¡ime
 *
π
, 
JSGíî©‹D©a
 *
s
)

18564 i‡(
s
->
°©e
 =
JS_GENERATOR_STATE_COMPLETED
)

18566 
	`async_func_‰ì
(
π
, &
s
->
func_°©e
);

18567 
s
->
°©e
 = 
JS_GENERATOR_STATE_COMPLETED
;

18568 
	}
}

18570 
	$js_gíî©‹_föÆizî
(
JSRu¡ime
 *
π
, 
JSVÆue
 
obj
)

18572 
JSGíî©‹D©a
 *
s
 = 
	`JS_GëO∑que
(
obj
, 
JS_CLASS_GENERATOR
);

18574 i‡(
s
) {

18575 
	`‰ì_gíî©‹_°ack_π
(
π
, 
s
);

18576 
	`js_‰ì_π
(
π
, 
s
);

18578 
	}
}

18580 
	$‰ì_gíî©‹_°ack
(
JSC⁄ãxt
 *
˘x
, 
JSGíî©‹D©a
 *
s
)

18582 
	`‰ì_gíî©‹_°ack_π
(
˘x
->
π
, 
s
);

18583 
	}
}

18585 
	$js_gíî©‹_m¨k
(
JSRu¡ime
 *
π
, 
JSVÆueC⁄°
 
vÆ
,

18586 
JS_M¨kFunc
 *
m¨k_func
)

18588 
JSObje˘
 *
p
 = 
	`JS_VALUE_GET_OBJ
(
vÆ
);

18589 
JSGíî©‹D©a
 *
s
 = 
p
->
u
.
gíî©‹_d©a
;

18591 i‡(!
s
 || s->
°©e
 =
JS_GENERATOR_STATE_COMPLETED
)

18593 
	`async_func_m¨k
(
π
, &
s
->
func_°©e
, 
m¨k_func
);

18594 
	}
}

18597 
	#GEN_MAGIC_NEXT
 0

	)

18598 
	#GEN_MAGIC_RETURN
 1

	)

18599 
	#GEN_MAGIC_THROW
 2

	)

18601 
JSVÆue
 
	$js_gíî©‹_√xt
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

18602 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
,

18603 
BOOL
 *
pd⁄e
, 
magic
)

18605 
JSGíî©‹D©a
 *
s
 = 
	`JS_GëO∑que
(
this_vÆ
, 
JS_CLASS_GENERATOR
);

18606 
JSSèckFøme
 *
sf
;

18607 
JSVÆue
 
ªt
, 
func_ªt
;

18608 
JSVÆueC⁄°
 
ôî_¨gs
[1];

18610 *
pd⁄e
 = 
TRUE
;

18611 i‡(!
s
)

18612  
	`JS_ThrowTy≥Eº‹
(
˘x
, "notá generator");

18613 
sf
 = &
s
->
func_°©e
.
‰ame
;

18614 
ªdo
:

18615 
s
->
°©e
) {

18617 
JS_GENERATOR_STATE_SUSPENDED_START
:

18618 i‡(
magic
 =
GEN_MAGIC_NEXT
) {

18619 
exec_no_¨g
;

18621 
	`‰ì_gíî©‹_°ack
(
˘x
, 
s
);

18622 
d⁄e
;

18625 
JS_GENERATOR_STATE_SUSPENDED_YIELD_STAR
:

18627 
d⁄e
;

18628 
JSVÆue
 
mëhod
, 
ôî_obj
;

18630 
ôî_obj
 = 
sf
->
cur_•
[-2];

18631 i‡(
magic
 =
GEN_MAGIC_NEXT
) {

18632 
mëhod
 = 
	`JS_DupVÆue
(
˘x
, 
sf
->
cur_•
[-1]);

18634 
mëhod
 = 
	`JS_GëPr›îty
(
˘x
, 
ôî_obj
,

18635 
magic
 =
GEN_MAGIC_RETURN
 ?

18636 
JS_ATOM_ªtu∫
 : 
JS_ATOM_throw
);

18637 i‡(
	`JS_IsEx˚±i⁄
(
mëhod
))

18638 
ôî_ex˚±i⁄
;

18640 i‡(
magic
 !
GEN_MAGIC_NEXT
 &&

18641 (
	`JS_IsUndeföed
(
mëhod
Ë|| 
	`JS_IsNuŒ
(method))) {

18643 i‡(
magic
 =
GEN_MAGIC_RETURN
) {

18644 
ªt
 = 
	`JS_DupVÆue
(
˘x
, 
¨gv
[0]);

18645 
ôî_d⁄e
;

18647 i‡(
	`JS_Iãøt‹Clo£
(
˘x
, 
ôî_obj
, 
FALSE
))

18648 
ôî_ex˚±i⁄
;

18649 
	`JS_ThrowTy≥Eº‹
(
˘x
, "iterator doesÇot haveáÅhrow method");

18650 
ôî_ex˚±i⁄
;

18653 
ªt
 = 
	`JS_Iãøt‹Next2
(
˘x
, 
ôî_obj
, 
mëhod
, 
¨gc
, 
¨gv
, &
d⁄e
);

18654 
	`JS_FªeVÆue
(
˘x
, 
mëhod
);

18655 i‡(
	`JS_IsEx˚±i⁄
(
ªt
)) {

18656 
ôî_ex˚±i⁄
:

18657 
exec_throw
;

18661 i‡(
d⁄e
 == 2) {

18662 
JSVÆue
 
d⁄e_vÆ
, 
vÆue
;

18663 
d⁄e_vÆ
 = 
	`JS_GëPr›îty
(
˘x
, 
ªt
, 
JS_ATOM_d⁄e
);

18664 i‡(
	`JS_IsEx˚±i⁄
(
d⁄e_vÆ
)) {

18665 
	`JS_FªeVÆue
(
˘x
, 
ªt
);

18666 
ôî_ex˚±i⁄
;

18668 
d⁄e
 = 
	`JS_ToBoﬁFªe
(
˘x
, 
d⁄e_vÆ
);

18669 i‡(
d⁄e
) {

18670 
vÆue
 = 
	`JS_GëPr›îty
(
˘x
, 
ªt
, 
JS_ATOM_vÆue
);

18671 
	`JS_FªeVÆue
(
˘x
, 
ªt
);

18672 i‡(
	`JS_IsEx˚±i⁄
(
vÆue
))

18673 
ôî_ex˚±i⁄
;

18674 
ªt
 = 
vÆue
;

18675 
ôî_d⁄e
;

18677 *
pd⁄e
 = 2;

18680 i‡(
d⁄e
) {

18682 
ôî_d⁄e
:

18683 
	`JS_FªeVÆue
(
˘x
, 
sf
->
cur_•
[-2]);

18684 
	`JS_FªeVÆue
(
˘x
, 
sf
->
cur_•
[-1]);

18685 
sf
->
cur_•
--;

18686 
exec_¨g
;

18688 *
pd⁄e
 = 
FALSE
;

18694 
JS_GENERATOR_STATE_SUSPENDED_YIELD
:

18696 
ªt
 = 
	`JS_DupVÆue
(
˘x
, 
¨gv
[0]);

18697 i‡(
magic
 =
GEN_MAGIC_THROW
) {

18698 
	`JS_Throw
(
˘x
, 
ªt
);

18699 
exec_throw
:

18700 
s
->
func_°©e
.
throw_Êag
 = 
TRUE
;

18702 
exec_¨g
:

18703 
sf
->
cur_•
[-1] = 
ªt
;

18704 
sf
->
cur_•
[0] = 
	`JS_NewBoﬁ
(
˘x
, (
magic
 =
GEN_MAGIC_RETURN
));

18705 
sf
->
cur_•
++;

18706 
exec_no_¨g
:

18707 
s
->
func_°©e
.
throw_Êag
 = 
FALSE
;

18709 
s
->
°©e
 = 
JS_GENERATOR_STATE_EXECUTING
;

18710 
func_ªt
 = 
	`async_func_ªsume
(
˘x
, &
s
->
func_°©e
);

18711 
s
->
°©e
 = 
JS_GENERATOR_STATE_SUSPENDED_YIELD
;

18712 i‡(
	`JS_IsEx˚±i⁄
(
func_ªt
)) {

18714 
	`‰ì_gíî©‹_°ack
(
˘x
, 
s
);

18715  
func_ªt
;

18717 i‡(
	`JS_VALUE_GET_TAG
(
func_ªt
Ë=
JS_TAG_INT
) {

18718 i‡(
	`JS_VALUE_GET_INT
(
func_ªt
Ë=
FUNC_RET_YIELD_STAR
) {

18720 
s
->
°©e
 = 
JS_GENERATOR_STATE_SUSPENDED_YIELD_STAR
;

18721 
ôî_¨gs
[0] = 
JS_UNDEFINED
;

18722 
¨gc
 = 1;

18723 
¨gv
 = 
ôî_¨gs
;

18724 
ªdo
;

18727 
ªt
 = 
sf
->
cur_•
[-1];

18728 
sf
->
cur_•
[-1] = 
JS_UNDEFINED
;

18729 *
pd⁄e
 = 
FALSE
;

18733 
ªt
 = 
sf
->
cur_•
[-1];

18734 
sf
->
cur_•
[-1] = 
JS_UNDEFINED
;

18735 
	`JS_FªeVÆue
(
˘x
, 
func_ªt
);

18736 
	`‰ì_gíî©‹_°ack
(
˘x
, 
s
);

18739 
JS_GENERATOR_STATE_COMPLETED
:

18740 
d⁄e
:

18742 
magic
) {

18744 
GEN_MAGIC_NEXT
:

18745 
ªt
 = 
JS_UNDEFINED
;

18747 
GEN_MAGIC_RETURN
:

18748 
ªt
 = 
	`JS_DupVÆue
(
˘x
, 
¨gv
[0]);

18750 
GEN_MAGIC_THROW
:

18751 
ªt
 = 
	`JS_Throw
(
˘x
, 
	`JS_DupVÆue
(˘x, 
¨gv
[0]));

18755 
JS_GENERATOR_STATE_EXECUTING
:

18756 
ªt
 = 
	`JS_ThrowTy≥Eº‹
(
˘x
, "cannot invokeáÑunning generator");

18759  
ªt
;

18760 
	}
}

18762 
JSVÆue
 
	$js_gíî©‹_fun˘i⁄_ˇŒ
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
func_obj
,

18763 
JSVÆueC⁄°
 
this_obj
,

18764 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
,

18765 
Êags
)

18767 
JSVÆue
 
obj
, 
func_ªt
;

18768 
JSGíî©‹D©a
 *
s
;

18770 
s
 = 
	`js_mÆlocz
(
˘x
, (*s));

18771 i‡(!
s
)

18772  
JS_EXCEPTION
;

18773 
s
->
°©e
 = 
JS_GENERATOR_STATE_SUSPENDED_START
;

18774 i‡(
	`async_func_öô
(
˘x
, &
s
->
func_°©e
, 
func_obj
, 
this_obj
, 
¨gc
, 
¨gv
)) {

18775 
s
->
°©e
 = 
JS_GENERATOR_STATE_COMPLETED
;

18776 
Áû
;

18780 
func_ªt
 = 
	`async_func_ªsume
(
˘x
, &
s
->
func_°©e
);

18781 i‡(
	`JS_IsEx˚±i⁄
(
func_ªt
))

18782 
Áû
;

18783 
	`JS_FªeVÆue
(
˘x
, 
func_ªt
);

18785 
obj
 = 
	`js_¸óã_‰om_˘‹
(
˘x
, 
func_obj
, 
JS_CLASS_GENERATOR
);

18786 i‡(
	`JS_IsEx˚±i⁄
(
obj
))

18787 
Áû
;

18788 
	`JS_SëO∑que
(
obj
, 
s
);

18789  
obj
;

18790 
Áû
:

18791 
	`‰ì_gíî©‹_°ack_π
(
˘x
->
π
, 
s
);

18792 
	`js_‰ì
(
˘x
, 
s
);

18793  
JS_EXCEPTION
;

18794 
	}
}

18798 
	$js_async_fun˘i⁄_ãrmö©e
(
JSRu¡ime
 *
π
, 
JSAsyncFun˘i⁄D©a
 *
s
)

18800 i‡(
s
->
is_a˘ive
) {

18801 
	`async_func_‰ì
(
π
, &
s
->
func_°©e
);

18802 
s
->
is_a˘ive
 = 
FALSE
;

18804 
	}
}

18806 
	$js_async_fun˘i⁄_‰ì0
(
JSRu¡ime
 *
π
, 
JSAsyncFun˘i⁄D©a
 *
s
)

18808 
	`js_async_fun˘i⁄_ãrmö©e
(
π
, 
s
);

18809 
	`JS_FªeVÆueRT
(
π
, 
s
->
ªsﬁvög_funcs
[0]);

18810 
	`JS_FªeVÆueRT
(
π
, 
s
->
ªsﬁvög_funcs
[1]);

18811 
	`ªmove_gc_obje˘
(&
s
->
hódî
);

18812 
	`js_‰ì_π
(
π
, 
s
);

18813 
	}
}

18815 
	$js_async_fun˘i⁄_‰ì
(
JSRu¡ime
 *
π
, 
JSAsyncFun˘i⁄D©a
 *
s
)

18817 i‡(--
s
->
hódî
.
ªf_cou¡
 == 0) {

18818 
	`js_async_fun˘i⁄_‰ì0
(
π
, 
s
);

18820 
	}
}

18822 
	$js_async_fun˘i⁄_ªsﬁve_föÆizî
(
JSRu¡ime
 *
π
, 
JSVÆue
 
vÆ
)

18824 
JSObje˘
 *
p
 = 
	`JS_VALUE_GET_OBJ
(
vÆ
);

18825 
JSAsyncFun˘i⁄D©a
 *
s
 = 
p
->
u
.
async_fun˘i⁄_d©a
;

18826 i‡(
s
) {

18827 
	`js_async_fun˘i⁄_‰ì
(
π
, 
s
);

18829 
	}
}

18831 
	$js_async_fun˘i⁄_ªsﬁve_m¨k
(
JSRu¡ime
 *
π
, 
JSVÆueC⁄°
 
vÆ
,

18832 
JS_M¨kFunc
 *
m¨k_func
)

18834 
JSObje˘
 *
p
 = 
	`JS_VALUE_GET_OBJ
(
vÆ
);

18835 
JSAsyncFun˘i⁄D©a
 *
s
 = 
p
->
u
.
async_fun˘i⁄_d©a
;

18836 i‡(
s
) {

18837 
	`m¨k_func
(
π
, &
s
->
hódî
);

18839 
	}
}

18841 
	$js_async_fun˘i⁄_ªsﬁve_¸óã
(
JSC⁄ãxt
 *
˘x
,

18842 
JSAsyncFun˘i⁄D©a
 *
s
,

18843 
JSVÆue
 *
ªsﬁvög_funcs
)

18845 
i
;

18846 
JSObje˘
 *
p
;

18848 
i
 = 0; i < 2; i++) {

18849 
ªsﬁvög_funcs
[
i
] =

18850 
	`JS_NewObje˘PrŸoCœss
(
˘x
, ctx->
fun˘i⁄_¥Ÿo
,

18851 
JS_CLASS_ASYNC_FUNCTION_RESOLVE
 + 
i
);

18852 i‡(
	`JS_IsEx˚±i⁄
(
ªsﬁvög_funcs
[
i
])) {

18853 i‡(
i
 == 1)

18854 
	`JS_FªeVÆue
(
˘x
, 
ªsﬁvög_funcs
[0]);

18857 
p
 = 
	`JS_VALUE_GET_OBJ
(
ªsﬁvög_funcs
[
i
]);

18858 
s
->
hódî
.
ªf_cou¡
++;

18859 
p
->
u
.
async_fun˘i⁄_d©a
 = 
s
;

18862 
	}
}

18864 
	$js_async_fun˘i⁄_ªsume
(
JSC⁄ãxt
 *
˘x
, 
JSAsyncFun˘i⁄D©a
 *
s
)

18866 
JSVÆue
 
func_ªt
, 
ªt2
;

18868 
func_ªt
 = 
	`async_func_ªsume
(
˘x
, &
s
->
func_°©e
);

18869 i‡(
	`JS_IsEx˚±i⁄
(
func_ªt
)) {

18870 
JSVÆue
 
îr‹
;

18871 
Áû
:

18872 
îr‹
 = 
	`JS_GëEx˚±i⁄
(
˘x
);

18873 
ªt2
 = 
	`JS_CÆl
(
˘x
, 
s
->
ªsﬁvög_funcs
[1], 
JS_UNDEFINED
,

18874 1, (
JSVÆueC⁄°
 *)&
îr‹
);

18875 
	`JS_FªeVÆue
(
˘x
, 
îr‹
);

18876 
	`js_async_fun˘i⁄_ãrmö©e
(
˘x
->
π
, 
s
);

18877 
	`JS_FªeVÆue
(
˘x
, 
ªt2
);

18879 
JSVÆue
 
vÆue
;

18880 
vÆue
 = 
s
->
func_°©e
.
‰ame
.
cur_•
[-1];

18881 
s
->
func_°©e
.
‰ame
.
cur_•
[-1] = 
JS_UNDEFINED
;

18882 i‡(
	`JS_IsUndeföed
(
func_ªt
)) {

18884 
ªt2
 = 
	`JS_CÆl
(
˘x
, 
s
->
ªsﬁvög_funcs
[0], 
JS_UNDEFINED
,

18885 1, (
JSVÆueC⁄°
 *)&
vÆue
);

18886 
	`JS_FªeVÆue
(
˘x
, 
ªt2
);

18887 
	`JS_FªeVÆue
(
˘x
, 
vÆue
);

18888 
	`js_async_fun˘i⁄_ãrmö©e
(
˘x
->
π
, 
s
);

18890 
JSVÆue
 
¥omi£
, 
ªsﬁvög_funcs
[2], 
ªsﬁvög_funcs1
[2];

18891 
i
, 
ªs
;

18894 
	`JS_FªeVÆue
(
˘x
, 
func_ªt
);

18895 
¥omi£
 = 
	`js_¥omi£_ªsﬁve
(
˘x
, ctx->
¥omi£_˘‹
,

18896 1, (
JSVÆueC⁄°
 *)&
vÆue
, 0);

18897 
	`JS_FªeVÆue
(
˘x
, 
vÆue
);

18898 i‡(
	`JS_IsEx˚±i⁄
(
¥omi£
))

18899 
Áû
;

18900 i‡(
	`js_async_fun˘i⁄_ªsﬁve_¸óã
(
˘x
, 
s
, 
ªsﬁvög_funcs
)) {

18901 
	`JS_FªeVÆue
(
˘x
, 
¥omi£
);

18902 
Áû
;

18907 
i
 = 0; i < 2; i++)

18908 
ªsﬁvög_funcs1
[
i
] = 
JS_UNDEFINED
;

18909 
ªs
 = 
	`≥rf‹m_¥omi£_thí
(
˘x
, 
¥omi£
,

18910 (
JSVÆueC⁄°
 *)
ªsﬁvög_funcs
,

18911 (
JSVÆueC⁄°
 *)
ªsﬁvög_funcs1
);

18912 
	`JS_FªeVÆue
(
˘x
, 
¥omi£
);

18913 
i
 = 0; i < 2; i++)

18914 
	`JS_FªeVÆue
(
˘x
, 
ªsﬁvög_funcs
[
i
]);

18915 i‡(
ªs
)

18916 
Áû
;

18919 
	}
}

18921 
JSVÆue
 
	$js_async_fun˘i⁄_ªsﬁve_ˇŒ
(
JSC⁄ãxt
 *
˘x
,

18922 
JSVÆueC⁄°
 
func_obj
,

18923 
JSVÆueC⁄°
 
this_obj
,

18924 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
,

18925 
Êags
)

18927 
JSObje˘
 *
p
 = 
	`JS_VALUE_GET_OBJ
(
func_obj
);

18928 
JSAsyncFun˘i⁄D©a
 *
s
 = 
p
->
u
.
async_fun˘i⁄_d©a
;

18929 
BOOL
 
is_ªje˘
 = 
p
->
˛ass_id
 - 
JS_CLASS_ASYNC_FUNCTION_RESOLVE
;

18930 
JSVÆueC⁄°
 
¨g
;

18932 i‡(
¨gc
 > 0)

18933 
¨g
 = 
¨gv
[0];

18935 
¨g
 = 
JS_UNDEFINED
;

18936 
s
->
func_°©e
.
throw_Êag
 = 
is_ªje˘
;

18937 i‡(
is_ªje˘
) {

18938 
	`JS_Throw
(
˘x
, 
	`JS_DupVÆue
(˘x, 
¨g
));

18941 
s
->
func_°©e
.
‰ame
.
cur_•
[-1] = 
	`JS_DupVÆue
(
˘x
, 
¨g
);

18943 
	`js_async_fun˘i⁄_ªsume
(
˘x
, 
s
);

18944  
JS_UNDEFINED
;

18945 
	}
}

18947 
JSVÆue
 
	$js_async_fun˘i⁄_ˇŒ
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
func_obj
,

18948 
JSVÆueC⁄°
 
this_obj
,

18949 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
, 
Êags
)

18951 
JSVÆue
 
¥omi£
;

18952 
JSAsyncFun˘i⁄D©a
 *
s
;

18954 
s
 = 
	`js_mÆlocz
(
˘x
, (*s));

18955 i‡(!
s
)

18956  
JS_EXCEPTION
;

18957 
s
->
hódî
.
ªf_cou¡
 = 1;

18958 
	`add_gc_obje˘
(
˘x
->
π
, &
s
->
hódî
, 
JS_GC_OBJ_TYPE_ASYNC_FUNCTION
);

18959 
s
->
is_a˘ive
 = 
FALSE
;

18960 
s
->
ªsﬁvög_funcs
[0] = 
JS_UNDEFINED
;

18961 
s
->
ªsﬁvög_funcs
[1] = 
JS_UNDEFINED
;

18963 
¥omi£
 = 
	`JS_NewPromi£C≠abûôy
(
˘x
, 
s
->
ªsﬁvög_funcs
);

18964 i‡(
	`JS_IsEx˚±i⁄
(
¥omi£
))

18965 
Áû
;

18967 i‡(
	`async_func_öô
(
˘x
, &
s
->
func_°©e
, 
func_obj
, 
this_obj
, 
¨gc
, 
¨gv
)) {

18968 
Áû
:

18969 
	`JS_FªeVÆue
(
˘x
, 
¥omi£
);

18970 
	`js_async_fun˘i⁄_‰ì
(
˘x
->
π
, 
s
);

18971  
JS_EXCEPTION
;

18973 
s
->
is_a˘ive
 = 
TRUE
;

18975 
	`js_async_fun˘i⁄_ªsume
(
˘x
, 
s
);

18977 
	`js_async_fun˘i⁄_‰ì
(
˘x
->
π
, 
s
);

18979  
¥omi£
;

18980 
	}
}

18984 
	eJSAsyncGíî©‹SèãEnum
 {

18985 
	mJS_ASYNC_GENERATOR_STATE_SUSPENDED_START
,

18986 
	mJS_ASYNC_GENERATOR_STATE_SUSPENDED_YIELD
,

18987 
	mJS_ASYNC_GENERATOR_STATE_SUSPENDED_YIELD_STAR
,

18988 
	mJS_ASYNC_GENERATOR_STATE_EXECUTING
,

18989 
	mJS_ASYNC_GENERATOR_STATE_AWAITING_RETURN
,

18990 
	mJS_ASYNC_GENERATOR_STATE_COMPLETED
,

18991 } 
	tJSAsyncGíî©‹SèãEnum
;

18993 
	sJSAsyncGíî©‹Reque°
 {

18994 
li°_hód
 
	mlök
;

18996 
	mcom∂ëi⁄_ty≥
;

18997 
JSVÆue
 
	mªsu…
;

18999 
JSVÆue
 
	m¥omi£
;

19000 
JSVÆue
 
	mªsﬁvög_funcs
[2];

19001 } 
	tJSAsyncGíî©‹Reque°
;

19003 
	sJSAsyncGíî©‹D©a
 {

19004 
JSObje˘
 *
	mgíî©‹
;

19005 
JSAsyncGíî©‹SèãEnum
 
	m°©e
;

19006 
JSAsyncFun˘i⁄Sèã
 
	mfunc_°©e
;

19007 
li°_hód
 
	mqueue
;

19008 } 
	tJSAsyncGíî©‹D©a
;

19010 
	$js_async_gíî©‹_‰ì
(
JSRu¡ime
 *
π
,

19011 
JSAsyncGíî©‹D©a
 *
s
)

19013 
li°_hód
 *
ñ
, *
ñ1
;

19014 
JSAsyncGíî©‹Reque°
 *
ªq
;

19016 
	`li°_f‹_óch_ß„
(
ñ
, 
ñ1
, &
s
->
queue
) {

19017 
ªq
 = 
	`li°_íåy
(
ñ
, 
JSAsyncGíî©‹Reque°
, 
lök
);

19018 
	`JS_FªeVÆueRT
(
π
, 
ªq
->
ªsu…
);

19019 
	`JS_FªeVÆueRT
(
π
, 
ªq
->
¥omi£
);

19020 
	`JS_FªeVÆueRT
(
π
, 
ªq
->
ªsﬁvög_funcs
[0]);

19021 
	`JS_FªeVÆueRT
(
π
, 
ªq
->
ªsﬁvög_funcs
[1]);

19022 
	`js_‰ì_π
(
π
, 
ªq
);

19024 i‡(
s
->
°©e
 !
JS_ASYNC_GENERATOR_STATE_COMPLETED
 &&

19025 
s
->
°©e
 !
JS_ASYNC_GENERATOR_STATE_AWAITING_RETURN
) {

19026 
	`async_func_‰ì
(
π
, &
s
->
func_°©e
);

19028 
	`js_‰ì_π
(
π
, 
s
);

19029 
	}
}

19031 
	$js_async_gíî©‹_föÆizî
(
JSRu¡ime
 *
π
, 
JSVÆue
 
obj
)

19033 
JSAsyncGíî©‹D©a
 *
s
 = 
	`JS_GëO∑que
(
obj
, 
JS_CLASS_ASYNC_GENERATOR
);

19035 i‡(
s
) {

19036 
	`js_async_gíî©‹_‰ì
(
π
, 
s
);

19038 
	}
}

19040 
	$js_async_gíî©‹_m¨k
(
JSRu¡ime
 *
π
, 
JSVÆueC⁄°
 
vÆ
,

19041 
JS_M¨kFunc
 *
m¨k_func
)

19043 
JSAsyncGíî©‹D©a
 *
s
 = 
	`JS_GëO∑que
(
vÆ
, 
JS_CLASS_ASYNC_GENERATOR
);

19044 
li°_hód
 *
ñ
;

19045 
JSAsyncGíî©‹Reque°
 *
ªq
;

19046 i‡(
s
) {

19047 
	`li°_f‹_óch
(
ñ
, &
s
->
queue
) {

19048 
ªq
 = 
	`li°_íåy
(
ñ
, 
JSAsyncGíî©‹Reque°
, 
lök
);

19049 
	`JS_M¨kVÆue
(
π
, 
ªq
->
ªsu…
, 
m¨k_func
);

19050 
	`JS_M¨kVÆue
(
π
, 
ªq
->
¥omi£
, 
m¨k_func
);

19051 
	`JS_M¨kVÆue
(
π
, 
ªq
->
ªsﬁvög_funcs
[0], 
m¨k_func
);

19052 
	`JS_M¨kVÆue
(
π
, 
ªq
->
ªsﬁvög_funcs
[1], 
m¨k_func
);

19054 i‡(
s
->
°©e
 !
JS_ASYNC_GENERATOR_STATE_COMPLETED
 &&

19055 
s
->
°©e
 !
JS_ASYNC_GENERATOR_STATE_AWAITING_RETURN
) {

19056 
	`async_func_m¨k
(
π
, &
s
->
func_°©e
, 
m¨k_func
);

19059 
	}
}

19061 
JSVÆue
 
js_async_gíî©‹_ªsﬁve_fun˘i⁄
(
JSC⁄ãxt
 *
˘x
,

19062 
JSVÆueC⁄°
 
this_obj
,

19063 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
,

19064 
magic
, 
JSVÆue
 *
func_d©a
);

19066 
	$js_async_gíî©‹_ªsﬁve_fun˘i⁄_¸óã
(
JSC⁄ãxt
 *
˘x
,

19067 
JSVÆueC⁄°
 
gíî©‹
,

19068 
JSVÆue
 *
ªsﬁvög_funcs
,

19069 
BOOL
 
is_ªsume_√xt
)

19071 
i
;

19072 
JSVÆue
 
func
;

19074 
i
 = 0; i < 2; i++) {

19075 
func
 = 
	`JS_NewCFun˘i⁄D©a
(
˘x
, 
js_async_gíî©‹_ªsﬁve_fun˘i⁄
, 1,

19076 
i
 + 
is_ªsume_√xt
 * 2, 1, &
gíî©‹
);

19077 i‡(
	`JS_IsEx˚±i⁄
(
func
)) {

19078 i‡(
i
 == 1)

19079 
	`JS_FªeVÆue
(
˘x
, 
ªsﬁvög_funcs
[0]);

19082 
ªsﬁvög_funcs
[
i
] = 
func
;

19085 
	}
}

19087 
	$js_async_gíî©‹_awaô
(
JSC⁄ãxt
 *
˘x
,

19088 
JSAsyncGíî©‹D©a
 *
s
,

19089 
JSVÆueC⁄°
 
vÆue
)

19091 
JSVÆue
 
¥omi£
, 
ªsﬁvög_funcs
[2], 
ªsﬁvög_funcs1
[2];

19092 
i
, 
ªs
;

19094 
¥omi£
 = 
	`js_¥omi£_ªsﬁve
(
˘x
, ctx->
¥omi£_˘‹
,

19095 1, &
vÆue
, 0);

19096 i‡(
	`JS_IsEx˚±i⁄
(
¥omi£
))

19097 
Áû
;

19099 i‡(
	`js_async_gíî©‹_ªsﬁve_fun˘i⁄_¸óã
(
˘x
, 
	`JS_MKPTR
(
JS_TAG_OBJECT
, 
s
->
gíî©‹
),

19100 
ªsﬁvög_funcs
, 
FALSE
)) {

19101 
	`JS_FªeVÆue
(
˘x
, 
¥omi£
);

19102 
Áû
;

19107 
i
 = 0; i < 2; i++)

19108 
ªsﬁvög_funcs1
[
i
] = 
JS_UNDEFINED
;

19109 
ªs
 = 
	`≥rf‹m_¥omi£_thí
(
˘x
, 
¥omi£
,

19110 (
JSVÆueC⁄°
 *)
ªsﬁvög_funcs
,

19111 (
JSVÆueC⁄°
 *)
ªsﬁvög_funcs1
);

19112 
	`JS_FªeVÆue
(
˘x
, 
¥omi£
);

19113 
i
 = 0; i < 2; i++)

19114 
	`JS_FªeVÆue
(
˘x
, 
ªsﬁvög_funcs
[
i
]);

19115 i‡(
ªs
)

19116 
Áû
;

19118 
Áû
:

19120 
	}
}

19122 
	$js_async_gíî©‹_ªsﬁve_‹_ªje˘
(
JSC⁄ãxt
 *
˘x
,

19123 
JSAsyncGíî©‹D©a
 *
s
,

19124 
JSVÆueC⁄°
 
ªsu…
,

19125 
is_ªje˘
)

19127 
JSAsyncGíî©‹Reque°
 *
√xt
;

19128 
JSVÆue
 
ªt
;

19130 
√xt
 = 
	`li°_íåy
(
s
->
queue
.√xt, 
JSAsyncGíî©‹Reque°
, 
lök
);

19131 
	`li°_dñ
(&
√xt
->
lök
);

19132 
ªt
 = 
	`JS_CÆl
(
˘x
, 
√xt
->
ªsﬁvög_funcs
[
is_ªje˘
], 
JS_UNDEFINED
, 1,

19133 &
ªsu…
);

19134 
	`JS_FªeVÆue
(
˘x
, 
ªt
);

19135 
	`JS_FªeVÆue
(
˘x
, 
√xt
->
ªsu…
);

19136 
	`JS_FªeVÆue
(
˘x
, 
√xt
->
¥omi£
);

19137 
	`JS_FªeVÆue
(
˘x
, 
√xt
->
ªsﬁvög_funcs
[0]);

19138 
	`JS_FªeVÆue
(
˘x
, 
√xt
->
ªsﬁvög_funcs
[1]);

19139 
	`js_‰ì
(
˘x
, 
√xt
);

19140 
	}
}

19142 
	$js_async_gíî©‹_ªsﬁve
(
JSC⁄ãxt
 *
˘x
,

19143 
JSAsyncGíî©‹D©a
 *
s
,

19144 
JSVÆueC⁄°
 
vÆue
,

19145 
BOOL
 
d⁄e
)

19147 
JSVÆue
 
ªsu…
;

19148 
ªsu…
 = 
	`js_¸óã_ôî©‹_ªsu…
(
˘x
, 
	`JS_DupVÆue
(˘x, 
vÆue
), 
d⁄e
);

19150 
	`js_async_gíî©‹_ªsﬁve_‹_ªje˘
(
˘x
, 
s
, 
ªsu…
, 0);

19151 
	`JS_FªeVÆue
(
˘x
, 
ªsu…
);

19152 
	}
}

19154 
	$js_async_gíî©‹_ªje˘
(
JSC⁄ãxt
 *
˘x
,

19155 
JSAsyncGíî©‹D©a
 *
s
,

19156 
JSVÆueC⁄°
 
ex˚±i⁄
)

19158 
	`js_async_gíî©‹_ªsﬁve_‹_ªje˘
(
˘x
, 
s
, 
ex˚±i⁄
, 1);

19159 
	}
}

19161 
	$js_async_gíî©‹_com∂ëe
(
JSC⁄ãxt
 *
˘x
,

19162 
JSAsyncGíî©‹D©a
 *
s
)

19164 i‡(
s
->
°©e
 !
JS_ASYNC_GENERATOR_STATE_COMPLETED
) {

19165 
s
->
°©e
 = 
JS_ASYNC_GENERATOR_STATE_COMPLETED
;

19166 
	`async_func_‰ì
(
˘x
->
π
, &
s
->
func_°©e
);

19168 
	}
}

19170 
	$js_async_gíî©‹_com∂ëed_ªtu∫
(
JSC⁄ãxt
 *
˘x
,

19171 
JSAsyncGíî©‹D©a
 *
s
,

19172 
JSVÆueC⁄°
 
vÆue
)

19174 
JSVÆue
 
¥omi£
, 
ªsﬁvög_funcs
[2], 
ªsﬁvög_funcs1
[2];

19175 
ªs
;

19177 
¥omi£
 = 
	`js_¥omi£_ªsﬁve
(
˘x
, ctx->
¥omi£_˘‹
,

19178 1, (
JSVÆueC⁄°
 *)&
vÆue
, 0);

19179 i‡(
	`JS_IsEx˚±i⁄
(
¥omi£
))

19181 i‡(
	`js_async_gíî©‹_ªsﬁve_fun˘i⁄_¸óã
(
˘x
,

19182 
	`JS_MKPTR
(
JS_TAG_OBJECT
, 
s
->
gíî©‹
),

19183 
ªsﬁvög_funcs1
,

19184 
TRUE
)) {

19185 
	`JS_FªeVÆue
(
˘x
, 
¥omi£
);

19188 
ªsﬁvög_funcs
[0] = 
JS_UNDEFINED
;

19189 
ªsﬁvög_funcs
[1] = 
JS_UNDEFINED
;

19190 
ªs
 = 
	`≥rf‹m_¥omi£_thí
(
˘x
, 
¥omi£
,

19191 (
JSVÆueC⁄°
 *)
ªsﬁvög_funcs1
,

19192 (
JSVÆueC⁄°
 *)
ªsﬁvög_funcs
);

19193 
	`JS_FªeVÆue
(
˘x
, 
ªsﬁvög_funcs1
[0]);

19194 
	`JS_FªeVÆue
(
˘x
, 
ªsﬁvög_funcs1
[1]);

19195 
	`JS_FªeVÆue
(
˘x
, 
¥omi£
);

19196  
ªs
;

19197 
	}
}

19199 
	$js_async_gíî©‹_ªsume_√xt
(
JSC⁄ãxt
 *
˘x
,

19200 
JSAsyncGíî©‹D©a
 *
s
)

19202 
JSAsyncGíî©‹Reque°
 *
√xt
;

19203 
JSVÆue
 
func_ªt
, 
vÆue
;

19206 i‡(
	`li°_em±y
(&
s
->
queue
))

19208 
√xt
 = 
	`li°_íåy
(
s
->
queue
.√xt, 
JSAsyncGíî©‹Reque°
, 
lök
);

19209 
s
->
°©e
) {

19210 
JS_ASYNC_GENERATOR_STATE_EXECUTING
:

19212 
ªsume_exec
;

19213 
JS_ASYNC_GENERATOR_STATE_AWAITING_RETURN
:

19214 
d⁄e
;

19215 
JS_ASYNC_GENERATOR_STATE_SUSPENDED_START
:

19216 i‡(
√xt
->
com∂ëi⁄_ty≥
 =
GEN_MAGIC_NEXT
) {

19217 
exec_no_¨g
;

19219 
	`js_async_gíî©‹_com∂ëe
(
˘x
, 
s
);

19222 
JS_ASYNC_GENERATOR_STATE_COMPLETED
:

19223 i‡(
√xt
->
com∂ëi⁄_ty≥
 =
GEN_MAGIC_NEXT
) {

19224 
	`js_async_gíî©‹_ªsﬁve
(
˘x
, 
s
, 
JS_UNDEFINED
, 
TRUE
);

19225 } i‡(
√xt
->
com∂ëi⁄_ty≥
 =
GEN_MAGIC_RETURN
) {

19226 
s
->
°©e
 = 
JS_ASYNC_GENERATOR_STATE_AWAITING_RETURN
;

19227 
	`js_async_gíî©‹_com∂ëed_ªtu∫
(
˘x
, 
s
, 
√xt
->
ªsu…
);

19228 
d⁄e
;

19230 
	`js_async_gíî©‹_ªje˘
(
˘x
, 
s
, 
√xt
->
ªsu…
);

19232 
d⁄e
;

19233 
JS_ASYNC_GENERATOR_STATE_SUSPENDED_YIELD
:

19234 
JS_ASYNC_GENERATOR_STATE_SUSPENDED_YIELD_STAR
:

19235 
vÆue
 = 
	`JS_DupVÆue
(
˘x
, 
√xt
->
ªsu…
);

19236 i‡(
√xt
->
com∂ëi⁄_ty≥
 =
GEN_MAGIC_THROW
 &&

19237 
s
->
°©e
 =
JS_ASYNC_GENERATOR_STATE_SUSPENDED_YIELD
) {

19238 
	`JS_Throw
(
˘x
, 
vÆue
);

19239 
s
->
func_°©e
.
throw_Êag
 = 
TRUE
;

19243 
s
->
func_°©e
.
‰ame
.
cur_•
[-1] = 
vÆue
;

19244 
s
->
func_°©e
.
‰ame
.
cur_•
[0] =

19245 
	`JS_NewI¡32
(
˘x
, 
√xt
->
com∂ëi⁄_ty≥
);

19246 
s
->
func_°©e
.
‰ame
.
cur_•
++;

19247 
exec_no_¨g
:

19248 
s
->
func_°©e
.
throw_Êag
 = 
FALSE
;

19250 
s
->
°©e
 = 
JS_ASYNC_GENERATOR_STATE_EXECUTING
;

19251 
ªsume_exec
:

19252 
func_ªt
 = 
	`async_func_ªsume
(
˘x
, &
s
->
func_°©e
);

19253 i‡(
	`JS_IsEx˚±i⁄
(
func_ªt
)) {

19254 
vÆue
 = 
	`JS_GëEx˚±i⁄
(
˘x
);

19255 
	`js_async_gíî©‹_com∂ëe
(
˘x
, 
s
);

19256 
	`js_async_gíî©‹_ªje˘
(
˘x
, 
s
, 
vÆue
);

19257 
	`JS_FªeVÆue
(
˘x
, 
vÆue
);

19258 } i‡(
	`JS_VALUE_GET_TAG
(
func_ªt
Ë=
JS_TAG_INT
) {

19259 
func_ªt_code
;

19260 
vÆue
 = 
s
->
func_°©e
.
‰ame
.
cur_•
[-1];

19261 
s
->
func_°©e
.
‰ame
.
cur_•
[-1] = 
JS_UNDEFINED
;

19262 
func_ªt_code
 = 
	`JS_VALUE_GET_INT
(
func_ªt
);

19263 
func_ªt_code
) {

19264 
FUNC_RET_YIELD
:

19265 
FUNC_RET_YIELD_STAR
:

19266 i‡(
func_ªt_code
 =
FUNC_RET_YIELD_STAR
)

19267 
s
->
°©e
 = 
JS_ASYNC_GENERATOR_STATE_SUSPENDED_YIELD_STAR
;

19269 
s
->
°©e
 = 
JS_ASYNC_GENERATOR_STATE_SUSPENDED_YIELD
;

19270 
	`js_async_gíî©‹_ªsﬁve
(
˘x
, 
s
, 
vÆue
, 
FALSE
);

19271 
	`JS_FªeVÆue
(
˘x
, 
vÆue
);

19273 
FUNC_RET_AWAIT
:

19274 
	`js_async_gíî©‹_awaô
(
˘x
, 
s
, 
vÆue
);

19275 
	`JS_FªeVÆue
(
˘x
, 
vÆue
);

19276 
d⁄e
;

19278 
	`ab‹t
();

19281 
	`as£π
(
	`JS_IsUndeföed
(
func_ªt
));

19283 
vÆue
 = 
s
->
func_°©e
.
‰ame
.
cur_•
[-1];

19284 
s
->
func_°©e
.
‰ame
.
cur_•
[-1] = 
JS_UNDEFINED
;

19285 
	`js_async_gíî©‹_com∂ëe
(
˘x
, 
s
);

19286 
	`js_async_gíî©‹_ªsﬁve
(
˘x
, 
s
, 
vÆue
, 
TRUE
);

19287 
	`JS_FªeVÆue
(
˘x
, 
vÆue
);

19291 
	`ab‹t
();

19294 
d⁄e
: ;

19295 
	}
}

19297 
JSVÆue
 
	$js_async_gíî©‹_ªsﬁve_fun˘i⁄
(
JSC⁄ãxt
 *
˘x
,

19298 
JSVÆueC⁄°
 
this_obj
,

19299 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
,

19300 
magic
, 
JSVÆue
 *
func_d©a
)

19302 
BOOL
 
is_ªje˘
 = 
magic
 & 1;

19303 
JSAsyncGíî©‹D©a
 *
s
 = 
	`JS_GëO∑que
(
func_d©a
[0], 
JS_CLASS_ASYNC_GENERATOR
);

19304 
JSVÆueC⁄°
 
¨g
 = 
¨gv
[0];

19308 i‡(
magic
 >= 2) {

19310 
	`as£π
(
s
->
°©e
 =
JS_ASYNC_GENERATOR_STATE_AWAITING_RETURN
 ||

19311 
s
->
°©e
 =
JS_ASYNC_GENERATOR_STATE_COMPLETED
);

19312 
s
->
°©e
 = 
JS_ASYNC_GENERATOR_STATE_COMPLETED
;

19313 i‡(
is_ªje˘
) {

19314 
	`js_async_gíî©‹_ªje˘
(
˘x
, 
s
, 
¨g
);

19316 
	`js_async_gíî©‹_ªsﬁve
(
˘x
, 
s
, 
¨g
, 
TRUE
);

19320 
	`as£π
(
s
->
°©e
 =
JS_ASYNC_GENERATOR_STATE_EXECUTING
);

19321 
s
->
func_°©e
.
throw_Êag
 = 
is_ªje˘
;

19322 i‡(
is_ªje˘
) {

19323 
	`JS_Throw
(
˘x
, 
	`JS_DupVÆue
(˘x, 
¨g
));

19326 
s
->
func_°©e
.
‰ame
.
cur_•
[-1] = 
	`JS_DupVÆue
(
˘x
, 
¨g
);

19328 
	`js_async_gíî©‹_ªsume_√xt
(
˘x
, 
s
);

19330  
JS_UNDEFINED
;

19331 
	}
}

19334 
JSVÆue
 
	$js_async_gíî©‹_√xt
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

19335 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
,

19336 
magic
)

19338 
JSAsyncGíî©‹D©a
 *
s
 = 
	`JS_GëO∑que
(
this_vÆ
, 
JS_CLASS_ASYNC_GENERATOR
);

19339 
JSVÆue
 
¥omi£
, 
ªsﬁvög_funcs
[2];

19340 
JSAsyncGíî©‹Reque°
 *
ªq
;

19342 
¥omi£
 = 
	`JS_NewPromi£C≠abûôy
(
˘x
, 
ªsﬁvög_funcs
);

19343 i‡(
	`JS_IsEx˚±i⁄
(
¥omi£
))

19344  
JS_EXCEPTION
;

19345 i‡(!
s
) {

19346 
JSVÆue
 
îr
, 
ªs2
;

19347 
	`JS_ThrowTy≥Eº‹
(
˘x
, "notán AsyncGenerator object");

19348 
îr
 = 
	`JS_GëEx˚±i⁄
(
˘x
);

19349 
ªs2
 = 
	`JS_CÆl
(
˘x
, 
ªsﬁvög_funcs
[1], 
JS_UNDEFINED
,

19350 1, (
JSVÆueC⁄°
 *)&
îr
);

19351 
	`JS_FªeVÆue
(
˘x
, 
îr
);

19352 
	`JS_FªeVÆue
(
˘x
, 
ªs2
);

19353 
	`JS_FªeVÆue
(
˘x
, 
ªsﬁvög_funcs
[0]);

19354 
	`JS_FªeVÆue
(
˘x
, 
ªsﬁvög_funcs
[1]);

19355  
¥omi£
;

19357 
ªq
 = 
	`js_mÆlocz
(
˘x
, (*req));

19358 i‡(!
ªq
)

19359 
Áû
;

19360 
ªq
->
com∂ëi⁄_ty≥
 = 
magic
;

19361 
ªq
->
ªsu…
 = 
	`JS_DupVÆue
(
˘x
, 
¨gv
[0]);

19362 
ªq
->
¥omi£
 = 
	`JS_DupVÆue
(
˘x
,Öromise);

19363 
ªq
->
ªsﬁvög_funcs
[0] =Ñesolving_funcs[0];

19364 
ªq
->
ªsﬁvög_funcs
[1] =Ñesolving_funcs[1];

19365 
	`li°_add_èû
(&
ªq
->
lök
, &
s
->
queue
);

19366 i‡(
s
->
°©e
 !
JS_ASYNC_GENERATOR_STATE_EXECUTING
) {

19367 
	`js_async_gíî©‹_ªsume_√xt
(
˘x
, 
s
);

19369  
¥omi£
;

19370 
Áû
:

19371 
	`JS_FªeVÆue
(
˘x
, 
ªsﬁvög_funcs
[0]);

19372 
	`JS_FªeVÆue
(
˘x
, 
ªsﬁvög_funcs
[1]);

19373 
	`JS_FªeVÆue
(
˘x
, 
¥omi£
);

19374  
JS_EXCEPTION
;

19375 
	}
}

19377 
JSVÆue
 
	$js_async_gíî©‹_fun˘i⁄_ˇŒ
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
func_obj
,

19378 
JSVÆueC⁄°
 
this_obj
,

19379 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
,

19380 
Êags
)

19382 
JSVÆue
 
obj
, 
func_ªt
;

19383 
JSAsyncGíî©‹D©a
 *
s
;

19385 
s
 = 
	`js_mÆlocz
(
˘x
, (*s));

19386 i‡(!
s
)

19387  
JS_EXCEPTION
;

19388 
s
->
°©e
 = 
JS_ASYNC_GENERATOR_STATE_SUSPENDED_START
;

19389 
	`öô_li°_hód
(&
s
->
queue
);

19390 i‡(
	`async_func_öô
(
˘x
, &
s
->
func_°©e
, 
func_obj
, 
this_obj
, 
¨gc
, 
¨gv
)) {

19391 
s
->
°©e
 = 
JS_ASYNC_GENERATOR_STATE_COMPLETED
;

19392 
Áû
;

19397 
func_ªt
 = 
	`async_func_ªsume
(
˘x
, &
s
->
func_°©e
);

19398 i‡(
	`JS_IsEx˚±i⁄
(
func_ªt
))

19399 
Áû
;

19400 
	`JS_FªeVÆue
(
˘x
, 
func_ªt
);

19402 
obj
 = 
	`js_¸óã_‰om_˘‹
(
˘x
, 
func_obj
, 
JS_CLASS_ASYNC_GENERATOR
);

19403 i‡(
	`JS_IsEx˚±i⁄
(
obj
))

19404 
Áû
;

19405 
s
->
gíî©‹
 = 
	`JS_VALUE_GET_OBJ
(
obj
);

19406 
	`JS_SëO∑que
(
obj
, 
s
);

19407  
obj
;

19408 
Áû
:

19409 
	`js_async_gíî©‹_‰ì
(
˘x
->
π
, 
s
);

19410  
JS_EXCEPTION
;

19411 
	}
}

19416 
	mTOK_NUMBER
 = -128,

19417 
	mTOK_STRING
,

19418 
	mTOK_TEMPLATE
,

19419 
	mTOK_IDENT
,

19420 
	mTOK_REGEXP
,

19422 
	mTOK_MUL_ASSIGN
,

19423 
	mTOK_DIV_ASSIGN
,

19424 
	mTOK_MOD_ASSIGN
,

19425 
	mTOK_PLUS_ASSIGN
,

19426 
	mTOK_MINUS_ASSIGN
,

19427 
	mTOK_SHL_ASSIGN
,

19428 
	mTOK_SAR_ASSIGN
,

19429 
	mTOK_SHR_ASSIGN
,

19430 
	mTOK_AND_ASSIGN
,

19431 
	mTOK_XOR_ASSIGN
,

19432 
	mTOK_OR_ASSIGN
,

19433 #ifde‡
CONFIG_BIGNUM


19434 
	mTOK_MATH_POW_ASSIGN
,

19436 
	mTOK_POW_ASSIGN
,

19437 
	mTOK_DEC
,

19438 
	mTOK_INC
,

19439 
	mTOK_SHL
,

19440 
	mTOK_SAR
,

19441 
	mTOK_SHR
,

19442 
	mTOK_LT
,

19443 
	mTOK_LTE
,

19444 
	mTOK_GT
,

19445 
	mTOK_GTE
,

19446 
	mTOK_EQ
,

19447 
	mTOK_STRICT_EQ
,

19448 
	mTOK_NEQ
,

19449 
	mTOK_STRICT_NEQ
,

19450 
	mTOK_LAND
,

19451 
	mTOK_LOR
,

19452 #ifde‡
CONFIG_BIGNUM


19453 
	mTOK_MATH_POW
,

19455 
	mTOK_POW
,

19456 
	mTOK_ARROW
,

19457 
	mTOK_ELLIPSIS
,

19458 
	mTOK_DOUBLE_QUESTION_MARK
,

19459 
	mTOK_QUESTION_MARK_DOT
,

19460 
	mTOK_ERROR
,

19461 
	mTOK_PRIVATE_NAME
,

19462 
	mTOK_EOF
,

19464 
	mTOK_NULL
,

19465 
	mTOK_FALSE
,

19466 
	mTOK_TRUE
,

19467 
	mTOK_IF
,

19468 
	mTOK_ELSE
,

19469 
	mTOK_RETURN
,

19470 
	mTOK_VAR
,

19471 
	mTOK_THIS
,

19472 
	mTOK_DELETE
,

19473 
	mTOK_VOID
,

19474 
	mTOK_TYPEOF
,

19475 
	mTOK_NEW
,

19476 
	mTOK_IN
,

19477 
	mTOK_INSTANCEOF
,

19478 
	mTOK_DO
,

19479 
	mTOK_WHILE
,

19480 
	mTOK_FOR
,

19481 
	mTOK_BREAK
,

19482 
	mTOK_CONTINUE
,

19483 
	mTOK_SWITCH
,

19484 
	mTOK_CASE
,

19485 
	mTOK_DEFAULT
,

19486 
	mTOK_THROW
,

19487 
	mTOK_TRY
,

19488 
	mTOK_CATCH
,

19489 
	mTOK_FINALLY
,

19490 
	mTOK_FUNCTION
,

19491 
	mTOK_DEBUGGER
,

19492 
	mTOK_WITH
,

19494 
	mTOK_CLASS
,

19495 
	mTOK_CONST
,

19496 
	mTOK_ENUM
,

19497 
	mTOK_EXPORT
,

19498 
	mTOK_EXTENDS
,

19499 
	mTOK_IMPORT
,

19500 
	mTOK_SUPER
,

19502 
	mTOK_IMPLEMENTS
,

19503 
	mTOK_INTERFACE
,

19504 
	mTOK_LET
,

19505 
	mTOK_PACKAGE
,

19506 
	mTOK_PRIVATE
,

19507 
	mTOK_PROTECTED
,

19508 
	mTOK_PUBLIC
,

19509 
	mTOK_STATIC
,

19510 
	mTOK_YIELD
,

19511 
	mTOK_AWAIT
,

19512 
	mTOK_OF
,

19515 
	#TOK_FIRST_KEYWORD
 
TOK_NULL


	)

19516 
	#TOK_LAST_KEYWORD
 
TOK_AWAIT


	)

19519 
	#CP_NBSP
 0x00a0

	)

19520 
	#CP_BOM
 0x„ff

	)

19522 
	#CP_LS
 0x2028

	)

19523 
	#CP_PS
 0x2029

	)

19525 
	sBlockEnv
 {

19526 
BlockEnv
 *
	m¥ev
;

19527 
JSAtom
 
	mœbñ_«me
;

19528 
	mœbñ_bªak
;

19529 
	mœbñ_c⁄t
;

19530 
	mdr›_cou¡
;

19531 
	mœbñ_föÆly
;

19532 
	msc›e_Àvñ
;

19533 
	mhas_ôî©‹
;

19534 } 
	tBlockEnv
;

19536 
	sJSHoi°edDef
 {

19537 
	m˝oﬁ_idx
;

19538 
uöt8_t
 
	mf‹˚_öô
 : 1;

19539 
uöt8_t
 
	mis_Àxiˇl
 : 1;

19540 
uöt8_t
 
	mis_c⁄°
 : 1;

19541 
	mv¨_idx
;

19542 
	msc›e_Àvñ
;

19543 
JSAtom
 
	mv¨_«me
;

19544 } 
	tJSHoi°edDef
;

19546 
	sRñocE¡ry
 {

19547 
RñocE¡ry
 *
	m√xt
;

19548 
uöt32_t
 
	maddr
;

19549 
	msize
;

19550 } 
	tRñocE¡ry
;

19552 
	sJumpSlŸ
 {

19553 
	m›
;

19554 
	msize
;

19555 
	mpos
;

19556 
	mœbñ
;

19557 } 
	tJumpSlŸ
;

19559 
	sLabñSlŸ
 {

19560 
	mªf_cou¡
;

19561 
	mpos
;

19562 
	mpos2
;

19563 
	maddr
;

19564 
RñocE¡ry
 *
	mfú°_ªloc
;

19565 } 
	tLabñSlŸ
;

19567 
	sLöeNumbîSlŸ
 {

19568 
uöt32_t
 
	mpc
;

19569 
	mlöe_num
;

19570 } 
	tLöeNumbîSlŸ
;

19572 
	eJSP¨£Fun˘i⁄Enum
 {

19573 
	mJS_PARSE_FUNC_STATEMENT
,

19574 
	mJS_PARSE_FUNC_VAR
,

19575 
	mJS_PARSE_FUNC_EXPR
,

19576 
	mJS_PARSE_FUNC_ARROW
,

19577 
	mJS_PARSE_FUNC_GETTER
,

19578 
	mJS_PARSE_FUNC_SETTER
,

19579 
	mJS_PARSE_FUNC_METHOD
,

19580 
	mJS_PARSE_FUNC_CLASS_CONSTRUCTOR
,

19581 
	mJS_PARSE_FUNC_DERIVED_CLASS_CONSTRUCTOR
,

19582 } 
	tJSP¨£Fun˘i⁄Enum
;

19584 
	eJSP¨£Exp‹tEnum
 {

19585 
	mJS_PARSE_EXPORT_NONE
,

19586 
	mJS_PARSE_EXPORT_NAMED
,

19587 
	mJS_PARSE_EXPORT_DEFAULT
,

19588 } 
	tJSP¨£Exp‹tEnum
;

19590 
	sJSFun˘i⁄Def
 {

19591 
JSC⁄ãxt
 *
	m˘x
;

19592 
JSFun˘i⁄Def
 *
	m∑ª¡
;

19593 
	m∑ª¡_˝oﬁ_idx
;

19595 
	m∑ª¡_sc›e_Àvñ
;

19596 
li°_hód
 
	mchûd_li°
;

19597 
li°_hód
 
	mlök
;

19599 
BOOL
 
	mis_evÆ
;

19600 
	mevÆ_ty≥
;

19601 
BOOL
 
	mis_globÆ_v¨
;

19603 
BOOL
 
	mis_func_ex¥
;

19604 
BOOL
 
	mhas_home_obje˘
;

19605 
BOOL
 
	mhas_¥ŸŸy≥
;

19606 
BOOL
 
	mhas_sim∂e_∑ømëî_li°
;

19607 
BOOL
 
	mhas_u£_°ri˘
;

19608 
BOOL
 
	mhas_evÆ_ˇŒ
;

19609 
BOOL
 
	mhas_¨gumíts_bödög
;

19611 
BOOL
 
	mhas_this_bödög
;

19613 
BOOL
 
	m√w_èrgë_Ælowed
;

19615 
BOOL
 
	msu≥r_ˇŒ_Ælowed
;

19616 
BOOL
 
	msu≥r_Ælowed
;

19617 
BOOL
 
	m¨gumíts_Ælowed
;

19618 
BOOL
 
	mis_dîived_˛ass_c⁄°ru˘‹
;

19619 
BOOL
 
	mö_fun˘i⁄_body
;

19620 
BOOL
 
	mbackåa˚_b¨rõr
;

19621 
JSFun˘i⁄KödEnum
 
	mfunc_köd
 : 8;

19622 
JSP¨£Fun˘i⁄Enum
 
	mfunc_ty≥
 : 8;

19623 
uöt8_t
 
	mjs_mode
;

19624 
JSAtom
 
	mfunc_«me
;

19626 
JSV¨Def
 *
	mv¨s
;

19627 
	mv¨_size
;

19628 
	mv¨_cou¡
;

19629 
JSV¨Def
 *
	m¨gs
;

19630 
	m¨g_size
;

19631 
	m¨g_cou¡
;

19632 
	mdeföed_¨g_cou¡
;

19633 
	mv¨_obje˘_idx
;

19634 
	m¨gumíts_v¨_idx
;

19635 
	mfunc_v¨_idx
;

19637 
	mevÆ_ªt_idx
;

19638 
	mthis_v¨_idx
;

19639 
	m√w_èrgë_v¨_idx
;

19640 
	mthis_a˘ive_func_v¨_idx
;

19641 
	mhome_obje˘_v¨_idx
;

19642 
BOOL
 
	m√ed_home_obje˘
;

19644 
	msc›e_Àvñ
;

19645 
	msc›e_fú°
;

19646 
	msc›e_size
;

19647 
	msc›e_cou¡
;

19648 
JSV¨Sc›e
 *
	msc›es
;

19649 
JSV¨Sc›e
 
	mdef_sc›e_¨øy
[4];

19651 
	mhoi°ed_def_cou¡
;

19652 
	mhoi°ed_def_size
;

19653 
JSHoi°edDef
 *
	mhoi°ed_def
;

19655 
DynBuf
 
	mbyã_code
;

19656 
	mœ°_›code_pos
;

19657 
	mœ°_›code_löe_num
;

19658 
BOOL
 
	mu£_sh‹t_›codes
;

19660 
LabñSlŸ
 *
	mœbñ_¶Ÿs
;

19661 
	mœbñ_size
;

19662 
	mœbñ_cou¡
;

19663 
BlockEnv
 *
	mt›_bªak
;

19666 
JSVÆue
 *
	m˝oﬁ
;

19667 
uöt32_t
 
	m˝oﬁ_cou¡
;

19668 
uöt32_t
 
	m˝oﬁ_size
;

19671 
	m˛osuª_v¨_cou¡
;

19672 
	m˛osuª_v¨_size
;

19673 
JSClosuªV¨
 *
	m˛osuª_v¨
;

19675 
JumpSlŸ
 *
	mjump_¶Ÿs
;

19676 
	mjump_size
;

19677 
	mjump_cou¡
;

19679 
LöeNumbîSlŸ
 *
	mlöe_numbî_¶Ÿs
;

19680 
	mlöe_numbî_size
;

19681 
	mlöe_numbî_cou¡
;

19682 
	mlöe_numbî_œ°
;

19683 
	mlöe_numbî_œ°_pc
;

19686 
JSAtom
 
	mfûíame
;

19687 
	mlöe_num
;

19688 
DynBuf
 
	mpc2löe
;

19690 *
	msour˚
;

19691 
	msour˚_Àn
;

19693 
JSModuÀDef
 *
	mmoduÀ
;

19694 } 
	tJSFun˘i⁄Def
;

19696 
	sJSTokí
 {

19697 
	mvÆ
;

19698 
	mlöe_num
;

19699 c⁄° 
uöt8_t
 *
	m±r
;

19702 
JSVÆue
 
	m°r
;

19703 
	m£p
;

19704 } 
	m°r
;

19706 
JSVÆue
 
	mvÆ
;

19707 #ifde‡
CONFIG_BIGNUM


19708 
¶imb_t
 
	mexp⁄ít
;

19710 } 
	mnum
;

19712 
JSAtom
 
	m©om
;

19713 
BOOL
 
	mhas_esˇ≥
;

19714 
BOOL
 
	mis_ª£rved
;

19715 } 
	midít
;

19717 
JSVÆue
 
	mbody
;

19718 
JSVÆue
 
	mÊags
;

19719 } 
	mªgexp
;

19720 } 
	mu
;

19721 } 
	tJSTokí
;

19723 
	sJSP¨£Sèã
 {

19724 
JSC⁄ãxt
 *
	m˘x
;

19725 
	mœ°_löe_num
;

19726 
	mlöe_num
;

19727 c⁄° *
	mfûíame
;

19728 
JSTokí
 
	mtokí
;

19729 
BOOL
 
	mgŸ_lf
;

19730 c⁄° 
uöt8_t
 *
	mœ°_±r
;

19731 c⁄° 
uöt8_t
 *
	mbuf_±r
;

19732 c⁄° 
uöt8_t
 *
	mbuf_íd
;

19735 
JSFun˘i⁄Def
 *
	mcur_func
;

19736 
BOOL
 
	mis_moduÀ
;

19737 
BOOL
 
	mÆlow_html_commíts
;

19738 } 
	tJSP¨£Sèã
;

19740 
	sJSOpCode
 {

19741 #ifde‡
DUMP_BYTECODE


19742 c⁄° *
	m«me
;

19744 
uöt8_t
 
	msize
;

19747 
uöt8_t
 
	mn_p›
;

19748 
uöt8_t
 
	mn_push
;

19749 
uöt8_t
 
	mfmt
;

19750 } 
	tJSOpCode
;

19752 c⁄° 
JSOpCode
 
	g›code_öfo
[
OP_COUNT
 + (
OP_TEMP_END
 - 
OP_TEMP_START
)] = {

19753 
	#FMT
(
f
)

	)

19754 #ifde‡
DUMP_BYTECODE


19755 
	#DEF
(
id
, 
size
, 
n_p›
, 
n_push
, 
f
Ë{ #id, size,Ç_p›,Ç_push, 
OP_FMT_
 ## f },

	)

19757 
	#DEF
(
id
, 
size
, 
n_p›
, 
n_push
, 
f
Ë{ size,Ç_p›,Ç_push, 
OP_FMT_
 ## f },

	)

19759 
	~<π/js/quickjs-›code.h
>

19760 #unde‡
DEF


19761 #unde‡
FMT


19764 #i‡
SHORT_OPCODES


19769 
	#sh‹t_›code_öfo
(
›
) \

19770 
›code_öfo
[(
›
Ë>
OP_TEMP_START
 ? \

19771 (
›
Ë+ (
OP_TEMP_END
 - 
OP_TEMP_START
Ë: (›)]

	)

19773 
	#sh‹t_›code_öfo
(
›
Ë
›code_öfo
[›]

	)

19776 
__ex˚±i⁄
 
√xt_tokí
(
JSP¨£Sèã
 *
s
);

19778 
	$‰ì_tokí
(
JSP¨£Sèã
 *
s
, 
JSTokí
 *
tokí
)

19780 
tokí
->
vÆ
) {

19781 #ifde‡
CONFIG_BIGNUM


19782 
TOK_NUMBER
:

19783 
	`JS_FªeVÆue
(
s
->
˘x
, 
tokí
->
u
.
num
.
vÆ
);

19786 
TOK_STRING
:

19787 
TOK_TEMPLATE
:

19788 
	`JS_FªeVÆue
(
s
->
˘x
, 
tokí
->
u
.
°r
.str);

19790 
TOK_REGEXP
:

19791 
	`JS_FªeVÆue
(
s
->
˘x
, 
tokí
->
u
.
ªgexp
.
body
);

19792 
	`JS_FªeVÆue
(
s
->
˘x
, 
tokí
->
u
.
ªgexp
.
Êags
);

19794 
TOK_IDENT
:

19795 
TOK_FIRST_KEYWORD
 ... 
TOK_LAST_KEYWORD
:

19796 
TOK_PRIVATE_NAME
:

19797 
	`JS_FªeAtom
(
s
->
˘x
, 
tokí
->
u
.
idít
.
©om
);

19802 
	}
}

19804 
__©åibuã
((
unu£d
)Ë
	$dump_tokí
(
JSP¨£Sèã
 *
s
,

19805 c⁄° 
JSTokí
 *
tokí
)

19807 
tokí
->
vÆ
) {

19808 
TOK_NUMBER
:

19810 
d
;

19811 
	`JS_ToFlﬂt64
(
s
->
˘x
, &
d
, 
tokí
->
u
.
num
.
vÆ
);

19812 
	`¥ötf
("numbî: %.14g\n", 
d
);

19815 
TOK_IDENT
:

19816 
dump_©om
:

19818 
buf
[
ATOM_GET_STR_BUF_SIZE
];

19819 
	`¥ötf
("ident: '%s'\n",

19820 
	`JS_AtomGëSå
(
s
->
˘x
, 
buf
, (buf), 
tokí
->
u
.
idít
.
©om
));

19823 
TOK_STRING
:

19825 c⁄° *
°r
;

19827 
°r
 = 
	`JS_ToCSåög
(
s
->
˘x
, 
tokí
->
u
.str.str);

19828 
	`¥ötf
("°rög: '%s'\n", 
°r
);

19829 
	`JS_FªeCSåög
(
s
->
˘x
, 
°r
);

19832 
TOK_TEMPLATE
:

19834 c⁄° *
°r
;

19835 
°r
 = 
	`JS_ToCSåög
(
s
->
˘x
, 
tokí
->
u
.str.str);

19836 
	`¥ötf
("ãm∂©e: `%s`\n", 
°r
);

19837 
	`JS_FªeCSåög
(
s
->
˘x
, 
°r
);

19840 
TOK_REGEXP
:

19842 c⁄° *
°r
, *
°r2
;

19843 
°r
 = 
	`JS_ToCSåög
(
s
->
˘x
, 
tokí
->
u
.
ªgexp
.
body
);

19844 
°r2
 = 
	`JS_ToCSåög
(
s
->
˘x
, 
tokí
->
u
.
ªgexp
.
Êags
);

19845 
	`¥ötf
("ªgexp: '%s' '%s'\n", 
°r
, 
°r2
);

19846 
	`JS_FªeCSåög
(
s
->
˘x
, 
°r
);

19847 
	`JS_FªeCSåög
(
s
->
˘x
, 
°r2
);

19850 
TOK_EOF
:

19851 
	`¥ötf
("eof\n");

19854 i‡(
s
->
tokí
.
vÆ
 >
TOK_NULL
 && s->tokí.vÆ <
TOK_LAST_KEYWORD
) {

19855 
dump_©om
;

19856 } i‡(
s
->
tokí
.
vÆ
 >= 256) {

19857 
	`¥ötf
("tokí: %d\n", 
tokí
->
vÆ
);

19859 
	`¥ötf
("tokí: '%c'\n", 
tokí
->
vÆ
);

19863 
	}
}

19865 
__©åibuã__
((
	$f‹m©
(
¥ötf
, 2, 3))Ë
	$js_∑r£_îr‹
(
JSP¨£Sèã
 *
s
, c⁄° *
fmt
, ...)

19867 
JSC⁄ãxt
 *
˘x
 = 
s
->ctx;

19868 
va_li°
 
≠
;

19869 
backåa˚_Êags
;

19871 
	`va_°¨t
(
≠
, 
fmt
);

19872 
	`JS_ThrowEº‹2
(
˘x
, 
JS_SYNTAX_ERROR
, 
fmt
, 
≠
, 
FALSE
);

19873 
	`va_íd
(
≠
);

19874 
backåa˚_Êags
 = 0;

19875 i‡(
s
->
cur_func
 && s->cur_func->
backåa˚_b¨rõr
)

19876 
backåa˚_Êags
 = 
JS_BACKTRACE_FLAG_SINGLE_LEVEL
;

19877 
	`buûd_backåa˚
(
˘x
, ctx->
π
->
cuºít_ex˚±i⁄
, 
s
->
fûíame
, s->
löe_num
,

19878 
backåa˚_Êags
);

19880 
	}
}

19882 
	$js_∑r£_ex≥˘
(
JSP¨£Sèã
 *
s
, 
tok
)

19884 i‡(
s
->
tokí
.
vÆ
 !
tok
) {

19886  
	`js_∑r£_îr‹
(
s
, "ex≥˘ög '%c'", 
tok
);

19888  
	`√xt_tokí
(
s
);

19889 
	}
}

19891 
	$js_∑r£_ex≥˘_£mi
(
JSP¨£Sèã
 *
s
)

19893 i‡(
s
->
tokí
.
vÆ
 != ';') {

19895 i‡(
s
->
tokí
.
vÆ
 =
TOK_EOF
 || s->tokí.vÆ ='}' || s->
gŸ_lf
) {

19898  
	`js_∑r£_îr‹
(
s
, "expecting '%c'", ';');

19900  
	`√xt_tokí
(
s
);

19901 
	}
}

19903 
	$js_∑r£_îr‹_ª£rved_idítifõr
(
JSP¨£Sèã
 *
s
)

19905 
buf1
[
ATOM_GET_STR_BUF_SIZE
];

19906  
	`js_∑r£_îr‹
(
s
, "'%s' isáÑeserved identifier",

19907 
	`JS_AtomGëSå
(
s
->
˘x
, 
buf1
, (buf1),

19908 
s
->
tokí
.
u
.
idít
.
©om
));

19909 
	}
}

19911 
__ex˚±i⁄
 
	$js_∑r£_ãm∂©e_∑π
(
JSP¨£Sèã
 *
s
, c⁄° 
uöt8_t
 *
p
)

19913 
uöt32_t
 
c
;

19914 
SåögBuf„r
 
b_s
, *
b
 = &b_s;

19917 i‡(
	`°rög_buf„r_öô
(
s
->
˘x
, 
b
, 32))

19918 
Áû
;

19920 i‡(
p
 >
s
->
buf_íd
)

19921 
u√x≥˘ed_eof
;

19922 
c
 = *
p
++;

19923 i‡(
c
 == '`') {

19927 i‡(
c
 ='$' && *
p
 == '{') {

19929 
p
++;

19932 i‡(
c
 == '\\') {

19933 i‡(
	`°rög_buf„r_putc8
(
b
, 
c
))

19934 
Áû
;

19935 i‡(
p
 >
s
->
buf_íd
)

19936 
u√x≥˘ed_eof
;

19937 
c
 = *
p
++;

19940 i‡(
c
 == '\r') {

19941 i‡(*
p
 == '\n')

19942 
p
++;

19943 
c
 = '\n';

19945 i‡(
c
 == '\n') {

19946 
s
->
löe_num
++;

19947 } i‡(
c
 >= 0x80) {

19948 c⁄° 
uöt8_t
 *
p_√xt
;

19949 
c
 = 
	`unicode_‰om_utf8
(
p
 - 1, 
UTF8_CHAR_LEN_MAX
, &
p_√xt
);

19950 i‡(
c
 > 0x10FFFF) {

19951 
	`js_∑r£_îr‹
(
s
, "invalid UTF-8 sequence");

19952 
Áû
;

19954 
p
 = 
p_√xt
;

19956 i‡(
	`°rög_buf„r_putc
(
b
, 
c
))

19957 
Áû
;

19959 
s
->
tokí
.
vÆ
 = 
TOK_TEMPLATE
;

19960 
s
->
tokí
.
u
.
°r
.
£p
 = 
c
;

19961 
s
->
tokí
.
u
.
°r
.°∏
	`°rög_buf„r_íd
(
b
);

19962 
s
->
buf_±r
 = 
p
;

19965 
u√x≥˘ed_eof
:

19966 
	`js_∑r£_îr‹
(
s
, "unexpectedÉnd of string");

19967 
Áû
:

19968 
	`°rög_buf„r_‰ì
(
b
);

19970 
	}
}

19972 
__ex˚±i⁄
 
	$js_∑r£_°rög
(
JSP¨£Sèã
 *
s
, 
£p
,

19973 
BOOL
 
do_throw
, c⁄° 
uöt8_t
 *
p
,

19974 
JSTokí
 *
tokí
, c⁄° 
uöt8_t
 **
µ
)

19976 
ªt
;

19977 
uöt32_t
 
c
;

19978 
SåögBuf„r
 
b_s
, *
b
 = &b_s;

19981 i‡(
	`°rög_buf„r_öô
(
s
->
˘x
, 
b
, 32))

19982 
Áû
;

19984 i‡(
p
 >
s
->
buf_íd
)

19985 
övÆid_ch¨
;

19986 
c
 = *
p
;

19987 i‡(
c
 < 0x20) {

19988 i‡(!
s
->
cur_func
) {

19989 i‡(
do_throw
)

19990 
	`js_∑r£_îr‹
(
s
, "invalid character iná JSON string");

19991 
Áû
;

19993 i‡(
£p
 == '`') {

19994 i‡(
c
 == '\r') {

19995 i‡(
p
[1] == '\n')

19996 
p
++;

19997 
c
 = '\n';

20000 } i‡(
c
 == '\n' || c == '\r')

20001 
övÆid_ch¨
;

20003 
p
++;

20004 i‡(
c
 =
£p
)

20006 i‡(
c
 ='$' && *
p
 ='{' && 
£p
 == '`') {

20008 
p
++;

20011 i‡(
c
 == '\\') {

20012 
c
 = *
p
;

20013 
c
) {

20015 i‡(
p
 >
s
->
buf_íd
)

20016 
övÆid_ch¨
;

20017 
p
++;

20022 
p
++;

20025 i‡(
p
[1] == '\n') {

20026 
p
++;

20031 
p
++;

20032 i‡(
£p
 != '`')

20033 
s
->
löe_num
++;

20036 i‡(
c
 >= '0' && c <= '7') {

20037 i‡(!
s
->
cur_func
)

20038 
övÆid_o˘Æ
;

20039 i‡(!(
s
->
cur_func
->
js_mode
 & 
JS_MODE_STRICT
Ë&& 
£p
 != '`')

20040 
∑r£_esˇ≥
;

20041 i‡(
c
 ='0' && !(
p
[1] >= '0' &&Ö[1] <= '9')) {

20042 
p
++;

20043 
c
 = '\0';

20045 
övÆid_o˘Æ
:

20046 i‡(
do_throw
)

20047 
	`js_∑r£_îr‹
(
s
, "invalid octal syntax in strict mode");

20048 
Áû
;

20050 } i‡(
c
 >= 0x80) {

20051 c⁄° 
uöt8_t
 *
p_√xt
;

20052 
c
 = 
	`unicode_‰om_utf8
(
p
, 
UTF8_CHAR_LEN_MAX
, &
p_√xt
);

20053 i‡(
c
 > 0x10FFFF) {

20054 
övÆid_utf8
;

20056 
p
 = 
p_√xt
;

20058 i‡(
c
 =
CP_LS
 || c =
CP_PS
)

20061 
∑r£_esˇ≥
:

20062 
ªt
 = 
	`Ãe_∑r£_esˇ≥
(&
p
, 
TRUE
);

20063 i‡(
ªt
 == -1) {

20064 i‡(
do_throw
)

20065 
	`js_∑r£_îr‹
(
s
, "malformedÉscape sequence in stringÜiteral");

20066 
Áû
;

20067 } i‡(
ªt
 < 0) {

20069 
p
++;

20071 
c
 = 
ªt
;

20076 } i‡(
c
 >= 0x80) {

20077 c⁄° 
uöt8_t
 *
p_√xt
;

20078 
c
 = 
	`unicode_‰om_utf8
(
p
 - 1, 
UTF8_CHAR_LEN_MAX
, &
p_√xt
);

20079 i‡(
c
 > 0x10FFFF)

20080 
övÆid_utf8
;

20081 
p
 = 
p_√xt
;

20083 i‡(
	`°rög_buf„r_putc
(
b
, 
c
))

20084 
Áû
;

20086 
tokí
->
vÆ
 = 
TOK_STRING
;

20087 
tokí
->
u
.
°r
.
£p
 = 
c
;

20088 
tokí
->
u
.
°r
.°∏
	`°rög_buf„r_íd
(
b
);

20089 *
µ
 = 
p
;

20092 
övÆid_utf8
:

20093 i‡(
do_throw
)

20094 
	`js_∑r£_îr‹
(
s
, "invalid UTF-8 sequence");

20095 
Áû
;

20096 
övÆid_ch¨
:

20097 i‡(
do_throw
)

20098 
	`js_∑r£_îr‹
(
s
, "unexpectedÉnd of string");

20099 
Áû
:

20100 
	`°rög_buf„r_‰ì
(
b
);

20102 
	}
}

20104 
ölöe
 
BOOL
 
	$tokí_is_p£udo_keyw‹d
(
JSP¨£Sèã
 *
s
, 
JSAtom
 
©om
) {

20105  
s
->
tokí
.
vÆ
 =
TOK_IDENT
 && s->tokí.
u
.
idít
.
©om
 ==átom &&

20106 !
s
->
tokí
.
u
.
idít
.
has_esˇ≥
;

20107 
	}
}

20109 
__ex˚±i⁄
 
	$js_∑r£_ªgexp
(
JSP¨£Sèã
 *
s
)

20111 c⁄° 
uöt8_t
 *
p
;

20112 
BOOL
 
ö_˛ass
;

20113 
SåögBuf„r
 
b_s
, *
b
 = &b_s;

20114 
SåögBuf„r
 
b2_s
, *
b2
 = &b2_s;

20115 
uöt32_t
 
c
;

20117 
p
 = 
s
->
buf_±r
;

20118 
p
++;

20119 
ö_˛ass
 = 
FALSE
;

20120 i‡(
	`°rög_buf„r_öô
(
s
->
˘x
, 
b
, 32))

20122 i‡(
	`°rög_buf„r_öô
(
s
->
˘x
, 
b2
, 1))

20123 
Áû
;

20125 i‡(
p
 >
s
->
buf_íd
) {

20126 
eof_îr‹
:

20127 
	`js_∑r£_îr‹
(
s
, "unexpectedÉnd ofÑegexp");

20128 
Áû
;

20130 
c
 = *
p
++;

20131 i‡(
c
 == '\n' || c == '\r') {

20132 
eﬁ_îr‹
;

20133 } i‡(
c
 == '/') {

20134 i‡(!
ö_˛ass
)

20136 } i‡(
c
 == '[') {

20137 
ö_˛ass
 = 
TRUE
;

20138 } i‡(
c
 == ']') {

20140 
ö_˛ass
 = 
FALSE
;

20141 } i‡(
c
 == '\\') {

20142 i‡(
	`°rög_buf„r_putc8
(
b
, 
c
))

20143 
Áû
;

20144 
c
 = *
p
++;

20145 i‡(
c
 == '\n' || c == '\r')

20146 
eﬁ_îr‹
;

20147 i‡(
c
 ='\0' && 
p
 >
s
->
buf_íd
)

20148 
eof_îr‹
;

20149 i‡(
c
 >= 0x80) {

20150 c⁄° 
uöt8_t
 *
p_√xt
;

20151 
c
 = 
	`unicode_‰om_utf8
(
p
 - 1, 
UTF8_CHAR_LEN_MAX
, &
p_√xt
);

20152 i‡(
c
 > 0x10FFFF) {

20153 
övÆid_utf8
;

20155 
p
 = 
p_√xt
;

20156 i‡(
c
 =
CP_LS
 || c =
CP_PS
)

20157 
eﬁ_îr‹
;

20159 } i‡(
c
 >= 0x80) {

20160 c⁄° 
uöt8_t
 *
p_√xt
;

20161 
c
 = 
	`unicode_‰om_utf8
(
p
 - 1, 
UTF8_CHAR_LEN_MAX
, &
p_√xt
);

20162 i‡(
c
 > 0x10FFFF) {

20163 
övÆid_utf8
:

20164 
	`js_∑r£_îr‹
(
s
, "invalid UTF-8 sequence");

20165 
Áû
;

20167 
p
 = 
p_√xt
;

20169 i‡(
c
 =
CP_LS
 || c =
CP_PS
) {

20170 
eﬁ_îr‹
:

20171 
	`js_∑r£_îr‹
(
s
, "unexpectedÜineÅerminator inÑegexp");

20172 
Áû
;

20175 i‡(
	`°rög_buf„r_putc
(
b
, 
c
))

20176 
Áû
;

20181 c⁄° 
uöt8_t
 *
p_√xt
 = 
p
;

20182 
c
 = *
p_√xt
++;

20183 i‡(
c
 >= 0x80) {

20184 
c
 = 
	`unicode_‰om_utf8
(
p
, 
UTF8_CHAR_LEN_MAX
, &
p_√xt
);

20185 i‡(
c
 > 0x10FFFF) {

20186 
övÆid_utf8
;

20189 i‡(!
	`Ãe_js_is_idít_√xt
(
c
))

20191 i‡(
	`°rög_buf„r_putc
(
b2
, 
c
))

20192 
Áû
;

20193 
p
 = 
p_√xt
;

20196 
s
->
tokí
.
vÆ
 = 
TOK_REGEXP
;

20197 
s
->
tokí
.
u
.
ªgexp
.
body
 = 
	`°rög_buf„r_íd
(
b
);

20198 
s
->
tokí
.
u
.
ªgexp
.
Êags
 = 
	`°rög_buf„r_íd
(
b2
);

20199 
s
->
buf_±r
 = 
p
;

20201 
Áû
:

20202 
	`°rög_buf„r_‰ì
(
b
);

20203 
	`°rög_buf„r_‰ì
(
b2
);

20205 
	}
}

20207 
__ex˚±i⁄
 
	$idít_ªÆloc
(
JSC⁄ãxt
 *
˘x
, **
pbuf
, 
size_t
 *
psize
,

20208 *
°©ic_buf
)

20210 *
buf
, *
√w_buf
;

20211 
size_t
 
size
, 
√w_size
;

20213 
buf
 = *
pbuf
;

20214 
size
 = *
psize
;

20215 i‡(
size
 >(
SIZE_MAX
 / 3) * 2)

20216 
√w_size
 = 
SIZE_MAX
;

20218 
√w_size
 = 
size
 + (size >> 1);

20219 i‡(
buf
 =
°©ic_buf
) {

20220 
√w_buf
 = 
	`js_mÆloc
(
˘x
, 
√w_size
);

20221 i‡(!
√w_buf
)

20223 
	`mem˝y
(
√w_buf
, 
buf
, 
size
);

20225 
√w_buf
 = 
	`js_ªÆloc
(
˘x
, 
buf
, 
√w_size
);

20226 i‡(!
√w_buf
)

20229 *
pbuf
 = 
√w_buf
;

20230 *
psize
 = 
√w_size
;

20232 
	}
}

20235 
JSAtom
 
	$∑r£_idít
(
JSP¨£Sèã
 *
s
, c⁄° 
uöt8_t
 **
µ
,

20236 
BOOL
 *
pidít_has_esˇ≥
, 
c
, BOOL 
is_¥iv©e
)

20238 c⁄° 
uöt8_t
 *
p
, *
p1
;

20239 
idít_buf
[128], *
buf
;

20240 
size_t
 
idít_size
, 
idít_pos
;

20241 
JSAtom
 
©om
;

20243 
p
 = *
µ
;

20244 
buf
 = 
idít_buf
;

20245 
idít_size
 = (
idít_buf
);

20246 
idít_pos
 = 0;

20247 i‡(
is_¥iv©e
)

20248 
buf
[
idít_pos
++] = '#';

20250 
p1
 = 
p
;

20252 i‡(
c
 < 128) {

20253 
buf
[
idít_pos
++] = 
c
;

20255 
idít_pos
 +
	`unicode_to_utf8
((
uöt8_t
*)
buf
 + idít_pos, 
c
);

20257 
c
 = *
p1
++;

20258 i‡(
c
 ='\\' && *
p1
 == 'u') {

20259 
c
 = 
	`Ãe_∑r£_esˇ≥
(&
p1
, 
TRUE
);

20260 *
pidít_has_esˇ≥
 = 
TRUE
;

20261 } i‡(
c
 >= 128) {

20262 
c
 = 
	`unicode_‰om_utf8
(
p
, 
UTF8_CHAR_LEN_MAX
, &
p1
);

20264 i‡(!
	`Ãe_js_is_idít_√xt
(
c
))

20266 
p
 = 
p1
;

20267 i‡(
	`u∆ikñy
(
idít_pos
 >
idít_size
 - 
UTF8_CHAR_LEN_MAX
)) {

20268 i‡(
	`idít_ªÆloc
(
s
->
˘x
, &
buf
, &
idít_size
, 
idít_buf
)) {

20269 
©om
 = 
JS_ATOM_NULL
;

20270 
d⁄e
;

20274 
©om
 = 
	`JS_NewAtomLí
(
s
->
˘x
, 
buf
, 
idít_pos
);

20275 
d⁄e
:

20276 i‡(
	`u∆ikñy
(
buf
 !
idít_buf
))

20277 
	`js_‰ì
(
s
->
˘x
, 
buf
);

20278 *
µ
 = 
p
;

20279  
©om
;

20280 
	}
}

20283 
__ex˚±i⁄
 
	$√xt_tokí
(
JSP¨£Sèã
 *
s
)

20285 c⁄° 
uöt8_t
 *
p
;

20286 
c
;

20287 
BOOL
 
idít_has_esˇ≥
;

20288 
JSAtom
 
©om
;

20290 i‡(
	`js_check_°ack_ovîÊow
(
s
->
˘x
->
π
, 0)) {

20291  
	`js_∑r£_îr‹
(
s
, "stack overflow");

20294 
	`‰ì_tokí
(
s
, &s->
tokí
);

20296 
p
 = 
s
->
œ°_±r
 = s->
buf_±r
;

20297 
s
->
gŸ_lf
 = 
FALSE
;

20298 
s
->
œ°_löe_num
 = s->
tokí
.
löe_num
;

20299 
ªdo
:

20300 
s
->
tokí
.
löe_num
 = s->line_num;

20301 
s
->
tokí
.
±r
 = 
p
;

20302 
c
 = *
p
;

20303 
c
) {

20305 
s
->
tokí
.
vÆ
 = 
TOK_EOF
;

20308 i‡(!
s
->
cur_func
) {

20310 
def_tokí
;

20312 i‡(
	`js_∑r£_ãm∂©e_∑π
(
s
, 
p
 + 1))

20313 
Áû
;

20314 
p
 = 
s
->
buf_±r
;

20317 i‡(!
s
->
cur_func
) {

20319 
def_tokí
;

20323 i‡(
	`js_∑r£_°rög
(
s
, 
c
, 
TRUE
, 
p
 + 1, &s->
tokí
, &p))

20324 
Áû
;

20327 i‡(
p
[1] == '\n') {

20328 
p
++;

20332 
p
++;

20333 
löe_ãrmö©‹
:

20334 
s
->
gŸ_lf
 = 
TRUE
;

20335 
s
->
löe_num
++;

20336 
ªdo
;

20339 i‡(!
s
->
cur_func
) {

20341 
def_tokí
;

20346 
p
++;

20347 
ªdo
;

20349 i‡(
p
[1] == '*') {

20351 
p
 += 2;

20353 i‡(*
p
 ='\0' &&Ö >
s
->
buf_íd
) {

20354 
	`js_∑r£_îr‹
(
s
, "unexpectedÉnd of comment");

20355 
Áû
;

20357 i‡(
p
[0] == '*' &&Ö[1] == '/') {

20358 
p
 += 2;

20361 i‡(*
p
 == '\n') {

20362 
s
->
löe_num
++;

20363 
s
->
gŸ_lf
 = 
TRUE
;

20364 
p
++;

20365 } i‡(*
p
 == '\r') {

20366 
s
->
gŸ_lf
 = 
TRUE
;

20367 
p
++;

20368 } i‡(*
p
 >= 0x80) {

20369 
c
 = 
	`unicode_‰om_utf8
(
p
, 
UTF8_CHAR_LEN_MAX
, &p);

20370 i‡(
c
 =
CP_LS
 || c =
CP_PS
) {

20371 
s
->
gŸ_lf
 = 
TRUE
;

20372 } i‡(
c
 == -1) {

20373 
p
++;

20376 
p
++;

20379 
ªdo
;

20380 } i‡(
p
[1] == '/') {

20382 
p
 += 2;

20383 
skù_löe_commít
:

20385 i‡(*
p
 ='\0' &&Ö >
s
->
buf_íd
)

20387 i‡(*
p
 == '\r' || *p == '\n')

20389 i‡(*
p
 >= 0x80) {

20390 
c
 = 
	`unicode_‰om_utf8
(
p
, 
UTF8_CHAR_LEN_MAX
, &p);

20392 i‡(
c
 =
CP_LS
 || c =
CP_PS
) {

20394 } i‡(
c
 == -1) {

20395 
p
++;

20398 
p
++;

20401 
ªdo
;

20402 } i‡(
p
[1] == '=') {

20403 
p
 += 2;

20404 
s
->
tokí
.
vÆ
 = 
TOK_DIV_ASSIGN
;

20406 
p
++;

20407 
s
->
tokí
.
vÆ
 = 
c
;

20411 i‡(
p
[1] == 'u') {

20412 c⁄° 
uöt8_t
 *
p1
 = 
p
 + 1;

20413 
c1
 = 
	`Ãe_∑r£_esˇ≥
(&
p1
, 
TRUE
);

20414 i‡(
c1
 >0 && 
	`Ãe_js_is_idít_fú°
(c1)) {

20415 
c
 = 
c1
;

20416 
p
 = 
p1
;

20417 
idít_has_esˇ≥
 = 
TRUE
;

20418 
has_idít
;

20423 
def_tokí
;

20429 
p
++;

20430 
idít_has_esˇ≥
 = 
FALSE
;

20431 
has_idít
:

20432 
©om
 = 
	`∑r£_idít
(
s
, &
p
, &
idít_has_esˇ≥
, 
c
, 
FALSE
);

20433 i‡(
©om
 =
JS_ATOM_NULL
)

20434 
Áû
;

20435 
s
->
tokí
.
u
.
idít
.
©om
 =átom;

20436 
s
->
tokí
.
u
.
idít
.
has_esˇ≥
 = 
idít_has_esˇ≥
;

20437 
s
->
tokí
.
u
.
idít
.
is_ª£rved
 = 
FALSE
;

20438 i‡(
s
->
tokí
.
u
.
idít
.
©om
 <
JS_ATOM_LAST_KEYWORD
 ||

20439 (
s
->
tokí
.
u
.
idít
.
©om
 <
JS_ATOM_LAST_STRICT_KEYWORD
 &&

20440 
s
->
cur_func
 && (s->cur_func->
js_mode
 & 
JS_MODE_STRICT
)) ||

20441 (
s
->
tokí
.
u
.
idít
.
©om
 =
JS_ATOM_yõld
 && s->
cur_func
 &&

20442 ((
s
->
cur_func
->
func_köd
 & 
JS_FUNC_GENERATOR
) ||

20443 (
s
->
cur_func
->
func_ty≥
 =
JS_PARSE_FUNC_ARROW
 &&

20444 !
s
->
cur_func
->
ö_fun˘i⁄_body
 && s->cur_func->
∑ª¡
 &&

20445 (
s
->
cur_func
->
∑ª¡
->
func_köd
 & 
JS_FUNC_GENERATOR
)))) ||

20446 (
s
->
tokí
.
u
.
idít
.
©om
 =
JS_ATOM_awaô
 &&

20447 (
s
->
is_moduÀ
 ||

20448 (
s
->
cur_func
 &&

20449 ((
s
->
cur_func
->
func_köd
 & 
JS_FUNC_ASYNC
) ||

20450 (
s
->
cur_func
->
func_ty≥
 =
JS_PARSE_FUNC_ARROW
 &&

20451 !
s
->
cur_func
->
ö_fun˘i⁄_body
 && s->cur_func->
∑ª¡
 &&

20452 (
s
->
cur_func
->
∑ª¡
->
func_köd
 & 
JS_FUNC_ASYNC
))))))) {

20453 i‡(
idít_has_esˇ≥
) {

20454 
s
->
tokí
.
u
.
idít
.
is_ª£rved
 = 
TRUE
;

20455 
s
->
tokí
.
vÆ
 = 
TOK_IDENT
;

20458 
s
->
tokí
.
vÆ
 = s->tokí.
u
.
idít
.
©om
 - 1 + 
TOK_FIRST_KEYWORD
;

20461 
s
->
tokí
.
vÆ
 = 
TOK_IDENT
;

20467 c⁄° 
uöt8_t
 *
p1
;

20468 
p
++;

20469 
p1
 = 
p
;

20470 
c
 = *
p1
++;

20471 i‡(
c
 ='\\' && *
p1
 == 'u') {

20472 
c
 = 
	`Ãe_∑r£_esˇ≥
(&
p1
, 
TRUE
);

20473 } i‡(
c
 >= 128) {

20474 
c
 = 
	`unicode_‰om_utf8
(
p
, 
UTF8_CHAR_LEN_MAX
, &
p1
);

20476 i‡(!
	`Ãe_js_is_idít_fú°
(
c
)) {

20477 
	`js_∑r£_îr‹
(
s
, "invalid first character ofÖrivateÇame");

20478 
Áû
;

20480 
p
 = 
p1
;

20481 
idít_has_esˇ≥
 = 
FALSE
;

20482 
©om
 = 
	`∑r£_idít
(
s
, &
p
, &
idít_has_esˇ≥
, 
c
, 
TRUE
);

20483 i‡(
©om
 =
JS_ATOM_NULL
)

20484 
Áû
;

20485 
s
->
tokí
.
u
.
idít
.
©om
 =átom;

20486 
s
->
tokí
.
vÆ
 = 
TOK_PRIVATE_NAME
;

20490 i‡(
p
[1] == '.' &&Ö[2] == '.') {

20491 
p
 += 3;

20492 
s
->
tokí
.
vÆ
 = 
TOK_ELLIPSIS
;

20495 i‡(
p
[1] >= '0' &&Ö[1] <= '9') {

20496 
∑r£_numbî
;

20498 
def_tokí
;

20503 i‡(
	`is_digô
(
p
[1]Ë&& (!
s
->
cur_func
 ||

20504 (
s
->
cur_func
->
js_mode
 & 
JS_MODE_STRICT
))) {

20505 
	`js_∑r£_îr‹
(
s
, "octalÜiteralsáre deprecated in strict mode");

20506 
Áû
;

20508 
∑r£_numbî
;

20511 
∑r£_numbî
:

20513 
JSVÆue
 
ªt
;

20514 c⁄° 
uöt8_t
 *
p1
;

20515 
Êags
, 
ødix
;

20516 i‡(!
s
->
cur_func
) {

20517 
Êags
 = 0;

20518 
ødix
 = 10;

20520 
Êags
 = 
ATOD_ACCEPT_BIN_OCT
 | 
ATOD_ACCEPT_LEGACY_OCTAL
 |

20521 
ATOD_ACCEPT_UNDERSCORES
;

20522 #ifde‡
CONFIG_BIGNUM


20523 
Êags
 |
ATOD_ACCEPT_SUFFIX
;

20524 i‡(
s
->
cur_func
->
js_mode
 & 
JS_MODE_MATH
) {

20525 
Êags
 |
ATOD_MODE_BIGINT
;

20526 i‡(
s
->
cur_func
->
js_mode
 & 
JS_MODE_MATH
)

20527 
Êags
 |
ATOD_TYPE_BIG_FLOAT
;

20530 
ødix
 = 0;

20532 #ifde‡
CONFIG_BIGNUM


20533 
s
->
tokí
.
u
.
num
.
exp⁄ít
 = 0;

20534 
ªt
 = 
	`js_©of2
(
s
->
˘x
, (c⁄° *)
p
, (c⁄° **)&p, 
ødix
,

20535 
Êags
, &
s
->
tokí
.
u
.
num
.
exp⁄ít
);

20537 
ªt
 = 
	`js_©of
(
s
->
˘x
, (c⁄° *)
p
, (c⁄° **)&p, 
ødix
,

20538 
Êags
);

20540 i‡(
	`JS_IsEx˚±i⁄
(
ªt
))

20541 
Áû
;

20543 i‡(
	`JS_VALUE_IS_NAN
(
ªt
) ||

20544 
	`Ãe_js_is_idít_√xt
(
	`unicode_‰om_utf8
(
p
, 
UTF8_CHAR_LEN_MAX
, &
p1
))) {

20545 
	`JS_FªeVÆue
(
s
->
˘x
, 
ªt
);

20546 
	`js_∑r£_îr‹
(
s
, "invalidÇumberÜiteral");

20547 
Áû
;

20549 
s
->
tokí
.
vÆ
 = 
TOK_NUMBER
;

20550 
s
->
tokí
.
u
.
num
.
vÆ
 = 
ªt
;

20554 i‡(
p
[1] == '=') {

20555 
p
 += 2;

20556 
s
->
tokí
.
vÆ
 = 
TOK_MUL_ASSIGN
;

20557 } i‡(
p
[1] == '*') {

20558 i‡(
p
[2] == '=') {

20559 
p
 += 3;

20560 
s
->
tokí
.
vÆ
 = 
TOK_POW_ASSIGN
;

20562 
p
 += 2;

20563 
s
->
tokí
.
vÆ
 = 
TOK_POW
;

20566 
def_tokí
;

20570 i‡(
p
[1] == '=') {

20571 
p
 += 2;

20572 
s
->
tokí
.
vÆ
 = 
TOK_MOD_ASSIGN
;

20574 
def_tokí
;

20578 i‡(
p
[1] == '=') {

20579 
p
 += 2;

20580 
s
->
tokí
.
vÆ
 = 
TOK_PLUS_ASSIGN
;

20581 } i‡(
p
[1] == '+') {

20582 
p
 += 2;

20583 
s
->
tokí
.
vÆ
 = 
TOK_INC
;

20585 
def_tokí
;

20589 i‡(
p
[1] == '=') {

20590 
p
 += 2;

20591 
s
->
tokí
.
vÆ
 = 
TOK_MINUS_ASSIGN
;

20592 } i‡(
p
[1] == '-') {

20593 i‡(
s
->
Ælow_html_commíts
 &&

20594 
p
[2] ='>' && 
s
->
œ°_löe_num
 !s->
löe_num
) {

20598 
skù_löe_commít
;

20600 
p
 += 2;

20601 
s
->
tokí
.
vÆ
 = 
TOK_DEC
;

20603 
def_tokí
;

20607 i‡(
p
[1] == '=') {

20608 
p
 += 2;

20609 
s
->
tokí
.
vÆ
 = 
TOK_LTE
;

20610 } i‡(
p
[1] == '<') {

20611 i‡(
p
[2] == '=') {

20612 
p
 += 3;

20613 
s
->
tokí
.
vÆ
 = 
TOK_SHL_ASSIGN
;

20615 
p
 += 2;

20616 
s
->
tokí
.
vÆ
 = 
TOK_SHL
;

20618 } i‡(
s
->
Ælow_html_commíts
 &&

20619 
p
[1] == '!' &&Ö[2] == '-' &&Ö[3] == '-') {

20621 
skù_löe_commít
;

20623 
def_tokí
;

20627 i‡(
p
[1] == '=') {

20628 
p
 += 2;

20629 
s
->
tokí
.
vÆ
 = 
TOK_GTE
;

20630 } i‡(
p
[1] == '>') {

20631 i‡(
p
[2] == '>') {

20632 i‡(
p
[3] == '=') {

20633 
p
 += 4;

20634 
s
->
tokí
.
vÆ
 = 
TOK_SHR_ASSIGN
;

20636 
p
 += 3;

20637 
s
->
tokí
.
vÆ
 = 
TOK_SHR
;

20639 } i‡(
p
[2] == '=') {

20640 
p
 += 3;

20641 
s
->
tokí
.
vÆ
 = 
TOK_SAR_ASSIGN
;

20643 
p
 += 2;

20644 
s
->
tokí
.
vÆ
 = 
TOK_SAR
;

20647 
def_tokí
;

20651 i‡(
p
[1] == '=') {

20652 i‡(
p
[2] == '=') {

20653 
p
 += 3;

20654 
s
->
tokí
.
vÆ
 = 
TOK_STRICT_EQ
;

20656 
p
 += 2;

20657 
s
->
tokí
.
vÆ
 = 
TOK_EQ
;

20659 } i‡(
p
[1] == '>') {

20660 
p
 += 2;

20661 
s
->
tokí
.
vÆ
 = 
TOK_ARROW
;

20663 
def_tokí
;

20667 i‡(
p
[1] == '=') {

20668 i‡(
p
[2] == '=') {

20669 
p
 += 3;

20670 
s
->
tokí
.
vÆ
 = 
TOK_STRICT_NEQ
;

20672 
p
 += 2;

20673 
s
->
tokí
.
vÆ
 = 
TOK_NEQ
;

20676 
def_tokí
;

20680 i‡(
p
[1] == '=') {

20681 
p
 += 2;

20682 
s
->
tokí
.
vÆ
 = 
TOK_AND_ASSIGN
;

20683 } i‡(
p
[1] == '&') {

20684 
p
 += 2;

20685 
s
->
tokí
.
vÆ
 = 
TOK_LAND
;

20687 
def_tokí
;

20690 #ifde‡
CONFIG_BIGNUM


20694 i‡(
p
[1] == '=') {

20695 
p
 += 2;

20696 i‡(
s
->
cur_func
 && (s->cur_func->
js_mode
 & 
JS_MODE_MATH
))

20697 
s
->
tokí
.
vÆ
 = 
TOK_MATH_POW_ASSIGN
;

20699 
s
->
tokí
.
vÆ
 = 
TOK_XOR_ASSIGN
;

20700 } i‡(
p
[1] == '^') {

20701 i‡(
p
[2] == '=') {

20702 
p
 += 3;

20703 
s
->
tokí
.
vÆ
 = 
TOK_XOR_ASSIGN
;

20705 
p
 += 2;

20706 
s
->
tokí
.
vÆ
 = '^';

20709 
p
++;

20710 i‡(
s
->
cur_func
 && (s->cur_func->
js_mode
 & 
JS_MODE_MATH
))

20711 
s
->
tokí
.
vÆ
 = 
TOK_MATH_POW
;

20713 
s
->
tokí
.
vÆ
 = '^';

20718 i‡(
p
[1] == '=') {

20719 
p
 += 2;

20720 
s
->
tokí
.
vÆ
 = 
TOK_XOR_ASSIGN
;

20722 
def_tokí
;

20727 i‡(
p
[1] == '=') {

20728 
p
 += 2;

20729 
s
->
tokí
.
vÆ
 = 
TOK_OR_ASSIGN
;

20730 } i‡(
p
[1] == '|') {

20731 
p
 += 2;

20732 
s
->
tokí
.
vÆ
 = 
TOK_LOR
;

20734 
def_tokí
;

20738 i‡(
p
[1] == '?') {

20739 
p
 += 2;

20740 
s
->
tokí
.
vÆ
 = 
TOK_DOUBLE_QUESTION_MARK
;

20741 } i‡(
p
[1] == '.' && !(p[2] >= '0' &&Ö[2] <= '9')) {

20742 
p
 += 2;

20743 
s
->
tokí
.
vÆ
 = 
TOK_QUESTION_MARK_DOT
;

20745 
def_tokí
;

20749 i‡(
c
 >= 128) {

20751 
c
 = 
	`unicode_‰om_utf8
(
p
, 
UTF8_CHAR_LEN_MAX
, &p);

20752 
c
) {

20753 
CP_PS
:

20754 
CP_LS
:

20755 i‡(!
s
->
cur_func
) {

20757 
def_tokí
;

20761 
löe_ãrmö©‹
;

20764 i‡(
	`Ãe_is_•a˚
(
c
)) {

20765 i‡(!
s
->
cur_func
) {

20767 
def_tokí
;

20769 
ªdo
;

20771 } i‡(
	`Ãe_js_is_idít_fú°
(
c
)) {

20772 
idít_has_esˇ≥
 = 
FALSE
;

20773 
has_idít
;

20775 
	`js_∑r£_îr‹
(
s
, "unexpected character");

20776 
Áû
;

20780 
def_tokí
:

20781 
s
->
tokí
.
vÆ
 = 
c
;

20782 
p
++;

20785 
s
->
buf_±r
 = 
p
;

20790 
Áû
:

20791 
s
->
tokí
.
vÆ
 = 
TOK_ERROR
;

20793 
	}
}

20798 
	$sim∂e_√xt_tokí
(c⁄° 
uöt8_t
 **
µ
, 
BOOL
 
no_löe_ãrmö©‹
)

20800 c⁄° 
uöt8_t
 *
p
;

20801 
uöt32_t
 
c
;

20804 
p
 = *
µ
;

20806 
c
 = *
p
++) {

20809 i‡(
no_löe_ãrmö©‹
)

20818 i‡(*
p
 == '/') {

20819 i‡(
no_löe_ãrmö©‹
)

20821 *
p
 && *p != '\r' && *p != '\n')

20822 
p
++;

20825 i‡(*
p
 == '*') {

20826 *++
p
) {

20827 i‡((*
p
 ='\r' || *∞='\n'Ë&& 
no_löe_ãrmö©‹
)

20829 i‡(*
p
 == '*' &&Ö[1] == '/') {

20830 
p
 += 2;

20838 i‡(*
p
 == '>')

20839  
TOK_ARROW
;

20842 i‡(
	`Ãe_js_is_idít_fú°
(
c
)) {

20843 i‡(
c
 == 'i') {

20844 i‡(
p
[0] ='n' && !
	`Ãe_js_is_idít_√xt
(p[1])) {

20845  
TOK_IN
;

20847 i‡(
p
[0] == 'm' &&Ö[1] == 'p' &&Ö[2] == 'o' &&

20848 
p
[3] == 'r' &&Ö[4] == 't' &&

20849 !
	`Ãe_js_is_idít_√xt
(
p
[5])) {

20850 *
µ
 = 
p
 + 5;

20851  
TOK_IMPORT
;

20853 } i‡(
c
 ='o' && *
p
 ='f' && !
	`Ãe_js_is_idít_√xt
(p[1])) {

20854  
TOK_OF
;

20855 } i‡(
c
 ='f' && 
p
[0] == 'u' &&Ö[1] == 'n' &&

20856 
p
[2] == 'c' &&Ö[3] == 't' &&Ö[4] == 'i' &&

20857 
p
[5] ='o' &&Ö[6] ='n' && !
	`Ãe_js_is_idít_√xt
(p[7])) {

20858  
TOK_FUNCTION
;

20860  
TOK_IDENT
;

20864  
c
;

20866 
	}
}

20868 
	$≥ek_tokí
(
JSP¨£Sèã
 *
s
, 
BOOL
 
no_löe_ãrmö©‹
)

20870 c⁄° 
uöt8_t
 *
p
 = 
s
->
buf_±r
;

20871  
	`sim∂e_√xt_tokí
(&
p
, 
no_löe_ãrmö©‹
);

20872 
	}
}

20880 
BOOL
 
	$JS_Dëe˘ModuÀ
(c⁄° *
öput
, 
size_t
 
öput_Àn
)

20882 c⁄° 
uöt8_t
 *
p
 = (c⁄° uöt8_à*)
öput
;

20883 
tok
;

20884 i‡(
	`sim∂e_√xt_tokí
(&
p
, 
FALSE
Ë!
TOK_IMPORT
)

20885  
FALSE
;

20886 
tok
 = 
	`sim∂e_√xt_tokí
(&
p
, 
FALSE
);

20887  (
tok
 != '.' &&Åok != '(');

20888 
	}
}

20890 
ölöe
 
	$gë_¥ev_›code
(
JSFun˘i⁄Def
 *
fd
) {

20891 i‡(
fd
->
œ°_›code_pos
 < 0)

20892  
OP_övÆid
;

20894  
fd
->
byã_code
.
buf
[fd->
œ°_›code_pos
];

20895 
	}
}

20897 
BOOL
 
	$js_is_live_code
(
JSP¨£Sèã
 *
s
) {

20898 
	`gë_¥ev_›code
(
s
->
cur_func
)) {

20899 
OP_èû_ˇŒ
:

20900 
OP_èû_ˇŒ_mëhod
:

20901 
OP_ªtu∫
:

20902 
OP_ªtu∫_undef
:

20903 
OP_ªtu∫_async
:

20904 
OP_throw
:

20905 
OP_throw_v¨
:

20906 
OP_gŸo
:

20907 #i‡
SHORT_OPCODES


20908 
OP_gŸo8
:

20909 
OP_gŸo16
:

20911 
OP_ªt
:

20912  
FALSE
;

20914  
TRUE
;

20916 
	}
}

20918 
	$emô_u8
(
JSP¨£Sèã
 *
s
, 
uöt8_t
 
vÆ
)

20920 
	`dbuf_putc
(&
s
->
cur_func
->
byã_code
, 
vÆ
);

20921 
	}
}

20923 
	$emô_u16
(
JSP¨£Sèã
 *
s
, 
uöt16_t
 
vÆ
)

20925 
	`dbuf_put_u16
(&
s
->
cur_func
->
byã_code
, 
vÆ
);

20926 
	}
}

20928 
	$emô_u32
(
JSP¨£Sèã
 *
s
, 
uöt32_t
 
vÆ
)

20930 
	`dbuf_put_u32
(&
s
->
cur_func
->
byã_code
, 
vÆ
);

20931 
	}
}

20933 
	$emô_›
(
JSP¨£Sèã
 *
s
, 
uöt8_t
 
vÆ
)

20935 
JSFun˘i⁄Def
 *
fd
 = 
s
->
cur_func
;

20936 
DynBuf
 *
bc
 = &
fd
->
byã_code
;

20941 i‡(
	`u∆ikñy
(
fd
->
œ°_›code_löe_num
 !
s
->
œ°_löe_num
)) {

20942 
	`dbuf_putc
(
bc
, 
OP_löe_num
);

20943 
	`dbuf_put_u32
(
bc
, 
s
->
œ°_löe_num
);

20944 
fd
->
œ°_›code_löe_num
 = 
s
->
œ°_löe_num
;

20946 
fd
->
œ°_›code_pos
 = 
bc
->
size
;

20947 
	`dbuf_putc
(
bc
, 
vÆ
);

20948 
	}
}

20950 
	$emô_©om
(
JSP¨£Sèã
 *
s
, 
JSAtom
 
«me
)

20952 
	`emô_u32
(
s
, 
	`JS_DupAtom
(s->
˘x
, 
«me
));

20953 
	}
}

20955 
	$upd©e_œbñ
(
JSFun˘i⁄Def
 *
s
, 
œbñ
, 
dñè
)

20957 
LabñSlŸ
 *
ls
;

20959 
	`as£π
(
œbñ
 >0 &&Üabñ < 
s
->
œbñ_cou¡
);

20960 
ls
 = &
s
->
œbñ_¶Ÿs
[
œbñ
];

20961 
ls
->
ªf_cou¡
 +
dñè
;

20962 
	`as£π
(
ls
->
ªf_cou¡
 >= 0);

20963  
ls
->
ªf_cou¡
;

20964 
	}
}

20966 
	$√w_œbñ_fd
(
JSFun˘i⁄Def
 *
fd
, 
œbñ
)

20968 
LabñSlŸ
 *
ls
;

20970 i‡(
œbñ
 < 0) {

20971 i‡(
fd
->
œbñ_cou¡
 >fd->
œbñ_size
) {

20972 
√w_size
;

20973 
size_t
 
¶ack
;

20974 
LabñSlŸ
 *
√w_èb
;

20977 
√w_size
 = 
fd
->
œbñ_size
 * 3 / 2 + 4;

20978 
√w_èb
 = 
	`js_ªÆloc2
(
fd
->
˘x
, fd->
œbñ_¶Ÿs
, 
√w_size
 * (*√w_èb), &
¶ack
);

20979 i‡(!
√w_èb
)

20981 
√w_size
 +
¶ack
 / (*
√w_èb
);

20982 
fd
->
œbñ_¶Ÿs
 = 
√w_èb
;

20983 
fd
->
œbñ_size
 = 
√w_size
;

20985 
œbñ
 = 
fd
->
œbñ_cou¡
++;

20986 
ls
 = &
fd
->
œbñ_¶Ÿs
[
œbñ
];

20987 
ls
->
ªf_cou¡
 = 0;

20988 
ls
->
pos
 = -1;

20989 
ls
->
pos2
 = -1;

20990 
ls
->
addr
 = -1;

20991 
ls
->
fú°_ªloc
 = 
NULL
;

20993  
œbñ
;

20994 
	}
}

20996 
	$√w_œbñ
(
JSP¨£Sèã
 *
s
)

20998  
	`√w_œbñ_fd
(
s
->
cur_func
, -1);

20999 
	}
}

21002 
	$emô_œbñ
(
JSP¨£Sèã
 *
s
, 
œbñ
)

21004 i‡(
œbñ
 >= 0) {

21005 
	`emô_›
(
s
, 
OP_œbñ
);

21006 
	`emô_u32
(
s
, 
œbñ
);

21007 
s
->
cur_func
->
œbñ_¶Ÿs
[
œbñ
].
pos
 = s->cur_func->
byã_code
.
size
;

21008  
s
->
cur_func
->
byã_code
.
size
 - 4;

21012 
	}
}

21015 
	$emô_gŸo
(
JSP¨£Sèã
 *
s
, 
›code
, 
œbñ
)

21017 i‡(
	`js_is_live_code
(
s
)) {

21018 i‡(
œbñ
 < 0)

21019 
œbñ
 = 
	`√w_œbñ
(
s
);

21020 
	`emô_›
(
s
, 
›code
);

21021 
	`emô_u32
(
s
, 
œbñ
);

21022 
s
->
cur_func
->
œbñ_¶Ÿs
[
œbñ
].
ªf_cou¡
++;

21023  
œbñ
;

21026 
	}
}

21029 
	$˝oﬁ_add
(
JSP¨£Sèã
 *
s
, 
JSVÆue
 
vÆ
)

21031 
JSFun˘i⁄Def
 *
fd
 = 
s
->
cur_func
;

21032 i‡(
fd
->
˝oﬁ_cou¡
 >fd->
˝oﬁ_size
) {

21033 
√w_size
;

21034 
size_t
 
¶ack
;

21035 
JSVÆue
 *
√w_èb
;

21037 
√w_size
 = 
	`max_öt
(
fd
->
˝oﬁ_cou¡
 + 1, fd->
˝oﬁ_size
 * 3 / 2);

21038 
√w_èb
 = 
	`js_ªÆloc2
(
s
->
˘x
, 
fd
->
˝oﬁ
, 
√w_size
 * (
JSVÆue
), &
¶ack
);

21039 i‡(!
√w_èb
)

21041 
√w_size
 +
¶ack
 / (*
√w_èb
);

21042 
fd
->
˝oﬁ
 = 
√w_èb
;

21043 
fd
->
˝oﬁ_size
 = 
√w_size
;

21045 
fd
->
˝oﬁ
[fd->
˝oﬁ_cou¡
++] = 
vÆ
;

21046  
fd
->
˝oﬁ_cou¡
 - 1;

21047 
	}
}

21049 
__ex˚±i⁄
 
	$emô_push_c⁄°
(
JSP¨£Sèã
 *
s
, 
JSVÆueC⁄°
 
vÆ
,

21050 
BOOL
 
as_©om
)

21052 
idx
;

21054 i‡(
	`JS_VALUE_GET_TAG
(
vÆ
Ë=
JS_TAG_STRING
 && 
as_©om
) {

21055 
JSAtom
 
©om
;

21057 
	`JS_DupVÆue
(
s
->
˘x
, 
vÆ
);

21058 
©om
 = 
	`JS_NewAtomSå
(
s
->
˘x
, 
	`JS_VALUE_GET_STRING
(
vÆ
));

21059 i‡(
©om
 !
JS_ATOM_NULL
 && !
	`__JS_AtomIsTaggedI¡
(atom)) {

21060 
	`emô_›
(
s
, 
OP_push_©om_vÆue
);

21061 
	`emô_u32
(
s
, 
©om
);

21066 
idx
 = 
	`˝oﬁ_add
(
s
, 
	`JS_DupVÆue
(s->
˘x
, 
vÆ
));

21067 i‡(
idx
 < 0)

21069 
	`emô_›
(
s
, 
OP_push_c⁄°
);

21070 
	`emô_u32
(
s
, 
idx
);

21072 
	}
}

21076 
	$föd_¨g
(
JSC⁄ãxt
 *
˘x
, 
JSFun˘i⁄Def
 *
fd
, 
JSAtom
 
«me
)

21078 
i
;

21079 
i
 = 
fd
->
¨g_cou¡
; i-- > 0;) {

21080 i‡(
fd
->
¨gs
[
i
].
v¨_«me
 =
«me
)

21081  
i
 | 
ARGUMENT_VAR_OFFSET
;

21084 
	}
}

21086 
	$föd_v¨
(
JSC⁄ãxt
 *
˘x
, 
JSFun˘i⁄Def
 *
fd
, 
JSAtom
 
«me
)

21088 
i
;

21089 
i
 = 
fd
->
v¨_cou¡
; i-- > 0;) {

21090 i‡(
fd
->
v¨s
[
i
].
v¨_«me
 =
«me
 && fd->v¨s[i].
sc›e_Àvñ
 == 0)

21091  
i
;

21093  
	`föd_¨g
(
˘x
, 
fd
, 
«me
);

21094 
	}
}

21098 
BOOL
 
	$is_chûd_sc›e
(
JSC⁄ãxt
 *
˘x
, 
JSFun˘i⁄Def
 *
fd
,

21099 
sc›e
, 
∑ª¡_sc›e
)

21101 
sc›e
 >= 0) {

21102 i‡(
sc›e
 =
∑ª¡_sc›e
)

21103  
TRUE
;

21104 
sc›e
 = 
fd
->
sc›es
[sc›e].
∑ª¡
;

21106  
FALSE
;

21107 
	}
}

21110 
	$föd_v¨_ö_chûd_sc›e
(
JSC⁄ãxt
 *
˘x
, 
JSFun˘i⁄Def
 *
fd
,

21111 
JSAtom
 
«me
, 
sc›e_Àvñ
)

21113 
i
;

21114 
i
 = 0; i < 
fd
->
v¨_cou¡
; i++) {

21115 
JSV¨Def
 *
vd
 = &
fd
->
v¨s
[
i
];

21116 i‡(
vd
->
v¨_«me
 =
«me
 && vd->
sc›e_Àvñ
 == 0) {

21117 i‡(
	`is_chûd_sc›e
(
˘x
, 
fd
, 
vd
->
func_poﬁ_‹_sc›e_idx
,

21118 
sc›e_Àvñ
))

21119  
i
;

21123 
	}
}

21126 
JSHoi°edDef
 *
	$föd_hoi°ed_def
(
JSFun˘i⁄Def
 *
fd
, 
JSAtom
 
«me
)

21128 
i
;

21129 
i
 = 0; i < 
fd
->
hoi°ed_def_cou¡
; i++) {

21130 
JSHoi°edDef
 *
hf
 = &
fd
->
hoi°ed_def
[
i
];

21131 i‡(
hf
->
v¨_«me
 =
«me
)

21132  
hf
;

21134  
NULL
;

21136 
	}
}

21138 
JSHoi°edDef
 *
	$föd_Àxiˇl_hoi°ed_def
(
JSFun˘i⁄Def
 *
fd
, 
JSAtom
 
«me
)

21140 
JSHoi°edDef
 *
hf
 = 
	`föd_hoi°ed_def
(
fd
, 
«me
);

21141 i‡(
hf
 && hf->
is_Àxiˇl
)

21142  
hf
;

21144  
NULL
;

21145 
	}
}

21147 
	$föd_Àxiˇl_de˛
(
JSC⁄ãxt
 *
˘x
, 
JSFun˘i⁄Def
 *
fd
, 
JSAtom
 
«me
,

21148 
sc›e_idx
, 
BOOL
 
check_ˇtch_v¨
)

21150 
sc›e_idx
 >= 0) {

21151 
JSV¨Def
 *
vd
 = &
fd
->
v¨s
[
sc›e_idx
];

21152 i‡(
vd
->
v¨_«me
 =
«me
 &&

21153 (
vd
->
is_Àxiˇl
 || (vd->
v¨_köd
 =
JS_VAR_CATCH
 &&

21154 
check_ˇtch_v¨
)))

21155  
sc›e_idx
;

21156 
sc›e_idx
 = 
vd
->
sc›e_√xt
;

21159 i‡(
fd
->
is_evÆ
 && fd->
evÆ_ty≥
 =
JS_EVAL_TYPE_GLOBAL
) {

21160 i‡(
	`föd_Àxiˇl_hoi°ed_def
(
fd
, 
«me
))

21161  
GLOBAL_VAR_OFFSET
;

21164 
	}
}

21166 
	$push_sc›e
(
JSP¨£Sèã
 *
s
) {

21167 i‡(
s
->
cur_func
) {

21168 
JSFun˘i⁄Def
 *
fd
 = 
s
->
cur_func
;

21169 
sc›e
 = 
fd
->
sc›e_cou¡
;

21171 i‡((
fd
->
sc›e_cou¡
 + 1Ë> fd->
sc›e_size
) {

21172 
√w_size
;

21173 
size_t
 
¶ack
;

21174 
JSV¨Sc›e
 *
√w_buf
;

21176 
√w_size
 = 
	`max_öt
(
fd
->
sc›e_cou¡
 + 1, fd->
sc›e_size
 * 3 / 2);

21177 i‡(
fd
->
sc›es
 =fd->
def_sc›e_¨øy
) {

21178 
√w_buf
 = 
	`js_ªÆloc2
(
s
->
˘x
, 
NULL
, 
√w_size
 * (*
fd
->
sc›es
), &
¶ack
);

21179 i‡(!
√w_buf
)

21181 
	`mem˝y
(
√w_buf
, 
fd
->
sc›es
, fd->
sc›e_cou¡
 * (*fd->scopes));

21183 
√w_buf
 = 
	`js_ªÆloc2
(
s
->
˘x
, 
fd
->
sc›es
, 
√w_size
 * (*fd->sc›es), &
¶ack
);

21184 i‡(!
√w_buf
)

21187 
√w_size
 +
¶ack
 / (*
√w_buf
);

21188 
fd
->
sc›es
 = 
√w_buf
;

21189 
fd
->
sc›e_size
 = 
√w_size
;

21191 
fd
->
sc›e_cou¡
++;

21192 
fd
->
sc›es
[
sc›e
].
∑ª¡
 = fd->
sc›e_Àvñ
;

21193 
fd
->
sc›es
[
sc›e
].
fú°
 = fd->
sc›e_fú°
;

21194 
	`emô_›
(
s
, 
OP_íãr_sc›e
);

21195 
	`emô_u16
(
s
, 
sc›e
);

21196  
fd
->
sc›e_Àvñ
 = 
sc›e
;

21199 
	}
}

21201 
	$gë_fú°_Àxiˇl_v¨
(
JSFun˘i⁄Def
 *
fd
, 
sc›e
)

21203 
sc›e
 >= 0) {

21204 
sc›e_idx
 = 
fd
->
sc›es
[
sc›e
].
fú°
;

21205 i‡(
sc›e_idx
 >= 0)

21206  
sc›e_idx
;

21207 
sc›e
 = 
fd
->
sc›es
[sc›e].
∑ª¡
;

21210 
	}
}

21212 
	$p›_sc›e
(
JSP¨£Sèã
 *
s
) {

21213 i‡(
s
->
cur_func
) {

21215 
JSFun˘i⁄Def
 *
fd
 = 
s
->
cur_func
;

21216 
sc›e
 = 
fd
->
sc›e_Àvñ
;

21217 
	`emô_›
(
s
, 
OP_Àave_sc›e
);

21218 
	`emô_u16
(
s
, 
sc›e
);

21219 
fd
->
sc›e_Àvñ
 = fd->
sc›es
[
sc›e
].
∑ª¡
;

21220 
fd
->
sc›e_fú°
 = 
	`gë_fú°_Àxiˇl_v¨
(fd, fd->
sc›e_Àvñ
);

21222 
	}
}

21224 
	$˛o£_sc›es
(
JSP¨£Sèã
 *
s
, 
sc›e
, 
sc›e_°›
)

21226 
sc›e
 > 
sc›e_°›
) {

21227 
	`emô_›
(
s
, 
OP_Àave_sc›e
);

21228 
	`emô_u16
(
s
, 
sc›e
);

21229 
sc›e
 = 
s
->
cur_func
->
sc›es
[sc›e].
∑ª¡
;

21231 
	}
}

21234 
	$add_v¨
(
JSC⁄ãxt
 *
˘x
, 
JSFun˘i⁄Def
 *
fd
, 
JSAtom
 
«me
)

21236 
JSV¨Def
 *
vd
;

21239 i‡(
fd
->
v¨_cou¡
 >
JS_MAX_LOCAL_VARS
) {

21240 
	`JS_ThrowI¡î«lEº‹
(
˘x
, "too manyÜocal variables");

21243 i‡((
fd
->
v¨_cou¡
 + 1Ë> fd->
v¨_size
) {

21244 
√w_size
;

21245 
size_t
 
¶ack
;

21246 
JSV¨Def
 *
√w_buf
;

21247 
√w_size
 = 
	`max_öt
(
fd
->
v¨_cou¡
 + 1, fd->
v¨_size
 * 3 / 2);

21248 
√w_buf
 = 
	`js_ªÆloc2
(
˘x
, 
fd
->
v¨s
, 
√w_size
 * (*fd->v¨s), &
¶ack
);

21249 i‡(!
√w_buf
)

21251 
√w_size
 +
¶ack
 / (*
√w_buf
);

21252 
fd
->
v¨s
 = 
√w_buf
;

21253 
fd
->
v¨_size
 = 
√w_size
;

21255 
vd
 = &
fd
->
v¨s
[fd->
v¨_cou¡
++];

21256 
	`mem£t
(
vd
, 0, (*vd));

21257 
vd
->
v¨_«me
 = 
	`JS_DupAtom
(
˘x
, 
«me
);

21258  
fd
->
v¨_cou¡
 - 1;

21259 
	}
}

21261 
	$add_sc›e_v¨
(
JSC⁄ãxt
 *
˘x
, 
JSFun˘i⁄Def
 *
fd
, 
JSAtom
 
«me
,

21262 
JSV¨KödEnum
 
v¨_köd
)

21264 
idx
 = 
	`add_v¨
(
˘x
, 
fd
, 
«me
);

21265 i‡(
idx
 >= 0) {

21266 
JSV¨Def
 *
vd
 = &
fd
->
v¨s
[
idx
];

21267 
vd
->
v¨_köd
 = var_kind;

21268 
vd
->
sc›e_Àvñ
 = 
fd
->scope_level;

21269 
vd
->
sc›e_√xt
 = 
fd
->
sc›e_fú°
;

21270 
fd
->
sc›es
[fd->
sc›e_Àvñ
].
fú°
 = 
idx
;

21271 
fd
->
sc›e_fú°
 = 
idx
;

21273  
idx
;

21274 
	}
}

21276 
	$add_func_v¨
(
JSC⁄ãxt
 *
˘x
, 
JSFun˘i⁄Def
 *
fd
, 
JSAtom
 
«me
)

21278 
idx
 = 
fd
->
func_v¨_idx
;

21279 i‡(
idx
 < 0 && (idx = 
	`add_v¨
(
˘x
, 
fd
, 
«me
)) >= 0) {

21280 
fd
->
func_v¨_idx
 = 
idx
;

21281 
fd
->
v¨s
[
idx
].
is_func_v¨
 = 
TRUE
;

21282 i‡(
fd
->
js_mode
 & 
JS_MODE_STRICT
)

21283 
fd
->
v¨s
[
idx
].
is_c⁄°
 = 
TRUE
;

21285  
idx
;

21286 
	}
}

21288 
	$add_¨gumíts_v¨
(
JSC⁄ãxt
 *
˘x
, 
JSFun˘i⁄Def
 *
fd
, 
JSAtom
 
«me
)

21290 
idx
 = 
fd
->
¨gumíts_v¨_idx
;

21291 i‡(
idx
 < 0 && (idx = 
	`add_v¨
(
˘x
, 
fd
, 
«me
)) >= 0) {

21292 
fd
->
¨gumíts_v¨_idx
 = 
idx
;

21294  
idx
;

21295 
	}
}

21297 
	$add_¨g
(
JSC⁄ãxt
 *
˘x
, 
JSFun˘i⁄Def
 *
fd
, 
JSAtom
 
«me
)

21299 
JSV¨Def
 *
vd
;

21302 i‡(
fd
->
¨g_cou¡
 >
JS_MAX_LOCAL_VARS
) {

21303 
	`JS_ThrowI¡î«lEº‹
(
˘x
, "too manyárguments");

21306 i‡((
fd
->
¨g_cou¡
 + 1Ë> fd->
¨g_size
) {

21307 
√w_size
;

21308 
size_t
 
¶ack
;

21309 
JSV¨Def
 *
√w_buf
;

21310 
√w_size
 = 
	`max_öt
(
fd
->
¨g_cou¡
 + 1, fd->
¨g_size
 * 3 / 2);

21311 
√w_buf
 = 
	`js_ªÆloc2
(
˘x
, 
fd
->
¨gs
, 
√w_size
 * (*fd->¨gs), &
¶ack
);

21312 i‡(!
√w_buf
)

21314 
√w_size
 +
¶ack
 / (*
√w_buf
);

21315 
fd
->
¨gs
 = 
√w_buf
;

21316 
fd
->
¨g_size
 = 
√w_size
;

21318 
vd
 = &
fd
->
¨gs
[fd->
¨g_cou¡
++];

21319 
	`mem£t
(
vd
, 0, (*vd));

21320 
vd
->
v¨_«me
 = 
	`JS_DupAtom
(
˘x
, 
«me
);

21321  
fd
->
¨g_cou¡
 - 1;

21322 
	}
}

21326 
JSHoi°edDef
 *
	$add_hoi°ed_def
(
JSC⁄ãxt
 *
˘x
,

21327 
JSFun˘i⁄Def
 *
s
, 
˝oﬁ_idx
,

21328 
JSAtom
 
«me
, 
v¨_idx
, 
BOOL
 
is_Àxiˇl
)

21330 
JSHoi°edDef
 *
hf
;

21332 i‡(
s
->
hoi°ed_def_cou¡
 >s->
hoi°ed_def_size
) {

21333 
√w_size
;

21334 
size_t
 
¶ack
;

21335 
JSHoi°edDef
 *
√w_èb
;

21336 
√w_size
 = 
	`max_öt
(
s
->
hoi°ed_def_cou¡
 + 1,

21337 
s
->
hoi°ed_def_size
 * 3 / 2);

21338 
√w_èb
 = 
	`js_ªÆloc2
(
˘x
, 
s
->
hoi°ed_def
, 
√w_size
 * (s->hoi°ed_def[0]), &
¶ack
);

21339 i‡(!
√w_èb
)

21340  
NULL
;

21341 
√w_size
 +
¶ack
 / (*
√w_èb
);

21342 
s
->
hoi°ed_def
 = 
√w_èb
;

21343 
s
->
hoi°ed_def_size
 = 
√w_size
;

21345 
hf
 = &
s
->
hoi°ed_def
[s->
hoi°ed_def_cou¡
++];

21346 
hf
->
˝oﬁ_idx
 = cpool_idx;

21347 
hf
->
f‹˚_öô
 = 0;

21348 
hf
->
is_Àxiˇl
 = is_lexical;

21349 
hf
->
is_c⁄°
 = 
FALSE
;

21350 
hf
->
v¨_idx
 = var_idx;

21351 
hf
->
sc›e_Àvñ
 = 
s
->scope_level;

21352 
hf
->
v¨_«me
 = 
JS_ATOM_NULL
;

21353 i‡(
«me
 !
JS_ATOM_NULL
) {

21354 
hf
->
v¨_«me
 = 
	`JS_DupAtom
(
˘x
, 
«me
);

21356  
hf
;

21357 
	}
}

21360 
	mJS_VAR_DEF_WITH
,

21361 
	mJS_VAR_DEF_LET
,

21362 
	mJS_VAR_DEF_CONST
,

21363 
	mJS_VAR_DEF_FUNCTION_DECL
,

21364 
	mJS_VAR_DEF_NEW_FUNCTION_DECL
,

21365 
	mJS_VAR_DEF_CATCH
,

21366 
	mJS_VAR_DEF_VAR
,

21367 } 
	tJSV¨DefEnum
;

21369 
	$deföe_v¨
(
JSP¨£Sèã
 *
s
, 
JSFun˘i⁄Def
 *
fd
, 
JSAtom
 
«me
,

21370 
JSV¨DefEnum
 
v¨_def_ty≥
)

21372 
JSC⁄ãxt
 *
˘x
 = 
s
->ctx;

21373 
JSV¨Def
 *
vd
;

21374 
idx
;

21376 
v¨_def_ty≥
) {

21377 
JS_VAR_DEF_WITH
:

21378 
idx
 = 
	`add_sc›e_v¨
(
˘x
, 
fd
, 
«me
, 
JS_VAR_NORMAL
);

21381 
JS_VAR_DEF_LET
:

21382 
JS_VAR_DEF_CONST
:

21383 
JS_VAR_DEF_FUNCTION_DECL
:

21384 
JS_VAR_DEF_NEW_FUNCTION_DECL
:

21385 
idx
 = 
	`föd_Àxiˇl_de˛
(
˘x
, 
fd
, 
«me
, fd->
sc›e_fú°
, 
TRUE
);

21386 i‡(
idx
 >= 0) {

21387 i‡(
idx
 < 
GLOBAL_VAR_OFFSET
) {

21388 i‡(
fd
->
v¨s
[
idx
].
sc›e_Àvñ
 == fd->scope_level) {

21391 i‡(!(!(
fd
->
js_mode
 & 
JS_MODE_STRICT
) &&

21392 
v¨_def_ty≥
 =
JS_VAR_DEF_FUNCTION_DECL
 &&

21393 
fd
->
v¨s
[
idx
].
v¨_köd
 =
JS_VAR_FUNCTION_DECL
)) {

21394 
ªdef_Àx_îr‹
;

21396 } i‡(
fd
->
v¨s
[
idx
].
v¨_köd
 =
JS_VAR_CATCH
 && (fd->v¨s[idx].
sc›e_Àvñ
 + 2) == fd->scope_level) {

21397 
ªdef_Àx_îr‹
;

21400 i‡(
fd
->
sc›e_Àvñ
 == 1) {

21401 
ªdef_Àx_îr‹
:

21403  
	`js_∑r£_îr‹
(
s
, "invalidÑedefinition ofÜexical identifier");

21407 i‡(
v¨_def_ty≥
 !
JS_VAR_DEF_FUNCTION_DECL
 &&

21408 
v¨_def_ty≥
 !
JS_VAR_DEF_NEW_FUNCTION_DECL
 &&

21409 
fd
->
sc›e_Àvñ
 == 1 &&

21410 
	`föd_¨g
(
˘x
, 
fd
, 
«me
) >= 0) {

21412  
	`js_∑r£_îr‹
(
s
, "invalidÑedefinition ofÖarameterÇame");

21415 i‡(
	`föd_v¨_ö_chûd_sc›e
(
˘x
, 
fd
, 
«me
, fd->
sc›e_Àvñ
) >= 0) {

21416  
	`js_∑r£_îr‹
(
s
, "invalidÑedefinition ofá variable");

21419 i‡(
fd
->
is_globÆ_v¨
) {

21420 
JSHoi°edDef
 *
hf
;

21421 
hf
 = 
	`föd_hoi°ed_def
(
fd
, 
«me
);

21422 i‡(
hf
 && 
	`is_chûd_sc›e
(
˘x
, 
fd
, hf->
sc›e_Àvñ
,

21423 
fd
->
sc›e_Àvñ
)) {

21424  
	`js_∑r£_îr‹
(
s
, "invalidÑedefinition of global identifier");

21428 i‡(
fd
->
is_evÆ
 &&

21429 (
fd
->
evÆ_ty≥
 =
JS_EVAL_TYPE_GLOBAL
 ||

21430 
fd
->
evÆ_ty≥
 =
JS_EVAL_TYPE_MODULE
) &&

21431 
fd
->
sc›e_Àvñ
 == 1) {

21432 
JSHoi°edDef
 *
hf
;

21433 
hf
 = 
	`add_hoi°ed_def
(
s
->
˘x
, 
fd
, -1, 
«me
, -1, 
TRUE
);

21434 i‡(!
hf
)

21436 
hf
->
is_c⁄°
 = (
v¨_def_ty≥
 =
JS_VAR_DEF_CONST
);

21437 
idx
 = 
GLOBAL_VAR_OFFSET
;

21439 
JSV¨KödEnum
 
v¨_köd
;

21440 i‡(
v¨_def_ty≥
 =
JS_VAR_DEF_FUNCTION_DECL
)

21441 
v¨_köd
 = 
JS_VAR_FUNCTION_DECL
;

21442 i‡(
v¨_def_ty≥
 =
JS_VAR_DEF_NEW_FUNCTION_DECL
)

21443 
v¨_köd
 = 
JS_VAR_NEW_FUNCTION_DECL
;

21445 
v¨_köd
 = 
JS_VAR_NORMAL
;

21446 
idx
 = 
	`add_sc›e_v¨
(
˘x
, 
fd
, 
«me
, 
v¨_köd
);

21447 i‡(
idx
 >= 0) {

21448 
vd
 = &
fd
->
v¨s
[
idx
];

21449 
vd
->
is_Àxiˇl
 = 1;

21450 
vd
->
is_c⁄°
 = (
v¨_def_ty≥
 =
JS_VAR_DEF_CONST
);

21455 
JS_VAR_DEF_CATCH
:

21456 
idx
 = 
	`add_sc›e_v¨
(
˘x
, 
fd
, 
«me
, 
JS_VAR_CATCH
);

21459 
JS_VAR_DEF_VAR
:

21460 i‡(
	`föd_Àxiˇl_de˛
(
˘x
, 
fd
, 
«me
, fd->
sc›e_fú°
,

21461 
FALSE
) >= 0) {

21462 
övÆid_Àxiˇl_ªdeföôi⁄
:

21464  
	`js_∑r£_îr‹
(
s
, "invalidÑedefinition ofÜexical identifier");

21466 i‡(
fd
->
is_globÆ_v¨
) {

21467 
JSHoi°edDef
 *
hf
;

21468 
hf
 = 
	`föd_hoi°ed_def
(
fd
, 
«me
);

21469 i‡(
hf
 && hf->
is_Àxiˇl
 && hf->
sc›e_Àvñ
 =
fd
->scope_level &&

21470 
fd
->
evÆ_ty≥
 =
JS_EVAL_TYPE_MODULE
) {

21471 
övÆid_Àxiˇl_ªdeföôi⁄
;

21473 
hf
 = 
	`add_hoi°ed_def
(
s
->
˘x
, 
fd
, -1, 
«me
, -1, 
FALSE
);

21474 i‡(!
hf
)

21476 
idx
 = 
GLOBAL_VAR_OFFSET
;

21479 
idx
 = 
	`föd_v¨
(
˘x
, 
fd
, 
«me
);

21480 i‡(
idx
 >= 0)

21482 
idx
 = 
	`add_v¨
(
˘x
, 
fd
, 
«me
);

21483 i‡(
idx
 >= 0) {

21484 i‡(
«me
 =
JS_ATOM_¨gumíts
 && 
fd
->
has_¨gumíts_bödög
)

21485 
fd
->
¨gumíts_v¨_idx
 = 
idx
;

21486 
fd
->
v¨s
[
idx
].
func_poﬁ_‹_sc›e_idx
 = fd->
sc›e_Àvñ
;

21491 
	`ab‹t
();

21493  
idx
;

21494 
	}
}

21497 
	$add_¥iv©e_˛ass_fõld
(
JSP¨£Sèã
 *
s
, 
JSFun˘i⁄Def
 *
fd
,

21498 
JSAtom
 
«me
, 
JSV¨KödEnum
 
v¨_köd
)

21500 
JSC⁄ãxt
 *
˘x
 = 
s
->ctx;

21501 
JSV¨Def
 *
vd
;

21502 
idx
;

21504 
idx
 = 
	`add_sc›e_v¨
(
˘x
, 
fd
, 
«me
, 
v¨_köd
);

21505 i‡(
idx
 < 0)

21506  
idx
;

21507 
vd
 = &
fd
->
v¨s
[
idx
];

21508 
vd
->
is_Àxiˇl
 = 1;

21509 
vd
->
is_c⁄°
 = 1;

21510  
idx
;

21511 
	}
}

21513 
__ex˚±i⁄
 
js_∑r£_ex¥
(
JSP¨£Sèã
 *
s
);

21514 
__ex˚±i⁄
 
js_∑r£_fun˘i⁄_de˛
(
JSP¨£Sèã
 *
s
,

21515 
JSP¨£Fun˘i⁄Enum
 
func_ty≥
,

21516 
JSFun˘i⁄KödEnum
 
func_köd
,

21517 
JSAtom
 
func_«me
, c⁄° 
uöt8_t
 *
±r
,

21518 
°¨t_löe
);

21519 
JSFun˘i⁄Def
 *
js_∑r£_fun˘i⁄_˛ass_fõlds_öô
(
JSP¨£Sèã
 *
s
);

21520 
__ex˚±i⁄
 
js_∑r£_fun˘i⁄_de˛2
(
JSP¨£Sèã
 *
s
,

21521 
JSP¨£Fun˘i⁄Enum
 
func_ty≥
,

21522 
JSFun˘i⁄KödEnum
 
func_köd
,

21523 
JSAtom
 
func_«me
,

21524 c⁄° 
uöt8_t
 *
±r
,

21525 
fun˘i⁄_löe_num
,

21526 
JSP¨£Exp‹tEnum
 
exp‹t_Êag
,

21527 
JSFun˘i⁄Def
 **
pfd
);

21528 
__ex˚±i⁄
 
js_∑r£_assign_ex¥
(
JSP¨£Sèã
 *
s
, 
ö_ac˚±ed
);

21529 
__ex˚±i⁄
 
js_∑r£_u«ry
(
JSP¨£Sèã
 *
s
, 
exp⁄ítüti⁄_Êag
);

21530 
push_bªak_íåy
(
JSFun˘i⁄Def
 *
fd
, 
BlockEnv
 *
be
,

21531 
JSAtom
 
œbñ_«me
,

21532 
œbñ_bªak
, 
œbñ_c⁄t
,

21533 
dr›_cou¡
);

21534 
p›_bªak_íåy
(
JSFun˘i⁄Def
 *
fd
);

21535 
JSExp‹tE¡ry
 *
add_exp‹t_íåy
(
JSP¨£Sèã
 *
s
, 
JSModuÀDef
 *
m
,

21536 
JSAtom
 
loˇl_«me
, JSAtom 
exp‹t_«me
,

21537 
JSExp‹tTy≥Enum
 
exp‹t_ty≥
);

21540 
	$£Æ_ãm∂©e_obj
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
obj
)

21542 
JSObje˘
 *
p
;

21543 
JSSh≠ePr›îty
 *
¥s
;

21545 
p
 = 
	`JS_VALUE_GET_OBJ
(
obj
);

21546 
¥s
 = 
	`föd_own_¥›îty1
(
p
, 
JS_ATOM_Àngth
);

21547 i‡(
¥s
) {

21548 i‡(
	`js_upd©e_¥›îty_Êags
(
˘x
, 
p
, &
¥s
,

21549 
¥s
->
Êags
 & ~(
JS_PROP_CONFIGURABLE
 | 
JS_PROP_WRITABLE
)))

21552 
p
->
exãnsibÀ
 = 
FALSE
;

21554 
	}
}

21556 
__ex˚±i⁄
 
	$js_∑r£_ãm∂©e
(
JSP¨£Sèã
 *
s
, 
ˇŒ
, *
¨gc
)

21558 
JSC⁄ãxt
 *
˘x
 = 
s
->ctx;

21559 
JSVÆue
 
øw_¨øy
, 
ãm∂©e_obje˘
;

21560 
JSTokí
 
cooked
;

21561 
dïth
, 
ªt
;

21563 
øw_¨øy
 = 
JS_UNDEFINED
;

21564 
ãm∂©e_obje˘
 = 
JS_UNDEFINED
;

21565 i‡(
ˇŒ
) {

21568 
ãm∂©e_obje˘
 = 
	`JS_NewAºay
(
˘x
);

21569 i‡(
	`JS_IsEx˚±i⁄
(
ãm∂©e_obje˘
))

21572 
ªt
 = 
	`emô_push_c⁄°
(
s
, 
ãm∂©e_obje˘
, 0);

21573 
	`JS_FªeVÆue
(
˘x
, 
ãm∂©e_obje˘
);

21574 i‡(
ªt
)

21576 
øw_¨øy
 = 
	`JS_NewAºay
(
˘x
);

21577 i‡(
	`JS_IsEx˚±i⁄
(
øw_¨øy
))

21579 i‡(
	`JS_DeföePr›îtyVÆue
(
˘x
, 
ãm∂©e_obje˘
, 
JS_ATOM_øw
,

21580 
øw_¨øy
, 
JS_PROP_THROW
) < 0) {

21585 
dïth
 = 0;

21586 
s
->
tokí
.
vÆ
 =
TOK_TEMPLATE
) {

21587 c⁄° 
uöt8_t
 *
p
 = 
s
->
tokí
.
±r
 + 1;

21588 
cooked
 = 
s
->
tokí
;

21589 i‡(
ˇŒ
) {

21590 i‡(
	`JS_DeföePr›îtyVÆueUöt32
(
˘x
, 
øw_¨øy
, 
dïth
,

21591 
	`JS_DupVÆue
(
˘x
, 
s
->
tokí
.
u
.
°r
.str),

21592 
JS_PROP_ENUMERABLE
 | 
JS_PROP_THROW
) < 0) {

21598 i‡(
	`js_∑r£_°rög
(
s
, '`', 
FALSE
, 
p
, &
cooked
, &p)) {

21599 
cooked
.
u
.
°r
.°∏
JS_UNDEFINED
;

21601 i‡(
	`JS_DeföePr›îtyVÆueUöt32
(
˘x
, 
ãm∂©e_obje˘
, 
dïth
,

21602 
cooked
.
u
.
°r
.str,

21603 
JS_PROP_ENUMERABLE
 | 
JS_PROP_THROW
) < 0) {

21607 
JSSåög
 *
°r
;

21611 
	`JS_FªeVÆue
(
˘x
, 
s
->
tokí
.
u
.
°r
.str);

21612 
s
->
tokí
.
u
.
°r
.°∏
JS_UNDEFINED
;

21613 i‡(
	`js_∑r£_°rög
(
s
, '`', 
TRUE
, 
p
, &
cooked
, &p))

21615 
°r
 = 
	`JS_VALUE_GET_STRING
(
cooked
.
u
.str.str);

21616 i‡(
°r
->
Àn
 !0 || 
dïth
 == 0) {

21617 
ªt
 = 
	`emô_push_c⁄°
(
s
, 
cooked
.
u
.
°r
.str, 1);

21618 
	`JS_FªeVÆue
(
s
->
˘x
, 
cooked
.
u
.
°r
.str);

21619 i‡(
ªt
)

21621 i‡(
dïth
 == 0) {

21622 i‡(
s
->
tokí
.
u
.
°r
.
£p
 == '`')

21623 
d⁄e1
;

21624 
	`emô_›
(
s
, 
OP_gë_fõld2
);

21625 
	`emô_©om
(
s
, 
JS_ATOM_c⁄ˇt
);

21627 
dïth
++;

21629 
	`JS_FªeVÆue
(
s
->
˘x
, 
cooked
.
u
.
°r
.str);

21632 i‡(
s
->
tokí
.
u
.
°r
.
£p
 == '`')

21633 
d⁄e
;

21634 i‡(
	`√xt_tokí
(
s
))

21636 i‡(
	`js_∑r£_assign_ex¥
(
s
, 
TRUE
))

21638 
dïth
++;

21639 i‡(
s
->
tokí
.
vÆ
 != '}') {

21640  
	`js_∑r£_îr‹
(
s
, "expected '}'áfterÅemplateÉxpression");

21643 
	`‰ì_tokí
(
s
, &s->
tokí
);

21645 
s
->
gŸ_lf
 = 
FALSE
;

21646 
s
->
œ°_löe_num
 = s->
tokí
.
löe_num
;

21647 i‡(
	`js_∑r£_ãm∂©e_∑π
(
s
, s->
buf_±r
))

21650  
	`js_∑r£_ex≥˘
(
s
, 
TOK_TEMPLATE
);

21652 
d⁄e
:

21653 i‡(
ˇŒ
) {

21655 
	`£Æ_ãm∂©e_obj
(
˘x
, 
øw_¨øy
);

21656 
	`£Æ_ãm∂©e_obj
(
˘x
, 
ãm∂©e_obje˘
);

21657 *
¨gc
 = 
dïth
 + 1;

21659 
	`emô_›
(
s
, 
OP_ˇŒ_mëhod
);

21660 
	`emô_u16
(
s
, 
dïth
 - 1);

21662 
d⁄e1
:

21663  
	`√xt_tokí
(
s
);

21664 
	}
}

21667 
	#PROP_TYPE_IDENT
 0

	)

21668 
	#PROP_TYPE_VAR
 1

	)

21669 
	#PROP_TYPE_GET
 2

	)

21670 
	#PROP_TYPE_SET
 3

	)

21671 
	#PROP_TYPE_STAR
 4

	)

21672 
	#PROP_TYPE_ASYNC
 5

	)

21673 
	#PROP_TYPE_ASYNC_STAR
 6

	)

21675 
	#PROP_TYPE_PRIVATE
 (1 << 4)

	)

21677 
BOOL
 
	$tokí_is_idít
(
tok
)

21680  (
tok
 =
TOK_IDENT
 ||

21681 (
tok
 >
TOK_FIRST_KEYWORD
 &&

21682 
tok
 <
TOK_LAST_KEYWORD
));

21683 
	}
}

21686 
__ex˚±i⁄
 
	$js_∑r£_¥›îty_«me
(
JSP¨£Sèã
 *
s
,

21687 
JSAtom
 *
≤ame
,

21688 
BOOL
 
Ælow_mëhod
, BOOL 
Ælow_v¨
,

21689 
BOOL
 
Ælow_¥iv©e
)

21691 
is_¥iv©e
 = 0;

21692 
BOOL
 
is_n⁄_ª£rved_idít
;

21693 
JSAtom
 
«me
;

21694 
¥›_ty≥
;

21696 
¥›_ty≥
 = 
PROP_TYPE_IDENT
;

21697 i‡(
Ælow_mëhod
) {

21698 i‡(
	`tokí_is_p£udo_keyw‹d
(
s
, 
JS_ATOM_gë
)

21699 || 
	`tokí_is_p£udo_keyw‹d
(
s
, 
JS_ATOM_£t
)) {

21701 
«me
 = 
	`JS_DupAtom
(
s
->
˘x
, s->
tokí
.
u
.
idít
.
©om
);

21702 i‡(
	`√xt_tokí
(
s
))

21703 
Áû1
;

21704 i‡(
s
->
tokí
.
vÆ
 == ':' || s->token.val == ',' ||

21705 
s
->
tokí
.
vÆ
 == '}' || s->token.val == '(') {

21706 
is_n⁄_ª£rved_idít
 = 
TRUE
;

21707 
idít_found
;

21709 
¥›_ty≥
 = 
PROP_TYPE_GET
 + (
«me
 =
JS_ATOM_£t
);

21710 
	`JS_FªeAtom
(
s
->
˘x
, 
«me
);

21711 } i‡(
s
->
tokí
.
vÆ
 == '*') {

21712 i‡(
	`√xt_tokí
(
s
))

21713 
Áû
;

21714 
¥›_ty≥
 = 
PROP_TYPE_STAR
;

21715 } i‡(
	`tokí_is_p£udo_keyw‹d
(
s
, 
JS_ATOM_async
) &&

21716 
	`≥ek_tokí
(
s
, 
TRUE
) != '\n') {

21717 
«me
 = 
	`JS_DupAtom
(
s
->
˘x
, s->
tokí
.
u
.
idít
.
©om
);

21718 i‡(
	`√xt_tokí
(
s
))

21719 
Áû1
;

21720 i‡(
s
->
tokí
.
vÆ
 == ':' || s->token.val == ',' ||

21721 
s
->
tokí
.
vÆ
 == '}' || s->token.val == '(') {

21722 
is_n⁄_ª£rved_idít
 = 
TRUE
;

21723 
idít_found
;

21725 
	`JS_FªeAtom
(
s
->
˘x
, 
«me
);

21726 i‡(
s
->
tokí
.
vÆ
 == '*') {

21727 i‡(
	`√xt_tokí
(
s
))

21728 
Áû
;

21729 
¥›_ty≥
 = 
PROP_TYPE_ASYNC_STAR
;

21731 
¥›_ty≥
 = 
PROP_TYPE_ASYNC
;

21736 i‡(
	`tokí_is_idít
(
s
->
tokí
.
vÆ
)) {

21738 
is_n⁄_ª£rved_idít
 =

21739 (
s
->
tokí
.
vÆ
 =
TOK_IDENT
 && !s->tokí.
u
.
idít
.
is_ª£rved
);

21741 
«me
 = 
	`JS_DupAtom
(
s
->
˘x
, s->
tokí
.
u
.
idít
.
©om
);

21742 i‡(
	`√xt_tokí
(
s
))

21743 
Áû1
;

21744 
idít_found
:

21745 i‡(
is_n⁄_ª£rved_idít
 &&

21746 
¥›_ty≥
 =
PROP_TYPE_IDENT
 && 
Ælow_v¨
) {

21747 i‡(!(
s
->
tokí
.
vÆ
 == ':' ||

21748 (
s
->
tokí
.
vÆ
 ='(' && 
Ælow_mëhod
))) {

21749 
¥›_ty≥
 = 
PROP_TYPE_VAR
;

21752 } i‡(
s
->
tokí
.
vÆ
 =
TOK_STRING
) {

21753 
«me
 = 
	`JS_VÆueToAtom
(
s
->
˘x
, s->
tokí
.
u
.
°r
.str);

21754 i‡(
«me
 =
JS_ATOM_NULL
)

21755 
Áû
;

21756 i‡(
	`√xt_tokí
(
s
))

21757 
Áû1
;

21758 } i‡(
s
->
tokí
.
vÆ
 =
TOK_NUMBER
) {

21759 
JSVÆue
 
vÆ
;

21760 
vÆ
 = 
s
->
tokí
.
u
.
num
.val;

21761 #ifde‡
CONFIG_BIGNUM


21762 i‡(
	`JS_VALUE_GET_TAG
(
vÆ
Ë=
JS_TAG_BIG_FLOAT
) {

21763 
JSBigFlﬂt
 *
p
 = 
	`JS_VALUE_GET_PTR
(
vÆ
);

21764 
vÆ
 = 
s
->
˘x
->
π
->
bigÊﬂt_›s
.

21765 
	`mul_pow10_to_Êﬂt64
(
s
->
˘x
, &
p
->
num
,

21766 
s
->
tokí
.
u
.
num
.
exp⁄ít
);

21767 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

21768 
Áû
;

21769 
«me
 = 
	`JS_VÆueToAtom
(
s
->
˘x
, 
vÆ
);

21770 
	`JS_FªeVÆue
(
s
->
˘x
, 
vÆ
);

21774 
«me
 = 
	`JS_VÆueToAtom
(
s
->
˘x
, 
vÆ
);

21776 i‡(
«me
 =
JS_ATOM_NULL
)

21777 
Áû
;

21778 i‡(
	`√xt_tokí
(
s
))

21779 
Áû1
;

21780 } i‡(
s
->
tokí
.
vÆ
 == '[') {

21781 i‡(
	`√xt_tokí
(
s
))

21782 
Áû
;

21783 i‡(
	`js_∑r£_ex¥
(
s
))

21784 
Áû
;

21785 i‡(
	`js_∑r£_ex≥˘
(
s
, ']'))

21786 
Áû
;

21787 
«me
 = 
JS_ATOM_NULL
;

21788 } i‡(
s
->
tokí
.
vÆ
 =
TOK_PRIVATE_NAME
 && 
Ælow_¥iv©e
) {

21789 
«me
 = 
	`JS_DupAtom
(
s
->
˘x
, s->
tokí
.
u
.
idít
.
©om
);

21790 i‡(
	`√xt_tokí
(
s
))

21791 
Áû1
;

21792 
is_¥iv©e
 = 
PROP_TYPE_PRIVATE
;

21794 
övÆid_¥›
;

21796 i‡(
¥›_ty≥
 !
PROP_TYPE_IDENT
 &&Ör›_ty≥ !
PROP_TYPE_VAR
 &&

21797 
s
->
tokí
.
vÆ
 != '(') {

21798 
	`JS_FªeAtom
(
s
->
˘x
, 
«me
);

21799 
övÆid_¥›
:

21800 
	`js_∑r£_îr‹
(
s
, "invalidÖropertyÇame");

21801 
Áû
;

21803 *
≤ame
 = 
«me
;

21804  
¥›_ty≥
 | 
is_¥iv©e
;

21805 
Áû1
:

21806 
	`JS_FªeAtom
(
s
->
˘x
, 
«me
);

21807 
Áû
:

21808 *
≤ame
 = 
JS_ATOM_NULL
;

21810 
	}
}

21812 
	sJSP¨£Pos
 {

21813 
	mœ°_löe_num
;

21814 
	mlöe_num
;

21815 
BOOL
 
	mgŸ_lf
;

21816 c⁄° 
uöt8_t
 *
	m±r
;

21817 } 
	tJSP¨£Pos
;

21819 
	$js_∑r£_gë_pos
(
JSP¨£Sèã
 *
s
, 
JSP¨£Pos
 *
•
)

21821 
•
->
œ°_löe_num
 = 
s
->last_line_num;

21822 
•
->
löe_num
 = 
s
->
tokí
.line_num;

21823 
•
->
±r
 = 
s
->
tokí
.ptr;

21824 
•
->
gŸ_lf
 = 
s
->got_lf;

21826 
	}
}

21828 
__ex˚±i⁄
 
	$js_∑r£_£ek_tokí
(
JSP¨£Sèã
 *
s
, c⁄° 
JSP¨£Pos
 *
•
)

21830 
s
->
tokí
.
löe_num
 = 
•
->
œ°_löe_num
;

21831 
s
->
löe_num
 = 
•
->line_num;

21832 
s
->
buf_±r
 = 
•
->
±r
;

21833 
s
->
gŸ_lf
 = 
•
->got_lf;

21834  
	`√xt_tokí
(
s
);

21835 
	}
}

21838 
BOOL
 
	$is_ªgexp_Ælowed
(
tok
)

21840 
tok
) {

21841 
TOK_NUMBER
:

21842 
TOK_STRING
:

21843 
TOK_REGEXP
:

21844 
TOK_DEC
:

21845 
TOK_INC
:

21846 
TOK_NULL
:

21847 
TOK_FALSE
:

21848 
TOK_TRUE
:

21849 
TOK_THIS
:

21853 
TOK_IDENT
:

21854  
FALSE
;

21856  
TRUE
;

21858 
	}
}

21860 
	#SKIP_HAS_SEMI
 (1 << 0)

	)

21861 
	#SKIP_HAS_ELLIPSIS
 (1 << 1)

	)

21866 
	$js_∑r£_skù_∑ªns_tokí
(
JSP¨£Sèã
 *
s
, *
pbôs
, 
BOOL
 
no_löe_ãrmö©‹
)

21868 
°©e
[256];

21869 
size_t
 
Àvñ
 = 0;

21870 
JSP¨£Pos
 
pos
;

21871 
œ°_tok
, 
tok
 = 
TOK_EOF
;

21872 
tok_Àn
, 
bôs
 = 0;

21875 
°©e
[
Àvñ
++] = 0;

21877 
	`js_∑r£_gë_pos
(
s
, &
pos
);

21878 
œ°_tok
 = 0;

21880 
s
->
tokí
.
vÆ
) {

21884 i‡(
Àvñ
 >(
°©e
))

21885 
d⁄e
;

21886 
°©e
[
Àvñ
++] = 
s
->
tokí
.
vÆ
;

21889 i‡(
°©e
[--
Àvñ
] != '(')

21890 
d⁄e
;

21893 i‡(
°©e
[--
Àvñ
] != '[')

21894 
d⁄e
;

21897 i‡(
°©e
[--
Àvñ
] != '{')

21898 
d⁄e
;

21900 
TOK_EOF
:

21901 
d⁄e
;

21903 i‡(
Àvñ
 == 2) {

21904 
bôs
 |
SKIP_HAS_SEMI
;

21907 
TOK_ELLIPSIS
:

21908 i‡(
Àvñ
 == 2) {

21909 
bôs
 |
SKIP_HAS_ELLIPSIS
;

21913 
TOK_DIV_ASSIGN
:

21914 
tok_Àn
 = 2;

21915 
∑r£_ªgexp
;

21917 
tok_Àn
 = 1;

21918 
∑r£_ªgexp
:

21919 i‡(
	`is_ªgexp_Ælowed
(
œ°_tok
)) {

21920 
s
->
buf_±r
 -
tok_Àn
;

21921 i‡(
	`js_∑r£_ªgexp
(
s
)) {

21923 
d⁄e
;

21929 i‡(
s
->
tokí
.
vÆ
 =
TOK_IDENT
 &&

21930 (
	`tokí_is_p£udo_keyw‹d
(
s
, 
JS_ATOM_of
) ||

21931 
	`tokí_is_p£udo_keyw‹d
(
s
, 
JS_ATOM_yõld
))) {

21932 
œ°_tok
 = 
TOK_OF
;

21934 
œ°_tok
 = 
s
->
tokí
.
vÆ
;

21936 i‡(
	`√xt_tokí
(
s
)) {

21940 i‡(
Àvñ
 <= 1) {

21941 
tok
 = 
s
->
tokí
.
vÆ
;

21942 i‡(
	`tokí_is_p£udo_keyw‹d
(
s
, 
JS_ATOM_of
))

21943 
tok
 = 
TOK_OF
;

21944 i‡(
no_löe_ãrmö©‹
 && 
s
->
œ°_löe_num
 !s->
tokí
.
löe_num
)

21945 
tok
 = '\n';

21949 
d⁄e
:

21950 i‡(
pbôs
) {

21951 *
pbôs
 = 
bôs
;

21953 i‡(
	`js_∑r£_£ek_tokí
(
s
, &
pos
))

21955  
tok
;

21956 
	}
}

21958 
	$£t_obje˘_«me
(
JSP¨£Sèã
 *
s
, 
JSAtom
 
«me
)

21960 
JSFun˘i⁄Def
 *
fd
 = 
s
->
cur_func
;

21961 
›code
;

21963 
›code
 = 
	`gë_¥ev_›code
(
fd
);

21964 i‡(
›code
 =
OP_£t_«me
) {

21966 
fd
->
byã_code
.
size
 = fd->
œ°_›code_pos
;

21967 
fd
->
œ°_›code_pos
 = -1;

21968 
	`emô_›
(
s
, 
OP_£t_«me
);

21969 
	`emô_©om
(
s
, 
«me
);

21970 } i‡(
›code
 =
OP_£t_˛ass_«me
) {

21971 
deföe_˛ass_pos
;

21972 
JSAtom
 
©om
;

21973 
deföe_˛ass_pos
 = 
fd
->
œ°_›code_pos
 + 1 -

21974 
	`gë_u32
(
fd
->
byã_code
.
buf
 + fd->
œ°_›code_pos
 + 1);

21975 
	`as£π
(
fd
->
byã_code
.
buf
[
deföe_˛ass_pos
] =
OP_deföe_˛ass
);

21978 
©om
 = 
	`gë_u32
(
fd
->
byã_code
.
buf
 + 
deföe_˛ass_pos
 + 1);

21979 
	`JS_FªeAtom
(
s
->
˘x
, 
©om
);

21980 
	`put_u32
(
fd
->
byã_code
.
buf
 + 
deföe_˛ass_pos
 + 1,

21981 
	`JS_DupAtom
(
s
->
˘x
, 
«me
));

21982 
fd
->
œ°_›code_pos
 = -1;

21984 
	}
}

21986 
	$£t_obje˘_«me_compuãd
(
JSP¨£Sèã
 *
s
)

21988 
JSFun˘i⁄Def
 *
fd
 = 
s
->
cur_func
;

21989 
›code
;

21991 
›code
 = 
	`gë_¥ev_›code
(
fd
);

21992 i‡(
›code
 =
OP_£t_«me
) {

21994 
fd
->
byã_code
.
size
 = fd->
œ°_›code_pos
;

21995 
fd
->
œ°_›code_pos
 = -1;

21996 
	`emô_›
(
s
, 
OP_£t_«me_compuãd
);

21997 } i‡(
›code
 =
OP_£t_˛ass_«me
) {

21998 
deföe_˛ass_pos
;

21999 
deföe_˛ass_pos
 = 
fd
->
œ°_›code_pos
 + 1 -

22000 
	`gë_u32
(
fd
->
byã_code
.
buf
 + fd->
œ°_›code_pos
 + 1);

22001 
	`as£π
(
fd
->
byã_code
.
buf
[
deföe_˛ass_pos
] =
OP_deföe_˛ass
);

22002 
fd
->
byã_code
.
buf
[
deföe_˛ass_pos
] = 
OP_deföe_˛ass_compuãd
;

22003 
fd
->
œ°_›code_pos
 = -1;

22005 
	}
}

22007 
__ex˚±i⁄
 
	$js_∑r£_obje˘_lôîÆ
(
JSP¨£Sèã
 *
s
)

22009 
JSAtom
 
«me
 = 
JS_ATOM_NULL
;

22010 c⁄° 
uöt8_t
 *
°¨t_±r
;

22011 
°¨t_löe
, 
¥›_ty≥
;

22012 
BOOL
 
has_¥Ÿo
;

22014 i‡(
	`√xt_tokí
(
s
))

22015 
Áû
;

22017 
	`emô_›
(
s
, 
OP_obje˘
);

22018 
has_¥Ÿo
 = 
FALSE
;

22019 
s
->
tokí
.
vÆ
 != '}') {

22021 
°¨t_±r
 = 
s
->
tokí
.
±r
;

22022 
°¨t_löe
 = 
s
->
tokí
.
löe_num
;

22024 i‡(
s
->
tokí
.
vÆ
 =
TOK_ELLIPSIS
) {

22025 i‡(
	`√xt_tokí
(
s
))

22027 i‡(
	`js_∑r£_assign_ex¥
(
s
, 
TRUE
))

22029 
	`emô_›
(
s
, 
OP_nuŒ
);

22030 
	`emô_›
(
s
, 
OP_c›y_d©a_¥›îtõs
);

22031 
	`emô_u8
(
s
, 2 | (1 << 2) | (0 << 5));

22032 
	`emô_›
(
s
, 
OP_dr›
);

22033 
	`emô_›
(
s
, 
OP_dr›
);

22034 
√xt
;

22037 
¥›_ty≥
 = 
	`js_∑r£_¥›îty_«me
(
s
, &
«me
, 
TRUE
, TRUE, 
FALSE
);

22038 i‡(
¥›_ty≥
 < 0)

22039 
Áû
;

22041 i‡(
¥›_ty≥
 =
PROP_TYPE_VAR
) {

22043 
	`emô_›
(
s
, 
OP_sc›e_gë_v¨
);

22044 
	`emô_©om
(
s
, 
«me
);

22045 
	`emô_u16
(
s
, s->
cur_func
->
sc›e_Àvñ
);

22046 
	`emô_›
(
s
, 
OP_deföe_fõld
);

22047 
	`emô_©om
(
s
, 
«me
);

22048 } i‡(
s
->
tokí
.
vÆ
 == '(') {

22049 
BOOL
 
is_gë£t
 = (
¥›_ty≥
 =
PROP_TYPE_GET
 ||

22050 
¥›_ty≥
 =
PROP_TYPE_SET
);

22051 
JSP¨£Fun˘i⁄Enum
 
func_ty≥
;

22052 
JSFun˘i⁄KödEnum
 
func_köd
;

22053 
›_Êags
;

22055 
func_köd
 = 
JS_FUNC_NORMAL
;

22056 i‡(
is_gë£t
) {

22057 
func_ty≥
 = 
JS_PARSE_FUNC_GETTER
 + 
¥›_ty≥
 - 
PROP_TYPE_GET
;

22059 
func_ty≥
 = 
JS_PARSE_FUNC_METHOD
;

22060 i‡(
¥›_ty≥
 =
PROP_TYPE_STAR
)

22061 
func_köd
 = 
JS_FUNC_GENERATOR
;

22062 i‡(
¥›_ty≥
 =
PROP_TYPE_ASYNC
)

22063 
func_köd
 = 
JS_FUNC_ASYNC
;

22064 i‡(
¥›_ty≥
 =
PROP_TYPE_ASYNC_STAR
)

22065 
func_köd
 = 
JS_FUNC_ASYNC_GENERATOR
;

22067 i‡(
	`js_∑r£_fun˘i⁄_de˛
(
s
, 
func_ty≥
, 
func_köd
, 
JS_ATOM_NULL
,

22068 
°¨t_±r
, 
°¨t_löe
))

22069 
Áû
;

22070 i‡(
«me
 =
JS_ATOM_NULL
) {

22071 
	`emô_›
(
s
, 
OP_deföe_mëhod_compuãd
);

22073 
	`emô_›
(
s
, 
OP_deföe_mëhod
);

22074 
	`emô_©om
(
s
, 
«me
);

22076 i‡(
is_gë£t
) {

22077 
›_Êags
 = 
OP_DEFINE_METHOD_GETTER
 +

22078 
¥›_ty≥
 - 
PROP_TYPE_GET
;

22080 
›_Êags
 = 
OP_DEFINE_METHOD_METHOD
;

22082 
	`emô_u8
(
s
, 
›_Êags
 | 
OP_DEFINE_METHOD_ENUMERABLE
);

22084 i‡(
	`js_∑r£_ex≥˘
(
s
, ':'))

22085 
Áû
;

22086 i‡(
	`js_∑r£_assign_ex¥
(
s
, 
TRUE
))

22087 
Áû
;

22088 i‡(
«me
 =
JS_ATOM_NULL
) {

22089 
	`£t_obje˘_«me_compuãd
(
s
);

22090 
	`emô_›
(
s
, 
OP_deföe_¨øy_ñ
);

22091 
	`emô_›
(
s
, 
OP_dr›
);

22092 } i‡(
«me
 =
JS_ATOM___¥Ÿo__
) {

22093 i‡(
has_¥Ÿo
) {

22094 
	`js_∑r£_îr‹
(
s
, "duplicate __proto__ÖropertyÇame");

22095 
Áû
;

22097 
	`emô_›
(
s
, 
OP_£t_¥Ÿo
);

22098 
has_¥Ÿo
 = 
TRUE
;

22100 
	`£t_obje˘_«me
(
s
, 
«me
);

22101 
	`emô_›
(
s
, 
OP_deföe_fõld
);

22102 
	`emô_©om
(
s
, 
«me
);

22105 
	`JS_FªeAtom
(
s
->
˘x
, 
«me
);

22106 
√xt
:

22107 
«me
 = 
JS_ATOM_NULL
;

22108 i‡(
s
->
tokí
.
vÆ
 != ',')

22110 i‡(
	`√xt_tokí
(
s
))

22111 
Áû
;

22113 i‡(
	`js_∑r£_ex≥˘
(
s
, '}'))

22114 
Áû
;

22116 
Áû
:

22117 
	`JS_FªeAtom
(
s
->
˘x
, 
«me
);

22119 
	}
}

22121 
__ex˚±i⁄
 
js_∑r£_po°fix_ex¥
(
JSP¨£Sèã
 *
s
,

22122 
BOOL
 
ac˚±_Õ¨í
);

22125 
__ex˚±i⁄
 
	$js_∑r£_˛ass_deÁu…_˘‹
(
JSP¨£Sèã
 *
s
,

22126 
BOOL
 
has_su≥r
,

22127 
JSFun˘i⁄Def
 **
pfd
)

22129 
JSP¨£Pos
 
pos
;

22130 c⁄° *
°r
;

22131 
ªt
, 
löe_num
;

22132 
JSP¨£Fun˘i⁄Enum
 
func_ty≥
;

22133 c⁄° 
uöt8_t
 *
ßved_buf_íd
;

22135 
	`js_∑r£_gë_pos
(
s
, &
pos
);

22136 i‡(
has_su≥r
) {

22137 
°r
 = "(...a){super(...a);}";

22138 
func_ty≥
 = 
JS_PARSE_FUNC_DERIVED_CLASS_CONSTRUCTOR
;

22140 
°r
 = "(){}";

22141 
func_ty≥
 = 
JS_PARSE_FUNC_CLASS_CONSTRUCTOR
;

22143 
löe_num
 = 
s
->
tokí
.line_num;

22144 
ßved_buf_íd
 = 
s
->
buf_íd
;

22145 
s
->
buf_±r
 = (
uöt8_t
 *)
°r
;

22146 
s
->
buf_íd
 = (
uöt8_t
 *)(
°r
 + 
	`°æí
(str));

22147 
ªt
 = 
	`√xt_tokí
(
s
);

22148 i‡(!
ªt
) {

22149 
ªt
 = 
	`js_∑r£_fun˘i⁄_de˛2
(
s
, 
func_ty≥
, 
JS_FUNC_NORMAL
,

22150 
JS_ATOM_NULL
, (
uöt8_t
 *)
°r
,

22151 
löe_num
, 
JS_PARSE_EXPORT_NONE
, 
pfd
);

22153 
s
->
buf_íd
 = 
ßved_buf_íd
;

22154 
ªt
 |
	`js_∑r£_£ek_tokí
(
s
, &
pos
);

22155  
ªt
;

22156 
	}
}

22159 
	$föd_¥iv©e_˛ass_fõld
(
JSC⁄ãxt
 *
˘x
, 
JSFun˘i⁄Def
 *
fd
,

22160 
JSAtom
 
«me
, 
sc›e_Àvñ
)

22162 
idx
;

22163 
idx
 = 
fd
->
sc›es
[
sc›e_Àvñ
].
fú°
;

22164 
idx
 != -1) {

22165 i‡(
fd
->
v¨s
[
idx
].
sc›e_Àvñ
 != scope_level)

22167 i‡(
fd
->
v¨s
[
idx
].
v¨_«me
 =
«me
)

22168  
idx
;

22169 
idx
 = 
fd
->
v¨s
[idx].
sc›e_√xt
;

22172 
	}
}

22177 
	$emô_˛ass_fõld_öô
(
JSP¨£Sèã
 *
s
)

22179 
œbñ_√xt
;

22181 
	`emô_›
(
s
, 
OP_sc›e_gë_v¨
);

22182 
	`emô_©om
(
s
, 
JS_ATOM_˛ass_fõlds_öô
);

22183 
	`emô_u16
(
s
, s->
cur_func
->
sc›e_Àvñ
);

22186 
	`emô_›
(
s
, 
OP_dup
);

22187 
œbñ_√xt
 = 
	`emô_gŸo
(
s
, 
OP_if_Ál£
, -1);

22189 
	`emô_›
(
s
, 
OP_sc›e_gë_v¨
);

22190 
	`emô_©om
(
s
, 
JS_ATOM_this
);

22191 
	`emô_u16
(
s
, 0);

22193 
	`emô_›
(
s
, 
OP_sw≠
);

22195 
	`emô_›
(
s
, 
OP_ˇŒ_mëhod
);

22196 
	`emô_u16
(
s
, 0);

22198 
	`emô_œbñ
(
s
, 
œbñ_√xt
);

22199 
	`emô_›
(
s
, 
OP_dr›
);

22200 
	}
}

22203 
JSAtom
 
	$gë_¥iv©e_£âî_«me
(
JSC⁄ãxt
 *
˘x
, 
JSAtom
 
«me
)

22205  
	`js_©om_c⁄ˇt_°r
(
˘x
, 
«me
, "<set>");

22206 
	}
}

22209 
JSFun˘i⁄Def
 *
	mfõlds_öô_fd
;

22210 
	mcompuãd_fõlds_cou¡
;

22211 
BOOL
 
	mhas_bønd
;

22212 
	mbønd_push_pos
;

22213 } 
	tCœssFõldsDef
;

22215 
__ex˚±i⁄
 
	$emô_˛ass_öô_°¨t
(
JSP¨£Sèã
 *
s
,

22216 
CœssFõldsDef
 *
cf
)

22218 
œbñ_add_bønd
;

22220 
cf
->
fõlds_öô_fd
 = 
	`js_∑r£_fun˘i⁄_˛ass_fõlds_öô
(
s
);

22221 i‡(!
cf
->
fõlds_öô_fd
)

22224 
s
->
cur_func
 = 
cf
->
fõlds_öô_fd
;

22228 
	`emô_›
(
s
, 
OP_push_Ál£
);

22229 
cf
->
bønd_push_pos
 = cf->
fõlds_öô_fd
->
œ°_›code_pos
;

22230 
œbñ_add_bønd
 = 
	`emô_gŸo
(
s
, 
OP_if_Ál£
, -1);

22232 
	`emô_›
(
s
, 
OP_sc›e_gë_v¨
);

22233 
	`emô_©om
(
s
, 
JS_ATOM_this
);

22234 
	`emô_u16
(
s
, 0);

22236 
	`emô_›
(
s
, 
OP_sc›e_gë_v¨
);

22237 
	`emô_©om
(
s
, 
JS_ATOM_home_obje˘
);

22238 
	`emô_u16
(
s
, 0);

22240 
	`emô_›
(
s
, 
OP_add_bønd
);

22242 
	`emô_œbñ
(
s
, 
œbñ_add_bønd
);

22244 
s
->
cur_func
 = s->cur_func->
∑ª¡
;

22246 
	}
}

22248 
__ex˚±i⁄
 
	$add_bønd
(
JSP¨£Sèã
 *
s
, 
CœssFõldsDef
 *
cf
)

22250 i‡(!
cf
->
has_bønd
) {

22252 i‡(!
cf
->
fõlds_öô_fd
) {

22253 i‡(
	`emô_˛ass_öô_°¨t
(
s
, 
cf
))

22257 
cf
->
fõlds_öô_fd
->
byã_code
.
buf
[cf->
bønd_push_pos
] = 
OP_push_åue
;

22259 
cf
->
has_bønd
 = 
TRUE
;

22262 
	}
}

22264 
	$emô_˛ass_öô_íd
(
JSP¨£Sèã
 *
s
, 
CœssFõldsDef
 *
cf
)

22266 
˝oﬁ_idx
;

22268 
s
->
cur_func
 = 
cf
->
fõlds_öô_fd
;

22269 
	`emô_›
(
s
, 
OP_ªtu∫_undef
);

22270 
s
->
cur_func
 = s->cur_func->
∑ª¡
;

22272 
˝oﬁ_idx
 = 
	`˝oﬁ_add
(
s
, 
JS_NULL
);

22273 
cf
->
fõlds_öô_fd
->
∑ª¡_˝oﬁ_idx
 = 
˝oﬁ_idx
;

22274 
	`emô_›
(
s
, 
OP_f˛osuª
);

22275 
	`emô_u32
(
s
, 
˝oﬁ_idx
);

22276 
	`emô_›
(
s
, 
OP_£t_home_obje˘
);

22277 
	}
}

22280 
__ex˚±i⁄
 
	$js_∑r£_˛ass
(
JSP¨£Sèã
 *
s
, 
BOOL
 
is_˛ass_ex¥
,

22281 
JSP¨£Exp‹tEnum
 
exp‹t_Êag
)

22283 
JSC⁄ãxt
 *
˘x
 = 
s
->ctx;

22284 
JSFun˘i⁄Def
 *
fd
 = 
s
->
cur_func
;

22285 
JSAtom
 
«me
 = 
JS_ATOM_NULL
, 
˛ass_«me
 = JS_ATOM_NULL, 
˛ass_«me1
;

22286 
JSAtom
 
˛ass_v¨_«me
 = 
JS_ATOM_NULL
;

22287 
JSFun˘i⁄Def
 *
mëhod_fd
, *
˘‹_fd
;

22288 
ßved_js_mode
, 
˛ass_«me_v¨_idx
, 
¥›_ty≥
, 
˘‹_˝oﬁ_off£t
;

22289 
˛ass_Êags
 = 0, 
i
, 
deföe_˛ass_off£t
;

22290 
BOOL
 
is_°©ic
, 
is_¥iv©e
;

22291 c⁄° 
uöt8_t
 *
˛ass_°¨t_±r
 = 
s
->
tokí
.
±r
;

22292 c⁄° 
uöt8_t
 *
°¨t_±r
;

22293 
CœssFõldsDef
 
˛ass_fõlds
[2];

22296 
ßved_js_mode
 = 
fd
->
js_mode
;

22297 
fd
->
js_mode
 |
JS_MODE_STRICT
;

22298 i‡(
	`√xt_tokí
(
s
))

22299 
Áû
;

22300 i‡(
s
->
tokí
.
vÆ
 =
TOK_IDENT
) {

22301 i‡(
s
->
tokí
.
u
.
idít
.
is_ª£rved
) {

22302 
	`js_∑r£_îr‹_ª£rved_idítifõr
(
s
);

22303 
Áû
;

22305 
˛ass_«me
 = 
	`JS_DupAtom
(
˘x
, 
s
->
tokí
.
u
.
idít
.
©om
);

22306 i‡(
	`√xt_tokí
(
s
))

22307 
Áû
;

22308 } i‡(!
is_˛ass_ex¥
 && 
exp‹t_Êag
 !
JS_PARSE_EXPORT_DEFAULT
) {

22309 
	`js_∑r£_îr‹
(
s
, "class statementÑequiresáÇame");

22310 
Áû
;

22312 i‡(!
is_˛ass_ex¥
) {

22313 i‡(
˛ass_«me
 =
JS_ATOM_NULL
)

22314 
˛ass_v¨_«me
 = 
JS_ATOM__deÁu…_
;

22316 
˛ass_v¨_«me
 = 
˛ass_«me
;

22317 
˛ass_v¨_«me
 = 
	`JS_DupAtom
(
˘x
, class_var_name);

22320 
	`push_sc›e
(
s
);

22322 i‡(
s
->
tokí
.
vÆ
 =
TOK_EXTENDS
) {

22323 
˛ass_Êags
 = 
JS_DEFINE_CLASS_HAS_HERITAGE
;

22324 i‡(
	`√xt_tokí
(
s
))

22325 
Áû
;

22327 i‡(
	`js_∑r£_po°fix_ex¥
(
s
, 
TRUE
))

22328 
Áû
;

22330 
	`emô_›
(
s
, 
OP_undeföed
);

22334 i‡(
˛ass_«me
 !
JS_ATOM_NULL
) {

22335 
˛ass_«me_v¨_idx
 = 
	`deföe_v¨
(
s
, 
fd
, 
˛ass_«me
, 
JS_VAR_DEF_CONST
);

22336 i‡(
˛ass_«me_v¨_idx
 < 0)

22337 
Áû
;

22340 i‡(
	`js_∑r£_ex≥˘
(
s
, '{'))

22341 
Áû
;

22344 
	`push_sc›e
(
s
);

22346 
	`emô_›
(
s
, 
OP_push_c⁄°
);

22347 
˘‹_˝oﬁ_off£t
 = 
fd
->
byã_code
.
size
;

22348 
	`emô_u32
(
s
, 0);

22350 i‡(
˛ass_«me
 =
JS_ATOM_NULL
) {

22351 i‡(
˛ass_v¨_«me
 !
JS_ATOM_NULL
)

22352 
˛ass_«me1
 = 
JS_ATOM_deÁu…
;

22354 
˛ass_«me1
 = 
JS_ATOM_em±y_°rög
;

22356 
˛ass_«me1
 = 
˛ass_«me
;

22359 
	`emô_›
(
s
, 
OP_deföe_˛ass
);

22360 
	`emô_©om
(
s
, 
˛ass_«me1
);

22361 
	`emô_u8
(
s
, 
˛ass_Êags
);

22362 
deföe_˛ass_off£t
 = 
fd
->
œ°_›code_pos
;

22364 
i
 = 0; i < 2; i++) {

22365 
CœssFõldsDef
 *
cf
 = &
˛ass_fõlds
[
i
];

22366 
cf
->
fõlds_öô_fd
 = 
NULL
;

22367 
cf
->
compuãd_fõlds_cou¡
 = 0;

22368 
cf
->
has_bønd
 = 
FALSE
;

22371 
˘‹_fd
 = 
NULL
;

22372 
s
->
tokí
.
vÆ
 != '}') {

22373 i‡(
s
->
tokí
.
vÆ
 == ';') {

22374 i‡(
	`√xt_tokí
(
s
))

22375 
Áû
;

22378 
is_°©ic
 = (
s
->
tokí
.
vÆ
 =
TOK_STATIC
);

22379 
¥›_ty≥
 = -1;

22380 i‡(
is_°©ic
) {

22381 i‡(
	`√xt_tokí
(
s
))

22382 
Áû
;

22384 i‡(
s
->
tokí
.
vÆ
 == ';' || s->token.val == '=') {

22385 
is_°©ic
 = 
FALSE
;

22386 
«me
 = 
	`JS_DupAtom
(
˘x
, 
JS_ATOM_°©ic
);

22387 
¥›_ty≥
 = 
PROP_TYPE_IDENT
;

22390 i‡(
is_°©ic
)

22391 
	`emô_›
(
s
, 
OP_sw≠
);

22392 
°¨t_±r
 = 
s
->
tokí
.
±r
;

22393 i‡(
¥›_ty≥
 < 0) {

22394 
¥›_ty≥
 = 
	`js_∑r£_¥›îty_«me
(
s
, &
«me
, 
TRUE
, 
FALSE
, TRUE);

22395 i‡(
¥›_ty≥
 < 0)

22396 
Áû
;

22398 
is_¥iv©e
 = 
¥›_ty≥
 & 
PROP_TYPE_PRIVATE
;

22399 
¥›_ty≥
 &~
PROP_TYPE_PRIVATE
;

22401 i‡((
«me
 =
JS_ATOM_c⁄°ru˘‹
 && !
is_°©ic
 &&

22402 
¥›_ty≥
 !
PROP_TYPE_IDENT
) ||

22403 (
«me
 =
JS_ATOM_¥ŸŸy≥
 && 
is_°©ic
) ||

22404 
«me
 =
JS_ATOM_hash_c⁄°ru˘‹
) {

22405 
	`js_∑r£_îr‹
(
s
, "invalid methodÇame");

22406 
Áû
;

22408 i‡(
¥›_ty≥
 =
PROP_TYPE_GET
 ||Ör›_ty≥ =
PROP_TYPE_SET
) {

22409 
BOOL
 
is_£t
 = 
¥›_ty≥
 - 
PROP_TYPE_GET
;

22410 
JSFun˘i⁄Def
 *
mëhod_fd
;

22412 i‡(
is_¥iv©e
) {

22413 
idx
, 
v¨_köd
;

22414 
idx
 = 
	`föd_¥iv©e_˛ass_fõld
(
˘x
, 
fd
, 
«me
, fd->
sc›e_Àvñ
);

22415 i‡(
idx
 >= 0) {

22416 
v¨_köd
 = 
fd
->
v¨s
[
idx
].var_kind;

22417 i‡(
v¨_köd
 =
JS_VAR_PRIVATE_FIELD
 ||

22418 
v¨_köd
 =
JS_VAR_PRIVATE_METHOD
 ||

22419 
v¨_köd
 =
JS_VAR_PRIVATE_GETTER_SETTER
 ||

22420 
v¨_köd
 =(
JS_VAR_PRIVATE_GETTER
 + 
is_£t
)) {

22421 
¥iv©e_fõld_Æªady_deföed
;

22423 
fd
->
v¨s
[
idx
].
v¨_köd
 = 
JS_VAR_PRIVATE_GETTER_SETTER
;

22425 i‡(
	`add_¥iv©e_˛ass_fõld
(
s
, 
fd
, 
«me
,

22426 
JS_VAR_PRIVATE_GETTER
 + 
is_£t
) < 0)

22427 
Áû
;

22429 i‡(
	`add_bønd
(
s
, &
˛ass_fõlds
[
is_°©ic
]) < 0)

22430 
Áû
;

22433 i‡(
	`js_∑r£_fun˘i⁄_de˛2
(
s
, 
JS_PARSE_FUNC_GETTER
 + 
is_£t
,

22434 
JS_FUNC_NORMAL
, 
JS_ATOM_NULL
,

22435 
°¨t_±r
, 
s
->
tokí
.
löe_num
,

22436 
JS_PARSE_EXPORT_NONE
, &
mëhod_fd
))

22437 
Áû
;

22438 i‡(
is_¥iv©e
) {

22439 
mëhod_fd
->
√ed_home_obje˘
 = 
TRUE
;

22440 
	`emô_›
(
s
, 
OP_£t_home_obje˘
);

22442 
	`emô_›
(
s
, 
OP_sc›e_put_v¨_öô
);

22443 i‡(
is_£t
) {

22444 
JSAtom
 
£âî_«me
;

22445 
ªt
;

22447 
£âî_«me
 = 
	`gë_¥iv©e_£âî_«me
(
˘x
, 
«me
);

22448 i‡(
£âî_«me
 =
JS_ATOM_NULL
)

22449 
Áû
;

22450 
	`emô_©om
(
s
, 
£âî_«me
);

22451 
ªt
 = 
	`add_¥iv©e_˛ass_fõld
(
s
, 
fd
, 
£âî_«me
,

22452 
JS_VAR_PRIVATE_SETTER
);

22453 
	`JS_FªeAtom
(
˘x
, 
£âî_«me
);

22454 i‡(
ªt
 < 0)

22455 
Áû
;

22457 
	`emô_©om
(
s
, 
«me
);

22459 
	`emô_u16
(
s
, s->
cur_func
->
sc›e_Àvñ
);

22461 i‡(
«me
 =
JS_ATOM_NULL
) {

22462 
	`emô_›
(
s
, 
OP_deföe_mëhod_compuãd
);

22464 
	`emô_›
(
s
, 
OP_deföe_mëhod
);

22465 
	`emô_©om
(
s
, 
«me
);

22467 
	`emô_u8
(
s
, 
OP_DEFINE_METHOD_GETTER
 + 
is_£t
);

22469 } i‡(
¥›_ty≥
 =
PROP_TYPE_IDENT
 && 
s
->
tokí
.
vÆ
 != '(') {

22470 
CœssFõldsDef
 *
cf
 = &
˛ass_fõlds
[
is_°©ic
];

22471 
JSAtom
 
fõld_v¨_«me
 = 
JS_ATOM_NULL
;

22476 i‡(
«me
 =
JS_ATOM_c⁄°ru˘‹
 ||Çamê=
JS_ATOM_¥ŸŸy≥
) {

22477 
	`js_∑r£_îr‹
(
s
, "invalid fieldÇame");

22478 
Áû
;

22481 i‡(
is_¥iv©e
) {

22482 i‡(
	`föd_¥iv©e_˛ass_fõld
(
˘x
, 
fd
, 
«me
,

22483 
fd
->
sc›e_Àvñ
) >= 0) {

22484 
¥iv©e_fõld_Æªady_deföed
;

22486 i‡(
	`add_¥iv©e_˛ass_fõld
(
s
, 
fd
, 
«me
,

22487 
JS_VAR_PRIVATE_FIELD
) < 0)

22488 
Áû
;

22489 
	`emô_›
(
s
, 
OP_¥iv©e_symbﬁ
);

22490 
	`emô_©om
(
s
, 
«me
);

22491 
	`emô_›
(
s
, 
OP_sc›e_put_v¨_öô
);

22492 
	`emô_©om
(
s
, 
«me
);

22493 
	`emô_u16
(
s
, s->
cur_func
->
sc›e_Àvñ
);

22496 i‡(!
cf
->
fõlds_öô_fd
) {

22497 i‡(
	`emô_˛ass_öô_°¨t
(
s
, 
cf
))

22498 
Áû
;

22500 i‡(
«me
 =
JS_ATOM_NULL
 ) {

22502 
fõld_v¨_«me
 = 
	`js_©om_c⁄ˇt_num
(
˘x
, 
JS_ATOM_compuãd_fõld
 + 
is_°©ic
, 
cf
->
compuãd_fõlds_cou¡
);

22503 i‡(
fõld_v¨_«me
 =
JS_ATOM_NULL
)

22504 
Áû
;

22505 i‡(
	`deföe_v¨
(
s
, 
fd
, 
fõld_v¨_«me
, 
JS_VAR_DEF_CONST
) < 0) {

22506 
	`JS_FªeAtom
(
˘x
, 
fõld_v¨_«me
);

22507 
Áû
;

22509 
	`emô_›
(
s
, 
OP_to_¥›key
);

22510 
	`emô_›
(
s
, 
OP_sc›e_put_v¨_öô
);

22511 
	`emô_©om
(
s
, 
fõld_v¨_«me
);

22512 
	`emô_u16
(
s
, s->
cur_func
->
sc›e_Àvñ
);

22514 
s
->
cur_func
 = 
cf
->
fõlds_öô_fd
;

22515 
	`emô_›
(
s
, 
OP_sc›e_gë_v¨
);

22516 
	`emô_©om
(
s
, 
JS_ATOM_this
);

22517 
	`emô_u16
(
s
, 0);

22519 i‡(
«me
 =
JS_ATOM_NULL
) {

22520 
	`emô_›
(
s
, 
OP_sc›e_gë_v¨
);

22521 
	`emô_©om
(
s
, 
fõld_v¨_«me
);

22522 
	`emô_u16
(
s
, s->
cur_func
->
sc›e_Àvñ
);

22523 
cf
->
compuãd_fõlds_cou¡
++;

22524 
	`JS_FªeAtom
(
˘x
, 
fõld_v¨_«me
);

22525 } i‡(
is_¥iv©e
) {

22526 
	`emô_›
(
s
, 
OP_sc›e_gë_v¨
);

22527 
	`emô_©om
(
s
, 
«me
);

22528 
	`emô_u16
(
s
, s->
cur_func
->
sc›e_Àvñ
);

22531 i‡(
s
->
tokí
.
vÆ
 == '=') {

22532 i‡(
	`√xt_tokí
(
s
))

22533 
Áû
;

22534 i‡(
	`js_∑r£_assign_ex¥
(
s
, 
TRUE
))

22535 
Áû
;

22537 
	`emô_›
(
s
, 
OP_undeföed
);

22539 i‡(
is_¥iv©e
) {

22540 
	`£t_obje˘_«me_compuãd
(
s
);

22541 
	`emô_›
(
s
, 
OP_deföe_¥iv©e_fõld
);

22542 } i‡(
«me
 =
JS_ATOM_NULL
) {

22543 
	`£t_obje˘_«me_compuãd
(
s
);

22544 
	`emô_›
(
s
, 
OP_deföe_¨øy_ñ
);

22545 
	`emô_›
(
s
, 
OP_dr›
);

22547 
	`£t_obje˘_«me
(
s
, 
«me
);

22548 
	`emô_›
(
s
, 
OP_deföe_fõld
);

22549 
	`emô_©om
(
s
, 
«me
);

22551 
s
->
cur_func
 = s->cur_func->
∑ª¡
;

22552 i‡(
	`js_∑r£_ex≥˘_£mi
(
s
))

22553 
Áû
;

22555 
JSP¨£Fun˘i⁄Enum
 
func_ty≥
;

22556 
JSFun˘i⁄KödEnum
 
func_köd
;

22558 
func_ty≥
 = 
JS_PARSE_FUNC_METHOD
;

22559 
func_köd
 = 
JS_FUNC_NORMAL
;

22560 i‡(
¥›_ty≥
 =
PROP_TYPE_STAR
) {

22561 
func_köd
 = 
JS_FUNC_GENERATOR
;

22562 } i‡(
¥›_ty≥
 =
PROP_TYPE_ASYNC
) {

22563 
func_köd
 = 
JS_FUNC_ASYNC
;

22564 } i‡(
¥›_ty≥
 =
PROP_TYPE_ASYNC_STAR
) {

22565 
func_köd
 = 
JS_FUNC_ASYNC_GENERATOR
;

22566 } i‡(
«me
 =
JS_ATOM_c⁄°ru˘‹
 && !
is_°©ic
) {

22567 i‡(
˘‹_fd
) {

22568 
	`js_∑r£_îr‹
(
s
, "property constructoráppears moreÅhan once");

22569 
Áû
;

22571 i‡(
˛ass_Êags
 & 
JS_DEFINE_CLASS_HAS_HERITAGE
)

22572 
func_ty≥
 = 
JS_PARSE_FUNC_DERIVED_CLASS_CONSTRUCTOR
;

22574 
func_ty≥
 = 
JS_PARSE_FUNC_CLASS_CONSTRUCTOR
;

22576 i‡(
is_¥iv©e
) {

22577 i‡(
	`add_bønd
(
s
, &
˛ass_fõlds
[
is_°©ic
]) < 0)

22578 
Áû
;

22580 i‡(
	`js_∑r£_fun˘i⁄_de˛2
(
s
, 
func_ty≥
, 
func_köd
, 
JS_ATOM_NULL
, 
°¨t_±r
, s->
tokí
.
löe_num
, 
JS_PARSE_EXPORT_NONE
, &
mëhod_fd
))

22581 
Áû
;

22582 i‡(
func_ty≥
 =
JS_PARSE_FUNC_DERIVED_CLASS_CONSTRUCTOR
 ||

22583 
func_ty≥
 =
JS_PARSE_FUNC_CLASS_CONSTRUCTOR
) {

22584 
˘‹_fd
 = 
mëhod_fd
;

22585 } i‡(
is_¥iv©e
) {

22586 
mëhod_fd
->
√ed_home_obje˘
 = 
TRUE
;

22587 i‡(
	`föd_¥iv©e_˛ass_fõld
(
˘x
, 
fd
, 
«me
,

22588 
fd
->
sc›e_Àvñ
) >= 0) {

22589 
¥iv©e_fõld_Æªady_deföed
:

22590 
	`js_∑r£_îr‹
(
s
, "private class field isálready defined");

22591 
Áû
;

22593 i‡(
	`add_¥iv©e_˛ass_fõld
(
s
, 
fd
, 
«me
,

22594 
JS_VAR_PRIVATE_METHOD
) < 0)

22595 
Áû
;

22596 
	`emô_›
(
s
, 
OP_£t_home_obje˘
);

22597 
	`emô_›
(
s
, 
OP_£t_«me
);

22598 
	`emô_©om
(
s
, 
«me
);

22599 
	`emô_›
(
s
, 
OP_sc›e_put_v¨_öô
);

22600 
	`emô_©om
(
s
, 
«me
);

22601 
	`emô_u16
(
s
, s->
cur_func
->
sc›e_Àvñ
);

22603 i‡(
«me
 =
JS_ATOM_NULL
) {

22604 
	`emô_›
(
s
, 
OP_deföe_mëhod_compuãd
);

22606 
	`emô_›
(
s
, 
OP_deföe_mëhod
);

22607 
	`emô_©om
(
s
, 
«me
);

22609 
	`emô_u8
(
s
, 
OP_DEFINE_METHOD_METHOD
);

22612 i‡(
is_°©ic
)

22613 
	`emô_›
(
s
, 
OP_sw≠
);

22614 
	`JS_FªeAtom
(
˘x
, 
«me
);

22615 
«me
 = 
JS_ATOM_NULL
;

22618 i‡(
s
->
tokí
.
vÆ
 != '}') {

22619 
	`js_∑r£_îr‹
(
s
, "expecting '%c'", '}');

22620 
Áû
;

22623 i‡(!
˘‹_fd
) {

22624 i‡(
	`js_∑r£_˛ass_deÁu…_˘‹
(
s
, 
˛ass_Êags
 & 
JS_DEFINE_CLASS_HAS_HERITAGE
, &
˘‹_fd
))

22625 
Áû
;

22628 
	`put_u32
(
fd
->
byã_code
.
buf
 + 
˘‹_˝oﬁ_off£t
, 
˘‹_fd
->
∑ª¡_˝oﬁ_idx
);

22631 i‡(!(
fd
->
js_mode
 & 
JS_MODE_STRIP
)) {

22632 
	`js_‰ì
(
˘x
, 
˘‹_fd
->
sour˚
);

22633 
˘‹_fd
->
sour˚_Àn
 = 
s
->
buf_±r
 - 
˛ass_°¨t_±r
;

22634 
˘‹_fd
->
sour˚
 = 
	`js_°∫dup
(
˘x
, (c⁄° *)
˛ass_°¨t_±r
,

22635 
˘‹_fd
->
sour˚_Àn
);

22636 i‡(!
˘‹_fd
->
sour˚
)

22637 
Áû
;

22641 i‡(
	`√xt_tokí
(
s
))

22642 
Áû
;

22647 
CœssFõldsDef
 *
cf
 = &
˛ass_fõlds
[0];

22648 
v¨_idx
;

22650 
v¨_idx
 = 
	`deföe_v¨
(
s
, 
fd
, 
JS_ATOM_˛ass_fõlds_öô
,

22651 
JS_VAR_DEF_CONST
);

22652 i‡(
v¨_idx
 < 0)

22653 
Áû
;

22654 i‡(
cf
->
fõlds_öô_fd
) {

22655 
	`emô_˛ass_öô_íd
(
s
, 
cf
);

22657 
	`emô_›
(
s
, 
OP_undeföed
);

22659 
	`emô_›
(
s
, 
OP_sc›e_put_v¨_öô
);

22660 
	`emô_©om
(
s
, 
JS_ATOM_˛ass_fõlds_öô
);

22661 
	`emô_u16
(
s
, s->
cur_func
->
sc›e_Àvñ
);

22665 
	`emô_›
(
s
, 
OP_dr›
);

22668 i‡(
˛ass_fõlds
[1].
fõlds_öô_fd
 !
NULL
) {

22669 
CœssFõldsDef
 *
cf
 = &
˛ass_fõlds
[1];

22670 
	`emô_›
(
s
, 
OP_dup
);

22671 
	`emô_˛ass_öô_íd
(
s
, 
cf
);

22672 
	`emô_›
(
s
, 
OP_ˇŒ_mëhod
);

22673 
	`emô_u16
(
s
, 0);

22674 
	`emô_›
(
s
, 
OP_dr›
);

22677 i‡(
˛ass_«me
 !
JS_ATOM_NULL
) {

22681 
	`emô_›
(
s
, 
OP_dup
);

22682 
	`emô_›
(
s
, 
OP_sc›e_put_v¨_öô
);

22683 
	`emô_©om
(
s
, 
˛ass_«me
);

22684 
	`emô_u16
(
s
, 
fd
->
sc›e_Àvñ
);

22686 
	`p›_sc›e
(
s
);

22687 
	`p›_sc›e
(
s
);

22690 i‡(
˛ass_v¨_«me
 !
JS_ATOM_NULL
) {

22691 i‡(
	`deföe_v¨
(
s
, 
fd
, 
˛ass_v¨_«me
, 
JS_VAR_DEF_LET
) < 0)

22692 
Áû
;

22693 
	`emô_›
(
s
, 
OP_sc›e_put_v¨_öô
);

22694 
	`emô_©om
(
s
, 
˛ass_v¨_«me
);

22695 
	`emô_u16
(
s
, 
fd
->
sc›e_Àvñ
);

22697 i‡(
˛ass_«me
 =
JS_ATOM_NULL
) {

22701 
	`emô_›
(
s
, 
OP_£t_˛ass_«me
);

22702 
	`emô_u32
(
s
, 
fd
->
œ°_›code_pos
 + 1 - 
deföe_˛ass_off£t
);

22706 i‡(
exp‹t_Êag
 !
JS_PARSE_EXPORT_NONE
) {

22707 i‡(!
	`add_exp‹t_íåy
(
s
, 
fd
->
moduÀ
,

22708 
˛ass_v¨_«me
,

22709 
exp‹t_Êag
 =
JS_PARSE_EXPORT_NAMED
 ? 
˛ass_v¨_«me
 : 
JS_ATOM_deÁu…
,

22710 
JS_EXPORT_TYPE_LOCAL
))

22711 
Áû
;

22714 
	`JS_FªeAtom
(
˘x
, 
˛ass_«me
);

22715 
	`JS_FªeAtom
(
˘x
, 
˛ass_v¨_«me
);

22716 
fd
->
js_mode
 = 
ßved_js_mode
;

22718 
Áû
:

22719 
	`JS_FªeAtom
(
˘x
, 
«me
);

22720 
	`JS_FªeAtom
(
˘x
, 
˛ass_«me
);

22721 
	`JS_FªeAtom
(
˘x
, 
˛ass_v¨_«me
);

22722 
fd
->
js_mode
 = 
ßved_js_mode
;

22724 
	}
}

22726 
__ex˚±i⁄
 
	$js_∑r£_¨øy_lôîÆ
(
JSP¨£Sèã
 *
s
)

22728 
uöt32_t
 
idx
;

22729 
BOOL
 
√ed_Àngth
;

22731 i‡(
	`√xt_tokí
(
s
))

22734 
idx
 = 0;

22735 
s
->
tokí
.
vÆ
 !']' && 
idx
 < 32) {

22736 i‡(
s
->
tokí
.
vÆ
 =',' || s->tokí.vÆ =
TOK_ELLIPSIS
)

22738 i‡(
	`js_∑r£_assign_ex¥
(
s
, 
TRUE
))

22740 
idx
++;

22742 i‡(
s
->
tokí
.
vÆ
 == ',') {

22743 i‡(
	`√xt_tokí
(
s
))

22746 i‡(
s
->
tokí
.
vÆ
 != ']')

22747 
d⁄e
;

22749 
	`emô_›
(
s
, 
OP_¨øy_‰om
);

22750 
	`emô_u16
(
s
, 
idx
);

22753 
√ed_Àngth
 = 
FALSE
;

22754 
s
->
tokí
.
vÆ
 !']' && 
idx
 < 0x7fffffff) {

22755 i‡(
s
->
tokí
.
vÆ
 =
TOK_ELLIPSIS
)

22757 
√ed_Àngth
 = 
TRUE
;

22758 i‡(
s
->
tokí
.
vÆ
 != ',') {

22759 i‡(
	`js_∑r£_assign_ex¥
(
s
, 
TRUE
))

22761 
	`emô_›
(
s
, 
OP_deföe_fõld
);

22762 
	`emô_u32
(
s
, 
	`__JS_AtomFromUI¡32
(
idx
));

22763 
√ed_Àngth
 = 
FALSE
;

22765 
idx
++;

22767 i‡(
s
->
tokí
.
vÆ
 == ',') {

22768 i‡(
	`√xt_tokí
(
s
))

22772 i‡(
s
->
tokí
.
vÆ
 == ']') {

22773 i‡(
√ed_Àngth
) {

22776 
	`emô_›
(
s
, 
OP_dup
);

22777 
	`emô_›
(
s
, 
OP_push_i32
);

22778 
	`emô_u32
(
s
, 
idx
);

22779 
	`emô_›
(
s
, 
OP_put_fõld
);

22780 
	`emô_©om
(
s
, 
JS_ATOM_Àngth
);

22782 
d⁄e
;

22786 
	`emô_›
(
s
, 
OP_push_i32
);

22787 
	`emô_u32
(
s
, 
idx
);

22790 
s
->
tokí
.
vÆ
 != ']') {

22791 i‡(
s
->
tokí
.
vÆ
 =
TOK_ELLIPSIS
) {

22792 i‡(
	`√xt_tokí
(
s
))

22794 i‡(
	`js_∑r£_assign_ex¥
(
s
, 
TRUE
))

22797 
	`emô_›
(
s
, 
OP_≠≥nd
);

22799 
œbñ_√xt
, 
œbñ_d⁄e
;

22800 
œbñ_√xt
 = 
	`√w_œbñ
(
s
);

22801 
œbñ_d⁄e
 = 
	`√w_œbñ
(
s
);

22803 
	`emô_›
(
s
, 
OP_f‹_of_°¨t
);

22804 
	`emô_›
(
s
, 
OP_rŸ5l
);

22805 
	`emô_›
(
s
, 
OP_rŸ5l
);

22806 
	`emô_œbñ
(
s
, 
œbñ_√xt
);

22808 
	`emô_›
(
s
, 
OP_f‹_of_√xt
);

22809 
	`emô_u8
(
s
, 2);

22810 
	`emô_gŸo
(
s
, 
OP_if_åue
, 
œbñ_d⁄e
);

22813 
	`emô_›
(
s
, 
OP_deföe_¨øy_ñ
);

22814 
	`emô_›
(
s
, 
OP_öc
);

22815 
	`emô_gŸo
(
s
, 
OP_gŸo
, 
œbñ_√xt
);

22816 
	`emô_œbñ
(
s
, 
œbñ_d⁄e
);

22818 
	`emô_›
(
s
, 
OP_dr›
);

22819 
	`emô_›
(
s
, 
OP_nù1
);

22820 
	`emô_›
(
s
, 
OP_nù1
);

22821 
	`emô_›
(
s
, 
OP_nù1
);

22824 
√ed_Àngth
 = 
TRUE
;

22825 i‡(
s
->
tokí
.
vÆ
 != ',') {

22826 i‡(
	`js_∑r£_assign_ex¥
(
s
, 
TRUE
))

22829 
	`emô_›
(
s
, 
OP_deföe_¨øy_ñ
);

22830 
√ed_Àngth
 = 
FALSE
;

22832 
	`emô_›
(
s
, 
OP_öc
);

22834 i‡(
s
->
tokí
.
vÆ
 != ',')

22836 i‡(
	`√xt_tokí
(
s
))

22839 i‡(
√ed_Àngth
) {

22842 
	`emô_›
(
s
, 
OP_dup1
);

22843 
	`emô_›
(
s
, 
OP_put_fõld
);

22844 
	`emô_©om
(
s
, 
JS_ATOM_Àngth
);

22846 
	`emô_›
(
s
, 
OP_dr›
);

22848 
d⁄e
:

22849  
	`js_∑r£_ex≥˘
(
s
, ']');

22850 
	}
}

22853 
BOOL
 
	$has_wôh_sc›e
(
JSFun˘i⁄Def
 *
s
, 
sc›e_Àvñ
)

22856 
s
) {

22857 
sc›e_idx
 = 
s
->
sc›es
[
sc›e_Àvñ
].
fú°
;

22858 
sc›e_idx
 >= 0) {

22859 
JSV¨Def
 *
vd
 = &
s
->
v¨s
[
sc›e_idx
];

22861 i‡(
vd
->
v¨_«me
 =
JS_ATOM__wôh_
)

22862  
TRUE
;

22863 
sc›e_idx
 = 
vd
->
sc›e_√xt
;

22866 
sc›e_Àvñ
 = 
s
->
∑ª¡_sc›e_Àvñ
;

22867 
s
 = s->
∑ª¡
;

22869  
FALSE
;

22870 
	}
}

22872 
	sJSLVÆue
 {

22873 
	m›code
;

22874 
	msc›e
;

22875 
	mœbñ
;

22876 
	mdïth
;

22877 
	mtok
;

22878 
JSAtom
 
	m«me
;

22879 } 
	tJSLVÆue
;

22881 
__ex˚±i⁄
 
	$gë_lvÆue
(
JSP¨£Sèã
 *
s
, *
p›code
, *
psc›e
,

22882 
JSAtom
 *
≤ame
, *
∂abñ
, *
pdïth
, 
BOOL
 
kìp
,

22883 
tok
)

22885 
JSFun˘i⁄Def
 *
fd
;

22886 
›code
, 
sc›e
, 
œbñ
, 
dïth
;

22887 
JSAtom
 
«me
;

22890 
fd
 = 
s
->
cur_func
;

22891 
sc›e
 = 0;

22892 
«me
 = 
JS_ATOM_NULL
;

22893 
œbñ
 = -1;

22894 
dïth
 = 0;

22895 
›code
 = 
	`gë_¥ev_›code
(
fd
)) {

22896 
OP_sc›e_gë_v¨
:

22897 
«me
 = 
	`gë_u32
(
fd
->
byã_code
.
buf
 + fd->
œ°_›code_pos
 + 1);

22898 
sc›e
 = 
	`gë_u16
(
fd
->
byã_code
.
buf
 + fd->
œ°_›code_pos
 + 5);

22899 i‡((
«me
 =
JS_ATOM_¨gumíts
 ||Çamê=
JS_ATOM_evÆ
) &&

22900 (
fd
->
js_mode
 & 
JS_MODE_STRICT
)) {

22901  
	`js_∑r£_îr‹
(
s
, "invalidÜvalue in strict mode");

22903 i‡(
«me
 =
JS_ATOM_this
 ||Çamê=
JS_ATOM_√w_èrgë
)

22904 
övÆid_lvÆue
;

22905 
dïth
 = 2;

22907 
OP_gë_fõld
:

22908 
«me
 = 
	`gë_u32
(
fd
->
byã_code
.
buf
 + fd->
œ°_›code_pos
 + 1);

22909 
dïth
 = 1;

22911 
OP_sc›e_gë_¥iv©e_fõld
:

22912 
«me
 = 
	`gë_u32
(
fd
->
byã_code
.
buf
 + fd->
œ°_›code_pos
 + 1);

22913 
sc›e
 = 
	`gë_u16
(
fd
->
byã_code
.
buf
 + fd->
œ°_›code_pos
 + 5);

22914 
dïth
 = 1;

22916 
OP_gë_¨øy_ñ
:

22917 
dïth
 = 2;

22919 
OP_gë_su≥r_vÆue
:

22920 
dïth
 = 3;

22923 
övÆid_lvÆue
:

22924 i‡(
tok
 =
TOK_FOR
) {

22925  
	`js_∑r£_îr‹
(
s
, "invalid for in/ofÜeft hand-side");

22926 } i‡(
tok
 =
TOK_INC
 ||Åok =
TOK_DEC
) {

22927  
	`js_∑r£_îr‹
(
s
, "invalid increment/decrement operand");

22928 } i‡(
tok
 == '[' ||Åok == '{') {

22929  
	`js_∑r£_îr‹
(
s
, "invalid destructuringÅarget");

22931  
	`js_∑r£_îr‹
(
s
, "invalidássignmentÜeft-hand side");

22935 
fd
->
byã_code
.
size
 = fd->
œ°_›code_pos
;

22936 
fd
->
œ°_›code_pos
 = -1;

22938 i‡(
kìp
) {

22940 
›code
) {

22941 
OP_sc›e_gë_v¨
:

22942 
œbñ
 = 
	`√w_œbñ
(
s
);

22943 
	`emô_›
(
s
, 
OP_sc›e_make_ªf
);

22944 
	`emô_©om
(
s
, 
«me
);

22945 
	`emô_u32
(
s
, 
œbñ
);

22946 
	`emô_u16
(
s
, 
sc›e
);

22947 
	`upd©e_œbñ
(
fd
, 
œbñ
, 1);

22948 
	`emô_›
(
s
, 
OP_gë_ªf_vÆue
);

22949 
›code
 = 
OP_gë_ªf_vÆue
;

22951 
OP_gë_fõld
:

22952 
	`emô_›
(
s
, 
OP_gë_fõld2
);

22953 
	`emô_©om
(
s
, 
«me
);

22955 
OP_sc›e_gë_¥iv©e_fõld
:

22956 
	`emô_›
(
s
, 
OP_sc›e_gë_¥iv©e_fõld2
);

22957 
	`emô_©om
(
s
, 
«me
);

22958 
	`emô_u16
(
s
, 
sc›e
);

22960 
OP_gë_¨øy_ñ
:

22962 
	`emô_›
(
s
, 
OP_to_¥›key2
);

22963 
	`emô_›
(
s
, 
OP_dup2
);

22964 
	`emô_›
(
s
, 
OP_gë_¨øy_ñ
);

22966 
OP_gë_su≥r_vÆue
:

22967 
	`emô_›
(
s
, 
OP_to_¥›key
);

22968 
	`emô_›
(
s
, 
OP_dup3
);

22969 
	`emô_›
(
s
, 
OP_gë_su≥r_vÆue
);

22972 
	`ab‹t
();

22975 
›code
) {

22976 
OP_sc›e_gë_v¨
:

22977 
œbñ
 = 
	`√w_œbñ
(
s
);

22978 
	`emô_›
(
s
, 
OP_sc›e_make_ªf
);

22979 
	`emô_©om
(
s
, 
«me
);

22980 
	`emô_u32
(
s
, 
œbñ
);

22981 
	`emô_u16
(
s
, 
sc›e
);

22982 
	`upd©e_œbñ
(
fd
, 
œbñ
, 1);

22983 
›code
 = 
OP_gë_ªf_vÆue
;

22985 
OP_gë_¨øy_ñ
:

22986 
	`emô_›
(
s
, 
OP_to_¥›key2
);

22988 
OP_gë_su≥r_vÆue
:

22989 
	`emô_›
(
s
, 
OP_to_¥›key
);

22994 *
p›code
 = 
›code
;

22995 *
psc›e
 = 
sc›e
;

22998 *
≤ame
 = 
«me
;

22999 *
∂abñ
 = 
œbñ
;

23000 i‡(
pdïth
)

23001 *
pdïth
 = 
dïth
;

23003 
	}
}

23007 
	$put_lvÆue
(
JSP¨£Sèã
 *
s
, 
›code
, 
sc›e
,

23008 
JSAtom
 
«me
, 
œbñ
, 
BOOL
 
•ecül
)

23010 
›code
) {

23011 
OP_gë_fõld
:

23012 i‡(!
•ecül
)

23013 
	`emô_›
(
s
, 
OP_ö£π2
);

23015 
	`emô_›
(
s
, 
OP_≥rm3
);

23016 
	`emô_›
(
s
, 
OP_put_fõld
);

23017 
	`emô_u32
(
s
, 
«me
);

23019 
OP_sc›e_gë_¥iv©e_fõld
:

23020 i‡(!
•ecül
)

23021 
	`emô_›
(
s
, 
OP_ö£π2
);

23023 
	`emô_›
(
s
, 
OP_≥rm3
);

23024 
	`emô_›
(
s
, 
OP_sc›e_put_¥iv©e_fõld
);

23025 
	`emô_u32
(
s
, 
«me
);

23026 
	`emô_u16
(
s
, 
sc›e
);

23028 
OP_gë_¨øy_ñ
:

23029 i‡(!
•ecül
)

23030 
	`emô_›
(
s
, 
OP_ö£π3
);

23032 
	`emô_›
(
s
, 
OP_≥rm4
);

23033 
	`emô_›
(
s
, 
OP_put_¨øy_ñ
);

23035 
OP_gë_ªf_vÆue
:

23036 
	`JS_FªeAtom
(
s
->
˘x
, 
«me
);

23037 
	`emô_œbñ
(
s
, 
œbñ
);

23038 i‡(!
•ecül
)

23039 
	`emô_›
(
s
, 
OP_ö£π3
);

23041 
	`emô_›
(
s
, 
OP_≥rm4
);

23042 
	`emô_›
(
s
, 
OP_put_ªf_vÆue
);

23044 
OP_gë_su≥r_vÆue
:

23045 i‡(!
•ecül
)

23046 
	`emô_›
(
s
, 
OP_ö£π4
);

23048 
	`emô_›
(
s
, 
OP_≥rm5
);

23049 
	`emô_›
(
s
, 
OP_put_su≥r_vÆue
);

23052 
	`ab‹t
();

23054 
	}
}

23056 
	$put_lvÆue_nokìp
(
JSP¨£Sèã
 *
s
, 
›code
, 
sc›e
,

23057 
JSAtom
 
«me
, 
œbñ
, 
v¨_tok
)

23059 
›code
) {

23060 
OP_sc›e_gë_v¨
:

23061 
	`emô_›
(
s
, (
v¨_tok
 =
TOK_CONST
 || v¨_tok =
TOK_LET
) ?

23062 
OP_sc›e_put_v¨_öô
 : 
OP_sc›e_put_v¨
);

23063 
	`emô_u32
(
s
, 
«me
);

23064 
	`emô_u16
(
s
, 
sc›e
);

23066 
OP_gë_fõld
:

23067 
	`emô_›
(
s
, 
OP_put_fõld
);

23068 
	`emô_u32
(
s
, 
«me
);

23070 
OP_sc›e_gë_¥iv©e_fõld
:

23071 
	`emô_›
(
s
, 
OP_sc›e_put_¥iv©e_fõld
);

23072 
	`emô_u32
(
s
, 
«me
);

23073 
	`emô_u16
(
s
, 
sc›e
);

23075 
OP_gë_¨øy_ñ
:

23076 
	`emô_›
(
s
, 
OP_put_¨øy_ñ
);

23078 
OP_gë_ªf_vÆue
:

23080 
	`JS_FªeAtom
(
s
->
˘x
, 
«me
);

23081 
	`emô_œbñ
(
s
, 
œbñ
);

23083 
	`emô_›
(
s
, 
OP_put_ªf_vÆue
);

23085 
OP_gë_su≥r_vÆue
:

23086 
	`emô_›
(
s
, 
OP_put_su≥r_vÆue
);

23089 
	`ab‹t
();

23091 
	}
}

23093 
__ex˚±i⁄
 
	$js_∑r£_ex¥_∑ªn
(
JSP¨£Sèã
 *
s
)

23095 i‡(
	`js_∑r£_ex≥˘
(
s
, '('))

23097 i‡(
	`js_∑r£_ex¥
(
s
))

23099 i‡(
	`js_∑r£_ex≥˘
(
s
, ')'))

23102 
	}
}

23104 
	$js_unsuµ‹ãd_keyw‹d
(
JSP¨£Sèã
 *
s
, 
JSAtom
 
©om
)

23106 
buf
[
ATOM_GET_STR_BUF_SIZE
];

23107  
	`js_∑r£_îr‹
(
s
, "unsupported keyword: %s",

23108 
	`JS_AtomGëSå
(
s
->
˘x
, 
buf
, (buf), 
©om
));

23109 
	}
}

23111 
__ex˚±i⁄
 
	$js_deföe_v¨
(
JSP¨£Sèã
 *
s
, 
JSAtom
 
«me
, 
tok
)

23113 
JSFun˘i⁄Def
 *
fd
 = 
s
->
cur_func
;

23114 
JSV¨DefEnum
 
v¨_def_ty≥
;

23116 i‡(
«me
 =
JS_ATOM_yõld
 && 
fd
->
func_köd
 =
JS_FUNC_GENERATOR
) {

23117  
	`js_∑r£_îr‹
(
s
, "yield isáÑeserved identifier");

23119 i‡((
«me
 =
JS_ATOM_¨gumíts
 ||Çamê=
JS_ATOM_evÆ
)

23120 && (
fd
->
js_mode
 & 
JS_MODE_STRICT
)) {

23121  
	`js_∑r£_îr‹
(
s
, "invalid variableÇame in strict mode");

23123 i‡((
«me
 =
JS_ATOM_Àt
 ||Çamê=
JS_ATOM_undeföed
)

23124 && (
tok
 =
TOK_LET
 ||Åok =
TOK_CONST
)) {

23125  
	`js_∑r£_îr‹
(
s
, "invalidÜexical variableÇame");

23127 
tok
) {

23128 
TOK_LET
:

23129 
v¨_def_ty≥
 = 
JS_VAR_DEF_LET
;

23131 
TOK_CONST
:

23132 
v¨_def_ty≥
 = 
JS_VAR_DEF_CONST
;

23134 
TOK_VAR
:

23135 
v¨_def_ty≥
 = 
JS_VAR_DEF_VAR
;

23137 
TOK_CATCH
:

23138 
v¨_def_ty≥
 = 
JS_VAR_DEF_CATCH
;

23141 
	`ab‹t
();

23143 i‡(
	`deföe_v¨
(
s
, 
fd
, 
«me
, 
v¨_def_ty≥
) < 0)

23146 
	}
}

23148 
	$js_emô_•ªad_code
(
JSP¨£Sèã
 *
s
, 
dïth
)

23150 
œbñ_ª°_√xt
, 
œbñ_ª°_d⁄e
;

23156 
	`emô_›
(
s
, 
OP_¨øy_‰om
);

23157 
	`emô_u16
(
s
, 0);

23158 
	`emô_›
(
s
, 
OP_push_i32
);

23159 
	`emô_u32
(
s
, 0);

23160 
	`emô_œbñ
(
s
, 
œbñ_ª°_√xt
 = 
	`√w_œbñ
(s));

23161 
	`emô_›
(
s
, 
OP_f‹_of_√xt
);

23162 
	`emô_u8
(
s
, 2 + 
dïth
);

23163 
œbñ_ª°_d⁄e
 = 
	`emô_gŸo
(
s
, 
OP_if_åue
, -1);

23165 
	`emô_›
(
s
, 
OP_deföe_¨øy_ñ
);

23166 
	`emô_›
(
s
, 
OP_öc
);

23167 
	`emô_gŸo
(
s
, 
OP_gŸo
, 
œbñ_ª°_√xt
);

23168 
	`emô_œbñ
(
s
, 
œbñ_ª°_d⁄e
);

23170 
	`emô_›
(
s
, 
OP_dr›
);

23171 
	`emô_›
(
s
, 
OP_dr›
);

23172 
	}
}

23174 
	$js_∑r£_check_du∂iˇã_∑ømëî
(
JSP¨£Sèã
 *
s
, 
JSAtom
 
«me
)

23177 
JSFun˘i⁄Def
 *
fd
 = 
s
->
cur_func
;

23178 
i
;

23179 
i
 = 0; i < 
fd
->
¨g_cou¡
; i++) {

23180 i‡(
fd
->
¨gs
[
i
].
v¨_«me
 =
«me
)

23181 
du∂iˇã
;

23183 
i
 = 0; i < 
fd
->
v¨_cou¡
; i++) {

23184 i‡(
fd
->
v¨s
[
i
].
v¨_«me
 =
«me
)

23185 
du∂iˇã
;

23189 
du∂iˇã
:

23190  
	`js_∑r£_îr‹
(
s
, "duplicateÖarameterÇamesÇotállowed inÅhis context");

23191 
	}
}

23193 
JSAtom
 
	$js_∑r£_de°ru˘urög_v¨
(
JSP¨£Sèã
 *
s
, 
tok
, 
is_¨g
)

23195 
JSAtom
 
«me
;

23197 i‡(!(
s
->
tokí
.
vÆ
 =
TOK_IDENT
 && !s->tokí.
u
.
idít
.
is_ª£rved
)

23198 || ((
s
->
cur_func
->
js_mode
 & 
JS_MODE_STRICT
) &&

23199 (
s
->
tokí
.
u
.
idít
.
©om
 =
JS_ATOM_evÆ
 || s->tokí.u.idít.©om =
JS_ATOM_¨gumíts
))) {

23200 
	`js_∑r£_îr‹
(
s
, "invalid destructuringÅarget");

23201  
JS_ATOM_NULL
;

23203 
«me
 = 
	`JS_DupAtom
(
s
->
˘x
, s->
tokí
.
u
.
idít
.
©om
);

23204 i‡(
is_¨g
 && 
	`js_∑r£_check_du∂iˇã_∑ømëî
(
s
, 
«me
))

23205 
Áû
;

23206 i‡(
	`√xt_tokí
(
s
))

23207 
Áû
;

23209  
«me
;

23210 
Áû
:

23211 
	`JS_FªeAtom
(
s
->
˘x
, 
«me
);

23212  
JS_ATOM_NULL
;

23213 
	}
}

23215 
	$js_∑r£_de°ru˘urög_ñemít
(
JSP¨£Sèã
 *
s
, 
tok
, 
is_¨g
,

23216 
hasvÆ
, 
has_ñlùsis
,

23217 
BOOL
 
Ælow_öôülizî
)

23219 
œbñ_∑r£
, 
œbñ_assign
, 
œbñ_d⁄e
, 
œbñ_lvÆue
, 
dïth_lvÆue
;

23220 
°¨t_addr
, 
assign_addr
;

23221 
JSAtom
 
¥›_«me
, 
v¨_«me
;

23222 
›code
, 
sc›e
, 
tok1
, 
skù_bôs
;

23224 i‡(
has_ñlùsis
 < 0) {

23226 
	`js_∑r£_skù_∑ªns_tokí
(
s
, &
skù_bôs
, 
FALSE
);

23227 
has_ñlùsis
 = 
skù_bôs
 & 
SKIP_HAS_ELLIPSIS
;

23230 
œbñ_∑r£
 = 
	`√w_œbñ
(
s
);

23231 
œbñ_assign
 = 
	`√w_œbñ
(
s
);

23233 
°¨t_addr
 = 
s
->
cur_func
->
byã_code
.
size
;

23234 i‡(
hasvÆ
) {

23236 
	`emô_›
(
s
, 
OP_dup
);

23237 
	`emô_›
(
s
, 
OP_undeföed
);

23238 
	`emô_›
(
s
, 
OP_°ri˘_eq
);

23239 
	`emô_gŸo
(
s
, 
OP_if_åue
, 
œbñ_∑r£
);

23240 
	`emô_œbñ
(
s
, 
œbñ_assign
);

23242 
	`emô_gŸo
(
s
, 
OP_gŸo
, 
œbñ_∑r£
);

23243 
	`emô_œbñ
(
s
, 
œbñ_assign
);

23245 
	`emô_›
(
s
, 
OP_dup
);

23247 
assign_addr
 = 
s
->
cur_func
->
byã_code
.
size
;

23248 i‡(
s
->
tokí
.
vÆ
 == '{') {

23249 i‡(
	`√xt_tokí
(
s
))

23252 
	`emô_›
(
s
, 
OP_to_obje˘
);

23253 i‡(
has_ñlùsis
) {

23255 
	`emô_›
(
s
, 
OP_obje˘
);

23256 
	`emô_›
(
s
, 
OP_sw≠
);

23258 
s
->
tokí
.
vÆ
 != '}') {

23259 
¥›_ty≥
;

23260 i‡(
s
->
tokí
.
vÆ
 =
TOK_ELLIPSIS
) {

23261 i‡(!
has_ñlùsis
) {

23262 
	`JS_ThrowI¡î«lEº‹
(
s
->
˘x
, "unexpectedÉllipsisÅoken");

23265 i‡(
	`√xt_tokí
(
s
))

23267 i‡(
tok
) {

23268 
v¨_«me
 = 
	`js_∑r£_de°ru˘urög_v¨
(
s
, 
tok
, 
is_¨g
);

23269 i‡(
v¨_«me
 =
JS_ATOM_NULL
)

23271 
›code
 = 
OP_sc›e_gë_v¨
;

23272 
sc›e
 = 
s
->
cur_func
->
sc›e_Àvñ
;

23273 
œbñ_lvÆue
 = -1;

23274 
dïth_lvÆue
 = 0;

23276 i‡(
	`js_∑r£_po°fix_ex¥
(
s
, 
TRUE
))

23279 i‡(
	`gë_lvÆue
(
s
, &
›code
, &
sc›e
, &
v¨_«me
,

23280 &
œbñ_lvÆue
, &
dïth_lvÆue
, 
FALSE
, '{'))

23283 i‡(
s
->
tokí
.
vÆ
 != '}') {

23284 
	`js_∑r£_îr‹
(
s
, "assignmentÑestÖroperty must beÜast");

23285 
v¨_îr‹
;

23287 
	`emô_›
(
s
, 
OP_obje˘
);

23288 
	`emô_›
(
s
, 
OP_c›y_d©a_¥›îtõs
);

23289 
	`emô_u8
(
s
, 0 | ((
dïth_lvÆue
 + 1) << 2) | ((depth_lvalue + 2) << 5));

23290 
£t_vÆ
;

23292 
¥›_ty≥
 = 
	`js_∑r£_¥›îty_«me
(
s
, &
¥›_«me
, 
FALSE
, 
TRUE
, FALSE);

23293 i‡(
¥›_ty≥
 < 0)

23295 
v¨_«me
 = 
JS_ATOM_NULL
;

23296 
›code
 = 
OP_sc›e_gë_v¨
;

23297 
sc›e
 = 
s
->
cur_func
->
sc›e_Àvñ
;

23298 
œbñ_lvÆue
 = -1;

23299 
dïth_lvÆue
 = 0;

23300 i‡(
¥›_ty≥
 =
PROP_TYPE_IDENT
) {

23301 i‡(
	`√xt_tokí
(
s
))

23302 
¥›_îr‹
;

23303 i‡((
s
->
tokí
.
vÆ
 == '[' || s->token.val == '{')

23304 && ((
tok1
 = 
	`js_∑r£_skù_∑ªns_tokí
(
s
, &
skù_bôs
, 
FALSE
)) == ',' ||

23305 
tok1
 == '=' ||Åok1 == '}')) {

23306 i‡(
¥›_«me
 =
JS_ATOM_NULL
) {

23308 i‡(
has_ñlùsis
) {

23310 
	`emô_›
(
s
, 
OP_to_¥›key
);

23311 
	`emô_›
(
s
, 
OP_≥rm3
);

23312 
	`emô_›
(
s
, 
OP_nuŒ
);

23313 
	`emô_›
(
s
, 
OP_deföe_¨øy_ñ
);

23314 
	`emô_›
(
s
, 
OP_≥rm3
);

23317 
	`emô_›
(
s
, 
OP_gë_¨øy_ñ2
);

23320 i‡(
has_ñlùsis
) {

23322 
	`emô_›
(
s
, 
OP_sw≠
);

23323 
	`emô_›
(
s
, 
OP_nuŒ
);

23324 
	`emô_›
(
s
, 
OP_deföe_fõld
);

23325 
	`emô_©om
(
s
, 
¥›_«me
);

23326 
	`emô_›
(
s
, 
OP_sw≠
);

23329 
	`emô_›
(
s
, 
OP_gë_fõld2
);

23330 
	`emô_u32
(
s
, 
¥›_«me
);

23332 i‡(
	`js_∑r£_de°ru˘urög_ñemít
(
s
, 
tok
, 
is_¨g
, 
TRUE
, -1, TRUE))

23334 i‡(
s
->
tokí
.
vÆ
 == '}')

23337 i‡(
	`js_∑r£_ex≥˘
(
s
, ','))

23341 i‡(
¥›_«me
 =
JS_ATOM_NULL
) {

23342 
	`emô_›
(
s
, 
OP_to_¥›key2
);

23343 i‡(
has_ñlùsis
) {

23345 
	`emô_›
(
s
, 
OP_≥rm3
);

23346 
	`emô_›
(
s
, 
OP_nuŒ
);

23347 
	`emô_›
(
s
, 
OP_deföe_¨øy_ñ
);

23348 
	`emô_›
(
s
, 
OP_≥rm3
);

23351 
	`emô_›
(
s
, 
OP_dup1
);

23353 i‡(
has_ñlùsis
) {

23355 
	`emô_›
(
s
, 
OP_sw≠
);

23356 
	`emô_›
(
s
, 
OP_nuŒ
);

23357 
	`emô_›
(
s
, 
OP_deföe_fõld
);

23358 
	`emô_©om
(
s
, 
¥›_«me
);

23359 
	`emô_›
(
s
, 
OP_sw≠
);

23362 
	`emô_›
(
s
, 
OP_dup
);

23364 i‡(
tok
) {

23365 
v¨_«me
 = 
	`js_∑r£_de°ru˘urög_v¨
(
s
, 
tok
, 
is_¨g
);

23366 i‡(
v¨_«me
 =
JS_ATOM_NULL
)

23367 
¥›_îr‹
;

23369 i‡(
	`js_∑r£_po°fix_ex¥
(
s
, 
TRUE
))

23370 
¥›_îr‹
;

23371 
lvÆue
:

23372 i‡(
	`gë_lvÆue
(
s
, &
›code
, &
sc›e
, &
v¨_«me
,

23373 &
œbñ_lvÆue
, &
dïth_lvÆue
, 
FALSE
, '{'))

23374 
¥›_îr‹
;

23376 i‡(
¥›_«me
 =
JS_ATOM_NULL
) {

23377 
dïth_lvÆue
) {

23380 
	`emô_›
(
s
, 
OP_rŸ3r
);

23384 
	`emô_›
(
s
, 
OP_sw≠2
);

23388 
	`emô_›
(
s
, 
OP_rŸ5l
);

23389 
	`emô_›
(
s
, 
OP_rŸ5l
);

23393 
dïth_lvÆue
) {

23396 
	`emô_›
(
s
, 
OP_sw≠
);

23400 
	`emô_›
(
s
, 
OP_rŸ3l
);

23404 
	`emô_›
(
s
, 
OP_rŸ4l
);

23409 i‡(
¥›_«me
 =
JS_ATOM_NULL
) {

23413 
	`emô_›
(
s
, 
OP_gë_¨øy_ñ
);

23418 
	`emô_›
(
s
, 
OP_gë_fõld
);

23419 
	`emô_u32
(
s
, 
¥›_«me
);

23423 i‡(
is_¨g
 && 
	`js_∑r£_check_du∂iˇã_∑ømëî
(
s
, 
¥›_«me
))

23424 
¥›_îr‹
;

23425 i‡((
s
->
cur_func
->
js_mode
 & 
JS_MODE_STRICT
) &&

23426 (
¥›_«me
 =
JS_ATOM_evÆ
 ||Ör›_«mê=
JS_ATOM_¨gumíts
)) {

23427 
	`js_∑r£_îr‹
(
s
, "invalid destructuringÅarget");

23428 
¥›_îr‹
;

23430 i‡(
has_ñlùsis
) {

23432 
	`emô_›
(
s
, 
OP_sw≠
);

23433 
	`emô_›
(
s
, 
OP_nuŒ
);

23434 
	`emô_›
(
s
, 
OP_deföe_fõld
);

23435 
	`emô_©om
(
s
, 
¥›_«me
);

23436 
	`emô_›
(
s
, 
OP_sw≠
);

23438 i‡(!
tok
 ||Åok =
TOK_VAR
) {

23441 
	`emô_›
(
s
, 
OP_dup
);

23442 
	`emô_›
(
s
, 
OP_sc›e_gë_v¨
);

23443 
	`emô_©om
(
s
, 
¥›_«me
);

23444 
	`emô_u16
(
s
, s->
cur_func
->
sc›e_Àvñ
);

23445 
lvÆue
;

23447 
v¨_«me
 = 
	`JS_DupAtom
(
s
->
˘x
, 
¥›_«me
);

23449 
	`emô_›
(
s
, 
OP_gë_fõld2
);

23450 
	`emô_u32
(
s
, 
¥›_«me
);

23452 
£t_vÆ
:

23453 i‡(
tok
) {

23454 i‡(
	`js_deföe_v¨
(
s
, 
v¨_«me
, 
tok
))

23455 
v¨_îr‹
;

23456 
sc›e
 = 
s
->
cur_func
->
sc›e_Àvñ
;

23458 i‡(
s
->
tokí
.
vÆ
 == '=') {

23459 
œbñ_hasvÆ
;

23460 
	`emô_›
(
s
, 
OP_dup
);

23461 
	`emô_›
(
s
, 
OP_undeföed
);

23462 
	`emô_›
(
s
, 
OP_°ri˘_eq
);

23463 
œbñ_hasvÆ
 = 
	`emô_gŸo
(
s
, 
OP_if_Ál£
, -1);

23464 i‡(
	`√xt_tokí
(
s
))

23465 
v¨_îr‹
;

23466 
	`emô_›
(
s
, 
OP_dr›
);

23467 i‡(
	`js_∑r£_assign_ex¥
(
s
, 
TRUE
))

23468 
v¨_îr‹
;

23469 i‡(
›code
 =
OP_sc›e_gë_v¨
 || opcodê=
OP_gë_ªf_vÆue
)

23470 
	`£t_obje˘_«me
(
s
, 
v¨_«me
);

23471 
	`emô_œbñ
(
s
, 
œbñ_hasvÆ
);

23474 
	`put_lvÆue_nokìp
(
s
, 
›code
, 
sc›e
, 
v¨_«me
, 
œbñ_lvÆue
, 
tok
);

23475 i‡(
s
->
tokí
.
vÆ
 == '}')

23478 i‡(
	`js_∑r£_ex≥˘
(
s
, ','))

23482 
	`emô_›
(
s
, 
OP_dr›
);

23483 i‡(
has_ñlùsis
) {

23484 
	`emô_›
(
s
, 
OP_dr›
);

23486 i‡(
	`√xt_tokí
(
s
))

23488 } i‡(
s
->
tokí
.
vÆ
 == '[') {

23489 
BOOL
 
has_•ªad
;

23490 
íum_dïth
;

23491 
BlockEnv
 
block_ív
;

23493 i‡(
	`√xt_tokí
(
s
))

23497 
	`push_bªak_íåy
(
s
->
cur_func
, &
block_ív
,

23498 
JS_ATOM_NULL
, -1, -1, 2);

23499 
block_ív
.
has_ôî©‹
 = 
TRUE
;

23500 
	`emô_›
(
s
, 
OP_f‹_of_°¨t
);

23501 
has_•ªad
 = 
FALSE
;

23502 
s
->
tokí
.
vÆ
 != ']') {

23504 i‡(
s
->
tokí
.
vÆ
 =
TOK_ELLIPSIS
) {

23505 i‡(
	`√xt_tokí
(
s
))

23507 i‡(
s
->
tokí
.
vÆ
 == ',' || s->token.val == ']')

23508  
	`js_∑r£_îr‹
(
s
, "missing bindingÖattern...");

23509 
has_•ªad
 = 
TRUE
;

23511 i‡(
s
->
tokí
.
vÆ
 == ',') {

23513 
	`emô_›
(
s
, 
OP_f‹_of_√xt
);

23514 
	`emô_u8
(
s
, 0);

23515 
	`emô_›
(
s
, 
OP_dr›
);

23516 
	`emô_›
(
s
, 
OP_dr›
);

23517 } i‡((
s
->
tokí
.
vÆ
 == '[' || s->token.val == '{')

23518 && ((
tok1
 = 
	`js_∑r£_skù_∑ªns_tokí
(
s
, &
skù_bôs
, 
FALSE
)) == ',' ||

23519 
tok1
 == '=' ||Åok1 == ']')) {

23520 i‡(
has_•ªad
) {

23521 i‡(
tok1
 == '=')

23522  
	`js_∑r£_îr‹
(
s
, "restÉlement cannot haveá default value");

23523 
	`js_emô_•ªad_code
(
s
, 0);

23525 
	`emô_›
(
s
, 
OP_f‹_of_√xt
);

23526 
	`emô_u8
(
s
, 0);

23527 
	`emô_›
(
s
, 
OP_dr›
);

23529 i‡(
	`js_∑r£_de°ru˘urög_ñemít
(
s
, 
tok
, 
is_¨g
, 
TRUE
, 
skù_bôs
 & 
SKIP_HAS_ELLIPSIS
, TRUE))

23532 
v¨_«me
 = 
JS_ATOM_NULL
;

23533 
íum_dïth
 = 0;

23534 i‡(
tok
) {

23535 
v¨_«me
 = 
	`js_∑r£_de°ru˘urög_v¨
(
s
, 
tok
, 
is_¨g
);

23536 i‡(
v¨_«me
 =
JS_ATOM_NULL
)

23537 
v¨_îr‹
;

23538 i‡(
	`js_deföe_v¨
(
s
, 
v¨_«me
, 
tok
))

23539 
v¨_îr‹
;

23540 
›code
 = 
OP_sc›e_gë_v¨
;

23541 
sc›e
 = 
s
->
cur_func
->
sc›e_Àvñ
;

23543 i‡(
	`js_∑r£_po°fix_ex¥
(
s
, 
TRUE
))

23545 i‡(
	`gë_lvÆue
(
s
, &
›code
, &
sc›e
, &
v¨_«me
,

23546 &
œbñ_lvÆue
, &
íum_dïth
, 
FALSE
, '[')) {

23550 i‡(
has_•ªad
) {

23551 
	`js_emô_•ªad_code
(
s
, 
íum_dïth
);

23553 
	`emô_›
(
s
, 
OP_f‹_of_√xt
);

23554 
	`emô_u8
(
s
, 
íum_dïth
);

23555 
	`emô_›
(
s
, 
OP_dr›
);

23557 i‡(
s
->
tokí
.
vÆ
 ='=' && !
has_•ªad
) {

23559 
œbñ_hasvÆ
;

23560 
	`emô_›
(
s
, 
OP_dup
);

23561 
	`emô_›
(
s
, 
OP_undeföed
);

23562 
	`emô_›
(
s
, 
OP_°ri˘_eq
);

23563 
œbñ_hasvÆ
 = 
	`emô_gŸo
(
s
, 
OP_if_Ál£
, -1);

23564 i‡(
	`√xt_tokí
(
s
))

23565 
v¨_îr‹
;

23566 
	`emô_›
(
s
, 
OP_dr›
);

23567 i‡(
	`js_∑r£_assign_ex¥
(
s
, 
TRUE
))

23568 
v¨_îr‹
;

23569 i‡(
›code
 =
OP_sc›e_gë_v¨
 || opcodê=
OP_gë_ªf_vÆue
)

23570 
	`£t_obje˘_«me
(
s
, 
v¨_«me
);

23571 
	`emô_œbñ
(
s
, 
œbñ_hasvÆ
);

23574 
	`put_lvÆue_nokìp
(
s
, 
›code
, 
sc›e
, 
v¨_«me
,

23575 
œbñ_lvÆue
, 
tok
);

23577 i‡(
s
->
tokí
.
vÆ
 == ']')

23579 i‡(
has_•ªad
)

23580  
	`js_∑r£_îr‹
(
s
, "restÉlement must beÅheÜast one");

23582 i‡(
	`js_∑r£_ex≥˘
(
s
, ','))

23587 
	`emô_›
(
s
, 
OP_ôî©‹_˛o£
);

23588 
	`p›_bªak_íåy
(
s
->
cur_func
);

23589 i‡(
	`√xt_tokí
(
s
))

23592  
	`js_∑r£_îr‹
(
s
, "invalidássignment syntax");

23594 i‡(
s
->
tokí
.
vÆ
 ='=' && 
Ælow_öôülizî
) {

23595 
œbñ_d⁄e
 = 
	`emô_gŸo
(
s
, 
OP_gŸo
, -1);

23596 i‡(
	`√xt_tokí
(
s
))

23598 
	`emô_œbñ
(
s
, 
œbñ_∑r£
);

23599 i‡(
hasvÆ
)

23600 
	`emô_›
(
s
, 
OP_dr›
);

23601 i‡(
	`js_∑r£_assign_ex¥
(
s
, 
TRUE
))

23603 
	`emô_gŸo
(
s
, 
OP_gŸo
, 
œbñ_assign
);

23604 
	`emô_œbñ
(
s
, 
œbñ_d⁄e
);

23609 i‡(!
hasvÆ
) {

23610 
	`js_∑r£_îr‹
(
s
, "too complicated destructuringÉxpression");

23614 
	`mem£t
(
s
->
cur_func
->
byã_code
.
buf
 + 
°¨t_addr
, 
OP_n›
,

23615 
assign_addr
 - 
°¨t_addr
);

23616 
s
->
cur_func
->
œbñ_¶Ÿs
[
œbñ_∑r£
].
ªf_cou¡
--;

23620 
¥›_îr‹
:

23621 
	`JS_FªeAtom
(
s
->
˘x
, 
¥›_«me
);

23622 
v¨_îr‹
:

23623 
	`JS_FªeAtom
(
s
->
˘x
, 
v¨_«me
);

23625 
	}
}

23627 
	eFuncCÆlTy≥
 {

23628 
	mFUNC_CALL_NORMAL
,

23629 
	mFUNC_CALL_NEW
,

23630 
	mFUNC_CALL_SUPER_CTOR
,

23631 
	mFUNC_CALL_TEMPLATE
,

23632 } 
	tFuncCÆlTy≥
;

23634 
	$›ti⁄Æ_chaö_ã°
(
JSP¨£Sèã
 *
s
, *
p›ti⁄Æ_chaöög_œbñ
,

23635 
dr›_cou¡
)

23637 
œbñ_√xt
, 
i
;

23638 i‡(*
p›ti⁄Æ_chaöög_œbñ
 < 0)

23639 *
p›ti⁄Æ_chaöög_œbñ
 = 
	`√w_œbñ
(
s
);

23641 
	`emô_›
(
s
, 
OP_dup
);

23642 
	`emô_›
(
s
, 
OP_is_undeföed_‹_nuŒ
);

23643 
œbñ_√xt
 = 
	`emô_gŸo
(
s
, 
OP_if_Ál£
, -1);

23644 
i
 = 0; i < 
dr›_cou¡
; i++)

23645 
	`emô_›
(
s
, 
OP_dr›
);

23646 
	`emô_›
(
s
, 
OP_undeföed
);

23647 
	`emô_gŸo
(
s
, 
OP_gŸo
, *
p›ti⁄Æ_chaöög_œbñ
);

23648 
	`emô_œbñ
(
s
, 
œbñ_√xt
);

23649 
	}
}

23651 
__ex˚±i⁄
 
	$js_∑r£_po°fix_ex¥
(
JSP¨£Sèã
 *
s
, 
BOOL
 
ac˚±_Õ¨í
)

23653 
FuncCÆlTy≥
 
ˇŒ_ty≥
;

23654 
›ti⁄Æ_chaöög_œbñ
;

23656 
ˇŒ_ty≥
 = 
FUNC_CALL_NORMAL
;

23657 
s
->
tokí
.
vÆ
) {

23658 
TOK_NUMBER
:

23660 
JSVÆue
 
vÆ
;

23661 
vÆ
 = 
s
->
tokí
.
u
.
num
.val;

23663 i‡(
	`JS_VALUE_GET_TAG
(
vÆ
Ë=
JS_TAG_INT
) {

23664 
	`emô_›
(
s
, 
OP_push_i32
);

23665 
	`emô_u32
(
s
, 
	`JS_VALUE_GET_INT
(
vÆ
));

23667 #ifde‡
CONFIG_BIGNUM


23668 i‡(
	`JS_VALUE_GET_TAG
(
vÆ
Ë=
JS_TAG_BIG_FLOAT
) {

23669 
¶imb_t
 
e
;

23670 
ªt
;

23675 i‡(
	`emô_push_c⁄°
(
s
, 
vÆ
, 0) < 0)

23677 
e
 = 
s
->
tokí
.
u
.
num
.
exp⁄ít
;

23678 i‡(
e
 =(
öt32_t
)e) {

23679 
	`emô_›
(
s
, 
OP_push_i32
);

23680 
	`emô_u32
(
s
, 
e
);

23682 
vÆ
 = 
	`JS_NewBigI¡64_1
(
s
->
˘x
, 
e
);

23683 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

23685 
ªt
 = 
	`emô_push_c⁄°
(
s
, 
vÆ
, 0);

23686 
	`JS_FªeVÆue
(
s
->
˘x
, 
vÆ
);

23687 i‡(
ªt
 < 0)

23690 
	`emô_›
(
s
, 
OP_mul_pow10
);

23694 i‡(
	`emô_push_c⁄°
(
s
, 
vÆ
, 0) < 0)

23698 i‡(
	`√xt_tokí
(
s
))

23701 
TOK_TEMPLATE
:

23702 i‡(
	`js_∑r£_ãm∂©e
(
s
, 0, 
NULL
))

23705 
TOK_STRING
:

23706 i‡(
	`emô_push_c⁄°
(
s
, s->
tokí
.
u
.
°r
.str, 1))

23708 i‡(
	`√xt_tokí
(
s
))

23712 
TOK_DIV_ASSIGN
:

23713 
s
->
buf_±r
 -= 2;

23714 
∑r£_ªgexp
;

23716 
s
->
buf_±r
--;

23717 
∑r£_ªgexp
:

23719 
JSVÆue
 
°r
;

23720 
ªt
, 
backåa˚_Êags
;

23721 i‡(!
s
->
˘x
->
compûe_ªgexp
)

23722  
	`js_∑r£_îr‹
(
s
, "RegExpáreÇot supported");

23724 i‡(
	`js_∑r£_ªgexp
(
s
))

23726 
ªt
 = 
	`emô_push_c⁄°
(
s
, s->
tokí
.
u
.
ªgexp
.
body
, 0);

23727 
°r
 = 
s
->
˘x
->
	`compûe_ªgexp
(s->˘x, s->
tokí
.
u
.
ªgexp
.
body
,

23728 
s
->
tokí
.
u
.
ªgexp
.
Êags
);

23729 i‡(
	`JS_IsEx˚±i⁄
(
°r
)) {

23731 
backåa˚_Êags
 = 0;

23732 i‡(
s
->
cur_func
 && s->cur_func->
backåa˚_b¨rõr
)

23733 
backåa˚_Êags
 = 
JS_BACKTRACE_FLAG_SINGLE_LEVEL
;

23734 
	`buûd_backåa˚
(
s
->
˘x
, s->˘x->
π
->
cuºít_ex˚±i⁄
,

23735 
s
->
fûíame
, s->
tokí
.
löe_num
,

23736 
backåa˚_Êags
);

23739 
ªt
 = 
	`emô_push_c⁄°
(
s
, 
°r
, 0);

23740 
	`JS_FªeVÆue
(
s
->
˘x
, 
°r
);

23741 i‡(
ªt
)

23746 
	`emô_›
(
s
, 
OP_ªgexp
);

23747 i‡(
	`√xt_tokí
(
s
))

23752 i‡(
	`js_∑r£_skù_∑ªns_tokí
(
s
, 
NULL
, 
TRUE
Ë=
TOK_ARROW
) {

23753 i‡(
	`js_∑r£_fun˘i⁄_de˛
(
s
, 
JS_PARSE_FUNC_ARROW
,

23754 
JS_FUNC_NORMAL
, 
JS_ATOM_NULL
,

23755 
s
->
tokí
.
±r
, s->tokí.
löe_num
))

23758 i‡(
	`js_∑r£_ex¥_∑ªn
(
s
))

23762 
TOK_FUNCTION
:

23763 i‡(
	`js_∑r£_fun˘i⁄_de˛
(
s
, 
JS_PARSE_FUNC_EXPR
,

23764 
JS_FUNC_NORMAL
, 
JS_ATOM_NULL
,

23765 
s
->
tokí
.
±r
, s->tokí.
löe_num
))

23768 
TOK_CLASS
:

23769 i‡(
	`js_∑r£_˛ass
(
s
, 
TRUE
, 
JS_PARSE_EXPORT_NONE
))

23772 
TOK_NULL
:

23773 i‡(
	`√xt_tokí
(
s
))

23775 
	`emô_›
(
s
, 
OP_nuŒ
);

23777 
TOK_THIS
:

23778 i‡(
	`√xt_tokí
(
s
))

23780 
	`emô_›
(
s
, 
OP_sc›e_gë_v¨
);

23781 
	`emô_©om
(
s
, 
JS_ATOM_this
);

23782 
	`emô_u16
(
s
, 0);

23784 
TOK_FALSE
:

23785 i‡(
	`√xt_tokí
(
s
))

23787 
	`emô_›
(
s
, 
OP_push_Ál£
);

23789 
TOK_TRUE
:

23790 i‡(
	`√xt_tokí
(
s
))

23792 
	`emô_›
(
s
, 
OP_push_åue
);

23794 
TOK_IDENT
:

23796 
JSAtom
 
«me
;

23797 i‡(
s
->
tokí
.
u
.
idít
.
is_ª£rved
) {

23798  
	`js_∑r£_îr‹_ª£rved_idítifõr
(
s
);

23800 i‡(
	`≥ek_tokí
(
s
, 
TRUE
Ë=
TOK_ARROW
) {

23801 i‡(
	`js_∑r£_fun˘i⁄_de˛
(
s
, 
JS_PARSE_FUNC_ARROW
,

23802 
JS_FUNC_NORMAL
, 
JS_ATOM_NULL
,

23803 
s
->
tokí
.
±r
, s->tokí.
löe_num
))

23805 } i‡(
	`tokí_is_p£udo_keyw‹d
(
s
, 
JS_ATOM_async
) &&

23806 
	`≥ek_tokí
(
s
, 
TRUE
) != '\n') {

23807 c⁄° 
uöt8_t
 *
sour˚_±r
;

23808 
sour˚_löe_num
;

23810 
sour˚_±r
 = 
s
->
tokí
.
±r
;

23811 
sour˚_löe_num
 = 
s
->
tokí
.
löe_num
;

23812 i‡(
	`√xt_tokí
(
s
))

23814 i‡(
s
->
tokí
.
vÆ
 =
TOK_FUNCTION
) {

23815 i‡(
	`js_∑r£_fun˘i⁄_de˛
(
s
, 
JS_PARSE_FUNC_EXPR
,

23816 
JS_FUNC_ASYNC
, 
JS_ATOM_NULL
,

23817 
sour˚_±r
, 
sour˚_löe_num
))

23819 } i‡((
s
->
tokí
.
vÆ
 == '(' &&

23820 
	`js_∑r£_skù_∑ªns_tokí
(
s
, 
NULL
, 
TRUE
Ë=
TOK_ARROW
) ||

23821 (
s
->
tokí
.
vÆ
 =
TOK_IDENT
 && !s->tokí.
u
.
idít
.
is_ª£rved
 &&

23822 
	`≥ek_tokí
(
s
, 
TRUE
Ë=
TOK_ARROW
)) {

23823 i‡(
	`js_∑r£_fun˘i⁄_de˛
(
s
, 
JS_PARSE_FUNC_ARROW
,

23824 
JS_FUNC_ASYNC
, 
JS_ATOM_NULL
,

23825 
sour˚_±r
, 
sour˚_löe_num
))

23828 
«me
 = 
	`JS_DupAtom
(
s
->
˘x
, 
JS_ATOM_async
);

23829 
do_gë_v¨
;

23832 i‡(
s
->
tokí
.
u
.
idít
.
©om
 =
JS_ATOM_¨gumíts
 &&

23833 !
s
->
cur_func
->
¨gumíts_Ælowed
) {

23834 
	`js_∑r£_îr‹
(
s
, "'arguments' identifier isÇotállowed in class field initializer");

23837 
«me
 = 
	`JS_DupAtom
(
s
->
˘x
, s->
tokí
.
u
.
idít
.
©om
);

23838 i‡(
	`√xt_tokí
(
s
))

23840 
do_gë_v¨
:

23841 
	`emô_›
(
s
, 
OP_sc›e_gë_v¨
);

23842 
	`emô_u32
(
s
, 
«me
);

23843 
	`emô_u16
(
s
, s->
cur_func
->
sc›e_Àvñ
);

23850 
skù_bôs
;

23851 i‡(
	`js_∑r£_skù_∑ªns_tokí
(
s
, &
skù_bôs
, 
FALSE
) == '=') {

23852 i‡(
	`js_∑r£_de°ru˘urög_ñemít
(
s
, 0, 0, 
FALSE
, 
skù_bôs
 & 
SKIP_HAS_ELLIPSIS
, 
TRUE
))

23855 i‡(
s
->
tokí
.
vÆ
 == '{') {

23856 i‡(
	`js_∑r£_obje˘_lôîÆ
(
s
))

23859 i‡(
	`js_∑r£_¨øy_lôîÆ
(
s
))

23865 
TOK_NEW
:

23866 i‡(
	`√xt_tokí
(
s
))

23868 i‡(
s
->
tokí
.
vÆ
 == '.') {

23869 i‡(
	`√xt_tokí
(
s
))

23871 i‡(!
	`tokí_is_p£udo_keyw‹d
(
s
, 
JS_ATOM_èrgë
))

23872  
	`js_∑r£_îr‹
(
s
, "expectingÅarget");

23873 i‡(!
s
->
cur_func
->
√w_èrgë_Ælowed
)

23874  
	`js_∑r£_îr‹
(
s
, "new.target onlyállowed within functions");

23875 i‡(
	`√xt_tokí
(
s
))

23877 
	`emô_›
(
s
, 
OP_sc›e_gë_v¨
);

23878 
	`emô_©om
(
s
, 
JS_ATOM_√w_èrgë
);

23879 
	`emô_u16
(
s
, 0);

23881 i‡(
	`js_∑r£_po°fix_ex¥
(
s
, 
FALSE
))

23883 
ac˚±_Õ¨í
 = 
TRUE
;

23884 i‡(
s
->
tokí
.
vÆ
 != '(') {

23886 
	`emô_›
(
s
, 
OP_dup
);

23887 
	`emô_›
(
s
, 
OP_ˇŒ_c⁄°ru˘‹
);

23888 
	`emô_u16
(
s
, 0);

23890 
ˇŒ_ty≥
 = 
FUNC_CALL_NEW
;

23894 
TOK_SUPER
:

23895 i‡(
	`√xt_tokí
(
s
))

23897 i‡(
s
->
tokí
.
vÆ
 == '(') {

23898 i‡(!
s
->
cur_func
->
su≥r_ˇŒ_Ælowed
)

23899  
	`js_∑r£_îr‹
(
s
, "super() is only valid iná derived class constructor");

23900 
ˇŒ_ty≥
 = 
FUNC_CALL_SUPER_CTOR
;

23901 } i‡(
s
->
tokí
.
vÆ
 == '.' || s->token.val == '[') {

23902 i‡(!
s
->
cur_func
->
su≥r_Ælowed
)

23903  
	`js_∑r£_îr‹
(
s
, "'super' is only valid iná method");

23904 
	`emô_›
(
s
, 
OP_sc›e_gë_v¨
);

23905 
	`emô_©om
(
s
, 
JS_ATOM_this
);

23906 
	`emô_u16
(
s
, 0);

23907 
	`emô_›
(
s
, 
OP_sc›e_gë_v¨
);

23908 
	`emô_©om
(
s
, 
JS_ATOM_home_obje˘
);

23909 
	`emô_u16
(
s
, 0);

23910 
	`emô_›
(
s
, 
OP_gë_su≥r
);

23912  
	`js_∑r£_îr‹
(
s
, "invalid use of 'super'");

23915 
TOK_IMPORT
:

23916 i‡(
	`√xt_tokí
(
s
))

23918 i‡(
s
->
tokí
.
vÆ
 == '.') {

23919 i‡(
	`√xt_tokí
(
s
))

23921 i‡(!
	`tokí_is_p£udo_keyw‹d
(
s
, 
JS_ATOM_mëa
))

23922  
	`js_∑r£_îr‹
(
s
, "metaÉxpected");

23923 i‡(!
s
->
is_moduÀ
)

23924  
	`js_∑r£_îr‹
(
s
, "import.meta only valid in module code");

23925 i‡(
	`√xt_tokí
(
s
))

23927 
	`emô_›
(
s
, 
OP_•ecül_obje˘
);

23928 
	`emô_u8
(
s
, 
OP_SPECIAL_OBJECT_IMPORT_META
);

23930 i‡(
	`js_∑r£_ex≥˘
(
s
, '('))

23932 i‡(!
ac˚±_Õ¨í
)

23933  
	`js_∑r£_îr‹
(
s
, "invalid use of 'import()'");

23934 i‡(
	`js_∑r£_assign_ex¥
(
s
, 
TRUE
))

23936 i‡(
	`js_∑r£_ex≥˘
(
s
, ')'))

23938 
	`emô_›
(
s
, 
OP_imp‹t
);

23942  
	`js_∑r£_îr‹
(
s
, "unexpectedÅoken inÉxpression: '%.*s'",

23943 ()(
s
->
buf_±r
 - s->
tokí
.
±r
), s->token.ptr);

23946 
›ti⁄Æ_chaöög_œbñ
 = -1;

23948 
JSFun˘i⁄Def
 *
fd
 = 
s
->
cur_func
;

23949 
BOOL
 
has_›ti⁄Æ_chaö
 = 
FALSE
;

23951 i‡(
s
->
tokí
.
vÆ
 =
TOK_QUESTION_MARK_DOT
) {

23953 i‡(
	`√xt_tokí
(
s
))

23955 
has_›ti⁄Æ_chaö
 = 
TRUE
;

23956 i‡(
s
->
tokí
.
vÆ
 ='(' && 
ac˚±_Õ¨í
) {

23957 
∑r£_func_ˇŒ
;

23958 } i‡(
s
->
tokí
.
vÆ
 == '[') {

23959 
∑r£_¨øy_ac˚ss
;

23961 
∑r£_¥›îty
;

23963 } i‡(
s
->
tokí
.
vÆ
 =
TOK_TEMPLATE
 &&

23964 
ˇŒ_ty≥
 =
FUNC_CALL_NORMAL
) {

23965 i‡(
›ti⁄Æ_chaöög_œbñ
 >= 0) {

23966  
	`js_∑r£_îr‹
(
s
, "templateÜiteral cannotáppear inán optional chain");

23968 
ˇŒ_ty≥
 = 
FUNC_CALL_TEMPLATE
;

23969 
∑r£_func_ˇŒ2
;

23970 } i‡(
s
->
tokí
.
vÆ
 ='(' && 
ac˚±_Õ¨í
) {

23971 
›code
, 
¨g_cou¡
, 
dr›_cou¡
;

23974 
∑r£_func_ˇŒ
:

23975 i‡(
	`√xt_tokí
(
s
))

23978 i‡(
ˇŒ_ty≥
 =
FUNC_CALL_NORMAL
) {

23979 
∑r£_func_ˇŒ2
:

23980 
›code
 = 
	`gë_¥ev_›code
(
fd
)) {

23981 
OP_gë_fõld
:

23983 
fd
->
byã_code
.
buf
[fd->
œ°_›code_pos
] = 
OP_gë_fõld2
;

23984 
dr›_cou¡
 = 2;

23986 
OP_sc›e_gë_¥iv©e_fõld
:

23988 
fd
->
byã_code
.
buf
[fd->
œ°_›code_pos
] = 
OP_sc›e_gë_¥iv©e_fõld2
;

23989 
dr›_cou¡
 = 2;

23991 
OP_gë_¨øy_ñ
:

23993 
fd
->
byã_code
.
buf
[fd->
œ°_›code_pos
] = 
OP_gë_¨øy_ñ2
;

23994 
dr›_cou¡
 = 2;

23996 
OP_sc›e_gë_v¨
:

23998 
JSAtom
 
«me
;

23999 
sc›e
;

24000 
«me
 = 
	`gë_u32
(
fd
->
byã_code
.
buf
 + fd->
œ°_›code_pos
 + 1);

24001 
sc›e
 = 
	`gë_u16
(
fd
->
byã_code
.
buf
 + fd->
œ°_›code_pos
 + 5);

24002 i‡(
«me
 =
JS_ATOM_evÆ
 && 
ˇŒ_ty≥
 =
FUNC_CALL_NORMAL
) {

24004 
›code
 = 
OP_evÆ
;

24014 i‡(
	`has_wôh_sc›e
(
fd
, 
sc›e
)) {

24015 
›code
 = 
OP_sc›e_gë_ªf
;

24016 
fd
->
byã_code
.
buf
[fd->
œ°_›code_pos
] = 
›code
;

24019 
dr›_cou¡
 = 1;

24022 
OP_gë_su≥r_vÆue
:

24023 
fd
->
byã_code
.
buf
[fd->
œ°_›code_pos
] = 
OP_gë_¨øy_ñ
;

24025 
›code
 = 
OP_gë_¨øy_ñ
;

24026 
dr›_cou¡
 = 2;

24029 
›code
 = 
OP_övÆid
;

24030 
dr›_cou¡
 = 1;

24033 i‡(
has_›ti⁄Æ_chaö
) {

24034 
	`›ti⁄Æ_chaö_ã°
(
s
, &
›ti⁄Æ_chaöög_œbñ
,

24035 
dr›_cou¡
);

24038 
›code
 = 
OP_övÆid
;

24041 i‡(
ˇŒ_ty≥
 =
FUNC_CALL_TEMPLATE
) {

24042 i‡(
	`js_∑r£_ãm∂©e
(
s
, 1, &
¨g_cou¡
))

24044 
emô_func_ˇŒ
;

24045 } i‡(
ˇŒ_ty≥
 =
FUNC_CALL_SUPER_CTOR
) {

24046 
	`emô_›
(
s
, 
OP_sc›e_gë_v¨
);

24047 
	`emô_©om
(
s
, 
JS_ATOM_this_a˘ive_func
);

24048 
	`emô_u16
(
s
, 0);

24050 
	`emô_›
(
s
, 
OP_gë_su≥r
);

24052 
	`emô_›
(
s
, 
OP_sc›e_gë_v¨
);

24053 
	`emô_©om
(
s
, 
JS_ATOM_√w_èrgë
);

24054 
	`emô_u16
(
s
, 0);

24055 } i‡(
ˇŒ_ty≥
 =
FUNC_CALL_NEW
) {

24056 
	`emô_›
(
s
, 
OP_dup
);

24060 
¨g_cou¡
 = 0;

24061 
s
->
tokí
.
vÆ
 != ')') {

24062 i‡(
¨g_cou¡
 >= 65535) {

24063  
	`js_∑r£_îr‹
(
s
, "Too many callárguments");

24065 i‡(
s
->
tokí
.
vÆ
 =
TOK_ELLIPSIS
)

24067 i‡(
	`js_∑r£_assign_ex¥
(
s
, 
TRUE
))

24069 
¨g_cou¡
++;

24070 i‡(
s
->
tokí
.
vÆ
 == ')')

24073 i‡(
	`js_∑r£_ex≥˘
(
s
, ','))

24076 i‡(
s
->
tokí
.
vÆ
 =
TOK_ELLIPSIS
) {

24077 
	`emô_›
(
s
, 
OP_¨øy_‰om
);

24078 
	`emô_u16
(
s
, 
¨g_cou¡
);

24079 
	`emô_›
(
s
, 
OP_push_i32
);

24080 
	`emô_u32
(
s
, 
¨g_cou¡
);

24083 
s
->
tokí
.
vÆ
 != ')') {

24084 i‡(
s
->
tokí
.
vÆ
 =
TOK_ELLIPSIS
) {

24085 i‡(
	`√xt_tokí
(
s
))

24087 i‡(
	`js_∑r£_assign_ex¥
(
s
, 
TRUE
))

24091 
	`emô_›
(
s
, 
OP_≠≥nd
);

24093 
œbñ_√xt
, 
œbñ_d⁄e
;

24094 
œbñ_√xt
 = 
	`√w_œbñ
(
s
);

24095 
œbñ_d⁄e
 = 
	`√w_œbñ
(
s
);

24097 
	`emô_›
(
s
, 
OP_f‹_of_°¨t
);

24098 
	`emô_›
(
s
, 
OP_rŸ5l
);

24099 
	`emô_›
(
s
, 
OP_rŸ5l
);

24100 
	`emô_œbñ
(
s
, 
œbñ_√xt
);

24102 
	`emô_›
(
s
, 
OP_f‹_of_√xt
);

24103 
	`emô_u8
(
s
, 2);

24104 
	`emô_gŸo
(
s
, 
OP_if_åue
, 
œbñ_d⁄e
);

24107 
	`emô_›
(
s
, 
OP_deföe_¨øy_ñ
);

24108 
	`emô_›
(
s
, 
OP_öc
);

24109 
	`emô_gŸo
(
s
, 
OP_gŸo
, 
œbñ_√xt
);

24110 
	`emô_œbñ
(
s
, 
œbñ_d⁄e
);

24112 
	`emô_›
(
s
, 
OP_dr›
);

24113 
	`emô_›
(
s
, 
OP_nù1
);

24114 
	`emô_›
(
s
, 
OP_nù1
);

24115 
	`emô_›
(
s
, 
OP_nù1
);

24118 i‡(
	`js_∑r£_assign_ex¥
(
s
, 
TRUE
))

24121 
	`emô_›
(
s
, 
OP_deföe_¨øy_ñ
);

24122 
	`emô_›
(
s
, 
OP_öc
);

24124 i‡(
s
->
tokí
.
vÆ
 == ')')

24127 i‡(
	`js_∑r£_ex≥˘
(
s
, ','))

24130 i‡(
	`√xt_tokí
(
s
))

24133 
	`emô_›
(
s
, 
OP_dr›
);

24136 
›code
) {

24137 
OP_gë_fõld
:

24138 
OP_sc›e_gë_¥iv©e_fõld
:

24139 
OP_gë_¨øy_ñ
:

24140 
OP_sc›e_gë_ªf
:

24142 
	`emô_›
(
s
, 
OP_≥rm3
);

24143 
	`emô_›
(
s
, 
OP_≠∂y
);

24144 
	`emô_u16
(
s
, 
ˇŒ_ty≥
 =
FUNC_CALL_NEW
);

24146 
OP_evÆ
:

24147 
	`emô_›
(
s
, 
OP_≠∂y_evÆ
);

24148 
	`emô_u16
(
s
, 
fd
->
sc›e_Àvñ
);

24149 
fd
->
has_evÆ_ˇŒ
 = 
TRUE
;

24152 i‡(
ˇŒ_ty≥
 =
FUNC_CALL_SUPER_CTOR
) {

24153 
	`emô_›
(
s
, 
OP_≠∂y
);

24154 
	`emô_u16
(
s
, 1);

24156 
	`emô_›
(
s
, 
OP_dup
);

24157 
	`emô_›
(
s
, 
OP_sc›e_put_v¨_öô
);

24158 
	`emô_©om
(
s
, 
JS_ATOM_this
);

24159 
	`emô_u16
(
s
, 0);

24161 
	`emô_˛ass_fõld_öô
(
s
);

24162 } i‡(
ˇŒ_ty≥
 =
FUNC_CALL_NEW
) {

24164 
	`emô_›
(
s
, 
OP_≥rm3
);

24165 
	`emô_›
(
s
, 
OP_≠∂y
);

24166 
	`emô_u16
(
s
, 1);

24169 
	`emô_›
(
s
, 
OP_undeföed
);

24170 
	`emô_›
(
s
, 
OP_sw≠
);

24171 
	`emô_›
(
s
, 
OP_≠∂y
);

24172 
	`emô_u16
(
s
, 0);

24177 i‡(
	`√xt_tokí
(
s
))

24179 
emô_func_ˇŒ
:

24180 
›code
) {

24181 
OP_gë_fõld
:

24182 
OP_sc›e_gë_¥iv©e_fõld
:

24183 
OP_gë_¨øy_ñ
:

24184 
OP_sc›e_gë_ªf
:

24185 
	`emô_›
(
s
, 
OP_ˇŒ_mëhod
);

24186 
	`emô_u16
(
s
, 
¨g_cou¡
);

24188 
OP_evÆ
:

24189 
	`emô_›
(
s
, 
OP_evÆ
);

24190 
	`emô_u16
(
s
, 
¨g_cou¡
);

24191 
	`emô_u16
(
s
, 
fd
->
sc›e_Àvñ
);

24192 
fd
->
has_evÆ_ˇŒ
 = 
TRUE
;

24195 i‡(
ˇŒ_ty≥
 =
FUNC_CALL_SUPER_CTOR
) {

24196 
	`emô_›
(
s
, 
OP_ˇŒ_c⁄°ru˘‹
);

24197 
	`emô_u16
(
s
, 
¨g_cou¡
);

24200 
	`emô_›
(
s
, 
OP_dup
);

24201 
	`emô_›
(
s
, 
OP_sc›e_put_v¨_öô
);

24202 
	`emô_©om
(
s
, 
JS_ATOM_this
);

24203 
	`emô_u16
(
s
, 0);

24205 
	`emô_˛ass_fõld_öô
(
s
);

24206 } i‡(
ˇŒ_ty≥
 =
FUNC_CALL_NEW
) {

24207 
	`emô_›
(
s
, 
OP_ˇŒ_c⁄°ru˘‹
);

24208 
	`emô_u16
(
s
, 
¨g_cou¡
);

24210 
	`emô_›
(
s
, 
OP_ˇŒ
);

24211 
	`emô_u16
(
s
, 
¨g_cou¡
);

24216 
ˇŒ_ty≥
 = 
FUNC_CALL_NORMAL
;

24217 } i‡(
s
->
tokí
.
vÆ
 == '.') {

24218 i‡(
	`√xt_tokí
(
s
))

24220 i‡(
s
->
tokí
.
vÆ
 =
TOK_PRIVATE_NAME
) {

24222 i‡(
	`gë_¥ev_›code
(
fd
Ë=
OP_gë_su≥r
) {

24223  
	`js_∑r£_îr‹
(
s
, "private class field forbiddenáfter super");

24225 
	`emô_›
(
s
, 
OP_sc›e_gë_¥iv©e_fõld
);

24226 
	`emô_©om
(
s
, s->
tokí
.
u
.
idít
.
©om
);

24227 
	`emô_u16
(
s
, s->
cur_func
->
sc›e_Àvñ
);

24229 
∑r£_¥›îty
:

24230 i‡(!
	`tokí_is_idít
(
s
->
tokí
.
vÆ
)) {

24231  
	`js_∑r£_îr‹
(
s
, "expecting fieldÇame");

24233 i‡(
	`gë_¥ev_›code
(
fd
Ë=
OP_gë_su≥r
) {

24234 
JSVÆue
 
vÆ
;

24235 
ªt
;

24236 
vÆ
 = 
	`JS_AtomToVÆue
(
s
->
˘x
, s->
tokí
.
u
.
idít
.
©om
);

24237 
ªt
 = 
	`emô_push_c⁄°
(
s
, 
vÆ
, 1);

24238 
	`JS_FªeVÆue
(
s
->
˘x
, 
vÆ
);

24239 i‡(
ªt
)

24241 
	`emô_›
(
s
, 
OP_gë_su≥r_vÆue
);

24243 i‡(
has_›ti⁄Æ_chaö
) {

24244 
	`›ti⁄Æ_chaö_ã°
(
s
, &
›ti⁄Æ_chaöög_œbñ
, 1);

24246 
	`emô_›
(
s
, 
OP_gë_fõld
);

24247 
	`emô_©om
(
s
, s->
tokí
.
u
.
idít
.
©om
);

24250 i‡(
	`√xt_tokí
(
s
))

24252 } i‡(
s
->
tokí
.
vÆ
 == '[') {

24253 
¥ev_›
;

24255 
∑r£_¨øy_ac˚ss
:

24256 
¥ev_›
 = 
	`gë_¥ev_›code
(
fd
);

24257 i‡(
has_›ti⁄Æ_chaö
) {

24258 
	`›ti⁄Æ_chaö_ã°
(
s
, &
›ti⁄Æ_chaöög_œbñ
, 1);

24260 i‡(
	`√xt_tokí
(
s
))

24262 i‡(
	`js_∑r£_ex¥
(
s
))

24264 i‡(
	`js_∑r£_ex≥˘
(
s
, ']'))

24266 i‡(
¥ev_›
 =
OP_gë_su≥r
) {

24267 
	`emô_›
(
s
, 
OP_gë_su≥r_vÆue
);

24269 
	`emô_›
(
s
, 
OP_gë_¨øy_ñ
);

24275 i‡(
›ti⁄Æ_chaöög_œbñ
 >= 0)

24276 
	`emô_œbñ
(
s
, 
›ti⁄Æ_chaöög_œbñ
);

24278 
	}
}

24280 
__ex˚±i⁄
 
	$js_∑r£_dñëe
(
JSP¨£Sèã
 *
s
)

24282 
JSFun˘i⁄Def
 *
fd
 = 
s
->
cur_func
;

24283 
JSAtom
 
«me
;

24284 
›code
;

24286 i‡(
	`√xt_tokí
(
s
))

24288 i‡(
	`js_∑r£_u«ry
(
s
, -1))

24290 
›code
 = 
	`gë_¥ev_›code
(
fd
)) {

24291 
OP_gë_fõld
:

24293 
JSVÆue
 
vÆ
;

24294 
ªt
;

24296 
«me
 = 
	`gë_u32
(
fd
->
byã_code
.
buf
 + fd->
œ°_›code_pos
 + 1);

24297 
fd
->
byã_code
.
size
 = fd->
œ°_›code_pos
;

24298 
fd
->
œ°_›code_pos
 = -1;

24299 
vÆ
 = 
	`JS_AtomToVÆue
(
s
->
˘x
, 
«me
);

24300 
ªt
 = 
	`emô_push_c⁄°
(
s
, 
vÆ
, 1);

24301 
	`JS_FªeVÆue
(
s
->
˘x
, 
vÆ
);

24302 
	`JS_FªeAtom
(
s
->
˘x
, 
«me
);

24303 i‡(
ªt
)

24304  
ªt
;

24306 
do_dñëe
;

24307 
OP_gë_¨øy_ñ
:

24308 
fd
->
byã_code
.
size
 = fd->
œ°_›code_pos
;

24309 
fd
->
œ°_›code_pos
 = -1;

24310 
do_dñëe
:

24311 
	`emô_›
(
s
, 
OP_dñëe
);

24313 
OP_sc›e_gë_v¨
:

24315 
«me
 = 
	`gë_u32
(
fd
->
byã_code
.
buf
 + fd->
œ°_›code_pos
 + 1);

24316 i‡(
«me
 =
JS_ATOM_this
 ||Çamê=
JS_ATOM_√w_èrgë
)

24317 
ªt_åue
;

24318 i‡(
fd
->
js_mode
 & 
JS_MODE_STRICT
) {

24319  
	`js_∑r£_îr‹
(
s
, "cannot deleteá directÑeference in strict mode");

24321 
fd
->
byã_code
.
buf
[fd->
œ°_›code_pos
] = 
OP_sc›e_dñëe_v¨
;

24324 
OP_sc›e_gë_¥iv©e_fõld
:

24325  
	`js_∑r£_îr‹
(
s
, "cannot deleteáÖrivate class field");

24326 
OP_gë_su≥r_vÆue
:

24327 
	`emô_›
(
s
, 
OP_throw_v¨
);

24328 
	`emô_©om
(
s
, 
JS_ATOM_NULL
);

24329 
	`emô_u8
(
s
, 
JS_THROW_VAR_DELETE_SUPER
);

24332 
ªt_åue
:

24333 
	`emô_›
(
s
, 
OP_dr›
);

24334 
	`emô_›
(
s
, 
OP_push_åue
);

24338 
	}
}

24340 
__ex˚±i⁄
 
	$js_∑r£_u«ry
(
JSP¨£Sèã
 *
s
, 
exp⁄ítüti⁄_Êag
)

24342 
›
;

24344 
s
->
tokí
.
vÆ
) {

24349 
TOK_VOID
:

24350 
›
 = 
s
->
tokí
.
vÆ
;

24351 i‡(
	`√xt_tokí
(
s
))

24353 i‡(
	`js_∑r£_u«ry
(
s
, -1))

24355 
›
) {

24357 
	`emô_›
(
s
, 
OP_√g
);

24360 
	`emô_›
(
s
, 
OP_∂us
);

24363 
	`emô_›
(
s
, 
OP_ Ÿ
);

24366 
	`emô_›
(
s
, 
OP_nŸ
);

24368 
TOK_VOID
:

24369 
	`emô_›
(
s
, 
OP_dr›
);

24370 
	`emô_›
(
s
, 
OP_undeföed
);

24373 
	`ab‹t
();

24375 
exp⁄ítüti⁄_Êag
 = 0;

24377 
TOK_DEC
:

24378 
TOK_INC
:

24380 
›code
, 
›
, 
sc›e
, 
œbñ
;

24381 
JSAtom
 
«me
;

24382 
›
 = 
s
->
tokí
.
vÆ
;

24383 i‡(
	`√xt_tokí
(
s
))

24386 i‡(
	`js_∑r£_u«ry
(
s
, 0))

24388 i‡(
	`gë_lvÆue
(
s
, &
›code
, &
sc›e
, &
«me
, &
œbñ
, 
NULL
, 
TRUE
, 
›
))

24390 
	`emô_›
(
s
, 
OP_dec
 + 
›
 - 
TOK_DEC
);

24391 
	`put_lvÆue
(
s
, 
›code
, 
sc›e
, 
«me
, 
œbñ
, 
FALSE
);

24394 
TOK_TYPEOF
:

24396 
JSFun˘i⁄Def
 *
fd
;

24397 i‡(
	`√xt_tokí
(
s
))

24399 i‡(
	`js_∑r£_u«ry
(
s
, -1))

24403 
fd
 = 
s
->
cur_func
;

24404 i‡(
	`gë_¥ev_›code
(
fd
Ë=
OP_sc›e_gë_v¨
) {

24405 
fd
->
byã_code
.
buf
[fd->
œ°_›code_pos
] = 
OP_sc›e_gë_v¨_undef
;

24407 
	`emô_›
(
s
, 
OP_ty≥of
);

24408 
exp⁄ítüti⁄_Êag
 = 0;

24411 
TOK_DELETE
:

24412 i‡(
	`js_∑r£_dñëe
(
s
))

24414 
exp⁄ítüti⁄_Êag
 = 0;

24416 
TOK_AWAIT
:

24417 i‡(!(
s
->
cur_func
->
func_köd
 & 
JS_FUNC_ASYNC
))

24418  
	`js_∑r£_îr‹
(
s
, "unexpected 'await' keyword");

24419 i‡(!
s
->
cur_func
->
ö_fun˘i⁄_body
)

24420  
	`js_∑r£_îr‹
(
s
, "await in defaultÉxpression");

24421 i‡(
	`√xt_tokí
(
s
))

24423 i‡(
	`js_∑r£_u«ry
(
s
, -1))

24425 
	`emô_›
(
s
, 
OP_awaô
);

24426 
exp⁄ítüti⁄_Êag
 = 0;

24429 i‡(
	`js_∑r£_po°fix_ex¥
(
s
, 
TRUE
))

24431 i‡(!
s
->
gŸ_lf
 &&

24432 (
s
->
tokí
.
vÆ
 =
TOK_DEC
 || s->tokí.vÆ =
TOK_INC
)) {

24433 
›code
, 
›
, 
sc›e
, 
œbñ
;

24434 
JSAtom
 
«me
;

24435 
›
 = 
s
->
tokí
.
vÆ
;

24436 i‡(
	`gë_lvÆue
(
s
, &
›code
, &
sc›e
, &
«me
, &
œbñ
, 
NULL
, 
TRUE
, 
›
))

24438 
	`emô_›
(
s
, 
OP_po°_dec
 + 
›
 - 
TOK_DEC
);

24439 
	`put_lvÆue
(
s
, 
›code
, 
sc›e
, 
«me
, 
œbñ
, 
TRUE
);

24440 i‡(
	`√xt_tokí
(
s
))

24445 i‡(
exp⁄ítüti⁄_Êag
) {

24446 #ifde‡
CONFIG_BIGNUM


24447 i‡(
s
->
tokí
.
vÆ
 =
TOK_POW
 || s->tokí.vÆ =
TOK_MATH_POW
) {

24451 i‡(!(
s
->
cur_func
->
js_mode
 & 
JS_MODE_MATH
)) {

24452 i‡(
exp⁄ítüti⁄_Êag
 < 0) {

24453 
	`JS_ThrowSy¡axEº‹
(
s
->
˘x
, "unparenthesized unaryÉxpression can'táppear onÅheÜeft-hand side of '**'");

24457 i‡(
	`√xt_tokí
(
s
))

24459 i‡(
	`js_∑r£_u«ry
(
s
, 1))

24461 
	`emô_›
(
s
, 
OP_pow
);

24464 i‡(
s
->
tokí
.
vÆ
 =
TOK_POW
) {

24470 i‡(
exp⁄ítüti⁄_Êag
 < 0) {

24471 
	`JS_ThrowSy¡axEº‹
(
s
->
˘x
, "unparenthesized unaryÉxpression can'táppear onÅheÜeft-hand side of '**'");

24474 i‡(
	`√xt_tokí
(
s
))

24476 i‡(
	`js_∑r£_u«ry
(
s
, 1))

24478 
	`emô_›
(
s
, 
OP_pow
);

24483 
	}
}

24485 
__ex˚±i⁄
 
	$js_∑r£_ex¥_bö¨y
(
JSP¨£Sèã
 *
s
, 
Àvñ
,

24486 
BOOL
 
ö_ac˚±ed
)

24488 
›
, 
›code
;

24490 i‡(
Àvñ
 == 0) {

24491  
	`js_∑r£_u«ry
(
s
, 1);

24493 i‡(
	`js_∑r£_ex¥_bö¨y
(
s
, 
Àvñ
 - 1, 
ö_ac˚±ed
))

24496 
›
 = 
s
->
tokí
.
vÆ
;

24497 
Àvñ
) {

24499 
›
) {

24501 
›code
 = 
OP_mul
;

24504 
›code
 = 
OP_div
;

24507 #ifde‡
CONFIG_BIGNUM


24508 i‡(
s
->
cur_func
->
js_mode
 & 
JS_MODE_MATH
)

24509 
›code
 = 
OP_m©h_mod
;

24512 
›code
 = 
OP_mod
;

24519 
›
) {

24521 
›code
 = 
OP_add
;

24524 
›code
 = 
OP_sub
;

24531 
›
) {

24532 
TOK_SHL
:

24533 
›code
 = 
OP_shl
;

24535 
TOK_SAR
:

24536 
›code
 = 
OP_ßr
;

24538 
TOK_SHR
:

24539 
›code
 = 
OP_shr
;

24546 
›
) {

24548 
›code
 = 
OP_…
;

24551 
›code
 = 
OP_gt
;

24553 
TOK_LTE
:

24554 
›code
 = 
OP_…e
;

24556 
TOK_GTE
:

24557 
›code
 = 
OP_gã
;

24559 
TOK_INSTANCEOF
:

24560 
›code
 = 
OP_ö°™˚of
;

24562 
TOK_IN
:

24563 i‡(
ö_ac˚±ed
) {

24564 
›code
 = 
OP_ö
;

24574 
›
) {

24575 
TOK_EQ
:

24576 
›code
 = 
OP_eq
;

24578 
TOK_NEQ
:

24579 
›code
 = 
OP_√q
;

24581 
TOK_STRICT_EQ
:

24582 
›code
 = 
OP_°ri˘_eq
;

24584 
TOK_STRICT_NEQ
:

24585 
›code
 = 
OP_°ri˘_√q
;

24592 
›
) {

24594 
›code
 = 
OP_™d
;

24601 
›
) {

24603 
›code
 = 
OP_x‹
;

24610 
›
) {

24612 
›code
 = 
OP_‹
;

24619 
	`ab‹t
();

24621 i‡(
	`√xt_tokí
(
s
))

24623 i‡(
	`js_∑r£_ex¥_bö¨y
(
s
, 
Àvñ
 - 1, 
ö_ac˚±ed
))

24625 
	`emô_›
(
s
, 
›code
);

24628 
	}
}

24630 
__ex˚±i⁄
 
	$js_∑r£_logiˇl_™d_‹
(
JSP¨£Sèã
 *
s
, 
›
,

24631 
BOOL
 
ö_ac˚±ed
)

24633 
œbñ1
;

24635 i‡(
›
 =
TOK_LAND
) {

24636 i‡(
	`js_∑r£_ex¥_bö¨y
(
s
, 8, 
ö_ac˚±ed
))

24639 i‡(
	`js_∑r£_logiˇl_™d_‹
(
s
, 
TOK_LAND
, 
ö_ac˚±ed
))

24642 i‡(
s
->
tokí
.
vÆ
 =
›
) {

24643 
œbñ1
 = 
	`√w_œbñ
(
s
);

24646 i‡(
	`√xt_tokí
(
s
))

24648 
	`emô_›
(
s
, 
OP_dup
);

24649 
	`emô_gŸo
(
s
, 
›
 =
TOK_LAND
 ? 
OP_if_Ál£
 : 
OP_if_åue
, 
œbñ1
);

24650 
	`emô_›
(
s
, 
OP_dr›
);

24652 i‡(
›
 =
TOK_LAND
) {

24653 i‡(
	`js_∑r£_ex¥_bö¨y
(
s
, 8, 
ö_ac˚±ed
))

24656 i‡(
	`js_∑r£_logiˇl_™d_‹
(
s
, 
TOK_LAND
, 
ö_ac˚±ed
))

24659 i‡(
s
->
tokí
.
vÆ
 !
›
) {

24660 i‡(
s
->
tokí
.
vÆ
 =
TOK_DOUBLE_QUESTION_MARK
)

24661  
	`js_∑r£_îr‹
(
s
, "cannot mix ?? with && or ||");

24666 
	`emô_œbñ
(
s
, 
œbñ1
);

24669 
	}
}

24671 
__ex˚±i⁄
 
	$js_∑r£_cﬂÀs˚_ex¥
(
JSP¨£Sèã
 *
s
, 
BOOL
 
ö_ac˚±ed
)

24673 
œbñ1
;

24675 i‡(
	`js_∑r£_logiˇl_™d_‹
(
s
, 
TOK_LOR
, 
ö_ac˚±ed
))

24677 i‡(
s
->
tokí
.
vÆ
 =
TOK_DOUBLE_QUESTION_MARK
) {

24678 
œbñ1
 = 
	`√w_œbñ
(
s
);

24680 i‡(
	`√xt_tokí
(
s
))

24683 
	`emô_›
(
s
, 
OP_dup
);

24684 
	`emô_›
(
s
, 
OP_is_undeföed_‹_nuŒ
);

24685 
	`emô_gŸo
(
s
, 
OP_if_Ál£
, 
œbñ1
);

24686 
	`emô_›
(
s
, 
OP_dr›
);

24688 i‡(
	`js_∑r£_ex¥_bö¨y
(
s
, 8, 
ö_ac˚±ed
))

24690 i‡(
s
->
tokí
.
vÆ
 !
TOK_DOUBLE_QUESTION_MARK
)

24693 
	`emô_œbñ
(
s
, 
œbñ1
);

24696 
	}
}

24698 
__ex˚±i⁄
 
	$js_∑r£_c⁄d_ex¥
(
JSP¨£Sèã
 *
s
, 
BOOL
 
ö_ac˚±ed
)

24700 
œbñ1
, 
œbñ2
;

24702 i‡(
	`js_∑r£_cﬂÀs˚_ex¥
(
s
, 
ö_ac˚±ed
))

24704 i‡(
s
->
tokí
.
vÆ
 == '?') {

24705 i‡(
	`√xt_tokí
(
s
))

24707 
œbñ1
 = 
	`emô_gŸo
(
s
, 
OP_if_Ál£
, -1);

24709 i‡(
	`js_∑r£_assign_ex¥
(
s
, 
TRUE
))

24711 i‡(
	`js_∑r£_ex≥˘
(
s
, ':'))

24714 
œbñ2
 = 
	`emô_gŸo
(
s
, 
OP_gŸo
, -1);

24716 
	`emô_œbñ
(
s
, 
œbñ1
);

24718 i‡(
	`js_∑r£_assign_ex¥
(
s
, 
ö_ac˚±ed
))

24721 
	`emô_œbñ
(
s
, 
œbñ2
);

24724 
	}
}

24726 
emô_ªtu∫
(
JSP¨£Sèã
 *
s
, 
BOOL
 
hasvÆ
);

24728 
__ex˚±i⁄
 
	$js_∑r£_assign_ex¥
(
JSP¨£Sèã
 *
s
, 
BOOL
 
ö_ac˚±ed
)

24730 
›code
, 
›
, 
sc›e
;

24731 
JSAtom
 
«me0
 = 
JS_ATOM_NULL
;

24732 
JSAtom
 
«me
;

24734 i‡(
s
->
tokí
.
vÆ
 =
TOK_YIELD
) {

24735 
BOOL
 
is_°¨
 = 
FALSE
;

24736 i‡(!(
s
->
cur_func
->
func_köd
 & 
JS_FUNC_GENERATOR
))

24737  
	`js_∑r£_îr‹
(
s
, "unexpected 'yield' keyword");

24738 i‡(!
s
->
cur_func
->
ö_fun˘i⁄_body
)

24739  
	`js_∑r£_îr‹
(
s
, "yield in defaultÉxpression");

24740 i‡(
	`√xt_tokí
(
s
))

24744 i‡(
s
->
tokí
.
vÆ
 != ';' && s->token.val != ')' &&

24745 
s
->
tokí
.
vÆ
 != ']' && s->token.val != '}' &&

24746 
s
->
tokí
.
vÆ
 !',' && s->tokí.vÆ !':' && !s->
gŸ_lf
) {

24747 i‡(
s
->
tokí
.
vÆ
 == '*') {

24748 
is_°¨
 = 
TRUE
;

24749 i‡(
	`√xt_tokí
(
s
))

24752 i‡(
	`js_∑r£_assign_ex¥
(
s
, 
ö_ac˚±ed
))

24755 
	`emô_›
(
s
, 
OP_undeföed
);

24757 i‡(
s
->
cur_func
->
func_köd
 =
JS_FUNC_ASYNC_GENERATOR
) {

24758 
œbñ_lo›
, 
œbñ_ªtu∫
, 
œbñ_√xt
;

24759 
œbñ_ªtu∫1
, 
œbñ_yõld
, 
œbñ_throw
, 
œbñ_throw1
;

24760 
œbñ_throw2
;

24762 i‡(
is_°¨
) {

24763 
œbñ_lo›
 = 
	`√w_œbñ
(
s
);

24764 
œbñ_yõld
 = 
	`√w_œbñ
(
s
);

24766 
	`emô_›
(
s
, 
OP_f‹_awaô_of_°¨t
);

24770 
	`emô_›
(
s
, 
OP_dr›
);

24771 
	`emô_›
(
s
, 
OP_undeföed
);

24773 
	`emô_›
(
s
, 
OP_undeföed
);

24775 
	`emô_œbñ
(
s
, 
œbñ_lo›
);

24776 
	`emô_›
(
s
, 
OP_async_ôî©‹_√xt
);

24777 
	`emô_›
(
s
, 
OP_awaô
);

24778 
	`emô_›
(
s
, 
OP_ôî©‹_gë_vÆue_d⁄e
);

24779 
œbñ_√xt
 = 
	`emô_gŸo
(
s
, 
OP_if_åue
, -1);

24780 
	`emô_›
(
s
, 
OP_awaô
);

24781 
	`emô_œbñ
(
s
, 
œbñ_yõld
);

24782 
	`emô_›
(
s
, 
OP_async_yõld_°¨
);

24783 
	`emô_›
(
s
, 
OP_dup
);

24784 
œbñ_ªtu∫
 = 
	`emô_gŸo
(
s
, 
OP_if_åue
, -1);

24785 
	`emô_›
(
s
, 
OP_dr›
);

24786 
	`emô_gŸo
(
s
, 
OP_gŸo
, 
œbñ_lo›
);

24788 
	`emô_œbñ
(
s
, 
œbñ_ªtu∫
);

24789 
	`emô_›
(
s
, 
OP_push_i32
);

24790 
	`emô_u32
(
s
, 2);

24791 
	`emô_›
(
s
, 
OP_°ri˘_eq
);

24792 
œbñ_throw
 = 
	`emô_gŸo
(
s
, 
OP_if_åue
, -1);

24795 
	`emô_›
(
s
, 
OP_awaô
);

24796 
	`emô_›
(
s
, 
OP_async_ôî©‹_gë
);

24797 
	`emô_u8
(
s
, 0);

24798 
œbñ_ªtu∫1
 = 
	`emô_gŸo
(
s
, 
OP_if_åue
, -1);

24799 
	`emô_›
(
s
, 
OP_awaô
);

24800 
	`emô_›
(
s
, 
OP_ôî©‹_gë_vÆue_d⁄e
);

24803 
	`emô_gŸo
(
s
, 
OP_if_Ál£
, 
œbñ_yõld
);

24805 
	`emô_œbñ
(
s
, 
œbñ_ªtu∫1
);

24806 
	`emô_›
(
s
, 
OP_nù
);

24807 
	`emô_›
(
s
, 
OP_nù
);

24808 
	`emô_›
(
s
, 
OP_nù
);

24809 
	`emô_ªtu∫
(
s
, 
TRUE
);

24812 
	`emô_œbñ
(
s
, 
œbñ_throw
);

24813 
	`emô_›
(
s
, 
OP_async_ôî©‹_gë
);

24814 
	`emô_u8
(
s
, 1);

24815 
œbñ_throw1
 = 
	`emô_gŸo
(
s
, 
OP_if_åue
, -1);

24816 
	`emô_›
(
s
, 
OP_awaô
);

24817 
	`emô_›
(
s
, 
OP_ôî©‹_gë_vÆue_d⁄e
);

24818 
	`emô_gŸo
(
s
, 
OP_if_Ál£
, 
œbñ_yõld
);

24821 
	`emô_›
(
s
, 
OP_awaô
);

24822 
	`emô_gŸo
(
s
, 
OP_gŸo
, 
œbñ_√xt
);

24824 
	`emô_œbñ
(
s
, 
œbñ_throw1
);

24825 
	`emô_›
(
s
, 
OP_async_ôî©‹_gë
);

24826 
	`emô_u8
(
s
, 0);

24827 
œbñ_throw2
 = 
	`emô_gŸo
(
s
, 
OP_if_åue
, -1);

24828 
	`emô_›
(
s
, 
OP_awaô
);

24829 
	`emô_œbñ
(
s
, 
œbñ_throw2
);

24830 
	`emô_›
(
s
, 
OP_async_ôî©‹_gë
);

24831 
	`emô_u8
(
s
, 2);

24832 
	`emô_›
(
s
, 
OP_dr›
);

24834 
	`emô_œbñ
(
s
, 
œbñ_√xt
);

24835 
	`emô_›
(
s
, 
OP_nù
);

24837 
	`emô_›
(
s
, 
OP_nù
);

24838 
	`emô_›
(
s
, 
OP_nù
);

24840 
	`emô_›
(
s
, 
OP_awaô
);

24841 
	`emô_›
(
s
, 
OP_yõld
);

24842 
œbñ_√xt
 = 
	`emô_gŸo
(
s
, 
OP_if_Ál£
, -1);

24843 
	`emô_ªtu∫
(
s
, 
TRUE
);

24844 
	`emô_œbñ
(
s
, 
œbñ_√xt
);

24847 
œbñ_√xt
;

24848 i‡(
is_°¨
) {

24849 
	`emô_›
(
s
, 
OP_f‹_of_°¨t
);

24850 
	`emô_›
(
s
, 
OP_dr›
);

24851 
	`emô_›
(
s
, 
OP_yõld_°¨
);

24853 
	`emô_›
(
s
, 
OP_yõld
);

24855 
œbñ_√xt
 = 
	`emô_gŸo
(
s
, 
OP_if_Ál£
, -1);

24856 
	`emô_ªtu∫
(
s
, 
TRUE
);

24857 
	`emô_œbñ
(
s
, 
œbñ_√xt
);

24861 i‡(
s
->
tokí
.
vÆ
 =
TOK_IDENT
) {

24863 
«me0
 = 
s
->
tokí
.
u
.
idít
.
©om
;

24865 i‡(
	`js_∑r£_c⁄d_ex¥
(
s
, 
ö_ac˚±ed
))

24868 
›
 = 
s
->
tokí
.
vÆ
;

24869 i‡(
›
 ='=' || (› >
TOK_MUL_ASSIGN
 && o∞<
TOK_POW_ASSIGN
)) {

24870 
œbñ
;

24871 i‡(
	`√xt_tokí
(
s
))

24873 i‡(
	`gë_lvÆue
(
s
, &
›code
, &
sc›e
, &
«me
, &
œbñ
, 
NULL
, (
›
 != '='), op) < 0)

24876 i‡(
	`js_∑r£_assign_ex¥
(
s
, 
ö_ac˚±ed
)) {

24877 
	`JS_FªeAtom
(
s
->
˘x
, 
«me
);

24881 i‡(
›
 == '=') {

24882 i‡(
›code
 =
OP_gë_ªf_vÆue
 && 
«me
 =
«me0
) {

24883 
	`£t_obje˘_«me
(
s
, 
«me
);

24886 c⁄° 
uöt8_t
 
assign_›codes
[] = {

24887 
OP_mul
, 
OP_div
, 
OP_mod
, 
OP_add
, 
OP_sub
,

24888 
OP_shl
, 
OP_ßr
, 
OP_shr
, 
OP_™d
, 
OP_x‹
, 
OP_‹
,

24889 #ifde‡
CONFIG_BIGNUM


24890 
OP_pow
,

24892 
OP_pow
,

24894 
›
 = 
assign_›codes
[› - 
TOK_MUL_ASSIGN
];

24895 #ifde‡
CONFIG_BIGNUM


24896 i‡(
s
->
cur_func
->
js_mode
 & 
JS_MODE_MATH
) {

24897 i‡(
›
 =
OP_mod
)

24898 
›
 = 
OP_m©h_mod
;

24901 
	`emô_›
(
s
, 
›
);

24903 
	`put_lvÆue
(
s
, 
›code
, 
sc›e
, 
«me
, 
œbñ
, 
FALSE
);

24906 
	}
}

24908 
__ex˚±i⁄
 
	$js_∑r£_ex¥2
(
JSP¨£Sèã
 *
s
, 
BOOL
 
ö_ac˚±ed
)

24910 
BOOL
 
comma
 = 
FALSE
;

24912 i‡(
	`js_∑r£_assign_ex¥
(
s
, 
ö_ac˚±ed
))

24914 i‡(
comma
) {

24920 
s
->
cur_func
->
œ°_›code_pos
 = -1;

24922 i‡(
s
->
tokí
.
vÆ
 != ',')

24924 
comma
 = 
TRUE
;

24925 i‡(
	`√xt_tokí
(
s
))

24927 
	`emô_›
(
s
, 
OP_dr›
);

24930 
	}
}

24932 
__ex˚±i⁄
 
	$js_∑r£_ex¥
(
JSP¨£Sèã
 *
s
)

24934  
	`js_∑r£_ex¥2
(
s
, 
TRUE
);

24935 
	}
}

24937 
	$push_bªak_íåy
(
JSFun˘i⁄Def
 *
fd
, 
BlockEnv
 *
be
,

24938 
JSAtom
 
œbñ_«me
,

24939 
œbñ_bªak
, 
œbñ_c⁄t
,

24940 
dr›_cou¡
)

24942 
be
->
¥ev
 = 
fd
->
t›_bªak
;

24943 
fd
->
t›_bªak
 = 
be
;

24944 
be
->
œbñ_«me
 =Üabel_name;

24945 
be
->
œbñ_bªak
 =Üabel_break;

24946 
be
->
œbñ_c⁄t
 =Üabel_cont;

24947 
be
->
dr›_cou¡
 = drop_count;

24948 
be
->
œbñ_föÆly
 = -1;

24949 
be
->
sc›e_Àvñ
 = 
fd
->scope_level;

24950 
be
->
has_ôî©‹
 = 
FALSE
;

24951 
	}
}

24953 
	$p›_bªak_íåy
(
JSFun˘i⁄Def
 *
fd
)

24955 
BlockEnv
 *
be
;

24956 
be
 = 
fd
->
t›_bªak
;

24957 
fd
->
t›_bªak
 = 
be
->
¥ev
;

24958 
	}
}

24960 
__ex˚±i⁄
 
	$emô_bªak
(
JSP¨£Sèã
 *
s
, 
JSAtom
 
«me
, 
is_c⁄t
)

24962 
BlockEnv
 *
t›
;

24963 
i
, 
sc›e_Àvñ
;

24965 
sc›e_Àvñ
 = 
s
->
cur_func
->scope_level;

24966 
t›
 = 
s
->
cur_func
->
t›_bªak
;

24967 
t›
 !
NULL
) {

24968 
	`˛o£_sc›es
(
s
, 
sc›e_Àvñ
, 
t›
->scope_level);

24969 
sc›e_Àvñ
 = 
t›
->scope_level;

24970 i‡(
is_c⁄t
 &&

24971 
t›
->
œbñ_c⁄t
 != -1 &&

24972 (
«me
 =
JS_ATOM_NULL
 || 
t›
->
œbñ_«me
 ==Çame)) {

24974 
	`emô_gŸo
(
s
, 
OP_gŸo
, 
t›
->
œbñ_c⁄t
);

24977 i‡(!
is_c⁄t
 &&

24978 
t›
->
œbñ_bªak
 != -1 &&

24979 (
«me
 =
JS_ATOM_NULL
 || 
t›
->
œbñ_«me
 ==Çame)) {

24980 
	`emô_gŸo
(
s
, 
OP_gŸo
, 
t›
->
œbñ_bªak
);

24983 
i
 = 0;

24984 i‡(
t›
->
has_ôî©‹
) {

24985 
	`emô_›
(
s
, 
OP_ôî©‹_˛o£
);

24986 
i
 += 3;

24988 ; 
i
 < 
t›
->
dr›_cou¡
; i++)

24989 
	`emô_›
(
s
, 
OP_dr›
);

24990 i‡(
t›
->
œbñ_föÆly
 != -1) {

24992 
	`emô_›
(
s
, 
OP_undeföed
);

24993 
	`emô_gŸo
(
s
, 
OP_gosub
, 
t›
->
œbñ_föÆly
);

24994 
	`emô_›
(
s
, 
OP_dr›
);

24996 
t›
 =Å›->
¥ev
;

24998 i‡(
«me
 =
JS_ATOM_NULL
) {

24999 i‡(
is_c⁄t
)

25000  
	`js_∑r£_îr‹
(
s
, "continue must be insideÜoop");

25002  
	`js_∑r£_îr‹
(
s
, "break must be insideÜoop or switch");

25004  
	`js_∑r£_îr‹
(
s
, "break/continueÜabelÇot found");

25006 
	}
}

25009 
	$emô_ªtu∫
(
JSP¨£Sèã
 *
s
, 
BOOL
 
hasvÆ
)

25011 
BlockEnv
 *
t›
;

25012 
dr›_cou¡
;

25014 
dr›_cou¡
 = 0;

25015 
t›
 = 
s
->
cur_func
->
t›_bªak
;

25016 
t›
 !
NULL
) {

25020 i‡(
t›
->
has_ôî©‹
) {

25024 i‡(!
hasvÆ
) {

25025 
	`emô_›
(
s
, 
OP_undeföed
);

25026 
hasvÆ
 = 
TRUE
;

25028 
	`emô_›
(
s
, 
OP_ôî©‹_˛o£_ªtu∫
);

25029 i‡(
s
->
cur_func
->
func_köd
 =
JS_FUNC_ASYNC_GENERATOR
) {

25030 
œbñ_√xt
;

25031 
	`emô_›
(
s
, 
OP_async_ôî©‹_˛o£
);

25032 
œbñ_√xt
 = 
	`emô_gŸo
(
s
, 
OP_if_åue
, -1);

25033 
	`emô_›
(
s
, 
OP_awaô
);

25034 
	`emô_œbñ
(
s
, 
œbñ_√xt
);

25035 
	`emô_›
(
s
, 
OP_dr›
);

25037 
	`emô_›
(
s
, 
OP_ôî©‹_˛o£
);

25039 
dr›_cou¡
 = -3;

25041 
dr›_cou¡
 +
t›
->drop_count;

25042 i‡(
t›
->
œbñ_föÆly
 != -1) {

25043 
dr›_cou¡
) {

25045 
	`emô_›
(
s
, 
hasvÆ
 ? 
OP_nù
 : 
OP_dr›
);

25046 
dr›_cou¡
--;

25048 i‡(!
hasvÆ
) {

25050 
	`emô_›
(
s
, 
OP_undeföed
);

25051 
hasvÆ
 = 
TRUE
;

25053 
	`emô_gŸo
(
s
, 
OP_gosub
, 
t›
->
œbñ_föÆly
);

25055 
t›
 =Å›->
¥ev
;

25057 i‡(
s
->
cur_func
->
is_dîived_˛ass_c⁄°ru˘‹
) {

25058 
œbñ_ªtu∫
;

25062 i‡(
hasvÆ
) {

25063 
	`emô_›
(
s
, 
OP_check_˘‹_ªtu∫
);

25064 
œbñ_ªtu∫
 = 
	`emô_gŸo
(
s
, 
OP_if_Ál£
, -1);

25065 
	`emô_›
(
s
, 
OP_dr›
);

25067 
œbñ_ªtu∫
 = -1;

25072 
	`emô_›
(
s
, 
OP_sc›e_gë_v¨
);

25073 
	`emô_©om
(
s
, 
JS_ATOM_this
);

25074 
	`emô_u16
(
s
, 0);

25076 
	`emô_œbñ
(
s
, 
œbñ_ªtu∫
);

25077 
	`emô_›
(
s
, 
OP_ªtu∫
);

25078 } i‡(
s
->
cur_func
->
func_köd
 !
JS_FUNC_NORMAL
) {

25079 i‡(!
hasvÆ
) {

25080 
	`emô_›
(
s
, 
OP_undeföed
);

25081 } i‡(
s
->
cur_func
->
func_köd
 =
JS_FUNC_ASYNC_GENERATOR
) {

25082 
	`emô_›
(
s
, 
OP_awaô
);

25084 
	`emô_›
(
s
, 
OP_ªtu∫_async
);

25086 
	`emô_›
(
s
, 
hasvÆ
 ? 
OP_ªtu∫
 : 
OP_ªtu∫_undef
);

25088 
	}
}

25090 
	#DECL_MASK_FUNC
 (1 << 0Ë

	)

25092 
	#DECL_MASK_FUNC_WITH_LABEL
 (1 << 1)

	)

25093 
	#DECL_MASK_OTHER
 (1 << 2Ë

	)

25094 
	#DECL_MASK_ALL
 (
DECL_MASK_FUNC
 | 
DECL_MASK_FUNC_WITH_LABEL
 | 
DECL_MASK_OTHER
)

	)

25096 
__ex˚±i⁄
 
js_∑r£_°©emít_‹_de˛
(
JSP¨£Sèã
 *
s
,

25097 
de˛_mask
);

25099 
__ex˚±i⁄
 
	$js_∑r£_°©emít
(
JSP¨£Sèã
 *
s
)

25101  
	`js_∑r£_°©emít_‹_de˛
(
s
, 0);

25102 
	}
}

25104 
__ex˚±i⁄
 
	$js_∑r£_block
(
JSP¨£Sèã
 *
s
)

25106 i‡(
	`js_∑r£_ex≥˘
(
s
, '{'))

25108 i‡(
s
->
tokí
.
vÆ
 != '}') {

25109 
	`push_sc›e
(
s
);

25111 i‡(
	`js_∑r£_°©emít_‹_de˛
(
s
, 
DECL_MASK_ALL
))

25113 i‡(
s
->
tokí
.
vÆ
 == '}')

25116 
	`p›_sc›e
(
s
);

25118 i‡(
	`√xt_tokí
(
s
))

25121 
	}
}

25123 
__ex˚±i⁄
 
	$js_∑r£_v¨
(
JSP¨£Sèã
 *
s
, 
BOOL
 
ö_ac˚±ed
, 
tok
,

25124 
BOOL
 
exp‹t_Êag
)

25126 
JSC⁄ãxt
 *
˘x
 = 
s
->ctx;

25127 
JSFun˘i⁄Def
 *
fd
 = 
s
->
cur_func
;

25128 
JSAtom
 
«me
 = 
JS_ATOM_NULL
;

25131 i‡(
s
->
tokí
.
vÆ
 =
TOK_IDENT
) {

25132 i‡(
s
->
tokí
.
u
.
idít
.
is_ª£rved
) {

25133  
	`js_∑r£_îr‹_ª£rved_idítifõr
(
s
);

25135 
«me
 = 
	`JS_DupAtom
(
˘x
, 
s
->
tokí
.
u
.
idít
.
©om
);

25136 i‡(
«me
 =
JS_ATOM_Àt
 && (
tok
 =
TOK_LET
 ||Åok =
TOK_CONST
)) {

25137 
	`js_∑r£_îr‹
(
s
, "'let' isÇotá validÜexical identifier");

25138 
v¨_îr‹
;

25140 i‡(
	`√xt_tokí
(
s
))

25141 
v¨_îr‹
;

25142 i‡(
	`js_deföe_v¨
(
s
, 
«me
, 
tok
))

25143 
v¨_îr‹
;

25144 i‡(
exp‹t_Êag
) {

25145 i‡(!
	`add_exp‹t_íåy
(
s
, s->
cur_func
->
moduÀ
, 
«me
,Çame,

25146 
JS_EXPORT_TYPE_LOCAL
))

25147 
v¨_îr‹
;

25150 i‡(
s
->
tokí
.
vÆ
 == '=') {

25151 i‡(
	`√xt_tokí
(
s
))

25152 
v¨_îr‹
;

25153 i‡(
tok
 =
TOK_VAR
) {

25155 
›code
, 
sc›e
, 
œbñ
;

25156 
JSAtom
 
«me1
;

25158 
	`emô_›
(
s
, 
OP_sc›e_gë_v¨
);

25159 
	`emô_©om
(
s
, 
«me
);

25160 
	`emô_u16
(
s
, 
fd
->
sc›e_Àvñ
);

25161 i‡(
	`gë_lvÆue
(
s
, &
›code
, &
sc›e
, &
«me1
, &
œbñ
, 
NULL
, 
FALSE
, '=') < 0)

25162 
v¨_îr‹
;

25163 i‡(
	`js_∑r£_assign_ex¥
(
s
, 
ö_ac˚±ed
)) {

25164 
	`JS_FªeAtom
(
˘x
, 
«me1
);

25165 
v¨_îr‹
;

25167 
	`£t_obje˘_«me
(
s
, 
«me
);

25168 
	`put_lvÆue
(
s
, 
›code
, 
sc›e
, 
«me1
, 
œbñ
, 
FALSE
);

25169 
	`emô_›
(
s
, 
OP_dr›
);

25171 i‡(
	`js_∑r£_assign_ex¥
(
s
, 
ö_ac˚±ed
))

25172 
v¨_îr‹
;

25173 
	`£t_obje˘_«me
(
s
, 
«me
);

25174 
	`emô_›
(
s
, (
tok
 =
TOK_CONST
 ||Åok =
TOK_LET
) ?

25175 
OP_sc›e_put_v¨_öô
 : 
OP_sc›e_put_v¨
);

25176 
	`emô_©om
(
s
, 
«me
);

25177 
	`emô_u16
(
s
, 
fd
->
sc›e_Àvñ
);

25180 i‡(
tok
 =
TOK_CONST
) {

25181 
	`js_∑r£_îr‹
(
s
, "missing initializer for const variable");

25182 
v¨_îr‹
;

25184 i‡(
tok
 =
TOK_LET
) {

25186 
	`emô_›
(
s
, 
OP_undeföed
);

25187 
	`emô_›
(
s
, 
OP_sc›e_put_v¨_öô
);

25188 
	`emô_©om
(
s
, 
«me
);

25189 
	`emô_u16
(
s
, 
fd
->
sc›e_Àvñ
);

25192 
	`JS_FªeAtom
(
˘x
, 
«me
);

25194 
skù_bôs
;

25195 i‡((
s
->
tokí
.
vÆ
 == '[' || s->token.val == '{')

25196 && 
	`js_∑r£_skù_∑ªns_tokí
(
s
, &
skù_bôs
, 
FALSE
) == '=') {

25197 
	`emô_›
(
s
, 
OP_undeföed
);

25198 i‡(
	`js_∑r£_de°ru˘urög_ñemít
(
s
, 
tok
, 0, 
TRUE
, 
skù_bôs
 & 
SKIP_HAS_ELLIPSIS
, TRUE))

25201  
	`js_∑r£_îr‹
(
s
, "variableÇameÉxpected");

25204 i‡(
s
->
tokí
.
vÆ
 != ',')

25206 i‡(
	`√xt_tokí
(
s
))

25211 
v¨_îr‹
:

25212 
	`JS_FªeAtom
(
˘x
, 
«me
);

25214 
	}
}

25217 
BOOL
 
	$is_œbñ
(
JSP¨£Sèã
 *
s
)

25219  (
s
->
tokí
.
vÆ
 =
TOK_IDENT
 && !s->tokí.
u
.
idít
.
is_ª£rved
 &&

25220 
	`≥ek_tokí
(
s
, 
FALSE
) == ':');

25221 
	}
}

25224 
	$is_Àt
(
JSP¨£Sèã
 *
s
, 
de˛_mask
)

25226 
ªs
 = 
FALSE
;

25228 i‡(
	`tokí_is_p£udo_keyw‹d
(
s
, 
JS_ATOM_Àt
)) {

25230 
JSP¨£Pos
 
pos
;

25231 
	`js_∑r£_gë_pos
(
s
, &
pos
);

25233 i‡(
	`√xt_tokí
(
s
)) {

25234 
ªs
 = -1;

25237 i‡(
s
->
tokí
.
vÆ
 == '[') {

25240 
ªs
 = 
TRUE
;

25243 i‡(
s
->
tokí
.
vÆ
 == '{' ||

25244 (
s
->
tokí
.
vÆ
 =
TOK_IDENT
 && !s->tokí.
u
.
idít
.
is_ª£rved
) ||

25245 
s
->
tokí
.
vÆ
 =
TOK_LET
 ||

25246 
s
->
tokí
.
vÆ
 =
TOK_YIELD
 ||

25247 
s
->
tokí
.
vÆ
 =
TOK_AWAIT
) {

25251 i‡(
s
->
œ°_löe_num
 =s->
tokí
.
löe_num
 || (
de˛_mask
 & 
DECL_MASK_OTHER
)) {

25252 
ªs
 = 
TRUE
;

25259 i‡(
	`js_∑r£_£ek_tokí
(
s
, &
pos
)) {

25260 
ªs
 = -1;

25263 
tok
 = 
	`≥ek_tokí
(
s
, 
TRUE
);

25264 i‡(
tok
 ='{' ||Åok =
TOK_IDENT
 || 
	`≥ek_tokí
(
s
, 
FALSE
) == '[') {

25265 
ªs
 = 
TRUE
;

25269  
ªs
;

25270 
	}
}

25274 
__ex˚±i⁄
 
	$js_∑r£_f‹_ö_of
(
JSP¨£Sèã
 *
s
, 
œbñ_«me
,

25275 
BOOL
 
is_async
)

25277 
JSC⁄ãxt
 *
˘x
 = 
s
->ctx;

25278 
JSFun˘i⁄Def
 *
fd
 = 
s
->
cur_func
;

25279 
JSAtom
 
v¨_«me
;

25280 
BOOL
 
has_öôülizî
, 
is_f‹_of
, 
has_de°ru˘urög
;

25281 
tok
, 
tok1
, 
›code
, 
sc›e
, 
block_sc›e_Àvñ
;

25282 
œbñ_√xt
, 
œbñ_ex¥
, 
œbñ_c⁄t
, 
œbñ_body
, 
œbñ_bªak
;

25283 
pos_√xt
, 
pos_ex¥
;

25284 
BlockEnv
 
bªak_íåy
;

25286 
has_öôülizî
 = 
FALSE
;

25287 
has_de°ru˘urög
 = 
FALSE
;

25288 
is_f‹_of
 = 
FALSE
;

25289 
block_sc›e_Àvñ
 = 
fd
->
sc›e_Àvñ
;

25290 
œbñ_c⁄t
 = 
	`√w_œbñ
(
s
);

25291 
œbñ_body
 = 
	`√w_œbñ
(
s
);

25292 
œbñ_bªak
 = 
	`√w_œbñ
(
s
);

25293 
œbñ_√xt
 = 
	`√w_œbñ
(
s
);

25298 
	`push_sc›e
(
s
);

25302 
	`push_bªak_íåy
(
s
->
cur_func
, &
bªak_íåy
,

25303 
œbñ_«me
, 
œbñ_bªak
, 
œbñ_c⁄t
, 1);

25304 
bªak_íåy
.
sc›e_Àvñ
 = 
block_sc›e_Àvñ
;

25306 
œbñ_ex¥
 = 
	`emô_gŸo
(
s
, 
OP_gŸo
, -1);

25308 
pos_√xt
 = 
s
->
cur_func
->
byã_code
.
size
;

25309 
	`emô_œbñ
(
s
, 
œbñ_√xt
);

25311 
tok
 = 
s
->
tokí
.
vÆ
;

25312 
	`is_Àt
(
s
, 
DECL_MASK_OTHER
)) {

25313 
TRUE
:

25314 
tok
 = 
TOK_LET
;

25316 
FALSE
:

25321 i‡(
tok
 =
TOK_VAR
 ||Åok =
TOK_LET
 ||Åok =
TOK_CONST
) {

25322 i‡(
	`√xt_tokí
(
s
))

25325 i‡(!(
s
->
tokí
.
vÆ
 =
TOK_IDENT
 && !s->tokí.
u
.
idít
.
is_ª£rved
)) {

25326 i‡(
s
->
tokí
.
vÆ
 == '[' || s->token.val == '{') {

25327 i‡(
	`js_∑r£_de°ru˘urög_ñemít
(
s
, 
tok
, 0, 
TRUE
, -1, 
FALSE
))

25329 
has_de°ru˘urög
 = 
TRUE
;

25331  
	`js_∑r£_îr‹
(
s
, "variableÇameÉxpected");

25333 
v¨_«me
 = 
JS_ATOM_NULL
;

25335 
v¨_«me
 = 
	`JS_DupAtom
(
˘x
, 
s
->
tokí
.
u
.
idít
.
©om
);

25336 i‡(
	`√xt_tokí
(
s
)) {

25337 
	`JS_FªeAtom
(
s
->
˘x
, 
v¨_«me
);

25340 i‡(
	`js_deföe_v¨
(
s
, 
v¨_«me
, 
tok
)) {

25341 
	`JS_FªeAtom
(
s
->
˘x
, 
v¨_«me
);

25344 
	`emô_›
(
s
, (
tok
 =
TOK_CONST
 ||Åok =
TOK_LET
) ?

25345 
OP_sc›e_put_v¨_öô
 : 
OP_sc›e_put_v¨
);

25346 
	`emô_©om
(
s
, 
v¨_«me
);

25347 
	`emô_u16
(
s
, 
fd
->
sc›e_Àvñ
);

25350 
skù_bôs
;

25351 i‡((
s
->
tokí
.
vÆ
 == '[' || s->token.val == '{')

25352 && ((
tok1
 = 
	`js_∑r£_skù_∑ªns_tokí
(
s
, &
skù_bôs
, 
FALSE
)Ë=
TOK_IN
 ||Åok1 =
TOK_OF
)) {

25353 i‡(
	`js_∑r£_de°ru˘urög_ñemít
(
s
, 0, 0, 
TRUE
, 
skù_bôs
 & 
SKIP_HAS_ELLIPSIS
, TRUE))

25356 
lvÆue_œbñ
, 
dïth
;

25357 i‡(
	`js_∑r£_po°fix_ex¥
(
s
, 
TRUE
))

25359 i‡(
	`gë_lvÆue
(
s
, &
›code
, &
sc›e
, &
v¨_«me
, &
lvÆue_œbñ
,

25360 &
dïth
, 
FALSE
, 
TOK_FOR
))

25364 
dïth
) {

25366 
	`emô_›
(
s
, 
OP_sw≠
);

25369 
	`emô_›
(
s
, 
OP_rŸ3l
);

25372 
	`emô_›
(
s
, 
OP_rŸ4l
);

25375 
	`ab‹t
();

25377 
	`put_lvÆue_nokìp
(
s
, 
›code
, 
sc›e
, 
v¨_«me
, 
lvÆue_œbñ
,

25378 
TOK_FOR
 );

25380 
v¨_«me
 = 
JS_ATOM_NULL
;

25382 
	`emô_gŸo
(
s
, 
OP_gŸo
, 
œbñ_body
);

25384 
pos_ex¥
 = 
s
->
cur_func
->
byã_code
.
size
;

25385 
	`emô_œbñ
(
s
, 
œbñ_ex¥
);

25386 i‡(
s
->
tokí
.
vÆ
 == '=') {

25388 
has_öôülizî
 = 
TRUE
;

25392 i‡(
	`√xt_tokí
(
s
Ë|| 
	`js_∑r£_assign_ex¥
(s, 
FALSE
)) {

25393 
	`JS_FªeAtom
(
˘x
, 
v¨_«me
);

25396 i‡(
v¨_«me
 !
JS_ATOM_NULL
) {

25397 
	`emô_›
(
s
, 
OP_sc›e_put_v¨
);

25398 
	`emô_©om
(
s
, 
v¨_«me
);

25399 
	`emô_u16
(
s
, 
fd
->
sc›e_Àvñ
);

25402 
	`JS_FªeAtom
(
˘x
, 
v¨_«me
);

25404 i‡(
	`tokí_is_p£udo_keyw‹d
(
s
, 
JS_ATOM_of
)) {

25405 
bªak_íåy
.
has_ôî©‹
 = 
is_f‹_of
 = 
TRUE
;

25406 
bªak_íåy
.
dr›_cou¡
 += 2;

25407 i‡(
has_öôülizî
)

25408 
öôülizî_îr‹
;

25409 } i‡(
s
->
tokí
.
vÆ
 =
TOK_IN
) {

25410 i‡(
is_async
)

25411  
	`js_∑r£_îr‹
(
s
, "'foráwait'Üoop should be used with 'of'");

25412 i‡(
has_öôülizî
 &&

25413 (
tok
 !
TOK_VAR
 || (
fd
->
js_mode
 & 
JS_MODE_STRICT
) ||

25414 
has_de°ru˘urög
)) {

25415 
öôülizî_îr‹
:

25416  
	`js_∑r£_îr‹
(
s
, "a declaration inÅhe head ofá for-%sÜoop can't haveán initializer",

25417 
is_f‹_of
 ? "of" : "in");

25420  
	`js_∑r£_îr‹
(
s
, "expected 'of' or 'in' in for controlÉxpression");

25422 i‡(
	`√xt_tokí
(
s
))

25424 i‡(
is_f‹_of
) {

25425 i‡(
	`js_∑r£_assign_ex¥
(
s
, 
TRUE
))

25428 i‡(
	`js_∑r£_ex¥
(
s
))

25433 
	`˛o£_sc›es
(
s
, s->
cur_func
->
sc›e_Àvñ
, 
block_sc›e_Àvñ
);

25434 i‡(
is_f‹_of
) {

25435 i‡(
is_async
)

25436 
	`emô_›
(
s
, 
OP_f‹_awaô_of_°¨t
);

25438 
	`emô_›
(
s
, 
OP_f‹_of_°¨t
);

25441 
	`emô_›
(
s
, 
OP_f‹_ö_°¨t
);

25444 
	`emô_gŸo
(
s
, 
OP_gŸo
, 
œbñ_c⁄t
);

25446 i‡(
	`js_∑r£_ex≥˘
(
s
, ')'))

25449 i‡(
OPTIMIZE
) {

25451 
DynBuf
 *
bc
 = &
s
->
cur_func
->
byã_code
;

25452 
chunk_size
 = 
pos_ex¥
 - 
pos_√xt
;

25453 
off£t
 = 
bc
->
size
 - 
pos_√xt
;

25454 
i
;

25455 
	`dbuf_ªÆloc
(
bc
, bc->
size
 + 
chunk_size
);

25456 
	`dbuf_put
(
bc
, bc->
buf
 + 
pos_√xt
, 
chunk_size
);

25457 
	`mem£t
(
bc
->
buf
 + 
pos_√xt
, 
OP_n›
, 
chunk_size
);

25459 
s
->
cur_func
->
œ°_›code_pos
 = 
bc
->
size
 - 5;

25461 
i
 = 
œbñ_c⁄t
; i < 
s
->
cur_func
->
œbñ_cou¡
; i++) {

25462 
LabñSlŸ
 *
ls
 = &
s
->
cur_func
->
œbñ_¶Ÿs
[
i
];

25463 i‡(
ls
->
pos
 >
pos_√xt
 &&Üs->po†< 
pos_ex¥
)

25464 
ls
->
pos
 +
off£t
;

25468 
	`emô_œbñ
(
s
, 
œbñ_body
);

25469 i‡(
	`js_∑r£_°©emít
(
s
))

25472 
	`˛o£_sc›es
(
s
, s->
cur_func
->
sc›e_Àvñ
, 
block_sc›e_Àvñ
);

25474 
	`emô_œbñ
(
s
, 
œbñ_c⁄t
);

25475 i‡(
is_f‹_of
) {

25476 i‡(
is_async
) {

25478 
	`emô_›
(
s
, 
OP_f‹_awaô_of_√xt
);

25480 
	`emô_›
(
s
, 
OP_awaô
);

25482 
	`emô_›
(
s
, 
OP_ôî©‹_gë_vÆue_d⁄e
);

25484 
	`emô_›
(
s
, 
OP_f‹_of_√xt
);

25485 
	`emô_u8
(
s
, 0);

25488 
	`emô_›
(
s
, 
OP_f‹_ö_√xt
);

25491 
	`emô_gŸo
(
s
, 
OP_if_Ál£
, 
œbñ_√xt
);

25493 
	`emô_›
(
s
, 
OP_dr›
);

25495 
	`emô_œbñ
(
s
, 
œbñ_bªak
);

25496 i‡(
is_f‹_of
) {

25498 
	`emô_›
(
s
, 
OP_ôî©‹_˛o£
);

25500 
	`emô_›
(
s
, 
OP_dr›
);

25502 
	`p›_bªak_íåy
(
s
->
cur_func
);

25503 
	`p›_sc›e
(
s
);

25505 
	}
}

25507 
	$£t_evÆ_ªt_undeföed
(
JSP¨£Sèã
 *
s
)

25509 i‡(
s
->
cur_func
->
evÆ_ªt_idx
 >= 0) {

25510 
	`emô_›
(
s
, 
OP_undeföed
);

25511 
	`emô_›
(
s
, 
OP_put_loc
);

25512 
	`emô_u16
(
s
, s->
cur_func
->
evÆ_ªt_idx
);

25514 
	}
}

25516 
__ex˚±i⁄
 
	$js_∑r£_°©emít_‹_de˛
(
JSP¨£Sèã
 *
s
,

25517 
de˛_mask
)

25519 
JSC⁄ãxt
 *
˘x
 = 
s
->ctx;

25520 
JSAtom
 
œbñ_«me
;

25521 
tok
;

25525 
œbñ_«me
 = 
JS_ATOM_NULL
;

25526 i‡(
	`is_œbñ
(
s
)) {

25527 
BlockEnv
 *
be
;

25529 
œbñ_«me
 = 
	`JS_DupAtom
(
˘x
, 
s
->
tokí
.
u
.
idít
.
©om
);

25531 
be
 = 
s
->
cur_func
->
t›_bªak
; be; bêbe->
¥ev
) {

25532 i‡(
be
->
œbñ_«me
 ==Üabel_name) {

25533 
	`js_∑r£_îr‹
(
s
, "duplicateÜabelÇame");

25534 
Áû
;

25538 i‡(
	`√xt_tokí
(
s
))

25539 
Áû
;

25540 i‡(
	`js_∑r£_ex≥˘
(
s
, ':'))

25541 
Áû
;

25542 i‡(
s
->
tokí
.
vÆ
 !
TOK_FOR


25543 && 
s
->
tokí
.
vÆ
 !
TOK_DO


25544 && 
s
->
tokí
.
vÆ
 !
TOK_WHILE
) {

25546 
œbñ_bªak
, 
mask
;

25547 
BlockEnv
 
bªak_íåy
;

25549 
œbñ_bªak
 = 
	`√w_œbñ
(
s
);

25550 
	`push_bªak_íåy
(
s
->
cur_func
, &
bªak_íåy
,

25551 
œbñ_«me
, 
œbñ_bªak
, -1, 0);

25552 i‡(!(
s
->
cur_func
->
js_mode
 & 
JS_MODE_STRICT
) &&

25553 (
de˛_mask
 & 
DECL_MASK_FUNC_WITH_LABEL
)) {

25554 
mask
 = 
DECL_MASK_FUNC
 | 
DECL_MASK_FUNC_WITH_LABEL
;

25556 
mask
 = 0;

25558 i‡(
	`js_∑r£_°©emít_‹_de˛
(
s
, 
mask
))

25559 
Áû
;

25560 
	`emô_œbñ
(
s
, 
œbñ_bªak
);

25561 
	`p›_bªak_íåy
(
s
->
cur_func
);

25562 
d⁄e
;

25566 
tok
 = 
s
->
tokí
.
vÆ
) {

25568 i‡(
	`js_∑r£_block
(
s
))

25569 
Áû
;

25571 
TOK_RETURN
:

25572 i‡(
s
->
cur_func
->
is_evÆ
) {

25573 
	`js_∑r£_îr‹
(
s
, "returnÇot iná function");

25574 
Áû
;

25576 i‡(
	`√xt_tokí
(
s
))

25577 
Áû
;

25578 i‡(
s
->
tokí
.
vÆ
 !';' && s->tokí.vÆ !'}' && !s->
gŸ_lf
) {

25579 i‡(
	`js_∑r£_ex¥
(
s
))

25580 
Áû
;

25581 
	`emô_ªtu∫
(
s
, 
TRUE
);

25583 
	`emô_ªtu∫
(
s
, 
FALSE
);

25585 i‡(
	`js_∑r£_ex≥˘_£mi
(
s
))

25586 
Áû
;

25588 
TOK_THROW
:

25589 i‡(
	`√xt_tokí
(
s
))

25590 
Áû
;

25591 i‡(
s
->
gŸ_lf
) {

25592 
	`js_∑r£_îr‹
(
s
, "lineÅerminatorÇotállowedáfterÅhrow");

25593 
Áû
;

25595 i‡(
	`js_∑r£_ex¥
(
s
))

25596 
Áû
;

25597 
	`emô_›
(
s
, 
OP_throw
);

25598 i‡(
	`js_∑r£_ex≥˘_£mi
(
s
))

25599 
Áû
;

25601 
TOK_LET
:

25602 
TOK_CONST
:

25603 
ha¶ë
:

25604 i‡(!(
de˛_mask
 & 
DECL_MASK_OTHER
)) {

25605 
	`js_∑r£_îr‹
(
s
, "lexical declarations can'táppear in single-statement context");

25606 
Áû
;

25609 
TOK_VAR
:

25610 i‡(
	`√xt_tokí
(
s
))

25611 
Áû
;

25612 i‡(
	`js_∑r£_v¨
(
s
, 
TRUE
, 
tok
, 
FALSE
))

25613 
Áû
;

25614 i‡(
	`js_∑r£_ex≥˘_£mi
(
s
))

25615 
Áû
;

25617 
TOK_IF
:

25619 
œbñ1
, 
œbñ2
, 
mask
;

25620 i‡(
	`√xt_tokí
(
s
))

25621 
Áû
;

25623 
	`push_sc›e
(
s
);

25624 
	`£t_evÆ_ªt_undeföed
(
s
);

25625 i‡(
	`js_∑r£_ex¥_∑ªn
(
s
))

25626 
Áû
;

25627 
œbñ1
 = 
	`emô_gŸo
(
s
, 
OP_if_Ál£
, -1);

25628 i‡(
s
->
cur_func
->
js_mode
 & 
JS_MODE_STRICT
)

25629 
mask
 = 0;

25631 
mask
 = 
DECL_MASK_FUNC
;

25633 i‡(
	`js_∑r£_°©emít_‹_de˛
(
s
, 
mask
))

25634 
Áû
;

25636 i‡(
s
->
tokí
.
vÆ
 =
TOK_ELSE
) {

25637 
œbñ2
 = 
	`emô_gŸo
(
s
, 
OP_gŸo
, -1);

25638 i‡(
	`√xt_tokí
(
s
))

25639 
Áû
;

25641 
	`emô_œbñ
(
s
, 
œbñ1
);

25642 i‡(
	`js_∑r£_°©emít_‹_de˛
(
s
, 
mask
))

25643 
Áû
;

25645 
œbñ1
 = 
œbñ2
;

25647 
	`emô_œbñ
(
s
, 
œbñ1
);

25648 
	`p›_sc›e
(
s
);

25651 
TOK_WHILE
:

25653 
œbñ_c⁄t
, 
œbñ_bªak
;

25654 
BlockEnv
 
bªak_íåy
;

25656 
œbñ_c⁄t
 = 
	`√w_œbñ
(
s
);

25657 
œbñ_bªak
 = 
	`√w_œbñ
(
s
);

25659 
	`push_bªak_íåy
(
s
->
cur_func
, &
bªak_íåy
,

25660 
œbñ_«me
, 
œbñ_bªak
, 
œbñ_c⁄t
, 0);

25662 i‡(
	`√xt_tokí
(
s
))

25663 
Áû
;

25665 
	`£t_evÆ_ªt_undeföed
(
s
);

25667 
	`emô_œbñ
(
s
, 
œbñ_c⁄t
);

25668 i‡(
	`js_∑r£_ex¥_∑ªn
(
s
))

25669 
Áû
;

25670 
	`emô_gŸo
(
s
, 
OP_if_Ál£
, 
œbñ_bªak
);

25672 i‡(
	`js_∑r£_°©emít
(
s
))

25673 
Áû
;

25674 
	`emô_gŸo
(
s
, 
OP_gŸo
, 
œbñ_c⁄t
);

25676 
	`emô_œbñ
(
s
, 
œbñ_bªak
);

25678 
	`p›_bªak_íåy
(
s
->
cur_func
);

25681 
TOK_DO
:

25683 
œbñ_c⁄t
, 
œbñ_bªak
, 
œbñ1
;

25684 
BlockEnv
 
bªak_íåy
;

25686 
œbñ_c⁄t
 = 
	`√w_œbñ
(
s
);

25687 
œbñ_bªak
 = 
	`√w_œbñ
(
s
);

25688 
œbñ1
 = 
	`√w_œbñ
(
s
);

25690 
	`push_bªak_íåy
(
s
->
cur_func
, &
bªak_íåy
,

25691 
œbñ_«me
, 
œbñ_bªak
, 
œbñ_c⁄t
, 0);

25693 i‡(
	`√xt_tokí
(
s
))

25694 
Áû
;

25696 
	`emô_œbñ
(
s
, 
œbñ1
);

25698 
	`£t_evÆ_ªt_undeföed
(
s
);

25700 i‡(
	`js_∑r£_°©emít
(
s
))

25701 
Áû
;

25703 
	`emô_œbñ
(
s
, 
œbñ_c⁄t
);

25704 i‡(
	`js_∑r£_ex≥˘
(
s
, 
TOK_WHILE
))

25705 
Áû
;

25706 i‡(
	`js_∑r£_ex¥_∑ªn
(
s
))

25707 
Áû
;

25709 i‡(
s
->
tokí
.
vÆ
 == ';') {

25710 i‡(
	`√xt_tokí
(
s
))

25711 
Áû
;

25713 
	`emô_gŸo
(
s
, 
OP_if_åue
, 
œbñ1
);

25715 
	`emô_œbñ
(
s
, 
œbñ_bªak
);

25717 
	`p›_bªak_íåy
(
s
->
cur_func
);

25720 
TOK_FOR
:

25722 
œbñ_c⁄t
, 
œbñ_bªak
, 
œbñ_body
, 
œbñ_ã°
;

25723 
pos_c⁄t
, 
pos_body
, 
block_sc›e_Àvñ
;

25724 
BlockEnv
 
bªak_íåy
;

25725 
tok
, 
bôs
;

25726 
BOOL
 
is_async
;

25728 i‡(
	`√xt_tokí
(
s
))

25729 
Áû
;

25731 
	`£t_evÆ_ªt_undeföed
(
s
);

25732 
bôs
 = 0;

25733 
is_async
 = 
FALSE
;

25734 i‡(
s
->
tokí
.
vÆ
 == '(') {

25735 
	`js_∑r£_skù_∑ªns_tokí
(
s
, &
bôs
, 
FALSE
);

25736 } i‡(
s
->
tokí
.
vÆ
 =
TOK_AWAIT
) {

25737 i‡(!(
s
->
cur_func
->
func_köd
 & 
JS_FUNC_ASYNC
)) {

25738 
	`js_∑r£_îr‹
(
s
, "foráwait is only valid inásynchronous functions");

25739 
Áû
;

25741 
is_async
 = 
TRUE
;

25742 i‡(
	`√xt_tokí
(
s
))

25743 
Áû
;

25745 i‡(
	`js_∑r£_ex≥˘
(
s
, '('))

25746 
Áû
;

25748 i‡(!(
bôs
 & 
SKIP_HAS_SEMI
)) {

25750 i‡(
	`js_∑r£_f‹_ö_of
(
s
, 
œbñ_«me
, 
is_async
))

25751 
Áû
;

25754 
block_sc›e_Àvñ
 = 
s
->
cur_func
->
sc›e_Àvñ
;

25758 
	`push_sc›e
(
s
);

25760 
tok
 = 
s
->
tokí
.
vÆ
;

25761 i‡(
tok
 != ';') {

25762 
	`is_Àt
(
s
, 
DECL_MASK_OTHER
)) {

25763 
TRUE
:

25764 
tok
 = 
TOK_LET
;

25766 
FALSE
:

25769 
Áû
;

25771 i‡(
tok
 =
TOK_VAR
 ||Åok =
TOK_LET
 ||Åok =
TOK_CONST
) {

25772 i‡(
	`√xt_tokí
(
s
))

25773 
Áû
;

25774 i‡(
	`js_∑r£_v¨
(
s
, 
FALSE
, 
tok
, FALSE))

25775 
Áû
;

25777 i‡(
	`js_∑r£_ex¥2
(
s
, 
FALSE
))

25778 
Áû
;

25779 
	`emô_›
(
s
, 
OP_dr›
);

25783 
	`˛o£_sc›es
(
s
, s->
cur_func
->
sc›e_Àvñ
, 
block_sc›e_Àvñ
);

25785 i‡(
	`js_∑r£_ex≥˘
(
s
, ';'))

25786 
Áû
;

25788 
œbñ_ã°
 = 
	`√w_œbñ
(
s
);

25789 
œbñ_c⁄t
 = 
	`√w_œbñ
(
s
);

25790 
œbñ_body
 = 
	`√w_œbñ
(
s
);

25791 
œbñ_bªak
 = 
	`√w_œbñ
(
s
);

25793 
	`push_bªak_íåy
(
s
->
cur_func
, &
bªak_íåy
,

25794 
œbñ_«me
, 
œbñ_bªak
, 
œbñ_c⁄t
, 0);

25797 i‡(
s
->
tokí
.
vÆ
 == ';') {

25799 
œbñ_ã°
 = 
œbñ_body
;

25801 
	`emô_œbñ
(
s
, 
œbñ_ã°
);

25802 i‡(
	`js_∑r£_ex¥
(
s
))

25803 
Áû
;

25804 
	`emô_gŸo
(
s
, 
OP_if_Ál£
, 
œbñ_bªak
);

25806 i‡(
	`js_∑r£_ex≥˘
(
s
, ';'))

25807 
Áû
;

25809 i‡(
s
->
tokí
.
vÆ
 == ')') {

25811 
bªak_íåy
.
œbñ_c⁄t
 =Üabñ_c⁄à
œbñ_ã°
;

25812 
pos_c⁄t
 = 0;

25815 
	`emô_gŸo
(
s
, 
OP_gŸo
, 
œbñ_body
);

25817 
pos_c⁄t
 = 
s
->
cur_func
->
byã_code
.
size
;

25818 
	`emô_œbñ
(
s
, 
œbñ_c⁄t
);

25819 i‡(
	`js_∑r£_ex¥
(
s
))

25820 
Áû
;

25821 
	`emô_›
(
s
, 
OP_dr›
);

25822 i‡(
œbñ_ã°
 !
œbñ_body
)

25823 
	`emô_gŸo
(
s
, 
OP_gŸo
, 
œbñ_ã°
);

25825 i‡(
	`js_∑r£_ex≥˘
(
s
, ')'))

25826 
Áû
;

25828 
pos_body
 = 
s
->
cur_func
->
byã_code
.
size
;

25829 
	`emô_œbñ
(
s
, 
œbñ_body
);

25830 i‡(
	`js_∑r£_°©emít
(
s
))

25831 
Áû
;

25835 
	`˛o£_sc›es
(
s
, s->
cur_func
->
sc›e_Àvñ
, 
block_sc›e_Àvñ
);

25837 i‡(
OPTIMIZE
 && 
œbñ_ã°
 !
œbñ_body
 && 
œbñ_c⁄t
 !=Üabel_test) {

25839 
DynBuf
 *
bc
 = &
s
->
cur_func
->
byã_code
;

25840 
chunk_size
 = 
pos_body
 - 
pos_c⁄t
;

25841 
off£t
 = 
bc
->
size
 - 
pos_c⁄t
;

25842 
i
;

25843 
	`dbuf_ªÆloc
(
bc
, bc->
size
 + 
chunk_size
);

25844 
	`dbuf_put
(
bc
, bc->
buf
 + 
pos_c⁄t
, 
chunk_size
);

25845 
	`mem£t
(
bc
->
buf
 + 
pos_c⁄t
, 
OP_n›
, 
chunk_size
);

25847 
s
->
cur_func
->
œ°_›code_pos
 = 
bc
->
size
 - 5;

25849 
i
 = 
œbñ_c⁄t
; i < 
s
->
cur_func
->
œbñ_cou¡
; i++) {

25850 
LabñSlŸ
 *
ls
 = &
s
->
cur_func
->
œbñ_¶Ÿs
[
i
];

25851 i‡(
ls
->
pos
 >
pos_c⁄t
 &&Üs->po†< 
pos_body
)

25852 
ls
->
pos
 +
off£t
;

25855 
	`emô_gŸo
(
s
, 
OP_gŸo
, 
œbñ_c⁄t
);

25858 
	`emô_œbñ
(
s
, 
œbñ_bªak
);

25860 
	`p›_bªak_íåy
(
s
->
cur_func
);

25861 
	`p›_sc›e
(
s
);

25864 
TOK_BREAK
:

25865 
TOK_CONTINUE
:

25867 
is_c⁄t
 = 
s
->
tokí
.
vÆ
 - 
TOK_BREAK
;

25868 
œbñ
;

25870 i‡(
	`√xt_tokí
(
s
))

25871 
Áû
;

25872 i‡(!
s
->
gŸ_lf
 && s->
tokí
.
vÆ
 =
TOK_IDENT
 && !s->tokí.
u
.
idít
.
is_ª£rved
)

25873 
œbñ
 = 
s
->
tokí
.
u
.
idít
.
©om
;

25875 
œbñ
 = 
JS_ATOM_NULL
;

25876 i‡(
	`emô_bªak
(
s
, 
œbñ
, 
is_c⁄t
))

25877 
Áû
;

25878 i‡(
œbñ
 !
JS_ATOM_NULL
) {

25879 i‡(
	`√xt_tokí
(
s
))

25880 
Áû
;

25882 i‡(
	`js_∑r£_ex≥˘_£mi
(
s
))

25883 
Áû
;

25886 
TOK_SWITCH
:

25888 
œbñ_ˇ£
, 
œbñ_bªak
, 
œbñ1
;

25889 
deÁu…_œbñ_pos
;

25890 
BlockEnv
 
bªak_íåy
;

25892 i‡(
	`√xt_tokí
(
s
))

25893 
Áû
;

25895 
	`£t_evÆ_ªt_undeföed
(
s
);

25896 i‡(
	`js_∑r£_ex¥_∑ªn
(
s
))

25897 
Áû
;

25899 
	`push_sc›e
(
s
);

25900 
œbñ_bªak
 = 
	`√w_œbñ
(
s
);

25901 
	`push_bªak_íåy
(
s
->
cur_func
, &
bªak_íåy
,

25902 
œbñ_«me
, 
œbñ_bªak
, -1, 1);

25904 i‡(
	`js_∑r£_ex≥˘
(
s
, '{'))

25905 
Áû
;

25907 
deÁu…_œbñ_pos
 = -1;

25908 
œbñ_ˇ£
 = -1;

25909 
s
->
tokí
.
vÆ
 != '}') {

25910 i‡(
s
->
tokí
.
vÆ
 =
TOK_CASE
) {

25911 
œbñ1
 = -1;

25912 i‡(
œbñ_ˇ£
 >= 0) {

25914 
œbñ1
 = 
	`emô_gŸo
(
s
, 
OP_gŸo
, -1);

25916 
	`emô_œbñ
(
s
, 
œbñ_ˇ£
);

25917 
œbñ_ˇ£
 = -1;

25920 i‡(
	`√xt_tokí
(
s
))

25921 
Áû
;

25922 
	`emô_›
(
s
, 
OP_dup
);

25923 i‡(
	`js_∑r£_ex¥
(
s
))

25924 
Áû
;

25925 i‡(
	`js_∑r£_ex≥˘
(
s
, ':'))

25926 
Áû
;

25927 
	`emô_›
(
s
, 
OP_°ri˘_eq
);

25928 i‡(
s
->
tokí
.
vÆ
 =
TOK_CASE
) {

25929 
œbñ1
 = 
	`emô_gŸo
(
s
, 
OP_if_åue
,Üabel1);

25931 
œbñ_ˇ£
 = 
	`emô_gŸo
(
s
, 
OP_if_Ál£
, -1);

25932 
	`emô_œbñ
(
s
, 
œbñ1
);

25936 } i‡(
s
->
tokí
.
vÆ
 =
TOK_DEFAULT
) {

25937 i‡(
	`√xt_tokí
(
s
))

25938 
Áû
;

25939 i‡(
	`js_∑r£_ex≥˘
(
s
, ':'))

25940 
Áû
;

25941 i‡(
deÁu…_œbñ_pos
 >= 0) {

25942 
	`js_∑r£_îr‹
(
s
, "duplicate default");

25943 
Áû
;

25945 i‡(
œbñ_ˇ£
 < 0) {

25947 
œbñ_ˇ£
 = 
	`emô_gŸo
(
s
, 
OP_gŸo
, -1);

25954 
	`emô_›
(
s
, 
OP_œbñ
);

25955 
	`emô_u32
(
s
, 0);

25956 
deÁu…_œbñ_pos
 = 
s
->
cur_func
->
byã_code
.
size
 - 4;

25958 i‡(
œbñ_ˇ£
 < 0) {

25960 
	`js_∑r£_îr‹
(
s
, "invalid switch statement");

25961 
Áû
;

25963 i‡(
	`js_∑r£_°©emít_‹_de˛
(
s
, 
DECL_MASK_ALL
))

25964 
Áû
;

25967 i‡(
	`js_∑r£_ex≥˘
(
s
, '}'))

25968 
Áû
;

25969 i‡(
deÁu…_œbñ_pos
 >= 0) {

25971 
	`put_u32
(
s
->
cur_func
->
byã_code
.
buf
 + 
deÁu…_œbñ_pos
,

25972 
œbñ_ˇ£
);

25973 
s
->
cur_func
->
œbñ_¶Ÿs
[
œbñ_ˇ£
].
pos
 = 
deÁu…_œbñ_pos
 + 4;

25975 
	`emô_œbñ
(
s
, 
œbñ_ˇ£
);

25977 
	`emô_œbñ
(
s
, 
œbñ_bªak
);

25978 
	`emô_›
(
s
, 
OP_dr›
);

25980 
	`p›_bªak_íåy
(
s
->
cur_func
);

25981 
	`p›_sc›e
(
s
);

25984 
TOK_TRY
:

25986 
œbñ_ˇtch
, 
œbñ_ˇtch2
, 
œbñ_föÆly
, 
œbñ_íd
;

25987 
JSAtom
 
«me
;

25988 
BlockEnv
 
block_ív
;

25990 
	`£t_evÆ_ªt_undeföed
(
s
);

25991 i‡(
	`√xt_tokí
(
s
))

25992 
Áû
;

25993 
œbñ_ˇtch
 = 
	`√w_œbñ
(
s
);

25994 
œbñ_ˇtch2
 = 
	`√w_œbñ
(
s
);

25995 
œbñ_föÆly
 = 
	`√w_œbñ
(
s
);

25996 
œbñ_íd
 = 
	`√w_œbñ
(
s
);

25998 
	`emô_gŸo
(
s
, 
OP_ˇtch
, 
œbñ_ˇtch
);

26000 
	`push_bªak_íåy
(
s
->
cur_func
, &
block_ív
,

26001 
JS_ATOM_NULL
, -1, -1, 1);

26002 
block_ív
.
œbñ_föÆly
 =Üabel_finally;

26004 i‡(
	`js_∑r£_block
(
s
))

26005 
Áû
;

26007 
	`p›_bªak_íåy
(
s
->
cur_func
);

26009 i‡(
	`js_is_live_code
(
s
)) {

26011 
	`emô_›
(
s
, 
OP_dr›
);

26013 
	`emô_›
(
s
, 
OP_undeföed
);

26014 
	`emô_gŸo
(
s
, 
OP_gosub
, 
œbñ_föÆly
);

26015 
	`emô_›
(
s
, 
OP_dr›
);

26017 
	`emô_gŸo
(
s
, 
OP_gŸo
, 
œbñ_íd
);

26020 i‡(
s
->
tokí
.
vÆ
 =
TOK_CATCH
) {

26021 i‡(
	`√xt_tokí
(
s
))

26022 
Áû
;

26024 
	`push_sc›e
(
s
);

26025 
	`emô_œbñ
(
s
, 
œbñ_ˇtch
);

26027 i‡(
s
->
tokí
.
vÆ
 == '{') {

26029 
	`emô_›
(
s
, 
OP_dr›
);

26031 i‡(
	`js_∑r£_ex≥˘
(
s
, '('))

26032 
Áû
;

26033 i‡(!(
s
->
tokí
.
vÆ
 =
TOK_IDENT
 && !s->tokí.
u
.
idít
.
is_ª£rved
)) {

26034 i‡(
s
->
tokí
.
vÆ
 == '[' || s->token.val == '{') {

26036 i‡(
	`js_∑r£_de°ru˘urög_ñemít
(
s
, 
TOK_LET
, 0, 
TRUE
, -1, TRUE))

26037 
Áû
;

26039 
	`js_∑r£_îr‹
(
s
, "identifierÉxpected");

26040 
Áû
;

26043 
«me
 = 
	`JS_DupAtom
(
˘x
, 
s
->
tokí
.
u
.
idít
.
©om
);

26044 i‡(
	`√xt_tokí
(
s
)

26045 || 
	`js_deföe_v¨
(
s
, 
«me
, 
TOK_CATCH
) < 0) {

26046 
	`JS_FªeAtom
(
˘x
, 
«me
);

26047 
Áû
;

26050 
	`emô_›
(
s
, 
OP_sc›e_put_v¨
);

26051 
	`emô_u32
(
s
, 
«me
);

26052 
	`emô_u16
(
s
, s->
cur_func
->
sc›e_Àvñ
);

26054 i‡(
	`js_∑r£_ex≥˘
(
s
, ')'))

26055 
Áû
;

26058 
	`emô_gŸo
(
s
, 
OP_ˇtch
, 
œbñ_ˇtch2
);

26060 
	`push_sc›e
(
s
);

26061 
	`push_bªak_íåy
(
s
->
cur_func
, &
block_ív
, 
JS_ATOM_NULL
,

26063 
block_ív
.
œbñ_föÆly
 =Üabel_finally;

26065 i‡(
	`js_∑r£_block
(
s
))

26066 
Áû
;

26068 
	`p›_bªak_íåy
(
s
->
cur_func
);

26069 
	`p›_sc›e
(
s
);

26070 
	`p›_sc›e
(
s
);

26072 i‡(
	`js_is_live_code
(
s
)) {

26074 
	`emô_›
(
s
, 
OP_dr›
);

26077 
	`emô_›
(
s
, 
OP_undeföed
);

26078 
	`emô_gŸo
(
s
, 
OP_gosub
, 
œbñ_föÆly
);

26079 
	`emô_›
(
s
, 
OP_dr›
);

26080 
	`emô_gŸo
(
s
, 
OP_gŸo
, 
œbñ_íd
);

26084 
	`emô_œbñ
(
s
, 
œbñ_ˇtch2
);

26086 
	`emô_gŸo
(
s
, 
OP_gosub
, 
œbñ_föÆly
);

26087 
	`emô_›
(
s
, 
OP_throw
);

26089 } i‡(
s
->
tokí
.
vÆ
 =
TOK_FINALLY
) {

26092 
	`emô_œbñ
(
s
, 
œbñ_ˇtch
);

26094 
	`emô_gŸo
(
s
, 
OP_gosub
, 
œbñ_föÆly
);

26095 
	`emô_›
(
s
, 
OP_throw
);

26097 
	`js_∑r£_îr‹
(
s
, "expecting catch or finally");

26098 
Áû
;

26100 
	`emô_œbñ
(
s
, 
œbñ_föÆly
);

26101 i‡(
s
->
tokí
.
vÆ
 =
TOK_FINALLY
) {

26102 
ßved_evÆ_ªt_idx
;

26103 i‡(
	`√xt_tokí
(
s
))

26104 
Áû
;

26106 
	`push_bªak_íåy
(
s
->
cur_func
, &
block_ív
, 
JS_ATOM_NULL
,

26108 
ßved_evÆ_ªt_idx
 = 
s
->
cur_func
->
evÆ_ªt_idx
;

26109 
s
->
cur_func
->
evÆ_ªt_idx
 = -1;

26111 i‡(
	`js_∑r£_block
(
s
))

26112 
Áû
;

26113 
s
->
cur_func
->
evÆ_ªt_idx
 = 
ßved_evÆ_ªt_idx
;

26114 
	`p›_bªak_íåy
(
s
->
cur_func
);

26116 
	`emô_›
(
s
, 
OP_ªt
);

26117 
	`emô_œbñ
(
s
, 
œbñ_íd
);

26122 i‡(
	`√xt_tokí
(
s
))

26123 
Áû
;

26125 
TOK_WITH
:

26126 i‡(
s
->
cur_func
->
js_mode
 & 
JS_MODE_STRICT
) {

26127 
	`js_∑r£_îr‹
(
s
, "invalid keyword: with");

26128 
Áû
;

26130 
wôh_idx
;

26132 i‡(
	`√xt_tokí
(
s
))

26133 
Áû
;

26135 i‡(
	`js_∑r£_ex¥_∑ªn
(
s
))

26136 
Áû
;

26138 
	`push_sc›e
(
s
);

26139 
wôh_idx
 = 
	`deföe_v¨
(
s
, s->
cur_func
, 
JS_ATOM__wôh_
,

26140 
JS_VAR_DEF_WITH
);

26141 i‡(
wôh_idx
 < 0)

26142 
Áû
;

26143 
	`emô_›
(
s
, 
OP_to_obje˘
);

26144 
	`emô_›
(
s
, 
OP_put_loc
);

26145 
	`emô_u16
(
s
, 
wôh_idx
);

26147 
	`£t_evÆ_ªt_undeföed
(
s
);

26148 i‡(
	`js_∑r£_°©emít
(
s
))

26149 
Áû
;

26152 
	`p›_sc›e
(
s
);

26155 
TOK_FUNCTION
:

26157 i‡(!(
de˛_mask
 & 
DECL_MASK_FUNC
))

26158 
func_de˛_îr‹
;

26159 i‡(!(
de˛_mask
 & 
DECL_MASK_OTHER
Ë&& 
	`≥ek_tokí
(
s
, 
FALSE
) == '*')

26160 
func_de˛_îr‹
;

26161 
∑r£_func_v¨
;

26162 
TOK_IDENT
:

26163 i‡(
s
->
tokí
.
u
.
idít
.
is_ª£rved
) {

26164 
	`js_∑r£_îr‹_ª£rved_idítifõr
(
s
);

26165 
Áû
;

26168 
	`is_Àt
(
s
, 
de˛_mask
)) {

26169 
TRUE
:

26170 
tok
 = 
TOK_LET
;

26171 
ha¶ë
;

26172 
FALSE
:

26175 
Áû
;

26177 i‡(
	`tokí_is_p£udo_keyw‹d
(
s
, 
JS_ATOM_async
) &&

26178 
	`≥ek_tokí
(
s
, 
TRUE
Ë=
TOK_FUNCTION
) {

26179 i‡(!(
de˛_mask
 & 
DECL_MASK_OTHER
)) {

26180 
func_de˛_îr‹
:

26181 
	`js_∑r£_îr‹
(
s
, "function declarations can'táppear in single-statement context");

26182 
Áû
;

26184 
∑r£_func_v¨
:

26185 i‡(
	`js_∑r£_fun˘i⁄_de˛
(
s
, 
JS_PARSE_FUNC_VAR
,

26186 
JS_FUNC_NORMAL
, 
JS_ATOM_NULL
,

26187 
s
->
tokí
.
±r
, s->tokí.
löe_num
))

26188 
Áû
;

26191 
ha£x¥
;

26193 
TOK_CLASS
:

26194 i‡(!(
de˛_mask
 & 
DECL_MASK_OTHER
)) {

26195 
	`js_∑r£_îr‹
(
s
, "class declarations can'táppear in single-statement context");

26196 
Áû
;

26198 i‡(
	`js_∑r£_˛ass
(
s
, 
FALSE
, 
JS_PARSE_EXPORT_NONE
))

26202 
TOK_DEBUGGER
:

26204 i‡(
	`√xt_tokí
(
s
))

26205 
Áû
;

26206 i‡(
	`js_∑r£_ex≥˘_£mi
(
s
))

26207 
Áû
;

26210 
TOK_ENUM
:

26211 
TOK_EXPORT
:

26212 
TOK_EXTENDS
:

26213 
	`js_unsuµ‹ãd_keyw‹d
(
s
, s->
tokí
.
u
.
idít
.
©om
);

26214 
Áû
;

26217 
ha£x¥
:

26218 i‡(
	`js_∑r£_ex¥
(
s
))

26219 
Áû
;

26220 i‡(
s
->
cur_func
->
evÆ_ªt_idx
 >= 0) {

26223 
	`emô_›
(
s
, 
OP_put_loc
);

26224 
	`emô_u16
(
s
, s->
cur_func
->
evÆ_ªt_idx
);

26226 
	`emô_›
(
s
, 
OP_dr›
);

26228 i‡(
	`js_∑r£_ex≥˘_£mi
(
s
))

26229 
Áû
;

26232 
d⁄e
:

26233 
	`JS_FªeAtom
(
˘x
, 
œbñ_«me
);

26235 
Áû
:

26236 
	`JS_FªeAtom
(
˘x
, 
œbñ_«me
);

26238 
	}
}

26241 
JSModuÀDef
 *
	$js_√w_moduÀ_def
(
JSC⁄ãxt
 *
˘x
, 
JSAtom
 
«me
)

26243 
JSModuÀDef
 *
m
;

26244 
m
 = 
	`js_mÆlocz
(
˘x
, (*m));

26245 i‡(!
m
) {

26246 
	`JS_FªeAtom
(
˘x
, 
«me
);

26247  
NULL
;

26249 
m
->
hódî
.
ªf_cou¡
 = 1;

26250 
m
->
moduÀ_«me
 = 
«me
;

26251 
m
->
moduÀ_ns
 = 
JS_UNDEFINED
;

26252 
m
->
func_obj
 = 
JS_UNDEFINED
;

26253 
m
->
evÆ_ex˚±i⁄
 = 
JS_UNDEFINED
;

26254 
m
->
mëa_obj
 = 
JS_UNDEFINED
;

26255 
	`li°_add_èû
(&
m
->
lök
, &
˘x
->
lﬂded_moduÀs
);

26256  
m
;

26257 
	}
}

26259 
	$js_m¨k_moduÀ_def
(
JSRu¡ime
 *
π
, 
JSModuÀDef
 *
m
,

26260 
JS_M¨kFunc
 *
m¨k_func
)

26262 
i
;

26264 
i
 = 0; i < 
m
->
exp‹t_íåõs_cou¡
; i++) {

26265 
JSExp‹tE¡ry
 *
me
 = &
m
->
exp‹t_íåõs
[
i
];

26266 i‡(
me
->
exp‹t_ty≥
 =
JS_EXPORT_TYPE_LOCAL
 &&

26267 
me
->
u
.
loˇl
.
v¨_ªf
) {

26268 
	`m¨k_func
(
π
, &
me
->
u
.
loˇl
.
v¨_ªf
->
hódî
);

26272 
	`JS_M¨kVÆue
(
π
, 
m
->
moduÀ_ns
, 
m¨k_func
);

26273 
	`JS_M¨kVÆue
(
π
, 
m
->
func_obj
, 
m¨k_func
);

26274 
	`JS_M¨kVÆue
(
π
, 
m
->
evÆ_ex˚±i⁄
, 
m¨k_func
);

26275 
	`JS_M¨kVÆue
(
π
, 
m
->
mëa_obj
, 
m¨k_func
);

26276 
	}
}

26278 
	$js_‰ì_moduÀ_def
(
JSC⁄ãxt
 *
˘x
, 
JSModuÀDef
 *
m
)

26280 
i
;

26282 
	`JS_FªeAtom
(
˘x
, 
m
->
moduÀ_«me
);

26284 
i
 = 0; i < 
m
->
ªq_moduÀ_íåõs_cou¡
; i++) {

26285 
JSReqModuÀE¡ry
 *
rme
 = &
m
->
ªq_moduÀ_íåõs
[
i
];

26286 
	`JS_FªeAtom
(
˘x
, 
rme
->
moduÀ_«me
);

26288 
	`js_‰ì
(
˘x
, 
m
->
ªq_moduÀ_íåõs
);

26290 
i
 = 0; i < 
m
->
exp‹t_íåõs_cou¡
; i++) {

26291 
JSExp‹tE¡ry
 *
me
 = &
m
->
exp‹t_íåõs
[
i
];

26292 i‡(
me
->
exp‹t_ty≥
 =
JS_EXPORT_TYPE_LOCAL
)

26293 
	`‰ì_v¨_ªf
(
˘x
->
π
, 
me
->
u
.
loˇl
.
v¨_ªf
);

26294 
	`JS_FªeAtom
(
˘x
, 
me
->
exp‹t_«me
);

26295 
	`JS_FªeAtom
(
˘x
, 
me
->
loˇl_«me
);

26297 
	`js_‰ì
(
˘x
, 
m
->
exp‹t_íåõs
);

26299 
	`js_‰ì
(
˘x
, 
m
->
°¨_exp‹t_íåõs
);

26301 
i
 = 0; i < 
m
->
imp‹t_íåõs_cou¡
; i++) {

26302 
JSImp‹tE¡ry
 *
mi
 = &
m
->
imp‹t_íåõs
[
i
];

26303 
	`JS_FªeAtom
(
˘x
, 
mi
->
imp‹t_«me
);

26305 
	`js_‰ì
(
˘x
, 
m
->
imp‹t_íåõs
);

26307 
	`JS_FªeVÆue
(
˘x
, 
m
->
moduÀ_ns
);

26308 
	`JS_FªeVÆue
(
˘x
, 
m
->
func_obj
);

26309 
	`JS_FªeVÆue
(
˘x
, 
m
->
evÆ_ex˚±i⁄
);

26310 
	`JS_FªeVÆue
(
˘x
, 
m
->
mëa_obj
);

26311 
	`li°_dñ
(&
m
->
lök
);

26312 
	`js_‰ì
(
˘x
, 
m
);

26313 
	}
}

26315 
	$js_ªsize_¨øy
(
JSC⁄ãxt
 *
˘x
, **
∑ºay
, 
ñem_size
,

26316 *
psize
, *
pcou¡
, 
√w_cou¡
)

26318 i‡(
	`u∆ikñy
(
√w_cou¡
 > *
psize
)) {

26319 
√w_size
;

26320 
size_t
 
¶ack
;

26321 *
√w_¨øy
;

26323 
√w_size
 = 
	`max_öt
(
√w_cou¡
, *
psize
 * 3 / 2);

26324 
√w_¨øy
 = 
	`js_ªÆloc2
(
˘x
, *
∑ºay
, 
√w_size
 * 
ñem_size
, &
¶ack
);

26325 i‡(!
√w_¨øy
)

26327 
√w_size
 +
¶ack
 / 
ñem_size
;

26328 *
psize
 = 
√w_size
;

26329 *
∑ºay
 = 
√w_¨øy
;

26331 *
pcou¡
 = 
√w_cou¡
;

26333 
	}
}

26335 
	$add_ªq_moduÀ_íåy
(
JSC⁄ãxt
 *
˘x
, 
JSModuÀDef
 *
m
,

26336 
JSAtom
 
moduÀ_«me
)

26338 
JSReqModuÀE¡ry
 *
rme
;

26339 
i
;

26342 
i
 = 0; i < 
m
->
ªq_moduÀ_íåõs_cou¡
; i++) {

26343 
rme
 = &
m
->
ªq_moduÀ_íåõs
[
i
];

26344 i‡(
rme
->
moduÀ_«me
 == module_name)

26345  
i
;

26348 i‡(
	`js_ªsize_¨øy
(
˘x
, (**)&
m
->
ªq_moduÀ_íåõs
,

26349 (
JSReqModuÀE¡ry
),

26350 &
m
->
ªq_moduÀ_íåõs_size
, &m->
ªq_moduÀ_íåõs_cou¡
,

26351 
m
->
ªq_moduÀ_íåõs_cou¡
 + 1))

26353 
i
 = 
m
->
ªq_moduÀ_íåõs_cou¡
 - 1;

26354 
rme
 = &
m
->
ªq_moduÀ_íåõs
[
i
];

26355 
rme
->
moduÀ_«me
 = 
	`JS_DupAtom
(
˘x
, module_name);

26356 
rme
->
moduÀ
 = 
NULL
;

26357  
i
;

26358 
	}
}

26360 
JSExp‹tE¡ry
 *
	$föd_exp‹t_íåy
(
JSC⁄ãxt
 *
˘x
, 
JSModuÀDef
 *
m
,

26361 
JSAtom
 
exp‹t_«me
)

26363 
JSExp‹tE¡ry
 *
me
;

26364 
i
;

26365 
i
 = 0; i < 
m
->
exp‹t_íåõs_cou¡
; i++) {

26366 
me
 = &
m
->
exp‹t_íåõs
[
i
];

26367 i‡(
me
->
exp‹t_«me
 ==Éxport_name)

26368  
me
;

26370  
NULL
;

26371 
	}
}

26373 
JSExp‹tE¡ry
 *
	$add_exp‹t_íåy2
(
JSC⁄ãxt
 *
˘x
,

26374 
JSP¨£Sèã
 *
s
, 
JSModuÀDef
 *
m
,

26375 
JSAtom
 
loˇl_«me
, JSAtom 
exp‹t_«me
,

26376 
JSExp‹tTy≥Enum
 
exp‹t_ty≥
)

26378 
JSExp‹tE¡ry
 *
me
;

26380 i‡(
	`föd_exp‹t_íåy
(
˘x
, 
m
, 
exp‹t_«me
)) {

26381 
buf1
[
ATOM_GET_STR_BUF_SIZE
];

26382 i‡(
s
) {

26383 
	`js_∑r£_îr‹
(
s
, "duplicateÉxportedÇame '%s'",

26384 
	`JS_AtomGëSå
(
˘x
, 
buf1
, (buf1), 
exp‹t_«me
));

26386 
	`JS_ThrowSy¡axEº‹
(
˘x
, "duplicateÉxportedÇame '%s'",

26387 
	`JS_AtomGëSå
(
˘x
, 
buf1
, (buf1), 
exp‹t_«me
));

26389  
NULL
;

26392 i‡(
	`js_ªsize_¨øy
(
˘x
, (**)&
m
->
exp‹t_íåõs
,

26393 (
JSExp‹tE¡ry
),

26394 &
m
->
exp‹t_íåõs_size
, &m->
exp‹t_íåõs_cou¡
,

26395 
m
->
exp‹t_íåõs_cou¡
 + 1))

26396  
NULL
;

26397 
me
 = &
m
->
exp‹t_íåõs
[m->
exp‹t_íåõs_cou¡
 - 1];

26398 
	`mem£t
(
me
, 0, (*me));

26399 
me
->
loˇl_«me
 = 
	`JS_DupAtom
(
˘x
,Üocal_name);

26400 
me
->
exp‹t_«me
 = 
	`JS_DupAtom
(
˘x
,Éxport_name);

26401 
me
->
exp‹t_ty≥
 =Éxport_type;

26402  
me
;

26403 
	}
}

26405 
JSExp‹tE¡ry
 *
	$add_exp‹t_íåy
(
JSP¨£Sèã
 *
s
, 
JSModuÀDef
 *
m
,

26406 
JSAtom
 
loˇl_«me
, JSAtom 
exp‹t_«me
,

26407 
JSExp‹tTy≥Enum
 
exp‹t_ty≥
)

26409  
	`add_exp‹t_íåy2
(
s
->
˘x
, s, 
m
, 
loˇl_«me
, 
exp‹t_«me
,

26410 
exp‹t_ty≥
);

26411 
	}
}

26413 
	$add_°¨_exp‹t_íåy
(
JSC⁄ãxt
 *
˘x
, 
JSModuÀDef
 *
m
,

26414 
ªq_moduÀ_idx
)

26416 
JSSèrExp‹tE¡ry
 *
£
;

26418 i‡(
	`js_ªsize_¨øy
(
˘x
, (**)&
m
->
°¨_exp‹t_íåõs
,

26419 (
JSSèrExp‹tE¡ry
),

26420 &
m
->
°¨_exp‹t_íåõs_size
, &m->
°¨_exp‹t_íåõs_cou¡
,

26421 
m
->
°¨_exp‹t_íåõs_cou¡
 + 1))

26423 
£
 = &
m
->
°¨_exp‹t_íåõs
[m->
°¨_exp‹t_íåõs_cou¡
 - 1];

26424 
£
->
ªq_moduÀ_idx
 =Ñeq_module_idx;

26426 
	}
}

26429 
JSModuÀDef
 *
	$JS_NewCModuÀ
(
JSC⁄ãxt
 *
˘x
, c⁄° *
«me_°r
,

26430 
JSModuÀInôFunc
 *
func
)

26432 
JSModuÀDef
 *
m
;

26433 
JSAtom
 
«me
;

26434 
«me
 = 
	`JS_NewAtom
(
˘x
, 
«me_°r
);

26435 i‡(
«me
 =
JS_ATOM_NULL
)

26436  
NULL
;

26437 
m
 = 
	`js_√w_moduÀ_def
(
˘x
, 
«me
);

26438 
m
->
öô_func
 = 
func
;

26439  
m
;

26440 
	}
}

26442 
	$JS_AddModuÀExp‹t
(
JSC⁄ãxt
 *
˘x
, 
JSModuÀDef
 *
m
, c⁄° *
exp‹t_«me
)

26444 
JSExp‹tE¡ry
 *
me
;

26445 
JSAtom
 
«me
;

26446 
«me
 = 
	`JS_NewAtom
(
˘x
, 
exp‹t_«me
);

26447 i‡(
«me
 =
JS_ATOM_NULL
)

26449 
me
 = 
	`add_exp‹t_íåy2
(
˘x
, 
NULL
, 
m
, 
JS_ATOM_NULL
, 
«me
,

26450 
JS_EXPORT_TYPE_LOCAL
);

26451 
	`JS_FªeAtom
(
˘x
, 
«me
);

26452 i‡(!
me
)

26456 
	}
}

26458 
	$JS_SëModuÀExp‹t
(
JSC⁄ãxt
 *
˘x
, 
JSModuÀDef
 *
m
, c⁄° *
exp‹t_«me
,

26459 
JSVÆue
 
vÆ
)

26461 
JSExp‹tE¡ry
 *
me
;

26462 
JSAtom
 
«me
;

26463 
«me
 = 
	`JS_NewAtom
(
˘x
, 
exp‹t_«me
);

26464 i‡(
«me
 =
JS_ATOM_NULL
)

26465 
Áû
;

26466 
me
 = 
	`föd_exp‹t_íåy
(
˘x
, 
m
, 
«me
);

26467 
	`JS_FªeAtom
(
˘x
, 
«me
);

26468 i‡(!
me
)

26469 
Áû
;

26470 
	`£t_vÆue
(
˘x
, 
me
->
u
.
loˇl
.
v¨_ªf
->
pvÆue
, 
vÆ
);

26472 
Áû
:

26473 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

26475 
	}
}

26477 
	$JS_SëModuÀLﬂdîFunc
(
JSRu¡ime
 *
π
,

26478 
JSModuÀN‹mÆizeFunc
 *
moduÀ_n‹mÆize
,

26479 
JSModuÀLﬂdîFunc
 *
moduÀ_lﬂdî
, *
›aque
)

26481 
π
->
moduÀ_n‹mÆize_func
 = 
moduÀ_n‹mÆize
;

26482 
π
->
moduÀ_lﬂdî_func
 = 
moduÀ_lﬂdî
;

26483 
π
->
moduÀ_lﬂdî_›aque
 = 
›aque
;

26484 
	}
}

26487 *
	$js_deÁu…_moduÀ_n‹mÆize_«me
(
JSC⁄ãxt
 *
˘x
,

26488 c⁄° *
ba£_«me
,

26489 c⁄° *
«me
)

26491 *
fûíame
, *
p
;

26492 c⁄° *
r
;

26493 
Àn
;

26495 i‡(
«me
[0] != '.') {

26497  
	`js_°rdup
(
˘x
, 
«me
);

26500 
p
 = 
	`°ºchr
(
ba£_«me
, '/');

26501 i‡(
p
)

26502 
Àn
 = 
p
 - 
ba£_«me
;

26504 
Àn
 = 0;

26506 
fûíame
 = 
	`js_mÆloc
(
˘x
, 
Àn
 + 
	`°æí
(
«me
) + 1 + 1);

26507 i‡(!
fûíame
)

26508  
NULL
;

26509 
	`mem˝y
(
fûíame
, 
ba£_«me
, 
Àn
);

26510 
fûíame
[
Àn
] = '\0';

26513 
r
 = 
«me
;

26515 i‡(
r
[0] == '.' &&Ñ[1] == '/') {

26516 
r
 += 2;

26517 } i‡(
r
[0] == '.' &&Ñ[1] == '.' &&Ñ[2] == '/') {

26520 i‡(
fûíame
[0] == '\0')

26522 
p
 = 
	`°ºchr
(
fûíame
, '/');

26523 i‡(!
p
)

26524 
p
 = 
fûíame
;

26526 
p
++;

26527 i‡(!
	`°rcmp
(
p
, ".") || !strcmp(p, ".."))

26529 i‡(
p
 > 
fûíame
)

26530 
p
--;

26531 *
p
 = '\0';

26532 
r
 += 3;

26537 i‡(
fûíame
[0] != '\0')

26538 
	`°rˇt
(
fûíame
, "/");

26539 
	`°rˇt
(
fûíame
, 
r
);

26541  
fûíame
;

26542 
	}
}

26544 
JSModuÀDef
 *
	$js_föd_lﬂded_moduÀ
(
JSC⁄ãxt
 *
˘x
, 
JSAtom
 
«me
)

26546 
li°_hód
 *
ñ
;

26547 
JSModuÀDef
 *
m
;

26550 
	`li°_f‹_óch
(
ñ
, &
˘x
->
lﬂded_moduÀs
) {

26551 
m
 = 
	`li°_íåy
(
ñ
, 
JSModuÀDef
, 
lök
);

26552 i‡(
m
->
moduÀ_«me
 =
«me
)

26553  
m
;

26555  
NULL
;

26556 
	}
}

26559 
JSModuÀDef
 *
	$js_ho°_ªsﬁve_imp‹ãd_moduÀ
(
JSC⁄ãxt
 *
˘x
,

26560 
JSAtom
 
ba£_moduÀ_«me
,

26561 
JSAtom
 
moduÀ_«me1
)

26563 
JSRu¡ime
 *
π
 = 
˘x
->rt;

26564 
JSModuÀDef
 *
m
;

26565 *
˙ame
;

26566 c⁄° *
ba£_˙ame
, *
˙ame1
;

26567 
JSAtom
 
moduÀ_«me
;

26569 
ba£_˙ame
 = 
	`JS_AtomToCSåög
(
˘x
, 
ba£_moduÀ_«me
);

26570 i‡(!
ba£_˙ame
)

26571  
NULL
;

26572 
˙ame1
 = 
	`JS_AtomToCSåög
(
˘x
, 
moduÀ_«me1
);

26573 i‡(!
˙ame1
) {

26574 
	`JS_FªeCSåög
(
˘x
, 
ba£_˙ame
);

26575  
NULL
;

26578 i‡(!
π
->
moduÀ_n‹mÆize_func
) {

26579 
˙ame
 = 
	`js_deÁu…_moduÀ_n‹mÆize_«me
(
˘x
, 
ba£_˙ame
, 
˙ame1
);

26581 
˙ame
 = 
π
->
	`moduÀ_n‹mÆize_func
(
˘x
, 
ba£_˙ame
, 
˙ame1
,

26582 
π
->
moduÀ_lﬂdî_›aque
);

26584 
	`JS_FªeCSåög
(
˘x
, 
ba£_˙ame
);

26585 
	`JS_FªeCSåög
(
˘x
, 
˙ame1
);

26586 i‡(!
˙ame
)

26587  
NULL
;

26589 
moduÀ_«me
 = 
	`JS_NewAtom
(
˘x
, 
˙ame
);

26590 i‡(
moduÀ_«me
 =
JS_ATOM_NULL
) {

26591 
	`js_‰ì
(
˘x
, 
˙ame
);

26592  
NULL
;

26596 
m
 = 
	`js_föd_lﬂded_moduÀ
(
˘x
, 
moduÀ_«me
);

26597 i‡(
m
) {

26598 
	`js_‰ì
(
˘x
, 
˙ame
);

26599 
	`JS_FªeAtom
(
˘x
, 
moduÀ_«me
);

26600  
m
;

26603 
	`JS_FªeAtom
(
˘x
, 
moduÀ_«me
);

26606 i‡(!
π
->
moduÀ_lﬂdî_func
) {

26608 
	`JS_ThrowRe„ªn˚Eº‹
(
˘x
, "couldÇotÜoad module '%s'",

26609 
˙ame
);

26610 
	`js_‰ì
(
˘x
, 
˙ame
);

26611  
NULL
;

26614 
m
 = 
π
->
	`moduÀ_lﬂdî_func
(
˘x
, 
˙ame
,Ñt->
moduÀ_lﬂdî_›aque
);

26615 
	`js_‰ì
(
˘x
, 
˙ame
);

26616  
m
;

26617 
	}
}

26619 
	sJSResﬁveE¡ry
 {

26620 
JSModuÀDef
 *
	mmoduÀ
;

26621 
JSAtom
 
	m«me
;

26622 } 
	tJSResﬁveE¡ry
;

26624 
	sJSResﬁveSèã
 {

26625 
JSResﬁveE¡ry
 *
	m¨øy
;

26626 
	msize
;

26627 
	mcou¡
;

26628 } 
	tJSResﬁveSèã
;

26630 
	$föd_ªsﬁve_íåy
(
JSResﬁveSèã
 *
s
,

26631 
JSModuÀDef
 *
m
, 
JSAtom
 
«me
)

26633 
i
;

26634 
i
 = 0; i < 
s
->
cou¡
; i++) {

26635 
JSResﬁveE¡ry
 *
ª
 = &
s
->
¨øy
[
i
];

26636 i‡(
ª
->
moduÀ
 =
m
 &&Ñe->
«me
 ==Çame)

26637  
i
;

26640 
	}
}

26642 
	$add_ªsﬁve_íåy
(
JSC⁄ãxt
 *
˘x
, 
JSResﬁveSèã
 *
s
,

26643 
JSModuÀDef
 *
m
, 
JSAtom
 
«me
)

26645 
JSResﬁveE¡ry
 *
ª
;

26647 i‡(
	`js_ªsize_¨øy
(
˘x
, (**)&
s
->
¨øy
,

26648 (
JSResﬁveE¡ry
),

26649 &
s
->
size
, &s->
cou¡
,

26650 
s
->
cou¡
 + 1))

26652 
ª
 = &
s
->
¨øy
[s->
cou¡
 - 1];

26653 
ª
->
moduÀ
 = 
m
;

26654 
ª
->
«me
 = 
	`JS_DupAtom
(
˘x
,Çame);

26656 
	}
}

26658 
	eJSResﬁveResu…Enum
 {

26659 
	mJS_RESOLVE_RES_EXCEPTION
 = -1,

26660 
	mJS_RESOLVE_RES_FOUND
 = 0,

26661 
	mJS_RESOLVE_RES_NOT_FOUND
,

26662 
	mJS_RESOLVE_RES_CIRCULAR
,

26663 
	mJS_RESOLVE_RES_AMBIGUOUS
,

26664 } 
	tJSResﬁveResu…Enum
;

26666 
JSResﬁveResu…Enum
 
	$js_ªsﬁve_exp‹t1
(
JSC⁄ãxt
 *
˘x
,

26667 
JSModuÀDef
 **
pmoduÀ
,

26668 
JSExp‹tE¡ry
 **
pme
,

26669 
JSModuÀDef
 *
m
,

26670 
JSAtom
 
exp‹t_«me
,

26671 
JSResﬁveSèã
 *
s
)

26673 
JSExp‹tE¡ry
 *
me
;

26675 *
pmoduÀ
 = 
NULL
;

26676 *
pme
 = 
NULL
;

26677 i‡(
	`föd_ªsﬁve_íåy
(
s
, 
m
, 
exp‹t_«me
) >= 0)

26678  
JS_RESOLVE_RES_CIRCULAR
;

26679 i‡(
	`add_ªsﬁve_íåy
(
˘x
, 
s
, 
m
, 
exp‹t_«me
) < 0)

26680  
JS_RESOLVE_RES_EXCEPTION
;

26681 
me
 = 
	`föd_exp‹t_íåy
(
˘x
, 
m
, 
exp‹t_«me
);

26682 i‡(
me
) {

26683 i‡(
me
->
exp‹t_ty≥
 =
JS_EXPORT_TYPE_LOCAL
) {

26685 *
pmoduÀ
 = 
m
;

26686 *
pme
 = 
me
;

26687  
JS_RESOLVE_RES_FOUND
;

26690 
JSModuÀDef
 *
m1
;

26691 
m1
 = 
m
->
ªq_moduÀ_íåõs
[
me
->
u
.
ªq_moduÀ_idx
].
moduÀ
;

26692 i‡(
me
->
loˇl_«me
 =
JS_ATOM__°¨_
) {

26694 *
pmoduÀ
 = 
m
;

26695 *
pme
 = 
me
;

26696  
JS_RESOLVE_RES_FOUND
;

26698  
	`js_ªsﬁve_exp‹t1
(
˘x
, 
pmoduÀ
, 
pme
, 
m1
,

26699 
me
->
loˇl_«me
, 
s
);

26703 i‡(
exp‹t_«me
 !
JS_ATOM_deÁu…
) {

26705 
i
;

26707 
i
 = 0; i < 
m
->
°¨_exp‹t_íåõs_cou¡
; i++) {

26708 
JSSèrExp‹tE¡ry
 *
£
 = &
m
->
°¨_exp‹t_íåõs
[
i
];

26709 
JSModuÀDef
 *
m1
, *
ªs_m
;

26710 
JSExp‹tE¡ry
 *
ªs_me
;

26711 
JSResﬁveResu…Enum
 
ªt
;

26713 
m1
 = 
m
->
ªq_moduÀ_íåõs
[
£
->
ªq_moduÀ_idx
].
moduÀ
;

26714 
ªt
 = 
	`js_ªsﬁve_exp‹t1
(
˘x
, &
ªs_m
, &
ªs_me
, 
m1
,

26715 
exp‹t_«me
, 
s
);

26716 i‡(
ªt
 =
JS_RESOLVE_RES_AMBIGUOUS
 ||

26717 
ªt
 =
JS_RESOLVE_RES_EXCEPTION
) {

26718  
ªt
;

26719 } i‡(
ªt
 =
JS_RESOLVE_RES_FOUND
) {

26720 i‡(*
pme
 !
NULL
) {

26721 i‡(*
pmoduÀ
 !
ªs_m
 ||

26722 
ªs_me
->
loˇl_«me
 !(*
pme
)->local_name) {

26723 *
pmoduÀ
 = 
NULL
;

26724 *
pme
 = 
NULL
;

26725  
JS_RESOLVE_RES_AMBIGUOUS
;

26728 *
pmoduÀ
 = 
ªs_m
;

26729 *
pme
 = 
ªs_me
;

26733 i‡(*
pme
 !
NULL
)

26734  
JS_RESOLVE_RES_FOUND
;

26736  
JS_RESOLVE_RES_NOT_FOUND
;

26738 
	}
}

26743 
JSResﬁveResu…Enum
 
	$js_ªsﬁve_exp‹t
(
JSC⁄ãxt
 *
˘x
,

26744 
JSModuÀDef
 **
pmoduÀ
,

26745 
JSExp‹tE¡ry
 **
pme
,

26746 
JSModuÀDef
 *
m
,

26747 
JSAtom
 
exp‹t_«me
)

26749 
JSResﬁveSèã
 
ss
, *
s
 = &ss;

26750 
i
;

26751 
JSResﬁveResu…Enum
 
ªt
;

26753 
s
->
¨øy
 = 
NULL
;

26754 
s
->
size
 = 0;

26755 
s
->
cou¡
 = 0;

26757 
ªt
 = 
	`js_ªsﬁve_exp‹t1
(
˘x
, 
pmoduÀ
, 
pme
, 
m
, 
exp‹t_«me
, 
s
);

26759 
i
 = 0; i < 
s
->
cou¡
; i++)

26760 
	`JS_FªeAtom
(
˘x
, 
s
->
¨øy
[
i
].
«me
);

26761 
	`js_‰ì
(
˘x
, 
s
->
¨øy
);

26763  
ªt
;

26764 
	}
}

26766 
	$js_ªsﬁve_exp‹t_throw_îr‹
(
JSC⁄ãxt
 *
˘x
,

26767 
JSResﬁveResu…Enum
 
ªs
,

26768 
JSModuÀDef
 *
m
, 
JSAtom
 
exp‹t_«me
)

26770 
buf1
[
ATOM_GET_STR_BUF_SIZE
];

26771 
buf2
[
ATOM_GET_STR_BUF_SIZE
];

26772 
ªs
) {

26773 
JS_RESOLVE_RES_EXCEPTION
:

26776 
JS_RESOLVE_RES_NOT_FOUND
:

26777 
	`JS_ThrowSy¡axEº‹
(
˘x
, "export '%s' in module '%s' isámbiguous",

26778 
	`JS_AtomGëSå
(
˘x
, 
buf1
, (buf1), 
exp‹t_«me
),

26779 
	`JS_AtomGëSå
(
˘x
, 
buf2
, (buf2), 
m
->
moduÀ_«me
));

26781 
JS_RESOLVE_RES_CIRCULAR
:

26782 
	`JS_ThrowSy¡axEº‹
(
˘x
, "CouldÇot findÉxport '%s' in module '%s'",

26783 
	`JS_AtomGëSå
(
˘x
, 
buf1
, (buf1), 
exp‹t_«me
),

26784 
	`JS_AtomGëSå
(
˘x
, 
buf2
, (buf2), 
m
->
moduÀ_«me
));

26786 
JS_RESOLVE_RES_AMBIGUOUS
:

26787 
	`JS_ThrowSy¡axEº‹
(
˘x
, "circularÑeference whenÜooking forÉxport '%s' in module '%s'",

26788 
	`JS_AtomGëSå
(
˘x
, 
buf1
, (buf1), 
exp‹t_«me
),

26789 
	`JS_AtomGëSå
(
˘x
, 
buf2
, (buf2), 
m
->
moduÀ_«me
));

26792 
	}
}

26796 
	mEXPORTED_NAME_AMBIGUOUS
,

26797 
	mEXPORTED_NAME_NORMAL
,

26798 
	mEXPORTED_NAME_NS
,

26799 } 
	tExp‹ãdNameE¡ryEnum
;

26801 
	sExp‹ãdNameE¡ry
 {

26802 
JSAtom
 
	mexp‹t_«me
;

26803 
Exp‹ãdNameE¡ryEnum
 
	mexp‹t_ty≥
;

26805 
JSExp‹tE¡ry
 *
	mme
;

26806 
JSV¨Ref
 *
	mv¨_ªf
;

26807 
JSModuÀDef
 *
	mmoduÀ
;

26808 } 
	mu
;

26809 } 
	tExp‹ãdNameE¡ry
;

26811 
	sGëExp‹tNamesSèã
 {

26812 
JSModuÀDef
 **
	mmoduÀs
;

26813 
	mmoduÀs_size
;

26814 
	mmoduÀs_cou¡
;

26816 
Exp‹ãdNameE¡ry
 *
	mexp‹ãd_«mes
;

26817 
	mexp‹ãd_«mes_size
;

26818 
	mexp‹ãd_«mes_cou¡
;

26819 } 
	tGëExp‹tNamesSèã
;

26821 
	$föd_exp‹ãd_«me
(
GëExp‹tNamesSèã
 *
s
, 
JSAtom
 
«me
)

26823 
i
;

26824 
i
 = 0; i < 
s
->
exp‹ãd_«mes_cou¡
; i++) {

26825 i‡(
s
->
exp‹ãd_«mes
[
i
].
exp‹t_«me
 =
«me
)

26826  
i
;

26829 
	}
}

26831 
__ex˚±i⁄
 
	$gë_exp‹ãd_«mes
(
JSC⁄ãxt
 *
˘x
,

26832 
GëExp‹tNamesSèã
 *
s
,

26833 
JSModuÀDef
 *
m
, 
BOOL
 
‰om_°¨
)

26835 
Exp‹ãdNameE¡ry
 *
í
;

26836 
i
, 
j
;

26839 
i
 = 0; i < 
s
->
moduÀs_cou¡
; i++) {

26840 i‡(
s
->
moduÀs
[
i
] =
m
)

26843 i‡(
	`js_ªsize_¨øy
(
˘x
, (**)&
s
->
moduÀs
, (s->modules[0]),

26844 &
s
->
moduÀs_size
, &s->
moduÀs_cou¡
, s->modules_count + 1))

26846 
s
->
moduÀs
[s->
moduÀs_cou¡
 - 1] = 
m
;

26848 
i
 = 0; i < 
m
->
exp‹t_íåõs_cou¡
; i++) {

26849 
JSExp‹tE¡ry
 *
me
 = &
m
->
exp‹t_íåõs
[
i
];

26850 i‡(
‰om_°¨
 && 
me
->
exp‹t_«me
 =
JS_ATOM_deÁu…
)

26852 
j
 = 
	`föd_exp‹ãd_«me
(
s
, 
me
->
exp‹t_«me
);

26853 i‡(
j
 < 0) {

26854 i‡(
	`js_ªsize_¨øy
(
˘x
, (**)&
s
->
exp‹ãd_«mes
, (s->exported_names[0]),

26855 &
s
->
exp‹ãd_«mes_size
, &s->
exp‹ãd_«mes_cou¡
, s->exported_names_count + 1))

26857 
í
 = &
s
->
exp‹ãd_«mes
[s->
exp‹ãd_«mes_cou¡
 - 1];

26858 
í
->
exp‹t_«me
 = 
me
->export_name;

26860 i‡(
‰om_°¨
 || 
me
->
exp‹t_ty≥
 !
JS_EXPORT_TYPE_LOCAL
)

26861 
í
->
u
.
me
 = 
NULL
;

26863 
í
->
u
.
me
 = me;

26865 
í
 = &
s
->
exp‹ãd_«mes
[
j
];

26866 
í
->
u
.
me
 = 
NULL
;

26869 
i
 = 0; i < 
m
->
°¨_exp‹t_íåõs_cou¡
; i++) {

26870 
JSSèrExp‹tE¡ry
 *
£
 = &
m
->
°¨_exp‹t_íåõs
[
i
];

26871 
JSModuÀDef
 *
m1
;

26872 
m1
 = 
m
->
ªq_moduÀ_íåõs
[
£
->
ªq_moduÀ_idx
].
moduÀ
;

26873 i‡(
	`gë_exp‹ãd_«mes
(
˘x
, 
s
, 
m1
, 
TRUE
))

26877 
	}
}

26880 
	$js_moduÀ_ns_has
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
obj
, 
JSAtom
 
©om
)

26882  (
	`föd_own_¥›îty1
(
	`JS_VALUE_GET_OBJ
(
obj
), 
©om
Ë!
NULL
);

26883 
	}
}

26885 c⁄° 
JSCœssExŸicMëhods
 
	gjs_moduÀ_ns_exŸic_mëhods
 = {

26886 .
has_¥›îty
 = 
js_moduÀ_ns_has
,

26889 
	$exp‹ãd_«mes_cmp
(c⁄° *
p1
, c⁄° *
p2
, *
›aque
)

26891 
JSC⁄ãxt
 *
˘x
 = 
›aque
;

26892 c⁄° 
Exp‹ãdNameE¡ry
 *
me1
 = 
p1
;

26893 c⁄° 
Exp‹ãdNameE¡ry
 *
me2
 = 
p2
;

26894 
JSVÆue
 
°r1
, 
°r2
;

26895 
ªt
;

26898 
°r1
 = 
	`JS_AtomToSåög
(
˘x
, 
me1
->
exp‹t_«me
);

26899 
°r2
 = 
	`JS_AtomToSåög
(
˘x
, 
me2
->
exp‹t_«me
);

26900 i‡(
	`JS_IsEx˚±i⁄
(
°r1
Ë|| JS_IsEx˚±i⁄(
°r2
)) {

26902 
ªt
 = 0;

26904 
ªt
 = 
	`js_°rög_com∑ª
(
˘x
, 
	`JS_VALUE_GET_STRING
(
°r1
),

26905 
	`JS_VALUE_GET_STRING
(
°r2
));

26907 
	`JS_FªeVÆue
(
˘x
, 
°r1
);

26908 
	`JS_FªeVÆue
(
˘x
, 
°r2
);

26909  
ªt
;

26910 
	}
}

26912 
JSVÆue
 
js_gë_moduÀ_ns
(
JSC⁄ãxt
 *
˘x
, 
JSModuÀDef
 *
m
);

26914 
	$js_moduÀ_ns_autoöô
(
JSC⁄ãxt
 *
˘x
, 
JSObje˘
 *
p
, 
JSAtom
 
©om
,

26915 *
›aque
)

26917 
JSModuÀDef
 *
m
 = 
›aque
;

26918 
JSVÆue
 
vÆ
, 
this_vÆ
 = 
	`JS_MKPTR
(
JS_TAG_OBJECT
, 
p
);

26920 
vÆ
 = 
	`js_gë_moduÀ_ns
(
˘x
, 
m
);

26921 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

26923 i‡(
	`JS_DeföePr›îtyVÆue
(
˘x
, 
this_vÆ
, 
©om
, 
vÆ
,

26924 
JS_PROP_ENUMERABLE
 | 
JS_PROP_WRITABLE
) < 0)

26927 
	}
}

26929 
JSVÆue
 
	$js_buûd_moduÀ_ns
(
JSC⁄ãxt
 *
˘x
, 
JSModuÀDef
 *
m
)

26931 
JSVÆue
 
obj
;

26932 
JSObje˘
 *
p
;

26933 
GëExp‹tNamesSèã
 
s_s
, *
s
 = &s_s;

26934 
i
, 
ªt
;

26935 
JSPr›îty
 *
¥
;

26937 
obj
 = 
	`JS_NewObje˘Cœss
(
˘x
, 
JS_CLASS_MODULE_NS
);

26938 i‡(
	`JS_IsEx˚±i⁄
(
obj
))

26939  
obj
;

26940 
p
 = 
	`JS_VALUE_GET_OBJ
(
obj
);

26942 
	`mem£t
(
s
, 0, (*s));

26943 
ªt
 = 
	`gë_exp‹ãd_«mes
(
˘x
, 
s
, 
m
, 
FALSE
);

26944 
	`js_‰ì
(
˘x
, 
s
->
moduÀs
);

26945 i‡(
ªt
)

26946 
Áû
;

26949 
i
 = 0; i < 
s
->
exp‹ãd_«mes_cou¡
; i++) {

26950 
Exp‹ãdNameE¡ry
 *
í
 = &
s
->
exp‹ãd_«mes
[
i
];

26951 
JSResﬁveResu…Enum
 
ªs
;

26952 
JSExp‹tE¡ry
 *
ªs_me
;

26953 
JSModuÀDef
 *
ªs_m
;

26955 i‡(
í
->
u
.
me
) {

26956 
ªs_me
 = 
í
->
u
.
me
;

26957 
ªs_m
 = 
m
;

26958 
ªs
 = 
JS_RESOLVE_RES_FOUND
;

26960 
ªs
 = 
	`js_ªsﬁve_exp‹t
(
˘x
, &
ªs_m
, &
ªs_me
, 
m
,

26961 
í
->
exp‹t_«me
);

26963 i‡(
ªs
 !
JS_RESOLVE_RES_FOUND
) {

26964 i‡(
ªs
 !
JS_RESOLVE_RES_AMBIGUOUS
) {

26965 
	`js_ªsﬁve_exp‹t_throw_îr‹
(
˘x
, 
ªs
, 
m
, 
í
->
exp‹t_«me
);

26966 
Áû
;

26968 
í
->
exp‹t_ty≥
 = 
EXPORTED_NAME_AMBIGUOUS
;

26970 i‡(
ªs_me
->
loˇl_«me
 =
JS_ATOM__°¨_
) {

26971 
í
->
exp‹t_ty≥
 = 
EXPORTED_NAME_NS
;

26972 
í
->
u
.
moduÀ
 = 
ªs_m
->
ªq_moduÀ_íåõs
[
ªs_me
->u.
ªq_moduÀ_idx
].module;

26974 
í
->
exp‹t_ty≥
 = 
EXPORTED_NAME_NORMAL
;

26975 i‡(
ªs_me
->
u
.
loˇl
.
v¨_ªf
) {

26976 
í
->
u
.
v¨_ªf
 = 
ªs_me
->u.
loˇl
.var_ref;

26978 
JSObje˘
 *
p1
 = 
	`JS_VALUE_GET_OBJ
(
ªs_m
->
func_obj
);

26979 
p1
 = 
	`JS_VALUE_GET_OBJ
(
ªs_m
->
func_obj
);

26980 
í
->
u
.
v¨_ªf
 = 
p1
->u.
func
.
v¨_ªfs
[
ªs_me
->u.
loˇl
.
v¨_idx
];

26987 
	`rqs‹t
(
s
->
exp‹ãd_«mes
, s->
exp‹ãd_«mes_cou¡
,

26988 (
s
->
exp‹ãd_«mes
[0]), 
exp‹ãd_«mes_cmp
, 
˘x
);

26990 
i
 = 0; i < 
s
->
exp‹ãd_«mes_cou¡
; i++) {

26991 
Exp‹ãdNameE¡ry
 *
í
 = &
s
->
exp‹ãd_«mes
[
i
];

26992 
í
->
exp‹t_ty≥
) {

26993 
EXPORTED_NAME_NORMAL
:

26995 
JSV¨Ref
 *
v¨_ªf
 = 
í
->
u
.var_ref;

26996 
¥
 = 
	`add_¥›îty
(
˘x
, 
p
, 
í
->
exp‹t_«me
,

26997 
JS_PROP_ENUMERABLE
 | 
JS_PROP_WRITABLE
 |

26998 
JS_PROP_VARREF
);

26999 i‡(!
¥
)

27000 
Áû
;

27001 
v¨_ªf
->
hódî
.
ªf_cou¡
++;

27002 
¥
->
u
.
v¨_ªf
 = var_ref;

27005 
EXPORTED_NAME_NS
:

27007 i‡(
	`JS_DeföeAutoInôPr›îty
(
˘x
, 
obj
,

27008 
í
->
exp‹t_«me
,

27009 
JS_AUTOINIT_ID_MODULE_NS
,

27010 
í
->
u
.
moduÀ
, 
JS_PROP_ENUMERABLE
 | 
JS_PROP_WRITABLE
) < 0)

27011 
Áû
;

27018 
	`js_‰ì
(
˘x
, 
s
->
exp‹ãd_«mes
);

27020 
	`JS_DeföePr›îtyVÆue
(
˘x
, 
obj
, 
JS_ATOM_Symbﬁ_toSåögTag
,

27021 
	`JS_AtomToSåög
(
˘x
, 
JS_ATOM_ModuÀ
),

27024 
p
->
exãnsibÀ
 = 
FALSE
;

27025  
obj
;

27026 
Áû
:

27027 
	`js_‰ì
(
˘x
, 
s
->
exp‹ãd_«mes
);

27028 
	`JS_FªeVÆue
(
˘x
, 
obj
);

27029  
JS_EXCEPTION
;

27030 
	}
}

27032 
JSVÆue
 
	$js_gë_moduÀ_ns
(
JSC⁄ãxt
 *
˘x
, 
JSModuÀDef
 *
m
)

27034 i‡(
	`JS_IsUndeföed
(
m
->
moduÀ_ns
)) {

27035 
JSVÆue
 
vÆ
;

27036 
vÆ
 = 
	`js_buûd_moduÀ_ns
(
˘x
, 
m
);

27037 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

27038  
JS_EXCEPTION
;

27039 
m
->
moduÀ_ns
 = 
vÆ
;

27041  
	`JS_DupVÆue
(
˘x
, 
m
->
moduÀ_ns
);

27042 
	}
}

27045 
	$js_ªsﬁve_moduÀ
(
JSC⁄ãxt
 *
˘x
, 
JSModuÀDef
 *
m
)

27047 
i
;

27048 
JSModuÀDef
 *
m1
;

27050 i‡(
m
->
ªsﬁved
)

27052 #ifde‡
DUMP_MODULE_RESOLVE


27054 
buf1
[
ATOM_GET_STR_BUF_SIZE
];

27055 
	`¥ötf
("ªsﬁvög moduÀ '%s':\n", 
	`JS_AtomGëSå
(
˘x
, 
buf1
, (buf1), 
m
->
moduÀ_«me
));

27058 
m
->
ªsﬁved
 = 
TRUE
;

27060 
i
 = 0; i < 
m
->
ªq_moduÀ_íåõs_cou¡
; i++) {

27061 
JSReqModuÀE¡ry
 *
rme
 = &
m
->
ªq_moduÀ_íåõs
[
i
];

27062 
m1
 = 
	`js_ho°_ªsﬁve_imp‹ãd_moduÀ
(
˘x
, 
m
->
moduÀ_«me
,

27063 
rme
->
moduÀ_«me
);

27064 i‡(!
m1
)

27066 
rme
->
moduÀ
 = 
m1
;

27069 i‡(
	`js_ªsﬁve_moduÀ
(
˘x
, 
m1
) < 0)

27073 
	}
}

27075 
JSV¨Ref
 *
	$js_¸óã_moduÀ_v¨
(
JSC⁄ãxt
 *
˘x
, 
BOOL
 
is_Àxiˇl
)

27077 
JSV¨Ref
 *
v¨_ªf
;

27078 
v¨_ªf
 = 
	`js_mÆloc
(
˘x
, (
JSV¨Ref
));

27079 i‡(!
v¨_ªf
)

27080  
NULL
;

27081 
v¨_ªf
->
hódî
.
ªf_cou¡
 = 1;

27082 i‡(
is_Àxiˇl
)

27083 
v¨_ªf
->
vÆue
 = 
JS_UNINITIALIZED
;

27085 
v¨_ªf
->
vÆue
 = 
JS_UNDEFINED
;

27086 
v¨_ªf
->
pvÆue
 = &v¨_ªf->
vÆue
;

27087 
v¨_ªf
->
is_dëached
 = 
TRUE
;

27088 
	`add_gc_obje˘
(
˘x
->
π
, &
v¨_ªf
->
hódî
, 
JS_GC_OBJ_TYPE_VAR_REF
);

27089  
v¨_ªf
;

27090 
	}
}

27093 
	$js_¸óã_moduÀ_fun˘i⁄
(
JSC⁄ãxt
 *
˘x
, 
JSModuÀDef
 *
m
)

27095 
JSFun˘i⁄Byãcode
 *
b
;

27096 
i
;

27097 
JSV¨Ref
 **
v¨_ªfs
;

27098 
JSVÆue
 
func_obj
, 
bfunc
;

27099 
JSObje˘
 *
p
;

27101 
bfunc
 = 
m
->
func_obj
;

27102 
func_obj
 = 
	`JS_NewObje˘PrŸoCœss
(
˘x
, ctx->
fun˘i⁄_¥Ÿo
,

27103 
JS_CLASS_BYTECODE_FUNCTION
);

27105 i‡(
	`JS_IsEx˚±i⁄
(
func_obj
))

27107 
b
 = 
	`JS_VALUE_GET_PTR
(
bfunc
);

27109 
p
 = 
	`JS_VALUE_GET_OBJ
(
func_obj
);

27110 
p
->
u
.
func
.
fun˘i⁄_byãcode
 = 
b
;

27111 
b
->
hódî
.
ªf_cou¡
++;

27112 
p
->
u
.
func
.
home_obje˘
 = 
NULL
;

27113 
p
->
u
.
func
.
v¨_ªfs
 = 
NULL
;

27114 i‡(
b
->
˛osuª_v¨_cou¡
) {

27115 
v¨_ªfs
 = 
	`js_mÆlocz
(
˘x
, (v¨_ªfs[0]Ë* 
b
->
˛osuª_v¨_cou¡
);

27116 i‡(!
v¨_ªfs
)

27117 
Áû
;

27118 
p
->
u
.
func
.
v¨_ªfs
 = var_refs;

27122 
i
 = 0; i < 
b
->
˛osuª_v¨_cou¡
; i++) {

27123 
JSClosuªV¨
 *
cv
 = &
b
->
˛osuª_v¨
[
i
];

27124 
JSV¨Ref
 *
v¨_ªf
;

27125 i‡(
cv
->
is_loˇl
) {

27126 
v¨_ªf
 = 
	`js_¸óã_moduÀ_v¨
(
˘x
, 
cv
->
is_Àxiˇl
);

27127 i‡(!
v¨_ªf
)

27128 
Áû
;

27129 #ifde‡
DUMP_MODULE_RESOLVE


27130 
	`¥ötf
("loˇ»%d: %p\n", 
i
, 
v¨_ªf
);

27132 
v¨_ªfs
[
i
] = 
v¨_ªf
;

27136 
m
->
func_obj
 = func_obj;

27137 
	`JS_FªeVÆue
(
˘x
, 
bfunc
);

27139 
Áû
:

27140 
	`JS_FªeVÆue
(
˘x
, 
func_obj
);

27142 
	}
}

27146 
	$js_ö°™tüã_moduÀ
(
JSC⁄ãxt
 *
˘x
, 
JSModuÀDef
 *
m
)

27148 
i
;

27149 
JSImp‹tE¡ry
 *
mi
;

27150 
JSModuÀDef
 *
m1
;

27151 
JSV¨Ref
 **
v¨_ªfs
, *
v¨_ªf
;

27152 
JSObje˘
 *
p
;

27153 
BOOL
 
is_c_moduÀ
;

27155 i‡(
m
->
ö°™tüãd
)

27157 
m
->
ö°™tüãd
 = 
TRUE
;

27159 
is_c_moduÀ
 = (
m
->
öô_func
 !
NULL
);

27161 i‡(
is_c_moduÀ
) {

27163 
i
 = 0; i < 
m
->
exp‹t_íåõs_cou¡
; i++) {

27164 
JSExp‹tE¡ry
 *
me
 = &
m
->
exp‹t_íåõs
[
i
];

27165 i‡(
me
->
exp‹t_ty≥
 =
JS_EXPORT_TYPE_LOCAL
) {

27166 
v¨_ªf
 = 
	`js_¸óã_moduÀ_v¨
(
˘x
, 
FALSE
);

27167 i‡(!
v¨_ªf
)

27168 
Áû
;

27169 
me
->
u
.
loˇl
.
v¨_ªf
 = var_ref;

27173 i‡(
	`js_¸óã_moduÀ_fun˘i⁄
(
˘x
, 
m
) < 0)

27174 
Áû
;

27177 
i
 = 0; i < 
m
->
ªq_moduÀ_íåõs_cou¡
; i++) {

27178 
JSReqModuÀE¡ry
 *
rme
 = &
m
->
ªq_moduÀ_íåõs
[
i
];

27179 i‡(
	`js_ö°™tüã_moduÀ
(
˘x
, 
rme
->
moduÀ
) < 0)

27180 
Áû
;

27183 #ifde‡
DUMP_MODULE_RESOLVE


27185 
buf1
[
ATOM_GET_STR_BUF_SIZE
];

27186 
	`¥ötf
("ö°™tütög moduÀ '%s':\n", 
	`JS_AtomGëSå
(
˘x
, 
buf1
, (buf1), 
m
->
moduÀ_«me
));

27190 
i
 = 0; i < 
m
->
exp‹t_íåõs_cou¡
; i++) {

27191 
JSExp‹tE¡ry
 *
me
 = &
m
->
exp‹t_íåõs
[
i
];

27192 i‡(
me
->
exp‹t_ty≥
 =
JS_EXPORT_TYPE_INDIRECT
 &&

27193 
me
->
loˇl_«me
 !
JS_ATOM__°¨_
) {

27194 
JSResﬁveResu…Enum
 
ªt
;

27195 
JSExp‹tE¡ry
 *
ªs_me
;

27196 
JSModuÀDef
 *
ªs_m
, *
m1
;

27197 
m1
 = 
m
->
ªq_moduÀ_íåõs
[
me
->
u
.
ªq_moduÀ_idx
].
moduÀ
;

27198 
ªt
 = 
	`js_ªsﬁve_exp‹t
(
˘x
, &
ªs_m
, &
ªs_me
, 
m1
, 
me
->
loˇl_«me
);

27199 i‡(
ªt
 !
JS_RESOLVE_RES_FOUND
) {

27200 
	`js_ªsﬁve_exp‹t_throw_îr‹
(
˘x
, 
ªt
, 
m
, 
me
->
exp‹t_«me
);

27201 
Áû
;

27206 #ifde‡
DUMP_MODULE_RESOLVE


27208 
	`¥ötf
("exported bindings:\n");

27209 
i
 = 0; i < 
m
->
exp‹t_íåõs_cou¡
; i++) {

27210 
JSExp‹tE¡ry
 *
me
 = &
m
->
exp‹t_íåõs
[
i
];

27211 
	`¥ötf
("Çame="); 
	`¥öt_©om
(
˘x
, 
me
->
exp‹t_«me
);

27212 
	`¥ötf
("Üoˇl="); 
	`¥öt_©om
(
˘x
, 
me
->
loˇl_«me
);

27213 
	`¥ötf
("Åy≥=%d idx=%d\n", 
me
->
exp‹t_ty≥
, me->
u
.
loˇl
.
v¨_idx
);

27218 i‡(!
is_c_moduÀ
) {

27219 
p
 = 
	`JS_VALUE_GET_OBJ
(
m
->
func_obj
);

27220 
v¨_ªfs
 = 
p
->
u
.
func
.var_refs;

27222 
i
 = 0; i < 
m
->
imp‹t_íåõs_cou¡
; i++) {

27223 
mi
 = &
m
->
imp‹t_íåõs
[
i
];

27224 #ifde‡
DUMP_MODULE_RESOLVE


27225 
	`¥ötf
("imp‹àv¨_idx=%dÇame=", 
mi
->
v¨_idx
);

27226 
	`¥öt_©om
(
˘x
, 
mi
->
imp‹t_«me
);

27227 
	`¥ötf
(": ");

27229 
m1
 = 
m
->
ªq_moduÀ_íåõs
[
mi
->
ªq_moduÀ_idx
].
moduÀ
;

27230 i‡(
mi
->
imp‹t_«me
 =
JS_ATOM__°¨_
) {

27231 
JSVÆue
 
vÆ
;

27233 
vÆ
 = 
	`js_gë_moduÀ_ns
(
˘x
, 
m1
);

27234 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

27235 
Áû
;

27236 
	`£t_vÆue
(
˘x
, &
v¨_ªfs
[
mi
->
v¨_idx
]->
vÆue
, 
vÆ
);

27237 #ifde‡
DUMP_MODULE_RESOLVE


27238 
	`¥ötf
("namespace\n");

27241 
JSResﬁveResu…Enum
 
ªt
;

27242 
JSExp‹tE¡ry
 *
ªs_me
;

27243 
JSModuÀDef
 *
ªs_m
;

27244 
JSObje˘
 *
p1
;

27246 
ªt
 = 
	`js_ªsﬁve_exp‹t
(
˘x
, &
ªs_m
,

27247 &
ªs_me
, 
m1
, 
mi
->
imp‹t_«me
);

27248 i‡(
ªt
 !
JS_RESOLVE_RES_FOUND
) {

27249 
	`js_ªsﬁve_exp‹t_throw_îr‹
(
˘x
, 
ªt
, 
m1
, 
mi
->
imp‹t_«me
);

27250 
Áû
;

27252 i‡(
ªs_me
->
loˇl_«me
 =
JS_ATOM__°¨_
) {

27253 
JSVÆue
 
vÆ
;

27254 
JSModuÀDef
 *
m2
;

27256 
m2
 = 
ªs_m
->
ªq_moduÀ_íåõs
[
ªs_me
->
u
.
ªq_moduÀ_idx
].
moduÀ
;

27257 
vÆ
 = 
	`js_gë_moduÀ_ns
(
˘x
, 
m2
);

27258 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

27259 
Áû
;

27260 
v¨_ªf
 = 
	`js_¸óã_moduÀ_v¨
(
˘x
, 
TRUE
);

27261 i‡(!
v¨_ªf
) {

27262 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

27263 
Áû
;

27265 
	`£t_vÆue
(
˘x
, &
v¨_ªf
->
vÆue
, 
vÆ
);

27266 
v¨_ªfs
[
mi
->
v¨_idx
] = 
v¨_ªf
;

27267 #ifde‡
DUMP_MODULE_RESOLVE


27268 
	`¥ötf
("namespace from\n");

27271 
v¨_ªf
 = 
ªs_me
->
u
.
loˇl
.var_ref;

27272 i‡(!
v¨_ªf
) {

27273 
p1
 = 
	`JS_VALUE_GET_OBJ
(
ªs_m
->
func_obj
);

27274 
v¨_ªf
 = 
p1
->
u
.
func
.
v¨_ªfs
[
ªs_me
->u.
loˇl
.
v¨_idx
];

27276 
v¨_ªf
->
hódî
.
ªf_cou¡
++;

27277 
v¨_ªfs
[
mi
->
v¨_idx
] = 
v¨_ªf
;

27278 #ifde‡
DUMP_MODULE_RESOLVE


27279 
	`¥ötf
("loˇ»exp‹à(v¨_ªf=%p)\n", 
v¨_ªf
);

27288 
i
 = 0; i < 
m
->
exp‹t_íåõs_cou¡
; i++) {

27289 
JSExp‹tE¡ry
 *
me
 = &
m
->
exp‹t_íåõs
[
i
];

27290 i‡(
me
->
exp‹t_ty≥
 =
JS_EXPORT_TYPE_LOCAL
) {

27291 
v¨_ªf
 = 
v¨_ªfs
[
me
->
u
.
loˇl
.
v¨_idx
];

27292 
v¨_ªf
->
hódî
.
ªf_cou¡
++;

27293 
me
->
u
.
loˇl
.
v¨_ªf
 = var_ref;

27298 #ifde‡
DUMP_MODULE_RESOLVE


27299 
	`¥ötf
("done instantiate\n");

27302 
Áû
:

27304 
	}
}

27307 
JSAtom
 
	$js_gë_s¸ùt_‹_moduÀ_«me
(
JSC⁄ãxt
 *
˘x
)

27309 
JSSèckFøme
 *
sf
;

27310 
JSFun˘i⁄Byãcode
 *
b
;

27311 
JSObje˘
 *
p
;

27315 
sf
 = 
˘x
->
π
->
cuºít_°ack_‰ame
;

27316 
	`as£π
(
sf
 !
NULL
);

27317 
	`as£π
(
	`JS_VALUE_GET_TAG
(
sf
->
cur_func
Ë=
JS_TAG_OBJECT
);

27318 
p
 = 
	`JS_VALUE_GET_OBJ
(
sf
->
cur_func
);

27319 
	`as£π
(
	`js_˛ass_has_byãcode
(
p
->
˛ass_id
));

27320 
b
 = 
p
->
u
.
func
.
fun˘i⁄_byãcode
;

27321 i‡(!
b
->
has_debug
)

27322  
JS_ATOM_NULL
;

27323  
b
->
debug
.
fûíame
;

27324 
	}
}

27326 
JSAtom
 
	$JS_GëModuÀName
(
JSC⁄ãxt
 *
˘x
, 
JSModuÀDef
 *
m
)

27328  
	`JS_DupAtom
(
˘x
, 
m
->
moduÀ_«me
);

27329 
	}
}

27331 
JSVÆue
 
	$JS_GëImp‹tMëa
(
JSC⁄ãxt
 *
˘x
, 
JSModuÀDef
 *
m
)

27333 
JSVÆue
 
obj
;

27335 
obj
 = 
m
->
mëa_obj
;

27336 i‡(
	`JS_IsUndeföed
(
obj
)) {

27337 
obj
 = 
	`JS_NewObje˘PrŸo
(
˘x
, 
JS_NULL
);

27338 i‡(
	`JS_IsEx˚±i⁄
(
obj
))

27339  
JS_EXCEPTION
;

27340 
m
->
mëa_obj
 = 
obj
;

27342  
	`JS_DupVÆue
(
˘x
, 
obj
);

27343 
	}
}

27345 
JSVÆue
 
	$js_imp‹t_mëa
(
JSC⁄ãxt
 *
˘x
)

27347 
JSAtom
 
fûíame
;

27348 
JSModuÀDef
 *
m
;

27350 
fûíame
 = 
	`js_gë_s¸ùt_‹_moduÀ_«me
(
˘x
);

27351 i‡(
fûíame
 =
JS_ATOM_NULL
)

27352 
Áû
;

27356 
m
 = 
	`js_föd_lﬂded_moduÀ
(
˘x
, 
fûíame
);

27357 i‡(!
m
) {

27358 
Áû
:

27359 
	`JS_ThrowTy≥Eº‹
(
˘x
, "import.metaÇot supported inÅhis context");

27360  
JS_EXCEPTION
;

27362  
	`JS_GëImp‹tMëa
(
˘x
, 
m
);

27363 
	}
}

27365 
JSVÆue
 
	$js_dy«mic_imp‹t_job
(
JSC⁄ãxt
 *
˘x
,

27366 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

27368 
JSVÆueC⁄°
 *
ªsﬁvög_funcs
 = 
¨gv
;

27369 
JSVÆueC⁄°
 
ba£«me_vÆ
 = 
¨gv
[2];

27370 
JSVÆueC⁄°
 
•ecifõr
 = 
¨gv
[3];

27371 
JSModuÀDef
 *
m
;

27372 
JSAtom
 
ba£«me
 = 
JS_ATOM_NULL
, 
fûíame
;

27373 
JSVÆue
 
•ecifõrSåög
, 
ªt
, 
func_obj
, 
îr
, 
ns
;

27375 i‡(!
	`JS_IsSåög
(
ba£«me_vÆ
)) {

27376 
	`JS_ThrowTy≥Eº‹
(
˘x
, "no function filename for import()");

27377 
ex˚±i⁄
;

27379 
ba£«me
 = 
	`JS_VÆueToAtom
(
˘x
, 
ba£«me_vÆ
);

27380 i‡(
ba£«me
 =
JS_ATOM_NULL
)

27381 
ex˚±i⁄
;

27383 
•ecifõrSåög
 = 
	`JS_ToSåög
(
˘x
, 
•ecifõr
);

27384 i‡(
	`JS_IsEx˚±i⁄
(
•ecifõrSåög
))

27385 
ex˚±i⁄
;

27386 
fûíame
 = 
	`JS_VÆueToAtom
(
˘x
, 
•ecifõrSåög
);

27387 
	`JS_FªeVÆue
(
˘x
, 
•ecifõrSåög
);

27388 i‡(
fûíame
 =
JS_ATOM_NULL
)

27389 
ex˚±i⁄
;

27391 
m
 = 
	`js_ho°_ªsﬁve_imp‹ãd_moduÀ
(
˘x
, 
ba£«me
, 
fûíame
);

27392 
	`JS_FªeAtom
(
˘x
, 
fûíame
);

27393 i‡(!
m
) {

27394 
ex˚±i⁄
;

27397 i‡(
	`js_ªsﬁve_moduÀ
(
˘x
, 
m
) < 0) {

27398 
	`js_‰ì_moduÀs
(
˘x
, 
JS_FREE_MODULE_NOT_RESOLVED
);

27399 
ex˚±i⁄
;

27403 
func_obj
 = 
	`JS_DupVÆue
(
˘x
, 
	`JS_MKPTR
(
JS_TAG_MODULE
, 
m
));

27404 
ªt
 = 
	`JS_EvÆFun˘i⁄
(
˘x
, 
func_obj
);

27405 i‡(
	`JS_IsEx˚±i⁄
(
ªt
))

27406 
ex˚±i⁄
;

27407 
	`JS_FªeVÆue
(
˘x
, 
ªt
);

27410 
ns
 = 
	`js_gë_moduÀ_ns
(
˘x
, 
m
);

27411 i‡(
	`JS_IsEx˚±i⁄
(
ªt
))

27412 
ex˚±i⁄
;

27414 
ªt
 = 
	`JS_CÆl
(
˘x
, 
ªsﬁvög_funcs
[0], 
JS_UNDEFINED
,

27415 1, (
JSVÆueC⁄°
 *)&
ns
);

27416 
	`JS_FªeVÆue
(
˘x
, 
ªt
);

27417 
	`JS_FªeVÆue
(
˘x
, 
ns
);

27418 
	`JS_FªeAtom
(
˘x
, 
ba£«me
);

27419  
JS_UNDEFINED
;

27420 
ex˚±i⁄
:

27422 
îr
 = 
	`JS_GëEx˚±i⁄
(
˘x
);

27423 
ªt
 = 
	`JS_CÆl
(
˘x
, 
ªsﬁvög_funcs
[1], 
JS_UNDEFINED
,

27424 1, (
JSVÆueC⁄°
 *)&
îr
);

27425 
	`JS_FªeVÆue
(
˘x
, 
ªt
);

27426 
	`JS_FªeVÆue
(
˘x
, 
îr
);

27427 
	`JS_FªeAtom
(
˘x
, 
ba£«me
);

27428  
JS_UNDEFINED
;

27429 
	}
}

27431 
JSVÆue
 
	$js_dy«mic_imp‹t
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
•ecifõr
)

27433 
JSAtom
 
ba£«me
;

27434 
JSVÆue
 
¥omi£
, 
ªsﬁvög_funcs
[2], 
ba£«me_vÆ
;

27435 
JSVÆueC⁄°
 
¨gs
[4];

27437 
ba£«me
 = 
	`js_gë_s¸ùt_‹_moduÀ_«me
(
˘x
);

27438 i‡(
ba£«me
 =
JS_ATOM_NULL
)

27439 
ba£«me_vÆ
 = 
JS_NULL
;

27441 
ba£«me_vÆ
 = 
	`JS_AtomToVÆue
(
˘x
, 
ba£«me
);

27442 i‡(
	`JS_IsEx˚±i⁄
(
ba£«me_vÆ
))

27443  
ba£«me_vÆ
;

27445 
¥omi£
 = 
	`JS_NewPromi£C≠abûôy
(
˘x
, 
ªsﬁvög_funcs
);

27446 i‡(
	`JS_IsEx˚±i⁄
(
¥omi£
)) {

27447 
	`JS_FªeVÆue
(
˘x
, 
ba£«me_vÆ
);

27448  
¥omi£
;

27451 
¨gs
[0] = 
ªsﬁvög_funcs
[0];

27452 
¨gs
[1] = 
ªsﬁvög_funcs
[1];

27453 
¨gs
[2] = 
ba£«me_vÆ
;

27454 
¨gs
[3] = 
•ecifõr
;

27456 
	`JS_EnqueueJob
(
˘x
, 
js_dy«mic_imp‹t_job
, 4, 
¨gs
);

27458 
	`JS_FªeVÆue
(
˘x
, 
ba£«me_vÆ
);

27459 
	`JS_FªeVÆue
(
˘x
, 
ªsﬁvög_funcs
[0]);

27460 
	`JS_FªeVÆue
(
˘x
, 
ªsﬁvög_funcs
[1]);

27461  
¥omi£
;

27462 
	}
}

27466 
JSVÆue
 
	$js_evÆu©e_moduÀ
(
JSC⁄ãxt
 *
˘x
, 
JSModuÀDef
 *
m
)

27468 
JSModuÀDef
 *
m1
;

27469 
i
;

27470 
JSVÆue
 
ªt_vÆ
;

27472 i‡(
m
->
evÆ_m¨k
)

27473  
JS_UNDEFINED
;

27475 i‡(
m
->
evÆu©ed
) {

27478 i‡(
m
->
evÆ_has_ex˚±i⁄
) {

27479  
	`JS_Throw
(
˘x
, 
	`JS_DupVÆue
(˘x, 
m
->
evÆ_ex˚±i⁄
));

27481  
JS_UNDEFINED
;

27485 
m
->
evÆ_m¨k
 = 
TRUE
;

27487 
i
 = 0; i < 
m
->
ªq_moduÀ_íåõs_cou¡
; i++) {

27488 
JSReqModuÀE¡ry
 *
rme
 = &
m
->
ªq_moduÀ_íåõs
[
i
];

27489 
m1
 = 
rme
->
moduÀ
;

27490 i‡(!
m1
->
evÆ_m¨k
) {

27491 
ªt_vÆ
 = 
	`js_evÆu©e_moduÀ
(
˘x
, 
m1
);

27492 i‡(
	`JS_IsEx˚±i⁄
(
ªt_vÆ
)) {

27493 
m
->
evÆ_m¨k
 = 
FALSE
;

27494  
ªt_vÆ
;

27496 
	`JS_FªeVÆue
(
˘x
, 
ªt_vÆ
);

27500 i‡(
m
->
öô_func
) {

27502 i‡(
m
->
	`öô_func
(
˘x
, m) < 0)

27503 
ªt_vÆ
 = 
JS_EXCEPTION
;

27505 
ªt_vÆ
 = 
JS_UNDEFINED
;

27507 
ªt_vÆ
 = 
	`JS_CÆlFªe
(
˘x
, 
m
->
func_obj
, 
JS_UNDEFINED
, 0, 
NULL
);

27508 
m
->
func_obj
 = 
JS_UNDEFINED
;

27510 i‡(
	`JS_IsEx˚±i⁄
(
ªt_vÆ
)) {

27512 
m
->
evÆ_has_ex˚±i⁄
 = 
TRUE
;

27513 
m
->
evÆ_ex˚±i⁄
 = 
	`JS_DupVÆue
(
˘x
, ctx->
π
->
cuºít_ex˚±i⁄
);

27515 
m
->
evÆ_m¨k
 = 
FALSE
;

27516 
m
->
evÆu©ed
 = 
TRUE
;

27517  
ªt_vÆ
;

27518 
	}
}

27520 
__ex˚±i⁄
 
JSAtom
 
	$js_∑r£_‰om_˛au£
(
JSP¨£Sèã
 *
s
)

27522 
JSAtom
 
moduÀ_«me
;

27523 i‡(!
	`tokí_is_p£udo_keyw‹d
(
s
, 
JS_ATOM_‰om
)) {

27524 
	`js_∑r£_îr‹
(
s
, "from clauseÉxpected");

27525  
JS_ATOM_NULL
;

27527 i‡(
	`√xt_tokí
(
s
))

27528  
JS_ATOM_NULL
;

27529 i‡(
s
->
tokí
.
vÆ
 !
TOK_STRING
) {

27530 
	`js_∑r£_îr‹
(
s
, "stringÉxpected");

27531  
JS_ATOM_NULL
;

27533 
moduÀ_«me
 = 
	`JS_VÆueToAtom
(
s
->
˘x
, s->
tokí
.
u
.
°r
.str);

27534 i‡(
moduÀ_«me
 =
JS_ATOM_NULL
)

27535  
JS_ATOM_NULL
;

27536 i‡(
	`√xt_tokí
(
s
)) {

27537 
	`JS_FªeAtom
(
s
->
˘x
, 
moduÀ_«me
);

27538  
JS_ATOM_NULL
;

27540  
moduÀ_«me
;

27541 
	}
}

27543 
__ex˚±i⁄
 
	$js_∑r£_exp‹t
(
JSP¨£Sèã
 *
s
)

27545 
JSC⁄ãxt
 *
˘x
 = 
s
->ctx;

27546 
JSModuÀDef
 *
m
 = 
s
->
cur_func
->
moduÀ
;

27547 
JSAtom
 
loˇl_«me
, 
exp‹t_«me
;

27548 
fú°_exp‹t
, 
idx
, 
i
, 
tok
;

27549 
JSAtom
 
moduÀ_«me
;

27550 
JSExp‹tE¡ry
 *
me
;

27552 i‡(
	`√xt_tokí
(
s
))

27555 
tok
 = 
s
->
tokí
.
vÆ
;

27556 i‡(
tok
 =
TOK_CLASS
) {

27557  
	`js_∑r£_˛ass
(
s
, 
FALSE
, 
JS_PARSE_EXPORT_NAMED
);

27558 } i‡(
tok
 =
TOK_FUNCTION
 ||

27559 (
	`tokí_is_p£udo_keyw‹d
(
s
, 
JS_ATOM_async
) &&

27560 
	`≥ek_tokí
(
s
, 
TRUE
Ë=
TOK_FUNCTION
)) {

27561  
	`js_∑r£_fun˘i⁄_de˛2
(
s
, 
JS_PARSE_FUNC_STATEMENT
,

27562 
JS_FUNC_NORMAL
, 
JS_ATOM_NULL
,

27563 
s
->
tokí
.
±r
, s->tokí.
löe_num
,

27564 
JS_PARSE_EXPORT_NAMED
, 
NULL
);

27567 i‡(
	`√xt_tokí
(
s
))

27570 
tok
) {

27572 
fú°_exp‹t
 = 
m
->
exp‹t_íåõs_cou¡
;

27573 
s
->
tokí
.
vÆ
 != '}') {

27574 i‡(!
	`tokí_is_idít
(
s
->
tokí
.
vÆ
)) {

27575 
	`js_∑r£_îr‹
(
s
, "identifierÉxpected");

27578 
loˇl_«me
 = 
	`JS_DupAtom
(
˘x
, 
s
->
tokí
.
u
.
idít
.
©om
);

27579 
exp‹t_«me
 = 
JS_ATOM_NULL
;

27580 i‡(
	`√xt_tokí
(
s
))

27581 
Áû
;

27582 i‡(
	`tokí_is_p£udo_keyw‹d
(
s
, 
JS_ATOM_as
)) {

27583 i‡(
	`√xt_tokí
(
s
))

27584 
Áû
;

27585 i‡(!
	`tokí_is_idít
(
s
->
tokí
.
vÆ
)) {

27586 
	`js_∑r£_îr‹
(
s
, "identifierÉxpected");

27587 
Áû
;

27589 
exp‹t_«me
 = 
	`JS_DupAtom
(
˘x
, 
s
->
tokí
.
u
.
idít
.
©om
);

27590 i‡(
	`√xt_tokí
(
s
)) {

27591 
Áû
:

27592 
	`JS_FªeAtom
(
˘x
, 
loˇl_«me
);

27593 
Áû1
:

27594 
	`JS_FªeAtom
(
˘x
, 
exp‹t_«me
);

27598 
exp‹t_«me
 = 
	`JS_DupAtom
(
˘x
, 
loˇl_«me
);

27600 
me
 = 
	`add_exp‹t_íåy
(
s
, 
m
, 
loˇl_«me
, 
exp‹t_«me
,

27601 
JS_EXPORT_TYPE_LOCAL
);

27602 
	`JS_FªeAtom
(
˘x
, 
loˇl_«me
);

27603 
	`JS_FªeAtom
(
˘x
, 
exp‹t_«me
);

27604 i‡(!
me
)

27606 i‡(
s
->
tokí
.
vÆ
 != ',')

27608 i‡(
	`√xt_tokí
(
s
))

27611 i‡(
	`js_∑r£_ex≥˘
(
s
, '}'))

27613 i‡(
	`tokí_is_p£udo_keyw‹d
(
s
, 
JS_ATOM_‰om
)) {

27614 
moduÀ_«me
 = 
	`js_∑r£_‰om_˛au£
(
s
);

27615 i‡(
moduÀ_«me
 =
JS_ATOM_NULL
)

27617 
idx
 = 
	`add_ªq_moduÀ_íåy
(
˘x
, 
m
, 
moduÀ_«me
);

27618 
	`JS_FªeAtom
(
˘x
, 
moduÀ_«me
);

27619 i‡(
idx
 < 0)

27621 
i
 = 
fú°_exp‹t
; i < 
m
->
exp‹t_íåõs_cou¡
; i++) {

27622 
me
 = &
m
->
exp‹t_íåõs
[
i
];

27623 
me
->
exp‹t_ty≥
 = 
JS_EXPORT_TYPE_INDIRECT
;

27624 
me
->
u
.
ªq_moduÀ_idx
 = 
idx
;

27629 i‡(
	`tokí_is_p£udo_keyw‹d
(
s
, 
JS_ATOM_as
)) {

27631 i‡(
	`√xt_tokí
(
s
))

27633 i‡(!
	`tokí_is_idít
(
s
->
tokí
.
vÆ
)) {

27634 
	`js_∑r£_îr‹
(
s
, "identifierÉxpected");

27637 
exp‹t_«me
 = 
	`JS_DupAtom
(
˘x
, 
s
->
tokí
.
u
.
idít
.
©om
);

27638 i‡(
	`√xt_tokí
(
s
))

27639 
Áû1
;

27640 
moduÀ_«me
 = 
	`js_∑r£_‰om_˛au£
(
s
);

27641 i‡(
moduÀ_«me
 =
JS_ATOM_NULL
)

27642 
Áû1
;

27643 
idx
 = 
	`add_ªq_moduÀ_íåy
(
˘x
, 
m
, 
moduÀ_«me
);

27644 
	`JS_FªeAtom
(
˘x
, 
moduÀ_«me
);

27645 i‡(
idx
 < 0)

27646 
Áû1
;

27647 
me
 = 
	`add_exp‹t_íåy
(
s
, 
m
, 
JS_ATOM__°¨_
, 
exp‹t_«me
,

27648 
JS_EXPORT_TYPE_INDIRECT
);

27649 
	`JS_FªeAtom
(
˘x
, 
exp‹t_«me
);

27650 i‡(!
me
)

27652 
me
->
u
.
ªq_moduÀ_idx
 = 
idx
;

27654 
moduÀ_«me
 = 
	`js_∑r£_‰om_˛au£
(
s
);

27655 i‡(
moduÀ_«me
 =
JS_ATOM_NULL
)

27657 
idx
 = 
	`add_ªq_moduÀ_íåy
(
˘x
, 
m
, 
moduÀ_«me
);

27658 
	`JS_FªeAtom
(
˘x
, 
moduÀ_«me
);

27659 i‡(
idx
 < 0)

27661 i‡(
	`add_°¨_exp‹t_íåy
(
˘x
, 
m
, 
idx
) < 0)

27665 
TOK_DEFAULT
:

27666 i‡(
s
->
tokí
.
vÆ
 =
TOK_CLASS
) {

27667  
	`js_∑r£_˛ass
(
s
, 
FALSE
, 
JS_PARSE_EXPORT_DEFAULT
);

27668 } i‡(
s
->
tokí
.
vÆ
 =
TOK_FUNCTION
 ||

27669 (
	`tokí_is_p£udo_keyw‹d
(
s
, 
JS_ATOM_async
) &&

27670 
	`≥ek_tokí
(
s
, 
TRUE
Ë=
TOK_FUNCTION
)) {

27671  
	`js_∑r£_fun˘i⁄_de˛2
(
s
, 
JS_PARSE_FUNC_STATEMENT
,

27672 
JS_FUNC_NORMAL
, 
JS_ATOM_NULL
,

27673 
s
->
tokí
.
±r
, s->tokí.
löe_num
,

27674 
JS_PARSE_EXPORT_DEFAULT
, 
NULL
);

27676 i‡(
	`js_∑r£_assign_ex¥
(
s
, 
TRUE
))

27680 
	`£t_obje˘_«me
(
s
, 
JS_ATOM_deÁu…
);

27684 
loˇl_«me
 = 
JS_ATOM__deÁu…_
;

27685 i‡(
	`deföe_v¨
(
s
, s->
cur_func
, 
loˇl_«me
, 
JS_VAR_DEF_LET
) < 0)

27687 
	`emô_›
(
s
, 
OP_sc›e_put_v¨_öô
);

27688 
	`emô_©om
(
s
, 
loˇl_«me
);

27689 
	`emô_u16
(
s
, 0);

27691 i‡(!
	`add_exp‹t_íåy
(
s
, 
m
, 
loˇl_«me
, 
JS_ATOM_deÁu…
,

27692 
JS_EXPORT_TYPE_LOCAL
))

27695 
TOK_VAR
:

27696 
TOK_LET
:

27697 
TOK_CONST
:

27698  
	`js_∑r£_v¨
(
s
, 
TRUE
, 
tok
, TRUE);

27700  
	`js_∑r£_îr‹
(
s
, "invalidÉxport syntax");

27702  
	`js_∑r£_ex≥˘_£mi
(
s
);

27703 
	}
}

27705 
add_˛osuª_v¨
(
JSC⁄ãxt
 *
˘x
, 
JSFun˘i⁄Def
 *
s
,

27706 
BOOL
 
is_loˇl
, BOOL 
is_¨g
,

27707 
v¨_idx
, 
JSAtom
 
v¨_«me
,

27708 
BOOL
 
is_c⁄°
, BOOL 
is_Àxiˇl
,

27709 
JSV¨KödEnum
 
v¨_köd
);

27711 
	$add_imp‹t
(
JSP¨£Sèã
 *
s
, 
JSModuÀDef
 *
m
,

27712 
JSAtom
 
loˇl_«me
, JSAtom 
imp‹t_«me
)

27714 
JSC⁄ãxt
 *
˘x
 = 
s
->ctx;

27715 
i
, 
v¨_idx
;

27716 
JSImp‹tE¡ry
 *
mi
;

27717 
BOOL
 
is_loˇl
;

27719 i‡(
loˇl_«me
 =
JS_ATOM_¨gumíts
 ||Üoˇl_«mê=
JS_ATOM_evÆ
)

27720  
	`js_∑r£_îr‹
(
s
, "invalid import binding");

27722 i‡(
loˇl_«me
 !
JS_ATOM_deÁu…
) {

27723 
i
 = 0; i < 
s
->
cur_func
->
˛osuª_v¨_cou¡
; i++) {

27724 i‡(
s
->
cur_func
->
˛osuª_v¨
[
i
].
v¨_«me
 =
loˇl_«me
)

27725  
	`js_∑r£_îr‹
(
s
, "duplicate import binding");

27729 
is_loˇl
 = (
imp‹t_«me
 =
JS_ATOM__°¨_
);

27730 
v¨_idx
 = 
	`add_˛osuª_v¨
(
˘x
, 
s
->
cur_func
, 
is_loˇl
, 
FALSE
,

27731 
m
->
imp‹t_íåõs_cou¡
,

27732 
loˇl_«me
, 
TRUE
, TRUE, 
FALSE
);

27733 i‡(
v¨_idx
 < 0)

27735 i‡(
	`js_ªsize_¨øy
(
˘x
, (**)&
m
->
imp‹t_íåõs
,

27736 (
JSImp‹tE¡ry
),

27737 &
m
->
imp‹t_íåõs_size
, &m->
imp‹t_íåõs_cou¡
,

27738 
m
->
imp‹t_íåõs_cou¡
 + 1))

27740 
mi
 = &
m
->
imp‹t_íåõs
[m->
imp‹t_íåõs_cou¡
 - 1];

27741 
mi
->
imp‹t_«me
 = 
	`JS_DupAtom
(
˘x
, import_name);

27742 
mi
->
v¨_idx
 = var_idx;

27744 
	}
}

27746 
__ex˚±i⁄
 
	$js_∑r£_imp‹t
(
JSP¨£Sèã
 *
s
)

27748 
JSC⁄ãxt
 *
˘x
 = 
s
->ctx;

27749 
JSModuÀDef
 *
m
 = 
s
->
cur_func
->
moduÀ
;

27750 
JSAtom
 
loˇl_«me
, 
imp‹t_«me
, 
moduÀ_«me
;

27751 
fú°_imp‹t
, 
i
, 
idx
;

27753 i‡(
	`√xt_tokí
(
s
))

27756 
fú°_imp‹t
 = 
m
->
imp‹t_íåõs_cou¡
;

27757 i‡(
s
->
tokí
.
vÆ
 =
TOK_STRING
) {

27758 
moduÀ_«me
 = 
	`JS_VÆueToAtom
(
˘x
, 
s
->
tokí
.
u
.
°r
.str);

27759 i‡(
moduÀ_«me
 =
JS_ATOM_NULL
)

27761 i‡(
	`√xt_tokí
(
s
)) {

27762 
	`JS_FªeAtom
(
˘x
, 
moduÀ_«me
);

27766 i‡(
s
->
tokí
.
vÆ
 =
TOK_IDENT
) {

27767 i‡(
s
->
tokí
.
u
.
idít
.
is_ª£rved
) {

27768  
	`js_∑r£_îr‹_ª£rved_idítifõr
(
s
);

27771 
loˇl_«me
 = 
	`JS_DupAtom
(
˘x
, 
s
->
tokí
.
u
.
idít
.
©om
);

27772 
imp‹t_«me
 = 
JS_ATOM_deÁu…
;

27773 i‡(
	`√xt_tokí
(
s
))

27774 
Áû
;

27775 i‡(
	`add_imp‹t
(
s
, 
m
, 
loˇl_«me
, 
imp‹t_«me
))

27776 
Áû
;

27777 
	`JS_FªeAtom
(
˘x
, 
loˇl_«me
);

27779 i‡(
s
->
tokí
.
vÆ
 != ',')

27780 
íd_imp‹t_˛au£
;

27781 i‡(
	`√xt_tokí
(
s
))

27785 i‡(
s
->
tokí
.
vÆ
 == '*') {

27787 i‡(
	`√xt_tokí
(
s
))

27789 i‡(!
	`tokí_is_p£udo_keyw‹d
(
s
, 
JS_ATOM_as
))

27790  
	`js_∑r£_îr‹
(
s
, "expecting 'as'");

27791 i‡(
	`√xt_tokí
(
s
))

27793 i‡(!
	`tokí_is_idít
(
s
->
tokí
.
vÆ
)) {

27794 
	`js_∑r£_îr‹
(
s
, "identifierÉxpected");

27797 
loˇl_«me
 = 
	`JS_DupAtom
(
˘x
, 
s
->
tokí
.
u
.
idít
.
©om
);

27798 
imp‹t_«me
 = 
JS_ATOM__°¨_
;

27799 i‡(
	`√xt_tokí
(
s
))

27800 
Áû
;

27801 i‡(
	`add_imp‹t
(
s
, 
m
, 
loˇl_«me
, 
imp‹t_«me
))

27802 
Áû
;

27803 
	`JS_FªeAtom
(
˘x
, 
loˇl_«me
);

27804 } i‡(
s
->
tokí
.
vÆ
 == '{') {

27805 i‡(
	`√xt_tokí
(
s
))

27808 
s
->
tokí
.
vÆ
 != '}') {

27809 i‡(!
	`tokí_is_idít
(
s
->
tokí
.
vÆ
)) {

27810 
	`js_∑r£_îr‹
(
s
, "identifierÉxpected");

27813 
imp‹t_«me
 = 
	`JS_DupAtom
(
˘x
, 
s
->
tokí
.
u
.
idít
.
©om
);

27814 
loˇl_«me
 = 
JS_ATOM_NULL
;

27815 i‡(
	`√xt_tokí
(
s
))

27816 
Áû
;

27817 i‡(
	`tokí_is_p£udo_keyw‹d
(
s
, 
JS_ATOM_as
)) {

27818 i‡(
	`√xt_tokí
(
s
))

27819 
Áû
;

27820 i‡(!
	`tokí_is_idít
(
s
->
tokí
.
vÆ
)) {

27821 
	`js_∑r£_îr‹
(
s
, "identifierÉxpected");

27822 
Áû
;

27824 
loˇl_«me
 = 
	`JS_DupAtom
(
˘x
, 
s
->
tokí
.
u
.
idít
.
©om
);

27825 i‡(
	`√xt_tokí
(
s
)) {

27826 
Áû
:

27827 
	`JS_FªeAtom
(
˘x
, 
loˇl_«me
);

27828 
	`JS_FªeAtom
(
˘x
, 
imp‹t_«me
);

27832 
loˇl_«me
 = 
	`JS_DupAtom
(
˘x
, 
imp‹t_«me
);

27834 i‡(
	`add_imp‹t
(
s
, 
m
, 
loˇl_«me
, 
imp‹t_«me
))

27835 
Áû
;

27836 
	`JS_FªeAtom
(
˘x
, 
loˇl_«me
);

27837 
	`JS_FªeAtom
(
˘x
, 
imp‹t_«me
);

27838 i‡(
s
->
tokí
.
vÆ
 != ',')

27840 i‡(
	`√xt_tokí
(
s
))

27843 i‡(
	`js_∑r£_ex≥˘
(
s
, '}'))

27846 
íd_imp‹t_˛au£
:

27847 
moduÀ_«me
 = 
	`js_∑r£_‰om_˛au£
(
s
);

27848 i‡(
moduÀ_«me
 =
JS_ATOM_NULL
)

27851 
idx
 = 
	`add_ªq_moduÀ_íåy
(
˘x
, 
m
, 
moduÀ_«me
);

27852 
	`JS_FªeAtom
(
˘x
, 
moduÀ_«me
);

27853 i‡(
idx
 < 0)

27855 
i
 = 
fú°_imp‹t
; i < 
m
->
imp‹t_íåõs_cou¡
; i++)

27856 
m
->
imp‹t_íåõs
[
i
].
ªq_moduÀ_idx
 = 
idx
;

27858  
	`js_∑r£_ex≥˘_£mi
(
s
);

27859 
	}
}

27861 
__ex˚±i⁄
 
	$js_∑r£_sour˚_ñemít
(
JSP¨£Sèã
 *
s
)

27863 
JSFun˘i⁄Def
 *
fd
 = 
s
->
cur_func
;

27864 
tok
;

27866 i‡(
s
->
tokí
.
vÆ
 =
TOK_FUNCTION
 ||

27867 (
	`tokí_is_p£udo_keyw‹d
(
s
, 
JS_ATOM_async
) &&

27868 
	`≥ek_tokí
(
s
, 
TRUE
Ë=
TOK_FUNCTION
)) {

27869 i‡(
	`js_∑r£_fun˘i⁄_de˛
(
s
, 
JS_PARSE_FUNC_STATEMENT
,

27870 
JS_FUNC_NORMAL
, 
JS_ATOM_NULL
,

27871 
s
->
tokí
.
±r
, s->tokí.
löe_num
))

27873 } i‡(
s
->
tokí
.
vÆ
 =
TOK_EXPORT
 && 
fd
->
moduÀ
) {

27874 i‡(
	`js_∑r£_exp‹t
(
s
))

27876 } i‡(
s
->
tokí
.
vÆ
 =
TOK_IMPORT
 && 
fd
->
moduÀ
 &&

27877 ((
tok
 = 
	`≥ek_tokí
(
s
, 
FALSE
)) != '(' &&Åok != '.')) {

27880 i‡(
	`js_∑r£_imp‹t
(
s
))

27883 i‡(
	`js_∑r£_°©emít_‹_de˛
(
s
, 
DECL_MASK_ALL
))

27887 
	}
}

27889 
JSFun˘i⁄Def
 *
	$js_√w_fun˘i⁄_def
(
JSC⁄ãxt
 *
˘x
,

27890 
JSFun˘i⁄Def
 *
∑ª¡
,

27891 
BOOL
 
is_evÆ
,

27892 
BOOL
 
is_func_ex¥
,

27893 c⁄° *
fûíame
, 
löe_num
)

27895 
JSFun˘i⁄Def
 *
fd
;

27897 
fd
 = 
	`js_mÆlocz
(
˘x
, (*fd));

27898 i‡(!
fd
)

27899  
NULL
;

27901 
fd
->
˘x
 = ctx;

27902 
	`öô_li°_hód
(&
fd
->
chûd_li°
);

27905 
fd
->
∑ª¡
 =Öarent;

27906 
fd
->
∑ª¡_˝oﬁ_idx
 = -1;

27907 i‡(
∑ª¡
) {

27908 
	`li°_add_èû
(&
fd
->
lök
, &
∑ª¡
->
chûd_li°
);

27909 
fd
->
js_mode
 = 
∑ª¡
->js_mode;

27910 
fd
->
∑ª¡_sc›e_Àvñ
 = 
∑ª¡
->
sc›e_Àvñ
;

27913 
fd
->
is_evÆ
 = is_eval;

27914 
fd
->
is_func_ex¥
 = is_func_expr;

27915 
	`js_dbuf_öô
(
˘x
, &
fd
->
byã_code
);

27916 
fd
->
œ°_›code_pos
 = -1;

27917 
fd
->
func_«me
 = 
JS_ATOM_NULL
;

27918 
fd
->
v¨_obje˘_idx
 = -1;

27919 
fd
->
¨gumíts_v¨_idx
 = -1;

27920 
fd
->
func_v¨_idx
 = -1;

27921 
fd
->
evÆ_ªt_idx
 = -1;

27922 
fd
->
this_v¨_idx
 = -1;

27923 
fd
->
√w_èrgë_v¨_idx
 = -1;

27924 
fd
->
this_a˘ive_func_v¨_idx
 = -1;

27925 
fd
->
home_obje˘_v¨_idx
 = -1;

27928 
fd
->
sc›e_Àvñ
 = 0;

27929 
fd
->
sc›e_fú°
 = -1;

27930 
fd
->
sc›es
 = fd->
def_sc›e_¨øy
;

27931 
fd
->
sc›e_size
 = 
	`cou¡of
(fd->
def_sc›e_¨øy
);

27932 
fd
->
sc›e_cou¡
 = 1;

27933 
fd
->
sc›es
[0].
fú°
 = -1;

27934 
fd
->
sc›es
[0].
∑ª¡
 = -1;

27936 
fd
->
fûíame
 = 
	`JS_NewAtom
(
˘x
, filename);

27937 
fd
->
löe_num
 =Üine_num;

27939 
	`js_dbuf_öô
(
˘x
, &
fd
->
pc2löe
);

27942 
fd
->
œ°_›code_löe_num
 = 
löe_num
;

27944  
fd
;

27945 
	}
}

27947 
	$‰ì_byãcode_©oms
(
JSRu¡ime
 *
π
,

27948 c⁄° 
uöt8_t
 *
bc_buf
, 
bc_Àn
,

27949 
BOOL
 
u£_sh‹t_›codes
)

27951 
pos
, 
Àn
, 
›
;

27952 
JSAtom
 
©om
;

27953 c⁄° 
JSOpCode
 *
oi
;

27955 
pos
 = 0;

27956 
pos
 < 
bc_Àn
) {

27957 
›
 = 
bc_buf
[
pos
];

27958 i‡(
u£_sh‹t_›codes
)

27959 
oi
 = &
	`sh‹t_›code_öfo
(
›
);

27961 
oi
 = &
›code_öfo
[
›
];

27963 
Àn
 = 
oi
->
size
;

27964 
oi
->
fmt
) {

27965 
OP_FMT_©om
:

27966 
OP_FMT_©om_u8
:

27967 
OP_FMT_©om_u16
:

27968 
OP_FMT_©om_œbñ_u8
:

27969 
OP_FMT_©om_œbñ_u16
:

27970 
©om
 = 
	`gë_u32
(
bc_buf
 + 
pos
 + 1);

27971 
	`JS_FªeAtomRT
(
π
, 
©om
);

27976 
pos
 +
Àn
;

27978 
	}
}

27980 
	$js_‰ì_fun˘i⁄_def
(
JSC⁄ãxt
 *
˘x
, 
JSFun˘i⁄Def
 *
fd
)

27982 
i
;

27983 
li°_hód
 *
ñ
, *
ñ1
;

27986 
	`li°_f‹_óch_ß„
(
ñ
, 
ñ1
, &
fd
->
chûd_li°
) {

27987 
JSFun˘i⁄Def
 *
fd1
;

27988 
fd1
 = 
	`li°_íåy
(
ñ
, 
JSFun˘i⁄Def
, 
lök
);

27989 
	`js_‰ì_fun˘i⁄_def
(
˘x
, 
fd1
);

27992 
	`‰ì_byãcode_©oms
(
˘x
->
π
, 
fd
->
byã_code
.
buf
, fd->byã_code.
size
,

27993 
fd
->
u£_sh‹t_›codes
);

27994 
	`dbuf_‰ì
(&
fd
->
byã_code
);

27995 
	`js_‰ì
(
˘x
, 
fd
->
jump_¶Ÿs
);

27996 
	`js_‰ì
(
˘x
, 
fd
->
œbñ_¶Ÿs
);

27997 
	`js_‰ì
(
˘x
, 
fd
->
löe_numbî_¶Ÿs
);

27999 
i
 = 0; i < 
fd
->
˝oﬁ_cou¡
; i++) {

28000 
	`JS_FªeVÆue
(
˘x
, 
fd
->
˝oﬁ
[
i
]);

28002 
	`js_‰ì
(
˘x
, 
fd
->
˝oﬁ
);

28004 
	`JS_FªeAtom
(
˘x
, 
fd
->
func_«me
);

28006 
i
 = 0; i < 
fd
->
v¨_cou¡
; i++) {

28007 
	`JS_FªeAtom
(
˘x
, 
fd
->
v¨s
[
i
].
v¨_«me
);

28009 
	`js_‰ì
(
˘x
, 
fd
->
v¨s
);

28010 
i
 = 0; i < 
fd
->
¨g_cou¡
; i++) {

28011 
	`JS_FªeAtom
(
˘x
, 
fd
->
¨gs
[
i
].
v¨_«me
);

28013 
	`js_‰ì
(
˘x
, 
fd
->
¨gs
);

28015 
i
 = 0; i < 
fd
->
hoi°ed_def_cou¡
; i++) {

28016 
	`JS_FªeAtom
(
˘x
, 
fd
->
hoi°ed_def
[
i
].
v¨_«me
);

28018 
	`js_‰ì
(
˘x
, 
fd
->
hoi°ed_def
);

28020 
i
 = 0; i < 
fd
->
˛osuª_v¨_cou¡
; i++) {

28021 
JSClosuªV¨
 *
cv
 = &
fd
->
˛osuª_v¨
[
i
];

28022 
	`JS_FªeAtom
(
˘x
, 
cv
->
v¨_«me
);

28024 
	`js_‰ì
(
˘x
, 
fd
->
˛osuª_v¨
);

28026 i‡(
fd
->
sc›es
 !fd->
def_sc›e_¨øy
)

28027 
	`js_‰ì
(
˘x
, 
fd
->
sc›es
);

28029 
	`JS_FªeAtom
(
˘x
, 
fd
->
fûíame
);

28030 
	`dbuf_‰ì
(&
fd
->
pc2löe
);

28032 
	`js_‰ì
(
˘x
, 
fd
->
sour˚
);

28034 i‡(
fd
->
∑ª¡
) {

28036 
	`li°_dñ
(&
fd
->
lök
);

28038 
	`js_‰ì
(
˘x
, 
fd
);

28039 
	}
}

28041 #ifde‡
DUMP_BYTECODE


28042 c⁄° *
	$skù_löes
(c⁄° *
p
, 
n
) {

28043 
n
-- > 0 && *
p
) {

28044 *
p
 && *p++ != '\n')

28047  
p
;

28048 
	}
}

28050 
	$¥öt_löes
(c⁄° *
sour˚
, 
löe
, 
löe1
) {

28051 c⁄° *
s
 = 
sour˚
;

28052 c⁄° *
p
 = 
	`skù_löes
(
s
, 
löe
);

28053 i‡(*
p
) {

28054 
löe
++ < 
löe1
) {

28055 
p
 = 
	`skù_löes
(
s
 =Ö, 1);

28056 
	`¥ötf
(";; %.*s", ()(
p
 - 
s
), s);

28057 i‡(!*
p
) {

28058 i‡(
p
[-1] != '\n')

28059 
	`¥ötf
("\n");

28064 
	}
}

28066 
	$dump_byã_code
(
JSC⁄ãxt
 *
˘x
, 
∑ss
,

28067 c⁄° 
uöt8_t
 *
èb
, 
Àn
,

28068 c⁄° 
JSV¨Def
 *
¨gs
, 
¨g_cou¡
,

28069 c⁄° 
JSV¨Def
 *
v¨s
, 
v¨_cou¡
,

28070 c⁄° 
JSClosuªV¨
 *
˛osuª_v¨
, 
˛osuª_v¨_cou¡
,

28071 c⁄° 
JSVÆue
 *
˝oﬁ
, 
uöt32_t
 
˝oﬁ_cou¡
,

28072 c⁄° *
sour˚
, 
löe_num
,

28073 c⁄° 
LabñSlŸ
 *
œbñ_¶Ÿs
, 
JSFun˘i⁄Byãcode
 *
b
)

28075 c⁄° 
JSOpCode
 *
oi
;

28076 
pos
, 
pos_√xt
, 
›
, 
size
, 
idx
, 
addr
, 
löe
, 
löe1
, 
ö_sour˚
;

28077 
uöt8_t
 *
bôs
 = 
	`js_mÆlocz
(
˘x
, 
Àn
 * (*bits));

28078 
BOOL
 
u£_sh‹t_›codes
 = (
b
 !
NULL
);

28081 
pos
 = 0;Öo†< 
Àn
;Öo†
pos_√xt
) {

28082 
›
 = 
èb
[
pos
];

28083 i‡(
u£_sh‹t_›codes
)

28084 
oi
 = &
	`sh‹t_›code_öfo
(
›
);

28086 
oi
 = &
›code_öfo
[
›
];

28087 
pos_√xt
 = 
pos
 + 
oi
->
size
;

28088 i‡(
›
 < 
OP_COUNT
) {

28089 
oi
->
fmt
) {

28090 #i‡
SHORT_OPCODES


28091 
OP_FMT_œbñ8
:

28092 
pos
++;

28093 
addr
 = (
öt8_t
)
èb
[
pos
];

28094 
has_addr
;

28095 
OP_FMT_œbñ16
:

28096 
pos
++;

28097 
addr
 = (
öt16_t
)
	`gë_u16
(
èb
 + 
pos
);

28098 
has_addr
;

28100 
OP_FMT_©om_œbñ_u8
:

28101 
OP_FMT_©om_œbñ_u16
:

28102 
pos
 += 4;

28104 
OP_FMT_œbñ
:

28105 
OP_FMT_œbñ_u16
:

28106 
pos
++;

28107 
addr
 = 
	`gë_u32
(
èb
 + 
pos
);

28108 
has_addr
;

28109 
has_addr
:

28110 i‡(
∑ss
 == 1)

28111 
addr
 = 
œbñ_¶Ÿs
[addr].
pos
;

28112 i‡(
∑ss
 == 2)

28113 
addr
 = 
œbñ_¶Ÿs
[addr].
pos2
;

28114 i‡(
∑ss
 == 3)

28115 
addr
 +
pos
;

28116 i‡(
addr
 >0 &&ádd∏< 
Àn
)

28117 
bôs
[
addr
] |= 1;

28122 
ö_sour˚
 = 0;

28123 i‡(
sour˚
) {

28125 
	`¥öt_löes
(
sour˚
, 0, 1);

28126 
ö_sour˚
 = 1;

28128 
löe1
 = 
löe
 = 1;

28129 
pos
 = 0;

28130 
pos
 < 
Àn
) {

28131 
›
 = 
èb
[
pos
];

28132 i‡(
sour˚
) {

28133 i‡(
b
) {

28134 
löe1
 = 
	`föd_löe_num
(
˘x
, 
b
, 
pos
Ë- 
löe_num
 + 1;

28135 } i‡(
›
 =
OP_löe_num
) {

28136 
löe1
 = 
	`gë_u32
(
èb
 + 
pos
 + 1Ë- 
löe_num
 + 1;

28138 i‡(
löe1
 > 
löe
) {

28139 i‡(!
ö_sour˚
)

28140 
	`¥ötf
("\n");

28141 
ö_sour˚
 = 1;

28142 
	`¥öt_löes
(
sour˚
, 
löe
, 
löe1
);

28143 
löe
 = 
löe1
;

28147 i‡(
ö_sour˚
)

28148 
	`¥ötf
("\n");

28149 
ö_sour˚
 = 0;

28150 i‡(
›
 >
OP_COUNT
) {

28151 
	`¥ötf
("övÆid opcodê(0x%02x)\n", 
›
);

28152 
pos
++;

28155 i‡(
u£_sh‹t_›codes
)

28156 
oi
 = &
	`sh‹t_›code_öfo
(
›
);

28158 
oi
 = &
›code_öfo
[
›
];

28159 
size
 = 
oi
->size;

28160 i‡(
pos
 + 
size
 > 
Àn
) {

28161 
	`¥ötf
("åunˇãd opcodê(0x%02x)\n", 
›
);

28164 #i‡
	`deföed
(
DUMP_BYTECODE
) && (DUMP_BYTECODE & 16)

28166 
i
, 
x
, 
x0
;

28167 
x
 = 
x0
 = 
	`¥ötf
("%5d ", 
pos
);

28168 
i
 = 0; i < 
size
; i++) {

28169 i‡(
i
 == 6) {

28170 
	`¥ötf
("\n%*s", 
x
 = 
x0
, "");

28172 
x
 +
	`¥ötf
(" %02X", 
èb
[
pos
 + 
i
]);

28174 
	`¥ötf
("%*s", 
x0
 + 20 - 
x
, "");

28177 i‡(
bôs
[
pos
]) {

28178 
	`¥ötf
("%5d: ", 
pos
);

28180 
	`¥ötf
(" ");

28182 
	`¥ötf
("%s", 
oi
->
«me
);

28183 
pos
++;

28184 
oi
->
fmt
) {

28185 
OP_FMT_n⁄e_öt
:

28186 
	`¥ötf
(" %d", 
›
 - 
OP_push_0
);

28188 
OP_FMT_≈›x
:

28189 
	`¥ötf
(" %d", 
›
 - 
OP_ˇŒ0
);

28191 
OP_FMT_u8
:

28192 
	`¥ötf
(" %u", 
	`gë_u8
(
èb
 + 
pos
));

28194 
OP_FMT_i8
:

28195 
	`¥ötf
(" %d", 
	`gë_i8
(
èb
 + 
pos
));

28197 
OP_FMT_u16
:

28198 
OP_FMT_≈›
:

28199 
	`¥ötf
(" %u", 
	`gë_u16
(
èb
 + 
pos
));

28201 
OP_FMT_≈›_u16
:

28202 
	`¥ötf
(" %u,%u", 
	`gë_u16
(
èb
 + 
pos
), get_u16(tab +Öos + 2));

28204 
OP_FMT_i16
:

28205 
	`¥ötf
(" %d", 
	`gë_i16
(
èb
 + 
pos
));

28207 
OP_FMT_i32
:

28208 
	`¥ötf
(" %d", 
	`gë_i32
(
èb
 + 
pos
));

28210 
OP_FMT_u32
:

28211 
	`¥ötf
(" %u", 
	`gë_u32
(
èb
 + 
pos
));

28213 #i‡
SHORT_OPCODES


28214 
OP_FMT_œbñ8
:

28215 
addr
 = 
	`gë_i8
(
èb
 + 
pos
);

28216 
has_addr1
;

28217 
OP_FMT_œbñ16
:

28218 
addr
 = 
	`gë_i16
(
èb
 + 
pos
);

28219 
has_addr1
;

28221 
OP_FMT_œbñ
:

28222 
addr
 = 
	`gë_u32
(
èb
 + 
pos
);

28223 
has_addr1
;

28224 
has_addr1
:

28225 i‡(
∑ss
 == 1)

28226 
	`¥ötf
(" %u:%u", 
addr
, 
œbñ_¶Ÿs
[addr].
pos
);

28227 i‡(
∑ss
 == 2)

28228 
	`¥ötf
(" %u:%u", 
addr
, 
œbñ_¶Ÿs
[addr].
pos2
);

28229 i‡(
∑ss
 == 3)

28230 
	`¥ötf
(" %u", 
addr
 + 
pos
);

28232 
OP_FMT_œbñ_u16
:

28233 
addr
 = 
	`gë_u32
(
èb
 + 
pos
);

28234 i‡(
∑ss
 == 1)

28235 
	`¥ötf
(" %u:%u", 
addr
, 
œbñ_¶Ÿs
[addr].
pos
);

28236 i‡(
∑ss
 == 2)

28237 
	`¥ötf
(" %u:%u", 
addr
, 
œbñ_¶Ÿs
[addr].
pos2
);

28238 i‡(
∑ss
 == 3)

28239 
	`¥ötf
(" %u", 
addr
 + 
pos
);

28240 
	`¥ötf
(",%u", 
	`gë_u16
(
èb
 + 
pos
 + 4));

28242 #i‡
SHORT_OPCODES


28243 
OP_FMT_c⁄°8
:

28244 
idx
 = 
	`gë_u8
(
èb
 + 
pos
);

28245 
has_poﬁ_idx
;

28247 
OP_FMT_c⁄°
:

28248 
idx
 = 
	`gë_u32
(
èb
 + 
pos
);

28249 
has_poﬁ_idx
;

28250 
has_poﬁ_idx
:

28251 
	`¥ötf
(" %u: ", 
idx
);

28252 i‡(
idx
 < 
˝oﬁ_cou¡
) {

28253 
	`JS_DumpVÆue
(
˘x
, 
˝oﬁ
[
idx
]);

28256 
OP_FMT_©om
:

28257 
	`¥ötf
(" ");

28258 
	`¥öt_©om
(
˘x
, 
	`gë_u32
(
èb
 + 
pos
));

28260 
OP_FMT_©om_u8
:

28261 
	`¥ötf
(" ");

28262 
	`¥öt_©om
(
˘x
, 
	`gë_u32
(
èb
 + 
pos
));

28263 
	`¥ötf
(",%d", 
	`gë_u8
(
èb
 + 
pos
 + 4));

28265 
OP_FMT_©om_u16
:

28266 
	`¥ötf
(" ");

28267 
	`¥öt_©om
(
˘x
, 
	`gë_u32
(
èb
 + 
pos
));

28268 
	`¥ötf
(",%d", 
	`gë_u16
(
èb
 + 
pos
 + 4));

28270 
OP_FMT_©om_œbñ_u8
:

28271 
OP_FMT_©om_œbñ_u16
:

28272 
	`¥ötf
(" ");

28273 
	`¥öt_©om
(
˘x
, 
	`gë_u32
(
èb
 + 
pos
));

28274 
addr
 = 
	`gë_u32
(
èb
 + 
pos
 + 4);

28275 i‡(
∑ss
 == 1)

28276 
	`¥ötf
(",%u:%u", 
addr
, 
œbñ_¶Ÿs
[addr].
pos
);

28277 i‡(
∑ss
 == 2)

28278 
	`¥ötf
(",%u:%u", 
addr
, 
œbñ_¶Ÿs
[addr].
pos2
);

28279 i‡(
∑ss
 == 3)

28280 
	`¥ötf
(",%u", 
addr
 + 
pos
 + 4);

28281 i‡(
oi
->
fmt
 =
OP_FMT_©om_œbñ_u8
)

28282 
	`¥ötf
(",%u", 
	`gë_u8
(
èb
 + 
pos
 + 8));

28284 
	`¥ötf
(",%u", 
	`gë_u16
(
èb
 + 
pos
 + 8));

28286 
OP_FMT_n⁄e_loc
:

28287 
idx
 = (
›
 - 
OP_gë_loc0
) % 4;

28288 
has_loc
;

28289 
OP_FMT_loc8
:

28290 
idx
 = 
	`gë_u8
(
èb
 + 
pos
);

28291 
has_loc
;

28292 
OP_FMT_loc
:

28293 
idx
 = 
	`gë_u16
(
èb
 + 
pos
);

28294 
has_loc
:

28295 
	`¥ötf
(" %d: ", 
idx
);

28296 i‡(
idx
 < 
v¨_cou¡
) {

28297 
	`¥öt_©om
(
˘x
, 
v¨s
[
idx
].
v¨_«me
);

28300 
OP_FMT_n⁄e_¨g
:

28301 
idx
 = (
›
 - 
OP_gë_¨g0
) % 4;

28302 
has_¨g
;

28303 
OP_FMT_¨g
:

28304 
idx
 = 
	`gë_u16
(
èb
 + 
pos
);

28305 
has_¨g
:

28306 
	`¥ötf
(" %d: ", 
idx
);

28307 i‡(
idx
 < 
¨g_cou¡
) {

28308 
	`¥öt_©om
(
˘x
, 
¨gs
[
idx
].
v¨_«me
);

28311 
OP_FMT_n⁄e_v¨_ªf
:

28312 
idx
 = (
›
 - 
OP_gë_v¨_ªf0
) % 4;

28313 
has_v¨_ªf
;

28314 
OP_FMT_v¨_ªf
:

28315 
idx
 = 
	`gë_u16
(
èb
 + 
pos
);

28316 
has_v¨_ªf
:

28317 
	`¥ötf
(" %d: ", 
idx
);

28318 i‡(
idx
 < 
˛osuª_v¨_cou¡
) {

28319 
	`¥öt_©om
(
˘x
, 
˛osuª_v¨
[
idx
].
v¨_«me
);

28325 
	`¥ötf
("\n");

28326 
pos
 +
oi
->
size
 - 1;

28328 i‡(
sour˚
) {

28329 i‡(!
ö_sour˚
)

28330 
	`¥ötf
("\n");

28331 
	`¥öt_löes
(
sour˚
, 
löe
, 
INT32_MAX
);

28333 
	`js_‰ì
(
˘x
, 
bôs
);

28334 
	}
}

28336 
__maybe_unu£d
 
	$dump_pc2löe
(
JSC⁄ãxt
 *
˘x
, c⁄° 
uöt8_t
 *
buf
, 
Àn
,

28337 
löe_num
)

28339 c⁄° 
uöt8_t
 *
p_íd
, *
p_√xt
, *
p
;

28340 
pc
, 
v
;

28341 
›
;

28343 i‡(
Àn
 <= 0)

28346 
	`¥ötf
("%5s %5s\n", "PC", "LINE");

28348 
p
 = 
buf
;

28349 
p_íd
 = 
buf
 + 
Àn
;

28350 
pc
 = 0;

28351 
p
 < 
p_íd
) {

28352 
›
 = *
p
++;

28353 i‡(
›
 == 0) {

28354 
v
 = 
	`unicode_‰om_utf8
(
p
, 
p_íd
 -Ö, &
p_√xt
);

28355 i‡(
v
 < 0)

28356 
Áû
;

28357 
pc
 +
v
;

28358 
p
 = 
p_√xt
;

28359 
v
 = 
	`unicode_‰om_utf8
(
p
, 
p_íd
 -Ö, &
p_√xt
);

28360 i‡(
v
 < 0) {

28361 
Áû
:

28362 
	`¥ötf
("övÆidÖc2löêícodêpos=%d\n", ()(
p
 - 
buf
));

28365 i‡(!(
v
 & 1)) {

28366 
v
 = v >> 1;

28368 
v
 = -(v >> 1) - 1;

28370 
löe_num
 +
v
;

28371 
p
 = 
p_√xt
;

28373 
›
 -
PC2LINE_OP_FIRST
;

28374 
pc
 +(
›
 / 
PC2LINE_RANGE
);

28375 
löe_num
 +(
›
 % 
PC2LINE_RANGE
Ë+ 
PC2LINE_BASE
;

28377 
	`¥ötf
("%5d %5d\n", 
pc
, 
löe_num
);

28379 
	}
}

28381 
__maybe_unu£d
 
	$js_dump_fun˘i⁄_byãcode
(
JSC⁄ãxt
 *
˘x
, 
JSFun˘i⁄Byãcode
 *
b
)

28383 
i
;

28384 
©om_buf
[
ATOM_GET_STR_BUF_SIZE
];

28385 c⁄° *
°r
;

28387 i‡(
b
->
has_debug
 && b->
debug
.
fûíame
 !
JS_ATOM_NULL
) {

28388 
°r
 = 
	`JS_AtomGëSå
(
˘x
, 
©om_buf
, ◊tom_buf), 
b
->
debug
.
fûíame
);

28389 
	`¥ötf
("%s:%d: ", 
°r
, 
b
->
debug
.
löe_num
);

28392 
°r
 = 
	`JS_AtomGëSå
(
˘x
, 
©om_buf
, ◊tom_buf), 
b
->
func_«me
);

28393 
	`¥ötf
("fun˘i⁄: %s%s\n", &"*"[
b
->
func_köd
 !
JS_FUNC_GENERATOR
], 
°r
);

28394 i‡(
b
->
js_mode
) {

28395 
	`¥ötf
(" mode:");

28396 i‡(
b
->
js_mode
 & 
JS_MODE_STRICT
)

28397 
	`¥ötf
(" strict");

28398 #ifde‡
CONFIG_BIGNUM


28399 i‡(
b
->
js_mode
 & 
JS_MODE_MATH
)

28400 
	`¥ötf
(" math");

28402 
	`¥ötf
("\n");

28404 i‡(
b
->
¨g_cou¡
 && b->
v¨defs
) {

28405 
	`¥ötf
("árgs:");

28406 
i
 = 0; i < 
b
->
¨g_cou¡
; i++) {

28407 
	`¥ötf
(" %s", 
	`JS_AtomGëSå
(
˘x
, 
©om_buf
, (atom_buf),

28408 
b
->
v¨defs
[
i
].
v¨_«me
));

28410 
	`¥ötf
("\n");

28412 i‡(
b
->
v¨_cou¡
 && b->
v¨defs
) {

28413 
	`¥ötf
("Üocals:\n");

28414 
i
 = 0; i < 
b
->
v¨_cou¡
; i++) {

28415 
JSV¨Def
 *
vd
 = &
b
->
v¨defs
[b->
¨g_cou¡
 + 
i
];

28416 
	`¥ötf
("%5d: %†%s", 
i
,

28417 
vd
->
v¨_köd
 =
JS_VAR_CATCH
 ? "catch" :

28418 (
vd
->
v¨_köd
 =
JS_VAR_FUNCTION_DECL
 ||

28419 
vd
->
v¨_köd
 =
JS_VAR_NEW_FUNCTION_DECL
) ? "function" :

28420 
vd
->
is_c⁄°
 ? "const" :

28421 
vd
->
is_Àxiˇl
 ? "let" : "var",

28422 
	`JS_AtomGëSå
(
˘x
, 
©om_buf
, ◊tom_buf), 
vd
->
v¨_«me
));

28423 i‡(
vd
->
sc›e_Àvñ
)

28424 
	`¥ötf
(" [Àvñ:%dÇext:%d]", 
vd
->
sc›e_Àvñ
, vd->
sc›e_√xt
);

28425 
	`¥ötf
("\n");

28428 i‡(
b
->
˛osuª_v¨_cou¡
) {

28429 
	`¥ötf
(" closure vars:\n");

28430 
i
 = 0; i < 
b
->
˛osuª_v¨_cou¡
; i++) {

28431 
JSClosuªV¨
 *
cv
 = &
b
->
˛osuª_v¨
[
i
];

28432 
	`¥ötf
("%5d: %†%s:%s%d %s\n", 
i
,

28433 
	`JS_AtomGëSå
(
˘x
, 
©om_buf
, ◊tom_buf), 
cv
->
v¨_«me
),

28434 
cv
->
is_loˇl
 ? "local" : "parent",

28435 
cv
->
is_¨g
 ? "¨g" : "loc", cv->
v¨_idx
,

28436 
cv
->
is_c⁄°
 ? "const" :

28437 
cv
->
is_Àxiˇl
 ? "let" : "var");

28440 
	`¥ötf
(" sèck_size: %d\n", 
b
->
°ack_size
);

28441 
	`¥ötf
(" opcodes:\n");

28442 
	`dump_byã_code
(
˘x
, 3, 
b
->
byã_code_buf
, b->
byã_code_Àn
,

28443 
b
->
v¨defs
, b->
¨g_cou¡
,

28444 
b
->
v¨defs
 ? b->v¨def†+ b->
¨g_cou¡
 : 
NULL
, b->
v¨_cou¡
,

28445 
b
->
˛osuª_v¨
, b->
˛osuª_v¨_cou¡
,

28446 
b
->
˝oﬁ
, b->
˝oﬁ_cou¡
,

28447 
b
->
has_debug
 ? b->
debug
.
sour˚
 : 
NULL
,

28448 
b
->
has_debug
 ? b->
debug
.
löe_num
 : -1, 
NULL
, b);

28449 #i‡
	`deföed
(
DUMP_BYTECODE
) && (DUMP_BYTECODE & 32)

28450 i‡(
b
->
has_debug
)

28451 
	`dump_pc2löe
(
˘x
, 
b
->
debug
.
pc2löe_buf
, b->debug.
pc2löe_Àn
, b->debug.
löe_num
);

28453 
	`¥ötf
("\n");

28454 
	}
}

28457 
	$add_˛osuª_v¨
(
JSC⁄ãxt
 *
˘x
, 
JSFun˘i⁄Def
 *
s
,

28458 
BOOL
 
is_loˇl
, BOOL 
is_¨g
,

28459 
v¨_idx
, 
JSAtom
 
v¨_«me
,

28460 
BOOL
 
is_c⁄°
, BOOL 
is_Àxiˇl
,

28461 
JSV¨KödEnum
 
v¨_köd
)

28463 
JSClosuªV¨
 *
cv
;

28466 i‡(
s
->
˛osuª_v¨_cou¡
 >
JS_MAX_LOCAL_VARS
) {

28467 
	`JS_ThrowI¡î«lEº‹
(
˘x
, "too many closure variables");

28471 i‡(
s
->
˛osuª_v¨_cou¡
 >s->
˛osuª_v¨_size
) {

28472 
JSClosuªV¨
 *
√w_èb
;

28473 
√w_size
;

28474 
size_t
 
¶ack
;

28475 
√w_size
 = 
	`max_öt
(
s
->
˛osuª_v¨_cou¡
 + 1,

28476 
s
->
˛osuª_v¨_size
 * 3 / 2);

28477 
√w_èb
 = 
	`js_ªÆloc2
(
˘x
, 
s
->
˛osuª_v¨
,

28478 
√w_size
 * (
JSClosuªV¨
), &
¶ack
);

28479 i‡(!
√w_èb
)

28481 
√w_size
 +
¶ack
 / (*
√w_èb
);

28482 
s
->
˛osuª_v¨
 = 
√w_èb
;

28483 
s
->
˛osuª_v¨_size
 = 
√w_size
;

28485 
cv
 = &
s
->
˛osuª_v¨
[s->
˛osuª_v¨_cou¡
++];

28486 
cv
->
is_loˇl
 = is_local;

28487 
cv
->
is_¨g
 = is_arg;

28488 
cv
->
is_c⁄°
 = is_const;

28489 
cv
->
is_Àxiˇl
 = is_lexical;

28490 
cv
->
v¨_köd
 = var_kind;

28491 
cv
->
v¨_idx
 = var_idx;

28492 
cv
->
v¨_«me
 = 
	`JS_DupAtom
(
˘x
, var_name);

28493  
s
->
˛osuª_v¨_cou¡
 - 1;

28494 
	}
}

28496 
	$föd_˛osuª_v¨
(
JSC⁄ãxt
 *
˘x
, 
JSFun˘i⁄Def
 *
s
,

28497 
JSAtom
 
v¨_«me
)

28499 
i
;

28500 
i
 = 0; i < 
s
->
˛osuª_v¨_cou¡
; i++) {

28501 
JSClosuªV¨
 *
cv
 = &
s
->
˛osuª_v¨
[
i
];

28502 i‡(
cv
->
v¨_«me
 == var_name)

28503  
i
;

28506 
	}
}

28511 
	$gë_˛osuª_v¨2
(
JSC⁄ãxt
 *
˘x
, 
JSFun˘i⁄Def
 *
s
,

28512 
JSFun˘i⁄Def
 *
fd
, 
BOOL
 
is_loˇl
,

28513 
BOOL
 
is_¨g
, 
v¨_idx
, 
JSAtom
 
v¨_«me
,

28514 
BOOL
 
is_c⁄°
, BOOL 
is_Àxiˇl
,

28515 
JSV¨KödEnum
 
v¨_köd
)

28517 
i
;

28519 i‡(
fd
 !
s
->
∑ª¡
) {

28520 
v¨_idx
 = 
	`gë_˛osuª_v¨2
(
˘x
, 
s
->
∑ª¡
, 
fd
, 
is_loˇl
,

28521 
is_¨g
, 
v¨_idx
, 
v¨_«me
,

28522 
is_c⁄°
, 
is_Àxiˇl
, 
v¨_köd
);

28523 i‡(
v¨_idx
 < 0)

28525 
is_loˇl
 = 
FALSE
;

28527 
i
 = 0; i < 
s
->
˛osuª_v¨_cou¡
; i++) {

28528 
JSClosuªV¨
 *
cv
 = &
s
->
˛osuª_v¨
[
i
];

28529 i‡(
cv
->
v¨_idx
 =v¨_idx && cv->
is_¨g
 == is_arg &&

28530 
cv
->
is_loˇl
 == is_local)

28531  
i
;

28533  
	`add_˛osuª_v¨
(
˘x
, 
s
, 
is_loˇl
, 
is_¨g
, 
v¨_idx
, 
v¨_«me
,

28534 
is_c⁄°
, 
is_Àxiˇl
, 
v¨_köd
);

28535 
	}
}

28537 
	$gë_˛osuª_v¨
(
JSC⁄ãxt
 *
˘x
, 
JSFun˘i⁄Def
 *
s
,

28538 
JSFun˘i⁄Def
 *
fd
, 
BOOL
 
is_¨g
,

28539 
v¨_idx
, 
JSAtom
 
v¨_«me
,

28540 
BOOL
 
is_c⁄°
, BOOL 
is_Àxiˇl
,

28541 
JSV¨KödEnum
 
v¨_köd
)

28543  
	`gë_˛osuª_v¨2
(
˘x
, 
s
, 
fd
, 
TRUE
, 
is_¨g
,

28544 
v¨_idx
, 
v¨_«me
, 
is_c⁄°
, 
is_Àxiˇl
,

28545 
v¨_köd
);

28546 
	}
}

28548 
	$gë_wôh_sc›e_›code
(
›
)

28550 i‡(
›
 =
OP_sc›e_gë_v¨_undef
)

28551  
OP_wôh_gë_v¨
;

28553  
OP_wôh_gë_v¨
 + (
›
 - 
OP_sc›e_gë_v¨
);

28554 
	}
}

28556 
BOOL
 
	$ˇn_›t_put_ªf_vÆue
(c⁄° 
uöt8_t
 *
bc_buf
, 
pos
)

28558 
›code
 = 
bc_buf
[
pos
];

28559  (
bc_buf
[
pos
 + 1] =
OP_put_ªf_vÆue
 &&

28560 (
›code
 =
OP_ö£π3
 ||

28561 
›code
 =
OP_≥rm4
 ||

28563 
›code
 =
OP_rŸ3l
));

28564 
	}
}

28566 
BOOL
 
	$ˇn_›t_put_globÆ_ªf_vÆue
(c⁄° 
uöt8_t
 *
bc_buf
, 
pos
)

28568 
›code
 = 
bc_buf
[
pos
];

28569  (
bc_buf
[
pos
 + 1] =
OP_put_ªf_vÆue
 &&

28570 (
›code
 =
OP_ö£π3
 ||

28571 
›code
 =
OP_≥rm4
 ||

28573 
›code
 =
OP_rŸ3l
));

28574 
	}
}

28576 
	$›timize_sc›e_make_ªf
(
JSC⁄ãxt
 *
˘x
, 
JSFun˘i⁄Def
 *
s
,

28577 
DynBuf
 *
bc
, 
uöt8_t
 *
bc_buf
,

28578 
LabñSlŸ
 *
ls
, 
pos_√xt
,

28579 
gë_›
, 
v¨_idx
)

28581 
œbñ_pos
, 
íd_pos
, 
pos
;

28591 i‡(
bc_buf
[
pos_√xt
] =
OP_gë_ªf_vÆue
) {

28592 
	`dbuf_putc
(
bc
, 
gë_›
);

28593 
	`dbuf_put_u16
(
bc
, 
v¨_idx
);

28594 
pos_√xt
++;

28599 
œbñ_pos
 = 
ls
->
pos
;

28600 
pos
 = 
œbñ_pos
 - 5;

28601 
	`as£π
(
bc_buf
[
pos
] =
OP_œbñ
);

28608 
íd_pos
 = 
œbñ_pos
 + 2;

28609 i‡(
bc_buf
[
œbñ_pos
] =
OP_ö£π3
)

28610 
bc_buf
[
pos
++] = 
OP_dup
;

28611 
bc_buf
[
pos
] = 
gë_›
 + 1;

28612 
	`put_u16
(
bc_buf
 + 
pos
 + 1, 
v¨_idx
);

28613 
pos
 += 3;

28615 
pos
 < 
íd_pos
)

28616 
bc_buf
[
pos
++] = 
OP_n›
;

28617  
pos_√xt
;

28618 
	}
}

28620 
	$›timize_sc›e_make_globÆ_ªf
(
JSC⁄ãxt
 *
˘x
, 
JSFun˘i⁄Def
 *
s
,

28621 
DynBuf
 *
bc
, 
uöt8_t
 *
bc_buf
,

28622 
LabñSlŸ
 *
ls
, 
pos_√xt
,

28623 
JSAtom
 
v¨_«me
)

28625 
œbñ_pos
, 
íd_pos
, 
pos
, 
›
;

28626 
BOOL
 
is_°ri˘
;

28627 
is_°ri˘
 = ((
s
->
js_mode
 & 
JS_MODE_STRICT
) != 0);

28631 i‡(
is_°ri˘
) {

28635 
	`dbuf_putc
(
bc
, 
OP_check_v¨
);

28636 
	`dbuf_put_u32
(
bc
, 
	`JS_DupAtom
(
˘x
, 
v¨_«me
));

28640 i‡(
bc_buf
[
pos_√xt
] =
OP_gë_ªf_vÆue
) {

28641 
	`dbuf_putc
(
bc
, 
OP_gë_v¨
);

28642 
	`dbuf_put_u32
(
bc
, 
	`JS_DupAtom
(
˘x
, 
v¨_«me
));

28643 
pos_√xt
++;

28648 
œbñ_pos
 = 
ls
->
pos
;

28649 
pos
 = 
œbñ_pos
 - 5;

28650 
	`as£π
(
bc_buf
[
pos
] =
OP_œbñ
);

28651 
íd_pos
 = 
œbñ_pos
 + 2;

28652 
›
 = 
bc_buf
[
œbñ_pos
];

28653 i‡(
is_°ri˘
) {

28654 
›
) {

28655 
OP_ö£π3
:

28656 
›
 = 
OP_ö£π2
;

28658 
OP_≥rm4
:

28659 
›
 = 
OP_≥rm3
;

28661 
OP_rŸ3l
:

28662 
›
 = 
OP_sw≠
;

28665 
	`ab‹t
();

28667 
bc_buf
[
pos
++] = 
›
;

28669 i‡(
›
 =
OP_ö£π3
)

28670 
bc_buf
[
pos
++] = 
OP_dup
;

28672 i‡(
is_°ri˘
) {

28673 
bc_buf
[
pos
] = 
OP_put_v¨_°ri˘
;

28676 
bc_buf
[
pos
] = 
OP_put_v¨
;

28679 
	`put_u32
(
bc_buf
 + 
pos
 + 1, 
	`JS_DupAtom
(
˘x
, 
v¨_«me
));

28680 
pos
 += 5;

28682 
pos
 < 
íd_pos
)

28683 
bc_buf
[
pos
++] = 
OP_n›
;

28684  
pos_√xt
;

28685 
	}
}

28687 
	$add_v¨_this
(
JSC⁄ãxt
 *
˘x
, 
JSFun˘i⁄Def
 *
fd
)

28689 
idx
;

28690 
idx
 = 
	`add_v¨
(
˘x
, 
fd
, 
JS_ATOM_this
);

28691 i‡(
idx
 >0 && 
fd
->
is_dîived_˛ass_c⁄°ru˘‹
) {

28692 
JSV¨Def
 *
vd
 = &
fd
->
v¨s
[
idx
];

28694 
vd
->
is_Àxiˇl
 = 1;

28697  
idx
;

28698 
	}
}

28700 
	$ªsﬁve_p£udo_v¨
(
JSC⁄ãxt
 *
˘x
, 
JSFun˘i⁄Def
 *
s
,

28701 
JSAtom
 
v¨_«me
)

28703 
v¨_idx
;

28705 i‡(!
s
->
has_this_bödög
)

28707 
v¨_«me
) {

28708 
JS_ATOM_home_obje˘
:

28710 
v¨_idx
 = 
s
->
home_obje˘_v¨_idx
 = 
	`add_v¨
(
˘x
, s, 
v¨_«me
);

28712 
JS_ATOM_this_a˘ive_func
:

28714 
v¨_idx
 = 
s
->
this_a˘ive_func_v¨_idx
 = 
	`add_v¨
(
˘x
, s, 
v¨_«me
);

28716 
JS_ATOM_√w_èrgë
:

28718 
v¨_idx
 = 
s
->
√w_èrgë_v¨_idx
 = 
	`add_v¨
(
˘x
, s, 
v¨_«me
);

28720 
JS_ATOM_this
:

28722 
v¨_idx
 = 
s
->
this_v¨_idx
 = 
	`add_v¨_this
(
˘x
, s);

28725 
v¨_idx
 = -1;

28728  
v¨_idx
;

28729 
	}
}

28732 
	$ªsﬁve_sc›e_v¨
(
JSC⁄ãxt
 *
˘x
, 
JSFun˘i⁄Def
 *
s
,

28733 
JSAtom
 
v¨_«me
, 
sc›e_Àvñ
, 
›
,

28734 
DynBuf
 *
bc
, 
uöt8_t
 *
bc_buf
,

28735 
LabñSlŸ
 *
ls
, 
pos_√xt
, 
¨g_vÆid
)

28737 
idx
, 
v¨_idx
, 
is_put
;

28738 
œbñ_d⁄e
;

28739 
BOOL
 
is_func_v¨
 = 
FALSE
;

28740 
JSFun˘i⁄Def
 *
fd
;

28741 
JSV¨Def
 *
vd
;

28742 
BOOL
 
is_p£udo_v¨
;

28744 
œbñ_d⁄e
 = -1;

28748 
is_p£udo_v¨
 = (
v¨_«me
 =
JS_ATOM_home_obje˘
 ||

28749 
v¨_«me
 =
JS_ATOM_this_a˘ive_func
 ||

28750 
v¨_«me
 =
JS_ATOM_√w_èrgë
 ||

28751 
v¨_«me
 =
JS_ATOM_this
);

28754 
v¨_idx
 = -1;

28755 
idx
 = 
s
->
sc›es
[
sc›e_Àvñ
].
fú°
; idx >= 0;) {

28756 
vd
 = &
s
->
v¨s
[
idx
];

28757 i‡(
vd
->
v¨_«me
 == var_name) {

28758 i‡(
›
 =
OP_sc›e_put_v¨
 || o∞=
OP_sc›e_make_ªf
) {

28759 i‡(
vd
->
is_c⁄°
) {

28760 
	`dbuf_putc
(
bc
, 
OP_throw_v¨
);

28761 
	`dbuf_put_u32
(
bc
, 
	`JS_DupAtom
(
˘x
, 
v¨_«me
));

28762 
	`dbuf_putc
(
bc
, 
JS_THROW_VAR_RO
);

28763 
d⁄e
;

28765 
is_func_v¨
 = 
vd
->is_func_var;

28767 
v¨_idx
 = 
idx
;

28770 i‡(
vd
->
v¨_«me
 =
JS_ATOM__wôh_
 && !
is_p£udo_v¨
) {

28771 
	`dbuf_putc
(
bc
, 
OP_gë_loc
);

28772 
	`dbuf_put_u16
(
bc
, 
idx
);

28773 
	`dbuf_putc
(
bc
, 
	`gë_wôh_sc›e_›code
(
›
));

28774 
	`dbuf_put_u32
(
bc
, 
	`JS_DupAtom
(
˘x
, 
v¨_«me
));

28775 
œbñ_d⁄e
 = 
	`√w_œbñ_fd
(
s
,Üabel_done);

28776 
	`dbuf_put_u32
(
bc
, 
œbñ_d⁄e
);

28777 
	`dbuf_putc
(
bc
, 1);

28778 
	`upd©e_œbñ
(
s
, 
œbñ_d⁄e
, 1);

28779 
s
->
jump_size
++;

28781 
idx
 = 
vd
->
sc›e_√xt
;

28783 i‡(
v¨_idx
 < 0) {

28788 
v¨_idx
 = 
	`föd_v¨
(
˘x
, 
s
, 
v¨_«me
);

28789 i‡(
v¨_idx
 >= 0) {

28790 i‡(
sc›e_Àvñ
 == 0

28791 && (
v¨_idx
 & 
ARGUMENT_VAR_OFFSET
)

28792 && (
v¨_idx
 - 
ARGUMENT_VAR_OFFSET
Ë>
¨g_vÆid
) {

28794 
	`dbuf_putc
(
bc
, 
OP_throw_v¨
);

28795 
	`dbuf_put_u32
(
bc
, 
	`JS_DupAtom
(
˘x
, 
v¨_«me
));

28796 
	`dbuf_putc
(
bc
, 
JS_THROW_VAR_UNINITIALIZED
);

28798 i‡(!(
v¨_idx
 & 
ARGUMENT_VAR_OFFSET
))

28799 
is_func_v¨
 = 
s
->
v¨s
[
v¨_idx
].is_func_var;

28802 i‡(
v¨_idx
 < 0 && 
is_p£udo_v¨
)

28803 
v¨_idx
 = 
	`ªsﬁve_p£udo_v¨
(
˘x
, 
s
, 
v¨_«me
);

28805 i‡(
v¨_idx
 < 0 && 
v¨_«me
 =
JS_ATOM_¨gumíts
 &&

28806 
s
->
has_¨gumíts_bödög
) {

28808 
v¨_idx
 = 
	`add_¨gumíts_v¨
(
˘x
, 
s
, 
v¨_«me
);

28810 i‡(
v¨_idx
 < 0 && 
s
->
is_func_ex¥
 && 
v¨_«me
 =s->
func_«me
) {

28812 
v¨_idx
 = 
	`add_func_v¨
(
˘x
, 
s
, 
v¨_«me
);

28813 
is_func_v¨
 = 
TRUE
;

28816 i‡(
v¨_idx
 >= 0) {

28820 
›
) {

28821 
OP_sc›e_make_ªf
:

28822 i‡(
is_func_v¨
) {

28824 
	`dbuf_putc
(
bc
, 
OP_obje˘
);

28825 
	`dbuf_putc
(
bc
, 
OP_gë_loc
);

28826 
	`dbuf_put_u16
(
bc
, 
v¨_idx
);

28827 
	`dbuf_putc
(
bc
, 
OP_deföe_fõld
);

28828 
	`dbuf_put_u32
(
bc
, 
	`JS_DupAtom
(
˘x
, 
v¨_«me
));

28829 
	`dbuf_putc
(
bc
, 
OP_push_©om_vÆue
);

28830 
	`dbuf_put_u32
(
bc
, 
	`JS_DupAtom
(
˘x
, 
v¨_«me
));

28832 i‡(
œbñ_d⁄e
 =-1 && 
	`ˇn_›t_put_ªf_vÆue
(
bc_buf
, 
ls
->
pos
)) {

28833 
gë_›
;

28834 i‡(
v¨_idx
 & 
ARGUMENT_VAR_OFFSET
) {

28835 
gë_›
 = 
OP_gë_¨g
;

28836 
v¨_idx
 -
ARGUMENT_VAR_OFFSET
;

28838 i‡(
s
->
v¨s
[
v¨_idx
].
is_Àxiˇl
)

28839 
gë_›
 = 
OP_gë_loc_check
;

28841 
gë_›
 = 
OP_gë_loc
;

28843 
pos_√xt
 = 
	`›timize_sc›e_make_ªf
(
˘x
, 
s
, 
bc
, 
bc_buf
, 
ls
,

28844 
pos_√xt
, 
gë_›
, 
v¨_idx
);

28848 i‡(
v¨_idx
 & 
ARGUMENT_VAR_OFFSET
) {

28849 
	`dbuf_putc
(
bc
, 
OP_make_¨g_ªf
);

28850 
	`dbuf_put_u32
(
bc
, 
	`JS_DupAtom
(
˘x
, 
v¨_«me
));

28851 
	`dbuf_put_u16
(
bc
, 
v¨_idx
 - 
ARGUMENT_VAR_OFFSET
);

28853 
	`dbuf_putc
(
bc
, 
OP_make_loc_ªf
);

28854 
	`dbuf_put_u32
(
bc
, 
	`JS_DupAtom
(
˘x
, 
v¨_«me
));

28855 
	`dbuf_put_u16
(
bc
, 
v¨_idx
);

28859 
OP_sc›e_gë_ªf
:

28860 
	`dbuf_putc
(
bc
, 
OP_undeföed
);

28862 
OP_sc›e_gë_v¨_undef
:

28863 
OP_sc›e_gë_v¨
:

28864 
OP_sc›e_put_v¨
:

28865 
OP_sc›e_put_v¨_öô
:

28866 
is_put
 = (
›
 =
OP_sc›e_put_v¨
 || o∞=
OP_sc›e_put_v¨_öô
);

28867 i‡(
v¨_idx
 & 
ARGUMENT_VAR_OFFSET
) {

28868 
	`dbuf_putc
(
bc
, 
OP_gë_¨g
 + 
is_put
);

28869 
	`dbuf_put_u16
(
bc
, 
v¨_idx
 - 
ARGUMENT_VAR_OFFSET
);

28872 i‡(
is_put
) {

28873 i‡(
s
->
v¨s
[
v¨_idx
].
is_Àxiˇl
) {

28874 i‡(
›
 =
OP_sc›e_put_v¨_öô
) {

28876 i‡(
v¨_«me
 =
JS_ATOM_this
)

28877 
	`dbuf_putc
(
bc
, 
OP_put_loc_check_öô
);

28879 
	`dbuf_putc
(
bc
, 
OP_put_loc
);

28881 
	`dbuf_putc
(
bc
, 
OP_put_loc_check
);

28884 
	`dbuf_putc
(
bc
, 
OP_put_loc
);

28887 i‡(
s
->
v¨s
[
v¨_idx
].
is_Àxiˇl
) {

28888 
	`dbuf_putc
(
bc
, 
OP_gë_loc_check
);

28890 
	`dbuf_putc
(
bc
, 
OP_gë_loc
);

28893 
	`dbuf_put_u16
(
bc
, 
v¨_idx
);

28896 
OP_sc›e_dñëe_v¨
:

28897 
	`dbuf_putc
(
bc
, 
OP_push_Ál£
);

28900 
d⁄e
;

28903 i‡(
s
->
v¨_obje˘_idx
 >0 && !
is_p£udo_v¨
) {

28904 
	`dbuf_putc
(
bc
, 
OP_gë_loc
);

28905 
	`dbuf_put_u16
(
bc
, 
s
->
v¨_obje˘_idx
);

28906 
	`dbuf_putc
(
bc
, 
	`gë_wôh_sc›e_›code
(
›
));

28907 
	`dbuf_put_u32
(
bc
, 
	`JS_DupAtom
(
˘x
, 
v¨_«me
));

28908 
œbñ_d⁄e
 = 
	`√w_œbñ_fd
(
s
,Üabel_done);

28909 
	`dbuf_put_u32
(
bc
, 
œbñ_d⁄e
);

28910 
	`dbuf_putc
(
bc
, 0);

28911 
	`upd©e_œbñ
(
s
, 
œbñ_d⁄e
, 1);

28912 
s
->
jump_size
++;

28915 
fd
 = 
s
; fd->
∑ª¡
;) {

28916 
sc›e_Àvñ
 = 
fd
->
∑ª¡_sc›e_Àvñ
;

28917 
fd
 = fd->
∑ª¡
;

28918 i‡(
sc›e_Àvñ
 == 0) {

28924 
v¨_idx
 = 
	`föd_¨g
(
˘x
, 
fd
, 
v¨_«me
);

28925 
check_idx
;

28927 
idx
 = 
fd
->
sc›es
[
sc›e_Àvñ
].
fú°
; idx >= 0;) {

28928 
vd
 = &
fd
->
v¨s
[
idx
];

28929 i‡(
vd
->
v¨_«me
 == var_name) {

28930 i‡(
›
 =
OP_sc›e_put_v¨
 || o∞=
OP_sc›e_make_ªf
) {

28931 i‡(
vd
->
is_c⁄°
) {

28932 
	`dbuf_putc
(
bc
, 
OP_throw_v¨
);

28933 
	`dbuf_put_u32
(
bc
, 
	`JS_DupAtom
(
˘x
, 
v¨_«me
));

28934 
	`dbuf_putc
(
bc
, 
JS_THROW_VAR_RO
);

28935 
d⁄e
;

28937 
is_func_v¨
 = 
vd
->is_func_var;

28939 
v¨_idx
 = 
idx
;

28941 } i‡(
vd
->
v¨_«me
 =
JS_ATOM__wôh_
 && !
is_p£udo_v¨
) {

28942 
vd
->
is_ˇ±uªd
 = 1;

28943 
idx
 = 
	`gë_˛osuª_v¨
(
˘x
, 
s
, 
fd
, 
FALSE
, idx, 
vd
->
v¨_«me
, FALSE, FALSE, 
JS_VAR_NORMAL
);

28944 i‡(
idx
 >= 0) {

28945 
	`dbuf_putc
(
bc
, 
OP_gë_v¨_ªf
);

28946 
	`dbuf_put_u16
(
bc
, 
idx
);

28947 
	`dbuf_putc
(
bc
, 
	`gë_wôh_sc›e_›code
(
›
));

28948 
	`dbuf_put_u32
(
bc
, 
	`JS_DupAtom
(
˘x
, 
v¨_«me
));

28949 
œbñ_d⁄e
 = 
	`√w_œbñ_fd
(
s
,Üabel_done);

28950 
	`dbuf_put_u32
(
bc
, 
œbñ_d⁄e
);

28951 
	`dbuf_putc
(
bc
, 1);

28952 
	`upd©e_œbñ
(
s
, 
œbñ_d⁄e
, 1);

28953 
s
->
jump_size
++;

28956 
idx
 = 
vd
->
sc›e_√xt
;

28958 i‡(
v¨_idx
 >= 0)

28961 
v¨_idx
 = 
	`föd_v¨
(
˘x
, 
fd
, 
v¨_«me
);

28962 
check_idx
:

28963 i‡(
v¨_idx
 >= 0) {

28964 i‡(!(
v¨_idx
 & 
ARGUMENT_VAR_OFFSET
))

28965 
is_func_v¨
 = 
fd
->
v¨s
[
v¨_idx
].is_func_var;

28968 i‡(
is_p£udo_v¨
) {

28969 
v¨_idx
 = 
	`ªsﬁve_p£udo_v¨
(
˘x
, 
fd
, 
v¨_«me
);

28970 i‡(
v¨_idx
 >= 0)

28973 i‡(
v¨_«me
 =
JS_ATOM_¨gumíts
 && 
fd
->
has_¨gumíts_bödög
) {

28974 
v¨_idx
 = 
	`add_¨gumíts_v¨
(
˘x
, 
fd
, 
v¨_«me
);

28977 i‡(
fd
->
is_func_ex¥
 && fd->
func_«me
 =
v¨_«me
) {

28979 
v¨_idx
 = 
	`add_func_v¨
(
˘x
, 
fd
, 
v¨_«me
);

28980 
is_func_v¨
 = 
TRUE
;

28985 i‡(
fd
->
v¨_obje˘_idx
 >0 && !
is_p£udo_v¨
) {

28986 
fd
->
v¨s
[fd->
v¨_obje˘_idx
].
is_ˇ±uªd
 = 1;

28987 
idx
 = 
	`gë_˛osuª_v¨
(
˘x
, 
s
, 
fd
, 
FALSE
,

28988 
fd
->
v¨_obje˘_idx
, 
JS_ATOM__v¨_
,

28989 
FALSE
, FALSE, 
JS_VAR_NORMAL
);

28990 
	`dbuf_putc
(
bc
, 
OP_gë_v¨_ªf
);

28991 
	`dbuf_put_u16
(
bc
, 
idx
);

28992 
	`dbuf_putc
(
bc
, 
	`gë_wôh_sc›e_›code
(
›
));

28993 
	`dbuf_put_u32
(
bc
, 
	`JS_DupAtom
(
˘x
, 
v¨_«me
));

28994 
œbñ_d⁄e
 = 
	`√w_œbñ_fd
(
s
,Üabel_done);

28995 
	`dbuf_put_u32
(
bc
, 
œbñ_d⁄e
);

28996 
	`dbuf_putc
(
bc
, 0);

28997 
	`upd©e_œbñ
(
s
, 
œbñ_d⁄e
, 1);

28998 
s
->
jump_size
++;

29001 i‡(
fd
->
is_evÆ
)

29007 i‡(!
fd
)

29008 
fd
 = 
s
;

29009 i‡(
v¨_idx
 < 0 && 
fd
->
is_evÆ
) {

29010 
idx1
;

29011 
idx1
 = 0; idx1 < 
fd
->
˛osuª_v¨_cou¡
; idx1++) {

29012 
JSClosuªV¨
 *
cv
 = &
fd
->
˛osuª_v¨
[
idx1
];

29013 i‡(
v¨_«me
 =
cv
->var_name) {

29014 i‡(
fd
 !
s
) {

29015 
idx
 = 
	`gë_˛osuª_v¨2
(
˘x
, 
s
, 
fd
,

29016 
FALSE
,

29017 
cv
->
is_¨g
, 
idx1
,

29018 
cv
->
v¨_«me
, cv->
is_c⁄°
,

29019 
cv
->
is_Àxiˇl
, cv->
v¨_köd
);

29021 
idx
 = 
idx1
;

29023 
has_idx
;

29024 } i‡((
cv
->
v¨_«me
 =
JS_ATOM__v¨_
 ||

29025 
cv
->
v¨_«me
 =
JS_ATOM__wôh_
Ë&& !
is_p£udo_v¨
) {

29026 
is_wôh
 = (
cv
->
v¨_«me
 =
JS_ATOM__wôh_
);

29027 i‡(
fd
 !
s
) {

29028 
idx
 = 
	`gë_˛osuª_v¨2
(
˘x
, 
s
, 
fd
,

29029 
FALSE
,

29030 
cv
->
is_¨g
, 
idx1
,

29031 
cv
->
v¨_«me
, 
FALSE
, FALSE,

29032 
JS_VAR_NORMAL
);

29034 
idx
 = 
idx1
;

29036 
	`dbuf_putc
(
bc
, 
OP_gë_v¨_ªf
);

29037 
	`dbuf_put_u16
(
bc
, 
idx
);

29038 
	`dbuf_putc
(
bc
, 
	`gë_wôh_sc›e_›code
(
›
));

29039 
	`dbuf_put_u32
(
bc
, 
	`JS_DupAtom
(
˘x
, 
v¨_«me
));

29040 
œbñ_d⁄e
 = 
	`√w_œbñ_fd
(
s
,Üabel_done);

29041 
	`dbuf_put_u32
(
bc
, 
œbñ_d⁄e
);

29042 
	`dbuf_putc
(
bc
, 
is_wôh
);

29043 
	`upd©e_œbñ
(
s
, 
œbñ_d⁄e
, 1);

29044 
s
->
jump_size
++;

29049 i‡(
v¨_idx
 >= 0) {

29051 i‡(
v¨_idx
 & 
ARGUMENT_VAR_OFFSET
) {

29052 
fd
->
¨gs
[
v¨_idx
 - 
ARGUMENT_VAR_OFFSET
].
is_ˇ±uªd
 = 1;

29053 
idx
 = 
	`gë_˛osuª_v¨
(
˘x
, 
s
, 
fd
,

29054 
TRUE
, 
v¨_idx
 - 
ARGUMENT_VAR_OFFSET
,

29055 
v¨_«me
, 
FALSE
, FALSE, 
JS_VAR_NORMAL
);

29057 
fd
->
v¨s
[
v¨_idx
].
is_ˇ±uªd
 = 1;

29058 
idx
 = 
	`gë_˛osuª_v¨
(
˘x
, 
s
, 
fd
,

29059 
FALSE
, 
v¨_idx
,

29060 
v¨_«me
,

29061 
fd
->
v¨s
[
v¨_idx
].
is_c⁄°
,

29062 
fd
->
v¨s
[
v¨_idx
].
is_Àxiˇl
,

29063 
fd
->
v¨s
[
v¨_idx
].
v¨_köd
);

29065 i‡(
idx
 >= 0) {

29066 
has_idx
:

29067 i‡((
›
 =
OP_sc›e_put_v¨
 || o∞=
OP_sc›e_make_ªf
) &&

29068 
s
->
˛osuª_v¨
[
idx
].
is_c⁄°
) {

29069 
	`dbuf_putc
(
bc
, 
OP_throw_v¨
);

29070 
	`dbuf_put_u32
(
bc
, 
	`JS_DupAtom
(
˘x
, 
v¨_«me
));

29071 
	`dbuf_putc
(
bc
, 
JS_THROW_VAR_RO
);

29072 
d⁄e
;

29074 
›
) {

29075 
OP_sc›e_make_ªf
:

29076 i‡(
is_func_v¨
) {

29078 
	`dbuf_putc
(
bc
, 
OP_obje˘
);

29079 
	`dbuf_putc
(
bc
, 
OP_gë_v¨_ªf
);

29080 
	`dbuf_put_u16
(
bc
, 
idx
);

29081 
	`dbuf_putc
(
bc
, 
OP_deföe_fõld
);

29082 
	`dbuf_put_u32
(
bc
, 
	`JS_DupAtom
(
˘x
, 
v¨_«me
));

29083 
	`dbuf_putc
(
bc
, 
OP_push_©om_vÆue
);

29084 
	`dbuf_put_u32
(
bc
, 
	`JS_DupAtom
(
˘x
, 
v¨_«me
));

29086 i‡(
œbñ_d⁄e
 == -1 &&

29087 
	`ˇn_›t_put_ªf_vÆue
(
bc_buf
, 
ls
->
pos
)) {

29088 
gë_›
;

29089 i‡(
s
->
˛osuª_v¨
[
idx
].
is_Àxiˇl
)

29090 
gë_›
 = 
OP_gë_v¨_ªf_check
;

29092 
gë_›
 = 
OP_gë_v¨_ªf
;

29093 
pos_√xt
 = 
	`›timize_sc›e_make_ªf
(
˘x
, 
s
, 
bc
, 
bc_buf
, 
ls
,

29094 
pos_√xt
,

29095 
gë_›
, 
idx
);

29099 
	`dbuf_putc
(
bc
, 
OP_make_v¨_ªf_ªf
);

29100 
	`dbuf_put_u32
(
bc
, 
	`JS_DupAtom
(
˘x
, 
v¨_«me
));

29101 
	`dbuf_put_u16
(
bc
, 
idx
);

29104 
OP_sc›e_gë_ªf
:

29107 
	`dbuf_putc
(
bc
, 
OP_undeföed
);

29109 
OP_sc›e_gë_v¨_undef
:

29110 
OP_sc›e_gë_v¨
:

29111 
OP_sc›e_put_v¨
:

29112 
OP_sc›e_put_v¨_öô
:

29113 
is_put
 = (
›
 =
OP_sc›e_put_v¨
 ||

29114 
›
 =
OP_sc›e_put_v¨_öô
);

29115 i‡(
is_put
) {

29116 i‡(
s
->
˛osuª_v¨
[
idx
].
is_Àxiˇl
) {

29117 i‡(
›
 =
OP_sc›e_put_v¨_öô
) {

29119 i‡(
v¨_«me
 =
JS_ATOM_this
)

29120 
	`dbuf_putc
(
bc
, 
OP_put_v¨_ªf_check_öô
);

29122 
	`dbuf_putc
(
bc
, 
OP_put_v¨_ªf
);

29124 
	`dbuf_putc
(
bc
, 
OP_put_v¨_ªf_check
);

29127 
	`dbuf_putc
(
bc
, 
OP_put_v¨_ªf
);

29130 i‡(
s
->
˛osuª_v¨
[
idx
].
is_Àxiˇl
) {

29131 
	`dbuf_putc
(
bc
, 
OP_gë_v¨_ªf_check
);

29133 
	`dbuf_putc
(
bc
, 
OP_gë_v¨_ªf
);

29136 
	`dbuf_put_u16
(
bc
, 
idx
);

29138 
OP_sc›e_dñëe_v¨
:

29139 
	`dbuf_putc
(
bc
, 
OP_push_Ál£
);

29142 
d⁄e
;

29148 
›
) {

29149 
OP_sc›e_make_ªf
:

29150 i‡(
œbñ_d⁄e
 =-1 && 
	`ˇn_›t_put_globÆ_ªf_vÆue
(
bc_buf
, 
ls
->
pos
)) {

29151 
pos_√xt
 = 
	`›timize_sc›e_make_globÆ_ªf
(
˘x
, 
s
, 
bc
, 
bc_buf
, 
ls
,

29152 
pos_√xt
, 
v¨_«me
);

29154 
	`dbuf_putc
(
bc
, 
OP_make_v¨_ªf
);

29155 
	`dbuf_put_u32
(
bc
, 
	`JS_DupAtom
(
˘x
, 
v¨_«me
));

29158 
OP_sc›e_gë_ªf
:

29161 
	`dbuf_putc
(
bc
, 
OP_undeföed
);

29162 
	`dbuf_putc
(
bc
, 
OP_gë_v¨
);

29163 
	`dbuf_put_u32
(
bc
, 
	`JS_DupAtom
(
˘x
, 
v¨_«me
));

29165 
OP_sc›e_gë_v¨_undef
:

29166 
OP_sc›e_gë_v¨
:

29167 
OP_sc›e_put_v¨
:

29168 
	`dbuf_putc
(
bc
, 
OP_gë_v¨_undef
 + (
›
 - 
OP_sc›e_gë_v¨_undef
));

29169 
	`dbuf_put_u32
(
bc
, 
	`JS_DupAtom
(
˘x
, 
v¨_«me
));

29171 
OP_sc›e_put_v¨_öô
:

29172 
	`dbuf_putc
(
bc
, 
OP_put_v¨_öô
);

29173 
	`dbuf_put_u32
(
bc
, 
	`JS_DupAtom
(
˘x
, 
v¨_«me
));

29175 
OP_sc›e_dñëe_v¨
:

29176 
	`dbuf_putc
(
bc
, 
OP_dñëe_v¨
);

29177 
	`dbuf_put_u32
(
bc
, 
	`JS_DupAtom
(
˘x
, 
v¨_«me
));

29180 
d⁄e
:

29181 i‡(
œbñ_d⁄e
 >= 0) {

29182 
	`dbuf_putc
(
bc
, 
OP_œbñ
);

29183 
	`dbuf_put_u32
(
bc
, 
œbñ_d⁄e
);

29184 
s
->
œbñ_¶Ÿs
[
œbñ_d⁄e
].
pos2
 = 
bc
->
size
;

29186  
pos_√xt
;

29187 
	}
}

29190 
	$föd_¥iv©e_˛ass_fõld_Æl
(
JSC⁄ãxt
 *
˘x
, 
JSFun˘i⁄Def
 *
fd
,

29191 
JSAtom
 
«me
, 
sc›e_Àvñ
)

29193 
idx
;

29195 
idx
 = 
fd
->
sc›es
[
sc›e_Àvñ
].
fú°
;

29196 
idx
 >= 0) {

29197 i‡(
fd
->
v¨s
[
idx
].
v¨_«me
 =
«me
)

29198  
idx
;

29199 
idx
 = 
fd
->
v¨s
[idx].
sc›e_√xt
;

29202 
	}
}

29204 
	$gë_loc_‹_ªf
(
DynBuf
 *
bc
, 
BOOL
 
is_ªf
, 
idx
)

29208 i‡(
is_ªf
)

29209 
	`dbuf_putc
(
bc
, 
OP_gë_v¨_ªf
);

29211 
	`dbuf_putc
(
bc
, 
OP_gë_loc
);

29212 
	`dbuf_put_u16
(
bc
, 
idx
);

29213 
	}
}

29215 
	$ªsﬁve_sc›e_¥iv©e_fõld1
(
JSC⁄ãxt
 *
˘x
,

29216 
BOOL
 *
pis_ªf
, *
pv¨_köd
,

29217 
JSFun˘i⁄Def
 *
s
,

29218 
JSAtom
 
v¨_«me
, 
sc›e_Àvñ
)

29220 
idx
, 
v¨_köd
;

29221 
JSFun˘i⁄Def
 *
fd
;

29222 
BOOL
 
is_ªf
;

29224 
fd
 = 
s
;

29225 
is_ªf
 = 
FALSE
;

29227 
idx
 = 
	`föd_¥iv©e_˛ass_fõld_Æl
(
˘x
, 
fd
, 
v¨_«me
, 
sc›e_Àvñ
);

29228 i‡(
idx
 >= 0) {

29229 
v¨_köd
 = 
fd
->
v¨s
[
idx
].var_kind;

29230 i‡(
is_ªf
) {

29231 
idx
 = 
	`gë_˛osuª_v¨
(
˘x
, 
s
, 
fd
, 
FALSE
, idx, 
v¨_«me
,

29232 
TRUE
, TRUE, 
JS_VAR_NORMAL
);

29233 i‡(
idx
 < 0)

29238 
sc›e_Àvñ
 = 
fd
->
∑ª¡_sc›e_Àvñ
;

29239 i‡(!
fd
->
∑ª¡
) {

29240 
buf
[
ATOM_GET_STR_BUF_SIZE
];

29242 i‡(
fd
->
is_evÆ
) {

29244 
idx
 = 0; idx < 
fd
->
˛osuª_v¨_cou¡
; idx++) {

29245 
JSClosuªV¨
 *
cv
 = &
fd
->
˛osuª_v¨
[
idx
];

29246 i‡(
cv
->
v¨_«me
 == var_name) {

29247 
v¨_köd
 = 
cv
->var_kind;

29248 
is_ªf
 = 
TRUE
;

29249 i‡(
fd
 !
s
) {

29250 
idx
 = 
	`gë_˛osuª_v¨2
(
˘x
, 
s
, 
fd
,

29251 
FALSE
,

29252 
cv
->
is_¨g
, 
idx
,

29253 
cv
->
v¨_«me
, cv->
is_c⁄°
,

29254 
cv
->
is_Àxiˇl
,

29255 
cv
->
v¨_köd
);

29256 i‡(
idx
 < 0)

29259 
d⁄e
;

29264 
	`JS_ThrowSy¡axEº‹
(
˘x
, "undefinedÖrivate field %s",

29265 
	`JS_AtomGëSå
(
˘x
, 
buf
, (buf), 
v¨_«me
));

29268 
fd
 = fd->
∑ª¡
;

29270 
is_ªf
 = 
TRUE
;

29272 
d⁄e
:

29273 *
pis_ªf
 = 
is_ªf
;

29274 *
pv¨_köd
 = 
v¨_köd
;

29275  
idx
;

29276 
	}
}

29279 
	$ªsﬁve_sc›e_¥iv©e_fõld
(
JSC⁄ãxt
 *
˘x
, 
JSFun˘i⁄Def
 *
s
,

29280 
JSAtom
 
v¨_«me
, 
sc›e_Àvñ
, 
›
,

29281 
DynBuf
 *
bc
)

29283 
idx
, 
v¨_köd
;

29284 
BOOL
 
is_ªf
;

29286 
idx
 = 
	`ªsﬁve_sc›e_¥iv©e_fõld1
(
˘x
, &
is_ªf
, &
v¨_köd
, 
s
,

29287 
v¨_«me
, 
sc›e_Àvñ
);

29288 i‡(
idx
 < 0)

29290 
	`as£π
(
v¨_köd
 !
JS_VAR_NORMAL
);

29291 
›
) {

29292 
OP_sc›e_gë_¥iv©e_fõld
:

29293 
OP_sc›e_gë_¥iv©e_fõld2
:

29294 
v¨_köd
) {

29295 
JS_VAR_PRIVATE_FIELD
:

29296 i‡(
›
 =
OP_sc›e_gë_¥iv©e_fõld2
)

29297 
	`dbuf_putc
(
bc
, 
OP_dup
);

29298 
	`gë_loc_‹_ªf
(
bc
, 
is_ªf
, 
idx
);

29299 
	`dbuf_putc
(
bc
, 
OP_gë_¥iv©e_fõld
);

29301 
JS_VAR_PRIVATE_METHOD
:

29302 
	`gë_loc_‹_ªf
(
bc
, 
is_ªf
, 
idx
);

29303 
	`dbuf_putc
(
bc
, 
OP_check_bønd
);

29304 i‡(
›
 !
OP_sc›e_gë_¥iv©e_fõld2
)

29305 
	`dbuf_putc
(
bc
, 
OP_nù
);

29307 
JS_VAR_PRIVATE_GETTER
:

29308 
JS_VAR_PRIVATE_GETTER_SETTER
:

29309 i‡(
›
 =
OP_sc›e_gë_¥iv©e_fõld2
)

29310 
	`dbuf_putc
(
bc
, 
OP_dup
);

29311 
	`gë_loc_‹_ªf
(
bc
, 
is_ªf
, 
idx
);

29312 
	`dbuf_putc
(
bc
, 
OP_check_bønd
);

29313 
	`dbuf_putc
(
bc
, 
OP_ˇŒ_mëhod
);

29314 
	`dbuf_put_u16
(
bc
, 0);

29316 
JS_VAR_PRIVATE_SETTER
:

29318 
	`dbuf_putc
(
bc
, 
OP_throw_v¨
);

29319 
	`dbuf_put_u32
(
bc
, 
	`JS_DupAtom
(
˘x
, 
v¨_«me
));

29320 
	`dbuf_putc
(
bc
, 
JS_THROW_VAR_RO
);

29323 
	`ab‹t
();

29326 
OP_sc›e_put_¥iv©e_fõld
:

29327 
v¨_köd
) {

29328 
JS_VAR_PRIVATE_FIELD
:

29329 
	`gë_loc_‹_ªf
(
bc
, 
is_ªf
, 
idx
);

29330 
	`dbuf_putc
(
bc
, 
OP_put_¥iv©e_fõld
);

29332 
JS_VAR_PRIVATE_METHOD
:

29333 
JS_VAR_PRIVATE_GETTER
:

29335 
	`dbuf_putc
(
bc
, 
OP_throw_v¨
);

29336 
	`dbuf_put_u32
(
bc
, 
	`JS_DupAtom
(
˘x
, 
v¨_«me
));

29337 
	`dbuf_putc
(
bc
, 
JS_THROW_VAR_RO
);

29339 
JS_VAR_PRIVATE_SETTER
:

29340 
JS_VAR_PRIVATE_GETTER_SETTER
:

29342 
JSAtom
 
£âî_«me
 = 
	`gë_¥iv©e_£âî_«me
(
˘x
, 
v¨_«me
);

29343 i‡(
£âî_«me
 =
JS_ATOM_NULL
)

29345 
idx
 = 
	`ªsﬁve_sc›e_¥iv©e_fõld1
(
˘x
, &
is_ªf
,

29346 &
v¨_köd
, 
s
,

29347 
£âî_«me
, 
sc›e_Àvñ
);

29348 
	`JS_FªeAtom
(
˘x
, 
£âî_«me
);

29349 i‡(
idx
 < 0)

29351 
	`as£π
(
v¨_köd
 =
JS_VAR_PRIVATE_SETTER
);

29352 
	`gë_loc_‹_ªf
(
bc
, 
is_ªf
, 
idx
);

29353 
	`dbuf_putc
(
bc
, 
OP_sw≠
);

29355 
	`dbuf_putc
(
bc
, 
OP_rŸ3r
);

29357 
	`dbuf_putc
(
bc
, 
OP_check_bønd
);

29358 
	`dbuf_putc
(
bc
, 
OP_rŸ3l
);

29360 
	`dbuf_putc
(
bc
, 
OP_ˇŒ_mëhod
);

29361 
	`dbuf_put_u16
(
bc
, 1);

29365 
	`ab‹t
();

29369 
	`ab‹t
();

29372 
	}
}

29374 
	$m¨k_evÆ_ˇ±uªd_v¨übÀs
(
JSC⁄ãxt
 *
˘x
, 
JSFun˘i⁄Def
 *
s
,

29375 
sc›e_Àvñ
)

29377 
idx
;

29378 
JSV¨Def
 *
vd
;

29380 
idx
 = 
s
->
sc›es
[
sc›e_Àvñ
].
fú°
; idx >= 0;) {

29381 
vd
 = &
s
->
v¨s
[
idx
];

29382 
vd
->
is_ˇ±uªd
 = 1;

29383 
idx
 = 
vd
->
sc›e_√xt
;

29385 
	}
}

29387 
	$add_evÆ_v¨übÀs
(
JSC⁄ãxt
 *
˘x
, 
JSFun˘i⁄Def
 *
s
)

29389 
JSFun˘i⁄Def
 *
fd
;

29390 
JSV¨Def
 *
vd
;

29391 
i
, 
sc›e_Àvñ
, 
sc›e_idx
;

29392 
BOOL
 
has_¨gumíts_bödög
, 
has_this_bödög
;

29396 i‡(!
s
->
is_evÆ
 && !(s->
js_mode
 & 
JS_MODE_STRICT
)) {

29397 
s
->
v¨_obje˘_idx
 = 
	`add_v¨
(
˘x
, s, 
JS_ATOM__v¨_
);

29401 
has_this_bödög
 = 
s
->has_this_binding;

29402 i‡(
has_this_bödög
) {

29403 i‡(
s
->
this_v¨_idx
 < 0)

29404 
s
->
this_v¨_idx
 = 
	`add_v¨_this
(
˘x
, s);

29405 i‡(
s
->
√w_èrgë_v¨_idx
 < 0)

29406 
s
->
√w_èrgë_v¨_idx
 = 
	`add_v¨
(
˘x
, s, 
JS_ATOM_√w_èrgë
);

29407 i‡(
s
->
is_dîived_˛ass_c⁄°ru˘‹
 && s->
this_a˘ive_func_v¨_idx
 < 0)

29408 
s
->
this_a˘ive_func_v¨_idx
 = 
	`add_v¨
(
˘x
, s, 
JS_ATOM_this_a˘ive_func
);

29409 i‡(
s
->
has_home_obje˘
 && s->
home_obje˘_v¨_idx
 < 0)

29410 
s
->
home_obje˘_v¨_idx
 = 
	`add_v¨
(
˘x
, s, 
JS_ATOM_home_obje˘
);

29412 
has_¨gumíts_bödög
 = 
s
->has_arguments_binding;

29413 i‡(
has_¨gumíts_bödög
)

29414 
	`add_¨gumíts_v¨
(
˘x
, 
s
, 
JS_ATOM_¨gumíts
);

29415 i‡(
s
->
is_func_ex¥
 && s->
func_«me
 !
JS_ATOM_NULL
)

29416 
	`add_func_v¨
(
˘x
, 
s
, s->
func_«me
);

29422 
	`as£π
(
s
->
is_evÆ
 || s->
˛osuª_v¨_cou¡
 == 0);

29425 
fd
 = 
s
;

29427 
sc›e_Àvñ
 = 
fd
->
∑ª¡_sc›e_Àvñ
;

29428 
fd
 = fd->
∑ª¡
;

29429 i‡(!
fd
)

29431 
sc›e_idx
 = 
fd
->
sc›es
[
sc›e_Àvñ
].
fú°
;

29433 i‡(!
has_this_bödög
 && 
fd
->has_this_binding) {

29434 i‡(
fd
->
this_v¨_idx
 < 0)

29435 
fd
->
this_v¨_idx
 = 
	`add_v¨_this
(
˘x
, fd);

29436 i‡(
fd
->
√w_èrgë_v¨_idx
 < 0)

29437 
fd
->
√w_èrgë_v¨_idx
 = 
	`add_v¨
(
˘x
, fd, 
JS_ATOM_√w_èrgë
);

29438 i‡(
fd
->
is_dîived_˛ass_c⁄°ru˘‹
 && fd->
this_a˘ive_func_v¨_idx
 < 0)

29439 
fd
->
this_a˘ive_func_v¨_idx
 = 
	`add_v¨
(
˘x
, fd, 
JS_ATOM_this_a˘ive_func
);

29440 i‡(
fd
->
has_home_obje˘
 && fd->
home_obje˘_v¨_idx
 < 0)

29441 
fd
->
home_obje˘_v¨_idx
 = 
	`add_v¨
(
˘x
, fd, 
JS_ATOM_home_obje˘
);

29442 
has_this_bödög
 = 
TRUE
;

29445 i‡(!
has_¨gumíts_bödög
 && 
fd
->has_arguments_binding) {

29446 
	`add_¨gumíts_v¨
(
˘x
, 
fd
, 
JS_ATOM_¨gumíts
);

29447 
has_¨gumíts_bödög
 = 
TRUE
;

29450 i‡(
fd
->
is_func_ex¥
 && fd->
func_«me
 !
JS_ATOM_NULL
)

29451 
	`add_func_v¨
(
˘x
, 
fd
, fd->
func_«me
);

29454 
sc›e_idx
 >= 0) {

29455 
vd
 = &
fd
->
v¨s
[
sc›e_idx
];

29456 
vd
->
is_ˇ±uªd
 = 1;

29457 
	`gë_˛osuª_v¨
(
˘x
, 
s
, 
fd
, 
FALSE
, 
sc›e_idx
,

29458 
vd
->
v¨_«me
, vd->
is_c⁄°
, vd->
is_Àxiˇl
, vd->
v¨_köd
);

29459 
sc›e_idx
 = 
vd
->
sc›e_√xt
;

29462 
i
 = 0; i < 
fd
->
¨g_cou¡
; i++) {

29463 
vd
 = &
fd
->
¨gs
[
i
];

29464 i‡(
vd
->
v¨_«me
 !
JS_ATOM_NULL
) {

29465 
	`gë_˛osuª_v¨
(
˘x
, 
s
, 
fd
,

29466 
TRUE
, 
i
, 
vd
->
v¨_«me
, 
FALSE
, FALSE,

29467 
JS_VAR_NORMAL
);

29470 
i
 = 0; i < 
fd
->
v¨_cou¡
; i++) {

29471 
vd
 = &
fd
->
v¨s
[
i
];

29473 i‡(
vd
->
sc›e_Àvñ
 == 0 &&

29474 
vd
->
v¨_«me
 !
JS_ATOM__ªt_
 &&

29475 
vd
->
v¨_«me
 !
JS_ATOM_NULL
) {

29476 
	`gë_˛osuª_v¨
(
˘x
, 
s
, 
fd
,

29477 
FALSE
, 
i
, 
vd
->
v¨_«me
, FALSE, FALSE,

29478 
JS_VAR_NORMAL
);

29481 i‡(
fd
->
is_evÆ
) {

29482 
idx
;

29485 
idx
 = 0; idx < 
fd
->
˛osuª_v¨_cou¡
; idx++) {

29486 
JSClosuªV¨
 *
cv
 = &
fd
->
˛osuª_v¨
[
idx
];

29487 
	`gë_˛osuª_v¨2
(
˘x
, 
s
, 
fd
,

29488 
FALSE
, 
cv
->
is_¨g
,

29489 
idx
, 
cv
->
v¨_«me
, cv->
is_c⁄°
,

29490 
cv
->
is_Àxiˇl
, cv->
v¨_köd
);

29494 
	}
}

29498 
__ex˚±i⁄
 
	$add_˛osuª_v¨übÀs
(
JSC⁄ãxt
 *
˘x
, 
JSFun˘i⁄Def
 *
s
,

29499 
JSFun˘i⁄Byãcode
 *
b
, 
sc›e_idx
)

29501 
i
, 
cou¡
;

29502 
JSV¨Def
 *
vd
;

29504 
cou¡
 = 
b
->
¨g_cou¡
 + b->
v¨_cou¡
 + b->
˛osuª_v¨_cou¡
;

29505 
s
->
˛osuª_v¨
 = 
NULL
;

29506 
s
->
˛osuª_v¨_cou¡
 = 0;

29507 
s
->
˛osuª_v¨_size
 = 
cou¡
;

29508 i‡(
cou¡
 == 0)

29510 
s
->
˛osuª_v¨
 = 
	`js_mÆloc
(
˘x
, (s->˛osuª_v¨[0]Ë* 
cou¡
);

29511 i‡(!
s
->
˛osuª_v¨
)

29514 
i
 = 
sc›e_idx
; i >= 0;) {

29515 
vd
 = &
b
->
v¨defs
[b->
¨g_cou¡
 + 
i
];

29516 i‡(
vd
->
sc›e_Àvñ
 > 0) {

29517 
JSClosuªV¨
 *
cv
 = &
s
->
˛osuª_v¨
[s->
˛osuª_v¨_cou¡
++];

29518 
cv
->
is_loˇl
 = 
TRUE
;

29519 
cv
->
is_¨g
 = 
FALSE
;

29520 
cv
->
is_c⁄°
 = 
vd
->is_const;

29521 
cv
->
is_Àxiˇl
 = 
vd
->is_lexical;

29522 
cv
->
v¨_köd
 = 
vd
->var_kind;

29523 
cv
->
v¨_idx
 = 
i
;

29524 
cv
->
v¨_«me
 = 
	`JS_DupAtom
(
˘x
, 
vd
->var_name);

29526 
i
 = 
vd
->
sc›e_√xt
;

29529 
i
 = 0; i < 
b
->
¨g_cou¡
; i++) {

29530 
JSClosuªV¨
 *
cv
 = &
s
->
˛osuª_v¨
[s->
˛osuª_v¨_cou¡
++];

29531 
vd
 = &
b
->
v¨defs
[
i
];

29532 
cv
->
is_loˇl
 = 
TRUE
;

29533 
cv
->
is_¨g
 = 
TRUE
;

29534 
cv
->
is_c⁄°
 = 
FALSE
;

29535 
cv
->
is_Àxiˇl
 = 
FALSE
;

29536 
cv
->
v¨_köd
 = 
JS_VAR_NORMAL
;

29537 
cv
->
v¨_idx
 = 
i
;

29538 
cv
->
v¨_«me
 = 
	`JS_DupAtom
(
˘x
, 
vd
->var_name);

29541 
i
 = 0; i < 
b
->
v¨_cou¡
; i++) {

29542 
vd
 = &
b
->
v¨defs
[b->
¨g_cou¡
 + 
i
];

29543 i‡(
vd
->
sc›e_Àvñ
 =0 && vd->
v¨_«me
 !
JS_ATOM__ªt_
) {

29544 
JSClosuªV¨
 *
cv
 = &
s
->
˛osuª_v¨
[s->
˛osuª_v¨_cou¡
++];

29545 
cv
->
is_loˇl
 = 
TRUE
;

29546 
cv
->
is_¨g
 = 
FALSE
;

29547 
cv
->
is_c⁄°
 = 
FALSE
;

29548 
cv
->
is_Àxiˇl
 = 
FALSE
;

29549 
cv
->
v¨_köd
 = 
JS_VAR_NORMAL
;

29550 
cv
->
v¨_idx
 = 
i
;

29551 
cv
->
v¨_«me
 = 
	`JS_DupAtom
(
˘x
, 
vd
->var_name);

29554 
i
 = 0; i < 
b
->
˛osuª_v¨_cou¡
; i++) {

29555 
JSClosuªV¨
 *
cv0
 = &
b
->
˛osuª_v¨
[
i
];

29556 
JSClosuªV¨
 *
cv
 = &
s
->
˛osuª_v¨
[s->
˛osuª_v¨_cou¡
++];

29557 
cv
->
is_loˇl
 = 
FALSE
;

29558 
cv
->
is_¨g
 = 
cv0
->is_arg;

29559 
cv
->
is_c⁄°
 = 
cv0
->is_const;

29560 
cv
->
is_Àxiˇl
 = 
cv0
->is_lexical;

29561 
cv
->
v¨_köd
 = 
cv0
->var_kind;

29562 
cv
->
v¨_idx
 = 
i
;

29563 
cv
->
v¨_«me
 = 
	`JS_DupAtom
(
˘x
, 
cv0
->var_name);

29566 
	}
}

29568 
	sCodeC⁄ãxt
 {

29569 c⁄° 
uöt8_t
 *
	mbc_buf
;

29570 
	mbc_Àn
;

29571 
	mpos
;

29572 
	mlöe_num
;

29573 
	m›
;

29574 
	midx
;

29575 
	mœbñ
;

29576 
	mvÆ
;

29577 
JSAtom
 
	m©om
;

29578 } 
	tCodeC⁄ãxt
;

29580 
	#M2
(
›1
, 
›2
Ë((›1Ë| ((›2Ë<< 8))

	)

29581 
	#M3
(
›1
, 
›2
, 
›3
Ë((›1Ë| ((›2Ë<< 8Ë| ((›3Ë<< 16))

	)

29582 
	#M4
(
›1
, 
›2
, 
›3
, 
›4
Ë((›1Ë| ((›2Ë<< 8Ë| ((›3Ë<< 16Ë| ((›4Ë<< 24))

	)

29584 
BOOL
 
	$code_m©ch
(
CodeC⁄ãxt
 *
s
, 
pos
, ...)

29586 c⁄° 
uöt8_t
 *
èb
 = 
s
->
bc_buf
;

29587 
›
, 
Àn
, 
›1
, 
löe_num
, 
pos_√xt
;

29588 
va_li°
 
≠
;

29589 
BOOL
 
ªt
 = 
FALSE
;

29591 
löe_num
 = -1;

29592 
	`va_°¨t
(
≠
, 
pos
);

29595 
›1
 = 
	`va_¨g
(
≠
, );

29596 i‡(
›1
 == -1) {

29597 
s
->
pos
 =Öos;

29598 
s
->
löe_num
 =Üine_num;

29599 
ªt
 = 
TRUE
;

29603 i‡(
pos
 >
s
->
bc_Àn
)

29604 
d⁄e
;

29605 
›
 = 
èb
[
pos
];

29606 
Àn
 = 
›code_öfo
[
›
].
size
;

29607 
pos_√xt
 = 
pos
 + 
Àn
;

29608 i‡(
pos_√xt
 > 
s
->
bc_Àn
)

29609 
d⁄e
;

29610 i‡(
›
 =
OP_löe_num
) {

29611 
löe_num
 = 
	`gë_u32
(
èb
 + 
pos
 + 1);

29612 
pos
 = 
pos_√xt
;

29617 i‡(
›
 !
›1
) {

29618 i‡(
›1
 =(
uöt8_t
)›1 || !
›
)

29620 i‡(
›
 !(
uöt8_t
)
›1


29621 && 
›
 !(
uöt8_t
)(
›1
 >> 8)

29622 && 
›
 !(
uöt8_t
)(
›1
 >> 16)

29623 && 
›
 !(
uöt8_t
)(
›1
 >> 24)) {

29626 
s
->
›
 = op;

29629 
pos
++;

29630 
›code_öfo
[
›
].
fmt
) {

29631 
OP_FMT_loc8
:

29632 
OP_FMT_u8
:

29634 
idx
 = 
èb
[
pos
];

29635 
¨g
 = 
	`va_¨g
(
≠
, );

29636 i‡(
¨g
 == -1) {

29637 
s
->
idx
 = idx;

29639 i‡(
¨g
 !
idx
)

29640 
d⁄e
;

29644 
OP_FMT_u16
:

29645 
OP_FMT_≈›
:

29646 
OP_FMT_loc
:

29647 
OP_FMT_¨g
:

29648 
OP_FMT_v¨_ªf
:

29650 
idx
 = 
	`gë_u16
(
èb
 + 
pos
);

29651 
¨g
 = 
	`va_¨g
(
≠
, );

29652 i‡(
¨g
 == -1) {

29653 
s
->
idx
 = idx;

29655 i‡(
¨g
 !
idx
)

29656 
d⁄e
;

29660 
OP_FMT_i32
:

29661 
OP_FMT_u32
:

29662 
OP_FMT_œbñ
:

29663 
OP_FMT_c⁄°
:

29665 
s
->
œbñ
 = 
	`gë_u32
(
èb
 + 
pos
);

29668 
OP_FMT_œbñ_u16
:

29670 
s
->
œbñ
 = 
	`gë_u32
(
èb
 + 
pos
);

29671 
s
->
vÆ
 = 
	`gë_u16
(
èb
 + 
pos
 + 4);

29674 
OP_FMT_©om
:

29676 
s
->
©om
 = 
	`gë_u32
(
èb
 + 
pos
);

29679 
OP_FMT_©om_u8
:

29681 
s
->
©om
 = 
	`gë_u32
(
èb
 + 
pos
);

29682 
s
->
vÆ
 = 
	`gë_u8
(
èb
 + 
pos
 + 4);

29685 
OP_FMT_©om_u16
:

29687 
s
->
©om
 = 
	`gë_u32
(
èb
 + 
pos
);

29688 
s
->
vÆ
 = 
	`gë_u16
(
èb
 + 
pos
 + 4);

29691 
OP_FMT_©om_œbñ_u8
:

29693 
s
->
©om
 = 
	`gë_u32
(
èb
 + 
pos
);

29694 
s
->
œbñ
 = 
	`gë_u32
(
èb
 + 
pos
 + 4);

29695 
s
->
vÆ
 = 
	`gë_u8
(
èb
 + 
pos
 + 8);

29701 
pos
 = 
pos_√xt
;

29703 
d⁄e
:

29704 
	`va_íd
(
≠
);

29705  
ªt
;

29706 
	}
}

29708 
	$ö°™tüã_hoi°ed_deföôi⁄s
(
JSC⁄ãxt
 *
˘x
, 
JSFun˘i⁄Def
 *
s
, 
DynBuf
 *
bc
)

29710 
i
, 
idx
, 
v¨_idx
;

29713 
i
 = 0; i < 
s
->
hoi°ed_def_cou¡
; i++) {

29714 
JSHoi°edDef
 *
hf
 = &
s
->
hoi°ed_def
[
i
];

29715 
has_˛osuª
 = 0;

29716 
BOOL
 
f‹˚_öô
 = 
hf
->force_init;

29717 i‡(
s
->
is_globÆ_v¨
 && 
hf
->
v¨_«me
 !
JS_ATOM_NULL
) {

29722 
idx
 = 0; idx < 
s
->
˛osuª_v¨_cou¡
; idx++) {

29723 
JSClosuªV¨
 *
cv
 = &
s
->
˛osuª_v¨
[
idx
];

29724 i‡(
cv
->
v¨_«me
 =
hf
->var_name) {

29725 
has_˛osuª
 = 2;

29726 
f‹˚_öô
 = 
FALSE
;

29729 i‡(
cv
->
v¨_«me
 =
JS_ATOM__v¨_
) {

29730 
	`dbuf_putc
(
bc
, 
OP_gë_v¨_ªf
);

29731 
	`dbuf_put_u16
(
bc
, 
idx
);

29732 
has_˛osuª
 = 1;

29733 
f‹˚_öô
 = 
TRUE
;

29737 i‡(!
has_˛osuª
) {

29738 
Êags
;

29740 
Êags
 = 0;

29741 i‡(
s
->
evÆ_ty≥
 !
JS_EVAL_TYPE_GLOBAL
)

29742 
Êags
 |
JS_PROP_CONFIGURABLE
;

29743 i‡(
hf
->
˝oﬁ_idx
 >0 && !hf->
is_Àxiˇl
) {

29745 
	`dbuf_putc
(
bc
, 
OP_f˛osuª
);

29746 
	`dbuf_put_u32
(
bc
, 
hf
->
˝oﬁ_idx
);

29748 
	`dbuf_putc
(
bc
, 
OP_deföe_func
);

29749 
	`dbuf_put_u32
(
bc
, 
	`JS_DupAtom
(
˘x
, 
hf
->
v¨_«me
));

29750 
	`dbuf_putc
(
bc
, 
Êags
);

29752 
d⁄e_hoi°ed_def
;

29754 i‡(
hf
->
is_Àxiˇl
) {

29755 
Êags
 |
DEFINE_GLOBAL_LEX_VAR
;

29756 i‡(!
hf
->
is_c⁄°
)

29757 
Êags
 |
JS_PROP_WRITABLE
;

29759 
	`dbuf_putc
(
bc
, 
OP_deföe_v¨
);

29760 
	`dbuf_put_u32
(
bc
, 
	`JS_DupAtom
(
˘x
, 
hf
->
v¨_«me
));

29761 
	`dbuf_putc
(
bc
, 
Êags
);

29765 i‡(
hf
->
˝oﬁ_idx
 >0 || 
f‹˚_öô
) {

29766 i‡(
hf
->
˝oﬁ_idx
 >= 0) {

29767 
	`dbuf_putc
(
bc
, 
OP_f˛osuª
);

29768 
	`dbuf_put_u32
(
bc
, 
hf
->
˝oﬁ_idx
);

29769 i‡(
hf
->
v¨_«me
 =
JS_ATOM__deÁu…_
) {

29771 
	`dbuf_putc
(
bc
, 
OP_£t_«me
);

29772 
	`dbuf_put_u32
(
bc
, 
	`JS_DupAtom
(
˘x
, 
JS_ATOM_deÁu…
));

29775 
	`dbuf_putc
(
bc
, 
OP_undeföed
);

29777 i‡(
s
->
is_globÆ_v¨
) {

29778 i‡(
has_˛osuª
 == 2) {

29779 
	`dbuf_putc
(
bc
, 
OP_put_v¨_ªf
);

29780 
	`dbuf_put_u16
(
bc
, 
idx
);

29781 } i‡(
has_˛osuª
 == 1) {

29782 
	`dbuf_putc
(
bc
, 
OP_deföe_fõld
);

29783 
	`dbuf_put_u32
(
bc
, 
	`JS_DupAtom
(
˘x
, 
hf
->
v¨_«me
));

29784 
	`dbuf_putc
(
bc
, 
OP_dr›
);

29787 
	`dbuf_putc
(
bc
, 
OP_put_v¨
);

29788 
	`dbuf_put_u32
(
bc
, 
	`JS_DupAtom
(
˘x
, 
hf
->
v¨_«me
));

29791 
v¨_idx
 = 
hf
->var_idx;

29792 i‡(
v¨_idx
 & 
ARGUMENT_VAR_OFFSET
) {

29793 
	`dbuf_putc
(
bc
, 
OP_put_¨g
);

29794 
	`dbuf_put_u16
(
bc
, 
v¨_idx
 - 
ARGUMENT_VAR_OFFSET
);

29796 
	`dbuf_putc
(
bc
, 
OP_put_loc
);

29797 
	`dbuf_put_u16
(
bc
, 
v¨_idx
);

29801 
d⁄e_hoi°ed_def
:

29802 
	`JS_FªeAtom
(
˘x
, 
hf
->
v¨_«me
);

29804 
	`js_‰ì
(
˘x
, 
s
->
hoi°ed_def
);

29805 
s
->
hoi°ed_def
 = 
NULL
;

29806 
s
->
hoi°ed_def_cou¡
 = 0;

29807 
s
->
hoi°ed_def_size
 = 0;

29808 
	}
}

29810 
	$skù_dód_code
(
JSFun˘i⁄Def
 *
s
, c⁄° 
uöt8_t
 *
bc_buf
, 
bc_Àn
,

29811 
pos
, *
löï
)

29813 
›
, 
Àn
, 
œbñ
;

29815 ; 
pos
 < 
bc_Àn
;Öo†+
Àn
) {

29816 
›
 = 
bc_buf
[
pos
];

29817 
Àn
 = 
›code_öfo
[
›
].
size
;

29818 i‡(
›
 =
OP_löe_num
) {

29819 *
löï
 = 
	`gë_u32
(
bc_buf
 + 
pos
 + 1);

29821 i‡(
›
 =
OP_œbñ
) {

29822 
œbñ
 = 
	`gë_u32
(
bc_buf
 + 
pos
 + 1);

29823 i‡(
	`upd©e_œbñ
(
s
, 
œbñ
, 0) > 0)

29826 i‡(
s
->
œbñ_¶Ÿs
[
œbñ
].
fú°_ªloc
) {

29827 
	`¥ötf
("line %d: unreferencedÜabel %d:%d hasÑelocations\n",

29828 *
löï
, 
œbñ
, 
s
->
œbñ_¶Ÿs
[œbñ].
pos2
);

29831 
	`as£π
(
s
->
œbñ_¶Ÿs
[
œbñ
].
fú°_ªloc
 =
NULL
);

29834 
JSAtom
 
©om
;

29835 
›code_öfo
[
›
].
fmt
) {

29836 
OP_FMT_œbñ
:

29837 
OP_FMT_œbñ_u16
:

29838 
œbñ
 = 
	`gë_u32
(
bc_buf
 + 
pos
 + 1);

29839 
	`upd©e_œbñ
(
s
, 
œbñ
, -1);

29841 
OP_FMT_©om_œbñ_u8
:

29842 
OP_FMT_©om_œbñ_u16
:

29843 
œbñ
 = 
	`gë_u32
(
bc_buf
 + 
pos
 + 5);

29844 
	`upd©e_œbñ
(
s
, 
œbñ
, -1);

29846 
OP_FMT_©om
:

29847 
OP_FMT_©om_u8
:

29848 
OP_FMT_©om_u16
:

29849 
©om
 = 
	`gë_u32
(
bc_buf
 + 
pos
 + 1);

29850 
	`JS_FªeAtom
(
s
->
˘x
, 
©om
);

29857  
pos
;

29858 
	}
}

29860 
	$gë_œbñ_pos
(
JSFun˘i⁄Def
 *
s
, 
œbñ
)

29862 
i
, 
pos
;

29863 
i
 = 0; i < 20; i++) {

29864 
pos
 = 
s
->
œbñ_¶Ÿs
[
œbñ
].pos;

29866 
s
->
byã_code
.
buf
[
pos
]) {

29867 
OP_löe_num
:

29868 
OP_œbñ
:

29869 
pos
 += 5;

29871 
OP_gŸo
:

29872 
œbñ
 = 
	`gë_u32
(
s
->
byã_code
.
buf
 + 
pos
 + 1);

29875  
pos
;

29880  
pos
;

29881 
	}
}

29885 
__ex˚±i⁄
 
	$ªsﬁve_v¨übÀs
(
JSC⁄ãxt
 *
˘x
, 
JSFun˘i⁄Def
 *
s
)

29887 
pos
, 
pos_√xt
, 
bc_Àn
, 
›
, 
Àn
, 
i
, 
idx
, 
¨g_vÆid
, 
löe_num
;

29888 
uöt8_t
 *
bc_buf
;

29889 
JSAtom
 
v¨_«me
;

29890 
DynBuf
 
bc_out
;

29891 
CodeC⁄ãxt
 
cc
;

29892 
sc›e
;

29894 
cc
.
bc_buf
 = bc_bu‡
s
->
byã_code
.
buf
;

29895 
cc
.
bc_Àn
 = bc_À¿
s
->
byã_code
.
size
;

29896 
	`js_dbuf_öô
(
˘x
, &
bc_out
);

29900 i‡(
s
->
is_globÆ_v¨
) {

29901 
i
 = 0; i < 
s
->
hoi°ed_def_cou¡
; i++) {

29902 
JSHoi°edDef
 *
hf
 = &
s
->
hoi°ed_def
[
i
];

29903 
Êags
;

29905 i‡(
hf
->
v¨_«me
 !
JS_ATOM_NULL
) {

29907 
idx
 = 0; idx < 
s
->
˛osuª_v¨_cou¡
; idx++) {

29908 
JSClosuªV¨
 *
cv
 = &
s
->
˛osuª_v¨
[
idx
];

29909 i‡(
cv
->
v¨_«me
 =
hf
->var_name) {

29910 i‡(
s
->
evÆ_ty≥
 =
JS_EVAL_TYPE_DIRECT
 &&

29911 
cv
->
is_Àxiˇl
) {

29917 
	`dbuf_putc
(&
bc_out
, 
OP_throw_v¨
);

29918 
	`dbuf_put_u32
(&
bc_out
, 
	`JS_DupAtom
(
˘x
, 
hf
->
v¨_«me
));

29919 
	`dbuf_putc
(&
bc_out
, 
JS_THROW_VAR_REDECL
);

29921 
√xt
;

29923 i‡(
cv
->
v¨_«me
 =
JS_ATOM__v¨_
)

29924 
√xt
;

29927 
	`dbuf_putc
(&
bc_out
, 
OP_check_deföe_v¨
);

29928 
	`dbuf_put_u32
(&
bc_out
, 
	`JS_DupAtom
(
˘x
, 
hf
->
v¨_«me
));

29929 
Êags
 = 0;

29930 i‡(
hf
->
is_Àxiˇl
)

29931 
Êags
 |
DEFINE_GLOBAL_LEX_VAR
;

29932 i‡(
hf
->
˝oﬁ_idx
 >= 0)

29933 
Êags
 |
DEFINE_GLOBAL_FUNC_VAR
;

29934 
	`dbuf_putc
(&
bc_out
, 
Êags
);

29936 
√xt
: ;

29940 
¨g_vÆid
 = 0;

29941 
löe_num
 = 0;

29942 
pos
 = 0;Öo†< 
bc_Àn
;Öo†
pos_√xt
) {

29943 
›
 = 
bc_buf
[
pos
];

29944 
Àn
 = 
›code_öfo
[
›
].
size
;

29945 
pos_√xt
 = 
pos
 + 
Àn
;

29946 
›
) {

29947 
OP_löe_num
:

29948 
löe_num
 = 
	`gë_u32
(
bc_buf
 + 
pos
 + 1);

29949 
s
->
löe_numbî_size
++;

29950 
no_ch™ge
;

29952 
OP_£t_¨g_vÆid_u±o
:

29953 
¨g_vÆid
 = 
	`gë_u16
(
bc_buf
 + 
pos
 + 1);

29955 
OP_evÆ
:

29957 
ˇŒ_¨gc
 = 
	`gë_u16
(
bc_buf
 + 
pos
 + 1);

29958 
sc›e
 = 
	`gë_u16
(
bc_buf
 + 
pos
 + 1 + 2);

29959 
	`m¨k_evÆ_ˇ±uªd_v¨übÀs
(
˘x
, 
s
, 
sc›e
);

29960 
	`dbuf_putc
(&
bc_out
, 
›
);

29961 
	`dbuf_put_u16
(&
bc_out
, 
ˇŒ_¨gc
);

29962 
	`dbuf_put_u16
(&
bc_out
, 
s
->
sc›es
[
sc›e
].
fú°
 + 1);

29965 
OP_≠∂y_evÆ
:

29966 
sc›e
 = 
	`gë_u16
(
bc_buf
 + 
pos
 + 1);

29967 
	`m¨k_evÆ_ˇ±uªd_v¨übÀs
(
˘x
, 
s
, 
sc›e
);

29968 
	`dbuf_putc
(&
bc_out
, 
›
);

29969 
	`dbuf_put_u16
(&
bc_out
, 
s
->
sc›es
[
sc›e
].
fú°
 + 1);

29971 
OP_sc›e_gë_v¨_undef
:

29972 
OP_sc›e_gë_v¨
:

29973 
OP_sc›e_put_v¨
:

29974 
OP_sc›e_dñëe_v¨
:

29975 
OP_sc›e_gë_ªf
:

29976 
OP_sc›e_put_v¨_öô
:

29977 
v¨_«me
 = 
	`gë_u32
(
bc_buf
 + 
pos
 + 1);

29978 
sc›e
 = 
	`gë_u16
(
bc_buf
 + 
pos
 + 5);

29979 
pos_√xt
 = 
	`ªsﬁve_sc›e_v¨
(
˘x
, 
s
, 
v¨_«me
, 
sc›e
, 
›
, &
bc_out
,

29980 
NULL
, NULL, 
pos_√xt
, 
¨g_vÆid
);

29981 
	`JS_FªeAtom
(
˘x
, 
v¨_«me
);

29983 
OP_sc›e_make_ªf
:

29985 
œbñ
;

29986 
LabñSlŸ
 *
ls
;

29987 
v¨_«me
 = 
	`gë_u32
(
bc_buf
 + 
pos
 + 1);

29988 
œbñ
 = 
	`gë_u32
(
bc_buf
 + 
pos
 + 5);

29989 
sc›e
 = 
	`gë_u16
(
bc_buf
 + 
pos
 + 9);

29990 
ls
 = &
s
->
œbñ_¶Ÿs
[
œbñ
];

29991 
ls
->
ªf_cou¡
--;

29992 
pos_√xt
 = 
	`ªsﬁve_sc›e_v¨
(
˘x
, 
s
, 
v¨_«me
, 
sc›e
, 
›
, &
bc_out
,

29993 
bc_buf
, 
ls
, 
pos_√xt
, 
¨g_vÆid
);

29994 
	`JS_FªeAtom
(
˘x
, 
v¨_«me
);

29997 
OP_sc›e_gë_¥iv©e_fõld
:

29998 
OP_sc›e_gë_¥iv©e_fõld2
:

29999 
OP_sc›e_put_¥iv©e_fõld
:

30001 
ªt
;

30002 
v¨_«me
 = 
	`gë_u32
(
bc_buf
 + 
pos
 + 1);

30003 
sc›e
 = 
	`gë_u16
(
bc_buf
 + 
pos
 + 5);

30004 
ªt
 = 
	`ªsﬁve_sc›e_¥iv©e_fõld
(
˘x
, 
s
, 
v¨_«me
, 
sc›e
, 
›
, &
bc_out
);

30005 i‡(
ªt
 < 0)

30006 
Áû
;

30007 
	`JS_FªeAtom
(
˘x
, 
v¨_«me
);

30010 
OP_gosub
:

30011 
s
->
jump_size
++;

30012 i‡(
OPTIMIZE
) {

30014 
œbñ
;

30015 
LabñSlŸ
 *
ls
;

30017 
œbñ
 = 
	`gë_u32
(
bc_buf
 + 
pos
 + 1);

30018 
	`as£π
(
œbñ
 >0 &&Üabñ < 
s
->
œbñ_cou¡
);

30019 
ls
 = &
s
->
œbñ_¶Ÿs
[
œbñ
];

30020 i‡(
	`code_m©ch
(&
cc
, 
ls
->
pos
, 
OP_ªt
, -1)) {

30021 
ls
->
ªf_cou¡
--;

30025 
no_ch™ge
;

30026 
OP_dr›
:

30031 
pos1
 = 
pos_√xt
;

30032 
löe1
 = 
löe_num
;

30033 
	`code_m©ch
(&
cc
, 
pos1
, 
OP_dr›
, -1)) {

30034 i‡(
cc
.
löe_num
 >0Ë
löe1
 = cc.line_num;

30035 
pos1
 = 
cc
.
pos
;

30037 i‡(
	`code_m©ch
(&
cc
, 
pos1
, 
OP_ªtu∫_undef
, -1)) {

30038 
pos_√xt
 = 
pos1
;

30039 i‡(
löe1
 !-1 &&Üöe1 !
löe_num
) {

30040 
löe_num
 = 
löe1
;

30041 
s
->
löe_numbî_size
++;

30042 
	`dbuf_putc
(&
bc_out
, 
OP_löe_num
);

30043 
	`dbuf_put_u32
(&
bc_out
, 
löe_num
);

30048 
no_ch™ge
;

30049 
OP_ö£π3
:

30050 i‡(
OPTIMIZE
) {

30052 i‡(
	`code_m©ch
(&
cc
, 
pos_√xt
, 
	`M2
(
OP_put_¨øy_ñ
, 
OP_put_ªf_vÆue
), 
OP_dr›
, -1)) {

30053 
	`dbuf_putc
(&
bc_out
, 
cc
.
›
);

30054 
pos_√xt
 = 
cc
.
pos
;

30055 i‡(
cc
.
löe_num
 != -1 && cc.line_num !=Üine_num) {

30056 
löe_num
 = 
cc
.line_num;

30057 
s
->
löe_numbî_size
++;

30058 
	`dbuf_putc
(&
bc_out
, 
OP_löe_num
);

30059 
	`dbuf_put_u32
(&
bc_out
, 
löe_num
);

30064 
no_ch™ge
;

30066 
OP_gŸo
:

30067 
s
->
jump_size
++;

30069 
OP_èû_ˇŒ
:

30070 
OP_èû_ˇŒ_mëhod
:

30071 
OP_ªtu∫
:

30072 
OP_ªtu∫_undef
:

30073 
OP_throw
:

30074 
OP_throw_v¨
:

30075 
OP_ªt
:

30076 i‡(
OPTIMIZE
) {

30078 
löe
 = -1;

30079 
	`dbuf_put
(&
bc_out
, 
bc_buf
 + 
pos
, 
Àn
);

30080 
pos
 = 
	`skù_dód_code
(
s
, 
bc_buf
, 
bc_Àn
,Öo†+ 
Àn
, &
löe
);

30081 
pos_√xt
 = 
pos
;

30082 i‡(
pos
 < 
bc_Àn
 && 
löe
 >0 && 
löe_num
 !=Üine) {

30083 
löe_num
 = 
löe
;

30084 
s
->
löe_numbî_size
++;

30085 
	`dbuf_putc
(&
bc_out
, 
OP_löe_num
);

30086 
	`dbuf_put_u32
(&
bc_out
, 
löe_num
);

30090 
no_ch™ge
;

30092 
OP_œbñ
:

30094 
œbñ
;

30095 
LabñSlŸ
 *
ls
;

30097 
œbñ
 = 
	`gë_u32
(
bc_buf
 + 
pos
 + 1);

30098 
	`as£π
(
œbñ
 >0 &&Üabñ < 
s
->
œbñ_cou¡
);

30099 
ls
 = &
s
->
œbñ_¶Ÿs
[
œbñ
];

30100 
ls
->
pos2
 = 
bc_out
.
size
 + 
›code_öfo
[
›
].size;

30102 
no_ch™ge
;

30104 
OP_íãr_sc›e
:

30106 
sc›e_idx
, 
sc›e
 = 
	`gë_u16
(
bc_buf
 + 
pos
 + 1);

30108 i‡(
sc›e
 == 1) {

30109 
	`ö°™tüã_hoi°ed_deföôi⁄s
(
˘x
, 
s
, &
bc_out
);

30112 
sc›e_idx
 = 
s
->
sc›es
[
sc›e
].
fú°
; scope_idx >= 0;) {

30113 
JSV¨Def
 *
vd
 = &
s
->
v¨s
[
sc›e_idx
];

30114 i‡(
vd
->
sc›e_Àvñ
 =
sc›e
) {

30115 i‡(
vd
->
v¨_köd
 =
JS_VAR_FUNCTION_DECL
 ||

30116 
vd
->
v¨_köd
 =
JS_VAR_NEW_FUNCTION_DECL
) {

30118 
	`dbuf_putc
(&
bc_out
, 
OP_f˛osuª
);

30119 
	`dbuf_put_u32
(&
bc_out
, 
vd
->
func_poﬁ_‹_sc›e_idx
);

30120 
	`dbuf_putc
(&
bc_out
, 
OP_put_loc
);

30121 
	`dbuf_put_u16
(&
bc_out
, 
sc›e_idx
);

30125 
	`dbuf_putc
(&
bc_out
, 
OP_£t_loc_unöôülized
);

30126 
	`dbuf_put_u16
(&
bc_out
, 
sc›e_idx
);

30128 
sc›e_idx
 = 
vd
->
sc›e_√xt
;

30136 
OP_Àave_sc›e
:

30138 
sc›e_idx
, 
sc›e
 = 
	`gë_u16
(
bc_buf
 + 
pos
 + 1);

30140 
sc›e_idx
 = 
s
->
sc›es
[
sc›e
].
fú°
; scope_idx >= 0;) {

30141 
JSV¨Def
 *
vd
 = &
s
->
v¨s
[
sc›e_idx
];

30142 i‡(
vd
->
sc›e_Àvñ
 =
sc›e
) {

30143 i‡(
vd
->
is_ˇ±uªd
) {

30144 
	`dbuf_putc
(&
bc_out
, 
OP_˛o£_loc
);

30145 
	`dbuf_put_u16
(&
bc_out
, 
sc›e_idx
);

30147 
sc›e_idx
 = 
vd
->
sc›e_√xt
;

30155 
OP_£t_«me
:

30158 
JSAtom
 
«me
 = 
	`gë_u32
(
bc_buf
 + 
pos
 + 1);

30159 i‡(
«me
 =
JS_ATOM_NULL
)

30162 
no_ch™ge
;

30164 
OP_if_Ál£
:

30165 
OP_if_åue
:

30166 
OP_ˇtch
:

30167 
s
->
jump_size
++;

30168 
no_ch™ge
;

30170 
OP_dup
:

30171 i‡(
OPTIMIZE
) {

30174 i‡(
	`code_m©ch
(&
cc
, 
pos_√xt
, 
	`M2
(
OP_if_Ál£
, 
OP_if_åue
), 
OP_dr›
, -1)) {

30175 
œb0
, 
œb1
, 
›1
, 
pos1
, 
löe1
, 
pos2
;

30176 
œb0
 = 
œb1
 = 
cc
.
œbñ
;

30177 
	`as£π
(
œb1
 >0 &&Üab1 < 
s
->
œbñ_cou¡
);

30178 
›1
 = 
cc
.
›
;

30179 
pos1
 = 
cc
.
pos
;

30180 
löe1
 = 
cc
.
löe_num
;

30181 
	`code_m©ch
(&
cc
, (
pos2
 = 
	`gë_œbñ_pos
(
s
, 
œb1
)), 
OP_dup
, 
›1
, 
OP_dr›
, -1)) {

30182 
œb1
 = 
cc
.
œbñ
;

30184 i‡(
	`code_m©ch
(&
cc
, 
pos2
, 
›1
, -1)) {

30185 
s
->
jump_size
++;

30186 
	`upd©e_œbñ
(
s
, 
œb0
, -1);

30187 
	`upd©e_œbñ
(
s
, 
cc
.
œbñ
, +1);

30188 
	`dbuf_putc
(&
bc_out
, 
›1
);

30189 
	`dbuf_put_u32
(&
bc_out
, 
cc
.
œbñ
);

30190 
pos_√xt
 = 
pos1
;

30191 i‡(
löe1
 !-1 &&Üöe1 !
löe_num
) {

30192 
löe_num
 = 
löe1
;

30193 
s
->
löe_numbî_size
++;

30194 
	`dbuf_putc
(&
bc_out
, 
OP_löe_num
);

30195 
	`dbuf_put_u32
(&
bc_out
, 
löe_num
);

30201 
no_ch™ge
;

30203 
OP_n›
:

30206 
OP_£t_˛ass_«me
:

30211 
no_ch™ge
:

30212 
	`dbuf_put
(&
bc_out
, 
bc_buf
 + 
pos
, 
Àn
);

30218 
	`dbuf_‰ì
(&
s
->
byã_code
);

30219 
s
->
byã_code
 = 
bc_out
;

30220 i‡(
	`dbuf_îr‹
(&
s
->
byã_code
)) {

30221 
	`JS_ThrowOutOfMem‹y
(
˘x
);

30225 
Áû
:

30228 ; 
pos
 < 
bc_Àn
;Öo†
pos_√xt
) {

30229 
›
 = 
bc_buf
[
pos
];

30230 
Àn
 = 
›code_öfo
[
›
].
size
;

30231 
pos_√xt
 = 
pos
 + 
Àn
;

30232 
	`dbuf_put
(&
bc_out
, 
bc_buf
 + 
pos
, 
Àn
);

30234 
	`dbuf_‰ì
(&
s
->
byã_code
);

30235 
s
->
byã_code
 = 
bc_out
;

30237 
	}
}

30240 
	$add_pc2löe_öfo
(
JSFun˘i⁄Def
 *
s
, 
uöt32_t
 
pc
, 
löe_num
)

30242 i‡(
s
->
löe_numbî_¶Ÿs
 !
NULL


30243 && 
s
->
löe_numbî_cou¡
 < s->
löe_numbî_size


30244 && 
pc
 >
s
->
löe_numbî_œ°_pc


30245 && 
löe_num
 !
s
->
löe_numbî_œ°
) {

30246 
s
->
löe_numbî_¶Ÿs
[s->
löe_numbî_cou¡
].
pc
 =Öc;

30247 
s
->
löe_numbî_¶Ÿs
[s->
löe_numbî_cou¡
].
löe_num
 =Üine_num;

30248 
s
->
löe_numbî_cou¡
++;

30249 
s
->
löe_numbî_œ°_pc
 = 
pc
;

30250 
s
->
löe_numbî_œ°
 = 
löe_num
;

30252 
	}
}

30254 
	$compuã_pc2löe_öfo
(
JSFun˘i⁄Def
 *
s
)

30256 i‡(!(
s
->
js_mode
 & 
JS_MODE_STRIP
Ë&& s->
löe_numbî_¶Ÿs
) {

30257 
œ°_löe_num
 = 
s
->
löe_num
;

30258 
uöt32_t
 
œ°_pc
 = 0;

30259 
i
;

30261 
	`js_dbuf_öô
(
s
->
˘x
, &s->
pc2löe
);

30262 
i
 = 0; i < 
s
->
löe_numbî_cou¡
; i++) {

30263 
uöt32_t
 
pc
 = 
s
->
löe_numbî_¶Ÿs
[
i
].pc;

30264 
löe_num
 = 
s
->
löe_numbî_¶Ÿs
[
i
].line_num;

30265 
diff_pc
, 
diff_löe
;

30267 i‡(
löe_num
 < 0)

30270 
diff_pc
 = 
pc
 - 
œ°_pc
;

30271 
diff_löe
 = 
löe_num
 - 
œ°_löe_num
;

30272 i‡(
diff_löe
 =0 || 
diff_pc
 < 0)

30275 i‡(
diff_löe
 >
PC2LINE_BASE
 &&

30276 
diff_löe
 < 
PC2LINE_BASE
 + 
PC2LINE_RANGE
 &&

30277 
diff_pc
 <
PC2LINE_DIFF_PC_MAX
) {

30278 
	`dbuf_putc
(&
s
->
pc2löe
, (
diff_löe
 - 
PC2LINE_BASE
) +

30279 
diff_pc
 * 
PC2LINE_RANGE
 + 
PC2LINE_OP_FIRST
);

30282 
	`dbuf_putc
(&
s
->
pc2löe
, 0);

30283 
	`dbuf_put_Àb128
(&
s
->
pc2löe
, 
diff_pc
);

30284 
	`dbuf_put_¶eb128
(&
s
->
pc2löe
, 
diff_löe
);

30286 
œ°_pc
 = 
pc
;

30287 
œ°_löe_num
 = 
löe_num
;

30290 
	}
}

30292 
RñocE¡ry
 *
	$add_ªloc
(
JSC⁄ãxt
 *
˘x
, 
LabñSlŸ
 *
ls
, 
uöt32_t
 
addr
, 
size
)

30294 
RñocE¡ry
 *
ª
;

30295 
ª
 = 
	`js_mÆloc
(
˘x
, (*re));

30296 i‡(!
ª
)

30297  
NULL
;

30298 
ª
->
addr
 =áddr;

30299 
ª
->
size
 = size;

30300 
ª
->
√xt
 = 
ls
->
fú°_ªloc
;

30301 
ls
->
fú°_ªloc
 = 
ª
;

30302  
ª
;

30303 
	}
}

30305 
BOOL
 
	$code_has_œbñ
(
CodeC⁄ãxt
 *
s
, 
pos
, 
œbñ
)

30307 
pos
 < 
s
->
bc_Àn
) {

30308 
›
 = 
s
->
bc_buf
[
pos
];

30309 i‡(
›
 =
OP_löe_num
) {

30310 
pos
 += 5;

30313 i‡(
›
 =
OP_œbñ
) {

30314 
œb
 = 
	`gë_u32
(
s
->
bc_buf
 + 
pos
 + 1);

30315 i‡(
œb
 =
œbñ
)

30316  
TRUE
;

30317 
pos
 += 5;

30320 i‡(
›
 =
OP_gŸo
) {

30321 
œb
 = 
	`gë_u32
(
s
->
bc_buf
 + 
pos
 + 1);

30322 i‡(
œb
 =
œbñ
)

30323  
TRUE
;

30327  
FALSE
;

30328 
	}
}

30333 
	$föd_jump_èrgë
(
JSFun˘i⁄Def
 *
s
, 
œbñ
, *
p›
, *
∂öe
)

30335 
i
, 
pos
, 
›
;

30337 
	`upd©e_œbñ
(
s
, 
œbñ
, -1);

30338 
i
 = 0; i < 10; i++) {

30339 
	`as£π
(
œbñ
 >0 &&Üabñ < 
s
->
œbñ_cou¡
);

30340 
pos
 = 
s
->
œbñ_¶Ÿs
[
œbñ
].
pos2
;

30342 
›
 = 
s
->
byã_code
.
buf
[
pos
]) {

30343 
OP_löe_num
:

30344 i‡(
∂öe
)

30345 *
∂öe
 = 
	`gë_u32
(
s
->
byã_code
.
buf
 + 
pos
 + 1);

30347 
OP_œbñ
:

30348 
pos
 +
›code_öfo
[
›
].
size
;

30350 
OP_gŸo
:

30351 
œbñ
 = 
	`gë_u32
(
s
->
byã_code
.
buf
 + 
pos
 + 1);

30353 
OP_dr›
:

30355 
s
->
byã_code
.
buf
[++
pos
] =
OP_dr›
)

30357 i‡(
s
->
byã_code
.
buf
[
pos
] =
OP_ªtu∫_undef
)

30358 
›
 = 
OP_ªtu∫_undef
;

30361 
d⁄e
;

30367 
d⁄e
:

30368 *
p›
 = 
›
;

30369 
	`upd©e_œbñ
(
s
, 
œbñ
, +1);

30370  
œbñ
;

30371 
	}
}

30373 
	$push_sh‹t_öt
(
DynBuf
 *
bc_out
, 
vÆ
)

30375 #i‡
SHORT_OPCODES


30376 i‡(
vÆ
 >= -1 && val <= 7) {

30377 
	`dbuf_putc
(
bc_out
, 
OP_push_0
 + 
vÆ
);

30380 i‡(
vÆ
 =(
öt8_t
)val) {

30381 
	`dbuf_putc
(
bc_out
, 
OP_push_i8
);

30382 
	`dbuf_putc
(
bc_out
, 
vÆ
);

30385 i‡(
vÆ
 =(
öt16_t
)val) {

30386 
	`dbuf_putc
(
bc_out
, 
OP_push_i16
);

30387 
	`dbuf_put_u16
(
bc_out
, 
vÆ
);

30391 
	`dbuf_putc
(
bc_out
, 
OP_push_i32
);

30392 
	`dbuf_put_u32
(
bc_out
, 
vÆ
);

30393 
	}
}

30395 
	$put_sh‹t_code
(
DynBuf
 *
bc_out
, 
›
, 
idx
)

30397 #i‡
SHORT_OPCODES


30398 i‡(
idx
 < 4) {

30399 
›
) {

30400 
OP_gë_loc
:

30401 
	`dbuf_putc
(
bc_out
, 
OP_gë_loc0
 + 
idx
);

30403 
OP_put_loc
:

30404 
	`dbuf_putc
(
bc_out
, 
OP_put_loc0
 + 
idx
);

30406 
OP_£t_loc
:

30407 
	`dbuf_putc
(
bc_out
, 
OP_£t_loc0
 + 
idx
);

30409 
OP_gë_¨g
:

30410 
	`dbuf_putc
(
bc_out
, 
OP_gë_¨g0
 + 
idx
);

30412 
OP_put_¨g
:

30413 
	`dbuf_putc
(
bc_out
, 
OP_put_¨g0
 + 
idx
);

30415 
OP_£t_¨g
:

30416 
	`dbuf_putc
(
bc_out
, 
OP_£t_¨g0
 + 
idx
);

30418 
OP_gë_v¨_ªf
:

30419 
	`dbuf_putc
(
bc_out
, 
OP_gë_v¨_ªf0
 + 
idx
);

30421 
OP_put_v¨_ªf
:

30422 
	`dbuf_putc
(
bc_out
, 
OP_put_v¨_ªf0
 + 
idx
);

30424 
OP_£t_v¨_ªf
:

30425 
	`dbuf_putc
(
bc_out
, 
OP_£t_v¨_ªf0
 + 
idx
);

30427 
OP_ˇŒ
:

30428 
	`dbuf_putc
(
bc_out
, 
OP_ˇŒ0
 + 
idx
);

30432 i‡(
idx
 < 256) {

30433 
›
) {

30434 
OP_gë_loc
:

30435 
	`dbuf_putc
(
bc_out
, 
OP_gë_loc8
);

30436 
	`dbuf_putc
(
bc_out
, 
idx
);

30438 
OP_put_loc
:

30439 
	`dbuf_putc
(
bc_out
, 
OP_put_loc8
);

30440 
	`dbuf_putc
(
bc_out
, 
idx
);

30442 
OP_£t_loc
:

30443 
	`dbuf_putc
(
bc_out
, 
OP_£t_loc8
);

30444 
	`dbuf_putc
(
bc_out
, 
idx
);

30449 
	`dbuf_putc
(
bc_out
, 
›
);

30450 
	`dbuf_put_u16
(
bc_out
, 
idx
);

30451 
	}
}

30454 
__ex˚±i⁄
 
	$ªsﬁve_œbñs
(
JSC⁄ãxt
 *
˘x
, 
JSFun˘i⁄Def
 *
s
)

30456 
pos
, 
pos_√xt
, 
bc_Àn
, 
›
, 
›1
, 
Àn
, 
i
, 
löe_num
;

30457 c⁄° 
uöt8_t
 *
bc_buf
;

30458 
DynBuf
 
bc_out
;

30459 
LabñSlŸ
 *
œbñ_¶Ÿs
, *
ls
;

30460 
RñocE¡ry
 *
ª
, *
ª_√xt
;

30461 
CodeC⁄ãxt
 
cc
;

30462 
œbñ
;

30463 #i‡
SHORT_OPCODES


30464 
JumpSlŸ
 *
jp
;

30467 
œbñ_¶Ÿs
 = 
s
->label_slots;

30469 
löe_num
 = 
s
->line_num;

30471 
cc
.
bc_buf
 = bc_bu‡
s
->
byã_code
.
buf
;

30472 
cc
.
bc_Àn
 = bc_À¿
s
->
byã_code
.
size
;

30473 
	`js_dbuf_öô
(
˘x
, &
bc_out
);

30475 #i‡
SHORT_OPCODES


30476 i‡(
s
->
jump_size
) {

30477 
s
->
jump_¶Ÿs
 = 
	`js_mÆlocz
(s->
˘x
, (*s->jump_¶ŸsË* s->
jump_size
);

30478 i‡(
s
->
jump_¶Ÿs
 =
NULL
)

30483 i‡(
s
->
löe_numbî_size
 && !(s->
js_mode
 & 
JS_MODE_STRIP
)) {

30484 
s
->
löe_numbî_¶Ÿs
 = 
	`js_mÆlocz
(s->
˘x
, (*s->löe_numbî_¶ŸsË* s->
löe_numbî_size
);

30485 i‡(
s
->
löe_numbî_¶Ÿs
 =
NULL
)

30487 
s
->
löe_numbî_œ°
 = s->
löe_num
;

30488 
s
->
löe_numbî_œ°_pc
 = 0;

30492 i‡(
s
->
home_obje˘_v¨_idx
 >= 0) {

30493 
	`dbuf_putc
(&
bc_out
, 
OP_•ecül_obje˘
);

30494 
	`dbuf_putc
(&
bc_out
, 
OP_SPECIAL_OBJECT_HOME_OBJECT
);

30495 
	`put_sh‹t_code
(&
bc_out
, 
OP_put_loc
, 
s
->
home_obje˘_v¨_idx
);

30498 i‡(
s
->
this_a˘ive_func_v¨_idx
 >= 0) {

30499 
	`dbuf_putc
(&
bc_out
, 
OP_•ecül_obje˘
);

30500 
	`dbuf_putc
(&
bc_out
, 
OP_SPECIAL_OBJECT_THIS_FUNC
);

30501 
	`put_sh‹t_code
(&
bc_out
, 
OP_put_loc
, 
s
->
this_a˘ive_func_v¨_idx
);

30504 i‡(
s
->
√w_èrgë_v¨_idx
 >= 0) {

30505 
	`dbuf_putc
(&
bc_out
, 
OP_•ecül_obje˘
);

30506 
	`dbuf_putc
(&
bc_out
, 
OP_SPECIAL_OBJECT_NEW_TARGET
);

30507 
	`put_sh‹t_code
(&
bc_out
, 
OP_put_loc
, 
s
->
√w_èrgë_v¨_idx
);

30511 i‡(
s
->
this_v¨_idx
 >= 0) {

30512 i‡(
s
->
is_dîived_˛ass_c⁄°ru˘‹
) {

30513 
	`dbuf_putc
(&
bc_out
, 
OP_£t_loc_unöôülized
);

30514 
	`dbuf_put_u16
(&
bc_out
, 
s
->
this_v¨_idx
);

30516 
	`dbuf_putc
(&
bc_out
, 
OP_push_this
);

30517 
	`put_sh‹t_code
(&
bc_out
, 
OP_put_loc
, 
s
->
this_v¨_idx
);

30521 i‡(
s
->
¨gumíts_v¨_idx
 >= 0) {

30522 i‡((
s
->
js_mode
 & 
JS_MODE_STRICT
Ë|| !s->
has_sim∂e_∑ømëî_li°
) {

30523 
	`dbuf_putc
(&
bc_out
, 
OP_•ecül_obje˘
);

30524 
	`dbuf_putc
(&
bc_out
, 
OP_SPECIAL_OBJECT_ARGUMENTS
);

30526 
	`dbuf_putc
(&
bc_out
, 
OP_•ecül_obje˘
);

30527 
	`dbuf_putc
(&
bc_out
, 
OP_SPECIAL_OBJECT_MAPPED_ARGUMENTS
);

30529 
	`put_sh‹t_code
(&
bc_out
, 
OP_put_loc
, 
s
->
¨gumíts_v¨_idx
);

30532 i‡(
s
->
func_v¨_idx
 >= 0) {

30533 
	`dbuf_putc
(&
bc_out
, 
OP_•ecül_obje˘
);

30534 
	`dbuf_putc
(&
bc_out
, 
OP_SPECIAL_OBJECT_THIS_FUNC
);

30535 
	`put_sh‹t_code
(&
bc_out
, 
OP_put_loc
, 
s
->
func_v¨_idx
);

30538 i‡(
s
->
v¨_obje˘_idx
 >= 0) {

30539 
	`dbuf_putc
(&
bc_out
, 
OP_•ecül_obje˘
);

30540 
	`dbuf_putc
(&
bc_out
, 
OP_SPECIAL_OBJECT_VAR_OBJECT
);

30541 
	`put_sh‹t_code
(&
bc_out
, 
OP_put_loc
, 
s
->
v¨_obje˘_idx
);

30544 
pos
 = 0;Öo†< 
bc_Àn
;Öo†
pos_√xt
) {

30545 
vÆ
;

30546 
›
 = 
bc_buf
[
pos
];

30547 
Àn
 = 
›code_öfo
[
›
].
size
;

30548 
pos_√xt
 = 
pos
 + 
Àn
;

30549 
›
) {

30550 
OP_löe_num
:

30554 
löe_num
 = 
	`gë_u32
(
bc_buf
 + 
pos
 + 1);

30557 
OP_œbñ
:

30559 
œbñ
 = 
	`gë_u32
(
bc_buf
 + 
pos
 + 1);

30560 
	`as£π
(
œbñ
 >0 &&Üabñ < 
s
->
œbñ_cou¡
);

30561 
ls
 = &
œbñ_¶Ÿs
[
œbñ
];

30562 
	`as£π
(
ls
->
addr
 == -1);

30563 
ls
->
addr
 = 
bc_out
.
size
;

30565 
ª
 = 
ls
->
fú°_ªloc
;Ñê!
NULL
;Ñê
ª_√xt
) {

30566 
diff
 = 
ls
->
addr
 - 
ª
->addr;

30567 
ª_√xt
 = 
ª
->
√xt
;

30568 
ª
->
size
) {

30570 
	`put_u32
(
bc_out
.
buf
 + 
ª
->
addr
, 
diff
);

30573 
	`as£π
(
diff
 =(
öt16_t
)diff);

30574 
	`put_u16
(
bc_out
.
buf
 + 
ª
->
addr
, 
diff
);

30577 
	`as£π
(
diff
 =(
öt8_t
)diff);

30578 
	`put_u8
(
bc_out
.
buf
 + 
ª
->
addr
, 
diff
);

30581 
	`js_‰ì
(
˘x
, 
ª
);

30583 
ls
->
fú°_ªloc
 = 
NULL
;

30587 
OP_ˇŒ
:

30588 
OP_ˇŒ_mëhod
:

30591 
¨gc
;

30592 
¨gc
 = 
	`gë_u16
(
bc_buf
 + 
pos
 + 1);

30593 i‡(
	`code_m©ch
(&
cc
, 
pos_√xt
, 
OP_ªtu∫
, -1)) {

30594 i‡(
cc
.
löe_num
 >= 0)Üine_num = cc.line_num;

30595 
	`add_pc2löe_öfo
(
s
, 
bc_out
.
size
, 
löe_num
);

30596 
	`put_sh‹t_code
(&
bc_out
, 
›
 + 1, 
¨gc
);

30597 
pos_√xt
 = 
	`skù_dód_code
(
s
, 
bc_buf
, 
bc_Àn
, 
cc
.
pos
, &
löe_num
);

30600 
	`add_pc2löe_öfo
(
s
, 
bc_out
.
size
, 
löe_num
);

30601 
	`put_sh‹t_code
(&
bc_out
, 
›
, 
¨gc
);

30604 
no_ch™ge
;

30606 
OP_ªtu∫
:

30607 
OP_ªtu∫_undef
:

30608 
OP_ªtu∫_async
:

30609 
OP_throw
:

30610 
OP_throw_v¨
:

30611 
pos_√xt
 = 
	`skù_dód_code
(
s
, 
bc_buf
, 
bc_Àn
,Öos_√xt, &
löe_num
);

30612 
no_ch™ge
;

30614 
OP_gŸo
:

30615 
œbñ
 = 
	`gë_u32
(
bc_buf
 + 
pos
 + 1);

30616 
has_gŸo
:

30617 i‡(
OPTIMIZE
) {

30618 
löe1
 = -1;

30620 
œbñ
 = 
	`föd_jump_èrgë
(
s
,Üabñ, &
›1
, &
löe1
);

30621 i‡(
	`code_has_œbñ
(&
cc
, 
pos_√xt
, 
œbñ
)) {

30623 
	`upd©e_œbñ
(
s
, 
œbñ
, -1);

30626 i‡(
›1
 =
OP_ªtu∫
 || op1 =
OP_ªtu∫_undef
 || op1 =
OP_throw
) {

30630 
	`upd©e_œbñ
(
s
, 
œbñ
, -1);

30631 
	`add_pc2löe_öfo
(
s
, 
bc_out
.
size
, 
löe_num
);

30632 
	`dbuf_putc
(&
bc_out
, 
›1
);

30633 
pos_√xt
 = 
	`skù_dód_code
(
s
, 
bc_buf
, 
bc_Àn
,Öos_√xt, &
löe_num
);

30643 
has_œbñ
;

30645 
OP_gosub
:

30646 
œbñ
 = 
	`gë_u32
(
bc_buf
 + 
pos
 + 1);

30647 i‡(0 && 
OPTIMIZE
) {

30648 
œbñ
 = 
	`föd_jump_èrgë
(
s
,Üabñ, &
›1
, 
NULL
);

30649 i‡(
›1
 =
OP_ªt
) {

30650 
	`upd©e_œbñ
(
s
, 
œbñ
, -1);

30655 
has_œbñ
;

30657 
OP_ˇtch
:

30658 
œbñ
 = 
	`gë_u32
(
bc_buf
 + 
pos
 + 1);

30659 
has_œbñ
;

30661 
OP_if_åue
:

30662 
OP_if_Ál£
:

30663 
œbñ
 = 
	`gë_u32
(
bc_buf
 + 
pos
 + 1);

30664 i‡(
OPTIMIZE
) {

30665 
œbñ
 = 
	`föd_jump_èrgë
(
s
,Üabñ, &
›1
, 
NULL
);

30667 i‡(
	`code_has_œbñ
(&
cc
, 
pos_√xt
, 
œbñ
)) {

30668 
	`upd©e_œbñ
(
s
, 
œbñ
, -1);

30669 
	`dbuf_putc
(&
bc_out
, 
OP_dr›
);

30673 i‡(
	`code_m©ch
(&
cc
, 
pos_√xt
, 
OP_gŸo
, -1)) {

30674 
pos1
 = 
cc
.
pos
;

30675 
löe1
 = 
cc
.
löe_num
;

30676 i‡(
	`code_has_œbñ
(&
cc
, 
pos1
, 
œbñ
)) {

30677 i‡(
löe1
 >0Ë
löe_num
 =Üine1;

30678 
pos_√xt
 = 
pos1
;

30679 
	`upd©e_œbñ
(
s
, 
œbñ
, -1);

30680 
œbñ
 = 
cc
.label;

30681 
›
 ^
OP_if_åue
 ^ 
OP_if_Ál£
;

30685 
has_œbñ
:

30686 
	`add_pc2löe_öfo
(
s
, 
bc_out
.
size
, 
löe_num
);

30687 i‡(
›
 =
OP_gŸo
) {

30688 
pos_√xt
 = 
	`skù_dód_code
(
s
, 
bc_buf
, 
bc_Àn
,Öos_√xt, &
löe_num
);

30690 
	`as£π
(
œbñ
 >0 &&Üabñ < 
s
->
œbñ_cou¡
);

30691 
ls
 = &
œbñ_¶Ÿs
[
œbñ
];

30692 #i‡
SHORT_OPCODES


30693 
jp
 = &
s
->
jump_¶Ÿs
[s->
jump_cou¡
++];

30694 
jp
->
›
 = op;

30695 
jp
->
size
 = 4;

30696 
jp
->
pos
 = 
bc_out
.
size
 + 1;

30697 
jp
->
œbñ
 =Üabel;

30699 i‡(
ls
->
addr
 == -1) {

30700 
diff
 = 
ls
->
pos2
 - 
pos
 - 1;

30701 i‡(
diff
 < 128 && (
›
 =
OP_if_Ál£
 || o∞=
OP_if_åue
 || o∞=
OP_gŸo
)) {

30702 
jp
->
size
 = 1;

30703 
jp
->
›
 = 
OP_if_Ál£8
 + (› - 
OP_if_Ál£
);

30704 
	`dbuf_putc
(&
bc_out
, 
OP_if_Ál£8
 + (
›
 - 
OP_if_Ál£
));

30705 
	`dbuf_putc
(&
bc_out
, 0);

30706 i‡(!
	`add_ªloc
(
˘x
, 
ls
, 
bc_out
.
size
 - 1, 1))

30707 
Áû
;

30710 i‡(
diff
 < 32768 && 
›
 =
OP_gŸo
) {

30711 
jp
->
size
 = 2;

30712 
jp
->
›
 = 
OP_gŸo16
;

30713 
	`dbuf_putc
(&
bc_out
, 
OP_gŸo16
);

30714 
	`dbuf_put_u16
(&
bc_out
, 0);

30715 i‡(!
	`add_ªloc
(
˘x
, 
ls
, 
bc_out
.
size
 - 2, 2))

30716 
Áû
;

30720 
diff
 = 
ls
->
addr
 - 
bc_out
.
size
 - 1;

30721 i‡(
diff
 =(
öt8_t
)dif‡&& (
›
 =
OP_if_Ál£
 || o∞=
OP_if_åue
 || o∞=
OP_gŸo
)) {

30722 
jp
->
size
 = 1;

30723 
jp
->
›
 = 
OP_if_Ál£8
 + (› - 
OP_if_Ál£
);

30724 
	`dbuf_putc
(&
bc_out
, 
OP_if_Ál£8
 + (
›
 - 
OP_if_Ál£
));

30725 
	`dbuf_putc
(&
bc_out
, 
diff
);

30728 i‡(
diff
 =(
öt16_t
)dif‡&& 
›
 =
OP_gŸo
) {

30729 
jp
->
size
 = 2;

30730 
jp
->
›
 = 
OP_gŸo16
;

30731 
	`dbuf_putc
(&
bc_out
, 
OP_gŸo16
);

30732 
	`dbuf_put_u16
(&
bc_out
, 
diff
);

30737 
	`dbuf_putc
(&
bc_out
, 
›
);

30738 
	`dbuf_put_u32
(&
bc_out
, 
ls
->
addr
 - bc_out.
size
);

30739 i‡(
ls
->
addr
 == -1) {

30741 i‡(!
	`add_ªloc
(
˘x
, 
ls
, 
bc_out
.
size
 - 4, 4))

30742 
Áû
;

30745 
OP_wôh_gë_v¨
:

30746 
OP_wôh_put_v¨
:

30747 
OP_wôh_dñëe_v¨
:

30748 
OP_wôh_make_ªf
:

30749 
OP_wôh_gë_ªf
:

30750 
OP_wôh_gë_ªf_undef
:

30752 
JSAtom
 
©om
;

30753 
is_wôh
;

30755 
©om
 = 
	`gë_u32
(
bc_buf
 + 
pos
 + 1);

30756 
œbñ
 = 
	`gë_u32
(
bc_buf
 + 
pos
 + 5);

30757 
is_wôh
 = 
bc_buf
[
pos
 + 9];

30758 i‡(
OPTIMIZE
) {

30759 
œbñ
 = 
	`föd_jump_èrgë
(
s
,Üabñ, &
›1
, 
NULL
);

30761 
	`as£π
(
œbñ
 >0 &&Üabñ < 
s
->
œbñ_cou¡
);

30762 
ls
 = &
œbñ_¶Ÿs
[
œbñ
];

30763 
	`add_pc2löe_öfo
(
s
, 
bc_out
.
size
, 
löe_num
);

30764 #i‡
SHORT_OPCODES


30765 
jp
 = &
s
->
jump_¶Ÿs
[s->
jump_cou¡
++];

30766 
jp
->
›
 = op;

30767 
jp
->
size
 = 4;

30768 
jp
->
pos
 = 
bc_out
.
size
 + 5;

30769 
jp
->
œbñ
 =Üabel;

30771 
	`dbuf_putc
(&
bc_out
, 
›
);

30772 
	`dbuf_put_u32
(&
bc_out
, 
©om
);

30773 
	`dbuf_put_u32
(&
bc_out
, 
ls
->
addr
 - bc_out.
size
);

30774 i‡(
ls
->
addr
 == -1) {

30776 i‡(!
	`add_ªloc
(
˘x
, 
ls
, 
bc_out
.
size
 - 4, 4))

30777 
Áû
;

30779 
	`dbuf_putc
(&
bc_out
, 
is_wôh
);

30783 
OP_dr›
:

30784 i‡(
OPTIMIZE
) {

30786 i‡(
	`code_m©ch
(&
cc
, 
pos_√xt
, 
OP_ªtu∫_undef
, -1)) {

30787 i‡(
cc
.
löe_num
 >= 0)Üine_num = cc.line_num;

30791 
no_ch™ge
;

30793 
OP_nuŒ
:

30794 #i‡
SHORT_OPCODES


30795 i‡(
OPTIMIZE
) {

30797 i‡(
	`code_m©ch
(&
cc
, 
pos_√xt
, 
OP_°ri˘_eq
, -1)) {

30798 i‡(
cc
.
löe_num
 >= 0)Üine_num = cc.line_num;

30799 
	`add_pc2löe_öfo
(
s
, 
bc_out
.
size
, 
löe_num
);

30800 
	`dbuf_putc
(&
bc_out
, 
OP_is_nuŒ
);

30801 
pos_√xt
 = 
cc
.
pos
;

30805 i‡(
	`code_m©ch
(&
cc
, 
pos_√xt
, 
OP_°ri˘_√q
, 
	`M2
(
OP_if_Ál£
, 
OP_if_åue
), -1)) {

30806 i‡(
cc
.
löe_num
 >= 0)Üine_num = cc.line_num;

30807 
	`add_pc2löe_öfo
(
s
, 
bc_out
.
size
, 
löe_num
);

30808 
	`dbuf_putc
(&
bc_out
, 
OP_is_nuŒ
);

30809 
pos_√xt
 = 
cc
.
pos
;

30810 
œbñ
 = 
cc
.label;

30811 
›
 = 
cc
.› ^ 
OP_if_Ál£
 ^ 
OP_if_åue
;

30812 
has_œbñ
;

30817 
OP_push_Ál£
:

30818 
OP_push_åue
:

30819 i‡(
OPTIMIZE
) {

30820 
vÆ
 = (
›
 =
OP_push_åue
);

30821 i‡(
	`code_m©ch
(&
cc
, 
pos_√xt
, 
	`M2
(
OP_if_Ál£
, 
OP_if_åue
), -1)) {

30822 
has_c⁄°™t_ã°
:

30823 i‡(
cc
.
löe_num
 >= 0)Üine_num = cc.line_num;

30824 i‡(
vÆ
 =
cc
.
›
 - 
OP_if_Ál£
) {

30828 
pos_√xt
 = 
cc
.
pos
;

30829 
›
 = 
OP_gŸo
;

30830 
œbñ
 = 
cc
.label;

30831 
has_gŸo
;

30836 
pos_√xt
 = 
cc
.
pos
;

30837 
	`upd©e_œbñ
(
s
, 
cc
.
œbñ
, -1);

30842 
no_ch™ge
;

30844 
OP_push_i32
:

30845 i‡(
OPTIMIZE
) {

30847 
vÆ
 = 
	`gë_i32
(
bc_buf
 + 
pos
 + 1);

30848 i‡((
vÆ
 !
INT32_MIN
 && val != 0)

30849 && 
	`code_m©ch
(&
cc
, 
pos_√xt
, 
OP_√g
, -1)) {

30850 i‡(
cc
.
löe_num
 >= 0)Üine_num = cc.line_num;

30851 i‡(
	`code_m©ch
(&
cc
, cc.
pos
, 
OP_dr›
, -1)) {

30852 i‡(
cc
.
löe_num
 >= 0)Üine_num = cc.line_num;

30854 
	`add_pc2löe_öfo
(
s
, 
bc_out
.
size
, 
löe_num
);

30855 
	`push_sh‹t_öt
(&
bc_out
, -
vÆ
);

30857 
pos_√xt
 = 
cc
.
pos
;

30861 i‡(
	`code_m©ch
(&
cc
, 
pos_√xt
, 
OP_dr›
, -1)) {

30862 i‡(
cc
.
löe_num
 >= 0)Üine_num = cc.line_num;

30863 
pos_√xt
 = 
cc
.
pos
;

30867 i‡(
	`code_m©ch
(&
cc
, 
pos_√xt
, 
	`M2
(
OP_if_Ál£
, 
OP_if_åue
), -1)) {

30868 
vÆ
 = (val != 0);

30869 
has_c⁄°™t_ã°
;

30871 
	`add_pc2löe_öfo
(
s
, 
bc_out
.
size
, 
löe_num
);

30872 
	`push_sh‹t_öt
(&
bc_out
, 
vÆ
);

30875 
no_ch™ge
;

30877 #i‡
SHORT_OPCODES


30878 
OP_push_c⁄°
:

30879 
OP_f˛osuª
:

30880 i‡(
OPTIMIZE
) {

30881 
idx
 = 
	`gë_u32
(
bc_buf
 + 
pos
 + 1);

30882 i‡(
idx
 < 256) {

30883 
	`add_pc2löe_öfo
(
s
, 
bc_out
.
size
, 
löe_num
);

30884 
	`dbuf_putc
(&
bc_out
, 
OP_push_c⁄°8
 + 
›
 - 
OP_push_c⁄°
);

30885 
	`dbuf_putc
(&
bc_out
, 
idx
);

30889 
no_ch™ge
;

30891 
OP_gë_fõld
:

30892 i‡(
OPTIMIZE
) {

30893 
JSAtom
 
©om
 = 
	`gë_u32
(
bc_buf
 + 
pos
 + 1);

30894 i‡(
©om
 =
JS_ATOM_Àngth
) {

30895 
	`JS_FªeAtom
(
˘x
, 
©om
);

30896 
	`add_pc2löe_öfo
(
s
, 
bc_out
.
size
, 
löe_num
);

30897 
	`dbuf_putc
(&
bc_out
, 
OP_gë_Àngth
);

30901 
no_ch™ge
;

30903 
OP_push_©om_vÆue
:

30904 i‡(
OPTIMIZE
) {

30905 
JSAtom
 
©om
 = 
	`gë_u32
(
bc_buf
 + 
pos
 + 1);

30907 i‡(
	`code_m©ch
(&
cc
, 
pos_√xt
, 
OP_dr›
, -1)) {

30908 
	`JS_FªeAtom
(
˘x
, 
©om
);

30909 i‡(
cc
.
löe_num
 >= 0)Üine_num = cc.line_num;

30910 
pos_√xt
 = 
cc
.
pos
;

30913 #i‡
SHORT_OPCODES


30914 i‡(
©om
 =
JS_ATOM_em±y_°rög
) {

30915 
	`JS_FªeAtom
(
˘x
, 
©om
);

30916 
	`add_pc2löe_öfo
(
s
, 
bc_out
.
size
, 
löe_num
);

30917 
	`dbuf_putc
(&
bc_out
, 
OP_push_em±y_°rög
);

30922 
no_ch™ge
;

30924 
OP_to_¥›key
:

30925 
OP_to_¥›key2
:

30926 i‡(
OPTIMIZE
) {

30928 i‡(
	`code_m©ch
(&
cc
, 
pos_√xt
, 
	`M3
(
OP_gë_loc
, 
OP_gë_¨g
, 
OP_gë_v¨_ªf
), -1, 
OP_put_¨øy_ñ
, -1)

30929 || 
	`code_m©ch
(&
cc
, 
pos_√xt
, 
	`M3
(
OP_push_i32
, 
OP_push_c⁄°
, 
OP_push_©om_vÆue
), 
OP_put_¨øy_ñ
, -1)

30930 || 
	`code_m©ch
(&
cc
, 
pos_√xt
, 
	`M4
(
OP_undeföed
, 
OP_nuŒ
, 
OP_push_åue
, 
OP_push_Ál£
), 
OP_put_¨øy_ñ
, -1)) {

30934 
no_ch™ge
;

30936 
OP_undeföed
:

30937 i‡(
OPTIMIZE
) {

30939 i‡(
	`code_m©ch
(&
cc
, 
pos_√xt
, 
OP_dr›
, -1)) {

30940 i‡(
cc
.
löe_num
 >= 0)Üine_num = cc.line_num;

30941 
pos_√xt
 = 
cc
.
pos
;

30945 i‡(
	`code_m©ch
(&
cc
, 
pos_√xt
, 
OP_ªtu∫
, -1)) {

30946 i‡(
cc
.
löe_num
 >= 0)Üine_num = cc.line_num;

30947 
	`add_pc2löe_öfo
(
s
, 
bc_out
.
size
, 
löe_num
);

30948 
	`dbuf_putc
(&
bc_out
, 
OP_ªtu∫_undef
);

30949 
pos_√xt
 = 
cc
.
pos
;

30953 i‡(
	`code_m©ch
(&
cc
, 
pos_√xt
, 
	`M2
(
OP_if_Ál£
, 
OP_if_åue
), -1)) {

30954 
vÆ
 = 0;

30955 
has_c⁄°™t_ã°
;

30957 #i‡
SHORT_OPCODES


30959 i‡(
	`code_m©ch
(&
cc
, 
pos_√xt
, 
OP_°ri˘_eq
, -1)) {

30960 i‡(
cc
.
löe_num
 >= 0)Üine_num = cc.line_num;

30961 
	`add_pc2löe_öfo
(
s
, 
bc_out
.
size
, 
löe_num
);

30962 
	`dbuf_putc
(&
bc_out
, 
OP_is_undeföed
);

30963 
pos_√xt
 = 
cc
.
pos
;

30967 i‡(
	`code_m©ch
(&
cc
, 
pos_√xt
, 
OP_°ri˘_√q
, 
	`M2
(
OP_if_Ál£
, 
OP_if_åue
), -1)) {

30968 i‡(
cc
.
löe_num
 >= 0)Üine_num = cc.line_num;

30969 
	`add_pc2löe_öfo
(
s
, 
bc_out
.
size
, 
löe_num
);

30970 
	`dbuf_putc
(&
bc_out
, 
OP_is_undeföed
);

30971 
pos_√xt
 = 
cc
.
pos
;

30972 
œbñ
 = 
cc
.label;

30973 
›
 = 
cc
.› ^ 
OP_if_Ál£
 ^ 
OP_if_åue
;

30974 
has_œbñ
;

30978 
no_ch™ge
;

30980 
OP_ö£π2
:

30981 i‡(
OPTIMIZE
) {

30986 i‡(
	`code_m©ch
(&
cc
, 
pos_√xt
, 
	`M2
(
OP_put_fõld
, 
OP_put_v¨_°ri˘
), 
OP_dr›
, -1)) {

30987 i‡(
cc
.
löe_num
 >= 0)Üine_num = cc.line_num;

30988 
	`add_pc2löe_öfo
(
s
, 
bc_out
.
size
, 
löe_num
);

30989 
	`dbuf_putc
(&
bc_out
, 
cc
.
›
);

30990 
	`dbuf_put_u32
(&
bc_out
, 
cc
.
©om
);

30991 
pos_√xt
 = 
cc
.
pos
;

30995 
no_ch™ge
;

30997 
OP_dup
:

30998 i‡(
OPTIMIZE
) {

31000 
›1
, 
löe2
 = -1;

31002 i‡(
	`code_m©ch
(&
cc
, 
pos_√xt
, 
	`M3
(
OP_put_loc
, 
OP_put_¨g
, 
OP_put_v¨_ªf
), -1, -1)) {

31003 i‡(
cc
.
löe_num
 >= 0)Üine_num = cc.line_num;

31004 
›1
 = 
cc
.
›
 + 1;

31005 
pos_√xt
 = 
cc
.
pos
;

31006 i‡(
	`code_m©ch
(&
cc
, cc.
pos
, 
OP_dr›
, -1)) {

31007 i‡(
cc
.
löe_num
 >= 0)Üine_num = cc.line_num;

31008 
›1
 -= 1;

31009 
pos_√xt
 = 
cc
.
pos
;

31010 i‡(
	`code_m©ch
(&
cc
, cc.
pos
, 
›1
 - 1, cc.
idx
, -1)) {

31011 
löe2
 = 
cc
.
löe_num
;

31012 
›1
 += 1;

31013 
pos_√xt
 = 
cc
.
pos
;

31016 
	`add_pc2löe_öfo
(
s
, 
bc_out
.
size
, 
löe_num
);

31017 
	`put_sh‹t_code
(&
bc_out
, 
›1
, 
cc
.
idx
);

31018 i‡(
löe2
 >0Ë
löe_num
 =Üine2;

31022 
no_ch™ge
;

31024 
OP_gë_loc
:

31025 i‡(
OPTIMIZE
) {

31032 
idx
;

31033 
idx
 = 
	`gë_u16
(
bc_buf
 + 
pos
 + 1);

31034 i‡(
idx
 >= 256)

31035 
no_ch™ge
;

31036 i‡(
	`code_m©ch
(&
cc
, 
pos_√xt
, 
	`M2
(
OP_po°_dec
, 
OP_po°_öc
), 
OP_put_loc
, 
idx
, 
OP_dr›
, -1) ||

31037 
	`code_m©ch
(&
cc
, 
pos_√xt
, 
	`M2
(
OP_dec
, 
OP_öc
), 
OP_dup
, 
OP_put_loc
, 
idx
, 
OP_dr›
, -1)) {

31038 i‡(
cc
.
löe_num
 >= 0)Üine_num = cc.line_num;

31039 
	`add_pc2löe_öfo
(
s
, 
bc_out
.
size
, 
löe_num
);

31040 
	`dbuf_putc
(&
bc_out
, (
cc
.
›
 =
OP_öc
 || cc.› =
OP_po°_öc
Ë? 
OP_öc_loc
 : 
OP_dec_loc
);

31041 
	`dbuf_putc
(&
bc_out
, 
idx
);

31042 
pos_√xt
 = 
cc
.
pos
;

31048 i‡(
	`code_m©ch
(&
cc
, 
pos_√xt
, 
OP_push_©om_vÆue
, 
OP_add
, 
OP_dup
, 
OP_put_loc
, 
idx
, 
OP_dr›
, -1)) {

31049 i‡(
cc
.
löe_num
 >= 0)Üine_num = cc.line_num;

31050 
	`add_pc2löe_öfo
(
s
, 
bc_out
.
size
, 
löe_num
);

31051 #i‡
SHORT_OPCODES


31052 i‡(
cc
.
©om
 =
JS_ATOM_em±y_°rög
) {

31053 
	`JS_FªeAtom
(
˘x
, 
cc
.
©om
);

31054 
	`dbuf_putc
(&
bc_out
, 
OP_push_em±y_°rög
);

31058 
	`dbuf_putc
(&
bc_out
, 
OP_push_©om_vÆue
);

31059 
	`dbuf_put_u32
(&
bc_out
, 
cc
.
©om
);

31061 
	`dbuf_putc
(&
bc_out
, 
OP_add_loc
);

31062 
	`dbuf_putc
(&
bc_out
, 
idx
);

31063 
pos_√xt
 = 
cc
.
pos
;

31069 i‡(
	`code_m©ch
(&
cc
, 
pos_√xt
, 
OP_push_i32
, 
OP_add
, 
OP_dup
, 
OP_put_loc
, 
idx
, 
OP_dr›
, -1)) {

31070 i‡(
cc
.
löe_num
 >= 0)Üine_num = cc.line_num;

31071 
	`add_pc2löe_öfo
(
s
, 
bc_out
.
size
, 
löe_num
);

31072 
	`push_sh‹t_öt
(&
bc_out
, 
cc
.
œbñ
);

31073 
	`dbuf_putc
(&
bc_out
, 
OP_add_loc
);

31074 
	`dbuf_putc
(&
bc_out
, 
idx
);

31075 
pos_√xt
 = 
cc
.
pos
;

31083 i‡(
	`code_m©ch
(&
cc
, 
pos_√xt
, 
	`M3
(
OP_gë_loc
, 
OP_gë_¨g
, 
OP_gë_v¨_ªf
), -1, 
OP_add
, 
OP_dup
, 
OP_put_loc
, 
idx
, 
OP_dr›
, -1)) {

31084 i‡(
cc
.
löe_num
 >= 0)Üine_num = cc.line_num;

31085 
	`add_pc2löe_öfo
(
s
, 
bc_out
.
size
, 
löe_num
);

31086 
	`put_sh‹t_code
(&
bc_out
, 
cc
.
›
, cc.
idx
);

31087 
	`dbuf_putc
(&
bc_out
, 
OP_add_loc
);

31088 
	`dbuf_putc
(&
bc_out
, 
idx
);

31089 
pos_√xt
 = 
cc
.
pos
;

31092 
	`add_pc2löe_öfo
(
s
, 
bc_out
.
size
, 
löe_num
);

31093 
	`put_sh‹t_code
(&
bc_out
, 
›
, 
idx
);

31096 
no_ch™ge
;

31097 #i‡
SHORT_OPCODES


31098 
OP_gë_¨g
:

31099 
OP_gë_v¨_ªf
:

31100 i‡(
OPTIMIZE
) {

31101 
idx
;

31102 
idx
 = 
	`gë_u16
(
bc_buf
 + 
pos
 + 1);

31103 
	`add_pc2löe_öfo
(
s
, 
bc_out
.
size
, 
löe_num
);

31104 
	`put_sh‹t_code
(&
bc_out
, 
›
, 
idx
);

31107 
no_ch™ge
;

31109 
OP_put_loc
:

31110 
OP_put_¨g
:

31111 
OP_put_v¨_ªf
:

31112 i‡(
OPTIMIZE
) {

31114 
idx
;

31115 
idx
 = 
	`gë_u16
(
bc_buf
 + 
pos
 + 1);

31116 i‡(
	`code_m©ch
(&
cc
, 
pos_√xt
, 
›
 - 1, 
idx
, -1)) {

31117 i‡(
cc
.
löe_num
 >= 0)Üine_num = cc.line_num;

31118 
	`add_pc2löe_öfo
(
s
, 
bc_out
.
size
, 
löe_num
);

31119 
	`put_sh‹t_code
(&
bc_out
, 
›
 + 1, 
idx
);

31120 
pos_√xt
 = 
cc
.
pos
;

31123 
	`add_pc2löe_öfo
(
s
, 
bc_out
.
size
, 
löe_num
);

31124 
	`put_sh‹t_code
(&
bc_out
, 
›
, 
idx
);

31127 
no_ch™ge
;

31129 
OP_po°_öc
:

31130 
OP_po°_dec
:

31131 i‡(
OPTIMIZE
) {

31138 
›1
, 
idx
;

31139 i‡(
	`code_m©ch
(&
cc
, 
pos_√xt
, 
	`M3
(
OP_put_loc
, 
OP_put_¨g
, 
OP_put_v¨_ªf
), -1, 
OP_dr›
, -1)) {

31140 i‡(
cc
.
löe_num
 >= 0)Üine_num = cc.line_num;

31141 
›1
 = 
cc
.
›
;

31142 
idx
 = 
cc
.idx;

31143 
pos_√xt
 = 
cc
.
pos
;

31144 i‡(
	`code_m©ch
(&
cc
, cc.
pos
, 
›1
 - 1, 
idx
, -1)) {

31145 i‡(
cc
.
löe_num
 >= 0)Üine_num = cc.line_num;

31146 
›1
 += 1;

31147 
pos_√xt
 = 
cc
.
pos
;

31149 
	`add_pc2löe_öfo
(
s
, 
bc_out
.
size
, 
löe_num
);

31150 
	`dbuf_putc
(&
bc_out
, 
OP_dec
 + (
›
 - 
OP_po°_dec
));

31151 
	`put_sh‹t_code
(&
bc_out
, 
›1
, 
idx
);

31154 i‡(
	`code_m©ch
(&
cc
, 
pos_√xt
, 
OP_≥rm3
, 
	`M2
(
OP_put_fõld
, 
OP_put_v¨_°ri˘
), 
OP_dr›
, -1)) {

31155 i‡(
cc
.
löe_num
 >= 0)Üine_num = cc.line_num;

31156 
	`add_pc2löe_öfo
(
s
, 
bc_out
.
size
, 
löe_num
);

31157 
	`dbuf_putc
(&
bc_out
, 
OP_dec
 + (
›
 - 
OP_po°_dec
));

31158 
	`dbuf_putc
(&
bc_out
, 
cc
.
›
);

31159 
	`dbuf_put_u32
(&
bc_out
, 
cc
.
©om
);

31160 
pos_√xt
 = 
cc
.
pos
;

31163 i‡(
	`code_m©ch
(&
cc
, 
pos_√xt
, 
OP_≥rm4
, 
OP_put_¨øy_ñ
, 
OP_dr›
, -1)) {

31164 i‡(
cc
.
löe_num
 >= 0)Üine_num = cc.line_num;

31165 
	`add_pc2löe_öfo
(
s
, 
bc_out
.
size
, 
löe_num
);

31166 
	`dbuf_putc
(&
bc_out
, 
OP_dec
 + (
›
 - 
OP_po°_dec
));

31167 
	`dbuf_putc
(&
bc_out
, 
OP_put_¨øy_ñ
);

31168 
pos_√xt
 = 
cc
.
pos
;

31172 
no_ch™ge
;

31174 
OP_ty≥of
:

31175 i‡(
OPTIMIZE
) {

31177 i‡(
	`code_m©ch
(&
cc
, 
pos_√xt
, 
OP_push_©om_vÆue
, 
	`M4
(
OP_°ri˘_eq
, 
OP_°ri˘_√q
, 
OP_eq
, 
OP_√q
), -1)) {

31178 i‡(
cc
.
löe_num
 >= 0)Üine_num = cc.line_num;

31179 
›1
 = (
cc
.
›
 =
OP_°ri˘_eq
 || cc.› =
OP_eq
Ë? OP_°ri˘_eq : 
OP_°ri˘_√q
;

31180 #i‡
SHORT_OPCODES


31181 
›2
 = -1;

31182 
cc
.
©om
) {

31183 
JS_ATOM_undeföed
:

31184 
›2
 = 
OP_is_undeföed
;

31186 
JS_ATOM_fun˘i⁄
:

31187 
›2
 = 
OP_is_fun˘i⁄
;

31190 i‡(
›2
 >= 0) {

31192 i‡(
›1
 =
OP_°ri˘_eq
) {

31193 
	`add_pc2löe_öfo
(
s
, 
bc_out
.
size
, 
löe_num
);

31194 
	`dbuf_putc
(&
bc_out
, 
›2
);

31195 
	`JS_FªeAtom
(
˘x
, 
cc
.
©om
);

31196 
pos_√xt
 = 
cc
.
pos
;

31199 i‡(
›1
 =
OP_°ri˘_√q
 && 
	`code_m©ch
(&
cc
, cc.
pos
, 
OP_if_Ál£
, -1)) {

31201 i‡(
cc
.
löe_num
 >= 0)Üine_num = cc.line_num;

31202 
	`add_pc2löe_öfo
(
s
, 
bc_out
.
size
, 
löe_num
);

31203 
	`dbuf_putc
(&
bc_out
, 
›2
);

31204 
	`JS_FªeAtom
(
˘x
, 
cc
.
©om
);

31205 
pos_√xt
 = 
cc
.
pos
;

31206 
œbñ
 = 
cc
.label;

31207 
›
 = 
OP_if_åue
;

31208 
has_œbñ
;

31212 i‡(
cc
.
©om
 =
JS_ATOM_undeföed
) {

31214 
	`add_pc2löe_öfo
(
s
, 
bc_out
.
size
, 
löe_num
);

31215 
	`dbuf_putc
(&
bc_out
, 
OP_undeföed
);

31216 
	`dbuf_putc
(&
bc_out
, 
›1
);

31217 
	`JS_FªeAtom
(
˘x
, 
cc
.
©om
);

31218 
pos_√xt
 = 
cc
.
pos
;

31223 
no_ch™ge
;

31226 
no_ch™ge
:

31227 
	`add_pc2löe_öfo
(
s
, 
bc_out
.
size
, 
löe_num
);

31228 
	`dbuf_put
(&
bc_out
, 
bc_buf
 + 
pos
, 
Àn
);

31234 
i
 = 0; i < 
s
->
œbñ_cou¡
; i++) {

31235 
	`as£π
(
œbñ_¶Ÿs
[
i
].
fú°_ªloc
 =
NULL
);

31237 #i‡
SHORT_OPCODES


31238 i‡(
OPTIMIZE
) {

31240 
∑tch_off£ts
 = 0;

31241 
i
 = 0, 
jp
 = 
s
->
jump_¶Ÿs
; i < s->
jump_cou¡
; i++, jp++) {

31242 
LabñSlŸ
 *
ls
;

31243 
JumpSlŸ
 *
jp1
;

31244 
j
, 
pos
, 
diff
, 
dñè
;

31246 
dñè
 = 3;

31247 
›
 = 
jp
->op) {

31248 
OP_gŸo16
:

31249 
dñè
 = 1;

31251 
OP_if_Ál£
:

31252 
OP_if_åue
:

31253 
OP_gŸo
:

31254 
pos
 = 
jp
->pos;

31255 
diff
 = 
s
->
œbñ_¶Ÿs
[
jp
->
œbñ
].
addr
 - 
pos
;

31256 i‡(
diff
 >-128 && dif‡<127 + 
dñè
) {

31258 
jp
->
size
 = 1;

31259 i‡(
›
 =
OP_gŸo16
) {

31260 
bc_out
.
buf
[
pos
 - 1] = 
jp
->
›
 = 
OP_gŸo8
;

31262 
bc_out
.
buf
[
pos
 - 1] = 
jp
->
›
 = 
OP_if_Ál£8
 + (› - 
OP_if_Ál£
);

31264 
shrök
;

31266 i‡(
diff
 =(
öt16_t
)dif‡&& 
›
 =
OP_gŸo
) {

31268 
jp
->
size
 = 2;

31269 
dñè
 = 2;

31270 
bc_out
.
buf
[
pos
 - 1] = 
jp
->
›
 = 
OP_gŸo16
;

31271 
shrök
:

31273 
	`memmove
(
bc_out
.
buf
 + 
pos
 + 
jp
->
size
, bc_out.bu‡+Öo†+ jp->sizê+ 
dñè
,

31274 
bc_out
.
size
 - 
pos
 - 
jp
->sizê- 
dñè
);

31275 
bc_out
.
size
 -
dñè
;

31276 
∑tch_off£ts
++;

31277 
j
 = 0, 
ls
 = 
s
->
œbñ_¶Ÿs
; j < s->
œbñ_cou¡
; j++,Üs++) {

31278 i‡(
ls
->
addr
 > 
pos
)

31279 
ls
->
addr
 -
dñè
;

31281 
j
 = 
i
 + 1, 
jp1
 = 
jp
 + 1; j < 
s
->
jump_cou¡
; j++, jp1++) {

31282 i‡(
jp1
->
pos
 >Öos)

31283 
jp1
->
pos
 -
dñè
;

31285 
j
 = 0; j < 
s
->
löe_numbî_cou¡
; j++) {

31286 i‡(
s
->
löe_numbî_¶Ÿs
[
j
].
pc
 > 
pos
)

31287 
s
->
löe_numbî_¶Ÿs
[
j
].
pc
 -
dñè
;

31294 i‡(
∑tch_off£ts
) {

31295 
JumpSlŸ
 *
jp1
;

31296 
j
;

31297 
j
 = 0, 
jp1
 = 
s
->
jump_¶Ÿs
; j < s->
jump_cou¡
; j++, jp1++) {

31298 
diff1
 = 
s
->
œbñ_¶Ÿs
[
jp1
->
œbñ
].
addr
 - jp1->
pos
;

31299 
jp1
->
size
) {

31301 
	`put_u8
(
bc_out
.
buf
 + 
jp1
->
pos
, 
diff1
);

31304 
	`put_u16
(
bc_out
.
buf
 + 
jp1
->
pos
, 
diff1
);

31307 
	`put_u32
(
bc_out
.
buf
 + 
jp1
->
pos
, 
diff1
);

31313 
	`js_‰ì
(
˘x
, 
s
->
jump_¶Ÿs
);

31314 
s
->
jump_¶Ÿs
 = 
NULL
;

31316 
	`js_‰ì
(
˘x
, 
s
->
œbñ_¶Ÿs
);

31317 
s
->
œbñ_¶Ÿs
 = 
NULL
;

31319 
	`compuã_pc2löe_öfo
(
s
);

31320 
	`js_‰ì
(
˘x
, 
s
->
löe_numbî_¶Ÿs
);

31321 
s
->
löe_numbî_¶Ÿs
 = 
NULL
;

31323 
	`dbuf_‰ì
(&
s
->
byã_code
);

31324 
s
->
byã_code
 = 
bc_out
;

31325 
s
->
u£_sh‹t_›codes
 = 
TRUE
;

31326 i‡(
	`dbuf_îr‹
(&
s
->
byã_code
)) {

31327 
	`JS_ThrowOutOfMem‹y
(
˘x
);

31331 
Áû
:

31333 
	`dbuf_‰ì
(&
bc_out
);

31335 
	}
}

31339 
	sSèckSizeSèã
 {

31340 
	m°ack_Àn_max
;

31341 
uöt16_t
 *
	m°ack_Àvñ_èb
;

31342 } 
	tSèckSizeSèã
;

31344 
__ex˚±i⁄
 
	$compuã_°ack_size_ªc
(
JSC⁄ãxt
 *
˘x
,

31345 
JSFun˘i⁄Def
 *
fd
,

31346 
SèckSizeSèã
 *
s
,

31347 
pos
, 
›
, 
°ack_Àn
)

31349 
bc_Àn
, 
diff
, 
n_p›
, 
pos_√xt
;

31350 c⁄° 
JSOpCode
 *
oi
;

31351 c⁄° 
uöt8_t
 *
bc_buf
;

31353 i‡(
°ack_Àn
 > 
s
->
°ack_Àn_max
) {

31354 
s
->
°ack_Àn_max
 = 
°ack_Àn
;

31355 i‡(
s
->
°ack_Àn_max
 > 
JS_STACK_SIZE_MAX
)

31356 
°ack_ovîÊow
;

31358 
bc_buf
 = 
fd
->
byã_code
.
buf
;

31359 
bc_Àn
 = 
fd
->
byã_code
.
size
;

31361 i‡(()
pos
 >
bc_Àn
)

31362 
buf_ovîÊow
;

31364 
	`¥ötf
("%5d: %d\n", 
pos
, 
°ack_Àn
);

31366 i‡(
s
->
°ack_Àvñ_èb
[
pos
] != 0xffff) {

31368 i‡(
s
->
°ack_Àvñ_èb
[
pos
] !
°ack_Àn
) {

31369 
	`JS_ThrowI¡î«lEº‹
(
˘x
, "unconsistent stack size: %d %d (pc=%d)",

31370 
s
->
°ack_Àvñ_èb
[
pos
], 
°ack_Àn
,Öos);

31376 
s
->
°ack_Àvñ_èb
[
pos
] = 
°ack_Àn
;

31379 
›
 = 
bc_buf
[
pos
];

31380 i‡(
›
 =0 || o∞>
OP_COUNT
) {

31381 
	`JS_ThrowI¡î«lEº‹
(
˘x
, "övÆid opcodê(›=%d,Öc=%d)", 
›
, 
pos
);

31384 
oi
 = &
	`sh‹t_›code_öfo
(
›
);

31385 
pos_√xt
 = 
pos
 + 
oi
->
size
;

31386 i‡(
pos_√xt
 > 
bc_Àn
) {

31387 
buf_ovîÊow
:

31388 
	`JS_ThrowI¡î«lEº‹
(
˘x
, "byãcodêbuf„∏ovîÊow (›=%d,Öc=%d)", 
›
, 
pos
);

31391 
n_p›
 = 
oi
->n_pop;

31393 i‡(
oi
->
fmt
 =
OP_FMT_≈›
 || oi->fmà=
OP_FMT_≈›_u16
) {

31394 
n_p›
 +
	`gë_u16
(
bc_buf
 + 
pos
 + 1);

31396 #i‡
SHORT_OPCODES


31397 i‡(
oi
->
fmt
 =
OP_FMT_≈›x
) {

31398 
n_p›
 +
›
 - 
OP_ˇŒ0
;

31403 i‡(
°ack_Àn
 < 
n_p›
) {

31404 
	`JS_ThrowI¡î«lEº‹
(
˘x
, "°ack undîÊow (›=%d,Öc=%d)", 
›
, 
pos
);

31407 
°ack_Àn
 +
oi
->
n_push
 - 
n_p›
;

31408 i‡(
°ack_Àn
 > 
s
->
°ack_Àn_max
) {

31409 
s
->
°ack_Àn_max
 = 
°ack_Àn
;

31410 i‡(
s
->
°ack_Àn_max
 > 
JS_STACK_SIZE_MAX
)

31411 
°ack_ovîÊow
;

31413 
›
) {

31414 
OP_èû_ˇŒ
:

31415 
OP_èû_ˇŒ_mëhod
:

31416 
OP_ªtu∫
:

31417 
OP_ªtu∫_undef
:

31418 
OP_ªtu∫_async
:

31419 
OP_throw
:

31420 
OP_throw_v¨
:

31421 
OP_ªt
:

31422 
d⁄e
;

31423 
OP_gŸo
:

31424 
diff
 = 
	`gë_u32
(
bc_buf
 + 
pos
 + 1);

31425 
pos_√xt
 = 
pos
 + 1 + 
diff
;

31427 #i‡
SHORT_OPCODES


31428 
OP_gŸo16
:

31429 
diff
 = (
öt16_t
)
	`gë_u16
(
bc_buf
 + 
pos
 + 1);

31430 
pos_√xt
 = 
pos
 + 1 + 
diff
;

31432 
OP_gŸo8
:

31433 
diff
 = (
öt8_t
)
bc_buf
[
pos
 + 1];

31434 
pos_√xt
 = 
pos
 + 1 + 
diff
;

31436 
OP_if_åue8
:

31437 
OP_if_Ál£8
:

31438 
diff
 = (
öt8_t
)
bc_buf
[
pos
 + 1];

31439 i‡(
	`compuã_°ack_size_ªc
(
˘x
, 
fd
, 
s
, 
pos
 + 1 + 
diff
, 
›
, 
°ack_Àn
))

31443 
OP_if_åue
:

31444 
OP_if_Ál£
:

31445 
OP_ˇtch
:

31446 
diff
 = 
	`gë_u32
(
bc_buf
 + 
pos
 + 1);

31447 i‡(
	`compuã_°ack_size_ªc
(
˘x
, 
fd
, 
s
, 
pos
 + 1 + 
diff
, 
›
, 
°ack_Àn
))

31450 
OP_gosub
:

31451 
diff
 = 
	`gë_u32
(
bc_buf
 + 
pos
 + 1);

31452 i‡(
	`compuã_°ack_size_ªc
(
˘x
, 
fd
, 
s
, 
pos
 + 1 + 
diff
, 
›
, 
°ack_Àn
 + 1))

31455 
OP_wôh_gë_v¨
:

31456 
OP_wôh_dñëe_v¨
:

31457 
diff
 = 
	`gë_u32
(
bc_buf
 + 
pos
 + 5);

31458 i‡(
	`compuã_°ack_size_ªc
(
˘x
, 
fd
, 
s
, 
pos
 + 5 + 
diff
, 
›
, 
°ack_Àn
 + 1))

31461 
OP_wôh_make_ªf
:

31462 
OP_wôh_gë_ªf
:

31463 
OP_wôh_gë_ªf_undef
:

31464 
diff
 = 
	`gë_u32
(
bc_buf
 + 
pos
 + 5);

31465 i‡(
	`compuã_°ack_size_ªc
(
˘x
, 
fd
, 
s
, 
pos
 + 5 + 
diff
, 
›
, 
°ack_Àn
 + 2))

31468 
OP_wôh_put_v¨
:

31469 
diff
 = 
	`gë_u32
(
bc_buf
 + 
pos
 + 5);

31470 i‡(
	`compuã_°ack_size_ªc
(
˘x
, 
fd
, 
s
, 
pos
 + 5 + 
diff
, 
›
, 
°ack_Àn
 - 1))

31477 
pos
 = 
pos_√xt
;

31479 
d⁄e
:

31482 
°ack_ovîÊow
:

31483 
	`JS_ThrowI¡î«lEº‹
(
˘x
, "°ack ovîÊow (›=%d,Öc=%d)", 
›
, 
pos
);

31485 
	}
}

31487 
__ex˚±i⁄
 
	$compuã_°ack_size
(
JSC⁄ãxt
 *
˘x
,

31488 
JSFun˘i⁄Def
 *
fd
,

31489 *
p°ack_size
)

31491 
SèckSizeSèã
 
s_s
, *
s
 = &s_s;

31492 
bc_Àn
, 
i
, 
ªt
;

31494 
bc_Àn
 = 
fd
->
byã_code
.
size
;

31496 
s
->
°ack_Àvñ_èb
 = 
	`js_mÆloc
(
˘x
, (s->°ack_Àvñ_èb[0]Ë* 
bc_Àn
);

31497 i‡(!
s
->
°ack_Àvñ_èb
)

31499 
i
 = 0; i < 
bc_Àn
; i++)

31500 
s
->
°ack_Àvñ_èb
[
i
] = 0xffff;

31501 
s
->
°ack_Àn_max
 = 0;

31502 
ªt
 = 
	`compuã_°ack_size_ªc
(
˘x
, 
fd
, 
s
, 0, 
OP_övÆid
, 0);

31503 
	`js_‰ì
(
˘x
, 
s
->
°ack_Àvñ_èb
);

31504 *
p°ack_size
 = 
s
->
°ack_Àn_max
;

31505  
ªt
;

31506 
	}
}

31508 
	$add_moduÀ_v¨übÀs
(
JSC⁄ãxt
 *
˘x
, 
JSFun˘i⁄Def
 *
fd
)

31510 
i
, 
idx
;

31511 
JSModuÀDef
 *
m
 = 
fd
->
moduÀ
;

31512 
JSExp‹tE¡ry
 *
me
;

31513 
JSHoi°edDef
 *
hf
;

31519 
i
 = 0; i < 
fd
->
hoi°ed_def_cou¡
; i++) {

31520 
hf
 = &
fd
->
hoi°ed_def
[
i
];

31521 i‡(
	`add_˛osuª_v¨
(
˘x
, 
fd
, 
TRUE
, 
FALSE
, 
i
, 
hf
->
v¨_«me
, hf->
is_c⁄°
,

31522 
hf
->
is_Àxiˇl
, 
FALSE
) < 0)

31527 
i
 = 0; i < 
m
->
exp‹t_íåõs_cou¡
; i++) {

31528 
me
 = &
m
->
exp‹t_íåõs
[
i
];

31529 i‡(
me
->
exp‹t_ty≥
 =
JS_EXPORT_TYPE_LOCAL
) {

31530 
idx
 = 
	`föd_˛osuª_v¨
(
˘x
, 
fd
, 
me
->
loˇl_«me
);

31531 i‡(
idx
 < 0) {

31532 
buf1
[
ATOM_GET_STR_BUF_SIZE
];

31533 
	`JS_ThrowSy¡axEº‹
(
˘x
, "exported variable '%s' doesÇotÉxist",

31534 
	`JS_AtomGëSå
(
˘x
, 
buf1
, (buf1), 
me
->
loˇl_«me
));

31537 
me
->
u
.
loˇl
.
v¨_idx
 = 
idx
;

31541 
	}
}

31546 
JSVÆue
 
	$js_¸óã_fun˘i⁄
(
JSC⁄ãxt
 *
˘x
, 
JSFun˘i⁄Def
 *
fd
)

31548 
JSVÆue
 
func_obj
;

31549 
JSFun˘i⁄Byãcode
 *
b
;

31550 
li°_hód
 *
ñ
, *
ñ1
;

31551 
°ack_size
, 
sc›e
, 
idx
;

31552 
fun˘i⁄_size
, 
byã_code_off£t
, 
˝oﬁ_off£t
;

31553 
˛osuª_v¨_off£t
, 
v¨defs_off£t
;

31556 
sc›e
 = 0; sc›ê< 
fd
->
sc›e_cou¡
; scope++) {

31557 
fd
->
sc›es
[
sc›e
].
fú°
 = -1;

31559 
idx
 = 0; idx < 
fd
->
v¨_cou¡
; idx++) {

31560 
JSV¨Def
 *
vd
 = &
fd
->
v¨s
[
idx
];

31561 
vd
->
sc›e_√xt
 = 
fd
->
sc›es
[vd->
sc›e_Àvñ
].
fú°
;

31562 
fd
->
sc›es
[
vd
->
sc›e_Àvñ
].
fú°
 = 
idx
;

31564 
sc›e
 = 2; sc›ê< 
fd
->
sc›e_cou¡
; scope++) {

31565 
JSV¨Sc›e
 *
sd
 = &
fd
->
sc›es
[
sc›e
];

31566 i‡(
sd
->
fú°
 == -1)

31567 
sd
->
fú°
 = 
fd
->
sc›es
[sd->
∑ª¡
].first;

31569 
idx
 = 0; idx < 
fd
->
v¨_cou¡
; idx++) {

31570 
JSV¨Def
 *
vd
 = &
fd
->
v¨s
[
idx
];

31571 i‡(
vd
->
sc›e_√xt
 =-1 && vd->
sc›e_Àvñ
 > 1) {

31572 
sc›e
 = 
fd
->
sc›es
[
vd
->
sc›e_Àvñ
].
∑ª¡
;

31573 
vd
->
sc›e_√xt
 = 
fd
->
sc›es
[
sc›e
].
fú°
;

31581 i‡(
fd
->
has_evÆ_ˇŒ
)

31582 
	`add_evÆ_v¨übÀs
(
˘x
, 
fd
);

31585 i‡(
fd
->
moduÀ
) {

31586 i‡(
	`add_moduÀ_v¨übÀs
(
˘x
, 
fd
))

31587 
Áû
;

31591 
	`li°_f‹_óch_ß„
(
ñ
, 
ñ1
, &
fd
->
chûd_li°
) {

31592 
JSFun˘i⁄Def
 *
fd1
;

31593 
˝oﬁ_idx
;

31595 
fd1
 = 
	`li°_íåy
(
ñ
, 
JSFun˘i⁄Def
, 
lök
);

31596 
˝oﬁ_idx
 = 
fd1
->
∑ª¡_˝oﬁ_idx
;

31597 
func_obj
 = 
	`js_¸óã_fun˘i⁄
(
˘x
, 
fd1
);

31598 i‡(
	`JS_IsEx˚±i⁄
(
func_obj
))

31599 
Áû
;

31601 
	`as£π
(
˝oﬁ_idx
 >= 0);

31602 
fd
->
˝oﬁ
[
˝oﬁ_idx
] = 
func_obj
;

31605 #i‡
	`deföed
(
DUMP_BYTECODE
) && (DUMP_BYTECODE & 4)

31606 i‡(!(
fd
->
js_mode
 & 
JS_MODE_STRIP
)) {

31607 
	`¥ötf
("pass 1\n");

31608 
	`dump_byã_code
(
˘x
, 1, 
fd
->
byã_code
.
buf
, fd->byã_code.
size
,

31609 
fd
->
¨gs
, fd->
¨g_cou¡
, fd->
v¨s
, fd->
v¨_cou¡
,

31610 
fd
->
˛osuª_v¨
, fd->
˛osuª_v¨_cou¡
,

31611 
fd
->
˝oﬁ
, fd->
˝oﬁ_cou¡
, fd->
sour˚
, fd->
löe_num
,

31612 
fd
->
œbñ_¶Ÿs
, 
NULL
);

31613 
	`¥ötf
("\n");

31617 i‡(
	`ªsﬁve_v¨übÀs
(
˘x
, 
fd
))

31618 
Áû
;

31620 #i‡
	`deföed
(
DUMP_BYTECODE
) && (DUMP_BYTECODE & 2)

31621 i‡(!(
fd
->
js_mode
 & 
JS_MODE_STRIP
)) {

31622 
	`¥ötf
("pass 2\n");

31623 
	`dump_byã_code
(
˘x
, 2, 
fd
->
byã_code
.
buf
, fd->byã_code.
size
,

31624 
fd
->
¨gs
, fd->
¨g_cou¡
, fd->
v¨s
, fd->
v¨_cou¡
,

31625 
fd
->
˛osuª_v¨
, fd->
˛osuª_v¨_cou¡
,

31626 
fd
->
˝oﬁ
, fd->
˝oﬁ_cou¡
, fd->
sour˚
, fd->
löe_num
,

31627 
fd
->
œbñ_¶Ÿs
, 
NULL
);

31628 
	`¥ötf
("\n");

31632 i‡(
	`ªsﬁve_œbñs
(
˘x
, 
fd
))

31633 
Áû
;

31635 i‡(
	`compuã_°ack_size
(
˘x
, 
fd
, &
°ack_size
) < 0)

31636 
Áû
;

31638 i‡(
fd
->
js_mode
 & 
JS_MODE_STRIP
) {

31639 
fun˘i⁄_size
 = 
	`off£tof
(
JSFun˘i⁄Byãcode
, 
debug
);

31641 
fun˘i⁄_size
 = (*
b
);

31643 
˝oﬁ_off£t
 = 
fun˘i⁄_size
;

31644 
fun˘i⁄_size
 +
fd
->
˝oﬁ_cou¡
 * (*fd->
˝oﬁ
);

31645 
v¨defs_off£t
 = 
fun˘i⁄_size
;

31646 i‡(!(
fd
->
js_mode
 & 
JS_MODE_STRIP
Ë|| fd->
has_evÆ_ˇŒ
) {

31647 
fun˘i⁄_size
 +(
fd
->
¨g_cou¡
 + fd->
v¨_cou¡
Ë* (*
b
->
v¨defs
);

31649 
˛osuª_v¨_off£t
 = 
fun˘i⁄_size
;

31650 
fun˘i⁄_size
 +
fd
->
˛osuª_v¨_cou¡
 * (*fd->
˛osuª_v¨
);

31651 
byã_code_off£t
 = 
fun˘i⁄_size
;

31652 
fun˘i⁄_size
 +
fd
->
byã_code
.
size
;

31654 
b
 = 
	`js_mÆlocz
(
˘x
, 
fun˘i⁄_size
);

31655 i‡(!
b
)

31656 
Áû
;

31657 
b
->
hódî
.
ªf_cou¡
 = 1;

31659 
b
->
byã_code_buf
 = (*)((
uöt8_t
*)b + 
byã_code_off£t
);

31660 
b
->
byã_code_Àn
 = 
fd
->
byã_code
.
size
;

31661 
	`mem˝y
(
b
->
byã_code_buf
, 
fd
->
byã_code
.
buf
, fd->byã_code.
size
);

31662 
	`js_‰ì
(
˘x
, 
fd
->
byã_code
.
buf
);

31663 
fd
->
byã_code
.
buf
 = 
NULL
;

31665 
b
->
func_«me
 = 
fd
->func_name;

31666 i‡(
fd
->
¨g_cou¡
 + fd->
v¨_cou¡
 > 0) {

31667 i‡((
fd
->
js_mode
 & 
JS_MODE_STRIP
Ë&& !fd->
has_evÆ_ˇŒ
) {

31669 
i
;

31670 
i
 = 0; i < 
fd
->
v¨_cou¡
; i++) {

31671 
	`JS_FªeAtom
(
˘x
, 
fd
->
v¨s
[
i
].
v¨_«me
);

31673 
i
 = 0; i < 
fd
->
¨g_cou¡
; i++) {

31674 
	`JS_FªeAtom
(
˘x
, 
fd
->
¨gs
[
i
].
v¨_«me
);

31676 
i
 = 0; i < 
fd
->
˛osuª_v¨_cou¡
; i++) {

31677 
	`JS_FªeAtom
(
˘x
, 
fd
->
˛osuª_v¨
[
i
].
v¨_«me
);

31678 
fd
->
˛osuª_v¨
[
i
].
v¨_«me
 = 
JS_ATOM_NULL
;

31681 
b
->
v¨defs
 = (*)((
uöt8_t
*)b + 
v¨defs_off£t
);

31682 
	`mem˝y
(
b
->
v¨defs
, 
fd
->
¨gs
, fd->
¨g_cou¡
 * (fd->args[0]));

31683 
	`mem˝y
(
b
->
v¨defs
 + 
fd
->
¨g_cou¡
, fd->
v¨s
, fd->
v¨_cou¡
 * (fd->vars[0]));

31685 
b
->
v¨_cou¡
 = 
fd
->var_count;

31686 
b
->
¨g_cou¡
 = 
fd
->arg_count;

31687 
b
->
deföed_¨g_cou¡
 = 
fd
->defined_arg_count;

31688 
	`js_‰ì
(
˘x
, 
fd
->
¨gs
);

31689 
	`js_‰ì
(
˘x
, 
fd
->
v¨s
);

31691 
b
->
˝oﬁ_cou¡
 = 
fd
->cpool_count;

31692 i‡(
b
->
˝oﬁ_cou¡
) {

31693 
b
->
˝oﬁ
 = (*)((
uöt8_t
*)b + 
˝oﬁ_off£t
);

31694 
	`mem˝y
(
b
->
˝oﬁ
, 
fd
->˝oﬁ, b->
˝oﬁ_cou¡
 * (*b->cpool));

31696 
	`js_‰ì
(
˘x
, 
fd
->
˝oﬁ
);

31697 
fd
->
˝oﬁ
 = 
NULL
;

31699 
b
->
°ack_size
 = stack_size;

31701 i‡(
fd
->
js_mode
 & 
JS_MODE_STRIP
) {

31702 
	`JS_FªeAtom
(
˘x
, 
fd
->
fûíame
);

31703 
	`dbuf_‰ì
(&
fd
->
pc2löe
);

31708 
b
->
has_debug
 = 1;

31709 
b
->
debug
.
fûíame
 = 
fd
->filename;

31710 
b
->
debug
.
löe_num
 = 
fd
->line_num;

31715 
b
->
debug
.
pc2löe_buf
 = 
	`js_ªÆloc
(
˘x
, 
fd
->
pc2löe
.
buf
, fd->pc2löe.
size
);

31716 i‡(!
b
->
debug
.
pc2löe_buf
)

31717 
b
->
debug
.
pc2löe_buf
 = 
fd
->
pc2löe
.
buf
;

31718 
b
->
debug
.
pc2löe_Àn
 = 
fd
->
pc2löe
.
size
;

31719 
b
->
debug
.
sour˚
 = 
fd
->source;

31720 
b
->
debug
.
sour˚_Àn
 = 
fd
->source_len;

31722 i‡(
fd
->
sc›es
 !fd->
def_sc›e_¨øy
)

31723 
	`js_‰ì
(
˘x
, 
fd
->
sc›es
);

31725 
b
->
˛osuª_v¨_cou¡
 = 
fd
->closure_var_count;

31726 i‡(
b
->
˛osuª_v¨_cou¡
) {

31727 
b
->
˛osuª_v¨
 = (*)((
uöt8_t
*)b + 
˛osuª_v¨_off£t
);

31728 
	`mem˝y
(
b
->
˛osuª_v¨
, 
fd
->˛osuª_v¨, b->
˛osuª_v¨_cou¡
 * (*b->closure_var));

31730 
	`js_‰ì
(
˘x
, 
fd
->
˛osuª_v¨
);

31731 
fd
->
˛osuª_v¨
 = 
NULL
;

31733 
b
->
has_¥ŸŸy≥
 = 
fd
->has_prototype;

31734 
b
->
has_sim∂e_∑ømëî_li°
 = 
fd
->has_simple_parameter_list;

31735 
b
->
js_mode
 = 
fd
->js_mode;

31736 
b
->
is_dîived_˛ass_c⁄°ru˘‹
 = 
fd
->is_derived_class_constructor;

31737 
b
->
func_köd
 = 
fd
->func_kind;

31738 
b
->
√ed_home_obje˘
 = (
fd
->
home_obje˘_v¨_idx
 >= 0 ||

31739 
fd
->
√ed_home_obje˘
);

31740 
b
->
√w_èrgë_Ælowed
 = 
fd
->new_target_allowed;

31741 
b
->
su≥r_ˇŒ_Ælowed
 = 
fd
->super_call_allowed;

31742 
b
->
su≥r_Ælowed
 = 
fd
->super_allowed;

31743 
b
->
¨gumíts_Ælowed
 = 
fd
->arguments_allowed;

31744 
b
->
backåa˚_b¨rõr
 = 
fd
->backtrace_barrier;

31745 
b
->
ªÆm
 = 
	`JS_DupC⁄ãxt
(
˘x
);

31747 
	`add_gc_obje˘
(
˘x
->
π
, &
b
->
hódî
, 
JS_GC_OBJ_TYPE_FUNCTION_BYTECODE
);

31749 #i‡
	`deföed
(
DUMP_BYTECODE
) && (DUMP_BYTECODE & 1)

31750 i‡(!(
fd
->
js_mode
 & 
JS_MODE_STRIP
)) {

31751 
	`js_dump_fun˘i⁄_byãcode
(
˘x
, 
b
);

31755 i‡(
fd
->
∑ª¡
) {

31757 
	`li°_dñ
(&
fd
->
lök
);

31760 
	`js_‰ì
(
˘x
, 
fd
);

31761  
	`JS_MKPTR
(
JS_TAG_FUNCTION_BYTECODE
, 
b
);

31762 
Áû
:

31763 
	`js_‰ì_fun˘i⁄_def
(
˘x
, 
fd
);

31764  
JS_EXCEPTION
;

31765 
	}
}

31767 
	$‰ì_fun˘i⁄_byãcode
(
JSRu¡ime
 *
π
, 
JSFun˘i⁄Byãcode
 *
b
)

31769 
i
;

31773 
buf
[
ATOM_GET_STR_BUF_SIZE
];

31774 
	`¥ötf
("freeing %s\n",

31775 
	`JS_AtomGëSåRT
(
π
, 
buf
, (buf), 
b
->
func_«me
));

31778 
	`‰ì_byãcode_©oms
(
π
, 
b
->
byã_code_buf
, b->
byã_code_Àn
, 
TRUE
);

31780 i‡(
b
->
v¨defs
) {

31781 
i
 = 0; i < 
b
->
¨g_cou¡
 + b->
v¨_cou¡
; i++) {

31782 
	`JS_FªeAtomRT
(
π
, 
b
->
v¨defs
[
i
].
v¨_«me
);

31785 
i
 = 0; i < 
b
->
˝oﬁ_cou¡
; i++)

31786 
	`JS_FªeVÆueRT
(
π
, 
b
->
˝oﬁ
[
i
]);

31788 
i
 = 0; i < 
b
->
˛osuª_v¨_cou¡
; i++) {

31789 
JSClosuªV¨
 *
cv
 = &
b
->
˛osuª_v¨
[
i
];

31790 
	`JS_FªeAtomRT
(
π
, 
cv
->
v¨_«me
);

31792 i‡(
b
->
ªÆm
)

31793 
	`JS_FªeC⁄ãxt
(
b
->
ªÆm
);

31795 
	`JS_FªeAtomRT
(
π
, 
b
->
func_«me
);

31796 i‡(
b
->
has_debug
) {

31797 
	`JS_FªeAtomRT
(
π
, 
b
->
debug
.
fûíame
);

31798 
	`js_‰ì_π
(
π
, 
b
->
debug
.
pc2löe_buf
);

31799 
	`js_‰ì_π
(
π
, 
b
->
debug
.
sour˚
);

31802 
	`ªmove_gc_obje˘
(&
b
->
hódî
);

31803 i‡(
π
->
gc_pha£
 =
JS_GC_PHASE_REMOVE_CYCLES
 && 
b
->
hódî
.
ªf_cou¡
 != 0) {

31804 
	`li°_add_èû
(&
b
->
hódî
.
lök
, &
π
->
gc_zîo_ªf_cou¡_li°
);

31806 
	`js_‰ì_π
(
π
, 
b
);

31808 
	}
}

31810 
__ex˚±i⁄
 
	$js_∑r£_dúe˘ives
(
JSP¨£Sèã
 *
s
)

31812 
°r
[20];

31813 
JSP¨£Pos
 
pos
;

31814 
BOOL
 
has_£mi
;

31816 i‡(
s
->
tokí
.
vÆ
 !
TOK_STRING
)

31819 
	`js_∑r£_gë_pos
(
s
, &
pos
);

31821 
s
->
tokí
.
vÆ
 =
TOK_STRING
) {

31823 
	`¢¥ötf
(
°r
,  str, "%.*s",

31824 ()(
s
->
buf_±r
 - s->
tokí
.
±r
 - 2), s->token.ptr + 1);

31826 i‡(
	`√xt_tokí
(
s
))

31829 
has_£mi
 = 
FALSE
;

31830 
s
->
tokí
.
vÆ
) {

31832 i‡(
	`√xt_tokí
(
s
))

31834 
has_£mi
 = 
TRUE
;

31837 
TOK_EOF
:

31838 
has_£mi
 = 
TRUE
;

31840 
TOK_NUMBER
:

31841 
TOK_STRING
:

31842 
TOK_TEMPLATE
:

31843 
TOK_IDENT
:

31844 
TOK_REGEXP
:

31845 
TOK_DEC
:

31846 
TOK_INC
:

31847 
TOK_NULL
:

31848 
TOK_FALSE
:

31849 
TOK_TRUE
:

31850 
TOK_IF
:

31851 
TOK_RETURN
:

31852 
TOK_VAR
:

31853 
TOK_THIS
:

31854 
TOK_DELETE
:

31855 
TOK_TYPEOF
:

31856 
TOK_NEW
:

31857 
TOK_DO
:

31858 
TOK_WHILE
:

31859 
TOK_FOR
:

31860 
TOK_SWITCH
:

31861 
TOK_THROW
:

31862 
TOK_TRY
:

31863 
TOK_FUNCTION
:

31864 
TOK_DEBUGGER
:

31865 
TOK_WITH
:

31866 
TOK_CLASS
:

31867 
TOK_CONST
:

31868 
TOK_ENUM
:

31869 
TOK_EXPORT
:

31870 
TOK_IMPORT
:

31871 
TOK_SUPER
:

31872 
TOK_INTERFACE
:

31873 
TOK_LET
:

31874 
TOK_PACKAGE
:

31875 
TOK_PRIVATE
:

31876 
TOK_PROTECTED
:

31877 
TOK_PUBLIC
:

31878 
TOK_STATIC
:

31880 i‡(
s
->
gŸ_lf
)

31881 
has_£mi
 = 
TRUE
;

31886 i‡(!
has_£mi
)

31888 i‡(!
	`°rcmp
(
°r
, "use strict")) {

31889 
s
->
cur_func
->
has_u£_°ri˘
 = 
TRUE
;

31890 
s
->
cur_func
->
js_mode
 |
JS_MODE_STRICT
;

31892 #i‡!
	`deföed
(
DUMP_BYTECODE
) || !(DUMP_BYTECODE & 8)

31893 i‡(!
	`°rcmp
(
°r
, "use strip")) {

31894 
s
->
cur_func
->
js_mode
 |
JS_MODE_STRIP
;

31897 #ifde‡
CONFIG_BIGNUM


31898 i‡(
s
->
˘x
->
bignum_ext
 && !
	`°rcmp
(
°r
, "use math")) {

31899 
s
->
cur_func
->
js_mode
 |
JS_MODE_MATH
;

31903  
	`js_∑r£_£ek_tokí
(
s
, &
pos
);

31904 
	}
}

31906 
	$js_∑r£_fun˘i⁄_check_«mes
(
JSP¨£Sèã
 *
s
, 
JSFun˘i⁄Def
 *
fd
,

31907 
JSAtom
 
func_«me
)

31909 
JSAtom
 
«me
;

31910 
i
, 
idx
;

31912 i‡(
fd
->
js_mode
 & 
JS_MODE_STRICT
) {

31913 i‡(!
fd
->
has_sim∂e_∑ømëî_li°
 && fd->
has_u£_°ri˘
) {

31914  
	`js_∑r£_îr‹
(
s
, "\"use strict\"Çotállowed in function with default or destructuringÖarameter");

31916 i‡(
func_«me
 =
JS_ATOM_evÆ
 || func_«mê=
JS_ATOM_¨gumíts
) {

31917  
	`js_∑r£_îr‹
(
s
, "invalid functionÇame in strict code");

31919 
idx
 = 0; idx < 
fd
->
¨g_cou¡
; idx++) {

31920 
«me
 = 
fd
->
¨gs
[
idx
].
v¨_«me
;

31922 i‡(
«me
 =
JS_ATOM_evÆ
 ||Çamê=
JS_ATOM_¨gumíts
) {

31923  
	`js_∑r£_îr‹
(
s
, "invalidárgumentÇame in strict code");

31928 i‡((
fd
->
js_mode
 & 
JS_MODE_STRICT
)

31929 || !
fd
->
has_sim∂e_∑ømëî_li°


31930 || (
fd
->
func_ty≥
 =
JS_PARSE_FUNC_METHOD
 && fd->
func_köd
 =
JS_FUNC_ASYNC
)

31931 || 
fd
->
func_ty≥
 =
JS_PARSE_FUNC_ARROW


31932 || 
fd
->
func_ty≥
 =
JS_PARSE_FUNC_METHOD
) {

31933 
idx
 = 0; idx < 
fd
->
¨g_cou¡
; idx++) {

31934 
«me
 = 
fd
->
¨gs
[
idx
].
v¨_«me
;

31935 i‡(
«me
 !
JS_ATOM_NULL
) {

31936 
i
 = 0; i < 
idx
; i++) {

31937 i‡(
fd
->
¨gs
[
i
].
v¨_«me
 =
«me
)

31938 
du∂iˇã
;

31942 
i
 = 0; i < 
fd
->
v¨_cou¡
; i++) {

31943 i‡(
fd
->
v¨s
[
i
].
v¨_«me
 =
«me
)

31944 
du∂iˇã
;

31951 
du∂iˇã
:

31952  
	`js_∑r£_îr‹
(
s
, "duplicateárgumentÇamesÇotállowed inÅhis context");

31953 
	}
}

31956 
JSFun˘i⁄Def
 *
	$js_∑r£_fun˘i⁄_˛ass_fõlds_öô
(
JSP¨£Sèã
 *
s
)

31958 
JSFun˘i⁄Def
 *
fd
;

31960 
fd
 = 
	`js_√w_fun˘i⁄_def
(
s
->
˘x
, s->
cur_func
, 
FALSE
, FALSE,

31961 
s
->
fûíame
, 0);

31962 i‡(!
fd
)

31963  
NULL
;

31964 
fd
->
func_«me
 = 
JS_ATOM_NULL
;

31965 
fd
->
has_¥ŸŸy≥
 = 
FALSE
;

31966 
fd
->
has_home_obje˘
 = 
TRUE
;

31968 
fd
->
has_¨gumíts_bödög
 = 
FALSE
;

31969 
fd
->
has_this_bödög
 = 
TRUE
;

31970 
fd
->
is_dîived_˛ass_c⁄°ru˘‹
 = 
FALSE
;

31971 
fd
->
√w_èrgë_Ælowed
 = 
TRUE
;

31972 
fd
->
su≥r_ˇŒ_Ælowed
 = 
FALSE
;

31973 
fd
->
su≥r_Ælowed
 = fd->
has_home_obje˘
;

31974 
fd
->
¨gumíts_Ælowed
 = 
FALSE
;

31976 
fd
->
func_köd
 = 
JS_FUNC_NORMAL
;

31977 
fd
->
func_ty≥
 = 
JS_PARSE_FUNC_METHOD
;

31978  
fd
;

31979 
	}
}

31983 
__ex˚±i⁄
 
	$js_∑r£_fun˘i⁄_de˛2
(
JSP¨£Sèã
 *
s
,

31984 
JSP¨£Fun˘i⁄Enum
 
func_ty≥
,

31985 
JSFun˘i⁄KödEnum
 
func_köd
,

31986 
JSAtom
 
func_«me
,

31987 c⁄° 
uöt8_t
 *
±r
,

31988 
fun˘i⁄_löe_num
,

31989 
JSP¨£Exp‹tEnum
 
exp‹t_Êag
,

31990 
JSFun˘i⁄Def
 **
pfd
)

31992 
JSC⁄ãxt
 *
˘x
 = 
s
->ctx;

31993 
JSFun˘i⁄Def
 *
fd
 = 
s
->
cur_func
;

31994 
BOOL
 
is_ex¥
;

31995 
func_idx
, 
Àxiˇl_func_idx
 = -1;

31996 
BOOL
 
has_›t_¨g
;

31997 
BOOL
 
¸óã_func_v¨
 = 
FALSE
;

31999 
is_ex¥
 = (
func_ty≥
 !
JS_PARSE_FUNC_STATEMENT
 &&

32000 
func_ty≥
 !
JS_PARSE_FUNC_VAR
);

32002 i‡(
func_ty≥
 =
JS_PARSE_FUNC_STATEMENT
 ||

32003 
func_ty≥
 =
JS_PARSE_FUNC_VAR
 ||

32004 
func_ty≥
 =
JS_PARSE_FUNC_EXPR
) {

32005 i‡(
func_köd
 =
JS_FUNC_NORMAL
 &&

32006 
	`tokí_is_p£udo_keyw‹d
(
s
, 
JS_ATOM_async
) &&

32007 
	`≥ek_tokí
(
s
, 
TRUE
) != '\n') {

32008 i‡(
	`√xt_tokí
(
s
))

32010 
func_köd
 = 
JS_FUNC_ASYNC
;

32012 i‡(
	`√xt_tokí
(
s
))

32014 i‡(
s
->
tokí
.
vÆ
 == '*') {

32015 i‡(
	`√xt_tokí
(
s
))

32017 
func_köd
 |
JS_FUNC_GENERATOR
;

32020 i‡(
s
->
tokí
.
vÆ
 =
TOK_IDENT
) {

32021 i‡(
s
->
tokí
.
u
.
idít
.
is_ª£rved
 ||

32022 (
s
->
tokí
.
u
.
idít
.
©om
 =
JS_ATOM_yõld
 &&

32023 
func_ty≥
 =
JS_PARSE_FUNC_EXPR
 &&

32024 (
func_köd
 & 
JS_FUNC_GENERATOR
)) ||

32025 (
s
->
tokí
.
u
.
idít
.
©om
 =
JS_ATOM_awaô
 &&

32026 
func_ty≥
 =
JS_PARSE_FUNC_EXPR
 &&

32027 (
func_köd
 & 
JS_FUNC_ASYNC
))) {

32028  
	`js_∑r£_îr‹_ª£rved_idítifõr
(
s
);

32031 i‡(
s
->
tokí
.
vÆ
 =
TOK_IDENT
 ||

32032 (((
s
->
tokí
.
vÆ
 =
TOK_YIELD
 && !(
fd
->
js_mode
 & 
JS_MODE_STRICT
)) ||

32033 (
s
->
tokí
.
vÆ
 =
TOK_AWAIT
 && !s->
is_moduÀ
)) &&

32034 
func_ty≥
 =
JS_PARSE_FUNC_EXPR
)) {

32035 
func_«me
 = 
	`JS_DupAtom
(
˘x
, 
s
->
tokí
.
u
.
idít
.
©om
);

32036 i‡(
	`√xt_tokí
(
s
)) {

32037 
	`JS_FªeAtom
(
˘x
, 
func_«me
);

32041 i‡(
func_ty≥
 !
JS_PARSE_FUNC_EXPR
 &&

32042 
exp‹t_Êag
 !
JS_PARSE_EXPORT_DEFAULT
) {

32043  
	`js_∑r£_îr‹
(
s
, "functionÇameÉxpected");

32046 } i‡(
func_ty≥
 !
JS_PARSE_FUNC_ARROW
) {

32047 
func_«me
 = 
	`JS_DupAtom
(
˘x
, func_name);

32050 i‡(
fd
->
is_evÆ
 && fd->
evÆ_ty≥
 =
JS_EVAL_TYPE_MODULE
 &&

32051 (
func_ty≥
 =
JS_PARSE_FUNC_STATEMENT
 || func_ty≥ =
JS_PARSE_FUNC_VAR
)) {

32052 
JSHoi°edDef
 *
hf
;

32053 
hf
 = 
	`föd_hoi°ed_def
(
fd
, 
func_«me
);

32055 i‡(
hf
 && hf->
sc›e_Àvñ
 =
fd
->scope_level) {

32056 
	`js_∑r£_îr‹
(
s
, "invalidÑedefinition of global identifier in module code");

32057 
	`JS_FªeAtom
(
˘x
, 
func_«me
);

32062 i‡(
func_ty≥
 =
JS_PARSE_FUNC_VAR
) {

32064 i‡(!(
fd
->
js_mode
 & 
JS_MODE_STRICT
)

32065 && 
	`föd_Àxiˇl_de˛
(
˘x
, 
fd
, 
func_«me
, fd->
sc›e_fú°
, 
FALSE
) < 0

32066 && !((
func_idx
 = 
	`föd_v¨
(
˘x
, 
fd
, 
func_«me
)Ë>0 && (func_idx & 
ARGUMENT_VAR_OFFSET
))

32067 && !(
func_«me
 =
JS_ATOM_¨gumíts
 && 
fd
->
has_¨gumíts_bödög
)) {

32068 
¸óã_func_v¨
 = 
TRUE
;

32070 i‡(
fd
->
is_evÆ
 &&

32071 (
fd
->
evÆ_ty≥
 =
JS_EVAL_TYPE_GLOBAL
 ||

32072 
fd
->
evÆ_ty≥
 =
JS_EVAL_TYPE_MODULE
) &&

32073 
fd
->
sc›e_Àvñ
 == 1) {

32076 
JSHoi°edDef
 *
hf
;

32077 
hf
 = 
	`föd_hoi°ed_def
(
fd
, 
func_«me
);

32079 i‡(
hf
 && hf->
sc›e_Àvñ
 =
fd
->scope_level) {

32080 
	`js_∑r£_îr‹
(
s
, "invalidÑedefinition of global identifier");

32081 
	`JS_FªeAtom
(
˘x
, 
func_«me
);

32088 
Àxiˇl_func_idx
 = 
	`deföe_v¨
(
s
, 
fd
, 
func_«me
,

32089 
func_köd
 !
JS_FUNC_NORMAL
 ?

32090 
JS_VAR_DEF_NEW_FUNCTION_DECL
 :

32091 
JS_VAR_DEF_FUNCTION_DECL
);

32092 i‡(
Àxiˇl_func_idx
 < 0) {

32093 
	`JS_FªeAtom
(
˘x
, 
func_«me
);

32099 
fd
 = 
	`js_√w_fun˘i⁄_def
(
˘x
, fd, 
FALSE
, 
is_ex¥
,

32100 
s
->
fûíame
, 
fun˘i⁄_löe_num
);

32101 i‡(!
fd
) {

32102 
	`JS_FªeAtom
(
˘x
, 
func_«me
);

32105 i‡(
pfd
)

32106 *
pfd
 = 
fd
;

32107 
s
->
cur_func
 = 
fd
;

32108 
fd
->
func_«me
 = func_name;

32110 
fd
->
has_¥ŸŸy≥
 = (
func_ty≥
 =
JS_PARSE_FUNC_STATEMENT
 ||

32111 
func_ty≥
 =
JS_PARSE_FUNC_VAR
 ||

32112 
func_ty≥
 =
JS_PARSE_FUNC_EXPR
) &&

32113 
func_köd
 =
JS_FUNC_NORMAL
;

32114 
fd
->
has_home_obje˘
 = (
func_ty≥
 =
JS_PARSE_FUNC_METHOD
 ||

32115 
func_ty≥
 =
JS_PARSE_FUNC_GETTER
 ||

32116 
func_ty≥
 =
JS_PARSE_FUNC_SETTER
 ||

32117 
func_ty≥
 =
JS_PARSE_FUNC_CLASS_CONSTRUCTOR
 ||

32118 
func_ty≥
 =
JS_PARSE_FUNC_DERIVED_CLASS_CONSTRUCTOR
);

32119 
fd
->
has_¨gumíts_bödög
 = (
func_ty≥
 !
JS_PARSE_FUNC_ARROW
);

32120 
fd
->
has_this_bödög
 = fd->
has_¨gumíts_bödög
;

32121 
fd
->
is_dîived_˛ass_c⁄°ru˘‹
 = (
func_ty≥
 =
JS_PARSE_FUNC_DERIVED_CLASS_CONSTRUCTOR
);

32122 i‡(
func_ty≥
 =
JS_PARSE_FUNC_ARROW
) {

32123 
fd
->
√w_èrgë_Ælowed
 = fd->
∑ª¡
->new_target_allowed;

32124 
fd
->
su≥r_ˇŒ_Ælowed
 = fd->
∑ª¡
->super_call_allowed;

32125 
fd
->
su≥r_Ælowed
 = fd->
∑ª¡
->super_allowed;

32126 
fd
->
¨gumíts_Ælowed
 = fd->
∑ª¡
->arguments_allowed;

32128 
fd
->
√w_èrgë_Ælowed
 = 
TRUE
;

32129 
fd
->
su≥r_ˇŒ_Ælowed
 = fd->
is_dîived_˛ass_c⁄°ru˘‹
;

32130 
fd
->
su≥r_Ælowed
 = fd->
has_home_obje˘
;

32131 
fd
->
¨gumíts_Ælowed
 = 
TRUE
;

32137 
fd
->
func_köd
 = func_kind;

32138 
fd
->
func_ty≥
 = func_type;

32140 i‡(
func_ty≥
 =
JS_PARSE_FUNC_CLASS_CONSTRUCTOR
 ||

32141 
func_ty≥
 =
JS_PARSE_FUNC_DERIVED_CLASS_CONSTRUCTOR
) {

32143 
	`emô_›
(
s
, 
OP_check_˘‹
);

32146 i‡(
func_ty≥
 =
JS_PARSE_FUNC_CLASS_CONSTRUCTOR
) {

32147 
	`emô_˛ass_fõld_öô
(
s
);

32151 
fd
->
has_sim∂e_∑ømëî_li°
 = 
TRUE
;

32152 
has_›t_¨g
 = 
FALSE
;

32153 i‡(
func_ty≥
 =
JS_PARSE_FUNC_ARROW
 && 
s
->
tokí
.
vÆ
 =
TOK_IDENT
) {

32154 
JSAtom
 
«me
;

32155 i‡(
s
->
tokí
.
u
.
idít
.
is_ª£rved
) {

32156 
	`js_∑r£_îr‹_ª£rved_idítifõr
(
s
);

32157 
Áû
;

32159 
«me
 = 
s
->
tokí
.
u
.
idít
.
©om
;

32160 i‡(
	`add_¨g
(
˘x
, 
fd
, 
«me
) < 0)

32161 
Áû
;

32162 
fd
->
deföed_¨g_cou¡
 = 1;

32164 i‡(
	`js_∑r£_ex≥˘
(
s
, '('))

32165 
Áû
;

32167 
s
->
tokí
.
vÆ
 != ')') {

32168 
JSAtom
 
«me
;

32169 
BOOL
 
ª°
 = 
FALSE
;

32170 
idx
;

32172 i‡(
s
->
tokí
.
vÆ
 =
TOK_ELLIPSIS
) {

32173 
fd
->
has_sim∂e_∑ømëî_li°
 = 
FALSE
;

32174 
ª°
 = 
TRUE
;

32175 i‡(
	`√xt_tokí
(
s
))

32176 
Áû
;

32178 i‡(
s
->
tokí
.
vÆ
 == '[' || s->token.val == '{') {

32179 
fd
->
has_sim∂e_∑ømëî_li°
 = 
FALSE
;

32180 i‡(
ª°
) {

32181 
	`emô_›
(
s
, 
OP_ª°
);

32182 
	`emô_u16
(
s
, 
fd
->
¨g_cou¡
);

32185 
idx
 = 
	`add_¨g
(
˘x
, 
fd
, 
JS_ATOM_NULL
);

32186 
	`emô_›
(
s
, 
OP_gë_¨g
);

32187 
	`emô_u16
(
s
, 
idx
);

32189 i‡(
	`js_∑r£_de°ru˘urög_ñemít
(
s
, 
TOK_VAR
, 1, 
TRUE
, -1, TRUE))

32190 
Áû
;

32191 } i‡(
s
->
tokí
.
vÆ
 =
TOK_IDENT
) {

32192 i‡(
s
->
tokí
.
u
.
idít
.
is_ª£rved
) {

32193 
	`js_∑r£_îr‹_ª£rved_idítifõr
(
s
);

32194 
Áû
;

32196 
«me
 = 
s
->
tokí
.
u
.
idít
.
©om
;

32197 i‡(
«me
 =
JS_ATOM_yõld
 && 
fd
->
func_köd
 =
JS_FUNC_GENERATOR
) {

32198 
	`js_∑r£_îr‹_ª£rved_idítifõr
(
s
);

32199 
Áû
;

32201 
idx
 = 
	`add_¨g
(
˘x
, 
fd
, 
«me
);

32202 i‡(
idx
 < 0)

32203 
Áû
;

32204 i‡(
	`√xt_tokí
(
s
))

32205 
Áû
;

32206 i‡(
ª°
) {

32207 
	`emô_›
(
s
, 
OP_ª°
);

32208 
	`emô_u16
(
s
, 
idx
);

32209 
	`emô_›
(
s
, 
OP_put_¨g
);

32210 
	`emô_u16
(
s
, 
idx
);

32211 
fd
->
has_sim∂e_∑ømëî_li°
 = 
FALSE
;

32212 
has_›t_¨g
 = 
TRUE
;

32213 } i‡(
s
->
tokí
.
vÆ
 == '=') {

32214 
fd
->
has_sim∂e_∑ømëî_li°
 = 
FALSE
;

32215 
has_›t_¨g
 = 
TRUE
;

32217 i‡(
	`√xt_tokí
(
s
))

32218 
Áû
;

32221 i‡(
s
->
tokí
.
vÆ
 =
TOK_VOID
) {

32222 
JSP¨£Pos
 
pos
;

32223 
	`js_∑r£_gë_pos
(
s
, &
pos
);

32224 i‡(
	`√xt_tokí
(
s
))

32225 
Áû
;

32226 i‡(
s
->
tokí
.
vÆ
 =
TOK_NUMBER
) {

32227 i‡(
	`√xt_tokí
(
s
))

32228 
Áû
;

32229 i‡(
s
->
tokí
.
vÆ
 == ',') {

32230 i‡(
	`√xt_tokí
(
s
))

32231 
Áû
;

32234 i‡(
s
->
tokí
.
vÆ
 == ')') {

32238 i‡(
	`js_∑r£_£ek_tokí
(
s
, &
pos
))

32239 
Áû
;

32245 i‡(
s
->
tokí
.
vÆ
 =
TOK_IDENT
 &&

32246 
s
->
tokí
.
u
.
idít
.
©om
 =
JS_ATOM_undeföed
 &&

32247 
fd
->
∑ª¡
 =
NULL
 &&

32248 ((
tok
 = 
	`≥ek_tokí
(
s
, 
FALSE
)) == ',' ||Åok == ')')) {

32249 i‡(
	`√xt_tokí
(
s
))

32250 
Áû
;

32254 
œbñ
 = 
	`√w_œbñ
(
s
);

32255 i‡(
idx
 > 0) {

32256 
	`emô_›
(
s
, 
OP_£t_¨g_vÆid_u±o
);

32257 
	`emô_u16
(
s
, 
idx
);

32259 
	`emô_›
(
s
, 
OP_gë_¨g
);

32260 
	`emô_u16
(
s
, 
idx
);

32261 
	`emô_›
(
s
, 
OP_undeföed
);

32262 
	`emô_›
(
s
, 
OP_°ri˘_eq
);

32263 
	`emô_gŸo
(
s
, 
OP_if_Ál£
, 
œbñ
);

32264 i‡(
	`js_∑r£_assign_ex¥
(
s
, 
TRUE
))

32265 
Áû
;

32266 
	`£t_obje˘_«me
(
s
, 
«me
);

32267 
	`emô_›
(
s
, 
OP_put_¨g
);

32268 
	`emô_u16
(
s
, 
idx
);

32269 
	`emô_œbñ
(
s
, 
œbñ
);

32271 } i‡(!
has_›t_¨g
) {

32272 
fd
->
deföed_¨g_cou¡
++;

32275 
	`js_∑r£_îr‹
(
s
, "missing formalÖarameter");

32276 
Áû
;

32278 i‡(
ª°
 && 
s
->
tokí
.
vÆ
 != ')') {

32279 
	`js_∑r£_ex≥˘
(
s
, ')');

32280 
Áû
;

32282 i‡(
s
->
tokí
.
vÆ
 == ')')

32284 i‡(
	`js_∑r£_ex≥˘
(
s
, ','))

32285 
Áû
;

32287 i‡((
func_ty≥
 =
JS_PARSE_FUNC_GETTER
 && 
fd
->
¨g_cou¡
 != 0) ||

32288 (
func_ty≥
 =
JS_PARSE_FUNC_SETTER
 && 
fd
->
¨g_cou¡
 != 1)) {

32289 
	`js_∑r£_îr‹
(
s
, "invalidÇumber ofárguments for getter or setter");

32290 
Áû
;

32294 i‡(
	`√xt_tokí
(
s
))

32295 
Áû
;

32298 i‡(
func_köd
 =
JS_FUNC_GENERATOR
 ||

32299 
func_köd
 =
JS_FUNC_ASYNC_GENERATOR
)

32300 
	`emô_›
(
s
, 
OP_öôül_yõld
);

32304 
fd
->
ö_fun˘i⁄_body
 = 
TRUE
;

32305 
	`push_sc›e
(
s
);

32307 i‡(
s
->
tokí
.
vÆ
 =
TOK_ARROW
) {

32308 i‡(
	`√xt_tokí
(
s
))

32309 
Áû
;

32311 i‡(
s
->
tokí
.
vÆ
 != '{') {

32312 i‡(
	`js_∑r£_fun˘i⁄_check_«mes
(
s
, 
fd
, 
func_«me
))

32313 
Áû
;

32315 i‡(
	`js_∑r£_assign_ex¥
(
s
, 
TRUE
))

32316 
Áû
;

32318 i‡(
func_köd
 !
JS_FUNC_NORMAL
)

32319 
	`emô_›
(
s
, 
OP_ªtu∫_async
);

32321 
	`emô_›
(
s
, 
OP_ªtu∫
);

32323 i‡(!(
fd
->
js_mode
 & 
JS_MODE_STRIP
)) {

32327 
fd
->
sour˚_Àn
 = 
s
->
œ°_±r
 - 
±r
;

32328 
fd
->
sour˚
 = 
	`js_°∫dup
(
˘x
, (c⁄° *)
±r
, fd->
sour˚_Àn
);

32329 i‡(!
fd
->
sour˚
)

32330 
Áû
;

32332 
d⁄e
;

32336 i‡(
	`js_∑r£_ex≥˘
(
s
, '{'))

32337 
Áû
;

32339 i‡(
	`js_∑r£_dúe˘ives
(
s
))

32340 
Áû
;

32343 i‡(
	`js_∑r£_fun˘i⁄_check_«mes
(
s
, 
fd
, 
func_«me
))

32344 
Áû
;

32346 
s
->
tokí
.
vÆ
 != '}') {

32347 i‡(
	`js_∑r£_sour˚_ñemít
(
s
))

32348 
Áû
;

32350 i‡(!(
fd
->
js_mode
 & 
JS_MODE_STRIP
)) {

32352 
fd
->
sour˚_Àn
 = 
s
->
buf_±r
 - 
±r
;

32353 
fd
->
sour˚
 = 
	`js_°∫dup
(
˘x
, (c⁄° *)
±r
, fd->
sour˚_Àn
);

32354 i‡(!
fd
->
sour˚
)

32355 
Áû
;

32358 i‡(
	`√xt_tokí
(
s
)) {

32360 
Áû
;

32364 i‡(
	`js_is_live_code
(
s
)) {

32365 
	`emô_ªtu∫
(
s
, 
FALSE
);

32367 
d⁄e
:

32368 
s
->
cur_func
 = 
fd
->
∑ª¡
;

32372 
idx
;

32373 
JSAtom
 
func_«me
 = 
fd
->func_name;

32376 
idx
 = 
	`˝oﬁ_add
(
s
, 
JS_NULL
);

32377 
fd
->
∑ª¡_˝oﬁ_idx
 = 
idx
;

32379 i‡(
is_ex¥
) {

32381 i‡(
func_ty≥
 !
JS_PARSE_FUNC_CLASS_CONSTRUCTOR
 &&

32382 
func_ty≥
 !
JS_PARSE_FUNC_DERIVED_CLASS_CONSTRUCTOR
) {

32385 
	`emô_›
(
s
, 
OP_f˛osuª
);

32386 
	`emô_u32
(
s
, 
idx
);

32387 i‡(
func_«me
 =
JS_ATOM_NULL
) {

32388 
	`emô_›
(
s
, 
OP_£t_«me
);

32389 
	`emô_u32
(
s
, 
JS_ATOM_NULL
);

32392 } i‡(
func_ty≥
 =
JS_PARSE_FUNC_VAR
) {

32393 
	`emô_›
(
s
, 
OP_f˛osuª
);

32394 
	`emô_u32
(
s
, 
idx
);

32395 i‡(
¸óã_func_v¨
) {

32396 i‡(
s
->
cur_func
->
is_globÆ_v¨
) {

32397 
JSHoi°edDef
 *
hf
;

32400 
hf
 = 
	`add_hoi°ed_def
(
˘x
, 
s
->
cur_func
, -1, 
func_«me
, -1, 
FALSE
);

32401 i‡(!
hf
)

32402 
Áû
;

32406 
hf
->
sc›e_Àvñ
 = 0;

32407 
hf
->
f‹˚_öô
 = ((
s
->
cur_func
->
js_mode
 & 
JS_MODE_STRICT
) != 0);

32409 
	`emô_›
(
s
, 
OP_dup
);

32410 
	`emô_›
(
s
, 
OP_sc›e_put_v¨
);

32411 
	`emô_©om
(
s
, 
func_«me
);

32412 
	`emô_u16
(
s
, 0);

32415 
func_idx
 = 
	`föd_v¨
(
˘x
, 
s
->
cur_func
, 
func_«me
);

32416 i‡(
func_idx
 < 0) {

32417 
func_idx
 = 
	`add_v¨
(
˘x
, 
s
->
cur_func
, 
func_«me
);

32418 i‡(
func_idx
 < 0)

32419 
Áû
;

32422 
	`emô_›
(
s
, 
OP_dup
);

32423 
	`emô_›
(
s
, 
OP_sc›e_put_v¨
);

32424 
	`emô_©om
(
s
, 
func_«me
);

32425 
	`emô_u16
(
s
, 0);

32428 i‡(
Àxiˇl_func_idx
 >= 0) {

32430 
s
->
cur_func
->
v¨s
[
Àxiˇl_func_idx
].
func_poﬁ_‹_sc›e_idx
 = 
idx
;

32431 
	`emô_›
(
s
, 
OP_dr›
);

32435 
	`emô_›
(
s
, 
OP_sc›e_put_v¨_öô
);

32436 
	`emô_©om
(
s
, 
func_«me
);

32437 
	`emô_u16
(
s
, s->
cur_func
->
sc›e_Àvñ
);

32440 i‡(!
s
->
cur_func
->
is_globÆ_v¨
) {

32441 
v¨_idx
 = 
	`deföe_v¨
(
s
, s->
cur_func
, 
func_«me
, 
JS_VAR_DEF_VAR
);

32443 i‡(
v¨_idx
 < 0)

32444 
Áû
;

32446 i‡(!
	`add_hoi°ed_def
(
˘x
, 
s
->
cur_func
, 
idx
, 
JS_ATOM_NULL
, 
v¨_idx
, 
FALSE
))

32447 
Áû
;

32449 
JSAtom
 
func_v¨_«me
;

32450 i‡(
func_«me
 =
JS_ATOM_NULL
)

32451 
func_v¨_«me
 = 
JS_ATOM__deÁu…_
;

32453 
func_v¨_«me
 = 
func_«me
;

32455 i‡(!
	`add_hoi°ed_def
(
˘x
, 
s
->
cur_func
, 
idx
, 
func_v¨_«me
, -1, 
FALSE
))

32456 
Áû
;

32457 i‡(
exp‹t_Êag
 !
JS_PARSE_EXPORT_NONE
) {

32458 i‡(!
	`add_exp‹t_íåy
(
s
, s->
cur_func
->
moduÀ
, 
func_v¨_«me
,

32459 
exp‹t_Êag
 =
JS_PARSE_EXPORT_NAMED
 ? 
func_v¨_«me
 : 
JS_ATOM_deÁu…
, 
JS_EXPORT_TYPE_LOCAL
))

32460 
Áû
;

32466 
Áû
:

32467 
s
->
cur_func
 = 
fd
->
∑ª¡
;

32468 
	`js_‰ì_fun˘i⁄_def
(
˘x
, 
fd
);

32469 i‡(
pfd
)

32470 *
pfd
 = 
NULL
;

32472 
	}
}

32474 
__ex˚±i⁄
 
	$js_∑r£_fun˘i⁄_de˛
(
JSP¨£Sèã
 *
s
,

32475 
JSP¨£Fun˘i⁄Enum
 
func_ty≥
,

32476 
JSFun˘i⁄KödEnum
 
func_köd
,

32477 
JSAtom
 
func_«me
,

32478 c⁄° 
uöt8_t
 *
±r
,

32479 
fun˘i⁄_löe_num
)

32481  
	`js_∑r£_fun˘i⁄_de˛2
(
s
, 
func_ty≥
, 
func_köd
, 
func_«me
, 
±r
,

32482 
fun˘i⁄_löe_num
, 
JS_PARSE_EXPORT_NONE
,

32483 
NULL
);

32484 
	}
}

32486 
__ex˚±i⁄
 
	$js_∑r£_¥ogøm
(
JSP¨£Sèã
 *
s
)

32488 
JSFun˘i⁄Def
 *
fd
 = 
s
->
cur_func
;

32489 
idx
;

32491 i‡(
	`√xt_tokí
(
s
))

32494 i‡(
	`js_∑r£_dúe˘ives
(
s
))

32497 
fd
->
is_globÆ_v¨
 = (fd->
evÆ_ty≥
 =
JS_EVAL_TYPE_GLOBAL
) ||

32498 (
fd
->
evÆ_ty≥
 =
JS_EVAL_TYPE_MODULE
) ||

32499 !(
fd
->
js_mode
 & 
JS_MODE_STRICT
);

32501 i‡(!
s
->
is_moduÀ
) {

32503 
fd
->
evÆ_ªt_idx
 = 
idx
 = 
	`add_v¨
(
s
->
˘x
, fd, 
JS_ATOM__ªt_
);

32504 i‡(
idx
 < 0)

32508 
s
->
tokí
.
vÆ
 !
TOK_EOF
) {

32509 i‡(
	`js_∑r£_sour˚_ñemít
(
s
))

32513 i‡(!
s
->
is_moduÀ
) {

32515 
	`emô_›
(
s
, 
OP_gë_loc
);

32516 
	`emô_u16
(
s
, 
fd
->
evÆ_ªt_idx
);

32518 
	`emô_›
(
s
, 
OP_ªtu∫
);

32520 
	`emô_›
(
s
, 
OP_ªtu∫_undef
);

32524 
	}
}

32526 
	$js_∑r£_öô
(
JSC⁄ãxt
 *
˘x
, 
JSP¨£Sèã
 *
s
,

32527 c⁄° *
öput
, 
size_t
 
öput_Àn
,

32528 c⁄° *
fûíame
)

32530 
	`mem£t
(
s
, 0, (*s));

32531 
s
->
˘x
 = ctx;

32532 
s
->
fûíame
 = filename;

32533 
s
->
löe_num
 = 1;

32534 
s
->
buf_±r
 = (c⁄° 
uöt8_t
 *)
öput
;

32535 
s
->
buf_íd
 = s->
buf_±r
 + 
öput_Àn
;

32536 
s
->
tokí
.
vÆ
 = ' ';

32537 
s
->
tokí
.
löe_num
 = 1;

32538 
	}
}

32540 
JSVÆue
 
	$JS_EvÆFun˘i⁄I¡î«l
(
JSC⁄ãxt
 *
˘x
, 
JSVÆue
 
fun_obj
,

32541 
JSVÆueC⁄°
 
this_obj
,

32542 
JSV¨Ref
 **
v¨_ªfs
, 
JSSèckFøme
 *
sf
)

32544 
JSVÆue
 
ªt_vÆ
;

32545 
uöt32_t
 
èg
;

32547 
èg
 = 
	`JS_VALUE_GET_TAG
(
fun_obj
);

32548 i‡(
èg
 =
JS_TAG_FUNCTION_BYTECODE
) {

32549 
fun_obj
 = 
	`js_˛osuª
(
˘x
, fun_obj, 
v¨_ªfs
, 
sf
);

32550 
ªt_vÆ
 = 
	`JS_CÆlFªe
(
˘x
, 
fun_obj
, 
this_obj
, 0, 
NULL
);

32551 } i‡(
èg
 =
JS_TAG_MODULE
) {

32552 
JSModuÀDef
 *
m
;

32553 
m
 = 
	`JS_VALUE_GET_PTR
(
fun_obj
);

32555 
	`JS_FªeVÆue
(
˘x
, 
fun_obj
);

32556 i‡(
	`js_ö°™tüã_moduÀ
(
˘x
, 
m
) < 0)

32557 
Áû
;

32558 
ªt_vÆ
 = 
	`js_evÆu©e_moduÀ
(
˘x
, 
m
);

32559 i‡(
	`JS_IsEx˚±i⁄
(
ªt_vÆ
)) {

32560 
Áû
:

32561 
	`js_‰ì_moduÀs
(
˘x
, 
JS_FREE_MODULE_NOT_EVALUATED
);

32562  
JS_EXCEPTION
;

32565 
	`JS_FªeVÆue
(
˘x
, 
fun_obj
);

32566 
ªt_vÆ
 = 
	`JS_ThrowTy≥Eº‹
(
˘x
, "bytecode functionÉxpected");

32568  
ªt_vÆ
;

32569 
	}
}

32571 
JSVÆue
 
	$JS_EvÆFun˘i⁄
(
JSC⁄ãxt
 *
˘x
, 
JSVÆue
 
fun_obj
)

32573  
	`JS_EvÆFun˘i⁄I¡î«l
(
˘x
, 
fun_obj
, ctx->
globÆ_obj
, 
NULL
, NULL);

32574 
	}
}

32576 
	$skù_sheb™g
(
JSP¨£Sèã
 *
s
)

32578 c⁄° 
uöt8_t
 *
p
 = 
s
->
buf_±r
;

32579 
c
;

32581 i‡(
p
[0] == '#' &&Ö[1] == '!') {

32582 
p
 += 2;

32583 
p
 < 
s
->
buf_íd
) {

32584 i‡(*
p
 == '\n' || *p == '\r') {

32586 } i‡(*
p
 >= 0x80) {

32587 
c
 = 
	`unicode_‰om_utf8
(
p
, 
UTF8_CHAR_LEN_MAX
, &p);

32588 i‡(
c
 =
CP_LS
 || c =
CP_PS
) {

32590 } i‡(
c
 == -1) {

32591 
p
++;

32594 
p
++;

32597 
s
->
buf_±r
 = 
p
;

32599 
	}
}

32602 
JSVÆue
 
	$__JS_EvÆI¡î«l
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_obj
,

32603 c⁄° *
öput
, 
size_t
 
öput_Àn
,

32604 c⁄° *
fûíame
, 
Êags
, 
sc›e_idx
)

32606 
JSP¨£Sèã
 
s1
, *
s
 = &s1;

32607 
îr
, 
js_mode
, 
evÆ_ty≥
;

32608 
JSVÆue
 
fun_obj
, 
ªt_vÆ
;

32609 
JSSèckFøme
 *
sf
;

32610 
JSV¨Ref
 **
v¨_ªfs
;

32611 
JSFun˘i⁄Byãcode
 *
b
;

32612 
JSFun˘i⁄Def
 *
fd
;

32613 
JSModuÀDef
 *
m
;

32615 
	`js_∑r£_öô
(
˘x
, 
s
, 
öput
, 
öput_Àn
, 
fûíame
);

32616 
	`skù_sheb™g
(
s
);

32618 
evÆ_ty≥
 = 
Êags
 & 
JS_EVAL_TYPE_MASK
;

32619 
m
 = 
NULL
;

32620 i‡(
evÆ_ty≥
 =
JS_EVAL_TYPE_DIRECT
) {

32621 
JSObje˘
 *
p
;

32622 
sf
 = 
˘x
->
π
->
cuºít_°ack_‰ame
;

32623 
	`as£π
(
sf
 !
NULL
);

32624 
	`as£π
(
	`JS_VALUE_GET_TAG
(
sf
->
cur_func
Ë=
JS_TAG_OBJECT
);

32625 
p
 = 
	`JS_VALUE_GET_OBJ
(
sf
->
cur_func
);

32626 
	`as£π
(
	`js_˛ass_has_byãcode
(
p
->
˛ass_id
));

32627 
b
 = 
p
->
u
.
func
.
fun˘i⁄_byãcode
;

32628 
v¨_ªfs
 = 
p
->
u
.
func
.var_refs;

32629 
js_mode
 = 
b
->js_mode;

32631 
sf
 = 
NULL
;

32632 
b
 = 
NULL
;

32633 
v¨_ªfs
 = 
NULL
;

32634 
js_mode
 = 0;

32635 i‡(
Êags
 & 
JS_EVAL_FLAG_STRICT
)

32636 
js_mode
 |
JS_MODE_STRICT
;

32637 i‡(
Êags
 & 
JS_EVAL_FLAG_STRIP
)

32638 
js_mode
 |
JS_MODE_STRIP
;

32639 i‡(
evÆ_ty≥
 =
JS_EVAL_TYPE_MODULE
) {

32640 
JSAtom
 
moduÀ_«me
 = 
	`JS_NewAtom
(
˘x
, 
fûíame
);

32641 i‡(
moduÀ_«me
 =
JS_ATOM_NULL
)

32642  
JS_EXCEPTION
;

32643 
m
 = 
	`js_√w_moduÀ_def
(
˘x
, 
moduÀ_«me
);

32644 i‡(!
m
)

32645  
JS_EXCEPTION
;

32646 
js_mode
 |
JS_MODE_STRICT
;

32649 
fd
 = 
	`js_√w_fun˘i⁄_def
(
˘x
, 
NULL
, 
TRUE
, 
FALSE
, 
fûíame
, 1);

32650 i‡(!
fd
)

32651 
Áû1
;

32652 
s
->
cur_func
 = 
fd
;

32653 
fd
->
evÆ_ty≥
 =Éval_type;

32654 
fd
->
has_this_bödög
 = (
evÆ_ty≥
 !
JS_EVAL_TYPE_DIRECT
);

32655 
fd
->
backåa˚_b¨rõr
 = ((
Êags
 & 
JS_EVAL_FLAG_BACKTRACE_BARRIER
) != 0);

32656 i‡(
evÆ_ty≥
 =
JS_EVAL_TYPE_DIRECT
) {

32657 
fd
->
√w_èrgë_Ælowed
 = 
b
->new_target_allowed;

32658 
fd
->
su≥r_ˇŒ_Ælowed
 = 
b
->super_call_allowed;

32659 
fd
->
su≥r_Ælowed
 = 
b
->super_allowed;

32660 
fd
->
¨gumíts_Ælowed
 = 
b
->arguments_allowed;

32662 
fd
->
√w_èrgë_Ælowed
 = 
FALSE
;

32663 
fd
->
su≥r_ˇŒ_Ælowed
 = 
FALSE
;

32664 
fd
->
su≥r_Ælowed
 = 
FALSE
;

32665 
fd
->
¨gumíts_Ælowed
 = 
TRUE
;

32667 
fd
->
js_mode
 = js_mode;

32668 
fd
->
func_«me
 = 
	`JS_DupAtom
(
˘x
, 
JS_ATOM__evÆ_
);

32669 i‡(
b
) {

32670 i‡(
	`add_˛osuª_v¨übÀs
(
˘x
, 
fd
, 
b
, 
sc›e_idx
))

32671 
Áû
;

32673 
fd
->
moduÀ
 = 
m
;

32674 
s
->
is_moduÀ
 = (
m
 !
NULL
);

32675 
s
->
Ælow_html_commíts
 = !s->
is_moduÀ
;

32677 
	`push_sc›e
(
s
);

32679 
îr
 = 
	`js_∑r£_¥ogøm
(
s
);

32680 i‡(
îr
) {

32681 
Áû
:

32682 
	`‰ì_tokí
(
s
, &s->
tokí
);

32683 
	`js_‰ì_fun˘i⁄_def
(
˘x
, 
fd
);

32684 
Áû1
;

32688 
fun_obj
 = 
	`js_¸óã_fun˘i⁄
(
˘x
, 
fd
);

32689 i‡(
	`JS_IsEx˚±i⁄
(
fun_obj
))

32690 
Áû1
;

32692 i‡(
m
) {

32693 
m
->
func_obj
 = 
fun_obj
;

32694 i‡(
	`js_ªsﬁve_moduÀ
(
˘x
, 
m
) < 0)

32695 
Áû1
;

32696 
fun_obj
 = 
	`JS_DupVÆue
(
˘x
, 
	`JS_MKPTR
(
JS_TAG_MODULE
, 
m
));

32698 i‡(
Êags
 & 
JS_EVAL_FLAG_COMPILE_ONLY
) {

32699 
ªt_vÆ
 = 
fun_obj
;

32701 
ªt_vÆ
 = 
	`JS_EvÆFun˘i⁄I¡î«l
(
˘x
, 
fun_obj
, 
this_obj
, 
v¨_ªfs
, 
sf
);

32703  
ªt_vÆ
;

32704 
Áû1
:

32706 i‡(
m
)

32707 
	`js_‰ì_moduÀ_def
(
˘x
, 
m
);

32708  
JS_EXCEPTION
;

32709 
	}
}

32712 
JSVÆue
 
	$JS_EvÆI¡î«l
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_obj
,

32713 c⁄° *
öput
, 
size_t
 
öput_Àn
,

32714 c⁄° *
fûíame
, 
Êags
, 
sc›e_idx
)

32716 i‡(
	`u∆ikñy
(!
˘x
->
evÆ_öã∫Æ
)) {

32717  
	`JS_ThrowTy≥Eº‹
(
˘x
, "eval isÇot supported");

32719  
˘x
->
	`evÆ_öã∫Æ
(˘x, 
this_obj
, 
öput
, 
öput_Àn
, 
fûíame
,

32720 
Êags
, 
sc›e_idx
);

32721 
	}
}

32723 
JSVÆue
 
	$JS_EvÆObje˘
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_obj
,

32724 
JSVÆueC⁄°
 
vÆ
, 
Êags
, 
sc›e_idx
)

32726 
JSVÆue
 
ªt
;

32727 c⁄° *
°r
;

32728 
size_t
 
Àn
;

32730 i‡(!
	`JS_IsSåög
(
vÆ
))

32731  
	`JS_DupVÆue
(
˘x
, 
vÆ
);

32732 
°r
 = 
	`JS_ToCSåögLí
(
˘x
, &
Àn
, 
vÆ
);

32733 i‡(!
°r
)

32734  
JS_EXCEPTION
;

32735 
ªt
 = 
	`JS_EvÆI¡î«l
(
˘x
, 
this_obj
, 
°r
, 
Àn
, "<öput>", 
Êags
, 
sc›e_idx
);

32736 
	`JS_FªeCSåög
(
˘x
, 
°r
);

32737  
ªt
;

32739 
	}
}

32741 
JSVÆue
 
	$JS_EvÆ
(
JSC⁄ãxt
 *
˘x
, c⁄° *
öput
, 
size_t
 
öput_Àn
,

32742 c⁄° *
fûíame
, 
evÆ_Êags
)

32744 
evÆ_ty≥
 = 
evÆ_Êags
 & 
JS_EVAL_TYPE_MASK
;

32745 
JSVÆue
 
ªt
;

32747 
	`as£π
(
evÆ_ty≥
 =
JS_EVAL_TYPE_GLOBAL
 ||

32748 
evÆ_ty≥
 =
JS_EVAL_TYPE_MODULE
);

32749 
ªt
 = 
	`JS_EvÆI¡î«l
(
˘x
, ctx->
globÆ_obj
, 
öput
, 
öput_Àn
, 
fûíame
,

32750 
evÆ_Êags
, -1);

32751  
ªt
;

32752 
	}
}

32754 
	$JS_ResﬁveModuÀ
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
obj
)

32756 i‡(
	`JS_VALUE_GET_TAG
(
obj
Ë=
JS_TAG_MODULE
) {

32757 
JSModuÀDef
 *
m
 = 
	`JS_VALUE_GET_PTR
(
obj
);

32758 i‡(
	`js_ªsﬁve_moduÀ
(
˘x
, 
m
) < 0) {

32759 
	`js_‰ì_moduÀs
(
˘x
, 
JS_FREE_MODULE_NOT_RESOLVED
);

32764 
	}
}

32769 
	eBCTagEnum
 {

32770 
	mBC_TAG_NULL
 = 1,

32771 
	mBC_TAG_UNDEFINED
,

32772 
	mBC_TAG_BOOL_FALSE
,

32773 
	mBC_TAG_BOOL_TRUE
,

32774 
	mBC_TAG_INT32
,

32775 
	mBC_TAG_FLOAT64
,

32776 
	mBC_TAG_STRING
,

32777 
	mBC_TAG_OBJECT
,

32778 
	mBC_TAG_ARRAY
,

32779 
	mBC_TAG_BIG_INT
,

32780 
	mBC_TAG_BIG_FLOAT
,

32781 
	mBC_TAG_BIG_DECIMAL
,

32782 
	mBC_TAG_TEMPLATE_OBJECT
,

32783 
	mBC_TAG_FUNCTION_BYTECODE
,

32784 
	mBC_TAG_MODULE
,

32785 } 
	tBCTagEnum
;

32787 #ifde‡
CONFIG_BIGNUM


32788 
	#BC_BASE_VERSION
 2

	)

32790 
	#BC_BASE_VERSION
 1

	)

32792 
	#BC_BE_VERSION
 0x40

	)

32793 #ifde‡
WORDS_BIGENDIAN


32794 
	#BC_VERSION
 (
BC_BASE_VERSION
 | 
BC_BE_VERSION
)

	)

32796 
	#BC_VERSION
 
BC_BASE_VERSION


	)

32799 
	sBCWrôîSèã
 {

32800 
JSC⁄ãxt
 *
	m˘x
;

32801 
DynBuf
 
	mdbuf
;

32802 
BOOL
 
	mbyã_sw≠
;

32803 
BOOL
 
	mÆlow_byãcode
;

32804 
uöt32_t
 
	mfú°_©om
;

32805 
uöt32_t
 *
	m©om_to_idx
;

32806 
	m©om_to_idx_size
;

32807 
JSAtom
 *
	midx_to_©om
;

32808 
	midx_to_©om_cou¡
;

32809 
	midx_to_©om_size
;

32810 } 
	tBCWrôîSèã
;

32812 #ifde‡
DUMP_READ_OBJECT


32813 c⁄° * c⁄° 
	gbc_èg_°r
[] = {

32833 
	$bc_put_u8
(
BCWrôîSèã
 *
s
, 
uöt8_t
 
v
)

32835 
	`dbuf_putc
(&
s
->
dbuf
, 
v
);

32836 
	}
}

32838 
	$bc_put_u16
(
BCWrôîSèã
 *
s
, 
uöt16_t
 
v
)

32840 i‡(
s
->
byã_sw≠
)

32841 
v
 = 
	`bsw≠16
(v);

32842 
	`dbuf_put_u16
(&
s
->
dbuf
, 
v
);

32843 
	}
}

32845 
__maybe_unu£d
 
	$bc_put_u32
(
BCWrôîSèã
 *
s
, 
uöt32_t
 
v
)

32847 i‡(
s
->
byã_sw≠
)

32848 
v
 = 
	`bsw≠32
(v);

32849 
	`dbuf_put_u32
(&
s
->
dbuf
, 
v
);

32850 
	}
}

32852 
	$bc_put_u64
(
BCWrôîSèã
 *
s
, 
uöt64_t
 
v
)

32854 i‡(
s
->
byã_sw≠
)

32855 
v
 = 
	`bsw≠64
(v);

32856 
	`dbuf_put
(&
s
->
dbuf
, (
uöt8_t
 *)&
v
, (v));

32857 
	}
}

32859 
	$bc_put_Àb128
(
BCWrôîSèã
 *
s
, 
uöt32_t
 
v
)

32861 
	`dbuf_put_Àb128
(&
s
->
dbuf
, 
v
);

32862 
	}
}

32864 
	$bc_put_¶eb128
(
BCWrôîSèã
 *
s
, 
öt32_t
 
v
)

32866 
	`dbuf_put_¶eb128
(&
s
->
dbuf
, 
v
);

32867 
	}
}

32869 
	$bc_£t_Êags
(
uöt32_t
 *
pÊags
, *
pidx
, uöt32_à
vÆ
, 
n
)

32871 *
pÊags
 = *pÊag†| (
vÆ
 << *
pidx
);

32872 *
pidx
 +
n
;

32873 
	}
}

32875 
	$bc_©om_to_idx
(
BCWrôîSèã
 *
s
, 
uöt32_t
 *
¥es
, 
JSAtom
 
©om
)

32877 
uöt32_t
 
v
;

32879 i‡(
©om
 < 
s
->
fú°_©om
 || 
	`__JS_AtomIsTaggedI¡
(atom)) {

32880 *
¥es
 = 
©om
;

32883 
©om
 -
s
->
fú°_©om
;

32884 i‡(
©om
 < 
s
->
©om_to_idx_size
 && s->
©om_to_idx
[atom] != 0) {

32885 *
¥es
 = 
s
->
©om_to_idx
[
©om
];

32888 i‡(
©om
 >
s
->
©om_to_idx_size
) {

32889 
size_t
 
√w_size
, 
i
, 
¶ack
;

32890 
uöt32_t
 *
√w_èb
;

32892 
√w_size
 = 
s
->
©om_to_idx_size
 * 3 / 2;

32893 i‡((
©om
 + 1Ë> 
√w_size
)

32894 
√w_size
 = 
©om
 + 1;

32895 
√w_èb
 = 
	`js_ªÆloc2
(
s
->
˘x
, s->
©om_to_idx
,

32896 
√w_size
 * (
s
->
©om_to_idx
[0]), &
¶ack
);

32897 i‡(!
√w_èb
)

32898 
Áû
;

32899 
√w_size
 +
¶ack
 / (*
√w_èb
);

32900 
i
 = 
s
->
©om_to_idx_size
; i < 
√w_size
; i++)

32901 
√w_èb
[
i
] = 0;

32902 
s
->
©om_to_idx
 = 
√w_èb
;

32903 
s
->
©om_to_idx_size
 = 
√w_size
;

32905 i‡((
s
->
idx_to_©om_cou¡
 + 1Ë> s->
idx_to_©om_size
) {

32906 
size_t
 
√w_size
, 
¶ack
;

32907 
JSAtom
 *
√w_èb
;

32908 
√w_size
 = 
s
->
idx_to_©om_size
 * 3 / 2;

32909 i‡((
s
->
idx_to_©om_cou¡
 + 1Ë> 
√w_size
)

32910 
√w_size
 = 
s
->
idx_to_©om_cou¡
 + 1;

32911 
√w_èb
 = 
	`js_ªÆloc2
(
s
->
˘x
, s->
idx_to_©om
,

32912 
√w_size
 * (
s
->
idx_to_©om
[0]), &
¶ack
);

32913 i‡(!
√w_èb
)

32914 
Áû
;

32915 
√w_size
 +
¶ack
 / (*
√w_èb
);

32916 
s
->
idx_to_©om
 = 
√w_èb
;

32917 
s
->
idx_to_©om_size
 = 
√w_size
;

32920 
v
 = 
s
->
idx_to_©om_cou¡
++;

32921 
s
->
idx_to_©om
[
v
] = 
©om
 + s->
fú°_©om
;

32922 
v
 +
s
->
fú°_©om
;

32923 
s
->
©om_to_idx
[
©om
] = 
v
;

32924 *
¥es
 = 
v
;

32926 
Áû
:

32927 *
¥es
 = 0;

32929 
	}
}

32931 
	$bc_put_©om
(
BCWrôîSèã
 *
s
, 
JSAtom
 
©om
)

32933 
uöt32_t
 
v
;

32935 i‡(
	`__JS_AtomIsTaggedI¡
(
©om
)) {

32936 
v
 = (
	`__JS_AtomToUI¡32
(
©om
) << 1) | 1;

32938 i‡(
	`bc_©om_to_idx
(
s
, &
v
, 
©om
))

32940 
v
 <<= 1;

32942 
	`bc_put_Àb128
(
s
, 
v
);

32944 
	}
}

32946 
	$bc_byã_sw≠
(
uöt8_t
 *
bc_buf
, 
bc_Àn
)

32948 
pos
, 
Àn
, 
›
, 
fmt
;

32950 
pos
 = 0;

32951 
pos
 < 
bc_Àn
) {

32952 
›
 = 
bc_buf
[
pos
];

32953 
Àn
 = 
	`sh‹t_›code_öfo
(
›
).
size
;

32954 
fmt
 = 
	`sh‹t_›code_öfo
(
›
).fmt;

32955 
fmt
) {

32956 
OP_FMT_u16
:

32957 
OP_FMT_i16
:

32958 
OP_FMT_œbñ16
:

32959 
OP_FMT_≈›
:

32960 
OP_FMT_loc
:

32961 
OP_FMT_¨g
:

32962 
OP_FMT_v¨_ªf
:

32963 
	`put_u16
(
bc_buf
 + 
pos
 + 1,

32964 
	`bsw≠16
(
	`gë_u16
(
bc_buf
 + 
pos
 + 1)));

32966 
OP_FMT_i32
:

32967 
OP_FMT_u32
:

32968 
OP_FMT_c⁄°
:

32969 
OP_FMT_œbñ
:

32970 
OP_FMT_©om
:

32971 
OP_FMT_©om_u8
:

32972 
	`put_u32
(
bc_buf
 + 
pos
 + 1,

32973 
	`bsw≠32
(
	`gë_u32
(
bc_buf
 + 
pos
 + 1)));

32975 
OP_FMT_©om_u16
:

32976 
OP_FMT_œbñ_u16
:

32977 
	`put_u32
(
bc_buf
 + 
pos
 + 1,

32978 
	`bsw≠32
(
	`gë_u32
(
bc_buf
 + 
pos
 + 1)));

32979 
	`put_u16
(
bc_buf
 + 
pos
 + 1 + 4,

32980 
	`bsw≠16
(
	`gë_u16
(
bc_buf
 + 
pos
 + 1 + 4)));

32982 
OP_FMT_©om_œbñ_u8
:

32983 
OP_FMT_©om_œbñ_u16
:

32984 
	`put_u32
(
bc_buf
 + 
pos
 + 1,

32985 
	`bsw≠32
(
	`gë_u32
(
bc_buf
 + 
pos
 + 1)));

32986 
	`put_u32
(
bc_buf
 + 
pos
 + 1 + 4,

32987 
	`bsw≠32
(
	`gë_u32
(
bc_buf
 + 
pos
 + 1 + 4)));

32988 i‡(
fmt
 =
OP_FMT_©om_œbñ_u16
) {

32989 
	`put_u16
(
bc_buf
 + 
pos
 + 1 + 4 + 4,

32990 
	`bsw≠16
(
	`gë_u16
(
bc_buf
 + 
pos
 + 1 + 4 + 4)));

32993 
OP_FMT_≈›_u16
:

32994 
	`put_u16
(
bc_buf
 + 
pos
 + 1,

32995 
	`bsw≠16
(
	`gë_u16
(
bc_buf
 + 
pos
 + 1)));

32996 
	`put_u16
(
bc_buf
 + 
pos
 + 1 + 2,

32997 
	`bsw≠16
(
	`gë_u16
(
bc_buf
 + 
pos
 + 1 + 2)));

33002 
pos
 +
Àn
;

33004 
	}
}

33006 
	$JS_WrôeFun˘i⁄Byãcode
(
BCWrôîSèã
 *
s
,

33007 c⁄° 
uöt8_t
 *
bc_buf1
, 
bc_Àn
)

33009 
pos
, 
Àn
, 
›
;

33010 
JSAtom
 
©om
;

33011 
uöt8_t
 *
bc_buf
;

33012 
uöt32_t
 
vÆ
;

33014 
bc_buf
 = 
	`js_mÆloc
(
s
->
˘x
, 
bc_Àn
);

33015 i‡(!
bc_buf
)

33017 
	`mem˝y
(
bc_buf
, 
bc_buf1
, 
bc_Àn
);

33019 
pos
 = 0;

33020 
pos
 < 
bc_Àn
) {

33021 
›
 = 
bc_buf
[
pos
];

33022 
Àn
 = 
	`sh‹t_›code_öfo
(
›
).
size
;

33023 
	`sh‹t_›code_öfo
(
›
).
fmt
) {

33024 
OP_FMT_©om
:

33025 
OP_FMT_©om_u8
:

33026 
OP_FMT_©om_u16
:

33027 
OP_FMT_©om_œbñ_u8
:

33028 
OP_FMT_©om_œbñ_u16
:

33029 
©om
 = 
	`gë_u32
(
bc_buf
 + 
pos
 + 1);

33030 i‡(
	`bc_©om_to_idx
(
s
, &
vÆ
, 
©om
))

33031 
Áû
;

33032 
	`put_u32
(
bc_buf
 + 
pos
 + 1, 
vÆ
);

33037 
pos
 +
Àn
;

33040 i‡(
s
->
byã_sw≠
)

33041 
	`bc_byã_sw≠
(
bc_buf
, 
bc_Àn
);

33043 
	`dbuf_put
(&
s
->
dbuf
, 
bc_buf
, 
bc_Àn
);

33045 
	`js_‰ì
(
s
->
˘x
, 
bc_buf
);

33047 
Áû
:

33048 
	`js_‰ì
(
s
->
˘x
, 
bc_buf
);

33050 
	}
}

33052 
	$JS_WrôeSåög
(
BCWrôîSèã
 *
s
, 
JSSåög
 *
p
)

33054 
i
;

33055 
	`bc_put_Àb128
(
s
, ((
uöt32_t
)
p
->
Àn
 << 1Ë|Ö->
is_wide_ch¨
);

33056 i‡(
p
->
is_wide_ch¨
) {

33057 
i
 = 0; i < 
p
->
Àn
; i++)

33058 
	`bc_put_u16
(
s
, 
p
->
u
.
°r16
[
i
]);

33060 
	`dbuf_put
(&
s
->
dbuf
, 
p
->
u
.
°r8
,Ö->
Àn
);

33062 
	}
}

33064 #ifde‡
CONFIG_BIGNUM


33065 
	$JS_WrôeBigNum
(
BCWrôîSèã
 *
s
, 
JSVÆueC⁄°
 
obj
)

33067 
uöt32_t
 
èg
, 
èg1
;

33068 
öt64_t
 
e
;

33069 
JSBigFlﬂt
 *
bf
 = 
	`JS_VALUE_GET_PTR
(
obj
);

33070 
bf_t
 *
a
 = &
bf
->
num
;

33071 
size_t
 
Àn
, 
i
, 
n1
, 
j
;

33072 
limb_t
 
v
;

33074 
èg
 = 
	`JS_VALUE_GET_TAG
(
obj
);

33075 
èg
) {

33076 
JS_TAG_BIG_INT
:

33077 
èg1
 = 
BC_TAG_BIG_INT
;

33079 
JS_TAG_BIG_FLOAT
:

33080 
èg1
 = 
BC_TAG_BIG_FLOAT
;

33082 
JS_TAG_BIG_DECIMAL
:

33083 
èg1
 = 
BC_TAG_BIG_DECIMAL
;

33086 
	`ab‹t
();

33088 
	`bc_put_u8
(
s
, 
èg1
);

33091 i‡(
a
->
ex≤
 =
BF_EXP_ZERO
)

33092 
e
 = 0;

33093 i‡(
a
->
ex≤
 =
BF_EXP_INF
)

33094 
e
 = 1;

33095 i‡(
a
->
ex≤
 =
BF_EXP_NAN
)

33096 
e
 = 2;

33097 i‡(
a
->
ex≤
 >= 0)

33098 
e
 = 
a
->
ex≤
 + 3;

33100 
e
 = 
a
->
ex≤
;

33101 
e
 = (ê<< 1Ë| 
a
->
sign
;

33102 i‡(
e
 < 
INT32_MIN
 ||É > 
INT32_MAX
) {

33103 
	`JS_ThrowI¡î«lEº‹
(
s
->
˘x
, "bignumÉxponent isÅooÜarge");

33106 
	`bc_put_¶eb128
(
s
, 
e
);

33109 i‡(
a
->
Àn
 != 0) {

33110 i‡(
èg
 !
JS_TAG_BIG_DECIMAL
) {

33111 
i
 = 0;

33112 
i
 < 
a
->
Àn
 &&á->
èb
[i] == 0)

33113 
i
++;

33114 
	`as£π
(
i
 < 
a
->
Àn
);

33115 
v
 = 
a
->
èb
[
i
];

33116 
n1
 = (
limb_t
);

33117 (
v
 & 0xff) == 0) {

33118 
n1
--;

33119 
v
 >>= 8;

33121 
i
++;

33122 
Àn
 = (
a
->À¿- 
i
Ë* (
limb_t
Ë+ 
n1
;

33123 i‡(
Àn
 > 
INT32_MAX
) {

33124 
	`JS_ThrowI¡î«lEº‹
(
s
->
˘x
, "bignum isÅooÜarge");

33127 
	`bc_put_Àb128
(
s
, 
Àn
);

33129 
j
 = 0; j < 
n1
; j++) {

33130 
	`dbuf_putc
(&
s
->
dbuf
, 
v
 >> (
j
 * 8));

33132 ; 
i
 < 
a
->
Àn
; i++) {

33133 
limb_t
 
v
 = 
a
->
èb
[
i
];

33134 #i‡
LIMB_BITS
 == 32

33135 #ifde‡
WORDS_BIGENDIAN


33136 
v
 = 
	`bsw≠32
(v);

33138 
	`dbuf_put_u32
(&
s
->
dbuf
, 
v
);

33140 #ifde‡
WORDS_BIGENDIAN


33141 
v
 = 
	`bsw≠64
(v);

33143 
	`dbuf_put_u64
(&
s
->
dbuf
, 
v
);

33147 
bpos
, 
d
;

33148 
uöt8_t
 
v8
;

33149 
size_t
 
i0
;

33152 
i
 = 0;

33153 
i
 < 
a
->
Àn
 &&á->
èb
[i] == 0)

33154 
i
++;

33155 
	`as£π
(
i
 < 
a
->
Àn
);

33156 
Àn
 = 
a
->À¿* 
LIMB_DIGITS
;

33157 
v
 = 
a
->
èb
[
i
];

33158 
j
 = 0;

33159 (
v
 % 10) == 0) {

33160 
j
++;

33161 
v
 /= 10;

33163 
Àn
 -
j
;

33164 
	`as£π
(
Àn
 > 0);

33165 i‡(
Àn
 > 
INT32_MAX
) {

33166 
	`JS_ThrowI¡î«lEº‹
(
s
->
˘x
, "bignum isÅooÜarge");

33169 
	`bc_put_Àb128
(
s
, 
Àn
);

33171 
bpos
 = 0;

33172 
v8
 = 0;

33173 
i0
 = 
i
;

33174 ; 
i
 < 
a
->
Àn
; i++) {

33175 i‡(
i
 !
i0
) {

33176 
v
 = 
a
->
èb
[
i
];

33177 
j
 = 0;

33179 ; 
j
 < 
LIMB_DIGITS
; j++) {

33180 
d
 = 
v
 % 10;

33181 
v
 /= 10;

33182 i‡(
bpos
 == 0) {

33183 
v8
 = 
d
;

33184 
bpos
 = 1;

33186 
	`dbuf_putc
(&
s
->
dbuf
, 
v8
 | (
d
 << 4));

33187 
bpos
 = 0;

33192 i‡(
bpos
) {

33193 
	`dbuf_putc
(&
s
->
dbuf
, 
v8
);

33198 
	}
}

33201 
	$JS_WrôeObje˘Rec
(
BCWrôîSèã
 *
s
, 
JSVÆueC⁄°
 
obj
)

33203 
uöt32_t
 
èg
 = 
	`JS_VALUE_GET_NORM_TAG
(
obj
);

33205 
èg
) {

33206 
JS_TAG_NULL
:

33207 
	`bc_put_u8
(
s
, 
BC_TAG_NULL
);

33209 
JS_TAG_UNDEFINED
:

33210 
	`bc_put_u8
(
s
, 
BC_TAG_UNDEFINED
);

33212 
JS_TAG_BOOL
:

33213 
	`bc_put_u8
(
s
, 
BC_TAG_BOOL_FALSE
 + 
	`JS_VALUE_GET_INT
(
obj
));

33215 
JS_TAG_INT
:

33216 
	`bc_put_u8
(
s
, 
BC_TAG_INT32
);

33217 
	`bc_put_¶eb128
(
s
, 
	`JS_VALUE_GET_INT
(
obj
));

33219 
JS_TAG_FLOAT64
:

33221 
JSFlﬂt64Uni⁄
 
u
;

33222 
	`bc_put_u8
(
s
, 
BC_TAG_FLOAT64
);

33223 
u
.
d
 = 
	`JS_VALUE_GET_FLOAT64
(
obj
);

33224 
	`bc_put_u64
(
s
, 
u
.
u64
);

33227 
JS_TAG_STRING
:

33229 
JSSåög
 *
p
 = 
	`JS_VALUE_GET_STRING
(
obj
);

33230 
	`bc_put_u8
(
s
, 
BC_TAG_STRING
);

33231 
	`JS_WrôeSåög
(
s
, 
p
);

33234 
JS_TAG_FUNCTION_BYTECODE
:

33236 
JSFun˘i⁄Byãcode
 *
b
 = 
	`JS_VALUE_GET_PTR
(
obj
);

33237 
uöt32_t
 
Êags
;

33238 
idx
, 
i
;

33240 i‡(!
s
->
Ælow_byãcode
)

33241 
övÆid_èg
;

33242 
	`bc_put_u8
(
s
, 
BC_TAG_FUNCTION_BYTECODE
);

33243 
Êags
 = 
idx
 = 0;

33244 
	`bc_£t_Êags
(&
Êags
, &
idx
, 
b
->
has_¥ŸŸy≥
, 1);

33245 
	`bc_£t_Êags
(&
Êags
, &
idx
, 
b
->
has_sim∂e_∑ømëî_li°
, 1);

33246 
	`bc_£t_Êags
(&
Êags
, &
idx
, 
b
->
is_dîived_˛ass_c⁄°ru˘‹
, 1);

33247 
	`bc_£t_Êags
(&
Êags
, &
idx
, 
b
->
√ed_home_obje˘
, 1);

33248 
	`bc_£t_Êags
(&
Êags
, &
idx
, 
b
->
func_köd
, 2);

33249 
	`bc_£t_Êags
(&
Êags
, &
idx
, 
b
->
√w_èrgë_Ælowed
, 1);

33250 
	`bc_£t_Êags
(&
Êags
, &
idx
, 
b
->
su≥r_ˇŒ_Ælowed
, 1);

33251 
	`bc_£t_Êags
(&
Êags
, &
idx
, 
b
->
su≥r_Ælowed
, 1);

33252 
	`bc_£t_Êags
(&
Êags
, &
idx
, 
b
->
¨gumíts_Ælowed
, 1);

33253 
	`bc_£t_Êags
(&
Êags
, &
idx
, 
b
->
has_debug
, 1);

33254 
	`bc_£t_Êags
(&
Êags
, &
idx
, 
b
->
backåa˚_b¨rõr
, 1);

33255 
	`as£π
(
idx
 <= 16);

33256 
	`bc_put_u16
(
s
, 
Êags
);

33257 
	`bc_put_u8
(
s
, 
b
->
js_mode
);

33258 
	`bc_put_©om
(
s
, 
b
->
func_«me
);

33260 
	`bc_put_Àb128
(
s
, 
b
->
¨g_cou¡
);

33261 
	`bc_put_Àb128
(
s
, 
b
->
v¨_cou¡
);

33262 
	`bc_put_Àb128
(
s
, 
b
->
deföed_¨g_cou¡
);

33263 
	`bc_put_Àb128
(
s
, 
b
->
°ack_size
);

33264 
	`bc_put_Àb128
(
s
, 
b
->
˛osuª_v¨_cou¡
);

33265 
	`bc_put_Àb128
(
s
, 
b
->
˝oﬁ_cou¡
);

33266 
	`bc_put_Àb128
(
s
, 
b
->
byã_code_Àn
);

33267 i‡(
b
->
v¨defs
) {

33268 
	`bc_put_Àb128
(
s
, 
b
->
¨g_cou¡
 + b->
v¨_cou¡
);

33269 
i
 = 0; i < 
b
->
¨g_cou¡
 + b->
v¨_cou¡
; i++) {

33270 
JSV¨Def
 *
vd
 = &
b
->
v¨defs
[
i
];

33271 
	`bc_put_©om
(
s
, 
vd
->
v¨_«me
);

33272 
	`bc_put_Àb128
(
s
, 
vd
->
sc›e_Àvñ
);

33273 
	`bc_put_Àb128
(
s
, 
vd
->
sc›e_√xt
 + 1);

33274 
Êags
 = 
idx
 = 0;

33275 
	`bc_£t_Êags
(&
Êags
, &
idx
, 
vd
->
v¨_köd
, 4);

33276 
	`bc_£t_Êags
(&
Êags
, &
idx
, 
vd
->
is_func_v¨
, 1);

33277 
	`bc_£t_Êags
(&
Êags
, &
idx
, 
vd
->
is_c⁄°
, 1);

33278 
	`bc_£t_Êags
(&
Êags
, &
idx
, 
vd
->
is_Àxiˇl
, 1);

33279 
	`bc_£t_Êags
(&
Êags
, &
idx
, 
vd
->
is_ˇ±uªd
, 1);

33280 
	`as£π
(
idx
 <= 8);

33281 
	`bc_put_u8
(
s
, 
Êags
);

33284 
	`bc_put_Àb128
(
s
, 0);

33287 
i
 = 0; i < 
b
->
˛osuª_v¨_cou¡
; i++) {

33288 
JSClosuªV¨
 *
cv
 = &
b
->
˛osuª_v¨
[
i
];

33289 
	`bc_put_©om
(
s
, 
cv
->
v¨_«me
);

33290 
	`bc_put_Àb128
(
s
, 
cv
->
v¨_idx
);

33291 
Êags
 = 
idx
 = 0;

33292 
	`bc_£t_Êags
(&
Êags
, &
idx
, 
cv
->
is_loˇl
, 1);

33293 
	`bc_£t_Êags
(&
Êags
, &
idx
, 
cv
->
is_¨g
, 1);

33294 
	`bc_£t_Êags
(&
Êags
, &
idx
, 
cv
->
is_c⁄°
, 1);

33295 
	`bc_£t_Êags
(&
Êags
, &
idx
, 
cv
->
is_Àxiˇl
, 1);

33296 
	`bc_£t_Êags
(&
Êags
, &
idx
, 
cv
->
v¨_köd
, 4);

33297 
	`as£π
(
idx
 <= 8);

33298 
	`bc_put_u8
(
s
, 
Êags
);

33301 i‡(
	`JS_WrôeFun˘i⁄Byãcode
(
s
, 
b
->
byã_code_buf
, b->
byã_code_Àn
))

33302 
Áû
;

33304 i‡(
b
->
has_debug
) {

33305 
	`bc_put_©om
(
s
, 
b
->
debug
.
fûíame
);

33306 
	`bc_put_Àb128
(
s
, 
b
->
debug
.
löe_num
);

33307 
	`bc_put_Àb128
(
s
, 
b
->
debug
.
pc2löe_Àn
);

33308 
	`dbuf_put
(&
s
->
dbuf
, 
b
->
debug
.
pc2löe_buf
, b->debug.
pc2löe_Àn
);

33311 
i
 = 0; i < 
b
->
˝oﬁ_cou¡
; i++) {

33312 i‡(
	`JS_WrôeObje˘Rec
(
s
, 
b
->
˝oﬁ
[
i
]))

33313 
Áû
;

33317 
JS_TAG_MODULE
:

33319 
JSModuÀDef
 *
m
 = 
	`JS_VALUE_GET_PTR
(
obj
);

33320 
i
;

33322 i‡(!
s
->
Ælow_byãcode
)

33323 
övÆid_èg
;

33324 
	`bc_put_u8
(
s
, 
BC_TAG_MODULE
);

33325 
	`bc_put_©om
(
s
, 
m
->
moduÀ_«me
);

33327 
	`bc_put_Àb128
(
s
, 
m
->
ªq_moduÀ_íåõs_cou¡
);

33328 
i
 = 0; i < 
m
->
ªq_moduÀ_íåõs_cou¡
; i++) {

33329 
JSReqModuÀE¡ry
 *
rme
 = &
m
->
ªq_moduÀ_íåõs
[
i
];

33330 
	`bc_put_©om
(
s
, 
rme
->
moduÀ_«me
);

33333 
	`bc_put_Àb128
(
s
, 
m
->
exp‹t_íåõs_cou¡
);

33334 
i
 = 0; i < 
m
->
exp‹t_íåõs_cou¡
; i++) {

33335 
JSExp‹tE¡ry
 *
me
 = &
m
->
exp‹t_íåõs
[
i
];

33336 
	`bc_put_u8
(
s
, 
me
->
exp‹t_ty≥
);

33337 i‡(
me
->
exp‹t_ty≥
 =
JS_EXPORT_TYPE_LOCAL
) {

33338 
	`bc_put_Àb128
(
s
, 
me
->
u
.
loˇl
.
v¨_idx
);

33340 
	`bc_put_Àb128
(
s
, 
me
->
u
.
ªq_moduÀ_idx
);

33341 
	`bc_put_©om
(
s
, 
me
->
loˇl_«me
);

33343 
	`bc_put_©om
(
s
, 
me
->
exp‹t_«me
);

33346 
	`bc_put_Àb128
(
s
, 
m
->
°¨_exp‹t_íåõs_cou¡
);

33347 
i
 = 0; i < 
m
->
°¨_exp‹t_íåõs_cou¡
; i++) {

33348 
JSSèrExp‹tE¡ry
 *
£
 = &
m
->
°¨_exp‹t_íåõs
[
i
];

33349 
	`bc_put_Àb128
(
s
, 
£
->
ªq_moduÀ_idx
);

33352 
	`bc_put_Àb128
(
s
, 
m
->
imp‹t_íåõs_cou¡
);

33353 
i
 = 0; i < 
m
->
imp‹t_íåõs_cou¡
; i++) {

33354 
JSImp‹tE¡ry
 *
mi
 = &
m
->
imp‹t_íåõs
[
i
];

33355 
	`bc_put_Àb128
(
s
, 
mi
->
v¨_idx
);

33356 
	`bc_put_©om
(
s
, 
mi
->
imp‹t_«me
);

33357 
	`bc_put_Àb128
(
s
, 
mi
->
ªq_moduÀ_idx
);

33360 i‡(
	`JS_WrôeObje˘Rec
(
s
, 
m
->
func_obj
))

33361 
Áû
;

33364 
JS_TAG_OBJECT
:

33366 
JSObje˘
 *
p
 = 
	`JS_VALUE_GET_OBJ
(
obj
);

33367 
uöt32_t
 
i
, 
¥›_cou¡
, 
Àn
;

33368 
JSSh≠e
 *
sh
;

33369 
JSSh≠ePr›îty
 *
¥
;

33370 
JSVÆue
 
vÆ
;

33371 
ªt
, 
∑ss
;

33372 
BOOL
 
is_ãm∂©e
;

33373 
JSAtom
 
©om
;

33375 i‡(
p
->
˛ass_id
 !
JS_CLASS_ARRAY
 &&

33376 
p
->
˛ass_id
 !
JS_CLASS_OBJECT
) {

33377 
	`JS_ThrowTy≥Eº‹
(
s
->
˘x
, "unsupported object class");

33378 
Áû
;

33380 i‡(
p
->
tmp_m¨k
) {

33381 
	`JS_ThrowTy≥Eº‹
(
s
->
˘x
, "circularÑeference");

33382 
Áû
;

33384 
p
->
tmp_m¨k
 = 1;

33385 i‡(
p
->
˛ass_id
 =
JS_CLASS_ARRAY
) {

33386 i‡(
s
->
Ælow_byãcode
 && !
p
->
exãnsibÀ
) {

33389 
	`bc_put_u8
(
s
, 
BC_TAG_TEMPLATE_OBJECT
);

33390 
is_ãm∂©e
 = 
TRUE
;

33392 
	`bc_put_u8
(
s
, 
BC_TAG_ARRAY
);

33393 
is_ãm∂©e
 = 
FALSE
;

33395 i‡(
	`js_gë_Àngth32
(
s
->
˘x
, &
Àn
, 
obj
))

33396 
Áû1
;

33397 
	`bc_put_Àb128
(
s
, 
Àn
);

33398 
i
 = 0; i < 
Àn
; i++) {

33399 
vÆ
 = 
	`JS_GëPr›îtyUöt32
(
s
->
˘x
, 
obj
, 
i
);

33400 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

33401 
Áû1
;

33402 
ªt
 = 
	`JS_WrôeObje˘Rec
(
s
, 
vÆ
);

33403 
	`JS_FªeVÆue
(
s
->
˘x
, 
vÆ
);

33404 i‡(
ªt
)

33405 
Áû1
;

33407 i‡(
is_ãm∂©e
) {

33408 
vÆ
 = 
	`JS_GëPr›îty
(
s
->
˘x
, 
obj
, 
JS_ATOM_øw
);

33409 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

33410 
Áû1
;

33411 
ªt
 = 
	`JS_WrôeObje˘Rec
(
s
, 
vÆ
);

33412 
	`JS_FªeVÆue
(
s
->
˘x
, 
vÆ
);

33413 i‡(
ªt
)

33414 
Áû1
;

33417 
	`bc_put_u8
(
s
, 
BC_TAG_OBJECT
);

33418 
¥›_cou¡
 = 0;

33419 
sh
 = 
p
->
sh≠e
;

33420 
∑ss
 = 0;Öass < 2;Öass++) {

33421 i‡(
∑ss
 == 1)

33422 
	`bc_put_Àb128
(
s
, 
¥›_cou¡
);

33423 
i
 = 0, 
¥
 = 
	`gë_sh≠e_¥›
(
sh
); i < sh->
¥›_cou¡
; i++,Ör++) {

33424 
©om
 = 
¥
->atom;

33425 i‡(
©om
 !
JS_ATOM_NULL
 &&

33426 
	`JS_AtomIsSåög
(
s
->
˘x
, 
©om
) &&

33427 (
¥
->
Êags
 & 
JS_PROP_ENUMERABLE
)) {

33428 i‡(
¥
->
Êags
 & 
JS_PROP_TMASK
) {

33429 
	`JS_ThrowTy≥Eº‹
(
s
->
˘x
, "only valueÖropertiesáre supported");

33430 
Áû
;

33432 i‡(
∑ss
 == 0) {

33433 
¥›_cou¡
++;

33435 
	`bc_put_©om
(
s
, 
©om
);

33436 i‡(
	`JS_WrôeObje˘Rec
(
s
, 
p
->
¥›
[
i
].
u
.
vÆue
)) {

33437 
Áû1
:

33438 
p
->
tmp_m¨k
 = 0;

33439 
Áû
;

33446 
p
->
tmp_m¨k
 = 0;

33449 #ifde‡
CONFIG_BIGNUM


33450 
JS_TAG_BIG_INT
:

33451 
JS_TAG_BIG_FLOAT
:

33452 
JS_TAG_BIG_DECIMAL
:

33453 i‡(
	`JS_WrôeBigNum
(
s
, 
obj
))

33454 
Áû
;

33458 
övÆid_èg
:

33459 
	`JS_ThrowI¡î«lEº‹
(
s
->
˘x
, "unsuµ‹ãdÅag (%d)", 
èg
);

33460 
Áû
;

33464 
Áû
:

33466 
	}
}

33469 
	$JS_WrôeObje˘Atoms
(
BCWrôîSèã
 *
s
)

33471 
JSRu¡ime
 *
π
 = 
s
->
˘x
->rt;

33472 
DynBuf
 
dbuf1
;

33473 
i
, 
©oms_size
;

33474 
uöt8_t
 
vîsi⁄
;

33476 
dbuf1
 = 
s
->
dbuf
;

33477 
	`js_dbuf_öô
(
s
->
˘x
, &s->
dbuf
);

33479 
vîsi⁄
 = 
BC_VERSION
;

33480 i‡(
s
->
byã_sw≠
)

33481 
vîsi⁄
 ^
BC_BE_VERSION
;

33482 
	`bc_put_u8
(
s
, 
vîsi⁄
);

33484 
	`bc_put_Àb128
(
s
, s->
idx_to_©om_cou¡
);

33485 
i
 = 0; i < 
s
->
idx_to_©om_cou¡
; i++) {

33486 
JSAtomSåu˘
 *
p
 = 
π
->
©om_¨øy
[
s
->
idx_to_©om
[
i
]];

33487 
	`JS_WrôeSåög
(
s
, 
p
);

33494 
©oms_size
 = 
s
->
dbuf
.
size
;

33495 i‡(
	`dbuf_ªÆloc
(&
dbuf1
, dbuf1.
size
 + 
©oms_size
))

33496 
Áû
;

33497 
	`memmove
(
dbuf1
.
buf
 + 
©oms_size
, dbuf1.buf, dbuf1.
size
);

33498 
	`mem˝y
(
dbuf1
.
buf
, 
s
->
dbuf
.buf, 
©oms_size
);

33499 
dbuf1
.
size
 +
©oms_size
;

33500 
	`dbuf_‰ì
(&
s
->
dbuf
);

33501 
s
->
dbuf
 = 
dbuf1
;

33503 
Áû
:

33504 
	`dbuf_‰ì
(&
dbuf1
);

33506 
	}
}

33508 
uöt8_t
 *
	$JS_WrôeObje˘
(
JSC⁄ãxt
 *
˘x
, 
size_t
 *
psize
, 
JSVÆueC⁄°
 
obj
,

33509 
Êags
)

33511 
BCWrôîSèã
 
ss
, *
s
 = &ss;

33513 
	`mem£t
(
s
, 0, (*s));

33514 
s
->
˘x
 = ctx;

33516 
s
->
byã_sw≠
 = ((
Êags
 & 
JS_WRITE_OBJ_BSWAP
) != 0);

33517 
s
->
Ælow_byãcode
 = ((
Êags
 & 
JS_WRITE_OBJ_BYTECODE
) != 0);

33519 i‡(
s
->
Ælow_byãcode
)

33520 
s
->
fú°_©om
 = 
JS_ATOM_END
;

33522 
s
->
fú°_©om
 = 1;

33523 
	`js_dbuf_öô
(
˘x
, &
s
->
dbuf
);

33525 i‡(
	`JS_WrôeObje˘Rec
(
s
, 
obj
))

33526 
Áû
;

33527 i‡(
	`JS_WrôeObje˘Atoms
(
s
))

33528 
Áû
;

33529 
	`js_‰ì
(
˘x
, 
s
->
©om_to_idx
);

33530 
	`js_‰ì
(
˘x
, 
s
->
idx_to_©om
);

33531 *
psize
 = 
s
->
dbuf
.
size
;

33532  
s
->
dbuf
.
buf
;

33533 
Áû
:

33534 
	`js_‰ì
(
˘x
, 
s
->
©om_to_idx
);

33535 
	`js_‰ì
(
˘x
, 
s
->
idx_to_©om
);

33536 
	`dbuf_‰ì
(&
s
->
dbuf
);

33537 *
psize
 = 0;

33538  
NULL
;

33539 
	}
}

33541 
	sBCRódîSèã
 {

33542 
JSC⁄ãxt
 *
	m˘x
;

33543 c⁄° 
uöt8_t
 *
	mbuf_°¨t
, *
	m±r
, *
	mbuf_íd
;

33544 
uöt32_t
 
	mfú°_©om
;

33545 
uöt32_t
 
	midx_to_©om_cou¡
;

33546 
JSAtom
 *
	midx_to_©om
;

33547 
	mîr‹_°©e
;

33548 
BOOL
 
	mÆlow_byãcode
;

33549 
BOOL
 
	mis_rom_d©a
;

33550 #ifde‡
DUMP_READ_OBJECT


33551 c⁄° 
uöt8_t
 *
	m±r_œ°
;

33552 
	mÀvñ
;

33554 } 
	tBCRódîSèã
;

33556 #ifde‡
DUMP_READ_OBJECT


33557 
__©åibuã__
((
	$f‹m©
(
¥ötf
, 2, 3))Ë
	$bc_ªad_åa˚
(
BCRódîSèã
 *
s
, c⁄° *
fmt
, ...) {

33558 
va_li°
 
≠
;

33559 
i
, 
n
, 
n0
;

33561 i‡(!
s
->
±r_œ°
)

33562 
s
->
±r_œ°
 = s->
buf_°¨t
;

33564 
n
 = 
n0
 = 0;

33565 i‡(
s
->
±r
 > s->
±r_œ°
 || s->±∏=s->
buf_°¨t
) {

33566 
n0
 = 
	`¥ötf
("%04x: ", ()(
s
->
±r_œ°
 - s->
buf_°¨t
));

33567 
n
 +
n0
;

33569 
i
 = 0; 
s
->
±r_œ°
 < s->
±r
; i++) {

33570 i‡((
i
 & 7) == 0 && i > 0) {

33571 
	`¥ötf
("\n%*s", 
n0
, "");

33572 
n
 = 
n0
;

33574 
n
 +
	`¥ötf
(" %02x", *
s
->
±r_œ°
++);

33576 i‡(*
fmt
 == '}')

33577 
s
->
Àvñ
--;

33578 i‡(
n
 < 32 + 
s
->
Àvñ
 * 2) {

33579 
	`¥ötf
("%*s", 32 + 
s
->
Àvñ
 * 2 - 
n
, "");

33581 
	`va_°¨t
(
≠
, 
fmt
);

33582 
	`vÂrötf
(
°dout
, 
fmt
, 
≠
);

33583 
	`va_íd
(
≠
);

33584 i‡(
	`°rchr
(
fmt
, '{'))

33585 
s
->
Àvñ
++;

33586 
	}
}

33588 
	#bc_ªad_åa˚
(...)

	)

33591 
	$bc_ªad_îr‹_íd
(
BCRódîSèã
 *
s
)

33593 i‡(!
s
->
îr‹_°©e
) {

33594 
	`JS_ThrowSy¡axEº‹
(
s
->
˘x
, "readáfterÅheÉnd ofÅhe buffer");

33596  
s
->
îr‹_°©e
 = -1;

33597 
	}
}

33599 
	$bc_gë_u8
(
BCRódîSèã
 *
s
, 
uöt8_t
 *
pvÆ
)

33601 i‡(
	`u∆ikñy
(
s
->
buf_íd
 - s->
±r
 < 1)) {

33602 *
pvÆ
 = 0;

33603  
	`bc_ªad_îr‹_íd
(
s
);

33605 *
pvÆ
 = *
s
->
±r
++;

33607 
	}
}

33609 
	$bc_gë_u16
(
BCRódîSèã
 *
s
, 
uöt16_t
 *
pvÆ
)

33611 i‡(
	`u∆ikñy
(
s
->
buf_íd
 - s->
±r
 < 2)) {

33612 *
pvÆ
 = 0;

33613  
	`bc_ªad_îr‹_íd
(
s
);

33615 *
pvÆ
 = 
	`gë_u16
(
s
->
±r
);

33616 
s
->
±r
 += 2;

33618 
	}
}

33620 
__maybe_unu£d
 
	$bc_gë_u32
(
BCRódîSèã
 *
s
, 
uöt32_t
 *
pvÆ
)

33622 i‡(
	`u∆ikñy
(
s
->
buf_íd
 - s->
±r
 < 4)) {

33623 *
pvÆ
 = 0;

33624  
	`bc_ªad_îr‹_íd
(
s
);

33626 *
pvÆ
 = 
	`gë_u32
(
s
->
±r
);

33627 
s
->
±r
 += 4;

33629 
	}
}

33631 
	$bc_gë_u64
(
BCRódîSèã
 *
s
, 
uöt64_t
 *
pvÆ
)

33633 i‡(
	`u∆ikñy
(
s
->
buf_íd
 - s->
±r
 < 8)) {

33634 *
pvÆ
 = 0;

33635  
	`bc_ªad_îr‹_íd
(
s
);

33637 *
pvÆ
 = 
	`gë_u64
(
s
->
±r
);

33638 
s
->
±r
 += 8;

33640 
	}
}

33642 
	$bc_gë_Àb128
(
BCRódîSèã
 *
s
, 
uöt32_t
 *
pvÆ
)

33644 
ªt
;

33645 
ªt
 = 
	`gë_Àb128
(
pvÆ
, 
s
->
±r
, s->
buf_íd
);

33646 i‡(
	`u∆ikñy
(
ªt
 < 0))

33647  
	`bc_ªad_îr‹_íd
(
s
);

33648 
s
->
±r
 +
ªt
;

33650 
	}
}

33652 
	$bc_gë_¶eb128
(
BCRódîSèã
 *
s
, 
öt32_t
 *
pvÆ
)

33654 
ªt
;

33655 
ªt
 = 
	`gë_¶eb128
(
pvÆ
, 
s
->
±r
, s->
buf_íd
);

33656 i‡(
	`u∆ikñy
(
ªt
 < 0))

33657  
	`bc_ªad_îr‹_íd
(
s
);

33658 
s
->
±r
 +
ªt
;

33660 
	}
}

33663 
	$bc_gë_Àb128_öt
(
BCRódîSèã
 *
s
, *
pvÆ
)

33665  
	`bc_gë_Àb128
(
s
, (
uöt32_t
 *)
pvÆ
);

33666 
	}
}

33668 
	$bc_gë_Àb128_u16
(
BCRódîSèã
 *
s
, 
uöt16_t
 *
pvÆ
)

33670 
uöt32_t
 
vÆ
;

33671 i‡(
	`bc_gë_Àb128
(
s
, &
vÆ
)) {

33672 *
pvÆ
 = 0;

33675 *
pvÆ
 = 
vÆ
;

33677 
	}
}

33679 
	$bc_gë_buf
(
BCRódîSèã
 *
s
, 
uöt8_t
 *
buf
, 
uöt32_t
 
buf_Àn
)

33681 i‡(
buf_Àn
 != 0) {

33682 i‡(
	`u∆ikñy
(!
buf
 || 
s
->
buf_íd
 - s->
±r
 < 
buf_Àn
))

33683  
	`bc_ªad_îr‹_íd
(
s
);

33684 
	`mem˝y
(
buf
, 
s
->
±r
, 
buf_Àn
);

33685 
s
->
±r
 +
buf_Àn
;

33688 
	}
}

33690 
	$bc_idx_to_©om
(
BCRódîSèã
 *
s
, 
JSAtom
 *
∑tom
, 
uöt32_t
 
idx
)

33692 
JSAtom
 
©om
;

33694 i‡(
	`__JS_AtomIsTaggedI¡
(
idx
)) {

33695 
©om
 = 
idx
;

33696 } i‡(
idx
 < 
s
->
fú°_©om
) {

33697 
©om
 = 
	`JS_DupAtom
(
s
->
˘x
, 
idx
);

33699 
idx
 -
s
->
fú°_©om
;

33700 i‡(
idx
 >
s
->
idx_to_©om_cou¡
) {

33701 
	`JS_ThrowSy¡axEº‹
(
s
->
˘x
, "invalidátom index (pos=%u)",

33702 ()(
s
->
±r
 - s->
buf_°¨t
));

33703 *
∑tom
 = 
JS_ATOM_NULL
;

33704  
s
->
îr‹_°©e
 = -1;

33706 
©om
 = 
	`JS_DupAtom
(
s
->
˘x
, s->
idx_to_©om
[
idx
]);

33708 *
∑tom
 = 
©om
;

33710 
	}
}

33712 
	$bc_gë_©om
(
BCRódîSèã
 *
s
, 
JSAtom
 *
∑tom
)

33714 
uöt32_t
 
v
;

33715 i‡(
	`bc_gë_Àb128
(
s
, &
v
))

33717 i‡(
v
 & 1) {

33718 *
∑tom
 = 
	`__JS_AtomFromUI¡32
(
v
 >> 1);

33721  
	`bc_idx_to_©om
(
s
, 
∑tom
, 
v
 >> 1);

33723 
	}
}

33725 
JSSåög
 *
	$JS_RódSåög
(
BCRódîSèã
 *
s
)

33727 
uöt32_t
 
Àn
;

33728 
size_t
 
size
;

33729 
BOOL
 
is_wide_ch¨
;

33730 
JSSåög
 *
p
;

33732 i‡(
	`bc_gë_Àb128
(
s
, &
Àn
))

33733  
NULL
;

33734 
is_wide_ch¨
 = 
Àn
 & 1;

33735 
Àn
 >>= 1;

33736 
p
 = 
	`js_Æloc_°rög
(
s
->
˘x
, 
Àn
, 
is_wide_ch¨
);

33737 i‡(!
p
) {

33738 
s
->
îr‹_°©e
 = -1;

33739  
NULL
;

33741 
size
 = (
size_t
)
Àn
 << 
is_wide_ch¨
;

33742 i‡((
s
->
buf_íd
 - s->
±r
Ë< 
size
) {

33743 
	`bc_ªad_îr‹_íd
(
s
);

33744 
	`js_‰ì_°rög
(
s
->
˘x
->
π
, 
p
);

33745  
NULL
;

33747 
	`mem˝y
(
p
->
u
.
°r8
, 
s
->
±r
, 
size
);

33748 
s
->
±r
 +
size
;

33749 i‡(!
is_wide_ch¨
) {

33750 
p
->
u
.
°r8
[
size
] = '\0';

33752 #ifde‡
DUMP_READ_OBJECT


33753 
	`bc_ªad_åa˚
(
s
, "°rög: "); 
	`JS_DumpSåög
(s->
˘x
->
π
, 
p
); 
	`¥ötf
("\n");

33755  
p
;

33756 
	}
}

33758 
uöt32_t
 
	$bc_gë_Êags
(
uöt32_t
 
Êags
, *
pidx
, 
n
)

33760 
uöt32_t
 
vÆ
;

33762 
vÆ
 = (
Êags
 >> *
pidx
Ë& ((1U << 
n
) - 1);

33763 *
pidx
 +
n
;

33764  
vÆ
;

33765 
	}
}

33767 
	$JS_RódFun˘i⁄Byãcode
(
BCRódîSèã
 *
s
, 
JSFun˘i⁄Byãcode
 *
b
,

33768 
byã_code_off£t
, 
uöt32_t
 
bc_Àn
)

33770 
uöt8_t
 *
bc_buf
;

33771 
pos
, 
Àn
, 
›
;

33772 
JSAtom
 
©om
;

33773 
uöt32_t
 
idx
;

33775 i‡(
s
->
is_rom_d©a
) {

33777 i‡(
	`u∆ikñy
(
s
->
buf_íd
 - s->
±r
 < 
bc_Àn
))

33778  
	`bc_ªad_îr‹_íd
(
s
);

33779 
bc_buf
 = (
uöt8_t
 *)
s
->
±r
;

33780 
s
->
±r
 +
bc_Àn
;

33782 
bc_buf
 = (*)((
uöt8_t
*)
b
 + 
byã_code_off£t
);

33783 i‡(
	`bc_gë_buf
(
s
, 
bc_buf
, 
bc_Àn
))

33786 
b
->
byã_code_buf
 = 
bc_buf
;

33788 
pos
 = 0;

33789 
pos
 < 
bc_Àn
) {

33790 
›
 = 
bc_buf
[
pos
];

33791 
Àn
 = 
	`sh‹t_›code_öfo
(
›
).
size
;

33792 
	`sh‹t_›code_öfo
(
›
).
fmt
) {

33793 
OP_FMT_©om
:

33794 
OP_FMT_©om_u8
:

33795 
OP_FMT_©om_u16
:

33796 
OP_FMT_©om_œbñ_u8
:

33797 
OP_FMT_©om_œbñ_u16
:

33798 
idx
 = 
	`gë_u32
(
bc_buf
 + 
pos
 + 1);

33799 i‡(
s
->
is_rom_d©a
) {

33801 
	`JS_DupAtom
(
s
->
˘x
, (
JSAtom
)
idx
);

33803 i‡(
	`bc_idx_to_©om
(
s
, &
©om
, 
idx
)) {

33805 
b
->
byã_code_Àn
 = 
pos
;

33808 
	`put_u32
(
bc_buf
 + 
pos
 + 1, 
©om
);

33809 #ifde‡
DUMP_READ_OBJECT


33810 
	`bc_ªad_åa˚
(
s
, "© %d, fixu∞©om: ", 
pos
 + 1); 
	`¥öt_©om
(s->
˘x
, 
©om
); 
	`¥ötf
("\n");

33817 
pos
 +
Àn
;

33820 
	}
}

33822 #ifde‡
CONFIG_BIGNUM


33823 
JSVÆue
 
	$JS_RódBigNum
(
BCRódîSèã
 *
s
, 
èg
)

33825 
JSVÆue
 
obj
 = 
JS_UNDEFINED
;

33826 
uöt8_t
 
v8
;

33827 
öt32_t
 
e
;

33828 
uöt32_t
 
Àn
;

33829 
limb_t
 
l
, 
i
, 
n
, 
j
;

33830 
JSBigFlﬂt
 *
p
;

33831 
limb_t
 
v
;

33832 
bf_t
 *
a
;

33833 
bpos
, 
d
;

33835 
	`bc_ªad_åa˚
(
s
, "%†{\n", 
bc_èg_°r
[
èg
]);

33837 
p
 = 
	`js_√w_bf
(
s
->
˘x
);

33838 i‡(!
p
)

33839 
Áû
;

33840 
èg
) {

33841 
BC_TAG_BIG_INT
:

33842 
obj
 = 
	`JS_MKPTR
(
JS_TAG_BIG_INT
, 
p
);

33844 
BC_TAG_BIG_FLOAT
:

33845 
obj
 = 
	`JS_MKPTR
(
JS_TAG_BIG_FLOAT
, 
p
);

33847 
BC_TAG_BIG_DECIMAL
:

33848 
obj
 = 
	`JS_MKPTR
(
JS_TAG_BIG_DECIMAL
, 
p
);

33851 
	`ab‹t
();

33855 i‡(
	`bc_gë_¶eb128
(
s
, &
e
))

33856 
Áû
;

33858 
a
 = &
p
->
num
;

33859 
a
->
sign
 = 
e
 & 1;

33860 
e
 >>= 1;

33861 i‡(
e
 == 0)

33862 
a
->
ex≤
 = 
BF_EXP_ZERO
;

33863 i‡(
e
 == 1)

33864 
a
->
ex≤
 = 
BF_EXP_INF
;

33865 i‡(
e
 == 2)

33866 
a
->
ex≤
 = 
BF_EXP_NAN
;

33867 i‡(
e
 >= 3)

33868 
a
->
ex≤
 = 
e
 - 3;

33870 
a
->
ex≤
 = 
e
;

33873 i‡(
a
->
ex≤
 !
BF_EXP_ZERO
 &&

33874 
a
->
ex≤
 !
BF_EXP_INF
 &&

33875 
a
->
ex≤
 !
BF_EXP_NAN
) {

33876 i‡(
	`bc_gë_Àb128
(
s
, &
Àn
))

33877 
Áû
;

33878 
	`bc_ªad_åa˚
(
s
, "Àn=%" 
PRId64
 "\n", (
öt64_t
)
Àn
);

33879 i‡(
Àn
 == 0) {

33880 
	`JS_ThrowI¡î«lEº‹
(
s
->
˘x
, "invalid bignumÜength");

33881 
Áû
;

33883 i‡(
èg
 !
BC_TAG_BIG_DECIMAL
)

33884 
l
 = (
Àn
 + (
limb_t
) - 1) / (limb_t);

33886 
l
 = (
Àn
 + 
LIMB_DIGITS
 - 1) / LIMB_DIGITS;

33887 i‡(
	`bf_ªsize
(
a
, 
l
)) {

33888 
	`JS_ThrowOutOfMem‹y
(
s
->
˘x
);

33889 
Áû
;

33891 i‡(
èg
 !
BC_TAG_BIG_DECIMAL
) {

33892 
n
 = 
Àn
 & ((
limb_t
) - 1);

33893 i‡(
n
 != 0) {

33894 
v
 = 0;

33895 
i
 = 0; i < 
n
; i++) {

33896 i‡(
	`bc_gë_u8
(
s
, &
v8
))

33897 
Áû
;

33898 
v
 |(
limb_t
)
v8
 << ((÷imb_tË- 
n
 + 
i
) * 8);

33900 
a
->
èb
[0] = 
v
;

33901 
i
 = 1;

33903 
i
 = 0;

33905 ; 
i
 < 
l
; i++) {

33906 #i‡
LIMB_BITS
 == 32

33907 i‡(
	`bc_gë_u32
(
s
, &
v
))

33908 
Áû
;

33909 #ifde‡
WORDS_BIGENDIAN


33910 
v
 = 
	`bsw≠32
(v);

33913 i‡(
	`bc_gë_u64
(
s
, &
v
))

33914 
Áû
;

33915 #ifde‡
WORDS_BIGENDIAN


33916 
v
 = 
	`bsw≠64
(v);

33919 
a
->
èb
[
i
] = 
v
;

33922 
bpos
 = 0;

33923 
i
 = 0; i < 
l
; i++) {

33924 i‡(
i
 =0 && (
n
 = 
Àn
 % 
LIMB_DIGITS
) != 0) {

33925 
j
 = 
LIMB_DIGITS
 - 
n
;

33927 
j
 = 0;

33929 
v
 = 0;

33930 ; 
j
 < 
LIMB_DIGITS
; j++) {

33931 i‡(
bpos
 == 0) {

33932 i‡(
	`bc_gë_u8
(
s
, &
v8
))

33933 
Áû
;

33934 
d
 = 
v8
 & 0xf;

33935 
bpos
 = 1;

33937 
d
 = 
v8
 >> 4;

33938 
bpos
 = 0;

33940 i‡(
d
 >= 10) {

33941 
	`JS_ThrowI¡î«lEº‹
(
s
->
˘x
, "invalid digit");

33942 
Áû
;

33944 
v
 +
mp_pow_dec
[
j
] * 
d
;

33946 
a
->
èb
[
i
] = 
v
;

33950 
	`bc_ªad_åa˚
(
s
, "}\n");

33951  
obj
;

33952 
Áû
:

33953 
	`JS_FªeVÆue
(
s
->
˘x
, 
obj
);

33954  
JS_EXCEPTION
;

33955 
	}
}

33958 
JSVÆue
 
	$JS_RódObje˘Rec
(
BCRódîSèã
 *
s
)

33960 
JSC⁄ãxt
 *
˘x
 = 
s
->ctx;

33961 
uöt8_t
 
èg
;

33962 
JSVÆue
 
obj
 = 
JS_UNDEFINED
;

33963 
JSModuÀDef
 *
m
 = 
NULL
;

33965 i‡(
	`bc_gë_u8
(
s
, &
èg
))

33966  
JS_EXCEPTION
;

33968 
èg
) {

33969 
BC_TAG_NULL
:

33970 
	`bc_ªad_åa˚
(
s
, "null\n");

33971 
obj
 = 
JS_NULL
;

33973 
BC_TAG_UNDEFINED
:

33974 
	`bc_ªad_åa˚
(
s
, "undefined\n");

33975 
obj
 = 
JS_UNDEFINED
;

33977 
BC_TAG_BOOL_FALSE
:

33978 
BC_TAG_BOOL_TRUE
:

33979 
	`bc_ªad_åa˚
(
s
, "%s\n", 
bc_èg_°r
[
èg
]);

33980 
obj
 = 
	`JS_NewBoﬁ
(
˘x
, 
èg
 - 
BC_TAG_BOOL_FALSE
);

33982 
BC_TAG_INT32
:

33984 
öt32_t
 
vÆ
;

33985 i‡(
	`bc_gë_¶eb128
(
s
, &
vÆ
))

33986  
JS_EXCEPTION
;

33987 
	`bc_ªad_åa˚
(
s
, "öt32 %d\n", 
vÆ
);

33988 
obj
 = 
	`JS_NewI¡32
(
˘x
, 
vÆ
);

33991 
BC_TAG_FLOAT64
:

33993 
JSFlﬂt64Uni⁄
 
u
;

33994 i‡(
	`bc_gë_u64
(
s
, &
u
.
u64
))

33995  
JS_EXCEPTION
;

33996 
	`bc_ªad_åa˚
(
s
, "Êﬂt64 %g\n", 
u
.
d
);

33997 
obj
 = 
	`__JS_NewFlﬂt64
(
˘x
, 
u
.
d
);

34000 
BC_TAG_STRING
:

34002 
JSSåög
 *
p
;

34003 
p
 = 
	`JS_RódSåög
(
s
);

34004 i‡(!
p
)

34005  
JS_EXCEPTION
;

34006 
obj
 = 
	`JS_MKPTR
(
JS_TAG_STRING
, 
p
);

34009 
BC_TAG_FUNCTION_BYTECODE
:

34011 
JSFun˘i⁄Byãcode
 
bc
, *
b
;

34012 
uöt16_t
 
v16
;

34013 
uöt8_t
 
v8
;

34014 
idx
, 
i
, 
loˇl_cou¡
;

34015 
fun˘i⁄_size
, 
˝oﬁ_off£t
, 
byã_code_off£t
;

34016 
˛osuª_v¨_off£t
, 
v¨defs_off£t
;

34018 i‡(!
s
->
Ælow_byãcode
)

34019 
övÆid_èg
;

34020 
	`bc_ªad_åa˚
(
s
, "%†{\n", 
bc_èg_°r
[
èg
]);

34022 
	`mem£t
(&
bc
, 0, (bc));

34023 
bc
.
hódî
.
ªf_cou¡
 = 1;

34026 i‡(
	`bc_gë_u16
(
s
, &
v16
))

34027 
Áû
;

34028 
idx
 = 0;

34029 
bc
.
has_¥ŸŸy≥
 = 
	`bc_gë_Êags
(
v16
, &
idx
, 1);

34030 
bc
.
has_sim∂e_∑ømëî_li°
 = 
	`bc_gë_Êags
(
v16
, &
idx
, 1);

34031 
bc
.
is_dîived_˛ass_c⁄°ru˘‹
 = 
	`bc_gë_Êags
(
v16
, &
idx
, 1);

34032 
bc
.
√ed_home_obje˘
 = 
	`bc_gë_Êags
(
v16
, &
idx
, 1);

34033 
bc
.
func_köd
 = 
	`bc_gë_Êags
(
v16
, &
idx
, 2);

34034 
bc
.
√w_èrgë_Ælowed
 = 
	`bc_gë_Êags
(
v16
, &
idx
, 1);

34035 
bc
.
su≥r_ˇŒ_Ælowed
 = 
	`bc_gë_Êags
(
v16
, &
idx
, 1);

34036 
bc
.
su≥r_Ælowed
 = 
	`bc_gë_Êags
(
v16
, &
idx
, 1);

34037 
bc
.
¨gumíts_Ælowed
 = 
	`bc_gë_Êags
(
v16
, &
idx
, 1);

34038 
bc
.
has_debug
 = 
	`bc_gë_Êags
(
v16
, &
idx
, 1);

34039 
bc
.
backåa˚_b¨rõr
 = 
	`bc_gë_Êags
(
v16
, &
idx
, 1);

34040 
bc
.
ªad_⁄ly_byãcode
 = 
s
->
is_rom_d©a
;

34041 i‡(
	`bc_gë_u8
(
s
, &
v8
))

34042 
Áû
;

34043 
bc
.
js_mode
 = 
v8
;

34044 i‡(
	`bc_gë_©om
(
s
, &
bc
.
func_«me
))

34045 
Áû
;

34046 i‡(
	`bc_gë_Àb128_u16
(
s
, &
bc
.
¨g_cou¡
))

34047 
Áû
;

34048 i‡(
	`bc_gë_Àb128_u16
(
s
, &
bc
.
v¨_cou¡
))

34049 
Áû
;

34050 i‡(
	`bc_gë_Àb128_u16
(
s
, &
bc
.
deföed_¨g_cou¡
))

34051 
Áû
;

34052 i‡(
	`bc_gë_Àb128_u16
(
s
, &
bc
.
°ack_size
))

34053 
Áû
;

34054 i‡(
	`bc_gë_Àb128_öt
(
s
, &
bc
.
˛osuª_v¨_cou¡
))

34055 
Áû
;

34056 i‡(
	`bc_gë_Àb128_öt
(
s
, &
bc
.
˝oﬁ_cou¡
))

34057 
Áû
;

34058 i‡(
	`bc_gë_Àb128_öt
(
s
, &
bc
.
byã_code_Àn
))

34059 
Áû
;

34060 i‡(
	`bc_gë_Àb128_öt
(
s
, &
loˇl_cou¡
))

34061 
Áû
;

34063 i‡(
bc
.
has_debug
) {

34064 
fun˘i⁄_size
 = (*
b
);

34066 
fun˘i⁄_size
 = 
	`off£tof
(
JSFun˘i⁄Byãcode
, 
debug
);

34068 
˝oﬁ_off£t
 = 
fun˘i⁄_size
;

34069 
fun˘i⁄_size
 +
bc
.
˝oﬁ_cou¡
 * (*bc.
˝oﬁ
);

34070 
v¨defs_off£t
 = 
fun˘i⁄_size
;

34071 
fun˘i⁄_size
 +
loˇl_cou¡
 * (*
bc
.
v¨defs
);

34072 
˛osuª_v¨_off£t
 = 
fun˘i⁄_size
;

34073 
fun˘i⁄_size
 +
bc
.
˛osuª_v¨_cou¡
 * (*bc.
˛osuª_v¨
);

34074 
byã_code_off£t
 = 
fun˘i⁄_size
;

34075 i‡(!
bc
.
ªad_⁄ly_byãcode
) {

34076 
fun˘i⁄_size
 +
bc
.
byã_code_Àn
;

34079 
b
 = 
	`js_mÆlocz
(
˘x
, 
fun˘i⁄_size
);

34080 i‡(!
b
)

34081  
JS_EXCEPTION
;

34083 
	`mem˝y
(
b
, &
bc
, 
	`off£tof
(
JSFun˘i⁄Byãcode
, 
debug
));

34084 
b
->
hódî
.
ªf_cou¡
 = 1;

34085 
	`add_gc_obje˘
(
˘x
->
π
, &
b
->
hódî
, 
JS_GC_OBJ_TYPE_FUNCTION_BYTECODE
);

34087 
obj
 = 
	`JS_MKPTR
(
JS_TAG_FUNCTION_BYTECODE
, 
b
);

34089 #ifde‡
DUMP_READ_OBJECT


34090 
	`bc_ªad_åa˚
(
s
, "«me: "); 
	`¥öt_©om
(s->
˘x
, 
b
->
func_«me
); 
	`¥ötf
("\n");

34092 
	`bc_ªad_åa˚
(
s
, "args=%d vars=%d defargs=%d closures=%d cpool=%d\n",

34093 
b
->
¨g_cou¡
, b->
v¨_cou¡
, b->
deföed_¨g_cou¡
,

34094 
b
->
˛osuª_v¨_cou¡
, b->
˝oﬁ_cou¡
);

34095 
	`bc_ªad_åa˚
(
s
, "stack=%d bclen=%dÜocals=%d\n",

34096 
b
->
°ack_size
, b->
byã_code_Àn
, 
loˇl_cou¡
);

34098 i‡(
loˇl_cou¡
 != 0) {

34099 
	`bc_ªad_åa˚
(
s
, "vars {\n");

34100 
b
->
v¨defs
 = (*)((
uöt8_t
*)b + 
v¨defs_off£t
);

34101 
i
 = 0; i < 
loˇl_cou¡
; i++) {

34102 
JSV¨Def
 *
vd
 = &
b
->
v¨defs
[
i
];

34103 i‡(
	`bc_gë_©om
(
s
, &
vd
->
v¨_«me
))

34104 
Áû
;

34105 i‡(
	`bc_gë_Àb128_öt
(
s
, &
vd
->
sc›e_Àvñ
))

34106 
Áû
;

34107 i‡(
	`bc_gë_Àb128_öt
(
s
, &
vd
->
sc›e_√xt
))

34108 
Áû
;

34109 
vd
->
sc›e_√xt
--;

34110 i‡(
	`bc_gë_u8
(
s
, &
v8
))

34111 
Áû
;

34112 
idx
 = 0;

34113 
vd
->
v¨_köd
 = 
	`bc_gë_Êags
(
v8
, &
idx
, 4);

34114 
vd
->
is_func_v¨
 = 
	`bc_gë_Êags
(
v8
, &
idx
, 1);

34115 
vd
->
is_c⁄°
 = 
	`bc_gë_Êags
(
v8
, &
idx
, 1);

34116 
vd
->
is_Àxiˇl
 = 
	`bc_gë_Êags
(
v8
, &
idx
, 1);

34117 
vd
->
is_ˇ±uªd
 = 
	`bc_gë_Êags
(
v8
, &
idx
, 1);

34118 #ifde‡
DUMP_READ_OBJECT


34119 
	`bc_ªad_åa˚
(
s
, "«me: "); 
	`¥öt_©om
(s->
˘x
, 
vd
->
v¨_«me
); 
	`¥ötf
("\n");

34122 
	`bc_ªad_åa˚
(
s
, "}\n");

34124 i‡(
b
->
˛osuª_v¨_cou¡
 != 0) {

34125 
	`bc_ªad_åa˚
(
s
, "closure vars {\n");

34126 
b
->
˛osuª_v¨
 = (*)((
uöt8_t
*)b + 
˛osuª_v¨_off£t
);

34127 
i
 = 0; i < 
b
->
˛osuª_v¨_cou¡
; i++) {

34128 
JSClosuªV¨
 *
cv
 = &
b
->
˛osuª_v¨
[
i
];

34129 
v¨_idx
;

34130 i‡(
	`bc_gë_©om
(
s
, &
cv
->
v¨_«me
))

34131 
Áû
;

34132 i‡(
	`bc_gë_Àb128_öt
(
s
, &
v¨_idx
))

34133 
Áû
;

34134 
cv
->
v¨_idx
 = var_idx;

34135 i‡(
	`bc_gë_u8
(
s
, &
v8
))

34136 
Áû
;

34137 
idx
 = 0;

34138 
cv
->
is_loˇl
 = 
	`bc_gë_Êags
(
v8
, &
idx
, 1);

34139 
cv
->
is_¨g
 = 
	`bc_gë_Êags
(
v8
, &
idx
, 1);

34140 
cv
->
is_c⁄°
 = 
	`bc_gë_Êags
(
v8
, &
idx
, 1);

34141 
cv
->
is_Àxiˇl
 = 
	`bc_gë_Êags
(
v8
, &
idx
, 1);

34142 
cv
->
v¨_köd
 = 
	`bc_gë_Êags
(
v8
, &
idx
, 4);

34143 #ifde‡
DUMP_READ_OBJECT


34144 
	`bc_ªad_åa˚
(
s
, "«me: "); 
	`¥öt_©om
(s->
˘x
, 
cv
->
v¨_«me
); 
	`¥ötf
("\n");

34147 
	`bc_ªad_åa˚
(
s
, "}\n");

34150 
	`bc_ªad_åa˚
(
s
, "bytecode {\n");

34151 i‡(
	`JS_RódFun˘i⁄Byãcode
(
s
, 
b
, 
byã_code_off£t
, b->
byã_code_Àn
))

34152 
Áû
;

34153 
	`bc_ªad_åa˚
(
s
, "}\n");

34155 i‡(
b
->
has_debug
) {

34157 
	`bc_ªad_åa˚
(
s
, "debug {\n");

34158 i‡(
	`bc_gë_©om
(
s
, &
b
->
debug
.
fûíame
))

34159 
Áû
;

34160 i‡(
	`bc_gë_Àb128_öt
(
s
, &
b
->
debug
.
löe_num
))

34161 
Áû
;

34162 i‡(
	`bc_gë_Àb128_öt
(
s
, &
b
->
debug
.
pc2löe_Àn
))

34163 
Áû
;

34164 i‡(
b
->
debug
.
pc2löe_Àn
) {

34165 
b
->
debug
.
pc2löe_buf
 = 
	`js_mÆlocz
(
˘x
, b->debug.
pc2löe_Àn
);

34166 i‡(!
b
->
debug
.
pc2löe_buf
)

34167 
Áû
;

34168 i‡(
	`bc_gë_buf
(
s
, 
b
->
debug
.
pc2löe_buf
, b->debug.
pc2löe_Àn
))

34169 
Áû
;

34171 #ifde‡
DUMP_READ_OBJECT


34172 
	`bc_ªad_åa˚
(
s
, "fûíame: "); 
	`¥öt_©om
(s->
˘x
, 
b
->
debug
.
fûíame
); 
	`¥ötf
("\n");

34174 
	`bc_ªad_åa˚
(
s
, "}\n");

34176 i‡(
b
->
˝oﬁ_cou¡
 != 0) {

34177 
	`bc_ªad_åa˚
(
s
, "cpool {\n");

34178 
b
->
˝oﬁ
 = (*)((
uöt8_t
*)b + 
˝oﬁ_off£t
);

34179 
i
 = 0; i < 
b
->
˝oﬁ_cou¡
; i++) {

34180 
JSVÆue
 
vÆ
;

34181 
vÆ
 = 
	`JS_RódObje˘Rec
(
s
);

34182 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

34183 
Áû
;

34184 
b
->
˝oﬁ
[
i
] = 
vÆ
;

34186 
	`bc_ªad_åa˚
(
s
, "}\n");

34188 
	`bc_ªad_åa˚
(
s
, "}\n");

34189 
b
->
ªÆm
 = 
	`JS_DupC⁄ãxt
(
˘x
);

34192 
BC_TAG_MODULE
:

34194 
JSAtom
 
moduÀ_«me
;

34195 
i
;

34196 
uöt8_t
 
v8
;

34198 i‡(!
s
->
Ælow_byãcode
)

34199 
övÆid_èg
;

34200 
	`bc_ªad_åa˚
(
s
, "%†{\n", 
bc_èg_°r
[
èg
]);

34201 i‡(
	`bc_gë_©om
(
s
, &
moduÀ_«me
))

34202 
Áû
;

34203 #ifde‡
DUMP_READ_OBJECT


34204 
	`bc_ªad_åa˚
(
s
, "«me: "); 
	`¥öt_©om
(s->
˘x
, 
moduÀ_«me
); 
	`¥ötf
("\n");

34206 
m
 = 
	`js_√w_moduÀ_def
(
˘x
, 
moduÀ_«me
);

34207 i‡(!
m
)

34208 
Áû
;

34209 
obj
 = 
	`JS_DupVÆue
(
˘x
, 
	`JS_MKPTR
(
JS_TAG_MODULE
, 
m
));

34210 i‡(
	`bc_gë_Àb128_öt
(
s
, &
m
->
ªq_moduÀ_íåõs_cou¡
))

34211 
Áû
;

34212 i‡(
m
->
ªq_moduÀ_íåõs_cou¡
 != 0) {

34213 
m
->
ªq_moduÀ_íåõs_size
 = m->
ªq_moduÀ_íåõs_cou¡
;

34214 
m
->
ªq_moduÀ_íåõs
 = 
	`js_mÆlocz
(
˘x
, (m->ªq_moduÀ_íåõs[0]Ë* m->
ªq_moduÀ_íåõs_size
);

34215 i‡(!
m
->
ªq_moduÀ_íåõs
)

34216 
Áû
;

34217 
i
 = 0; i < 
m
->
ªq_moduÀ_íåõs_cou¡
; i++) {

34218 
JSReqModuÀE¡ry
 *
rme
 = &
m
->
ªq_moduÀ_íåõs
[
i
];

34219 i‡(
	`bc_gë_©om
(
s
, &
rme
->
moduÀ_«me
))

34220 
Áû
;

34224 i‡(
	`bc_gë_Àb128_öt
(
s
, &
m
->
exp‹t_íåõs_cou¡
))

34225 
Áû
;

34226 i‡(
m
->
exp‹t_íåõs_cou¡
 != 0) {

34227 
m
->
exp‹t_íåõs_size
 = m->
exp‹t_íåõs_cou¡
;

34228 
m
->
exp‹t_íåõs
 = 
	`js_mÆlocz
(
˘x
, (m->exp‹t_íåõs[0]Ë* m->
exp‹t_íåõs_size
);

34229 i‡(!
m
->
exp‹t_íåõs
)

34230 
Áû
;

34231 
i
 = 0; i < 
m
->
exp‹t_íåõs_cou¡
; i++) {

34232 
JSExp‹tE¡ry
 *
me
 = &
m
->
exp‹t_íåõs
[
i
];

34233 i‡(
	`bc_gë_u8
(
s
, &
v8
))

34234 
Áû
;

34235 
me
->
exp‹t_ty≥
 = 
v8
;

34236 i‡(
me
->
exp‹t_ty≥
 =
JS_EXPORT_TYPE_LOCAL
) {

34237 i‡(
	`bc_gë_Àb128_öt
(
s
, &
me
->
u
.
loˇl
.
v¨_idx
))

34238 
Áû
;

34240 i‡(
	`bc_gë_Àb128_öt
(
s
, &
me
->
u
.
ªq_moduÀ_idx
))

34241 
Áû
;

34242 i‡(
	`bc_gë_©om
(
s
, &
me
->
loˇl_«me
))

34243 
Áû
;

34245 i‡(
	`bc_gë_©om
(
s
, &
me
->
exp‹t_«me
))

34246 
Áû
;

34250 i‡(
	`bc_gë_Àb128_öt
(
s
, &
m
->
°¨_exp‹t_íåõs_cou¡
))

34251 
Áû
;

34252 i‡(
m
->
°¨_exp‹t_íåõs_cou¡
 != 0) {

34253 
m
->
°¨_exp‹t_íåõs_size
 = m->
°¨_exp‹t_íåõs_cou¡
;

34254 
m
->
°¨_exp‹t_íåõs
 = 
	`js_mÆlocz
(
˘x
, (m->°¨_exp‹t_íåõs[0]Ë* m->
°¨_exp‹t_íåõs_size
);

34255 i‡(!
m
->
°¨_exp‹t_íåõs
)

34256 
Áû
;

34257 
i
 = 0; i < 
m
->
°¨_exp‹t_íåõs_cou¡
; i++) {

34258 
JSSèrExp‹tE¡ry
 *
£
 = &
m
->
°¨_exp‹t_íåõs
[
i
];

34259 i‡(
	`bc_gë_Àb128_öt
(
s
, &
£
->
ªq_moduÀ_idx
))

34260 
Áû
;

34264 i‡(
	`bc_gë_Àb128_öt
(
s
, &
m
->
imp‹t_íåõs_cou¡
))

34265 
Áû
;

34266 i‡(
m
->
imp‹t_íåõs_cou¡
 != 0) {

34267 
m
->
imp‹t_íåõs_size
 = m->
imp‹t_íåõs_cou¡
;

34268 
m
->
imp‹t_íåõs
 = 
	`js_mÆlocz
(
˘x
, (m->imp‹t_íåõs[0]Ë* m->
imp‹t_íåõs_size
);

34269 i‡(!
m
->
imp‹t_íåõs
)

34270 
Áû
;

34271 
i
 = 0; i < 
m
->
imp‹t_íåõs_cou¡
; i++) {

34272 
JSImp‹tE¡ry
 *
mi
 = &
m
->
imp‹t_íåõs
[
i
];

34273 i‡(
	`bc_gë_Àb128_öt
(
s
, &
mi
->
v¨_idx
))

34274 
Áû
;

34275 i‡(
	`bc_gë_©om
(
s
, &
mi
->
imp‹t_«me
))

34276 
Áû
;

34277 i‡(
	`bc_gë_Àb128_öt
(
s
, &
mi
->
ªq_moduÀ_idx
))

34278 
Áû
;

34282 
m
->
func_obj
 = 
	`JS_RódObje˘Rec
(
s
);

34283 i‡(
	`JS_IsEx˚±i⁄
(
m
->
func_obj
))

34284 
Áû
;

34285 
	`bc_ªad_åa˚
(
s
, "}\n");

34288 
BC_TAG_OBJECT
:

34290 
uöt32_t
 
¥›_cou¡
, 
i
;

34291 
JSAtom
 
©om
;

34292 
JSVÆue
 
vÆ
;

34293 
ªt
;

34295 
	`bc_ªad_åa˚
(
s
, "%†{\n", 
bc_èg_°r
[
èg
]);

34297 
obj
 = 
	`JS_NewObje˘
(
˘x
);

34298 i‡(
	`bc_gë_Àb128
(
s
, &
¥›_cou¡
))

34299 
Áû
;

34300 
i
 = 0; i < 
¥›_cou¡
; i++) {

34301 i‡(
	`bc_gë_©om
(
s
, &
©om
))

34302 
Áû
;

34303 #ifde‡
DUMP_READ_OBJECT


34304 
	`bc_ªad_åa˚
(
s
, "¥›«me: "); 
	`¥öt_©om
(s->
˘x
, 
©om
); 
	`¥ötf
("\n");

34306 
vÆ
 = 
	`JS_RódObje˘Rec
(
s
);

34307 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
)) {

34308 
	`JS_FªeAtom
(
˘x
, 
©om
);

34309 
Áû
;

34311 
ªt
 = 
	`JS_DeföePr›îtyVÆue
(
˘x
, 
obj
, 
©om
, 
vÆ
, 
JS_PROP_C_W_E
);

34312 
	`JS_FªeAtom
(
˘x
, 
©om
);

34313 i‡(
ªt
 < 0)

34314 
Áû
;

34316 
	`bc_ªad_åa˚
(
s
, "}\n");

34319 
BC_TAG_ARRAY
:

34320 
BC_TAG_TEMPLATE_OBJECT
:

34322 
uöt32_t
 
Àn
, 
i
;

34323 
JSVÆue
 
vÆ
;

34324 
ªt
, 
¥›_Êags
;

34325 
BOOL
 
is_ãm∂©e
;

34327 
	`bc_ªad_åa˚
(
s
, "%†{\n", 
bc_èg_°r
[
èg
]);

34329 
obj
 = 
	`JS_NewAºay
(
˘x
);

34330 
is_ãm∂©e
 = (
èg
 =
BC_TAG_TEMPLATE_OBJECT
);

34331 i‡(
	`bc_gë_Àb128
(
s
, &
Àn
))

34332 
Áû
;

34333 
i
 = 0; i < 
Àn
; i++) {

34334 
vÆ
 = 
	`JS_RódObje˘Rec
(
s
);

34335 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

34336 
Áû
;

34337 i‡(
is_ãm∂©e
)

34338 
¥›_Êags
 = 
JS_PROP_ENUMERABLE
;

34340 
¥›_Êags
 = 
JS_PROP_C_W_E
;

34341 
ªt
 = 
	`JS_DeföePr›îtyVÆueUöt32
(
˘x
, 
obj
, 
i
, 
vÆ
,

34342 
¥›_Êags
);

34343 i‡(
ªt
 < 0)

34344 
Áû
;

34346 i‡(
is_ãm∂©e
) {

34347 
vÆ
 = 
	`JS_RódObje˘Rec
(
s
);

34348 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

34349 
Áû
;

34350 i‡(!
	`JS_IsUndeföed
(
vÆ
)) {

34351 
ªt
 = 
	`JS_DeföePr›îtyVÆue
(
˘x
, 
obj
, 
JS_ATOM_øw
, 
vÆ
, 0);

34352 i‡(
ªt
 < 0)

34353 
Áû
;

34355 
	`JS_PªvítExãnsi⁄s
(
˘x
, 
obj
);

34357 
	`bc_ªad_åa˚
(
s
, "}\n");

34360 #ifde‡
CONFIG_BIGNUM


34361 
BC_TAG_BIG_INT
:

34362 
BC_TAG_BIG_FLOAT
:

34363 
BC_TAG_BIG_DECIMAL
:

34364 
obj
 = 
	`JS_RódBigNum
(
s
, 
èg
);

34365 i‡(
	`JS_IsEx˚±i⁄
(
obj
))

34366 
Áû
;

34370 
övÆid_èg
:

34371  
	`JS_ThrowSy¡axEº‹
(
˘x
, "invalidÅag (tag=%dÖos=%u)",

34372 
èg
, ()(
s
->
±r
 - s->
buf_°¨t
));

34374  
obj
;

34375 
Áû
:

34376 i‡(
m
) {

34377 
	`js_‰ì_moduÀ_def
(
˘x
, 
m
);

34379 
	`JS_FªeVÆue
(
˘x
, 
obj
);

34381  
JS_EXCEPTION
;

34382 
	}
}

34384 
	$JS_RódObje˘Atoms
(
BCRódîSèã
 *
s
)

34386 
uöt8_t
 
v8
;

34387 
JSSåög
 *
p
;

34388 
i
;

34389 
JSAtom
 
©om
;

34391 i‡(
	`bc_gë_u8
(
s
, &
v8
))

34394 i‡(
v8
 !
BC_VERSION
) {

34395 
	`JS_ThrowSy¡axEº‹
(
s
->
˘x
, "invalid version (%dÉxpected=%d)",

34396 
v8
, 
BC_VERSION
);

34399 i‡(
	`bc_gë_Àb128
(
s
, &s->
idx_to_©om_cou¡
))

34402 
	`bc_ªad_åa˚
(
s
, "%dátom indexe†{\n", s->
idx_to_©om_cou¡
);

34404 i‡(
s
->
idx_to_©om_cou¡
 != 0) {

34405 
s
->
idx_to_©om
 = 
	`js_mÆlocz
(s->
˘x
, s->
idx_to_©om_cou¡
 *

34406 (
s
->
idx_to_©om
[0]));

34407 i‡(!
s
->
idx_to_©om
)

34408  
s
->
îr‹_°©e
 = -1;

34410 
i
 = 0; i < 
s
->
idx_to_©om_cou¡
; i++) {

34411 
p
 = 
	`JS_RódSåög
(
s
);

34412 i‡(!
p
)

34414 
©om
 = 
	`JS_NewAtomSå
(
s
->
˘x
, 
p
);

34415 i‡(
©om
 =
JS_ATOM_NULL
)

34416  
s
->
îr‹_°©e
 = -1;

34417 
s
->
idx_to_©om
[
i
] = 
©om
;

34418 i‡(
s
->
is_rom_d©a
 && (
©om
 !(
i
 + s->
fú°_©om
)))

34419 
s
->
is_rom_d©a
 = 
FALSE
;

34421 
	`bc_ªad_åa˚
(
s
, "}\n");

34423 
	}
}

34425 
	$bc_ªadî_‰ì
(
BCRódîSèã
 *
s
)

34427 
i
;

34428 i‡(
s
->
idx_to_©om
) {

34429 
i
 = 0; i < 
s
->
idx_to_©om_cou¡
; i++) {

34430 
	`JS_FªeAtom
(
s
->
˘x
, s->
idx_to_©om
[
i
]);

34432 
	`js_‰ì
(
s
->
˘x
, s->
idx_to_©om
);

34434 
	}
}

34436 
JSVÆue
 
	$JS_RódObje˘
(
JSC⁄ãxt
 *
˘x
, c⁄° 
uöt8_t
 *
buf
, 
size_t
 
buf_Àn
,

34437 
Êags
)

34439 
BCRódîSèã
 
ss
, *
s
 = &ss;

34440 
JSVÆue
 
obj
;

34442 
˘x
->
bö¨y_obje˘_cou¡
 += 1;

34443 
˘x
->
bö¨y_obje˘_size
 +
buf_Àn
;

34445 
	`mem£t
(
s
, 0, (*s));

34446 
s
->
˘x
 = ctx;

34447 
s
->
buf_°¨t
 = 
buf
;

34448 
s
->
buf_íd
 = 
buf
 + 
buf_Àn
;

34449 
s
->
±r
 = 
buf
;

34450 
s
->
Ælow_byãcode
 = ((
Êags
 & 
JS_READ_OBJ_BYTECODE
) != 0);

34451 
s
->
is_rom_d©a
 = ((
Êags
 & 
JS_READ_OBJ_ROM_DATA
) != 0);

34452 i‡(
s
->
Ælow_byãcode
)

34453 
s
->
fú°_©om
 = 
JS_ATOM_END
;

34455 
s
->
fú°_©om
 = 1;

34456 i‡(
	`JS_RódObje˘Atoms
(
s
)) {

34457 
obj
 = 
JS_EXCEPTION
;

34459 
obj
 = 
	`JS_RódObje˘Rec
(
s
);

34461 
	`bc_ªadî_‰ì
(
s
);

34462  
obj
;

34463 
	}
}

34468 
JSVÆue
 
js_°rög_c⁄°ru˘‹
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

34469 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
);

34470 
JSVÆue
 
js_boﬁón_c⁄°ru˘‹
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

34471 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
);

34472 
JSVÆue
 
js_numbî_c⁄°ru˘‹
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

34473 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
);

34475 
	$check_fun˘i⁄
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
obj
)

34477 i‡(
	`likñy
(
	`JS_IsFun˘i⁄
(
˘x
, 
obj
)))

34479 
	`JS_ThrowTy≥Eº‹
(
˘x
, "notá function");

34481 
	}
}

34483 
	$check_ex˚±i⁄_‰ì
(
JSC⁄ãxt
 *
˘x
, 
JSVÆue
 
obj
)

34485 
	`JS_FªeVÆue
(
˘x
, 
obj
);

34486  
	`JS_IsEx˚±i⁄
(
obj
);

34487 
	}
}

34489 
JSAtom
 
	$föd_©om
(
JSC⁄ãxt
 *
˘x
, c⁄° *
«me
)

34491 
JSAtom
 
©om
;

34492 
Àn
;

34494 i‡(*
«me
 == '[') {

34495 
«me
++;

34496 
Àn
 = 
	`°æí
(
«me
) - 1;

34499 
©om
 = 
JS_ATOM_Symbﬁ_toPrimôive
;átom < 
JS_ATOM_END
;átom++) {

34500 
JSAtomSåu˘
 *
p
 = 
˘x
->
π
->
©om_¨øy
[
©om
];

34501 
JSSåög
 *
°r
 = 
p
;

34502 i‡(
°r
->
Àn
 =À¿&& !
	`memcmp
(°r->
u
.
°r8
, 
«me
,Üen))

34503  
	`JS_DupAtom
(
˘x
, 
©om
);

34505 
	`ab‹t
();

34507 
©om
 = 
	`JS_NewAtom
(
˘x
, 
«me
);

34509  
©om
;

34510 
	}
}

34512 
	$JS_In°™tüãFun˘i⁄Li°Iãm
(
JSC⁄ãxt
 *
˘x
, 
JSObje˘
 *
p
,

34513 
JSAtom
 
©om
, *
›aque
)

34515 c⁄° 
JSCFun˘i⁄Li°E¡ry
 *
e
 = 
›aque
;

34516 
JSVÆueC⁄°
 
obj
 = 
	`JS_MKPTR
(
JS_TAG_OBJECT
, 
p
);

34517 
JSVÆue
 
vÆ
;

34518 
¥›_Êags
 = 
e
->prop_flags;

34520 
e
->
def_ty≥
) {

34521 
JS_DEF_ALIAS
:

34523 
JSAtom
 
©om1
 = 
	`föd_©om
(
˘x
, 
e
->
u
.
Æüs
.
«me
);

34524 
e
->
u
.
Æüs
.
ba£
) {

34526 
vÆ
 = 
	`JS_GëPr›îty
(
˘x
, 
obj
, 
©om1
);

34529 
vÆ
 = 
	`JS_GëPr›îty
(
˘x
, ctx->
globÆ_obj
, 
©om1
);

34532 
vÆ
 = 
	`JS_GëPr›îty
(
˘x
, ctx->
˛ass_¥Ÿo
[
JS_CLASS_ARRAY
], 
©om1
);

34535 
	`ab‹t
();

34537 
	`JS_FªeAtom
(
˘x
, 
©om1
);

34538 
£tvÆ
;

34540 
JS_DEF_CFUNC
:

34541 
vÆ
 = 
	`JS_NewCFun˘i⁄2
(
˘x
, 
e
->
u
.
func
.
cfunc
.
gíîic
,

34542 
e
->
«me
,É->
u
.
func
.
Àngth
,É->u.func.
˝rŸo
,É->
magic
);

34543 
£tvÆ
:

34544 i‡(
©om
 =
JS_ATOM_Symbﬁ_toPrimôive
) {

34546 
¥›_Êags
 = 
JS_PROP_CONFIGURABLE
;

34547 } i‡(
©om
 =
JS_ATOM_Symbﬁ_hasIn°™˚
) {

34549 
¥›_Êags
 = 0;

34552 
JS_DEF_CGETSET
:

34553 
JS_DEF_CGETSET_MAGIC
:

34555 
JSVÆue
 
gëãr
, 
£âî
;

34556 
buf
[64];

34558 
gëãr
 = 
JS_UNDEFINED
;

34559 i‡(
e
->
u
.
gë£t
.
gë
.
gíîic
) {

34560 
	`¢¥ötf
(
buf
, (buf), "gë %s", 
e
->
«me
);

34561 
gëãr
 = 
	`JS_NewCFun˘i⁄2
(
˘x
, 
e
->
u
.
gë£t
.
gë
.
gíîic
,

34562 
buf
, 0, 
e
->
def_ty≥
 =
JS_DEF_CGETSET_MAGIC
 ? 
JS_CFUNC_gëãr_magic
 : 
JS_CFUNC_gëãr
,

34563 
e
->
magic
);

34565 
£âî
 = 
JS_UNDEFINED
;

34566 i‡(
e
->
u
.
gë£t
.
£t
.
gíîic
) {

34567 
	`¢¥ötf
(
buf
, (buf), "£à%s", 
e
->
«me
);

34568 
£âî
 = 
	`JS_NewCFun˘i⁄2
(
˘x
, 
e
->
u
.
gë£t
.
£t
.
gíîic
,

34569 
buf
, 1, 
e
->
def_ty≥
 =
JS_DEF_CGETSET_MAGIC
 ? 
JS_CFUNC_£âî_magic
 : 
JS_CFUNC_£âî
,

34570 
e
->
magic
);

34572 
	`JS_DeföePr›îtyGëSë
(
˘x
, 
obj
, 
©om
, 
gëãr
, 
£âî
, 
¥›_Êags
);

34576 
JS_DEF_PROP_STRING
:

34577 
vÆ
 = 
	`JS_NewAtomSåög
(
˘x
, 
e
->
u
.
°r
);

34579 
JS_DEF_PROP_INT32
:

34580 
vÆ
 = 
	`JS_NewI¡32
(
˘x
, 
e
->
u
.
i32
);

34582 
JS_DEF_PROP_INT64
:

34583 
vÆ
 = 
	`JS_NewI¡64
(
˘x
, 
e
->
u
.
i64
);

34585 
JS_DEF_PROP_DOUBLE
:

34586 
vÆ
 = 
	`__JS_NewFlﬂt64
(
˘x
, 
e
->
u
.
f64
);

34588 
JS_DEF_PROP_UNDEFINED
:

34589 
vÆ
 = 
JS_UNDEFINED
;

34591 
JS_DEF_OBJECT
:

34592 
vÆ
 = 
	`JS_NewObje˘
(
˘x
);

34593 
	`JS_SëPr›îtyFun˘i⁄Li°
(
˘x
, 
vÆ
, 
e
->
u
.
¥›_li°
.
èb
,É->u.¥›_li°.
Àn
);

34596 
	`ab‹t
();

34598 
	`JS_DeföePr›îtyVÆue
(
˘x
, 
obj
, 
©om
, 
vÆ
, 
¥›_Êags
);

34600 
	}
}

34602 
	$JS_SëPr›îtyFun˘i⁄Li°
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
obj
,

34603 c⁄° 
JSCFun˘i⁄Li°E¡ry
 *
èb
, 
Àn
)

34605 
i
, 
¥›_Êags
;

34607 
i
 = 0; i < 
Àn
; i++) {

34608 c⁄° 
JSCFun˘i⁄Li°E¡ry
 *
e
 = &
èb
[
i
];

34609 
JSAtom
 
©om
 = 
	`föd_©om
(
˘x
, 
e
->
«me
);

34611 
e
->
def_ty≥
) {

34612 
JS_DEF_CFUNC
:

34613 
JS_DEF_CGETSET
:

34614 
JS_DEF_CGETSET_MAGIC
:

34615 
JS_DEF_PROP_STRING
:

34616 
JS_DEF_ALIAS
:

34617 
JS_DEF_OBJECT
:

34618 
¥›_Êags
 = 
JS_PROP_WRITABLE
 | 
JS_PROP_CONFIGURABLE
 | (
e
->¥›_Êag†& 
JS_PROP_ENUMERABLE
);

34619 
	`JS_DeföeAutoInôPr›îty
(
˘x
, 
obj
, 
©om
,

34620 
JS_AUTOINIT_ID_PROP
,

34621 (*)
e
, 
¥›_Êags
);

34623 
JS_DEF_PROP_INT32
:

34624 
JS_DEF_PROP_INT64
:

34625 
JS_DEF_PROP_DOUBLE
:

34626 
JS_DEF_PROP_UNDEFINED
:

34628 
JSObje˘
 *
p
 = 
	`JS_VALUE_GET_OBJ
(
obj
);

34629 
	`JS_In°™tüãFun˘i⁄Li°Iãm
(
˘x
, 
p
, 
©om
, (*)
e
);

34633 
	`ab‹t
();

34635 
	`JS_FªeAtom
(
˘x
, 
©om
);

34637 
	}
}

34639 
	$JS_AddModuÀExp‹tLi°
(
JSC⁄ãxt
 *
˘x
, 
JSModuÀDef
 *
m
,

34640 c⁄° 
JSCFun˘i⁄Li°E¡ry
 *
èb
, 
Àn
)

34642 
i
;

34643 
i
 = 0; i < 
Àn
; i++) {

34644 i‡(
	`JS_AddModuÀExp‹t
(
˘x
, 
m
, 
èb
[
i
].
«me
))

34648 
	}
}

34650 
	$JS_SëModuÀExp‹tLi°
(
JSC⁄ãxt
 *
˘x
, 
JSModuÀDef
 *
m
,

34651 c⁄° 
JSCFun˘i⁄Li°E¡ry
 *
èb
, 
Àn
)

34653 
i
;

34654 
JSVÆue
 
vÆ
;

34656 
i
 = 0; i < 
Àn
; i++) {

34657 c⁄° 
JSCFun˘i⁄Li°E¡ry
 *
e
 = &
èb
[
i
];

34658 
e
->
def_ty≥
) {

34659 
JS_DEF_CFUNC
:

34660 
vÆ
 = 
	`JS_NewCFun˘i⁄2
(
˘x
, 
e
->
u
.
func
.
cfunc
.
gíîic
,

34661 
e
->
«me
,É->
u
.
func
.
Àngth
,É->u.func.
˝rŸo
,É->
magic
);

34663 
JS_DEF_PROP_STRING
:

34664 
vÆ
 = 
	`JS_NewSåög
(
˘x
, 
e
->
u
.
°r
);

34666 
JS_DEF_PROP_INT32
:

34667 
vÆ
 = 
	`JS_NewI¡32
(
˘x
, 
e
->
u
.
i32
);

34669 
JS_DEF_PROP_INT64
:

34670 
vÆ
 = 
	`JS_NewI¡64
(
˘x
, 
e
->
u
.
i64
);

34672 
JS_DEF_PROP_DOUBLE
:

34673 
vÆ
 = 
	`__JS_NewFlﬂt64
(
˘x
, 
e
->
u
.
f64
);

34675 
JS_DEF_OBJECT
:

34676 
vÆ
 = 
	`JS_NewObje˘
(
˘x
);

34677 
	`JS_SëPr›îtyFun˘i⁄Li°
(
˘x
, 
vÆ
, 
e
->
u
.
¥›_li°
.
èb
,É->u.¥›_li°.
Àn
);

34680 
	`ab‹t
();

34682 i‡(
	`JS_SëModuÀExp‹t
(
˘x
, 
m
, 
e
->
«me
, 
vÆ
))

34686 
	}
}

34689 
	$JS_SëC⁄°ru˘‹2
(
JSC⁄ãxt
 *
˘x
,

34690 
JSVÆueC⁄°
 
func_obj
,

34691 
JSVÆueC⁄°
 
¥Ÿo
,

34692 
¥Ÿo_Êags
, 
˘‹_Êags
)

34694 
	`JS_DeföePr›îtyVÆue
(
˘x
, 
func_obj
, 
JS_ATOM_¥ŸŸy≥
,

34695 
	`JS_DupVÆue
(
˘x
, 
¥Ÿo
), 
¥Ÿo_Êags
);

34696 
	`JS_DeföePr›îtyVÆue
(
˘x
, 
¥Ÿo
, 
JS_ATOM_c⁄°ru˘‹
,

34697 
	`JS_DupVÆue
(
˘x
, 
func_obj
),

34698 
˘‹_Êags
);

34699 
	`£t_cy˛e_Êag
(
˘x
, 
func_obj
);

34700 
	`£t_cy˛e_Êag
(
˘x
, 
¥Ÿo
);

34701 
	}
}

34703 
	$JS_SëC⁄°ru˘‹
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
func_obj
,

34704 
JSVÆueC⁄°
 
¥Ÿo
)

34706 
	`JS_SëC⁄°ru˘‹2
(
˘x
, 
func_obj
, 
¥Ÿo
,

34707 0, 
JS_PROP_WRITABLE
 | 
JS_PROP_CONFIGURABLE
);

34708 
	}
}

34710 
	$JS_NewGlobÆCC⁄°ru˘‹2
(
JSC⁄ãxt
 *
˘x
,

34711 
JSVÆue
 
func_obj
,

34712 c⁄° *
«me
,

34713 
JSVÆueC⁄°
 
¥Ÿo
)

34715 
	`JS_DeföePr›îtyVÆueSå
(
˘x
, ctx->
globÆ_obj
, 
«me
,

34716 
	`JS_DupVÆue
(
˘x
, 
func_obj
),

34717 
JS_PROP_WRITABLE
 | 
JS_PROP_CONFIGURABLE
);

34718 
	`JS_SëC⁄°ru˘‹
(
˘x
, 
func_obj
, 
¥Ÿo
);

34719 
	`JS_FªeVÆue
(
˘x
, 
func_obj
);

34720 
	}
}

34722 
JSVÆueC⁄°
 
	$JS_NewGlobÆCC⁄°ru˘‹
(
JSC⁄ãxt
 *
˘x
, c⁄° *
«me
,

34723 
JSCFun˘i⁄
 *
func
, 
Àngth
,

34724 
JSVÆueC⁄°
 
¥Ÿo
)

34726 
JSVÆue
 
func_obj
;

34727 
func_obj
 = 
	`JS_NewCFun˘i⁄2
(
˘x
, 
func
, 
«me
, 
Àngth
, 
JS_CFUNC_c⁄°ru˘‹_‹_func
, 0);

34728 
	`JS_NewGlobÆCC⁄°ru˘‹2
(
˘x
, 
func_obj
, 
«me
, 
¥Ÿo
);

34729  
func_obj
;

34730 
	}
}

34732 
JSVÆueC⁄°
 
	$JS_NewGlobÆCC⁄°ru˘‹O∆y
(
JSC⁄ãxt
 *
˘x
, c⁄° *
«me
,

34733 
JSCFun˘i⁄
 *
func
, 
Àngth
,

34734 
JSVÆueC⁄°
 
¥Ÿo
)

34736 
JSVÆue
 
func_obj
;

34737 
func_obj
 = 
	`JS_NewCFun˘i⁄2
(
˘x
, 
func
, 
«me
, 
Àngth
, 
JS_CFUNC_c⁄°ru˘‹
, 0);

34738 
	`JS_NewGlobÆCC⁄°ru˘‹2
(
˘x
, 
func_obj
, 
«me
, 
¥Ÿo
);

34739  
func_obj
;

34740 
	}
}

34742 
JSVÆue
 
	$js_globÆ_evÆ
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

34743 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

34745  
	`JS_EvÆObje˘
(
˘x
, ctx->
globÆ_obj
, 
¨gv
[0], 
JS_EVAL_TYPE_INDIRECT
, -1);

34746 
	}
}

34748 
JSVÆue
 
	$js_globÆ_isNaN
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

34749 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

34751 
d
;

34754 i‡(
	`u∆ikñy
(
	`JS_ToFlﬂt64
(
˘x
, &
d
, 
¨gv
[0])))

34755  
JS_EXCEPTION
;

34756  
	`JS_NewBoﬁ
(
˘x
, 
	`i¢™
(
d
));

34757 
	}
}

34759 
JSVÆue
 
	$js_globÆ_isFöôe
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

34760 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

34762 
BOOL
 
ªs
;

34763 
d
;

34764 i‡(
	`u∆ikñy
(
	`JS_ToFlﬂt64
(
˘x
, &
d
, 
¨gv
[0])))

34765  
JS_EXCEPTION
;

34766 
ªs
 = 
	`isföôe
(
d
);

34767  
	`JS_NewBoﬁ
(
˘x
, 
ªs
);

34768 
	}
}

34772 
JSVÆue
 
	$JS_ToObje˘
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
vÆ
)

34774 
èg
 = 
	`JS_VALUE_GET_NORM_TAG
(
vÆ
);

34775 
JSVÆue
 
obj
;

34777 
èg
) {

34779 
JS_TAG_NULL
:

34780 
JS_TAG_UNDEFINED
:

34781  
	`JS_ThrowTy≥Eº‹
(
˘x
, "cannot convertÅo object");

34782 
JS_TAG_OBJECT
:

34783 
JS_TAG_EXCEPTION
:

34784  
	`JS_DupVÆue
(
˘x
, 
vÆ
);

34785 #ifde‡
CONFIG_BIGNUM


34786 
JS_TAG_BIG_INT
:

34787 
obj
 = 
	`JS_NewObje˘Cœss
(
˘x
, 
JS_CLASS_BIG_INT
);

34788 
£t_vÆue
;

34789 
JS_TAG_BIG_FLOAT
:

34790 
obj
 = 
	`JS_NewObje˘Cœss
(
˘x
, 
JS_CLASS_BIG_FLOAT
);

34791 
£t_vÆue
;

34792 
JS_TAG_BIG_DECIMAL
:

34793 
obj
 = 
	`JS_NewObje˘Cœss
(
˘x
, 
JS_CLASS_BIG_DECIMAL
);

34794 
£t_vÆue
;

34796 
JS_TAG_INT
:

34797 
JS_TAG_FLOAT64
:

34798 
obj
 = 
	`JS_NewObje˘Cœss
(
˘x
, 
JS_CLASS_NUMBER
);

34799 
£t_vÆue
;

34800 
JS_TAG_STRING
:

34803 
JSSåög
 *
p1
 = 
	`JS_VALUE_GET_STRING
(
vÆ
);

34804 
obj
 = 
	`JS_NewObje˘Cœss
(
˘x
, 
JS_CLASS_STRING
);

34805 
	`JS_DeföePr›îtyVÆue
(
˘x
, 
obj
, 
JS_ATOM_Àngth
, 
	`JS_NewI¡32
(˘x, 
p1
->
Àn
), 0);

34807 
£t_vÆue
;

34808 
JS_TAG_BOOL
:

34809 
obj
 = 
	`JS_NewObje˘Cœss
(
˘x
, 
JS_CLASS_BOOLEAN
);

34810 
£t_vÆue
;

34811 
JS_TAG_SYMBOL
:

34812 
obj
 = 
	`JS_NewObje˘Cœss
(
˘x
, 
JS_CLASS_SYMBOL
);

34813 
£t_vÆue
:

34814 i‡(!
	`JS_IsEx˚±i⁄
(
obj
))

34815 
	`JS_SëObje˘D©a
(
˘x
, 
obj
, 
	`JS_DupVÆue
(˘x, 
vÆ
));

34816  
obj
;

34818 
	}
}

34820 
JSVÆue
 
	$JS_ToObje˘Fªe
(
JSC⁄ãxt
 *
˘x
, 
JSVÆue
 
vÆ
)

34822 
JSVÆue
 
obj
 = 
	`JS_ToObje˘
(
˘x
, 
vÆ
);

34823 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

34824  
obj
;

34825 
	}
}

34827 
	$js_obj_to_desc
(
JSC⁄ãxt
 *
˘x
, 
JSPr›îtyDes¸ùt‹
 *
d
,

34828 
JSVÆueC⁄°
 
desc
)

34830 
JSVÆue
 
vÆ
, 
gëãr
, 
£âî
;

34831 
Êags
;

34833 i‡(!
	`JS_IsObje˘
(
desc
)) {

34834 
	`JS_ThrowTy≥Eº‹NŸAnObje˘
(
˘x
);

34837 
Êags
 = 0;

34838 
vÆ
 = 
JS_UNDEFINED
;

34839 
gëãr
 = 
JS_UNDEFINED
;

34840 
£âî
 = 
JS_UNDEFINED
;

34841 i‡(
	`JS_HasPr›îty
(
˘x
, 
desc
, 
JS_ATOM_c⁄figuøbÀ
)) {

34842 
JSVÆue
 
¥›
 = 
	`JS_GëPr›îty
(
˘x
, 
desc
, 
JS_ATOM_c⁄figuøbÀ
);

34843 i‡(
	`JS_IsEx˚±i⁄
(
¥›
))

34844 
Áû
;

34845 
Êags
 |
JS_PROP_HAS_CONFIGURABLE
;

34846 i‡(
	`JS_ToBoﬁFªe
(
˘x
, 
¥›
))

34847 
Êags
 |
JS_PROP_CONFIGURABLE
;

34849 i‡(
	`JS_HasPr›îty
(
˘x
, 
desc
, 
JS_ATOM_wrôabÀ
)) {

34850 
JSVÆue
 
¥›
 = 
	`JS_GëPr›îty
(
˘x
, 
desc
, 
JS_ATOM_wrôabÀ
);

34851 i‡(
	`JS_IsEx˚±i⁄
(
¥›
))

34852 
Áû
;

34853 
Êags
 |
JS_PROP_HAS_WRITABLE
;

34854 i‡(
	`JS_ToBoﬁFªe
(
˘x
, 
¥›
))

34855 
Êags
 |
JS_PROP_WRITABLE
;

34857 i‡(
	`JS_HasPr›îty
(
˘x
, 
desc
, 
JS_ATOM_íumîabÀ
)) {

34858 
JSVÆue
 
¥›
 = 
	`JS_GëPr›îty
(
˘x
, 
desc
, 
JS_ATOM_íumîabÀ
);

34859 i‡(
	`JS_IsEx˚±i⁄
(
¥›
))

34860 
Áû
;

34861 
Êags
 |
JS_PROP_HAS_ENUMERABLE
;

34862 i‡(
	`JS_ToBoﬁFªe
(
˘x
, 
¥›
))

34863 
Êags
 |
JS_PROP_ENUMERABLE
;

34865 i‡(
	`JS_HasPr›îty
(
˘x
, 
desc
, 
JS_ATOM_vÆue
)) {

34866 
Êags
 |
JS_PROP_HAS_VALUE
;

34867 
vÆ
 = 
	`JS_GëPr›îty
(
˘x
, 
desc
, 
JS_ATOM_vÆue
);

34868 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

34869 
Áû
;

34871 i‡(
	`JS_HasPr›îty
(
˘x
, 
desc
, 
JS_ATOM_gë
)) {

34872 
Êags
 |
JS_PROP_HAS_GET
;

34873 
gëãr
 = 
	`JS_GëPr›îty
(
˘x
, 
desc
, 
JS_ATOM_gë
);

34874 i‡(
	`JS_IsEx˚±i⁄
(
gëãr
) ||

34875 !(
	`JS_IsUndeföed
(
gëãr
Ë|| 
	`JS_IsFun˘i⁄
(
˘x
, getter))) {

34876 
	`JS_ThrowTy≥Eº‹
(
˘x
, "invalid getter");

34877 
Áû
;

34880 i‡(
	`JS_HasPr›îty
(
˘x
, 
desc
, 
JS_ATOM_£t
)) {

34881 
Êags
 |
JS_PROP_HAS_SET
;

34882 
£âî
 = 
	`JS_GëPr›îty
(
˘x
, 
desc
, 
JS_ATOM_£t
);

34883 i‡(
	`JS_IsEx˚±i⁄
(
£âî
) ||

34884 !(
	`JS_IsUndeföed
(
£âî
Ë|| 
	`JS_IsFun˘i⁄
(
˘x
, setter))) {

34885 
	`JS_ThrowTy≥Eº‹
(
˘x
, "invalid setter");

34886 
Áû
;

34889 i‡((
Êags
 & (
JS_PROP_HAS_SET
 | 
JS_PROP_HAS_GET
)) &&

34890 (
Êags
 & (
JS_PROP_HAS_VALUE
 | 
JS_PROP_HAS_WRITABLE
))) {

34891 
	`JS_ThrowTy≥Eº‹
(
˘x
, "cannot have setter/getteránd value or writable");

34892 
Áû
;

34894 
d
->
Êags
 = flags;

34895 
d
->
vÆue
 = 
vÆ
;

34896 
d
->
gëãr
 = getter;

34897 
d
->
£âî
 = setter;

34899 
Áû
:

34900 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

34901 
	`JS_FªeVÆue
(
˘x
, 
gëãr
);

34902 
	`JS_FªeVÆue
(
˘x
, 
£âî
);

34904 
	}
}

34906 
__ex˚±i⁄
 
	$JS_DeföePr›îtyDesc
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
obj
,

34907 
JSAtom
 
¥›
, 
JSVÆueC⁄°
 
desc
,

34908 
Êags
)

34910 
JSPr›îtyDes¸ùt‹
 
d
;

34911 
ªt
;

34913 i‡(
	`js_obj_to_desc
(
˘x
, &
d
, 
desc
) < 0)

34916 
ªt
 = 
	`JS_DeföePr›îty
(
˘x
, 
obj
, 
¥›
,

34917 
d
.
vÆue
, d.
gëãr
, d.
£âî
, d.
Êags
 | flags);

34918 
	`js_‰ì_desc
(
˘x
, &
d
);

34919  
ªt
;

34920 
	}
}

34922 
__ex˚±i⁄
 
	$JS_Obje˘DeföePr›îtõs
(
JSC⁄ãxt
 *
˘x
,

34923 
JSVÆueC⁄°
 
obj
,

34924 
JSVÆueC⁄°
 
¥›îtõs
)

34926 
JSVÆue
 
¥›s
, 
desc
;

34927 
JSObje˘
 *
p
;

34928 
JSPr›îtyEnum
 *
©oms
;

34929 
uöt32_t
 
Àn
, 
i
;

34930 
ªt
 = -1;

34932 i‡(!
	`JS_IsObje˘
(
obj
)) {

34933 
	`JS_ThrowTy≥Eº‹NŸAnObje˘
(
˘x
);

34936 
desc
 = 
JS_UNDEFINED
;

34937 
¥›s
 = 
	`JS_ToObje˘
(
˘x
, 
¥›îtõs
);

34938 i‡(
	`JS_IsEx˚±i⁄
(
¥›s
))

34940 
p
 = 
	`JS_VALUE_GET_OBJ
(
¥›s
);

34941 i‡(
	`JS_GëOwnPr›îtyNamesI¡î«l
(
˘x
, &
©oms
, &
Àn
, 
p
, 
JS_GPN_ENUM_ONLY
 | 
JS_GPN_STRING_MASK
) < 0)

34942 
ex˚±i⁄
;

34943 
i
 = 0; i < 
Àn
; i++) {

34944 
	`JS_FªeVÆue
(
˘x
, 
desc
);

34945 
desc
 = 
	`JS_GëPr›îty
(
˘x
, 
¥›s
, 
©oms
[
i
].
©om
);

34946 i‡(
	`JS_IsEx˚±i⁄
(
desc
))

34947 
ex˚±i⁄
;

34948 i‡(
	`JS_DeföePr›îtyDesc
(
˘x
, 
obj
, 
©oms
[
i
].
©om
, 
desc
, 
JS_PROP_THROW
) < 0)

34949 
ex˚±i⁄
;

34951 
ªt
 = 0;

34953 
ex˚±i⁄
:

34954 
	`js_‰ì_¥›_íum
(
˘x
, 
©oms
, 
Àn
);

34955 
	`JS_FªeVÆue
(
˘x
, 
¥›s
);

34956 
	`JS_FªeVÆue
(
˘x
, 
desc
);

34957  
ªt
;

34958 
	}
}

34960 
JSVÆue
 
	$js_obje˘_c⁄°ru˘‹
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
√w_èrgë
,

34961 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

34963 
JSVÆue
 
ªt
;

34964 i‡(!
	`JS_IsUndeföed
(
√w_èrgë
) &&

34965 
	`JS_VALUE_GET_OBJ
(
√w_èrgë
) !=

34966 
	`JS_VALUE_GET_OBJ
(
	`JS_GëA˘iveFun˘i⁄
(
˘x
))) {

34967 
ªt
 = 
	`js_¸óã_‰om_˘‹
(
˘x
, 
√w_èrgë
, 
JS_CLASS_OBJECT
);

34969 
èg
 = 
	`JS_VALUE_GET_NORM_TAG
(
¨gv
[0]);

34970 
èg
) {

34971 
JS_TAG_NULL
:

34972 
JS_TAG_UNDEFINED
:

34973 
ªt
 = 
	`JS_NewObje˘
(
˘x
);

34976 
ªt
 = 
	`JS_ToObje˘
(
˘x
, 
¨gv
[0]);

34980  
ªt
;

34981 
	}
}

34983 
JSVÆue
 
	$js_obje˘_¸óã
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

34984 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

34986 
JSVÆueC⁄°
 
¥Ÿo
, 
¥›s
;

34987 
JSVÆue
 
obj
;

34989 
¥Ÿo
 = 
¨gv
[0];

34990 i‡(!
	`JS_IsObje˘
(
¥Ÿo
Ë&& !
	`JS_IsNuŒ
(proto))

34991  
	`JS_ThrowTy≥Eº‹
(
˘x
, "notáÖrototype");

34992 
obj
 = 
	`JS_NewObje˘PrŸo
(
˘x
, 
¥Ÿo
);

34993 i‡(
	`JS_IsEx˚±i⁄
(
obj
))

34994  
JS_EXCEPTION
;

34995 
¥›s
 = 
¨gv
[1];

34996 i‡(!
	`JS_IsUndeföed
(
¥›s
)) {

34997 i‡(
	`JS_Obje˘DeföePr›îtõs
(
˘x
, 
obj
, 
¥›s
)) {

34998 
	`JS_FªeVÆue
(
˘x
, 
obj
);

34999  
JS_EXCEPTION
;

35002  
obj
;

35003 
	}
}

35005 
JSVÆue
 
	$js_obje˘_gëPrŸŸy≥Of
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

35006 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
, 
magic
)

35008 
JSVÆueC⁄°
 
vÆ
;

35010 
vÆ
 = 
¨gv
[0];

35011 i‡(
	`JS_VALUE_GET_TAG
(
vÆ
Ë!
JS_TAG_OBJECT
) {

35014 i‡(
magic
 || 
	`JS_VALUE_GET_TAG
(
vÆ
Ë=
JS_TAG_NULL
 ||

35015 
	`JS_VALUE_GET_TAG
(
vÆ
Ë=
JS_TAG_UNDEFINED
)

35016  
	`JS_ThrowTy≥Eº‹NŸAnObje˘
(
˘x
);

35018  
	`JS_DupVÆue
(
˘x
, 
	`JS_GëPrŸŸy≥
(˘x, 
vÆ
));

35019 
	}
}

35021 
JSVÆue
 
	$js_obje˘_£tPrŸŸy≥Of
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

35022 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

35024 
JSVÆueC⁄°
 
obj
;

35025 
obj
 = 
¨gv
[0];

35026 i‡(
	`JS_SëPrŸŸy≥I¡î«l
(
˘x
, 
obj
, 
¨gv
[1], 
TRUE
) < 0)

35027  
JS_EXCEPTION
;

35028  
	`JS_DupVÆue
(
˘x
, 
obj
);

35029 
	}
}

35032 
JSVÆue
 
	$js_obje˘_deföePr›îty
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

35033 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
, 
magic
)

35035 
JSVÆueC⁄°
 
obj
, 
¥›
, 
desc
;

35036 
ªt
, 
Êags
;

35037 
JSAtom
 
©om
;

35039 
obj
 = 
¨gv
[0];

35040 
¥›
 = 
¨gv
[1];

35041 
desc
 = 
¨gv
[2];

35043 i‡(
	`JS_VALUE_GET_TAG
(
obj
Ë!
JS_TAG_OBJECT
)

35044  
	`JS_ThrowTy≥Eº‹NŸAnObje˘
(
˘x
);

35045 
©om
 = 
	`JS_VÆueToAtom
(
˘x
, 
¥›
);

35046 i‡(
	`u∆ikñy
(
©om
 =
JS_ATOM_NULL
))

35047  
JS_EXCEPTION
;

35048 
Êags
 = 0;

35049 i‡(!
magic
)

35050 
Êags
 |
JS_PROP_THROW
;

35051 
ªt
 = 
	`JS_DeföePr›îtyDesc
(
˘x
, 
obj
, 
©om
, 
desc
, 
Êags
);

35052 
	`JS_FªeAtom
(
˘x
, 
©om
);

35053 i‡(
ªt
 < 0) {

35054  
JS_EXCEPTION
;

35055 } i‡(
magic
) {

35056  
	`JS_NewBoﬁ
(
˘x
, 
ªt
);

35058  
	`JS_DupVÆue
(
˘x
, 
obj
);

35060 
	}
}

35062 
JSVÆue
 
	$js_obje˘_deföePr›îtõs
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

35063 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

35066 
JSVÆueC⁄°
 
obj
 = 
¨gv
[0];

35068 i‡(
	`JS_Obje˘DeföePr›îtõs
(
˘x
, 
obj
, 
¨gv
[1]))

35069  
JS_EXCEPTION
;

35071  
	`JS_DupVÆue
(
˘x
, 
obj
);

35072 
	}
}

35075 
JSVÆue
 
	$js_obje˘___deföeGëãr__
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

35076 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
, 
magic
)

35078 
JSVÆue
 
obj
;

35079 
JSVÆueC⁄°
 
¥›
, 
vÆue
, 
gë
, 
£t
;

35080 
ªt
, 
Êags
;

35081 
JSAtom
 
©om
;

35083 
¥›
 = 
¨gv
[0];

35084 
vÆue
 = 
¨gv
[1];

35086 
obj
 = 
	`JS_ToObje˘
(
˘x
, 
this_vÆ
);

35087 i‡(
	`JS_IsEx˚±i⁄
(
obj
))

35088  
JS_EXCEPTION
;

35090 i‡(
	`check_fun˘i⁄
(
˘x
, 
vÆue
)) {

35091 
	`JS_FªeVÆue
(
˘x
, 
obj
);

35092  
JS_EXCEPTION
;

35094 
©om
 = 
	`JS_VÆueToAtom
(
˘x
, 
¥›
);

35095 i‡(
	`u∆ikñy
(
©om
 =
JS_ATOM_NULL
)) {

35096 
	`JS_FªeVÆue
(
˘x
, 
obj
);

35097  
JS_EXCEPTION
;

35099 
Êags
 = 
JS_PROP_THROW
 |

35100 
JS_PROP_HAS_ENUMERABLE
 | 
JS_PROP_ENUMERABLE
 |

35101 
JS_PROP_HAS_CONFIGURABLE
 | 
JS_PROP_CONFIGURABLE
;

35102 i‡(
magic
) {

35103 
gë
 = 
JS_UNDEFINED
;

35104 
£t
 = 
vÆue
;

35105 
Êags
 |
JS_PROP_HAS_SET
;

35107 
gë
 = 
vÆue
;

35108 
£t
 = 
JS_UNDEFINED
;

35109 
Êags
 |
JS_PROP_HAS_GET
;

35111 
ªt
 = 
	`JS_DeföePr›îty
(
˘x
, 
obj
, 
©om
, 
JS_UNDEFINED
, 
gë
, 
£t
, 
Êags
);

35112 
	`JS_FªeVÆue
(
˘x
, 
obj
);

35113 
	`JS_FªeAtom
(
˘x
, 
©om
);

35114 i‡(
ªt
 < 0) {

35115  
JS_EXCEPTION
;

35117  
JS_UNDEFINED
;

35119 
	}
}

35121 
JSVÆue
 
	$js_obje˘_gëOwnPr›îtyDes¸ùt‹
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

35122 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
, 
magic
)

35124 
JSVÆueC⁄°
 
¥›
;

35125 
JSAtom
 
©om
;

35126 
JSVÆue
 
ªt
, 
obj
;

35127 
JSPr›îtyDes¸ùt‹
 
desc
;

35128 
ªs
, 
Êags
;

35130 i‡(
magic
) {

35132 i‡(
	`JS_VALUE_GET_TAG
(
¨gv
[0]Ë!
JS_TAG_OBJECT
)

35133  
	`JS_ThrowTy≥Eº‹NŸAnObje˘
(
˘x
);

35134 
obj
 = 
	`JS_DupVÆue
(
˘x
, 
¨gv
[0]);

35136 
obj
 = 
	`JS_ToObje˘
(
˘x
, 
¨gv
[0]);

35137 i‡(
	`JS_IsEx˚±i⁄
(
obj
))

35138  
obj
;

35140 
¥›
 = 
¨gv
[1];

35141 
©om
 = 
	`JS_VÆueToAtom
(
˘x
, 
¥›
);

35142 i‡(
	`u∆ikñy
(
©om
 =
JS_ATOM_NULL
))

35143 
ex˚±i⁄
;

35144 
ªt
 = 
JS_UNDEFINED
;

35145 i‡(
	`JS_VALUE_GET_TAG
(
obj
Ë=
JS_TAG_OBJECT
) {

35146 
ªs
 = 
	`JS_GëOwnPr›îtyI¡î«l
(
˘x
, &
desc
, 
	`JS_VALUE_GET_OBJ
(
obj
), 
©om
);

35147 i‡(
ªs
 < 0)

35148 
ex˚±i⁄
;

35149 i‡(
ªs
) {

35150 
ªt
 = 
	`JS_NewObje˘
(
˘x
);

35151 i‡(
	`JS_IsEx˚±i⁄
(
ªt
))

35152 
ex˚±i⁄1
;

35153 
Êags
 = 
JS_PROP_C_W_E
 | 
JS_PROP_THROW
;

35154 i‡(
desc
.
Êags
 & 
JS_PROP_GETSET
) {

35155 i‡(
	`JS_DeföePr›îtyVÆue
(
˘x
, 
ªt
, 
JS_ATOM_gë
, 
	`JS_DupVÆue
(˘x, 
desc
.
gëãr
), 
Êags
) < 0

35156 || 
	`JS_DeföePr›îtyVÆue
(
˘x
, 
ªt
, 
JS_ATOM_£t
, 
	`JS_DupVÆue
(˘x, 
desc
.
£âî
), 
Êags
) < 0)

35157 
ex˚±i⁄1
;

35159 i‡(
	`JS_DeföePr›îtyVÆue
(
˘x
, 
ªt
, 
JS_ATOM_vÆue
, 
	`JS_DupVÆue
(˘x, 
desc
.
vÆue
), 
Êags
) < 0

35160 || 
	`JS_DeföePr›îtyVÆue
(
˘x
, 
ªt
, 
JS_ATOM_wrôabÀ
,

35161 
	`JS_NewBoﬁ
(
˘x
, (
desc
.
Êags
 & 
JS_PROP_WRITABLE
) != 0), flags) < 0)

35162 
ex˚±i⁄1
;

35164 i‡(
	`JS_DeföePr›îtyVÆue
(
˘x
, 
ªt
, 
JS_ATOM_íumîabÀ
,

35165 
	`JS_NewBoﬁ
(
˘x
, (
desc
.
Êags
 & 
JS_PROP_ENUMERABLE
) != 0), flags) < 0

35166 || 
	`JS_DeföePr›îtyVÆue
(
˘x
, 
ªt
, 
JS_ATOM_c⁄figuøbÀ
,

35167 
	`JS_NewBoﬁ
(
˘x
, (
desc
.
Êags
 & 
JS_PROP_CONFIGURABLE
) != 0), flags) < 0)

35168 
ex˚±i⁄1
;

35169 
	`js_‰ì_desc
(
˘x
, &
desc
);

35172 
	`JS_FªeAtom
(
˘x
, 
©om
);

35173 
	`JS_FªeVÆue
(
˘x
, 
obj
);

35174  
ªt
;

35176 
ex˚±i⁄1
:

35177 
	`js_‰ì_desc
(
˘x
, &
desc
);

35178 
	`JS_FªeVÆue
(
˘x
, 
ªt
);

35179 
ex˚±i⁄
:

35180 
	`JS_FªeAtom
(
˘x
, 
©om
);

35181 
	`JS_FªeVÆue
(
˘x
, 
obj
);

35182  
JS_EXCEPTION
;

35183 
	}
}

35185 
JSVÆue
 
	$js_obje˘_gëOwnPr›îtyDes¸ùt‹s
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

35186 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

35189 
JSVÆue
 
obj
, 
r
;

35190 
JSObje˘
 *
p
;

35191 
JSPr›îtyEnum
 *
¥›s
;

35192 
uöt32_t
 
Àn
, 
i
;

35194 
r
 = 
JS_UNDEFINED
;

35195 
obj
 = 
	`JS_ToObje˘
(
˘x
, 
¨gv
[0]);

35196 i‡(
	`JS_IsEx˚±i⁄
(
obj
))

35197  
JS_EXCEPTION
;

35199 
p
 = 
	`JS_VALUE_GET_OBJ
(
obj
);

35200 i‡(
	`JS_GëOwnPr›îtyNamesI¡î«l
(
˘x
, &
¥›s
, &
Àn
, 
p
,

35201 
JS_GPN_STRING_MASK
 | 
JS_GPN_SYMBOL_MASK
))

35202 
ex˚±i⁄
;

35203 
r
 = 
	`JS_NewObje˘
(
˘x
);

35204 i‡(
	`JS_IsEx˚±i⁄
(
r
))

35205 
ex˚±i⁄
;

35206 
i
 = 0; i < 
Àn
; i++) {

35207 
JSVÆue
 
©omVÆue
, 
desc
;

35208 
JSVÆueC⁄°
 
¨gs
[2];

35210 
©omVÆue
 = 
	`JS_AtomToVÆue
(
˘x
, 
¥›s
[
i
].
©om
);

35211 i‡(
	`JS_IsEx˚±i⁄
(
©omVÆue
))

35212 
ex˚±i⁄
;

35213 
¨gs
[0] = 
obj
;

35214 
¨gs
[1] = 
©omVÆue
;

35215 
desc
 = 
	`js_obje˘_gëOwnPr›îtyDes¸ùt‹
(
˘x
, 
JS_UNDEFINED
, 2, 
¨gs
, 0);

35216 
	`JS_FªeVÆue
(
˘x
, 
©omVÆue
);

35217 i‡(
	`JS_IsEx˚±i⁄
(
desc
))

35218 
ex˚±i⁄
;

35219 i‡(!
	`JS_IsUndeföed
(
desc
)) {

35220 i‡(
	`JS_DeföePr›îtyVÆue
(
˘x
, 
r
, 
¥›s
[
i
].
©om
, 
desc
,

35221 
JS_PROP_C_W_E
 | 
JS_PROP_THROW
) < 0)

35222 
ex˚±i⁄
;

35225 
	`js_‰ì_¥›_íum
(
˘x
, 
¥›s
, 
Àn
);

35226 
	`JS_FªeVÆue
(
˘x
, 
obj
);

35227  
r
;

35229 
ex˚±i⁄
:

35230 
	`js_‰ì_¥›_íum
(
˘x
, 
¥›s
, 
Àn
);

35231 
	`JS_FªeVÆue
(
˘x
, 
obj
);

35232 
	`JS_FªeVÆue
(
˘x
, 
r
);

35233  
JS_EXCEPTION
;

35234 
	}
}

35236 
JSVÆue
 
	$JS_GëOwnPr›îtyNames2
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
obj1
,

35237 
Êags
, 
köd
)

35239 
JSVÆue
 
obj
, 
r
, 
vÆ
, 
key
, 
vÆue
;

35240 
JSObje˘
 *
p
;

35241 
JSPr›îtyEnum
 *
©oms
;

35242 
uöt32_t
 
Àn
, 
i
, 
j
;

35244 
r
 = 
JS_UNDEFINED
;

35245 
vÆ
 = 
JS_UNDEFINED
;

35246 
obj
 = 
	`JS_ToObje˘
(
˘x
, 
obj1
);

35247 i‡(
	`JS_IsEx˚±i⁄
(
obj
))

35248  
JS_EXCEPTION
;

35249 
p
 = 
	`JS_VALUE_GET_OBJ
(
obj
);

35250 i‡(
	`JS_GëOwnPr›îtyNamesI¡î«l
(
˘x
, &
©oms
, &
Àn
, 
p
, 
Êags
 & ~
JS_GPN_ENUM_ONLY
))

35251 
ex˚±i⁄
;

35252 
r
 = 
	`JS_NewAºay
(
˘x
);

35253 i‡(
	`JS_IsEx˚±i⁄
(
r
))

35254 
ex˚±i⁄
;

35255 
j
 = 
i
 = 0; i < 
Àn
; i++) {

35256 
JSAtom
 
©om
 = 
©oms
[
i
].atom;

35257 i‡(
Êags
 & 
JS_GPN_ENUM_ONLY
) {

35258 
JSPr›îtyDes¸ùt‹
 
desc
;

35259 
ªs
;

35262 
ªs
 = 
	`JS_GëOwnPr›îtyI¡î«l
(
˘x
, &
desc
, 
p
, 
©om
);

35263 i‡(
ªs
 < 0)

35264 
ex˚±i⁄
;

35265 i‡(!
ªs
)

35267 
	`js_‰ì_desc
(
˘x
, &
desc
);

35268 i‡(!(
desc
.
Êags
 & 
JS_PROP_ENUMERABLE
))

35271 
köd
) {

35273 
JS_ITERATOR_KIND_KEY
:

35274 
vÆ
 = 
	`JS_AtomToVÆue
(
˘x
, 
©om
);

35275 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

35276 
ex˚±i⁄
;

35278 
JS_ITERATOR_KIND_VALUE
:

35279 
vÆ
 = 
	`JS_GëPr›îty
(
˘x
, 
obj
, 
©om
);

35280 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

35281 
ex˚±i⁄
;

35283 
JS_ITERATOR_KIND_KEY_AND_VALUE
:

35284 
vÆ
 = 
	`JS_NewAºay
(
˘x
);

35285 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

35286 
ex˚±i⁄
;

35287 
key
 = 
	`JS_AtomToVÆue
(
˘x
, 
©om
);

35288 i‡(
	`JS_IsEx˚±i⁄
(
key
))

35289 
ex˚±i⁄1
;

35290 i‡(
	`JS_Cª©eD©aPr›îtyUöt32
(
˘x
, 
vÆ
, 0, 
key
, 
JS_PROP_THROW
) < 0)

35291 
ex˚±i⁄1
;

35292 
vÆue
 = 
	`JS_GëPr›îty
(
˘x
, 
obj
, 
©om
);

35293 i‡(
	`JS_IsEx˚±i⁄
(
vÆue
))

35294 
ex˚±i⁄1
;

35295 i‡(
	`JS_Cª©eD©aPr›îtyUöt32
(
˘x
, 
vÆ
, 1, 
vÆue
, 
JS_PROP_THROW
) < 0)

35296 
ex˚±i⁄1
;

35299 i‡(
	`JS_Cª©eD©aPr›îtyUöt32
(
˘x
, 
r
, 
j
++, 
vÆ
, 0) < 0)

35300 
ex˚±i⁄
;

35302 
d⁄e
;

35304 
ex˚±i⁄1
:

35305 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

35306 
ex˚±i⁄
:

35307 
	`JS_FªeVÆue
(
˘x
, 
r
);

35308 
r
 = 
JS_EXCEPTION
;

35309 
d⁄e
:

35310 
	`js_‰ì_¥›_íum
(
˘x
, 
©oms
, 
Àn
);

35311 
	`JS_FªeVÆue
(
˘x
, 
obj
);

35312  
r
;

35313 
	}
}

35315 
JSVÆue
 
	$js_obje˘_gëOwnPr›îtyNames
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

35316 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

35318  
	`JS_GëOwnPr›îtyNames2
(
˘x
, 
¨gv
[0],

35319 
JS_GPN_STRING_MASK
, 
JS_ITERATOR_KIND_KEY
);

35320 
	}
}

35322 
JSVÆue
 
	$js_obje˘_gëOwnPr›îtySymbﬁs
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

35323 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

35325  
	`JS_GëOwnPr›îtyNames2
(
˘x
, 
¨gv
[0],

35326 
JS_GPN_SYMBOL_MASK
, 
JS_ITERATOR_KIND_KEY
);

35327 
	}
}

35329 
JSVÆue
 
	$js_obje˘_keys
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

35330 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
, 
köd
)

35332  
	`JS_GëOwnPr›îtyNames2
(
˘x
, 
¨gv
[0],

35333 
JS_GPN_ENUM_ONLY
 | 
JS_GPN_STRING_MASK
, 
köd
);

35334 
	}
}

35336 
JSVÆue
 
	$js_obje˘_isExãnsibÀ
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

35337 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
, 
ªÊe˘
)

35339 
JSVÆueC⁄°
 
obj
;

35340 
ªt
;

35342 
obj
 = 
¨gv
[0];

35343 i‡(
	`JS_VALUE_GET_TAG
(
obj
Ë!
JS_TAG_OBJECT
) {

35344 i‡(
ªÊe˘
)

35345  
	`JS_ThrowTy≥Eº‹NŸAnObje˘
(
˘x
);

35347  
JS_FALSE
;

35349 
ªt
 = 
	`JS_IsExãnsibÀ
(
˘x
, 
obj
);

35350 i‡(
ªt
 < 0)

35351  
JS_EXCEPTION
;

35353  
	`JS_NewBoﬁ
(
˘x
, 
ªt
);

35354 
	}
}

35356 
JSVÆue
 
	$js_obje˘_¥evítExãnsi⁄s
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

35357 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
, 
ªÊe˘
)

35359 
JSVÆueC⁄°
 
obj
;

35360 
ªt
;

35362 
obj
 = 
¨gv
[0];

35363 i‡(
	`JS_VALUE_GET_TAG
(
obj
Ë!
JS_TAG_OBJECT
) {

35364 i‡(
ªÊe˘
)

35365  
	`JS_ThrowTy≥Eº‹NŸAnObje˘
(
˘x
);

35367  
	`JS_DupVÆue
(
˘x
, 
obj
);

35369 
ªt
 = 
	`JS_PªvítExãnsi⁄s
(
˘x
, 
obj
);

35370 i‡(
ªt
 < 0)

35371  
JS_EXCEPTION
;

35372 i‡(
ªÊe˘
) {

35373  
	`JS_NewBoﬁ
(
˘x
, 
ªt
);

35375 i‡(!
ªt
)

35376  
	`JS_ThrowTy≥Eº‹
(
˘x
, "proxyÖreventExtensions handlerÑeturned false");

35377  
	`JS_DupVÆue
(
˘x
, 
obj
);

35379 
	}
}

35381 
JSVÆue
 
	$js_obje˘_hasOwnPr›îty
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

35382 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

35384 
JSVÆue
 
obj
;

35385 
JSAtom
 
©om
;

35386 
JSObje˘
 *
p
;

35387 
BOOL
 
ªt
;

35389 
©om
 = 
	`JS_VÆueToAtom
(
˘x
, 
¨gv
[0]);

35390 i‡(
	`u∆ikñy
(
©om
 =
JS_ATOM_NULL
))

35391  
JS_EXCEPTION
;

35392 
obj
 = 
	`JS_ToObje˘
(
˘x
, 
this_vÆ
);

35393 i‡(
	`JS_IsEx˚±i⁄
(
obj
)) {

35394 
	`JS_FªeAtom
(
˘x
, 
©om
);

35395  
obj
;

35397 
p
 = 
	`JS_VALUE_GET_OBJ
(
obj
);

35398 
ªt
 = 
	`JS_GëOwnPr›îtyI¡î«l
(
˘x
, 
NULL
, 
p
, 
©om
);

35399 
	`JS_FªeAtom
(
˘x
, 
©om
);

35400 
	`JS_FªeVÆue
(
˘x
, 
obj
);

35401 i‡(
ªt
 < 0)

35402  
JS_EXCEPTION
;

35404  
	`JS_NewBoﬁ
(
˘x
, 
ªt
);

35405 
	}
}

35407 
JSVÆue
 
	$js_obje˘_vÆueOf
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

35408 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

35410  
	`JS_ToObje˘
(
˘x
, 
this_vÆ
);

35411 
	}
}

35413 
JSVÆue
 
	$js_obje˘_toSåög
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

35414 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

35416 
JSVÆue
 
obj
, 
èg
;

35417 
is_¨øy
;

35418 
JSAtom
 
©om
;

35419 
JSObje˘
 *
p
;

35421 i‡(
	`JS_IsNuŒ
(
this_vÆ
)) {

35422 
èg
 = 
	`JS_NewSåög
(
˘x
, "Null");

35423 } i‡(
	`JS_IsUndeföed
(
this_vÆ
)) {

35424 
èg
 = 
	`JS_NewSåög
(
˘x
, "Undefined");

35426 
obj
 = 
	`JS_ToObje˘
(
˘x
, 
this_vÆ
);

35427 i‡(
	`JS_IsEx˚±i⁄
(
obj
))

35428  
obj
;

35429 
is_¨øy
 = 
	`JS_IsAºay
(
˘x
, 
obj
);

35430 i‡(
is_¨øy
 < 0) {

35431 
	`JS_FªeVÆue
(
˘x
, 
obj
);

35432  
JS_EXCEPTION
;

35434 i‡(
is_¨øy
) {

35435 
©om
 = 
JS_ATOM_Aºay
;

35436 } i‡(
	`JS_IsFun˘i⁄
(
˘x
, 
obj
)) {

35437 
©om
 = 
JS_ATOM_Fun˘i⁄
;

35439 
p
 = 
	`JS_VALUE_GET_OBJ
(
obj
);

35440 
p
->
˛ass_id
) {

35441 
JS_CLASS_STRING
:

35442 
JS_CLASS_ARGUMENTS
:

35443 
JS_CLASS_MAPPED_ARGUMENTS
:

35444 
JS_CLASS_ERROR
:

35445 
JS_CLASS_BOOLEAN
:

35446 
JS_CLASS_NUMBER
:

35447 
JS_CLASS_DATE
:

35448 
JS_CLASS_REGEXP
:

35449 
©om
 = 
˘x
->
π
->
˛ass_¨øy
[
p
->
˛ass_id
].
˛ass_«me
;

35452 
©om
 = 
JS_ATOM_Obje˘
;

35456 
èg
 = 
	`JS_GëPr›îty
(
˘x
, 
obj
, 
JS_ATOM_Symbﬁ_toSåögTag
);

35457 
	`JS_FªeVÆue
(
˘x
, 
obj
);

35458 i‡(
	`JS_IsEx˚±i⁄
(
èg
))

35459  
JS_EXCEPTION
;

35460 i‡(!
	`JS_IsSåög
(
èg
)) {

35461 
	`JS_FªeVÆue
(
˘x
, 
èg
);

35462 
èg
 = 
	`JS_AtomToSåög
(
˘x
, 
©om
);

35465  
	`JS_C⁄ˇtSåög3
(
˘x
, "[obje˘ ", 
èg
, "]");

35466 
	}
}

35468 
JSVÆue
 
	$js_obje˘_toLoˇÀSåög
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

35469 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

35471  
	`JS_Invoke
(
˘x
, 
this_vÆ
, 
JS_ATOM_toSåög
, 0, 
NULL
);

35472 
	}
}

35474 
JSVÆue
 
	$js_obje˘_assign
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

35475 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

35478 
JSVÆue
 
obj
, 
s
;

35479 
i
;

35481 
s
 = 
JS_UNDEFINED
;

35482 
obj
 = 
	`JS_ToObje˘
(
˘x
, 
¨gv
[0]);

35483 i‡(
	`JS_IsEx˚±i⁄
(
obj
))

35484 
ex˚±i⁄
;

35485 
i
 = 1; i < 
¨gc
; i++) {

35486 i‡(!
	`JS_IsNuŒ
(
¨gv
[
i
]Ë&& !
	`JS_IsUndeföed
(argv[i])) {

35487 
s
 = 
	`JS_ToObje˘
(
˘x
, 
¨gv
[
i
]);

35488 i‡(
	`JS_IsEx˚±i⁄
(
s
))

35489 
ex˚±i⁄
;

35490 i‡(
	`JS_C›yD©aPr›îtõs
(
˘x
, 
obj
, 
s
, 
JS_UNDEFINED
, 
TRUE
))

35491 
ex˚±i⁄
;

35492 
	`JS_FªeVÆue
(
˘x
, 
s
);

35495  
obj
;

35496 
ex˚±i⁄
:

35497 
	`JS_FªeVÆue
(
˘x
, 
obj
);

35498 
	`JS_FªeVÆue
(
˘x
, 
s
);

35499  
JS_EXCEPTION
;

35500 
	}
}

35502 
JSVÆue
 
	$js_obje˘_£Æ
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

35503 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
, 
‰ìze_Êag
)

35505 
JSVÆueC⁄°
 
obj
 = 
¨gv
[0];

35506 
JSObje˘
 *
p
;

35507 
JSPr›îtyEnum
 *
¥›s
;

35508 
uöt32_t
 
Àn
, 
i
;

35509 
Êags
, 
desc_Êags
, 
ªs
;

35511 i‡(!
	`JS_IsObje˘
(
obj
))

35512  
	`JS_DupVÆue
(
˘x
, 
obj
);

35514 
ªs
 = 
	`JS_PªvítExãnsi⁄s
(
˘x
, 
obj
);

35515 i‡(
ªs
 < 0)

35516  
JS_EXCEPTION
;

35517 i‡(!
ªs
) {

35518  
	`JS_ThrowTy≥Eº‹
(
˘x
, "proxyÖreventExtensions handlerÑeturned false");

35521 
p
 = 
	`JS_VALUE_GET_OBJ
(
obj
);

35522 
Êags
 = 
JS_GPN_STRING_MASK
 | 
JS_GPN_SYMBOL_MASK
;

35523 i‡(
	`JS_GëOwnPr›îtyNamesI¡î«l
(
˘x
, &
¥›s
, &
Àn
, 
p
, 
Êags
))

35524  
JS_EXCEPTION
;

35526 
i
 = 0; i < 
Àn
; i++) {

35527 
JSPr›îtyDes¸ùt‹
 
desc
;

35528 
JSAtom
 
¥›
 = 
¥›s
[
i
].
©om
;

35530 
desc_Êags
 = 
JS_PROP_THROW
 | 
JS_PROP_HAS_CONFIGURABLE
;

35531 i‡(
‰ìze_Êag
) {

35532 
ªs
 = 
	`JS_GëOwnPr›îtyI¡î«l
(
˘x
, &
desc
, 
p
, 
¥›
);

35533 i‡(
ªs
 < 0)

35534 
ex˚±i⁄
;

35535 i‡(
ªs
) {

35536 i‡(
desc
.
Êags
 & 
JS_PROP_WRITABLE
)

35537 
desc_Êags
 |
JS_PROP_HAS_WRITABLE
;

35538 
	`js_‰ì_desc
(
˘x
, &
desc
);

35541 i‡(
	`JS_DeföePr›îty
(
˘x
, 
obj
, 
¥›
, 
JS_UNDEFINED
,

35542 
JS_UNDEFINED
, JS_UNDEFINED, 
desc_Êags
) < 0)

35543 
ex˚±i⁄
;

35545 
	`js_‰ì_¥›_íum
(
˘x
, 
¥›s
, 
Àn
);

35546  
	`JS_DupVÆue
(
˘x
, 
obj
);

35548 
ex˚±i⁄
:

35549 
	`js_‰ì_¥›_íum
(
˘x
, 
¥›s
, 
Àn
);

35550  
JS_EXCEPTION
;

35551 
	}
}

35553 
JSVÆue
 
	$js_obje˘_isSóÀd
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

35554 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
, 
is_‰ozí
)

35556 
JSVÆueC⁄°
 
obj
 = 
¨gv
[0];

35557 
JSObje˘
 *
p
;

35558 
JSPr›îtyEnum
 *
¥›s
;

35559 
uöt32_t
 
Àn
, 
i
;

35560 
Êags
, 
ªs
;

35562 i‡(!
	`JS_IsObje˘
(
obj
))

35563  
JS_TRUE
;

35565 
p
 = 
	`JS_VALUE_GET_OBJ
(
obj
);

35566 
Êags
 = 
JS_GPN_STRING_MASK
 | 
JS_GPN_SYMBOL_MASK
;

35567 i‡(
	`JS_GëOwnPr›îtyNamesI¡î«l
(
˘x
, &
¥›s
, &
Àn
, 
p
, 
Êags
))

35568  
JS_EXCEPTION
;

35570 
i
 = 0; i < 
Àn
; i++) {

35571 
JSPr›îtyDes¸ùt‹
 
desc
;

35572 
JSAtom
 
¥›
 = 
¥›s
[
i
].
©om
;

35574 
ªs
 = 
	`JS_GëOwnPr›îtyI¡î«l
(
˘x
, &
desc
, 
p
, 
¥›
);

35575 i‡(
ªs
 < 0)

35576 
ex˚±i⁄
;

35577 i‡(
ªs
) {

35578 
	`js_‰ì_desc
(
˘x
, &
desc
);

35579 i‡((
desc
.
Êags
 & 
JS_PROP_CONFIGURABLE
)

35580 || (
is_‰ozí
 && (
desc
.
Êags
 & 
JS_PROP_WRITABLE
))) {

35581 
ªs
 = 
FALSE
;

35582 
d⁄e
;

35586 
ªs
 = 
	`JS_IsExãnsibÀ
(
˘x
, 
obj
);

35587 i‡(
ªs
 < 0)

35588  
JS_EXCEPTION
;

35589 
ªs
 ^= 1;

35590 
d⁄e
:

35591 
	`js_‰ì_¥›_íum
(
˘x
, 
¥›s
, 
Àn
);

35592  
	`JS_NewBoﬁ
(
˘x
, 
ªs
);

35594 
ex˚±i⁄
:

35595 
	`js_‰ì_¥›_íum
(
˘x
, 
¥›s
, 
Àn
);

35596  
JS_EXCEPTION
;

35597 
	}
}

35599 
JSVÆue
 
	$js_obje˘_‰omE¡rõs
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

35600 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

35602 
JSVÆue
 
obj
, 
ôî
, 
√xt_mëhod
 = 
JS_UNDEFINED
;

35603 
JSVÆueC⁄°
 
ôîabÀ
;

35604 
BOOL
 
d⁄e
;

35608 
ôîabÀ
 = 
¨gv
[0];

35610 
obj
 = 
	`JS_NewObje˘
(
˘x
);

35611 i‡(
	`JS_IsEx˚±i⁄
(
obj
))

35612  
obj
;

35614 
ôî
 = 
	`JS_GëIãøt‹
(
˘x
, 
ôîabÀ
, 
FALSE
);

35615 i‡(
	`JS_IsEx˚±i⁄
(
ôî
))

35616 
Áû
;

35617 
√xt_mëhod
 = 
	`JS_GëPr›îty
(
˘x
, 
ôî
, 
JS_ATOM_√xt
);

35618 i‡(
	`JS_IsEx˚±i⁄
(
√xt_mëhod
))

35619 
Áû
;

35622 
JSVÆue
 
key
, 
vÆue
, 
ôem
;

35623 
ôem
 = 
	`JS_Iãøt‹Next
(
˘x
, 
ôî
, 
√xt_mëhod
, 0, 
NULL
, &
d⁄e
);

35624 i‡(
	`JS_IsEx˚±i⁄
(
ôem
))

35625 
Áû
;

35626 i‡(
d⁄e
) {

35627 
	`JS_FªeVÆue
(
˘x
, 
ôem
);

35631 
key
 = 
JS_UNDEFINED
;

35632 
vÆue
 = 
JS_UNDEFINED
;

35633 i‡(!
	`JS_IsObje˘
(
ôem
)) {

35634 
	`JS_ThrowTy≥Eº‹NŸAnObje˘
(
˘x
);

35635 
Áû1
;

35637 
key
 = 
	`JS_GëPr›îtyUöt32
(
˘x
, 
ôem
, 0);

35638 i‡(
	`JS_IsEx˚±i⁄
(
key
))

35639 
Áû1
;

35640 
vÆue
 = 
	`JS_GëPr›îtyUöt32
(
˘x
, 
ôem
, 1);

35641 i‡(
	`JS_IsEx˚±i⁄
(
vÆue
)) {

35642 
	`JS_FªeVÆue
(
˘x
, 
key
);

35643 
Áû1
;

35645 i‡(
	`JS_DeföePr›îtyVÆueVÆue
(
˘x
, 
obj
, 
key
, 
vÆue
,

35646 
JS_PROP_C_W_E
 | 
JS_PROP_THROW
) < 0) {

35647 
Áû1
:

35648 
	`JS_FªeVÆue
(
˘x
, 
ôem
);

35649 
Áû
;

35651 
	`JS_FªeVÆue
(
˘x
, 
ôem
);

35653 
	`JS_FªeVÆue
(
˘x
, 
√xt_mëhod
);

35654 
	`JS_FªeVÆue
(
˘x
, 
ôî
);

35655  
obj
;

35656 
Áû
:

35657 i‡(
	`JS_IsObje˘
(
ôî
)) {

35659 
	`JS_Iãøt‹Clo£
(
˘x
, 
ôî
, 
TRUE
);

35661 
	`JS_FªeVÆue
(
˘x
, 
√xt_mëhod
);

35662 
	`JS_FªeVÆue
(
˘x
, 
ôî
);

35663 
	`JS_FªeVÆue
(
˘x
, 
obj
);

35664  
JS_EXCEPTION
;

35665 
	}
}

35669 
JSVÆue
 
	$js_obje˘___£tOwnPr›îty
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

35670 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

35672 
ªt
;

35673 
ªt
 = 
	`JS_DeföePr›îtyVÆueVÆue
(
˘x
, 
¨gv
[0], 
	`JS_DupVÆue
(ctx,árgv[1]),

35674 
	`JS_DupVÆue
(
˘x
, 
¨gv
[2]),

35675 
JS_PROP_C_W_E
 | 
JS_PROP_THROW
);

35676 i‡(
ªt
 < 0)

35677  
JS_EXCEPTION
;

35679  
	`JS_NewBoﬁ
(
˘x
, 
ªt
);

35680 
	}
}

35682 
JSVÆue
 
	$js_obje˘___toObje˘
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

35683 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

35685  
	`JS_ToObje˘
(
˘x
, 
¨gv
[0]);

35686 
	}
}

35688 
JSVÆue
 
	$js_obje˘___toPrimôive
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

35689 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

35691 
höt
 = 
HINT_NONE
;

35693 i‡(
	`JS_VALUE_GET_TAG
(
¨gv
[1]Ë=
JS_TAG_INT
)

35694 
höt
 = 
	`JS_VALUE_GET_INT
(
¨gv
[1]);

35696  
	`JS_ToPrimôive
(
˘x
, 
¨gv
[0], 
höt
);

35697 
	}
}

35701 
JSVÆue
 
	$js_obje˘___gëCœss
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

35702 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

35704 
JSAtom
 
©om
;

35705 
JSObje˘
 *
p
;

35706 
uöt32_t
 
èg
;

35707 
˛ass_id
;

35709 
èg
 = 
	`JS_VALUE_GET_NORM_TAG
(
¨gv
[0]);

35710 i‡(
èg
 =
JS_TAG_OBJECT
) {

35711 
p
 = 
	`JS_VALUE_GET_OBJ
(
¨gv
[0]);

35712 
˛ass_id
 = 
p
->class_id;

35713 i‡(
˛ass_id
 =
JS_CLASS_PROXY
 && 
	`JS_IsFun˘i⁄
(
˘x
, 
¨gv
[0]))

35714 
˛ass_id
 = 
JS_CLASS_BYTECODE_FUNCTION
;

35715 
©om
 = 
˘x
->
π
->
˛ass_¨øy
[
˛ass_id
].
˛ass_«me
;

35717 
©om
 = 
JS_ATOM_em±y_°rög
;

35719  
	`JS_AtomToSåög
(
˘x
, 
©om
);

35720 
	}
}

35722 
JSVÆue
 
	$js_obje˘_is
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

35723 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

35725  
	`JS_NewBoﬁ
(
˘x
, 
	`js_ßme_vÆue
(˘x, 
¨gv
[0],árgv[1]));

35726 
	}
}

35729 
JSVÆue
 
	$js_obje˘___gëObje˘D©a
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

35730 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

35732  
	`JS_GëObje˘D©a
(
˘x
, 
¨gv
[0]);

35733 
	}
}

35735 
JSVÆue
 
	$js_obje˘___£tObje˘D©a
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

35736 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

35738 i‡(
	`JS_SëObje˘D©a
(
˘x
, 
¨gv
[0], 
	`JS_DupVÆue
(ctx,árgv[1])))

35739  
JS_EXCEPTION
;

35740  
	`JS_DupVÆue
(
˘x
, 
¨gv
[1]);

35741 
	}
}

35743 
JSVÆue
 
	$js_obje˘___toPr›îtyKey
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

35744 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

35746  
	`JS_ToPr›îtyKey
(
˘x
, 
¨gv
[0]);

35747 
	}
}

35749 
JSVÆue
 
	$js_obje˘___isObje˘
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

35750 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

35752  
	`JS_NewBoﬁ
(
˘x
, 
	`JS_IsObje˘
(
¨gv
[0]));

35753 
	}
}

35755 
JSVÆue
 
	$js_obje˘___isSameVÆueZîo
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

35756 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

35758  
	`JS_NewBoﬁ
(
˘x
, 
	`js_ßme_vÆue_zîo
(˘x, 
¨gv
[0],árgv[1]));

35759 
	}
}

35761 
JSVÆue
 
	$js_obje˘___isC⁄°ru˘‹
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

35762 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

35764  
	`JS_NewBoﬁ
(
˘x
, 
	`JS_IsC⁄°ru˘‹
(˘x, 
¨gv
[0]));

35765 
	}
}

35768 
JSVÆue
 
	$JS_S≥cõsC⁄°ru˘‹
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
obj
,

35769 
JSVÆueC⁄°
 
deÁu…C⁄°ru˘‹
)

35771 
JSVÆue
 
˘‹
, 
•ecõs
;

35773 i‡(!
	`JS_IsObje˘
(
obj
))

35774  
	`JS_ThrowTy≥Eº‹NŸAnObje˘
(
˘x
);

35775 
˘‹
 = 
	`JS_GëPr›îty
(
˘x
, 
obj
, 
JS_ATOM_c⁄°ru˘‹
);

35776 i‡(
	`JS_IsEx˚±i⁄
(
˘‹
))

35777  
˘‹
;

35778 i‡(
	`JS_IsUndeföed
(
˘‹
))

35779  
	`JS_DupVÆue
(
˘x
, 
deÁu…C⁄°ru˘‹
);

35780 i‡(!
	`JS_IsObje˘
(
˘‹
)) {

35781 
	`JS_FªeVÆue
(
˘x
, 
˘‹
);

35782  
	`JS_ThrowTy≥Eº‹NŸAnObje˘
(
˘x
);

35784 
•ecõs
 = 
	`JS_GëPr›îty
(
˘x
, 
˘‹
, 
JS_ATOM_Symbﬁ_•ecõs
);

35785 
	`JS_FªeVÆue
(
˘x
, 
˘‹
);

35786 i‡(
	`JS_IsEx˚±i⁄
(
•ecõs
))

35787  
•ecõs
;

35788 i‡(
	`JS_IsUndeföed
(
•ecõs
Ë|| 
	`JS_IsNuŒ
(species))

35789  
	`JS_DupVÆue
(
˘x
, 
deÁu…C⁄°ru˘‹
);

35790 i‡(!
	`JS_IsC⁄°ru˘‹
(
˘x
, 
•ecõs
)) {

35791 
	`JS_FªeVÆue
(
˘x
, 
•ecõs
);

35792  
	`JS_ThrowTy≥Eº‹
(
˘x
, "notá constructor");

35794  
•ecõs
;

35795 
	}
}

35798 
JSVÆue
 
	$js_obje˘___•ecõsC⁄°ru˘‹
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

35799 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

35801  
	`JS_S≥cõsC⁄°ru˘‹
(
˘x
, 
¨gv
[0],árgv[1]);

35802 
	}
}

35805 
JSVÆue
 
	$js_obje˘_gë___¥Ÿo__
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
)

35807 
JSVÆue
 
vÆ
, 
ªt
;

35809 
vÆ
 = 
	`JS_ToObje˘
(
˘x
, 
this_vÆ
);

35810 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

35811  
vÆ
;

35812 
ªt
 = 
	`JS_DupVÆue
(
˘x
, 
	`JS_GëPrŸŸy≥
(˘x, 
vÆ
));

35813 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

35814  
ªt
;

35815 
	}
}

35817 
JSVÆue
 
	$js_obje˘_£t___¥Ÿo__
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

35818 
JSVÆueC⁄°
 
¥Ÿo
)

35820 i‡(
	`JS_IsUndeföed
(
this_vÆ
Ë|| 
	`JS_IsNuŒ
(this_val))

35821  
	`JS_ThrowTy≥Eº‹NŸAnObje˘
(
˘x
);

35822 i‡(!
	`JS_IsObje˘
(
¥Ÿo
Ë&& !
	`JS_IsNuŒ
(proto))

35823  
JS_UNDEFINED
;

35824 i‡(
	`JS_SëPrŸŸy≥I¡î«l
(
˘x
, 
this_vÆ
, 
¥Ÿo
, 
TRUE
) < 0)

35825  
JS_EXCEPTION
;

35827  
JS_UNDEFINED
;

35828 
	}
}

35830 
JSVÆue
 
	$js_obje˘_isPrŸŸy≥Of
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

35831 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

35833 
JSVÆue
 
obj
;

35834 
JSVÆueC⁄°
 
v
;

35835 
max_dïth
 = 1000, 
ªs
 = -1;

35837 
v
 = 
¨gv
[0];

35838 i‡(!
	`JS_IsObje˘
(
v
))

35839  
JS_FALSE
;

35840 
obj
 = 
	`JS_ToObje˘
(
˘x
, 
this_vÆ
);

35841 i‡(
	`JS_IsEx˚±i⁄
(
obj
))

35842  
JS_EXCEPTION
;

35843 --
max_dïth
 > 0) {

35844 
v
 = 
	`JS_GëPrŸŸy≥
(
˘x
, v);

35845 i‡(
	`JS_IsEx˚±i⁄
(
v
))

35846 
ex˚±i⁄
;

35847 i‡(
	`JS_IsNuŒ
(
v
)) {

35848 
ªs
 = 
FALSE
;

35851 i‡(
	`js_°ri˘_eq2
(
˘x
, 
	`JS_DupVÆue
(˘x, 
obj
), JS_DupVÆue(˘x, 
v
),

35852 
JS_EQ_STRICT
)) {

35853 
ªs
 = 
TRUE
;

35857 
	`JS_FªeVÆue
(
˘x
, 
obj
);

35858 i‡(
ªs
 < 0)

35859  
	`JS_ThrowI¡î«lEº‹
(
˘x
, "prototype chain cycle");

35861  
	`JS_NewBoﬁ
(
˘x
, 
ªs
);

35863 
ex˚±i⁄
:

35864 
	`JS_FªeVÆue
(
˘x
, 
obj
);

35865  
JS_EXCEPTION
;

35866 
	}
}

35868 
JSVÆue
 
	$js_obje˘_¥›îtyIsEnumîabÀ
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

35869 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

35871 
JSVÆue
 
obj
, 
ªs
 = 
JS_EXCEPTION
;

35872 
JSAtom
 
¥›
 = 
JS_ATOM_NULL
;

35873 
JSPr›îtyDes¸ùt‹
 
desc
;

35874 
has_¥›
;

35876 
obj
 = 
	`JS_ToObje˘
(
˘x
, 
this_vÆ
);

35877 i‡(
	`JS_IsEx˚±i⁄
(
obj
))

35878 
ex˚±i⁄
;

35879 
¥›
 = 
	`JS_VÆueToAtom
(
˘x
, 
¨gv
[0]);

35880 i‡(
	`u∆ikñy
(
¥›
 =
JS_ATOM_NULL
))

35881 
ex˚±i⁄
;

35883 
has_¥›
 = 
	`JS_GëOwnPr›îtyI¡î«l
(
˘x
, &
desc
, 
	`JS_VALUE_GET_OBJ
(
obj
), 
¥›
);

35884 i‡(
has_¥›
 < 0)

35885 
ex˚±i⁄
;

35886 i‡(
has_¥›
) {

35887 
ªs
 = 
	`JS_NewBoﬁ
(
˘x
, (
desc
.
Êags
 & 
JS_PROP_ENUMERABLE
) != 0);

35888 
	`js_‰ì_desc
(
˘x
, &
desc
);

35890 
ªs
 = 
JS_FALSE
;

35893 
ex˚±i⁄
:

35894 
	`JS_FªeAtom
(
˘x
, 
¥›
);

35895 
	`JS_FªeVÆue
(
˘x
, 
obj
);

35896  
ªs
;

35897 
	}
}

35899 
JSVÆue
 
	$js_obje˘___lookupGëãr__
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

35900 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
, 
£âî
)

35902 
JSVÆue
 
obj
, 
ªs
 = 
JS_EXCEPTION
;

35903 
JSVÆueC⁄°
 
v
;

35904 
JSAtom
 
¥›
 = 
JS_ATOM_NULL
;

35905 
JSPr›îtyDes¸ùt‹
 
desc
;

35906 
has_¥›
;

35908 
obj
 = 
	`JS_ToObje˘
(
˘x
, 
this_vÆ
);

35909 i‡(
	`JS_IsEx˚±i⁄
(
obj
))

35910 
ex˚±i⁄
;

35911 
¥›
 = 
	`JS_VÆueToAtom
(
˘x
, 
¨gv
[0]);

35912 i‡(
	`u∆ikñy
(
¥›
 =
JS_ATOM_NULL
))

35913 
ex˚±i⁄
;

35915 
v
 = 
obj
;;) {

35916 
has_¥›
 = 
	`JS_GëOwnPr›îtyI¡î«l
(
˘x
, &
desc
, 
	`JS_VALUE_GET_OBJ
(
v
), 
¥›
);

35917 i‡(
has_¥›
 < 0)

35918 
ex˚±i⁄
;

35919 i‡(
has_¥›
) {

35920 i‡(
desc
.
Êags
 & 
JS_PROP_GETSET
)

35921 
ªs
 = 
	`JS_DupVÆue
(
˘x
, 
£âî
 ? 
desc
.£âî : desc.
gëãr
);

35923 
ªs
 = 
JS_UNDEFINED
;

35924 
	`js_‰ì_desc
(
˘x
, &
desc
);

35927 
v
 = 
	`JS_GëPrŸŸy≥
(
˘x
, v);

35928 i‡(
	`JS_IsEx˚±i⁄
(
v
))

35929 
ex˚±i⁄
;

35930 i‡(
	`JS_IsNuŒ
(
v
)) {

35931 
ªs
 = 
JS_UNDEFINED
;

35936 
ex˚±i⁄
:

35937 
	`JS_FªeAtom
(
˘x
, 
¥›
);

35938 
	`JS_FªeVÆue
(
˘x
, 
obj
);

35939  
ªs
;

35940 
	}
}

35942 c⁄° 
JSCFun˘i⁄Li°E¡ry
 
	gjs_obje˘_funcs
[] = {

35943 
JS_CFUNC_DEF
("¸óã", 2, 
js_obje˘_¸óã
 ),

35944 
JS_CFUNC_MAGIC_DEF
("gëPrŸŸy≥Of", 1, 
js_obje˘_gëPrŸŸy≥Of
, 0 ),

35945 
JS_CFUNC_DEF
("£tPrŸŸy≥Of", 2, 
js_obje˘_£tPrŸŸy≥Of
 ),

35946 
JS_CFUNC_MAGIC_DEF
("deföePr›îty", 3, 
js_obje˘_deföePr›îty
, 0 ),

35947 
JS_CFUNC_DEF
("deföePr›îtõs", 2, 
js_obje˘_deföePr›îtõs
 ),

35948 
JS_CFUNC_DEF
("gëOwnPr›îtyNames", 1, 
js_obje˘_gëOwnPr›îtyNames
 ),

35949 
JS_CFUNC_DEF
("gëOwnPr›îtySymbﬁs", 1, 
js_obje˘_gëOwnPr›îtySymbﬁs
 ),

35950 
JS_CFUNC_MAGIC_DEF
("keys", 1, 
js_obje˘_keys
, 
JS_ITERATOR_KIND_KEY
 ),

35951 
JS_CFUNC_MAGIC_DEF
("vÆues", 1, 
js_obje˘_keys
, 
JS_ITERATOR_KIND_VALUE
 ),

35952 
JS_CFUNC_MAGIC_DEF
("íåõs", 1, 
js_obje˘_keys
, 
JS_ITERATOR_KIND_KEY_AND_VALUE
 ),

35953 
JS_CFUNC_MAGIC_DEF
("isExãnsibÀ", 1, 
js_obje˘_isExãnsibÀ
, 0 ),

35954 
JS_CFUNC_MAGIC_DEF
("¥evítExãnsi⁄s", 1, 
js_obje˘_¥evítExãnsi⁄s
, 0 ),

35955 
JS_CFUNC_MAGIC_DEF
("gëOwnPr›îtyDes¸ùt‹", 2, 
js_obje˘_gëOwnPr›îtyDes¸ùt‹
, 0 ),

35956 
JS_CFUNC_DEF
("gëOwnPr›îtyDes¸ùt‹s", 1, 
js_obje˘_gëOwnPr›îtyDes¸ùt‹s
 ),

35957 
JS_CFUNC_DEF
("is", 2, 
js_obje˘_is
 ),

35958 
JS_CFUNC_DEF
("assign", 2, 
js_obje˘_assign
 ),

35959 
JS_CFUNC_MAGIC_DEF
("£Æ", 1, 
js_obje˘_£Æ
, 0 ),

35960 
JS_CFUNC_MAGIC_DEF
("‰ìze", 1, 
js_obje˘_£Æ
, 1 ),

35961 
JS_CFUNC_MAGIC_DEF
("isSóÀd", 1, 
js_obje˘_isSóÀd
, 0 ),

35962 
JS_CFUNC_MAGIC_DEF
("isFrozí", 1, 
js_obje˘_isSóÀd
, 1 ),

35963 
JS_CFUNC_DEF
("__gëCœss", 1, 
js_obje˘___gëCœss
 ),

35974 
JS_CFUNC_DEF
("‰omE¡rõs", 1, 
js_obje˘_‰omE¡rõs
 ),

35977 c⁄° 
JSCFun˘i⁄Li°E¡ry
 
	gjs_obje˘_¥Ÿo_funcs
[] = {

35978 
JS_CFUNC_DEF
("toSåög", 0, 
js_obje˘_toSåög
 ),

35979 
JS_CFUNC_DEF
("toLoˇÀSåög", 0, 
js_obje˘_toLoˇÀSåög
 ),

35980 
JS_CFUNC_DEF
("vÆueOf", 0, 
js_obje˘_vÆueOf
 ),

35981 
JS_CFUNC_DEF
("hasOwnPr›îty", 1, 
js_obje˘_hasOwnPr›îty
 ),

35982 
JS_CFUNC_DEF
("isPrŸŸy≥Of", 1, 
js_obje˘_isPrŸŸy≥Of
 ),

35983 
JS_CFUNC_DEF
("¥›îtyIsEnumîabÀ", 1, 
js_obje˘_¥›îtyIsEnumîabÀ
 ),

35984 
JS_CGETSET_DEF
("__¥Ÿo__", 
js_obje˘_gë___¥Ÿo__
, 
js_obje˘_£t___¥Ÿo__
 ),

35985 
JS_CFUNC_MAGIC_DEF
("__deföeGëãr__", 2, 
js_obje˘___deföeGëãr__
, 0 ),

35986 
JS_CFUNC_MAGIC_DEF
("__deföeSëãr__", 2, 
js_obje˘___deföeGëãr__
, 1 ),

35987 
JS_CFUNC_MAGIC_DEF
("__lookupGëãr__", 1, 
js_obje˘___lookupGëãr__
, 0 ),

35988 
JS_CFUNC_MAGIC_DEF
("__lookupSëãr__", 1, 
js_obje˘___lookupGëãr__
, 1 ),

35993 
JSVÆue
 
	$js_fun˘i⁄_¥Ÿo
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

35994 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

35996  
JS_UNDEFINED
;

35997 
	}
}

36001 
	$∑tch_fun˘i⁄_c⁄°ru˘‹_sour˚
(
JSC⁄ãxt
 *
˘x
,

36002 
JSVÆueC⁄°
 
func_obj
,

36003 
size_t
 
pos
)

36005 
JSObje˘
 *
p
;

36006 
JSFun˘i⁄Byãcode
 *
b
;

36007 *
r
, *
r_íd
, *
√w_sour˚
;

36008 
c
;

36009 
size_t
 
idx
, 
Àn
;

36011 i‡(
	`JS_VALUE_GET_TAG
(
func_obj
Ë!
JS_TAG_OBJECT
)

36013 
p
 = 
	`JS_VALUE_GET_OBJ
(
func_obj
);

36014 i‡(!
	`js_˛ass_has_byãcode
(
p
->
˛ass_id
))

36016 
b
 = 
p
->
u
.
func
.
fun˘i⁄_byãcode
;

36017 i‡(!
b
->
has_debug
)

36019 
r
 = 
b
->
debug
.
sour˚
;

36020 
r_íd
 = 
b
->
debug
.
sour˚
 + b->debug.
sour˚_Àn
;

36021 
idx
 = 0;

36022 
r
 < 
r_íd
) {

36023 i‡(
idx
 =
pos
) {

36025 
√w_sour˚
 = 
	`js_ªÆloc
(
˘x
, 
b
->
debug
.
sour˚
,

36026 
b
->
debug
.
sour˚_Àn
 + 2);

36027 i‡(!
√w_sour˚
)

36029 
Àn
 = 
r
 - 
b
->
debug
.
sour˚
;

36030 
	`memmove
(
√w_sour˚
 + 
Àn
 + 1,Çew_source +Üen,

36031 
b
->
debug
.
sour˚_Àn
 + 1 - 
Àn
);

36032 
√w_sour˚
[
Àn
] = '\n';

36033 
b
->
debug
.
sour˚
 = 
√w_sour˚
;

36034 
b
->
debug
.
sour˚_Àn
++;

36037 
c
 = 
	`unicode_‰om_utf8
((c⁄° 
uöt8_t
 *)
r
, 
UTF8_CHAR_LEN_MAX
,

36038 (c⁄° 
uöt8_t
 **)&
r
);

36039 i‡(
c
 < 0)

36041 
idx
++;

36044 
	}
}

36047 
JSVÆue
 
	$js_fun˘i⁄_c⁄°ru˘‹
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
√w_èrgë
,

36048 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
, 
magic
)

36050 
JSFun˘i⁄KödEnum
 
func_köd
 = 
magic
;

36051 
i
, 
n
, 
ªt
, 
func_°¨t_pos
;

36052 
JSVÆue
 
s
, 
¥Ÿo
, 
obj
 = 
JS_UNDEFINED
;

36053 
SåögBuf„r
 
b_s
, *
b
 = &b_s;

36055 
	`°rög_buf„r_öô
(
˘x
, 
b
, 0);

36056 
	`°rög_buf„r_putc8
(
b
, '(');

36058 i‡(
func_köd
 =
JS_FUNC_ASYNC
 || func_köd =
JS_FUNC_ASYNC_GENERATOR
) {

36059 
	`°rög_buf„r_puts8
(
b
, "async ");

36061 
	`°rög_buf„r_puts8
(
b
, "function");

36063 i‡(
func_köd
 =
JS_FUNC_GENERATOR
 || func_köd =
JS_FUNC_ASYNC_GENERATOR
) {

36064 
	`°rög_buf„r_putc8
(
b
, '*');

36066 
	`°rög_buf„r_puts8
(
b
, "ánonymous(");

36068 
n
 = 
¨gc
 - 1;

36069 
i
 = 0; i < 
n
; i++) {

36070 i‡(
i
 != 0) {

36071 
	`°rög_buf„r_putc8
(
b
, ',');

36073 i‡(
	`°rög_buf„r_c⁄ˇt_vÆue
(
b
, 
¨gv
[
i
]))

36074 
Áû
;

36076 
	`°rög_buf„r_puts8
(
b
, "\n) {");

36082 
func_°¨t_pos
 = 
b
->
Àn
 - 1;

36083 i‡(
n
 >= 0) {

36084 i‡(
	`°rög_buf„r_c⁄ˇt_vÆue
(
b
, 
¨gv
[
n
]))

36085 
Áû
;

36087 
	`°rög_buf„r_puts8
(
b
, "\n})");

36088 
s
 = 
	`°rög_buf„r_íd
(
b
);

36089 i‡(
	`JS_IsEx˚±i⁄
(
s
))

36090 
Áû1
;

36092 
obj
 = 
	`JS_EvÆObje˘
(
˘x
, ctx->
globÆ_obj
, 
s
, 
JS_EVAL_TYPE_INDIRECT
, -1);

36093 
	`JS_FªeVÆue
(
˘x
, 
s
);

36094 i‡(
	`JS_IsEx˚±i⁄
(
obj
))

36095 
Áû1
;

36096 i‡(
	`∑tch_fun˘i⁄_c⁄°ru˘‹_sour˚
(
˘x
, 
obj
, 
func_°¨t_pos
) < 0)

36097 
Áû1
;

36098 i‡(!
	`JS_IsUndeföed
(
√w_èrgë
)) {

36100 
¥Ÿo
 = 
	`JS_GëPr›îty
(
˘x
, 
√w_èrgë
, 
JS_ATOM_¥ŸŸy≥
);

36101 i‡(
	`JS_IsEx˚±i⁄
(
¥Ÿo
))

36102 
Áû1
;

36103 i‡(!
	`JS_IsObje˘
(
¥Ÿo
)) {

36104 
JSC⁄ãxt
 *
ªÆm
;

36105 
	`JS_FªeVÆue
(
˘x
, 
¥Ÿo
);

36106 
ªÆm
 = 
	`JS_GëFun˘i⁄Rólm
(
˘x
, 
√w_èrgë
);

36107 i‡(!
ªÆm
)

36108 
Áû1
;

36109 
¥Ÿo
 = 
	`JS_DupVÆue
(
˘x
, 
ªÆm
->
˛ass_¥Ÿo
[
func_köd_to_˛ass_id
[
func_köd
]]);

36111 
ªt
 = 
	`JS_SëPrŸŸy≥I¡î«l
(
˘x
, 
obj
, 
¥Ÿo
, 
TRUE
);

36112 
	`JS_FªeVÆue
(
˘x
, 
¥Ÿo
);

36113 i‡(
ªt
 < 0)

36114 
Áû1
;

36116  
obj
;

36118 
Áû
:

36119 
	`°rög_buf„r_‰ì
(
b
);

36120 
Áû1
:

36121 
	`JS_FªeVÆue
(
˘x
, 
obj
);

36122  
JS_EXCEPTION
;

36123 
	}
}

36125 
__ex˚±i⁄
 
	$js_gë_Àngth32
(
JSC⁄ãxt
 *
˘x
, 
uöt32_t
 *
¥es
,

36126 
JSVÆueC⁄°
 
obj
)

36128 
JSVÆue
 
Àn_vÆ
;

36129 
Àn_vÆ
 = 
	`JS_GëPr›îty
(
˘x
, 
obj
, 
JS_ATOM_Àngth
);

36130 i‡(
	`JS_IsEx˚±i⁄
(
Àn_vÆ
)) {

36131 *
¥es
 = 0;

36134  
	`JS_ToUöt32Fªe
(
˘x
, 
¥es
, 
Àn_vÆ
);

36135 
	}
}

36137 
__ex˚±i⁄
 
	$js_gë_Àngth64
(
JSC⁄ãxt
 *
˘x
, 
öt64_t
 *
¥es
,

36138 
JSVÆueC⁄°
 
obj
)

36140 
JSVÆue
 
Àn_vÆ
;

36141 
Àn_vÆ
 = 
	`JS_GëPr›îty
(
˘x
, 
obj
, 
JS_ATOM_Àngth
);

36142 i‡(
	`JS_IsEx˚±i⁄
(
Àn_vÆ
)) {

36143 *
¥es
 = 0;

36146  
	`JS_ToLígthFªe
(
˘x
, 
¥es
, 
Àn_vÆ
);

36147 
	}
}

36149 
	$‰ì_¨g_li°
(
JSC⁄ãxt
 *
˘x
, 
JSVÆue
 *
èb
, 
uöt32_t
 
Àn
)

36151 
uöt32_t
 
i
;

36152 
i
 = 0; i < 
Àn
; i++) {

36153 
	`JS_FªeVÆue
(
˘x
, 
èb
[
i
]);

36155 
	`js_‰ì
(
˘x
, 
èb
);

36156 
	}
}

36159 
JSVÆue
 *
	$buûd_¨g_li°
(
JSC⁄ãxt
 *
˘x
, 
uöt32_t
 *
∂í
,

36160 
JSVÆueC⁄°
 
¨øy_¨g
)

36162 
uöt32_t
 
Àn
, 
i
;

36163 
JSVÆue
 *
èb
, 
ªt
;

36164 
JSObje˘
 *
p
;

36166 i‡(
	`JS_VALUE_GET_TAG
(
¨øy_¨g
Ë!
JS_TAG_OBJECT
) {

36167 
	`JS_ThrowTy≥Eº‹
(
˘x
, "notá object");

36168  
NULL
;

36170 i‡(
	`js_gë_Àngth32
(
˘x
, &
Àn
, 
¨øy_¨g
))

36171  
NULL
;

36173 
èb
 = 
	`js_mÆlocz
(
˘x
, —ab[0]Ë* 
	`max_uöt32
(1, 
Àn
));

36174 i‡(!
èb
)

36175  
NULL
;

36176 
p
 = 
	`JS_VALUE_GET_OBJ
(
¨øy_¨g
);

36177 i‡((
p
->
˛ass_id
 =
JS_CLASS_ARRAY
 ||Ö->˛ass_id =
JS_CLASS_ARGUMENTS
) &&

36178 
p
->
Á°_¨øy
 &&

36179 
Àn
 =
p
->
u
.
¨øy
.
cou¡
) {

36180 
i
 = 0; i < 
Àn
; i++) {

36181 
èb
[
i
] = 
	`JS_DupVÆue
(
˘x
, 
p
->
u
.
¨øy
.u.
vÆues
[i]);

36184 
i
 = 0; i < 
Àn
; i++) {

36185 
ªt
 = 
	`JS_GëPr›îtyUöt32
(
˘x
, 
¨øy_¨g
, 
i
);

36186 i‡(
	`JS_IsEx˚±i⁄
(
ªt
)) {

36187 
	`‰ì_¨g_li°
(
˘x
, 
èb
, 
i
);

36188  
NULL
;

36190 
èb
[
i
] = 
ªt
;

36193 *
∂í
 = 
Àn
;

36194  
èb
;

36195 
	}
}

36197 
JSVÆue
 
	$js_fun˘i⁄_≠∂y
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

36198 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
, 
magic
)

36200 
JSVÆueC⁄°
 
this_¨g
, 
¨øy_¨g
;

36201 
uöt32_t
 
Àn
;

36202 
JSVÆue
 *
èb
, 
ªt
;

36204 i‡(
	`check_fun˘i⁄
(
˘x
, 
this_vÆ
))

36205  
JS_EXCEPTION
;

36206 
this_¨g
 = 
¨gv
[0];

36207 
¨øy_¨g
 = 
¨gv
[1];

36208 i‡(
	`JS_VALUE_GET_TAG
(
¨øy_¨g
Ë=
JS_TAG_UNDEFINED
 ||

36209 
	`JS_VALUE_GET_TAG
(
¨øy_¨g
Ë=
JS_TAG_NULL
) {

36210  
	`JS_CÆl
(
˘x
, 
this_vÆ
, 
this_¨g
, 0, 
NULL
);

36212 
èb
 = 
	`buûd_¨g_li°
(
˘x
, &
Àn
, 
¨øy_¨g
);

36213 i‡(!
èb
)

36214  
JS_EXCEPTION
;

36215 i‡(
magic
) {

36216 
ªt
 = 
	`JS_CÆlC⁄°ru˘‹2
(
˘x
, 
this_vÆ
, 
this_¨g
, 
Àn
, (
JSVÆueC⁄°
 *)
èb
);

36218 
ªt
 = 
	`JS_CÆl
(
˘x
, 
this_vÆ
, 
this_¨g
, 
Àn
, (
JSVÆueC⁄°
 *)
èb
);

36220 
	`‰ì_¨g_li°
(
˘x
, 
èb
, 
Àn
);

36221  
ªt
;

36222 
	}
}

36224 
JSVÆue
 
	$js_fun˘i⁄_ˇŒ
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

36225 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

36227 i‡(
¨gc
 <= 0) {

36228  
	`JS_CÆl
(
˘x
, 
this_vÆ
, 
JS_UNDEFINED
, 0, 
NULL
);

36230  
	`JS_CÆl
(
˘x
, 
this_vÆ
, 
¨gv
[0], 
¨gc
 - 1,árgv + 1);

36232 
	}
}

36234 
JSVÆue
 
	$js_fun˘i⁄_böd
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

36235 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

36237 
JSBoundFun˘i⁄
 *
bf
;

36238 
JSVÆue
 
func_obj
, 
«me1
;

36239 
JSObje˘
 *
p
;

36240 
¨g_cou¡
, 
i
;

36241 
uöt32_t
 
Àn1
;

36243 i‡(
	`check_fun˘i⁄
(
˘x
, 
this_vÆ
))

36244  
JS_EXCEPTION
;

36246 
func_obj
 = 
	`JS_NewObje˘PrŸoCœss
(
˘x
, ctx->
fun˘i⁄_¥Ÿo
,

36247 
JS_CLASS_BOUND_FUNCTION
);

36248 i‡(
	`JS_IsEx˚±i⁄
(
func_obj
))

36249  
JS_EXCEPTION
;

36250 
p
 = 
	`JS_VALUE_GET_OBJ
(
func_obj
);

36251 
p
->
is_c⁄°ru˘‹
 = 
	`JS_IsC⁄°ru˘‹
(
˘x
, 
this_vÆ
);

36252 
¨g_cou¡
 = 
	`max_öt
(0, 
¨gc
 - 1);

36253 
bf
 = 
	`js_mÆloc
(
˘x
, (*bfË+ 
¨g_cou¡
 * (
JSVÆue
));

36254 i‡(!
bf
)

36255 
ex˚±i⁄
;

36256 
bf
->
func_obj
 = 
	`JS_DupVÆue
(
˘x
, 
this_vÆ
);

36257 
bf
->
this_vÆ
 = 
	`JS_DupVÆue
(
˘x
, 
¨gv
[0]);

36258 
bf
->
¨gc
 = 
¨g_cou¡
;

36259 
i
 = 0; i < 
¨g_cou¡
; i++) {

36260 
bf
->
¨gv
[
i
] = 
	`JS_DupVÆue
(
˘x
,árgv[i + 1]);

36262 
p
->
u
.
bound_fun˘i⁄
 = 
bf
;

36264 
«me1
 = 
	`JS_GëPr›îty
(
˘x
, 
this_vÆ
, 
JS_ATOM_«me
);

36265 i‡(
	`JS_IsEx˚±i⁄
(
«me1
))

36266 
ex˚±i⁄
;

36267 i‡(!
	`JS_IsSåög
(
«me1
)) {

36268 
	`JS_FªeVÆue
(
˘x
, 
«me1
);

36269 
«me1
 = 
	`JS_AtomToSåög
(
˘x
, 
JS_ATOM_em±y_°rög
);

36271 
«me1
 = 
	`JS_C⁄ˇtSåög3
(
˘x
, "bound ",Çame1, "");

36272 i‡(
	`JS_IsEx˚±i⁄
(
«me1
))

36273 
ex˚±i⁄
;

36274 
	`JS_DeföePr›îtyVÆue
(
˘x
, 
func_obj
, 
JS_ATOM_«me
, 
«me1
,

36275 
JS_PROP_CONFIGURABLE
);

36276 i‡(
	`js_gë_Àngth32
(
˘x
, &
Àn1
, 
this_vÆ
))

36277 
ex˚±i⁄
;

36278 i‡(
Àn1
 <(
uöt32_t
)
¨g_cou¡
)

36279 
Àn1
 = 0;

36281 
Àn1
 -
¨g_cou¡
;

36282 
	`JS_DeföePr›îtyVÆue
(
˘x
, 
func_obj
, 
JS_ATOM_Àngth
,

36283 
	`JS_NewUöt32
(
˘x
, 
Àn1
),

36284 
JS_PROP_CONFIGURABLE
);

36285  
func_obj
;

36286 
ex˚±i⁄
:

36287 
	`JS_FªeVÆue
(
˘x
, 
func_obj
);

36288  
JS_EXCEPTION
;

36289 
	}
}

36291 
JSVÆue
 
	$js_fun˘i⁄_toSåög
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

36292 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

36294 
JSObje˘
 *
p
;

36295 
JSFun˘i⁄KödEnum
 
func_köd
 = 
JS_FUNC_NORMAL
;

36297 i‡(
	`check_fun˘i⁄
(
˘x
, 
this_vÆ
))

36298  
JS_EXCEPTION
;

36300 
p
 = 
	`JS_VALUE_GET_OBJ
(
this_vÆ
);

36301 i‡(
	`js_˛ass_has_byãcode
(
p
->
˛ass_id
)) {

36302 
JSFun˘i⁄Byãcode
 *
b
 = 
p
->
u
.
func
.
fun˘i⁄_byãcode
;

36303 i‡(
b
->
has_debug
 && b->
debug
.
sour˚
) {

36304  
	`JS_NewSåögLí
(
˘x
, 
b
->
debug
.
sour˚
, b->debug.
sour˚_Àn
);

36306 
func_köd
 = 
b
->func_kind;

36309 
JSVÆue
 
«me
;

36310 c⁄° *
¥ef
, *
suff
;

36312 i‡(
p
->
is_˛ass
) {

36313 
¥ef
 = "class ";

36314 
suff
 = " {\n [native code]\n}";

36316 
func_köd
) {

36318 
JS_FUNC_NORMAL
:

36319 
¥ef
 = "function ";

36321 
JS_FUNC_GENERATOR
:

36322 
¥ef
 = "function *";

36324 
JS_FUNC_ASYNC
:

36325 
¥ef
 = "async function ";

36327 
JS_FUNC_ASYNC_GENERATOR
:

36328 
¥ef
 = "async function *";

36331 
suff
 = "() {\n [native code]\n}";

36333 
«me
 = 
	`JS_GëPr›îty
(
˘x
, 
this_vÆ
, 
JS_ATOM_«me
);

36334 i‡(
	`JS_IsUndeföed
(
«me
))

36335 
«me
 = 
	`JS_AtomToSåög
(
˘x
, 
JS_ATOM_em±y_°rög
);

36336  
	`JS_C⁄ˇtSåög3
(
˘x
, 
¥ef
, 
«me
, 
suff
);

36338 
	}
}

36340 
JSVÆue
 
	$js_fun˘i⁄_hasIn°™˚
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

36341 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

36343 
ªt
;

36344 
ªt
 = 
	`JS_Ordö¨yIsIn°™˚Of
(
˘x
, 
¨gv
[0], 
this_vÆ
);

36345 i‡(
ªt
 < 0)

36346  
JS_EXCEPTION
;

36348  
	`JS_NewBoﬁ
(
˘x
, 
ªt
);

36349 
	}
}

36351 c⁄° 
JSCFun˘i⁄Li°E¡ry
 
	gjs_fun˘i⁄_¥Ÿo_funcs
[] = {

36352 
JS_CFUNC_DEF
("ˇŒ", 1, 
js_fun˘i⁄_ˇŒ
 ),

36353 
JS_CFUNC_MAGIC_DEF
("≠∂y", 2, 
js_fun˘i⁄_≠∂y
, 0 ),

36354 
JS_CFUNC_DEF
("böd", 1, 
js_fun˘i⁄_böd
 ),

36355 
JS_CFUNC_DEF
("toSåög", 0, 
js_fun˘i⁄_toSåög
 ),

36356 
JS_CFUNC_DEF
("[Symbﬁ.hasIn°™˚]", 1, 
js_fun˘i⁄_hasIn°™˚
 ),

36357 
JS_CGETSET_DEF
("fûeName", 
js_fun˘i⁄_¥Ÿo_fûeName
, 
NULL
 ),

36358 
JS_CGETSET_DEF
("löeNumbî", 
js_fun˘i⁄_¥Ÿo_löeNumbî
, 
NULL
 ),

36363 
JSVÆue
 
	$ôî©‹_to_¨øy
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
ôems
)

36365 
JSVÆue
 
ôî
, 
√xt_mëhod
 = 
JS_UNDEFINED
;

36366 
JSVÆue
 
v
, 
r
 = 
JS_UNDEFINED
;

36367 
söt64_t
 
k
;

36368 
BOOL
 
d⁄e
;

36370 
ôî
 = 
	`JS_GëIãøt‹
(
˘x
, 
ôems
, 
FALSE
);

36371 i‡(
	`JS_IsEx˚±i⁄
(
ôî
))

36372 
ex˚±i⁄
;

36373 
√xt_mëhod
 = 
	`JS_GëPr›îty
(
˘x
, 
ôî
, 
JS_ATOM_√xt
);

36374 i‡(
	`JS_IsEx˚±i⁄
(
√xt_mëhod
))

36375 
ex˚±i⁄
;

36376 
r
 = 
	`JS_NewAºay
(
˘x
);

36377 i‡(
	`JS_IsEx˚±i⁄
(
r
))

36378 
ex˚±i⁄
;

36379 
k
 = 0;; k++) {

36380 
v
 = 
	`JS_Iãøt‹Next
(
˘x
, 
ôî
, 
√xt_mëhod
, 0, 
NULL
, &
d⁄e
);

36381 i‡(
	`JS_IsEx˚±i⁄
(
v
))

36382 
ex˚±i⁄_˛o£
;

36383 i‡(
d⁄e
)

36385 i‡(
	`JS_DeföePr›îtyVÆueI¡64
(
˘x
, 
r
, 
k
, 
v
,

36386 
JS_PROP_C_W_E
 | 
JS_PROP_THROW
) < 0)

36387 
ex˚±i⁄_˛o£
;

36389 
d⁄e
:

36390 
	`JS_FªeVÆue
(
˘x
, 
√xt_mëhod
);

36391 
	`JS_FªeVÆue
(
˘x
, 
ôî
);

36392  
r
;

36393 
ex˚±i⁄_˛o£
:

36394 
	`JS_Iãøt‹Clo£
(
˘x
, 
ôî
, 
TRUE
);

36395 
ex˚±i⁄
:

36396 
	`JS_FªeVÆue
(
˘x
, 
r
);

36397 
r
 = 
JS_EXCEPTION
;

36398 
d⁄e
;

36399 
	}
}

36401 
JSVÆue
 
	$js_îr‹_c⁄°ru˘‹
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
√w_èrgë
,

36402 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
, 
magic
)

36404 
JSVÆue
 
obj
, 
msg
, 
¥Ÿo
;

36405 
JSVÆueC⁄°
 
mesßge
;

36407 i‡(
	`JS_IsUndeföed
(
√w_èrgë
))

36408 
√w_èrgë
 = 
	`JS_GëA˘iveFun˘i⁄
(
˘x
);

36409 
¥Ÿo
 = 
	`JS_GëPr›îty
(
˘x
, 
√w_èrgë
, 
JS_ATOM_¥ŸŸy≥
);

36410 i‡(
	`JS_IsEx˚±i⁄
(
¥Ÿo
))

36411  
¥Ÿo
;

36412 i‡(!
	`JS_IsObje˘
(
¥Ÿo
)) {

36413 
JSC⁄ãxt
 *
ªÆm
;

36414 
JSVÆueC⁄°
 
¥Ÿo1
;

36416 
	`JS_FªeVÆue
(
˘x
, 
¥Ÿo
);

36417 
ªÆm
 = 
	`JS_GëFun˘i⁄Rólm
(
˘x
, 
√w_èrgë
);

36418 i‡(!
ªÆm
)

36419  
JS_EXCEPTION
;

36420 i‡(
magic
 < 0) {

36421 
¥Ÿo1
 = 
ªÆm
->
˛ass_¥Ÿo
[
JS_CLASS_ERROR
];

36423 
¥Ÿo1
 = 
ªÆm
->
«tive_îr‹_¥Ÿo
[
magic
];

36425 
¥Ÿo
 = 
	`JS_DupVÆue
(
˘x
, 
¥Ÿo1
);

36427 
obj
 = 
	`JS_NewObje˘PrŸoCœss
(
˘x
, 
¥Ÿo
, 
JS_CLASS_ERROR
);

36428 
	`JS_FªeVÆue
(
˘x
, 
¥Ÿo
);

36429 i‡(
	`JS_IsEx˚±i⁄
(
obj
))

36430  
obj
;

36431 i‡(
magic
 =
JS_AGGREGATE_ERROR
) {

36432 
JSObje˘
 *
p
;

36433 
JSVÆue
 
îr‹_li°
 = 
	`ôî©‹_to_¨øy
(
˘x
, 
¨gv
[0]);

36434 i‡(
	`JS_IsEx˚±i⁄
(
îr‹_li°
))

36435 
ex˚±i⁄
;

36436 
p
 = 
	`JS_VALUE_GET_OBJ
(
obj
);

36437 
p
->
u
.
obje˘_d©a
 = 
îr‹_li°
;

36438 
mesßge
 = 
¨gv
[1];

36440 
mesßge
 = 
¨gv
[0];

36443 i‡(!
	`JS_IsUndeföed
(
mesßge
)) {

36444 
msg
 = 
	`JS_ToSåög
(
˘x
, 
mesßge
);

36445 i‡(
	`u∆ikñy
(
	`JS_IsEx˚±i⁄
(
msg
))) {

36446 
ex˚±i⁄
:

36447 
	`JS_FªeVÆue
(
˘x
, 
obj
);

36448  
JS_EXCEPTION
;

36450 
	`JS_DeföePr›îtyVÆue
(
˘x
, 
obj
, 
JS_ATOM_mesßge
, 
msg
,

36451 
JS_PROP_WRITABLE
 | 
JS_PROP_CONFIGURABLE
);

36454 
	`buûd_backåa˚
(
˘x
, 
obj
, 
NULL
, 0, 
JS_BACKTRACE_FLAG_SKIP_FIRST_LEVEL
);

36455  
obj
;

36456 
	}
}

36458 
JSVÆue
 
	$js_îr‹_toSåög
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

36459 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

36461 
JSVÆue
 
«me
, 
msg
;

36463 i‡(!
	`JS_IsObje˘
(
this_vÆ
))

36464  
	`JS_ThrowTy≥Eº‹NŸAnObje˘
(
˘x
);

36465 
«me
 = 
	`JS_GëPr›îty
(
˘x
, 
this_vÆ
, 
JS_ATOM_«me
);

36466 i‡(
	`JS_IsUndeföed
(
«me
))

36467 
«me
 = 
	`JS_AtomToSåög
(
˘x
, 
JS_ATOM_Eº‹
);

36469 
«me
 = 
	`JS_ToSåögFªe
(
˘x
,Çame);

36470 i‡(
	`JS_IsEx˚±i⁄
(
«me
))

36471  
JS_EXCEPTION
;

36473 
msg
 = 
	`JS_GëPr›îty
(
˘x
, 
this_vÆ
, 
JS_ATOM_mesßge
);

36474 i‡(
	`JS_IsUndeföed
(
msg
))

36475 
msg
 = 
	`JS_AtomToSåög
(
˘x
, 
JS_ATOM_em±y_°rög
);

36477 
msg
 = 
	`JS_ToSåögFªe
(
˘x
, msg);

36478 i‡(
	`JS_IsEx˚±i⁄
(
msg
)) {

36479 
	`JS_FªeVÆue
(
˘x
, 
«me
);

36480  
JS_EXCEPTION
;

36482 i‡(!
	`JS_IsEm±ySåög
(
«me
Ë&& !JS_IsEm±ySåög(
msg
))

36483 
«me
 = 
	`JS_C⁄ˇtSåög3
(
˘x
, "",Çame, ": ");

36484  
	`JS_C⁄ˇtSåög
(
˘x
, 
«me
, 
msg
);

36485 
	}
}

36487 c⁄° 
JSCFun˘i⁄Li°E¡ry
 
	gjs_îr‹_¥Ÿo_funcs
[] = {

36488 
JS_CFUNC_DEF
("toSåög", 0, 
js_îr‹_toSåög
 ),

36489 
JS_PROP_STRING_DEF
("«me", "Eº‹", 
JS_PROP_WRITABLE
 | 
JS_PROP_CONFIGURABLE
 ),

36490 
JS_PROP_STRING_DEF
("mesßge", "", 
JS_PROP_WRITABLE
 | 
JS_PROP_CONFIGURABLE
 ),

36496 
JSVÆue
 
	$js_aggªg©e_îr‹_c⁄°ru˘‹
(
JSC⁄ãxt
 *
˘x
,

36497 
JSVÆueC⁄°
 
îr‹s
)

36499 
JSVÆue
 
obj
;

36500 
JSObje˘
 *
p
;

36502 
obj
 = 
	`JS_NewObje˘PrŸoCœss
(
˘x
,

36503 
˘x
->
«tive_îr‹_¥Ÿo
[
JS_AGGREGATE_ERROR
],

36504 
JS_CLASS_ERROR
);

36505 i‡(
	`JS_IsEx˚±i⁄
(
obj
))

36506  
obj
;

36507 
p
 = 
	`JS_VALUE_GET_OBJ
(
obj
);

36508 
p
->
u
.
obje˘_d©a
 = 
	`JS_DupVÆue
(
˘x
, 
îr‹s
);

36509  
obj
;

36510 
	}
}

36512 
JSVÆue
 
	$js_aggªg©e_îr‹_îr‹s
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
)

36514 
JSObje˘
 *
p
;

36515 
JSVÆue
 
r
, *
¨r
;

36516 
uöt32_t
 
Àn
, 
i
;

36518 i‡(
	`JS_VALUE_GET_TAG
(
this_vÆ
Ë!
JS_TAG_OBJECT
)

36519 
övÆid_ty≥
;

36520 
p
 = 
	`JS_VALUE_GET_OBJ
(
this_vÆ
);

36521 i‡(
p
->
˛ass_id
 !
JS_CLASS_ERROR
)

36522 
övÆid_ty≥
;

36523 i‡(!
	`js_gë_Á°_¨øy
(
˘x
, 
p
->
u
.
obje˘_d©a
, &
¨r
, &
Àn
)) {

36524 
övÆid_ty≥
:

36525  
	`JS_ThrowTy≥Eº‹
(
˘x
, "notán AggregateError");

36527 
r
 = 
	`JS_NewAºay
(
˘x
);

36528 i‡(
	`JS_IsEx˚±i⁄
(
r
))

36529 
ex˚±i⁄
;

36530 
i
 = 0; i < 
Àn
; i++) {

36531 i‡(
	`JS_DeföePr›îtyVÆueI¡64
(
˘x
, 
r
, 
i
, 
	`JS_DupVÆue
(˘x, 
¨r
[i]),

36532 
JS_PROP_C_W_E
 | 
JS_PROP_THROW
) < 0)

36533 
ex˚±i⁄
;

36535  
r
;

36536 
ex˚±i⁄
:

36537 
	`JS_FªeVÆue
(
˘x
, 
r
);

36538  
JS_EXCEPTION
;

36539 
	}
}

36541 c⁄° 
JSCFun˘i⁄Li°E¡ry
 
	gjs_aggªg©e_îr‹_¥Ÿo_funcs
[] = {

36542 
JS_CGETSET_DEF
("îr‹s", 
js_aggªg©e_îr‹_îr‹s
, 
NULL
),

36547 
	$JS_C›ySubAºay
(
JSC⁄ãxt
 *
˘x
,

36548 
JSVÆueC⁄°
 
obj
, 
öt64_t
 
to_pos
,

36549 
söt64_t
 
‰om_pos
, 
öt64_t
 
cou¡
, 
dú
)

36551 
söt64_t
 
i
, 
‰om
, 
to
;

36552 
JSVÆue
 
vÆ
;

36553 
‰omPª£¡
;

36556 
i
 = 0; i < 
cou¡
; i++) {

36557 i‡(
dú
 < 0) {

36558 
‰om
 = 
‰om_pos
 + 
cou¡
 - 
i
 - 1;

36559 
to
 = 
to_pos
 + 
cou¡
 - 
i
 - 1;

36561 
‰om
 = 
‰om_pos
 + 
i
;

36562 
to
 = 
to_pos
 + 
i
;

36564 
‰omPª£¡
 = 
	`JS_TryGëPr›îtyI¡64
(
˘x
, 
obj
, 
‰om
, &
vÆ
);

36565 i‡(
‰omPª£¡
 < 0)

36566 
ex˚±i⁄
;

36568 i‡(
‰omPª£¡
) {

36569 i‡(
	`JS_SëPr›îtyI¡64
(
˘x
, 
obj
, 
to
, 
vÆ
) < 0)

36570 
ex˚±i⁄
;

36572 i‡(
	`JS_DñëePr›îtyI¡64
(
˘x
, 
obj
, 
to
, 
JS_PROP_THROW
) < 0)

36573 
ex˚±i⁄
;

36578 
ex˚±i⁄
:

36580 
	}
}

36582 
JSVÆue
 
	$js_¨øy_c⁄°ru˘‹
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
√w_èrgë
,

36583 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

36585 
JSVÆue
 
obj
;

36586 
i
;

36588 
obj
 = 
	`js_¸óã_‰om_˘‹
(
˘x
, 
√w_èrgë
, 
JS_CLASS_ARRAY
);

36589 i‡(
	`JS_IsEx˚±i⁄
(
obj
))

36590  
obj
;

36591 i‡(
¨gc
 =1 && 
	`JS_IsNumbî
(
¨gv
[0])) {

36592 
uöt32_t
 
Àn
;

36593 i‡(
	`JS_ToAºayLígthFªe
(
˘x
, &
Àn
, 
	`JS_DupVÆue
(˘x, 
¨gv
[0])))

36594 
Áû
;

36595 i‡(
	`JS_SëPr›îty
(
˘x
, 
obj
, 
JS_ATOM_Àngth
, 
	`JS_NewUöt32
(˘x, 
Àn
)) < 0)

36596 
Áû
;

36598 
i
 = 0; i < 
¨gc
; i++) {

36599 i‡(
	`JS_SëPr›îtyUöt32
(
˘x
, 
obj
, 
i
, 
	`JS_DupVÆue
(˘x, 
¨gv
[i])) < 0)

36600 
Áû
;

36603  
obj
;

36604 
Áû
:

36605 
	`JS_FªeVÆue
(
˘x
, 
obj
);

36606  
JS_EXCEPTION
;

36607 
	}
}

36609 
JSVÆue
 
	$js_¨øy_‰om
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

36610 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

36613 
JSVÆueC⁄°
 
ôems
 = 
¨gv
[0], 
m≠‚
, 
this_¨g
;

36614 
JSVÆueC⁄°
 
¨gs
[2];

36615 
JSVÆue
 
°ack
[2];

36616 
JSVÆue
 
ôî
, 
r
, 
v
, 
v2
, 
¨øyLike
;

36617 
söt64_t
 
k
, 
Àn
;

36618 
d⁄e
, 
m≠pög
;

36620 
m≠pög
 = 
FALSE
;

36621 
m≠‚
 = 
JS_UNDEFINED
;

36622 
this_¨g
 = 
JS_UNDEFINED
;

36623 
r
 = 
JS_UNDEFINED
;

36624 
¨øyLike
 = 
JS_UNDEFINED
;

36625 
°ack
[0] = 
JS_UNDEFINED
;

36626 
°ack
[1] = 
JS_UNDEFINED
;

36628 i‡(
¨gc
 > 1) {

36629 
m≠‚
 = 
¨gv
[1];

36630 i‡(!
	`JS_IsUndeföed
(
m≠‚
)) {

36631 i‡(
	`check_fun˘i⁄
(
˘x
, 
m≠‚
))

36632 
ex˚±i⁄
;

36633 
m≠pög
 = 1;

36634 i‡(
¨gc
 > 2)

36635 
this_¨g
 = 
¨gv
[2];

36638 
ôî
 = 
	`JS_GëPr›îty
(
˘x
, 
ôems
, 
JS_ATOM_Symbﬁ_ôî©‹
);

36639 i‡(
	`JS_IsEx˚±i⁄
(
ôî
))

36640 
ex˚±i⁄
;

36641 i‡(!
	`JS_IsUndeföed
(
ôî
)) {

36642 
	`JS_FªeVÆue
(
˘x
, 
ôî
);

36643 i‡(
	`JS_IsC⁄°ru˘‹
(
˘x
, 
this_vÆ
))

36644 
r
 = 
	`JS_CÆlC⁄°ru˘‹
(
˘x
, 
this_vÆ
, 0, 
NULL
);

36646 
r
 = 
	`JS_NewAºay
(
˘x
);

36647 i‡(
	`JS_IsEx˚±i⁄
(
r
))

36648 
ex˚±i⁄
;

36649 
°ack
[0] = 
	`JS_DupVÆue
(
˘x
, 
ôems
);

36650 i‡(
	`js_f‹_of_°¨t
(
˘x
, &
°ack
[1], 
FALSE
))

36651 
ex˚±i⁄
;

36652 
k
 = 0;; k++) {

36653 
v
 = 
	`JS_Iãøt‹Next
(
˘x
, 
°ack
[0], sèck[1], 0, 
NULL
, &
d⁄e
);

36654 i‡(
	`JS_IsEx˚±i⁄
(
v
))

36655 
ex˚±i⁄_˛o£
;

36656 i‡(
d⁄e
)

36658 i‡(
m≠pög
) {

36659 
¨gs
[0] = 
v
;

36660 
¨gs
[1] = 
	`JS_NewI¡32
(
˘x
, 
k
);

36661 
v2
 = 
	`JS_CÆl
(
˘x
, 
m≠‚
, 
this_¨g
, 2, 
¨gs
);

36662 
	`JS_FªeVÆue
(
˘x
, 
v
);

36663 
v
 = 
v2
;

36664 i‡(
	`JS_IsEx˚±i⁄
(
v
))

36665 
ex˚±i⁄_˛o£
;

36667 i‡(
	`JS_DeföePr›îtyVÆueI¡64
(
˘x
, 
r
, 
k
, 
v
,

36668 
JS_PROP_C_W_E
 | 
JS_PROP_THROW
) < 0)

36669 
ex˚±i⁄_˛o£
;

36672 
¨øyLike
 = 
	`JS_ToObje˘
(
˘x
, 
ôems
);

36673 i‡(
	`JS_IsEx˚±i⁄
(
¨øyLike
))

36674 
ex˚±i⁄
;

36675 i‡(
	`js_gë_Àngth64
(
˘x
, &
Àn
, 
¨øyLike
) < 0)

36676 
ex˚±i⁄
;

36677 
v
 = 
	`JS_NewI¡64
(
˘x
, 
Àn
);

36678 
¨gs
[0] = 
v
;

36679 i‡(
	`JS_IsC⁄°ru˘‹
(
˘x
, 
this_vÆ
)) {

36680 
r
 = 
	`JS_CÆlC⁄°ru˘‹
(
˘x
, 
this_vÆ
, 1, 
¨gs
);

36682 
r
 = 
	`js_¨øy_c⁄°ru˘‹
(
˘x
, 
JS_UNDEFINED
, 1, 
¨gs
);

36684 
	`JS_FªeVÆue
(
˘x
, 
v
);

36685 i‡(
	`JS_IsEx˚±i⁄
(
r
))

36686 
ex˚±i⁄
;

36687 
k
 = 0; k < 
Àn
; k++) {

36688 
v
 = 
	`JS_GëPr›îtyI¡64
(
˘x
, 
¨øyLike
, 
k
);

36689 i‡(
	`JS_IsEx˚±i⁄
(
v
))

36690 
ex˚±i⁄
;

36691 i‡(
m≠pög
) {

36692 
¨gs
[0] = 
v
;

36693 
¨gs
[1] = 
	`JS_NewI¡32
(
˘x
, 
k
);

36694 
v2
 = 
	`JS_CÆl
(
˘x
, 
m≠‚
, 
this_¨g
, 2, 
¨gs
);

36695 
	`JS_FªeVÆue
(
˘x
, 
v
);

36696 
v
 = 
v2
;

36697 i‡(
	`JS_IsEx˚±i⁄
(
v
))

36698 
ex˚±i⁄
;

36700 i‡(
	`JS_DeföePr›îtyVÆueI¡64
(
˘x
, 
r
, 
k
, 
v
,

36701 
JS_PROP_C_W_E
 | 
JS_PROP_THROW
) < 0)

36702 
ex˚±i⁄
;

36705 i‡(
	`JS_SëPr›îty
(
˘x
, 
r
, 
JS_ATOM_Àngth
, 
	`JS_NewUöt32
(˘x, 
k
)) < 0)

36706 
ex˚±i⁄
;

36707 
d⁄e
;

36709 
ex˚±i⁄_˛o£
:

36710 i‡(!
	`JS_IsUndeföed
(
°ack
[0]))

36711 
	`JS_Iãøt‹Clo£
(
˘x
, 
°ack
[0], 
TRUE
);

36712 
ex˚±i⁄
:

36713 
	`JS_FªeVÆue
(
˘x
, 
r
);

36714 
r
 = 
JS_EXCEPTION
;

36715 
d⁄e
:

36716 
	`JS_FªeVÆue
(
˘x
, 
¨øyLike
);

36717 
	`JS_FªeVÆue
(
˘x
, 
°ack
[0]);

36718 
	`JS_FªeVÆue
(
˘x
, 
°ack
[1]);

36719  
r
;

36720 
	}
}

36722 
JSVÆue
 
	$js_¨øy_of
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

36723 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

36725 
JSVÆue
 
obj
, 
¨gs
[1];

36726 
i
;

36728 i‡(
	`JS_IsC⁄°ru˘‹
(
˘x
, 
this_vÆ
)) {

36729 
¨gs
[0] = 
	`JS_NewI¡32
(
˘x
, 
¨gc
);

36730 
obj
 = 
	`JS_CÆlC⁄°ru˘‹
(
˘x
, 
this_vÆ
, 1, (
JSVÆueC⁄°
 *)
¨gs
);

36732 
obj
 = 
	`JS_NewAºay
(
˘x
);

36734 i‡(
	`JS_IsEx˚±i⁄
(
obj
))

36735  
JS_EXCEPTION
;

36736 
i
 = 0; i < 
¨gc
; i++) {

36737 i‡(
	`JS_Cª©eD©aPr›îtyUöt32
(
˘x
, 
obj
, 
i
, 
	`JS_DupVÆue
(˘x, 
¨gv
[i]),

36738 
JS_PROP_THROW
) < 0) {

36739 
Áû
;

36742 i‡(
	`JS_SëPr›îty
(
˘x
, 
obj
, 
JS_ATOM_Àngth
, 
	`JS_NewUöt32
(˘x, 
¨gc
)) < 0) {

36743 
Áû
:

36744 
	`JS_FªeVÆue
(
˘x
, 
obj
);

36745  
JS_EXCEPTION
;

36747  
obj
;

36748 
	}
}

36750 
JSVÆue
 
	$js_¨øy_isAºay
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

36751 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

36753 
ªt
;

36754 
ªt
 = 
	`JS_IsAºay
(
˘x
, 
¨gv
[0]);

36755 i‡(
ªt
 < 0)

36756  
JS_EXCEPTION
;

36758  
	`JS_NewBoﬁ
(
˘x
, 
ªt
);

36759 
	}
}

36761 
JSVÆue
 
	$js_gë_this
(
JSC⁄ãxt
 *
˘x
,

36762 
JSVÆueC⁄°
 
this_vÆ
)

36764  
	`JS_DupVÆue
(
˘x
, 
this_vÆ
);

36765 
	}
}

36767 
JSVÆue
 
	$JS_AºayS≥cõsCª©e
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
obj
,

36768 
JSVÆueC⁄°
 
Àn_vÆ
)

36770 
JSVÆue
 
˘‹
, 
ªt
, 
•ecõs
;

36771 
ªs
;

36772 
JSC⁄ãxt
 *
ªÆm
;

36774 
ªs
 = 
	`JS_IsAºay
(
˘x
, 
obj
);

36775 i‡(
ªs
 < 0)

36776  
JS_EXCEPTION
;

36777 i‡(!
ªs
)

36778  
	`js_¨øy_c⁄°ru˘‹
(
˘x
, 
JS_UNDEFINED
, 1, &
Àn_vÆ
);

36779 
˘‹
 = 
	`JS_GëPr›îty
(
˘x
, 
obj
, 
JS_ATOM_c⁄°ru˘‹
);

36780 i‡(
	`JS_IsEx˚±i⁄
(
˘‹
))

36781  
˘‹
;

36782 i‡(
	`JS_IsC⁄°ru˘‹
(
˘x
, 
˘‹
)) {

36784 
ªÆm
 = 
	`JS_GëFun˘i⁄Rólm
(
˘x
, 
˘‹
);

36785 i‡(!
ªÆm
) {

36786 
	`JS_FªeVÆue
(
˘x
, 
˘‹
);

36787  
JS_EXCEPTION
;

36789 i‡(
ªÆm
 !
˘x
 &&

36790 
	`js_ßme_vÆue
(
˘x
, 
˘‹
, 
ªÆm
->
¨øy_˘‹
)) {

36791 
	`JS_FªeVÆue
(
˘x
, 
˘‹
);

36792 
˘‹
 = 
JS_UNDEFINED
;

36795 i‡(
	`JS_IsObje˘
(
˘‹
)) {

36796 
•ecõs
 = 
	`JS_GëPr›îty
(
˘x
, 
˘‹
, 
JS_ATOM_Symbﬁ_•ecõs
);

36797 
	`JS_FªeVÆue
(
˘x
, 
˘‹
);

36798 i‡(
	`JS_IsEx˚±i⁄
(
•ecõs
))

36799  
•ecõs
;

36800 
˘‹
 = 
•ecõs
;

36801 i‡(
	`JS_IsNuŒ
(
˘‹
))

36802 
˘‹
 = 
JS_UNDEFINED
;

36804 i‡(
	`JS_IsUndeföed
(
˘‹
)) {

36805  
	`js_¨øy_c⁄°ru˘‹
(
˘x
, 
JS_UNDEFINED
, 1, &
Àn_vÆ
);

36807 
ªt
 = 
	`JS_CÆlC⁄°ru˘‹
(
˘x
, 
˘‹
, 1, &
Àn_vÆ
);

36808 
	`JS_FªeVÆue
(
˘x
, 
˘‹
);

36809  
ªt
;

36811 
	}
}

36813 c⁄° 
JSCFun˘i⁄Li°E¡ry
 
	gjs_¨øy_funcs
[] = {

36814 
JS_CFUNC_DEF
("isAºay", 1, 
js_¨øy_isAºay
 ),

36815 
JS_CFUNC_DEF
("‰om", 1, 
js_¨øy_‰om
 ),

36816 
JS_CFUNC_DEF
("of", 0, 
js_¨øy_of
 ),

36817 
JS_CGETSET_DEF
("[Symbﬁ.•ecõs]", 
js_gë_this
, 
NULL
 ),

36820 
	$JS_isC⁄ˇtS¥ódabÀ
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
obj
)

36822 
JSVÆue
 
vÆ
;

36824 i‡(!
	`JS_IsObje˘
(
obj
))

36825  
FALSE
;

36826 
vÆ
 = 
	`JS_GëPr›îty
(
˘x
, 
obj
, 
JS_ATOM_Symbﬁ_isC⁄ˇtS¥ódabÀ
);

36827 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

36829 i‡(!
	`JS_IsUndeföed
(
vÆ
))

36830  
	`JS_ToBoﬁFªe
(
˘x
, 
vÆ
);

36831  
	`JS_IsAºay
(
˘x
, 
obj
);

36832 
	}
}

36834 
JSVÆue
 
	$js_¨øy_c⁄ˇt
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

36835 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

36837 
JSVÆue
 
obj
, 
¨r
, 
vÆ
;

36838 
JSVÆueC⁄°
 
e
;

36839 
söt64_t
 
Àn
, 
k
, 
n
;

36840 
i
, 
ªs
;

36842 
¨r
 = 
JS_UNDEFINED
;

36843 
obj
 = 
	`JS_ToObje˘
(
˘x
, 
this_vÆ
);

36844 i‡(
	`JS_IsEx˚±i⁄
(
obj
))

36845 
ex˚±i⁄
;

36847 
¨r
 = 
	`JS_AºayS≥cõsCª©e
(
˘x
, 
obj
, 
	`JS_NewI¡32
(ctx, 0));

36848 i‡(
	`JS_IsEx˚±i⁄
(
¨r
))

36849 
ex˚±i⁄
;

36850 
n
 = 0;

36851 
i
 = -1; i < 
¨gc
; i++) {

36852 i‡(
i
 < 0)

36853 
e
 = 
obj
;

36855 
e
 = 
¨gv
[
i
];

36857 
ªs
 = 
	`JS_isC⁄ˇtS¥ódabÀ
(
˘x
, 
e
);

36858 i‡(
ªs
 < 0)

36859 
ex˚±i⁄
;

36860 i‡(
ªs
) {

36861 i‡(
	`js_gë_Àngth64
(
˘x
, &
Àn
, 
e
))

36862 
ex˚±i⁄
;

36863 i‡(
n
 + 
Àn
 > 
MAX_SAFE_INTEGER
) {

36864 
	`JS_ThrowTy≥Eº‹
(
˘x
, "ArrayÜooÜong");

36865 
ex˚±i⁄
;

36867 
k
 = 0; k < 
Àn
; k++, 
n
++) {

36868 
ªs
 = 
	`JS_TryGëPr›îtyI¡64
(
˘x
, 
e
, 
k
, &
vÆ
);

36869 i‡(
ªs
 < 0)

36870 
ex˚±i⁄
;

36871 i‡(
ªs
) {

36872 i‡(
	`JS_DeföePr›îtyVÆueI¡64
(
˘x
, 
¨r
, 
n
, 
vÆ
,

36873 
JS_PROP_C_W_E
 | 
JS_PROP_THROW
) < 0)

36874 
ex˚±i⁄
;

36878 i‡(
n
 >
MAX_SAFE_INTEGER
) {

36879 
	`JS_ThrowTy≥Eº‹
(
˘x
, "ArrayÜooÜong");

36880 
ex˚±i⁄
;

36882 i‡(
	`JS_DeföePr›îtyVÆueI¡64
(
˘x
, 
¨r
, 
n
, 
	`JS_DupVÆue
(˘x, 
e
),

36883 
JS_PROP_C_W_E
 | 
JS_PROP_THROW
) < 0)

36884 
ex˚±i⁄
;

36885 
n
++;

36888 i‡(
	`JS_SëPr›îty
(
˘x
, 
¨r
, 
JS_ATOM_Àngth
, 
	`JS_NewI¡64
(˘x, 
n
)) < 0)

36889 
ex˚±i⁄
;

36891 
	`JS_FªeVÆue
(
˘x
, 
obj
);

36892  
¨r
;

36894 
ex˚±i⁄
:

36895 
	`JS_FªeVÆue
(
˘x
, 
¨r
);

36896 
	`JS_FªeVÆue
(
˘x
, 
obj
);

36897  
JS_EXCEPTION
;

36898 
	}
}

36900 
	#•ecül_evîy
 0

	)

36901 
	#•ecül_some
 1

	)

36902 
	#•ecül_f‹Each
 2

	)

36903 
	#•ecül_m≠
 3

	)

36904 
	#•ecül_fûãr
 4

	)

36905 
	#•ecül_TA
 8

	)

36907 
js_ty≥d_¨øy_gë_Àngth_öã∫Æ
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
obj
);

36909 
JSVÆue
 
js_ty≥d_¨øy___•ecõsCª©e
(
JSC⁄ãxt
 *
˘x
,

36910 
JSVÆueC⁄°
 
this_vÆ
,

36911 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
);

36913 
JSVÆue
 
	$js_¨øy_evîy
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

36914 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
, 
•ecül
)

36916 
JSVÆue
 
obj
, 
vÆ
, 
ödex_vÆ
, 
ªs
, 
ªt
;

36917 
JSVÆueC⁄°
 
¨gs
[3];

36918 
JSVÆueC⁄°
 
func
, 
this_¨g
;

36919 
söt64_t
 
Àn
, 
k
, 
n
;

36920 
¥e£¡
;

36922 
ªt
 = 
JS_UNDEFINED
;

36923 
vÆ
 = 
JS_UNDEFINED
;

36924 i‡(
•ecül
 & 
•ecül_TA
) {

36925 
obj
 = 
	`JS_DupVÆue
(
˘x
, 
this_vÆ
);

36926 
Àn
 = 
	`js_ty≥d_¨øy_gë_Àngth_öã∫Æ
(
˘x
, 
obj
);

36927 i‡(
Àn
 < 0)

36928 
ex˚±i⁄
;

36930 
obj
 = 
	`JS_ToObje˘
(
˘x
, 
this_vÆ
);

36931 i‡(
	`js_gë_Àngth64
(
˘x
, &
Àn
, 
obj
))

36932 
ex˚±i⁄
;

36934 
func
 = 
¨gv
[0];

36935 
this_¨g
 = 
JS_UNDEFINED
;

36936 i‡(
¨gc
 > 1)

36937 
this_¨g
 = 
¨gv
[1];

36939 i‡(
	`check_fun˘i⁄
(
˘x
, 
func
))

36940 
ex˚±i⁄
;

36942 
•ecül
) {

36943 
•ecül_evîy
:

36944 
•ecül_evîy
 | 
•ecül_TA
:

36945 
ªt
 = 
JS_TRUE
;

36947 
•ecül_some
:

36948 
•ecül_some
 | 
•ecül_TA
:

36949 
ªt
 = 
JS_FALSE
;

36951 
•ecül_m≠
:

36953 
ªt
 = 
	`JS_AºayS≥cõsCª©e
(
˘x
, 
obj
, 
	`JS_NewI¡64
(˘x, 
Àn
));

36954 i‡(
	`JS_IsEx˚±i⁄
(
ªt
))

36955 
ex˚±i⁄
;

36957 
•ecül_fûãr
:

36958 
ªt
 = 
	`JS_AºayS≥cõsCª©e
(
˘x
, 
obj
, 
	`JS_NewI¡32
(ctx, 0));

36959 i‡(
	`JS_IsEx˚±i⁄
(
ªt
))

36960 
ex˚±i⁄
;

36962 
•ecül_m≠
 | 
•ecül_TA
:

36963 
¨gs
[0] = 
obj
;

36964 
¨gs
[1] = 
	`JS_NewI¡32
(
˘x
, 
Àn
);

36965 
ªt
 = 
	`js_ty≥d_¨øy___•ecõsCª©e
(
˘x
, 
JS_UNDEFINED
, 2, 
¨gs
);

36966 i‡(
	`JS_IsEx˚±i⁄
(
ªt
))

36967 
ex˚±i⁄
;

36969 
•ecül_fûãr
 | 
•ecül_TA
:

36970 
ªt
 = 
	`JS_NewAºay
(
˘x
);

36971 i‡(
	`JS_IsEx˚±i⁄
(
ªt
))

36972 
ex˚±i⁄
;

36975 
n
 = 0;

36977 
k
 = 0; k < 
Àn
; k++) {

36978 
¥e£¡
 = 
	`JS_TryGëPr›îtyI¡64
(
˘x
, 
obj
, 
k
, &
vÆ
);

36979 i‡(
¥e£¡
 < 0)

36980 
ex˚±i⁄
;

36981 i‡(
¥e£¡
) {

36982 
ödex_vÆ
 = 
	`JS_NewI¡64
(
˘x
, 
k
);

36983 i‡(
	`JS_IsEx˚±i⁄
(
ödex_vÆ
))

36984 
ex˚±i⁄
;

36985 
¨gs
[0] = 
vÆ
;

36986 
¨gs
[1] = 
ödex_vÆ
;

36987 
¨gs
[2] = 
obj
;

36988 
ªs
 = 
	`JS_CÆl
(
˘x
, 
func
, 
this_¨g
, 3, 
¨gs
);

36989 
	`JS_FªeVÆue
(
˘x
, 
ödex_vÆ
);

36990 i‡(
	`JS_IsEx˚±i⁄
(
ªs
))

36991 
ex˚±i⁄
;

36992 
•ecül
) {

36993 
•ecül_evîy
:

36994 
•ecül_evîy
 | 
•ecül_TA
:

36995 i‡(!
	`JS_ToBoﬁFªe
(
˘x
, 
ªs
)) {

36996 
ªt
 = 
JS_FALSE
;

36997 
d⁄e
;

37000 
•ecül_some
:

37001 
•ecül_some
 | 
•ecül_TA
:

37002 i‡(
	`JS_ToBoﬁFªe
(
˘x
, 
ªs
)) {

37003 
ªt
 = 
JS_TRUE
;

37004 
d⁄e
;

37007 
•ecül_m≠
:

37008 i‡(
	`JS_DeföePr›îtyVÆueI¡64
(
˘x
, 
ªt
, 
k
, 
ªs
,

37009 
JS_PROP_C_W_E
 | 
JS_PROP_THROW
) < 0)

37010 
ex˚±i⁄
;

37012 
•ecül_m≠
 | 
•ecül_TA
:

37013 i‡(
	`JS_SëPr›îtyVÆue
(
˘x
, 
ªt
, 
	`JS_NewI¡32
(˘x, 
k
), 
ªs
, 
JS_PROP_THROW
) < 0)

37014 
ex˚±i⁄
;

37016 
•ecül_fûãr
:

37017 
•ecül_fûãr
 | 
•ecül_TA
:

37018 i‡(
	`JS_ToBoﬁFªe
(
˘x
, 
ªs
)) {

37019 i‡(
	`JS_DeföePr›îtyVÆueI¡64
(
˘x
, 
ªt
, 
n
++, 
	`JS_DupVÆue
(˘x, 
vÆ
),

37020 
JS_PROP_C_W_E
 | 
JS_PROP_THROW
) < 0)

37021 
ex˚±i⁄
;

37025 
	`JS_FªeVÆue
(
˘x
, 
ªs
);

37028 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

37029 
vÆ
 = 
JS_UNDEFINED
;

37032 
d⁄e
:

37033 i‡(
•ecül
 =(
•ecül_fûãr
 | 
•ecül_TA
)) {

37034 
JSVÆue
 
¨r
;

37035 
¨gs
[0] = 
obj
;

37036 
¨gs
[1] = 
	`JS_NewI¡32
(
˘x
, 
n
);

37037 
¨r
 = 
	`js_ty≥d_¨øy___•ecõsCª©e
(
˘x
, 
JS_UNDEFINED
, 2, 
¨gs
);

37038 i‡(
	`JS_IsEx˚±i⁄
(
¨r
))

37039 
ex˚±i⁄
;

37040 
¨gs
[0] = 
ªt
;

37041 
ªs
 = 
	`JS_Invoke
(
˘x
, 
¨r
, 
JS_ATOM_£t
, 1, 
¨gs
);

37042 i‡(
	`check_ex˚±i⁄_‰ì
(
˘x
, 
ªs
))

37043 
ex˚±i⁄
;

37044 
	`JS_FªeVÆue
(
˘x
, 
ªt
);

37045 
ªt
 = 
¨r
;

37047 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

37048 
	`JS_FªeVÆue
(
˘x
, 
obj
);

37049  
ªt
;

37051 
ex˚±i⁄
:

37052 
	`JS_FªeVÆue
(
˘x
, 
ªt
);

37053 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

37054 
	`JS_FªeVÆue
(
˘x
, 
obj
);

37055  
JS_EXCEPTION
;

37056 
	}
}

37058 
	#•ecül_ªdu˚
 0

	)

37059 
	#•ecül_ªdu˚Right
 1

	)

37061 
JSVÆue
 
	$js_¨øy_ªdu˚
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

37062 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
, 
•ecül
)

37064 
JSVÆue
 
obj
, 
vÆ
, 
ödex_vÆ
, 
acc
, 
acc1
;

37065 
JSVÆueC⁄°
 
¨gs
[4];

37066 
JSVÆueC⁄°
 
func
;

37067 
söt64_t
 
Àn
, 
k
, 
k1
;

37068 
¥e£¡
;

37070 
acc
 = 
JS_UNDEFINED
;

37071 
vÆ
 = 
JS_UNDEFINED
;

37072 i‡(
•ecül
 & 
•ecül_TA
) {

37073 
obj
 = 
	`JS_DupVÆue
(
˘x
, 
this_vÆ
);

37074 
Àn
 = 
	`js_ty≥d_¨øy_gë_Àngth_öã∫Æ
(
˘x
, 
obj
);

37075 i‡(
Àn
 < 0)

37076 
ex˚±i⁄
;

37078 
obj
 = 
	`JS_ToObje˘
(
˘x
, 
this_vÆ
);

37079 i‡(
	`js_gë_Àngth64
(
˘x
, &
Àn
, 
obj
))

37080 
ex˚±i⁄
;

37082 
func
 = 
¨gv
[0];

37084 i‡(
	`check_fun˘i⁄
(
˘x
, 
func
))

37085 
ex˚±i⁄
;

37087 
k
 = 0;

37088 i‡(
¨gc
 > 1) {

37089 
acc
 = 
	`JS_DupVÆue
(
˘x
, 
¨gv
[1]);

37092 i‡(
k
 >
Àn
) {

37093 
	`JS_ThrowTy≥Eº‹
(
˘x
, "emptyárray");

37094 
ex˚±i⁄
;

37096 
k1
 = (
•ecül
 & 
•ecül_ªdu˚Right
Ë? 
Àn
 - 
k
 - 1 : k;

37097 
k
++;

37098 
¥e£¡
 = 
	`JS_TryGëPr›îtyI¡64
(
˘x
, 
obj
, 
k1
, &
acc
);

37099 i‡(
¥e£¡
 < 0)

37100 
ex˚±i⁄
;

37101 i‡(
¥e£¡
)

37105 ; 
k
 < 
Àn
; k++) {

37106 
k1
 = (
•ecül
 & 
•ecül_ªdu˚Right
Ë? 
Àn
 - 
k
 - 1 : k;

37107 
¥e£¡
 = 
	`JS_TryGëPr›îtyI¡64
(
˘x
, 
obj
, 
k1
, &
vÆ
);

37108 i‡(
¥e£¡
 < 0)

37109 
ex˚±i⁄
;

37110 i‡(
¥e£¡
) {

37111 
ödex_vÆ
 = 
	`JS_NewI¡64
(
˘x
, 
k1
);

37112 i‡(
	`JS_IsEx˚±i⁄
(
ödex_vÆ
))

37113 
ex˚±i⁄
;

37114 
¨gs
[0] = 
acc
;

37115 
¨gs
[1] = 
vÆ
;

37116 
¨gs
[2] = 
ödex_vÆ
;

37117 
¨gs
[3] = 
obj
;

37118 
acc1
 = 
	`JS_CÆl
(
˘x
, 
func
, 
JS_UNDEFINED
, 4, 
¨gs
);

37119 
	`JS_FªeVÆue
(
˘x
, 
ödex_vÆ
);

37120 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

37121 
vÆ
 = 
JS_UNDEFINED
;

37122 i‡(
	`JS_IsEx˚±i⁄
(
acc1
))

37123 
ex˚±i⁄
;

37124 
	`JS_FªeVÆue
(
˘x
, 
acc
);

37125 
acc
 = 
acc1
;

37128 
	`JS_FªeVÆue
(
˘x
, 
obj
);

37129  
acc
;

37131 
ex˚±i⁄
:

37132 
	`JS_FªeVÆue
(
˘x
, 
acc
);

37133 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

37134 
	`JS_FªeVÆue
(
˘x
, 
obj
);

37135  
JS_EXCEPTION
;

37136 
	}
}

37138 
JSVÆue
 
	$js_¨øy_fûl
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

37139 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

37141 
JSVÆue
 
obj
;

37142 
söt64_t
 
Àn
, 
°¨t
, 
íd
;

37144 
obj
 = 
	`JS_ToObje˘
(
˘x
, 
this_vÆ
);

37145 i‡(
	`js_gë_Àngth64
(
˘x
, &
Àn
, 
obj
))

37146 
ex˚±i⁄
;

37148 
°¨t
 = 0;

37149 i‡(
¨gc
 > 1 && !
	`JS_IsUndeföed
(
¨gv
[1])) {

37150 i‡(
	`JS_ToI¡64Cœmp
(
˘x
, &
°¨t
, 
¨gv
[1], 0, 
Àn
,Üen))

37151 
ex˚±i⁄
;

37154 
íd
 = 
Àn
;

37155 i‡(
¨gc
 > 2 && !
	`JS_IsUndeföed
(
¨gv
[2])) {

37156 i‡(
	`JS_ToI¡64Cœmp
(
˘x
, &
íd
, 
¨gv
[2], 0, 
Àn
,Üen))

37157 
ex˚±i⁄
;

37161 
°¨t
 < 
íd
) {

37162 i‡(
	`JS_SëPr›îtyI¡64
(
˘x
, 
obj
, 
°¨t
,

37163 
	`JS_DupVÆue
(
˘x
, 
¨gv
[0])) < 0)

37164 
ex˚±i⁄
;

37165 
°¨t
++;

37167  
obj
;

37169 
ex˚±i⁄
:

37170 
	`JS_FªeVÆue
(
˘x
, 
obj
);

37171  
JS_EXCEPTION
;

37172 
	}
}

37174 
JSVÆue
 
	$js_¨øy_ö˛udes
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

37175 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

37177 
JSVÆue
 
obj
, 
vÆ
;

37178 
söt64_t
 
Àn
, 
n
, 
ªs
;

37179 
JSVÆue
 *
¨Ω
;

37180 
uöt32_t
 
cou¡
;

37182 
obj
 = 
	`JS_ToObje˘
(
˘x
, 
this_vÆ
);

37183 i‡(
	`js_gë_Àngth64
(
˘x
, &
Àn
, 
obj
))

37184 
ex˚±i⁄
;

37186 
ªs
 = 
FALSE
;

37187 i‡(
Àn
 > 0) {

37188 
n
 = 0;

37189 i‡(
¨gc
 > 1) {

37190 i‡(
	`JS_ToI¡64Cœmp
(
˘x
, &
n
, 
¨gv
[1], 0, 
Àn
,Üen))

37191 
ex˚±i⁄
;

37193 i‡(
	`js_gë_Á°_¨øy
(
˘x
, 
obj
, &
¨Ω
, &
cou¡
)) {

37194 ; 
n
 < 
cou¡
;Ç++) {

37195 i‡(
	`js_°ri˘_eq2
(
˘x
, 
	`JS_DupVÆue
(˘x, 
¨gv
[0]),

37196 
	`JS_DupVÆue
(
˘x
, 
¨Ω
[
n
]),

37197 
JS_EQ_SAME_VALUE_ZERO
)) {

37198 
ªs
 = 
TRUE
;

37199 
d⁄e
;

37203 ; 
n
 < 
Àn
;Ç++) {

37204 
vÆ
 = 
	`JS_GëPr›îtyI¡64
(
˘x
, 
obj
, 
n
);

37205 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

37206 
ex˚±i⁄
;

37207 i‡(
	`js_°ri˘_eq2
(
˘x
, 
	`JS_DupVÆue
(˘x, 
¨gv
[0]), 
vÆ
,

37208 
JS_EQ_SAME_VALUE_ZERO
)) {

37209 
ªs
 = 
TRUE
;

37214 
d⁄e
:

37215 
	`JS_FªeVÆue
(
˘x
, 
obj
);

37216  
	`JS_NewBoﬁ
(
˘x
, 
ªs
);

37218 
ex˚±i⁄
:

37219 
	`JS_FªeVÆue
(
˘x
, 
obj
);

37220  
JS_EXCEPTION
;

37221 
	}
}

37223 
JSVÆue
 
	$js_¨øy_ödexOf
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

37224 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

37226 
JSVÆue
 
obj
, 
vÆ
;

37227 
söt64_t
 
Àn
, 
n
, 
ªs
;

37228 
JSVÆue
 *
¨Ω
;

37229 
uöt32_t
 
cou¡
;

37231 
obj
 = 
	`JS_ToObje˘
(
˘x
, 
this_vÆ
);

37232 i‡(
	`js_gë_Àngth64
(
˘x
, &
Àn
, 
obj
))

37233 
ex˚±i⁄
;

37235 
ªs
 = -1;

37236 i‡(
Àn
 > 0) {

37237 
n
 = 0;

37238 i‡(
¨gc
 > 1) {

37239 i‡(
	`JS_ToI¡64Cœmp
(
˘x
, &
n
, 
¨gv
[1], 0, 
Àn
,Üen))

37240 
ex˚±i⁄
;

37242 i‡(
	`js_gë_Á°_¨øy
(
˘x
, 
obj
, &
¨Ω
, &
cou¡
)) {

37243 ; 
n
 < 
cou¡
;Ç++) {

37244 i‡(
	`js_°ri˘_eq2
(
˘x
, 
	`JS_DupVÆue
(˘x, 
¨gv
[0]),

37245 
	`JS_DupVÆue
(
˘x
, 
¨Ω
[
n
]), 
JS_EQ_STRICT
)) {

37246 
ªs
 = 
n
;

37247 
d⁄e
;

37251 ; 
n
 < 
Àn
;Ç++) {

37252 
¥e£¡
 = 
	`JS_TryGëPr›îtyI¡64
(
˘x
, 
obj
, 
n
, &
vÆ
);

37253 i‡(
¥e£¡
 < 0)

37254 
ex˚±i⁄
;

37255 i‡(
¥e£¡
) {

37256 i‡(
	`js_°ri˘_eq2
(
˘x
, 
	`JS_DupVÆue
(˘x, 
¨gv
[0]), 
vÆ
, 
JS_EQ_STRICT
)) {

37257 
ªs
 = 
n
;

37263 
d⁄e
:

37264 
	`JS_FªeVÆue
(
˘x
, 
obj
);

37265  
	`JS_NewI¡64
(
˘x
, 
ªs
);

37267 
ex˚±i⁄
:

37268 
	`JS_FªeVÆue
(
˘x
, 
obj
);

37269  
JS_EXCEPTION
;

37270 
	}
}

37272 
JSVÆue
 
	$js_¨øy_œ°IndexOf
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

37273 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

37275 
JSVÆue
 
obj
, 
vÆ
;

37276 
söt64_t
 
Àn
, 
n
, 
ªs
;

37277 
¥e£¡
;

37279 
obj
 = 
	`JS_ToObje˘
(
˘x
, 
this_vÆ
);

37280 i‡(
	`js_gë_Àngth64
(
˘x
, &
Àn
, 
obj
))

37281 
ex˚±i⁄
;

37283 
ªs
 = -1;

37284 i‡(
Àn
 > 0) {

37285 
n
 = 
Àn
 - 1;

37286 i‡(
¨gc
 > 1) {

37287 i‡(
	`JS_ToI¡64Cœmp
(
˘x
, &
n
, 
¨gv
[1], -1, 
Àn
 - 1,Üen))

37288 
ex˚±i⁄
;

37291 ; 
n
 >= 0;Ç--) {

37292 
¥e£¡
 = 
	`JS_TryGëPr›îtyI¡64
(
˘x
, 
obj
, 
n
, &
vÆ
);

37293 i‡(
¥e£¡
 < 0)

37294 
ex˚±i⁄
;

37295 i‡(
¥e£¡
) {

37296 i‡(
	`js_°ri˘_eq2
(
˘x
, 
	`JS_DupVÆue
(˘x, 
¨gv
[0]), 
vÆ
, 
JS_EQ_STRICT
)) {

37297 
ªs
 = 
n
;

37303 
	`JS_FªeVÆue
(
˘x
, 
obj
);

37304  
	`JS_NewI¡64
(
˘x
, 
ªs
);

37306 
ex˚±i⁄
:

37307 
	`JS_FªeVÆue
(
˘x
, 
obj
);

37308  
JS_EXCEPTION
;

37309 
	}
}

37311 
JSVÆue
 
	$js_¨øy_föd
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

37312 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
, 
födIndex
)

37314 
JSVÆueC⁄°
 
func
, 
this_¨g
;

37315 
JSVÆueC⁄°
 
¨gs
[3];

37316 
JSVÆue
 
obj
, 
vÆ
, 
ödex_vÆ
, 
ªs
;

37317 
söt64_t
 
Àn
, 
k
;

37319 
ödex_vÆ
 = 
JS_UNDEFINED
;

37320 
vÆ
 = 
JS_UNDEFINED
;

37321 
obj
 = 
	`JS_ToObje˘
(
˘x
, 
this_vÆ
);

37322 i‡(
	`js_gë_Àngth64
(
˘x
, &
Àn
, 
obj
))

37323 
ex˚±i⁄
;

37325 
func
 = 
¨gv
[0];

37326 i‡(
	`check_fun˘i⁄
(
˘x
, 
func
))

37327 
ex˚±i⁄
;

37329 
this_¨g
 = 
JS_UNDEFINED
;

37330 i‡(
¨gc
 > 1)

37331 
this_¨g
 = 
¨gv
[1];

37333 
k
 = 0; k < 
Àn
; k++) {

37334 
ödex_vÆ
 = 
	`JS_NewI¡64
(
˘x
, 
k
);

37335 i‡(
	`JS_IsEx˚±i⁄
(
ödex_vÆ
))

37336 
ex˚±i⁄
;

37337 
vÆ
 = 
	`JS_GëPr›îtyVÆue
(
˘x
, 
obj
, 
ödex_vÆ
);

37338 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

37339 
ex˚±i⁄
;

37340 
¨gs
[0] = 
vÆ
;

37341 
¨gs
[1] = 
ödex_vÆ
;

37342 
¨gs
[2] = 
this_vÆ
;

37343 
ªs
 = 
	`JS_CÆl
(
˘x
, 
func
, 
this_¨g
, 3, 
¨gs
);

37344 i‡(
	`JS_IsEx˚±i⁄
(
ªs
))

37345 
ex˚±i⁄
;

37346 i‡(
	`JS_ToBoﬁFªe
(
˘x
, 
ªs
)) {

37347 i‡(
födIndex
) {

37348 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

37349 
	`JS_FªeVÆue
(
˘x
, 
obj
);

37350  
ödex_vÆ
;

37352 
	`JS_FªeVÆue
(
˘x
, 
ödex_vÆ
);

37353 
	`JS_FªeVÆue
(
˘x
, 
obj
);

37354  
vÆ
;

37357 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

37358 
	`JS_FªeVÆue
(
˘x
, 
ödex_vÆ
);

37360 
	`JS_FªeVÆue
(
˘x
, 
obj
);

37361 i‡(
födIndex
)

37362  
	`JS_NewI¡32
(
˘x
, -1);

37364  
JS_UNDEFINED
;

37366 
ex˚±i⁄
:

37367 
	`JS_FªeVÆue
(
˘x
, 
ödex_vÆ
);

37368 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

37369 
	`JS_FªeVÆue
(
˘x
, 
obj
);

37370  
JS_EXCEPTION
;

37371 
	}
}

37373 
JSVÆue
 
	$js_¨øy_toSåög
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

37374 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

37376 
JSVÆue
 
obj
, 
mëhod
, 
ªt
;

37378 
obj
 = 
	`JS_ToObje˘
(
˘x
, 
this_vÆ
);

37379 i‡(
	`JS_IsEx˚±i⁄
(
obj
))

37380  
JS_EXCEPTION
;

37381 
mëhod
 = 
	`JS_GëPr›îty
(
˘x
, 
obj
, 
JS_ATOM_joö
);

37382 i‡(
	`JS_IsEx˚±i⁄
(
mëhod
)) {

37383 
ªt
 = 
JS_EXCEPTION
;

37385 i‡(!
	`JS_IsFun˘i⁄
(
˘x
, 
mëhod
)) {

37387 
	`JS_FªeVÆue
(
˘x
, 
mëhod
);

37388 
ªt
 = 
	`js_obje˘_toSåög
(
˘x
, 
obj
, 0, 
NULL
);

37390 
ªt
 = 
	`JS_CÆlFªe
(
˘x
, 
mëhod
, 
obj
, 0, 
NULL
);

37392 
	`JS_FªeVÆue
(
˘x
, 
obj
);

37393  
ªt
;

37394 
	}
}

37396 
JSVÆue
 
	$js_¨øy_joö
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

37397 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
, 
toLoˇÀSåög
)

37399 
JSVÆue
 
obj
, 
£p
 = 
JS_UNDEFINED
, 
ñ
;

37400 
SåögBuf„r
 
b_s
, *
b
 = &b_s;

37401 
JSSåög
 *
p
 = 
NULL
;

37402 
söt64_t
 
i
, 
n
;

37403 
c
;

37405 
obj
 = 
	`JS_ToObje˘
(
˘x
, 
this_vÆ
);

37406 i‡(
	`js_gë_Àngth64
(
˘x
, &
n
, 
obj
))

37407 
ex˚±i⁄
;

37409 
c
 = ',';

37410 i‡(!
toLoˇÀSåög
 && 
¨gc
 > 0 && !
	`JS_IsUndeföed
(
¨gv
[0])) {

37411 
£p
 = 
	`JS_ToSåög
(
˘x
, 
¨gv
[0]);

37412 i‡(
	`JS_IsEx˚±i⁄
(
£p
))

37413 
ex˚±i⁄
;

37414 
p
 = 
	`JS_VALUE_GET_STRING
(
£p
);

37415 i‡(
p
->
Àn
 =1 && !p->
is_wide_ch¨
)

37416 
c
 = 
p
->
u
.
°r8
[0];

37418 
c
 = -1;

37420 
	`°rög_buf„r_öô
(
˘x
, 
b
, 0);

37422 
i
 = 0; i < 
n
; i++) {

37423 i‡(
i
 > 0) {

37424 i‡(
c
 >= 0) {

37425 
	`°rög_buf„r_putc8
(
b
, 
c
);

37427 
	`°rög_buf„r_c⁄ˇt
(
b
, 
p
, 0,Ö->
Àn
);

37430 
ñ
 = 
	`JS_GëPr›îtyUöt32
(
˘x
, 
obj
, 
i
);

37431 i‡(
	`JS_IsEx˚±i⁄
(
ñ
))

37432 
Áû
;

37433 i‡(!
	`JS_IsNuŒ
(
ñ
Ë&& !
	`JS_IsUndeföed
(el)) {

37434 i‡(
toLoˇÀSåög
) {

37435 
ñ
 = 
	`JS_ToLoˇÀSåögFªe
(
˘x
,Él);

37437 i‡(
	`°rög_buf„r_c⁄ˇt_vÆue_‰ì
(
b
, 
ñ
))

37438 
Áû
;

37441 
	`JS_FªeVÆue
(
˘x
, 
£p
);

37442 
	`JS_FªeVÆue
(
˘x
, 
obj
);

37443  
	`°rög_buf„r_íd
(
b
);

37445 
Áû
:

37446 
	`°rög_buf„r_‰ì
(
b
);

37447 
	`JS_FªeVÆue
(
˘x
, 
£p
);

37448 
ex˚±i⁄
:

37449 
	`JS_FªeVÆue
(
˘x
, 
obj
);

37450  
JS_EXCEPTION
;

37451 
	}
}

37453 
JSVÆue
 
	$js_¨øy_p›
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

37454 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
, 
shi·
)

37456 
JSVÆue
 
obj
, 
ªs
 = 
JS_UNDEFINED
;

37457 
söt64_t
 
Àn
, 
√wLí
;

37458 
JSVÆue
 *
¨Ω
;

37459 
uöt32_t
 
cou¡32
;

37461 
obj
 = 
	`JS_ToObje˘
(
˘x
, 
this_vÆ
);

37462 i‡(
	`js_gë_Àngth64
(
˘x
, &
Àn
, 
obj
))

37463 
ex˚±i⁄
;

37464 
√wLí
 = 0;

37465 i‡(
Àn
 > 0) {

37466 
√wLí
 = 
Àn
 - 1;

37468 i‡(
	`js_gë_Á°_¨øy
(
˘x
, 
obj
, &
¨Ω
, &
cou¡32
Ë&& cou¡32 =
Àn
) {

37469 
JSObje˘
 *
p
 = 
	`JS_VALUE_GET_OBJ
(
obj
);

37470 i‡(
shi·
) {

37471 
ªs
 = 
¨Ω
[0];

37472 
	`memmove
(
¨Ω
,áº∞+ 1, (
cou¡32
 - 1) * (*arrp));

37473 
p
->
u
.
¨øy
.
cou¡
--;

37475 
ªs
 = 
¨Ω
[
cou¡32
 - 1];

37476 
p
->
u
.
¨øy
.
cou¡
--;

37479 i‡(
shi·
) {

37480 
ªs
 = 
	`JS_GëPr›îtyI¡64
(
˘x
, 
obj
, 0);

37481 i‡(
	`JS_IsEx˚±i⁄
(
ªs
))

37482 
ex˚±i⁄
;

37483 i‡(
	`JS_C›ySubAºay
(
˘x
, 
obj
, 0, 1, 
Àn
 - 1, +1))

37484 
ex˚±i⁄
;

37486 
ªs
 = 
	`JS_GëPr›îtyI¡64
(
˘x
, 
obj
, 
√wLí
);

37487 i‡(
	`JS_IsEx˚±i⁄
(
ªs
))

37488 
ex˚±i⁄
;

37490 i‡(
	`JS_DñëePr›îtyI¡64
(
˘x
, 
obj
, 
√wLí
, 
JS_PROP_THROW
) < 0)

37491 
ex˚±i⁄
;

37494 i‡(
	`JS_SëPr›îty
(
˘x
, 
obj
, 
JS_ATOM_Àngth
, 
	`JS_NewI¡64
(˘x, 
√wLí
)) < 0)

37495 
ex˚±i⁄
;

37497 
	`JS_FªeVÆue
(
˘x
, 
obj
);

37498  
ªs
;

37500 
ex˚±i⁄
:

37501 
	`JS_FªeVÆue
(
˘x
, 
ªs
);

37502 
	`JS_FªeVÆue
(
˘x
, 
obj
);

37503  
JS_EXCEPTION
;

37504 
	}
}

37506 
JSVÆue
 
	$js_¨øy_push
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

37507 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
, 
unshi·
)

37509 
JSVÆue
 
obj
;

37510 
i
;

37511 
söt64_t
 
Àn
, 
‰om
, 
√wLí
;

37513 
obj
 = 
	`JS_ToObje˘
(
˘x
, 
this_vÆ
);

37514 i‡(
	`js_gë_Àngth64
(
˘x
, &
Àn
, 
obj
))

37515 
ex˚±i⁄
;

37516 
√wLí
 = 
Àn
 + 
¨gc
;

37517 i‡(
√wLí
 > 
MAX_SAFE_INTEGER
) {

37518 
	`JS_ThrowTy≥Eº‹
(
˘x
, "ArrayÜooÜong");

37519 
ex˚±i⁄
;

37521 
‰om
 = 
Àn
;

37522 i‡(
unshi·
 && 
¨gc
 > 0) {

37523 i‡(
	`JS_C›ySubAºay
(
˘x
, 
obj
, 
¨gc
, 0, 
Àn
, -1))

37524 
ex˚±i⁄
;

37525 
‰om
 = 0;

37527 
i
 = 0; i < 
¨gc
; i++) {

37528 i‡(
	`JS_SëPr›îtyI¡64
(
˘x
, 
obj
, 
‰om
 + 
i
,

37529 
	`JS_DupVÆue
(
˘x
, 
¨gv
[
i
])) < 0)

37530 
ex˚±i⁄
;

37532 i‡(
	`JS_SëPr›îty
(
˘x
, 
obj
, 
JS_ATOM_Àngth
, 
	`JS_NewI¡64
(˘x, 
√wLí
)) < 0)

37533 
ex˚±i⁄
;

37535 
	`JS_FªeVÆue
(
˘x
, 
obj
);

37536  
	`JS_NewI¡64
(
˘x
, 
√wLí
);

37538 
ex˚±i⁄
:

37539 
	`JS_FªeVÆue
(
˘x
, 
obj
);

37540  
JS_EXCEPTION
;

37541 
	}
}

37543 
JSVÆue
 
	$js_¨øy_ªvî£
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

37544 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

37546 
JSVÆue
 
obj
, 
lvÆ
, 
hvÆ
;

37547 
JSVÆue
 *
¨Ω
;

37548 
söt64_t
 
Àn
, 
l
, 
h
;

37549 
l_¥e£¡
, 
h_¥e£¡
;

37550 
uöt32_t
 
cou¡32
;

37552 
lvÆ
 = 
JS_UNDEFINED
;

37553 
obj
 = 
	`JS_ToObje˘
(
˘x
, 
this_vÆ
);

37554 i‡(
	`js_gë_Àngth64
(
˘x
, &
Àn
, 
obj
))

37555 
ex˚±i⁄
;

37558 i‡(
	`js_gë_Á°_¨øy
(
˘x
, 
obj
, &
¨Ω
, &
cou¡32
Ë&& cou¡32 =
Àn
) {

37559 
uöt32_t
 
Œ
, 
hh
;

37561 i‡(
cou¡32
 > 1) {

37562 
Œ
 = 0, 
hh
 = 
cou¡32
 - 1;Ül < hh;Ül++, hh--) {

37563 
lvÆ
 = 
¨Ω
[
Œ
];

37564 
¨Ω
[
Œ
] =áºp[
hh
];

37565 
¨Ω
[
hh
] = 
lvÆ
;

37568  
obj
;

37571 
l
 = 0, 
h
 = 
Àn
 - 1;Ü < h;Ü++, h--) {

37572 
l_¥e£¡
 = 
	`JS_TryGëPr›îtyI¡64
(
˘x
, 
obj
, 
l
, &
lvÆ
);

37573 i‡(
l_¥e£¡
 < 0)

37574 
ex˚±i⁄
;

37575 
h_¥e£¡
 = 
	`JS_TryGëPr›îtyI¡64
(
˘x
, 
obj
, 
h
, &
hvÆ
);

37576 i‡(
h_¥e£¡
 < 0)

37577 
ex˚±i⁄
;

37578 i‡(
h_¥e£¡
) {

37579 i‡(
	`JS_SëPr›îtyI¡64
(
˘x
, 
obj
, 
l
, 
hvÆ
) < 0)

37580 
ex˚±i⁄
;

37582 i‡(
l_¥e£¡
) {

37583 i‡(
	`JS_SëPr›îtyI¡64
(
˘x
, 
obj
, 
h
, 
lvÆ
) < 0) {

37584 
lvÆ
 = 
JS_UNDEFINED
;

37585 
ex˚±i⁄
;

37587 
lvÆ
 = 
JS_UNDEFINED
;

37589 i‡(
	`JS_DñëePr›îtyI¡64
(
˘x
, 
obj
, 
h
, 
JS_PROP_THROW
) < 0)

37590 
ex˚±i⁄
;

37593 i‡(
l_¥e£¡
) {

37594 i‡(
	`JS_DñëePr›îtyI¡64
(
˘x
, 
obj
, 
l
, 
JS_PROP_THROW
) < 0)

37595 
ex˚±i⁄
;

37596 i‡(
	`JS_SëPr›îtyI¡64
(
˘x
, 
obj
, 
h
, 
lvÆ
) < 0) {

37597 
lvÆ
 = 
JS_UNDEFINED
;

37598 
ex˚±i⁄
;

37600 
lvÆ
 = 
JS_UNDEFINED
;

37604  
obj
;

37606 
ex˚±i⁄
:

37607 
	`JS_FªeVÆue
(
˘x
, 
lvÆ
);

37608 
	`JS_FªeVÆue
(
˘x
, 
obj
);

37609  
JS_EXCEPTION
;

37610 
	}
}

37612 
JSVÆue
 
	$js_¨øy_¶i˚
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

37613 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
, 
•li˚
)

37615 
JSVÆue
 
obj
, 
¨r
, 
vÆ
, 
Àn_vÆ
;

37616 
söt64_t
 
Àn
, 
°¨t
, 
k
, 
föÆ
, 
n
, 
cou¡
, 
dñ_cou¡
, 
√w_Àn
;

37617 
kPª£¡
;

37618 
JSVÆue
 *
¨Ω
;

37619 
uöt32_t
 
cou¡32
, 
i
, 
ôem_cou¡
;

37621 
¨r
 = 
JS_UNDEFINED
;

37622 
obj
 = 
	`JS_ToObje˘
(
˘x
, 
this_vÆ
);

37623 i‡(
	`js_gë_Àngth64
(
˘x
, &
Àn
, 
obj
))

37624 
ex˚±i⁄
;

37626 i‡(
	`JS_ToI¡64Cœmp
(
˘x
, &
°¨t
, 
¨gv
[0], 0, 
Àn
,Üen))

37627 
ex˚±i⁄
;

37629 i‡(
•li˚
) {

37630 i‡(
¨gc
 == 0) {

37631 
ôem_cou¡
 = 0;

37632 
dñ_cou¡
 = 0;

37634 i‡(
¨gc
 == 1) {

37635 
ôem_cou¡
 = 0;

37636 
dñ_cou¡
 = 
Àn
 - 
°¨t
;

37638 
ôem_cou¡
 = 
¨gc
 - 2;

37639 i‡(
	`JS_ToI¡64Cœmp
(
˘x
, &
dñ_cou¡
, 
¨gv
[1], 0, 
Àn
 - 
°¨t
, 0))

37640 
ex˚±i⁄
;

37642 i‡(
Àn
 + 
ôem_cou¡
 - 
dñ_cou¡
 > 
MAX_SAFE_INTEGER
) {

37643 
	`JS_ThrowTy≥Eº‹
(
˘x
, "ArrayÜooÜong");

37644 
ex˚±i⁄
;

37646 
cou¡
 = 
dñ_cou¡
;

37648 
ôem_cou¡
 = 0;

37649 
föÆ
 = 
Àn
;

37650 i‡(!
	`JS_IsUndeföed
(
¨gv
[1])) {

37651 i‡(
	`JS_ToI¡64Cœmp
(
˘x
, &
föÆ
, 
¨gv
[1], 0, 
Àn
,Üen))

37652 
ex˚±i⁄
;

37654 
cou¡
 = 
	`max_öt64
(
föÆ
 - 
°¨t
, 0);

37656 
Àn_vÆ
 = 
	`JS_NewI¡64
(
˘x
, 
cou¡
);

37657 
¨r
 = 
	`JS_AºayS≥cõsCª©e
(
˘x
, 
obj
, 
Àn_vÆ
);

37658 
	`JS_FªeVÆue
(
˘x
, 
Àn_vÆ
);

37659 i‡(
	`JS_IsEx˚±i⁄
(
¨r
))

37660 
ex˚±i⁄
;

37662 
k
 = 
°¨t
;

37663 
föÆ
 = 
°¨t
 + 
cou¡
;

37664 
n
 = 0;

37669 i‡(
	`js_gë_Á°_¨øy
(
˘x
, 
obj
, &
¨Ω
, &
cou¡32
) &&

37670 
	`js_is_Á°_¨øy
(
˘x
, 
¨r
)) {

37672 ; 
k
 < 
föÆ
 && k < 
cou¡32
; k++, 
n
++) {

37673 i‡(
	`JS_Cª©eD©aPr›îtyUöt32
(
˘x
, 
¨r
, 
n
, 
	`JS_DupVÆue
(˘x, 
¨Ω
[
k
]), 
JS_PROP_THROW
) < 0)

37674 
ex˚±i⁄
;

37678 ; 
k
 < 
föÆ
; k++, 
n
++) {

37679 
kPª£¡
 = 
	`JS_TryGëPr›îtyI¡64
(
˘x
, 
obj
, 
k
, &
vÆ
);

37680 i‡(
kPª£¡
 < 0)

37681 
ex˚±i⁄
;

37682 i‡(
kPª£¡
) {

37683 i‡(
	`JS_Cª©eD©aPr›îtyUöt32
(
˘x
, 
¨r
, 
n
, 
vÆ
, 
JS_PROP_THROW
) < 0)

37684 
ex˚±i⁄
;

37687 i‡(
	`JS_SëPr›îty
(
˘x
, 
¨r
, 
JS_ATOM_Àngth
, 
	`JS_NewI¡64
(˘x, 
n
)) < 0)

37688 
ex˚±i⁄
;

37690 i‡(
•li˚
) {

37691 
√w_Àn
 = 
Àn
 + 
ôem_cou¡
 - 
dñ_cou¡
;

37692 i‡(
ôem_cou¡
 !
dñ_cou¡
) {

37693 i‡(
	`JS_C›ySubAºay
(
˘x
, 
obj
, 
°¨t
 + 
ôem_cou¡
,

37694 
°¨t
 + 
dñ_cou¡
, 
Àn
 - (start + del_count),

37695 
ôem_cou¡
 <
dñ_cou¡
 ? +1 : -1) < 0)

37696 
ex˚±i⁄
;

37698 
k
 = 
Àn
; k-- > 
√w_Àn
; ) {

37699 i‡(
	`JS_DñëePr›îtyI¡64
(
˘x
, 
obj
, 
k
, 
JS_PROP_THROW
) < 0)

37700 
ex˚±i⁄
;

37703 
i
 = 0; i < 
ôem_cou¡
; i++) {

37704 i‡(
	`JS_SëPr›îtyI¡64
(
˘x
, 
obj
, 
°¨t
 + 
i
, 
	`JS_DupVÆue
(˘x, 
¨gv
[i + 2])) < 0)

37705 
ex˚±i⁄
;

37707 i‡(
	`JS_SëPr›îty
(
˘x
, 
obj
, 
JS_ATOM_Àngth
, 
	`JS_NewI¡64
(˘x, 
√w_Àn
)) < 0)

37708 
ex˚±i⁄
;

37710 
	`JS_FªeVÆue
(
˘x
, 
obj
);

37711  
¨r
;

37713 
ex˚±i⁄
:

37714 
	`JS_FªeVÆue
(
˘x
, 
obj
);

37715 
	`JS_FªeVÆue
(
˘x
, 
¨r
);

37716  
JS_EXCEPTION
;

37717 
	}
}

37719 
JSVÆue
 
	$js_¨øy_c›yWôhö
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

37720 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

37722 
JSVÆue
 
obj
;

37723 
söt64_t
 
Àn
, 
‰om
, 
to
, 
föÆ
, 
cou¡
;

37725 
obj
 = 
	`JS_ToObje˘
(
˘x
, 
this_vÆ
);

37726 i‡(
	`js_gë_Àngth64
(
˘x
, &
Àn
, 
obj
))

37727 
ex˚±i⁄
;

37729 i‡(
	`JS_ToI¡64Cœmp
(
˘x
, &
to
, 
¨gv
[0], 0, 
Àn
,Üen))

37730 
ex˚±i⁄
;

37732 i‡(
	`JS_ToI¡64Cœmp
(
˘x
, &
‰om
, 
¨gv
[1], 0, 
Àn
,Üen))

37733 
ex˚±i⁄
;

37735 
föÆ
 = 
Àn
;

37736 i‡(
¨gc
 > 2 && !
	`JS_IsUndeföed
(
¨gv
[2])) {

37737 i‡(
	`JS_ToI¡64Cœmp
(
˘x
, &
föÆ
, 
¨gv
[2], 0, 
Àn
,Üen))

37738 
ex˚±i⁄
;

37741 
cou¡
 = 
	`mö_öt64
(
föÆ
 - 
‰om
, 
Àn
 - 
to
);

37743 i‡(
	`JS_C›ySubAºay
(
˘x
, 
obj
, 
to
, 
‰om
, 
cou¡
,

37744 (
‰om
 < 
to
 &&Åÿ< from + 
cou¡
) ? -1 : +1))

37745 
ex˚±i⁄
;

37747  
obj
;

37749 
ex˚±i⁄
:

37750 
	`JS_FªeVÆue
(
˘x
, 
obj
);

37751  
JS_EXCEPTION
;

37752 
	}
}

37754 
söt64_t
 
	$JS_FœâíI¡oAºay
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
èrgë
,

37755 
JSVÆueC⁄°
 
sour˚
, 
öt64_t
 
sour˚Lí
,

37756 
söt64_t
 
èrgëIndex
, 
dïth
,

37757 
JSVÆueC⁄°
 
m≠≥rFun˘i⁄
,

37758 
JSVÆueC⁄°
 
thisArg
)

37760 
JSVÆue
 
ñemít
;

37761 
söt64_t
 
sour˚Index
, 
ñemítLí
;

37762 
¥e£¡
, 
is_¨øy
;

37764 
sour˚Index
 = 0; sour˚Index < 
sour˚Lí
; sourceIndex++) {

37765 
¥e£¡
 = 
	`JS_TryGëPr›îtyI¡64
(
˘x
, 
sour˚
, 
sour˚Index
, &
ñemít
);

37766 i‡(
¥e£¡
 < 0)

37768 i‡(!
¥e£¡
)

37770 i‡(!
	`JS_IsUndeföed
(
m≠≥rFun˘i⁄
)) {

37771 
JSVÆueC⁄°
 
¨gs
[3] = { 
ñemít
, 
	`JS_NewI¡64
(
˘x
, 
sour˚Index
), 
sour˚
 };

37772 
ñemít
 = 
	`JS_CÆl
(
˘x
, 
m≠≥rFun˘i⁄
, 
thisArg
, 3, 
¨gs
);

37773 
	`JS_FªeVÆue
(
˘x
, (
JSVÆue
)
¨gs
[0]);

37774 
	`JS_FªeVÆue
(
˘x
, (
JSVÆue
)
¨gs
[1]);

37775 i‡(
	`JS_IsEx˚±i⁄
(
ñemít
))

37778 i‡(
dïth
 > 0) {

37779 
is_¨øy
 = 
	`JS_IsAºay
(
˘x
, 
ñemít
);

37780 i‡(
is_¨øy
 < 0)

37781 
Áû
;

37782 i‡(
is_¨øy
) {

37783 i‡(
	`js_gë_Àngth64
(
˘x
, &
ñemítLí
, 
ñemít
) < 0)

37784 
Áû
;

37785 
èrgëIndex
 = 
	`JS_FœâíI¡oAºay
(
˘x
, 
èrgë
, 
ñemít
,

37786 
ñemítLí
, 
èrgëIndex
,

37787 
dïth
 - 1,

37788 
JS_UNDEFINED
, JS_UNDEFINED);

37789 i‡(
èrgëIndex
 < 0)

37790 
Áû
;

37791 
	`JS_FªeVÆue
(
˘x
, 
ñemít
);

37795 i‡(
èrgëIndex
 >
MAX_SAFE_INTEGER
) {

37796 
	`JS_ThrowTy≥Eº‹
(
˘x
, "ArrayÅooÜong");

37797 
Áû
;

37799 i‡(
	`JS_DeföePr›îtyVÆueI¡64
(
˘x
, 
èrgë
, 
èrgëIndex
, 
ñemít
,

37800 
JS_PROP_C_W_E
 | 
JS_PROP_THROW
) < 0)

37802 
èrgëIndex
++;

37804  
èrgëIndex
;

37806 
Áû
:

37807 
	`JS_FªeVÆue
(
˘x
, 
ñemít
);

37809 
	}
}

37811 
JSVÆue
 
	$js_¨øy_Ê©ãn
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

37812 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
, 
m≠
)

37814 
JSVÆue
 
obj
, 
¨r
;

37815 
JSVÆueC⁄°
 
m≠≥rFun˘i⁄
, 
thisArg
;

37816 
söt64_t
 
sour˚Lí
;

37817 
dïthNum
;

37819 
¨r
 = 
JS_UNDEFINED
;

37820 
obj
 = 
	`JS_ToObje˘
(
˘x
, 
this_vÆ
);

37821 i‡(
	`js_gë_Àngth64
(
˘x
, &
sour˚Lí
, 
obj
))

37822 
ex˚±i⁄
;

37824 
dïthNum
 = 1;

37825 
m≠≥rFun˘i⁄
 = 
JS_UNDEFINED
;

37826 
thisArg
 = 
JS_UNDEFINED
;

37827 i‡(
m≠
) {

37828 
m≠≥rFun˘i⁄
 = 
¨gv
[0];

37829 i‡(
¨gc
 > 1) {

37830 
thisArg
 = 
¨gv
[1];

37832 i‡(
	`check_fun˘i⁄
(
˘x
, 
m≠≥rFun˘i⁄
))

37833 
ex˚±i⁄
;

37835 i‡(
¨gc
 > 0 && !
	`JS_IsUndeföed
(
¨gv
[0])) {

37836 i‡(
	`JS_ToI¡32S©
(
˘x
, &
dïthNum
, 
¨gv
[0]) < 0)

37837 
ex˚±i⁄
;

37840 
¨r
 = 
	`JS_AºayS≥cõsCª©e
(
˘x
, 
obj
, 
	`JS_NewI¡32
(ctx, 0));

37841 i‡(
	`JS_IsEx˚±i⁄
(
¨r
))

37842 
ex˚±i⁄
;

37843 i‡(
	`JS_FœâíI¡oAºay
(
˘x
, 
¨r
, 
obj
, 
sour˚Lí
, 0, 
dïthNum
,

37844 
m≠≥rFun˘i⁄
, 
thisArg
) < 0)

37845 
ex˚±i⁄
;

37846 
	`JS_FªeVÆue
(
˘x
, 
obj
);

37847  
¨r
;

37849 
ex˚±i⁄
:

37850 
	`JS_FªeVÆue
(
˘x
, 
obj
);

37851 
	`JS_FªeVÆue
(
˘x
, 
¨r
);

37852  
JS_EXCEPTION
;

37853 
	}
}

37857 
	sVÆueSlŸ
 {

37858 
JSVÆue
 
	mvÆ
;

37859 
JSSåög
 *
	m°r
;

37860 
söt64_t
 
	mpos
;

37861 } 
	tVÆueSlŸ
;

37863 
	s¨øy_s‹t_c⁄ãxt
 {

37864 
JSC⁄ãxt
 *
	m˘x
;

37865 
	mex˚±i⁄
;

37866 
	mhas_mëhod
;

37867 
JSVÆueC⁄°
 
	mmëhod
;

37870 
	$js_¨øy_cmp_gíîic
(c⁄° *
a
, c⁄° *
b
, *
›aque
) {

37871 
¨øy_s‹t_c⁄ãxt
 *
psc
 = 
›aque
;

37872 
JSC⁄ãxt
 *
˘x
 = 
psc
->ctx;

37873 
JSVÆueC⁄°
 
¨gv
[2];

37874 
JSVÆue
 
ªs
;

37875 
VÆueSlŸ
 *
≠
 = (VÆueSlŸ *)(*)
a
;

37876 
VÆueSlŸ
 *
bp
 = (VÆueSlŸ *)(*)
b
;

37877 
cmp
;

37879 i‡(
psc
->
ex˚±i⁄
)

37882 i‡(
psc
->
has_mëhod
) {

37886 i‡(!
	`memcmp
(&
≠
->
vÆ
, &
bp
->val, (ap->val)))

37887 
cmp_ßme
;

37888 
¨gv
[0] = 
≠
->
vÆ
;

37889 
¨gv
[1] = 
bp
->
vÆ
;

37890 
ªs
 = 
	`JS_CÆl
(
˘x
, 
psc
->
mëhod
, 
JS_UNDEFINED
, 2, 
¨gv
);

37891 i‡(
	`JS_IsEx˚±i⁄
(
ªs
))

37892 
ex˚±i⁄
;

37893 i‡(
	`JS_VALUE_GET_TAG
(
ªs
Ë=
JS_TAG_INT
) {

37894 
vÆ
 = 
	`JS_VALUE_GET_INT
(
ªs
);

37895 
cmp
 = (
vÆ
 > 0) - (val < 0);

37897 
vÆ
;

37898 i‡(
	`JS_ToFlﬂt64Fªe
(
˘x
, &
vÆ
, 
ªs
) < 0)

37899 
ex˚±i⁄
;

37900 
cmp
 = (
vÆ
 > 0) - (val < 0);

37906 i‡(!
≠
->
°r
) {

37907 
JSVÆue
 
°r
 = 
	`JS_ToSåög
(
˘x
, 
≠
->
vÆ
);

37908 i‡(
	`JS_IsEx˚±i⁄
(
°r
))

37909 
ex˚±i⁄
;

37910 
≠
->
°r
 = 
	`JS_VALUE_GET_STRING
(str);

37912 i‡(!
bp
->
°r
) {

37913 
JSVÆue
 
°r
 = 
	`JS_ToSåög
(
˘x
, 
bp
->
vÆ
);

37914 i‡(
	`JS_IsEx˚±i⁄
(
°r
))

37915 
ex˚±i⁄
;

37916 
bp
->
°r
 = 
	`JS_VALUE_GET_STRING
(str);

37918 
cmp
 = 
	`js_°rög_com∑ª
(
˘x
, 
≠
->
°r
, 
bp
->str);

37920 i‡(
cmp
 != 0)

37921  
cmp
;

37922 
cmp_ßme
:

37924  (
≠
->
pos
 > 
bp
->pos) - (ap->pos < bp->pos);

37926 
ex˚±i⁄
:

37927 
psc
->
ex˚±i⁄
 = 1;

37929 
	}
}

37931 
JSVÆue
 
	$js_¨øy_s‹t
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

37932 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

37934 
¨øy_s‹t_c⁄ãxt
 
asc
 = { 
˘x
, 0, 0, 
¨gv
[0] };

37935 
JSVÆue
 
obj
 = 
JS_UNDEFINED
;

37936 
VÆueSlŸ
 *
¨øy
 = 
NULL
;

37937 
size_t
 
¨øy_size
 = 0, 
pos
 = 0, 
n
 = 0;

37938 
söt64_t
 
i
, 
Àn
, 
undeföed_cou¡
 = 0;

37939 
¥e£¡
;

37941 i‡(!
	`JS_IsUndeföed
(
asc
.
mëhod
)) {

37942 i‡(
	`check_fun˘i⁄
(
˘x
, 
asc
.
mëhod
))

37943 
ex˚±i⁄
;

37944 
asc
.
has_mëhod
 = 1;

37946 
obj
 = 
	`JS_ToObje˘
(
˘x
, 
this_vÆ
);

37947 i‡(
	`js_gë_Àngth64
(
˘x
, &
Àn
, 
obj
))

37948 
ex˚±i⁄
;

37951 
i
 = 0; i < 
Àn
; i++) {

37952 i‡(
pos
 >
¨øy_size
) {

37953 
size_t
 
√w_size
, 
¶ack
;

37954 
VÆueSlŸ
 *
√w_¨øy
;

37955 
√w_size
 = (
¨øy_size
 + (array_size >> 1) + 31) & ~15;

37956 
√w_¨øy
 = 
	`js_ªÆloc2
(
˘x
, 
¨øy
, 
√w_size
 * (*¨øy), &
¶ack
);

37957 i‡(
√w_¨øy
 =
NULL
)

37958 
ex˚±i⁄
;

37959 
√w_size
 +
¶ack
 / (*
√w_¨øy
);

37960 
¨øy
 = 
√w_¨øy
;

37961 
¨øy_size
 = 
√w_size
;

37963 
¥e£¡
 = 
	`JS_TryGëPr›îtyI¡64
(
˘x
, 
obj
, 
i
, &
¨øy
[
pos
].
vÆ
);

37964 i‡(
¥e£¡
 < 0)

37965 
ex˚±i⁄
;

37966 i‡(
¥e£¡
 == 0)

37968 i‡(
	`JS_IsUndeföed
(
¨øy
[
pos
].
vÆ
)) {

37969 
undeföed_cou¡
++;

37972 
¨øy
[
pos
].
°r
 = 
NULL
;

37973 
¨øy
[
pos
].po†
i
;

37974 
pos
++;

37976 
	`rqs‹t
(
¨øy
, 
pos
, (*¨øy), 
js_¨øy_cmp_gíîic
, &
asc
);

37977 i‡(
asc
.
ex˚±i⁄
)

37978 
ex˚±i⁄
;

37981 
n
 < 
pos
) {

37982 i‡(
¨øy
[
n
].
°r
)

37983 
	`JS_FªeVÆue
(
˘x
, 
	`JS_MKPTR
(
JS_TAG_STRING
, 
¨øy
[
n
].
°r
));

37984 i‡(
¨øy
[
n
].
pos
 ==Ç) {

37985 
	`JS_FªeVÆue
(
˘x
, 
¨øy
[
n
].
vÆ
);

37987 i‡(
	`JS_SëPr›îtyI¡64
(
˘x
, 
obj
, 
n
, 
¨øy
[n].
vÆ
) < 0) {

37988 
n
++;

37989 
ex˚±i⁄
;

37992 
n
++;

37994 
	`js_‰ì
(
˘x
, 
¨øy
);

37995 
i
 = 
n
; 
undeföed_cou¡
-- > 0; i++) {

37996 i‡(
	`JS_SëPr›îtyI¡64
(
˘x
, 
obj
, 
i
, 
JS_UNDEFINED
) < 0)

37997 
Áû
;

37999 ; 
i
 < 
Àn
; i++) {

38000 i‡(
	`JS_DñëePr›îtyI¡64
(
˘x
, 
obj
, 
i
, 
JS_PROP_THROW
) < 0)

38001 
Áû
;

38003  
obj
;

38005 
ex˚±i⁄
:

38006 ; 
n
 < 
pos
;Ç++) {

38007 
	`JS_FªeVÆue
(
˘x
, 
¨øy
[
n
].
vÆ
);

38008 i‡(
¨øy
[
n
].
°r
)

38009 
	`JS_FªeVÆue
(
˘x
, 
	`JS_MKPTR
(
JS_TAG_STRING
, 
¨øy
[
n
].
°r
));

38011 
	`js_‰ì
(
˘x
, 
¨øy
);

38012 
Áû
:

38013 
	`JS_FªeVÆue
(
˘x
, 
obj
);

38014  
JS_EXCEPTION
;

38015 
	}
}

38017 
	sJSAºayIãøt‹D©a
 {

38018 
JSVÆue
 
	mobj
;

38019 
JSIãøt‹KödEnum
 
	mköd
;

38020 
uöt32_t
 
	midx
;

38021 } 
	tJSAºayIãøt‹D©a
;

38023 
	$js_¨øy_ôî©‹_föÆizî
(
JSRu¡ime
 *
π
, 
JSVÆue
 
vÆ
)

38025 
JSObje˘
 *
p
 = 
	`JS_VALUE_GET_OBJ
(
vÆ
);

38026 
JSAºayIãøt‹D©a
 *
ô
 = 
p
->
u
.
¨øy_ôî©‹_d©a
;

38027 i‡(
ô
) {

38028 
	`JS_FªeVÆueRT
(
π
, 
ô
->
obj
);

38029 
	`js_‰ì_π
(
π
, 
ô
);

38031 
	}
}

38033 
	$js_¨øy_ôî©‹_m¨k
(
JSRu¡ime
 *
π
, 
JSVÆueC⁄°
 
vÆ
,

38034 
JS_M¨kFunc
 *
m¨k_func
)

38036 
JSObje˘
 *
p
 = 
	`JS_VALUE_GET_OBJ
(
vÆ
);

38037 
JSAºayIãøt‹D©a
 *
ô
 = 
p
->
u
.
¨øy_ôî©‹_d©a
;

38038 i‡(
ô
) {

38039 
	`JS_M¨kVÆue
(
π
, 
ô
->
obj
, 
m¨k_func
);

38041 
	}
}

38043 
JSVÆue
 
	$js_¸óã_¨øy
(
JSC⁄ãxt
 *
˘x
, 
Àn
, 
JSVÆueC⁄°
 *
èb
)

38045 
JSVÆue
 
obj
;

38046 
i
;

38048 
obj
 = 
	`JS_NewAºay
(
˘x
);

38049 i‡(
	`JS_IsEx˚±i⁄
(
obj
))

38050  
JS_EXCEPTION
;

38051 
i
 = 0; i < 
Àn
; i++) {

38052 i‡(
	`JS_Cª©eD©aPr›îtyUöt32
(
˘x
, 
obj
, 
i
, 
	`JS_DupVÆue
(˘x, 
èb
[i]), 0) < 0) {

38053 
	`JS_FªeVÆue
(
˘x
, 
obj
);

38054  
JS_EXCEPTION
;

38057  
obj
;

38058 
	}
}

38060 
JSVÆue
 
	$js_¸óã_¨øy_ôî©‹
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

38061 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
, 
magic
)

38063 
JSVÆue
 
íum_obj
, 
¨r
;

38064 
JSAºayIãøt‹D©a
 *
ô
;

38065 
JSIãøt‹KödEnum
 
köd
;

38066 
˛ass_id
;

38068 
köd
 = 
magic
 & 3;

38069 i‡(
magic
 & 4) {

38071 
¨r
 = 
	`JS_ToSåögCheckObje˘
(
˘x
, 
this_vÆ
);

38072 
˛ass_id
 = 
JS_CLASS_STRING_ITERATOR
;

38074 
¨r
 = 
	`JS_ToObje˘
(
˘x
, 
this_vÆ
);

38075 
˛ass_id
 = 
JS_CLASS_ARRAY_ITERATOR
;

38077 i‡(
	`JS_IsEx˚±i⁄
(
¨r
))

38078 
Áû
;

38079 
íum_obj
 = 
	`JS_NewObje˘Cœss
(
˘x
, 
˛ass_id
);

38080 i‡(
	`JS_IsEx˚±i⁄
(
íum_obj
))

38081 
Áû
;

38082 
ô
 = 
	`js_mÆloc
(
˘x
, (*it));

38083 i‡(!
ô
)

38084 
Áû1
;

38085 
ô
->
obj
 = 
¨r
;

38086 
ô
->
köd
 = kind;

38087 
ô
->
idx
 = 0;

38088 
	`JS_SëO∑que
(
íum_obj
, 
ô
);

38089  
íum_obj
;

38090 
Áû1
:

38091 
	`JS_FªeVÆue
(
˘x
, 
íum_obj
);

38092 
Áû
:

38093 
	`JS_FªeVÆue
(
˘x
, 
¨r
);

38094  
JS_EXCEPTION
;

38095 
	}
}

38097 
JSVÆue
 
	$js_¨øy_ôî©‹_√xt
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

38098 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
,

38099 
BOOL
 *
pd⁄e
, 
magic
)

38101 
JSAºayIãøt‹D©a
 *
ô
;

38102 
uöt32_t
 
Àn
, 
idx
;

38103 
JSVÆue
 
vÆ
, 
obj
;

38104 
JSObje˘
 *
p
;

38106 
ô
 = 
	`JS_GëO∑que2
(
˘x
, 
this_vÆ
, 
JS_CLASS_ARRAY_ITERATOR
);

38107 i‡(!
ô
)

38108 
Áû1
;

38109 i‡(
	`JS_IsUndeföed
(
ô
->
obj
))

38110 
d⁄e
;

38111 
p
 = 
	`JS_VALUE_GET_OBJ
(
ô
->
obj
);

38112 i‡(
p
->
˛ass_id
 >
JS_CLASS_UINT8C_ARRAY
 &&

38113 
p
->
˛ass_id
 <
JS_CLASS_FLOAT64_ARRAY
) {

38114 i‡(
	`ty≥d_¨øy_is_dëached
(
˘x
, 
p
)) {

38115 
	`JS_ThrowTy≥Eº‹DëachedAºayBuf„r
(
˘x
);

38116 
Áû1
;

38118 
Àn
 = 
p
->
u
.
¨øy
.
cou¡
;

38120 i‡(
	`js_gë_Àngth32
(
˘x
, &
Àn
, 
ô
->
obj
)) {

38121 
Áû1
:

38122 *
pd⁄e
 = 
FALSE
;

38123  
JS_EXCEPTION
;

38126 
idx
 = 
ô
->idx;

38127 i‡(
idx
 >
Àn
) {

38128 
	`JS_FªeVÆue
(
˘x
, 
ô
->
obj
);

38129 
ô
->
obj
 = 
JS_UNDEFINED
;

38130 
d⁄e
:

38131 *
pd⁄e
 = 
TRUE
;

38132  
JS_UNDEFINED
;

38134 
ô
->
idx
 = idx + 1;

38135 *
pd⁄e
 = 
FALSE
;

38136 i‡(
ô
->
köd
 =
JS_ITERATOR_KIND_KEY
) {

38137  
	`JS_NewUöt32
(
˘x
, 
idx
);

38139 
vÆ
 = 
	`JS_GëPr›îtyUöt32
(
˘x
, 
ô
->
obj
, 
idx
);

38140 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

38141  
JS_EXCEPTION
;

38142 i‡(
ô
->
köd
 =
JS_ITERATOR_KIND_VALUE
) {

38143  
vÆ
;

38145 
JSVÆueC⁄°
 
¨gs
[2];

38146 
JSVÆue
 
num
;

38147 
num
 = 
	`JS_NewUöt32
(
˘x
, 
idx
);

38148 
¨gs
[0] = 
num
;

38149 
¨gs
[1] = 
vÆ
;

38150 
obj
 = 
	`js_¸óã_¨øy
(
˘x
, 2, 
¨gs
);

38151 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

38152 
	`JS_FªeVÆue
(
˘x
, 
num
);

38153  
obj
;

38156 
	}
}

38158 
JSVÆue
 
	$js_ôî©‹_¥Ÿo_ôî©‹
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

38159 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

38161  
	`JS_DupVÆue
(
˘x
, 
this_vÆ
);

38162 
	}
}

38164 c⁄° 
JSCFun˘i⁄Li°E¡ry
 
	gjs_ôî©‹_¥Ÿo_funcs
[] = {

38165 
JS_CFUNC_DEF
("[Symbﬁ.ôî©‹]", 0, 
js_ôî©‹_¥Ÿo_ôî©‹
 ),

38168 c⁄° 
JSCFun˘i⁄Li°E¡ry
 
	gjs_¨øy_¥Ÿo_funcs
[] = {

38169 
JS_CFUNC_DEF
("c⁄ˇt", 1, 
js_¨øy_c⁄ˇt
 ),

38170 
JS_CFUNC_MAGIC_DEF
("evîy", 1, 
js_¨øy_evîy
, 
•ecül_evîy
 ),

38171 
JS_CFUNC_MAGIC_DEF
("some", 1, 
js_¨øy_evîy
, 
•ecül_some
 ),

38172 
JS_CFUNC_MAGIC_DEF
("f‹Each", 1, 
js_¨øy_evîy
, 
•ecül_f‹Each
 ),

38173 
JS_CFUNC_MAGIC_DEF
("m≠", 1, 
js_¨øy_evîy
, 
•ecül_m≠
 ),

38174 
JS_CFUNC_MAGIC_DEF
("fûãr", 1, 
js_¨øy_evîy
, 
•ecül_fûãr
 ),

38175 
JS_CFUNC_MAGIC_DEF
("ªdu˚", 1, 
js_¨øy_ªdu˚
, 
•ecül_ªdu˚
 ),

38176 
JS_CFUNC_MAGIC_DEF
("ªdu˚Right", 1, 
js_¨øy_ªdu˚
, 
•ecül_ªdu˚Right
 ),

38177 
JS_CFUNC_DEF
("fûl", 1, 
js_¨øy_fûl
 ),

38178 
JS_CFUNC_MAGIC_DEF
("föd", 1, 
js_¨øy_föd
, 0 ),

38179 
JS_CFUNC_MAGIC_DEF
("födIndex", 1, 
js_¨øy_föd
, 1 ),

38180 
JS_CFUNC_DEF
("ödexOf", 1, 
js_¨øy_ödexOf
 ),

38181 
JS_CFUNC_DEF
("œ°IndexOf", 1, 
js_¨øy_œ°IndexOf
 ),

38182 
JS_CFUNC_DEF
("ö˛udes", 1, 
js_¨øy_ö˛udes
 ),

38183 
JS_CFUNC_MAGIC_DEF
("joö", 1, 
js_¨øy_joö
, 0 ),

38184 
JS_CFUNC_DEF
("toSåög", 0, 
js_¨øy_toSåög
 ),

38185 
JS_CFUNC_MAGIC_DEF
("toLoˇÀSåög", 0, 
js_¨øy_joö
, 1 ),

38186 
JS_CFUNC_MAGIC_DEF
("p›", 0, 
js_¨øy_p›
, 0 ),

38187 
JS_CFUNC_MAGIC_DEF
("push", 1, 
js_¨øy_push
, 0 ),

38188 
JS_CFUNC_MAGIC_DEF
("shi·", 0, 
js_¨øy_p›
, 1 ),

38189 
JS_CFUNC_MAGIC_DEF
("unshi·", 1, 
js_¨øy_push
, 1 ),

38190 
JS_CFUNC_DEF
("ªvî£", 0, 
js_¨øy_ªvî£
 ),

38191 
JS_CFUNC_DEF
("s‹t", 1, 
js_¨øy_s‹t
 ),

38192 
JS_CFUNC_MAGIC_DEF
("¶i˚", 2, 
js_¨øy_¶i˚
, 0 ),

38193 
JS_CFUNC_MAGIC_DEF
("•li˚", 2, 
js_¨øy_¶i˚
, 1 ),

38194 
JS_CFUNC_DEF
("c›yWôhö", 2, 
js_¨øy_c›yWôhö
 ),

38195 
JS_CFUNC_MAGIC_DEF
("Ê©M≠", 1, 
js_¨øy_Ê©ãn
, 1 ),

38196 
JS_CFUNC_MAGIC_DEF
("Ê©", 0, 
js_¨øy_Ê©ãn
, 0 ),

38197 
JS_CFUNC_MAGIC_DEF
("vÆues", 0, 
js_¸óã_¨øy_ôî©‹
, 
JS_ITERATOR_KIND_VALUE
 ),

38198 
JS_ALIAS_DEF
("[Symbol.iterator]", "values" ),

38199 
JS_CFUNC_MAGIC_DEF
("keys", 0, 
js_¸óã_¨øy_ôî©‹
, 
JS_ITERATOR_KIND_KEY
 ),

38200 
JS_CFUNC_MAGIC_DEF
("íåõs", 0, 
js_¸óã_¨øy_ôî©‹
, 
JS_ITERATOR_KIND_KEY_AND_VALUE
 ),

38203 c⁄° 
JSCFun˘i⁄Li°E¡ry
 
	gjs_¨øy_ôî©‹_¥Ÿo_funcs
[] = {

38204 
JS_ITERATOR_NEXT_DEF
("√xt", 0, 
js_¨øy_ôî©‹_√xt
, 0 ),

38205 
JS_PROP_STRING_DEF
("[Symbﬁ.toSåögTag]", "Aºay Iãøt‹", 
JS_PROP_CONFIGURABLE
 ),

38210 
JSVÆue
 
	$js_numbî_c⁄°ru˘‹
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
√w_èrgë
,

38211 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

38213 
JSVÆue
 
vÆ
, 
obj
;

38214 i‡(
¨gc
 == 0) {

38215 
vÆ
 = 
	`JS_NewI¡32
(
˘x
, 0);

38217 
vÆ
 = 
	`JS_ToNumîic
(
˘x
, 
¨gv
[0]);

38218 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

38219  
vÆ
;

38220 
	`JS_VALUE_GET_TAG
(
vÆ
)) {

38221 #ifde‡
CONFIG_BIGNUM


38222 
JS_TAG_BIG_INT
:

38223 
JS_TAG_BIG_FLOAT
:

38225 
JSBigFlﬂt
 *
p
 = 
	`JS_VALUE_GET_PTR
(
vÆ
);

38226 
d
;

38227 
	`bf_gë_Êﬂt64
(&
p
->
num
, &
d
, 
BF_RNDN
);

38228 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

38229 
vÆ
 = 
	`__JS_NewFlﬂt64
(
˘x
, 
d
);

38232 
JS_TAG_BIG_DECIMAL
:

38233 
vÆ
 = 
	`JS_ToSåögFªe
(
˘x
, val);

38234 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

38235  
vÆ
;

38236 
vÆ
 = 
	`JS_ToNumbîFªe
(
˘x
, val);

38237 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

38238  
vÆ
;

38245 i‡(!
	`JS_IsUndeföed
(
√w_èrgë
)) {

38246 
obj
 = 
	`js_¸óã_‰om_˘‹
(
˘x
, 
√w_èrgë
, 
JS_CLASS_NUMBER
);

38247 i‡(!
	`JS_IsEx˚±i⁄
(
obj
))

38248 
	`JS_SëObje˘D©a
(
˘x
, 
obj
, 
vÆ
);

38249  
obj
;

38251  
vÆ
;

38253 
	}
}

38256 
JSVÆue
 
	$js_numbî___toI¡egî
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

38257 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

38259  
	`JS_ToI¡egîFªe
(
˘x
, 
	`JS_DupVÆue
(˘x, 
¨gv
[0]));

38260 
	}
}

38262 
JSVÆue
 
	$js_numbî___toLígth
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

38263 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

38265 
öt64_t
 
v
;

38266 i‡(
	`JS_ToLígthFªe
(
˘x
, &
v
, 
	`JS_DupVÆue
(˘x, 
¨gv
[0])))

38267  
JS_EXCEPTION
;

38268  
	`JS_NewI¡64
(
˘x
, 
v
);

38269 
	}
}

38272 
JSVÆue
 
	$js_numbî_isNaN
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

38273 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

38275 i‡(!
	`JS_IsNumbî
(
¨gv
[0]))

38276  
JS_FALSE
;

38277  
	`js_globÆ_isNaN
(
˘x
, 
this_vÆ
, 
¨gc
, 
¨gv
);

38278 
	}
}

38280 
JSVÆue
 
	$js_numbî_isFöôe
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

38281 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

38283 i‡(!
	`JS_IsNumbî
(
¨gv
[0]))

38284  
JS_FALSE
;

38285  
	`js_globÆ_isFöôe
(
˘x
, 
this_vÆ
, 
¨gc
, 
¨gv
);

38286 
	}
}

38288 
JSVÆue
 
	$js_numbî_isI¡egî
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

38289 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

38291 
ªt
;

38292 
ªt
 = 
	`JS_NumbîIsI¡egî
(
˘x
, 
¨gv
[0]);

38293 i‡(
ªt
 < 0)

38294  
JS_EXCEPTION
;

38296  
	`JS_NewBoﬁ
(
˘x
, 
ªt
);

38297 
	}
}

38299 
JSVÆue
 
	$js_numbî_isSa„I¡egî
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

38300 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

38302 
d
;

38303 i‡(!
	`JS_IsNumbî
(
¨gv
[0]))

38304  
JS_FALSE
;

38305 i‡(
	`u∆ikñy
(
	`JS_ToFlﬂt64
(
˘x
, &
d
, 
¨gv
[0])))

38306  
JS_EXCEPTION
;

38307  
	`JS_NewBoﬁ
(
˘x
, 
	`is_ß„_öãgî
(
d
));

38308 
	}
}

38310 c⁄° 
JSCFun˘i⁄Li°E¡ry
 
	gjs_numbî_funcs
[] = {

38312 
JS_ALIAS_BASE_DEF
("parseInt", "parseInt", 0 ),

38313 
JS_ALIAS_BASE_DEF
("parseFloat", "parseFloat", 0 ),

38314 
JS_CFUNC_DEF
("isNaN", 1, 
js_numbî_isNaN
 ),

38315 
JS_CFUNC_DEF
("isFöôe", 1, 
js_numbî_isFöôe
 ),

38316 
JS_CFUNC_DEF
("isI¡egî", 1, 
js_numbî_isI¡egî
 ),

38317 
JS_CFUNC_DEF
("isSa„I¡egî", 1, 
js_numbî_isSa„I¡egî
 ),

38318 
JS_PROP_DOUBLE_DEF
("MAX_VALUE", 1.7976931348623157e+308, 0 ),

38319 
JS_PROP_DOUBLE_DEF
("MIN_VALUE", 5e-324, 0 ),

38320 
JS_PROP_DOUBLE_DEF
("NaN", 
NAN
, 0 ),

38321 
JS_PROP_DOUBLE_DEF
("NEGATIVE_INFINITY", -
INFINITY
, 0 ),

38322 
JS_PROP_DOUBLE_DEF
("POSITIVE_INFINITY", 
INFINITY
, 0 ),

38323 
JS_PROP_DOUBLE_DEF
("EPSILON", 2.220446049250313e-16, 0 ),

38324 
JS_PROP_DOUBLE_DEF
("MAX_SAFE_INTEGER", 9007199254740991.0, 0 ),

38325 
JS_PROP_DOUBLE_DEF
("MIN_SAFE_INTEGER", -9007199254740991.0, 0 ),

38330 
JSVÆue
 
	$js_thisNumbîVÆue
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
)

38332 i‡(
	`JS_IsNumbî
(
this_vÆ
))

38333  
	`JS_DupVÆue
(
˘x
, 
this_vÆ
);

38335 i‡(
	`JS_VALUE_GET_TAG
(
this_vÆ
Ë=
JS_TAG_OBJECT
) {

38336 
JSObje˘
 *
p
 = 
	`JS_VALUE_GET_OBJ
(
this_vÆ
);

38337 i‡(
p
->
˛ass_id
 =
JS_CLASS_NUMBER
) {

38338 i‡(
	`JS_IsNumbî
(
p
->
u
.
obje˘_d©a
))

38339  
	`JS_DupVÆue
(
˘x
, 
p
->
u
.
obje˘_d©a
);

38342  
	`JS_ThrowTy≥Eº‹
(
˘x
, "notáÇumber");

38343 
	}
}

38345 
JSVÆue
 
	$js_numbî_vÆueOf
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

38346 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

38348  
	`js_thisNumbîVÆue
(
˘x
, 
this_vÆ
);

38349 
	}
}

38351 
	$js_gë_ødix
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
vÆ
)

38353 
ødix
;

38354 i‡(
	`JS_ToI¡32S©
(
˘x
, &
ødix
, 
vÆ
))

38356 i‡(
ødix
 < 2 ||Ñadix > 36) {

38357 
	`JS_ThrowR™geEº‹
(
˘x
, "radix must be between 2ánd 36");

38360  
ødix
;

38361 
	}
}

38363 
JSVÆue
 
	$js_numbî_toSåög
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

38364 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
, 
magic
)

38366 
JSVÆue
 
vÆ
;

38367 
ba£
;

38368 
d
;

38370 
vÆ
 = 
	`js_thisNumbîVÆue
(
˘x
, 
this_vÆ
);

38371 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

38372  
vÆ
;

38373 i‡(
magic
 || 
	`JS_IsUndeföed
(
¨gv
[0])) {

38374 
ba£
 = 10;

38376 
ba£
 = 
	`js_gë_ødix
(
˘x
, 
¨gv
[0]);

38377 i‡(
ba£
 < 0)

38378 
Áû
;

38380 i‡(
	`JS_ToFlﬂt64Fªe
(
˘x
, &
d
, 
vÆ
))

38381  
JS_EXCEPTION
;

38382  
	`js_dtﬂ
(
˘x
, 
d
, 
ba£
, 0, 
JS_DTOA_VAR_FORMAT
);

38383 
Áû
:

38384 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

38385  
JS_EXCEPTION
;

38386 
	}
}

38388 
JSVÆue
 
	$js_numbî_toFixed
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

38389 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

38391 
JSVÆue
 
vÆ
;

38392 
f
;

38393 
d
;

38395 
vÆ
 = 
	`js_thisNumbîVÆue
(
˘x
, 
this_vÆ
);

38396 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

38397  
vÆ
;

38398 i‡(
	`JS_ToFlﬂt64Fªe
(
˘x
, &
d
, 
vÆ
))

38399  
JS_EXCEPTION
;

38400 i‡(
	`JS_ToI¡32S©
(
˘x
, &
f
, 
¨gv
[0]))

38401  
JS_EXCEPTION
;

38402 i‡(
f
 < 0 || f > 100)

38403  
	`JS_ThrowR™geEº‹
(
˘x
, "invalidÇumber of digits");

38404 i‡(
	`Ábs
(
d
) >= 1e21) {

38405  
	`JS_ToSåögFªe
(
˘x
, 
	`__JS_NewFlﬂt64
(˘x, 
d
));

38407  
	`js_dtﬂ
(
˘x
, 
d
, 10, 
f
, 
JS_DTOA_FRAC_FORMAT
);

38409 
	}
}

38411 
JSVÆue
 
	$js_numbî_toExp⁄ítül
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

38412 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

38414 
JSVÆue
 
vÆ
;

38415 
f
, 
Êags
;

38416 
d
;

38418 
vÆ
 = 
	`js_thisNumbîVÆue
(
˘x
, 
this_vÆ
);

38419 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

38420  
vÆ
;

38421 i‡(
	`JS_ToFlﬂt64Fªe
(
˘x
, &
d
, 
vÆ
))

38422  
JS_EXCEPTION
;

38423 i‡(
	`JS_ToI¡32S©
(
˘x
, &
f
, 
¨gv
[0]))

38424  
JS_EXCEPTION
;

38425 i‡(!
	`isföôe
(
d
)) {

38426  
	`JS_ToSåögFªe
(
˘x
, 
	`__JS_NewFlﬂt64
(˘x, 
d
));

38428 i‡(
	`JS_IsUndeföed
(
¨gv
[0])) {

38429 
Êags
 = 0;

38430 
f
 = 0;

38432 i‡(
f
 < 0 || f > 100)

38433  
	`JS_ThrowR™geEº‹
(
˘x
, "invalidÇumber of digits");

38434 
f
++;

38435 
Êags
 = 
JS_DTOA_FIXED_FORMAT
;

38437  
	`js_dtﬂ
(
˘x
, 
d
, 10, 
f
, 
Êags
 | 
JS_DTOA_FORCE_EXP
);

38438 
	}
}

38440 
JSVÆue
 
	$js_numbî_toPªcisi⁄
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

38441 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

38443 
JSVÆue
 
vÆ
;

38444 
p
;

38445 
d
;

38447 
vÆ
 = 
	`js_thisNumbîVÆue
(
˘x
, 
this_vÆ
);

38448 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

38449  
vÆ
;

38450 i‡(
	`JS_ToFlﬂt64Fªe
(
˘x
, &
d
, 
vÆ
))

38451  
JS_EXCEPTION
;

38452 i‡(
	`JS_IsUndeföed
(
¨gv
[0]))

38453 
to_°rög
;

38454 i‡(
	`JS_ToI¡32S©
(
˘x
, &
p
, 
¨gv
[0]))

38455  
JS_EXCEPTION
;

38456 i‡(!
	`isföôe
(
d
)) {

38457 
to_°rög
:

38458  
	`JS_ToSåögFªe
(
˘x
, 
	`__JS_NewFlﬂt64
(˘x, 
d
));

38460 i‡(
p
 < 1 ||Ö > 100)

38461  
	`JS_ThrowR™geEº‹
(
˘x
, "invalidÇumber of digits");

38462  
	`js_dtﬂ
(
˘x
, 
d
, 10, 
p
, 
JS_DTOA_FIXED_FORMAT
);

38463 
	}
}

38465 c⁄° 
JSCFun˘i⁄Li°E¡ry
 
	gjs_numbî_¥Ÿo_funcs
[] = {

38466 
JS_CFUNC_DEF
("toExp⁄ítül", 1, 
js_numbî_toExp⁄ítül
 ),

38467 
JS_CFUNC_DEF
("toFixed", 1, 
js_numbî_toFixed
 ),

38468 
JS_CFUNC_DEF
("toPªcisi⁄", 1, 
js_numbî_toPªcisi⁄
 ),

38469 
JS_CFUNC_MAGIC_DEF
("toSåög", 1, 
js_numbî_toSåög
, 0 ),

38470 
JS_CFUNC_MAGIC_DEF
("toLoˇÀSåög", 0, 
js_numbî_toSåög
, 1 ),

38471 
JS_CFUNC_DEF
("vÆueOf", 0, 
js_numbî_vÆueOf
 ),

38474 
JSVÆue
 
	$js_∑r£I¡
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

38475 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

38477 c⁄° *
°r
, *
p
;

38478 
ødix
, 
Êags
;

38479 
JSVÆue
 
ªt
;

38481 
°r
 = 
	`JS_ToCSåög
(
˘x
, 
¨gv
[0]);

38482 i‡(!
°r
)

38483  
JS_EXCEPTION
;

38484 i‡(
	`JS_ToI¡32
(
˘x
, &
ødix
, 
¨gv
[1])) {

38485 
	`JS_FªeCSåög
(
˘x
, 
°r
);

38486  
JS_EXCEPTION
;

38488 i‡(
ødix
 != 0 && (radix < 2 ||Ñadix > 36)) {

38489 
ªt
 = 
JS_NAN
;

38491 
p
 = 
°r
;

38492 
p
 +
	`skù_•a˚s
(p);

38493 
Êags
 = 
ATOD_INT_ONLY
 | 
ATOD_ACCEPT_PREFIX_AFTER_SIGN
;

38494 
ªt
 = 
	`js_©of
(
˘x
, 
p
, 
NULL
, 
ødix
, 
Êags
);

38496 
	`JS_FªeCSåög
(
˘x
, 
°r
);

38497  
ªt
;

38498 
	}
}

38500 
JSVÆue
 
	$js_∑r£Flﬂt
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

38501 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

38503 c⁄° *
°r
, *
p
;

38504 
JSVÆue
 
ªt
;

38506 
°r
 = 
	`JS_ToCSåög
(
˘x
, 
¨gv
[0]);

38507 i‡(!
°r
)

38508  
JS_EXCEPTION
;

38509 
p
 = 
°r
;

38510 
p
 +
	`skù_•a˚s
(p);

38511 
ªt
 = 
	`js_©of
(
˘x
, 
p
, 
NULL
, 10, 0);

38512 
	`JS_FªeCSåög
(
˘x
, 
°r
);

38513  
ªt
;

38514 
	}
}

38517 
JSVÆue
 
	$js_boﬁón_c⁄°ru˘‹
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
√w_èrgë
,

38518 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

38520 
JSVÆue
 
vÆ
, 
obj
;

38521 
vÆ
 = 
	`JS_NewBoﬁ
(
˘x
, 
	`JS_ToBoﬁ
(˘x, 
¨gv
[0]));

38522 i‡(!
	`JS_IsUndeföed
(
√w_èrgë
)) {

38523 
obj
 = 
	`js_¸óã_‰om_˘‹
(
˘x
, 
√w_èrgë
, 
JS_CLASS_BOOLEAN
);

38524 i‡(!
	`JS_IsEx˚±i⁄
(
obj
))

38525 
	`JS_SëObje˘D©a
(
˘x
, 
obj
, 
vÆ
);

38526  
obj
;

38528  
vÆ
;

38530 
	}
}

38532 
JSVÆue
 
	$js_thisBoﬁónVÆue
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
)

38534 i‡(
	`JS_VALUE_GET_TAG
(
this_vÆ
Ë=
JS_TAG_BOOL
)

38535  
	`JS_DupVÆue
(
˘x
, 
this_vÆ
);

38537 i‡(
	`JS_VALUE_GET_TAG
(
this_vÆ
Ë=
JS_TAG_OBJECT
) {

38538 
JSObje˘
 *
p
 = 
	`JS_VALUE_GET_OBJ
(
this_vÆ
);

38539 i‡(
p
->
˛ass_id
 =
JS_CLASS_BOOLEAN
) {

38540 i‡(
	`JS_VALUE_GET_TAG
(
p
->
u
.
obje˘_d©a
Ë=
JS_TAG_BOOL
)

38541  
p
->
u
.
obje˘_d©a
;

38544  
	`JS_ThrowTy≥Eº‹
(
˘x
, "notá boolean");

38545 
	}
}

38547 
JSVÆue
 
	$js_boﬁón_toSåög
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

38548 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

38550 
JSVÆue
 
vÆ
 = 
	`js_thisBoﬁónVÆue
(
˘x
, 
this_vÆ
);

38551 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

38552  
vÆ
;

38553  
	`JS_AtomToSåög
(
˘x
, 
	`JS_VALUE_GET_BOOL
(
vÆ
) ?

38554 
JS_ATOM_åue
 : 
JS_ATOM_Ál£
);

38555 
	}
}

38557 
JSVÆue
 
	$js_boﬁón_vÆueOf
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

38558 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

38560  
	`js_thisBoﬁónVÆue
(
˘x
, 
this_vÆ
);

38561 
	}
}

38563 c⁄° 
JSCFun˘i⁄Li°E¡ry
 
	gjs_boﬁón_¥Ÿo_funcs
[] = {

38564 
JS_CFUNC_DEF
("toSåög", 0, 
js_boﬁón_toSåög
 ),

38565 
JS_CFUNC_DEF
("vÆueOf", 0, 
js_boﬁón_vÆueOf
 ),

38570 
	$js_°rög_gë_own_¥›îty
(
JSC⁄ãxt
 *
˘x
,

38571 
JSPr›îtyDes¸ùt‹
 *
desc
,

38572 
JSVÆueC⁄°
 
obj
, 
JSAtom
 
¥›
)

38574 
JSObje˘
 *
p
;

38575 
JSSåög
 *
p1
;

38576 
uöt32_t
 
idx
, 
ch
;

38579 i‡(
	`__JS_AtomIsTaggedI¡
(
¥›
)) {

38580 
p
 = 
	`JS_VALUE_GET_OBJ
(
obj
);

38581 i‡(
	`JS_VALUE_GET_TAG
(
p
->
u
.
obje˘_d©a
Ë=
JS_TAG_STRING
) {

38582 
p1
 = 
	`JS_VALUE_GET_STRING
(
p
->
u
.
obje˘_d©a
);

38583 
idx
 = 
	`__JS_AtomToUI¡32
(
¥›
);

38584 i‡(
idx
 < 
p1
->
Àn
) {

38585 i‡(
desc
) {

38586 i‡(
p1
->
is_wide_ch¨
)

38587 
ch
 = 
p1
->
u
.
°r16
[
idx
];

38589 
ch
 = 
p1
->
u
.
°r8
[
idx
];

38590 
desc
->
Êags
 = 
JS_PROP_ENUMERABLE
;

38591 
desc
->
vÆue
 = 
	`js_√w_°rög_ch¨
(
˘x
, 
ch
);

38592 
desc
->
gëãr
 = 
JS_UNDEFINED
;

38593 
desc
->
£âî
 = 
JS_UNDEFINED
;

38595  
TRUE
;

38599  
FALSE
;

38600 
	}
}

38602 
uöt32_t
 
	$js_°rög_obj_gë_Àngth
(
JSC⁄ãxt
 *
˘x
,

38603 
JSVÆueC⁄°
 
obj
)

38605 
JSObje˘
 *
p
;

38606 
JSSåög
 *
p1
;

38607 
uöt32_t
 
Àn
 = 0;

38610 
p
 = 
	`JS_VALUE_GET_OBJ
(
obj
);

38611 i‡(
	`JS_VALUE_GET_TAG
(
p
->
u
.
obje˘_d©a
Ë=
JS_TAG_STRING
) {

38612 
p1
 = 
	`JS_VALUE_GET_STRING
(
p
->
u
.
obje˘_d©a
);

38613 
Àn
 = 
p1
->len;

38615  
Àn
;

38616 
	}
}

38618 
	$js_°rög_gë_own_¥›îty_«mes
(
JSC⁄ãxt
 *
˘x
,

38619 
JSPr›îtyEnum
 **
±ab
,

38620 
uöt32_t
 *
∂í
,

38621 
JSVÆueC⁄°
 
obj
)

38623 
JSPr›îtyEnum
 *
èb
;

38624 
uöt32_t
 
Àn
, 
i
;

38626 
Àn
 = 
	`js_°rög_obj_gë_Àngth
(
˘x
, 
obj
);

38627 
èb
 = 
NULL
;

38628 i‡(
Àn
 > 0) {

38630 
èb
 = 
	`js_mÆloc
(
˘x
, (
JSPr›îtyEnum
Ë* 
Àn
);

38631 i‡(!
èb
)

38633 
i
 = 0; i < 
Àn
; i++) {

38634 
èb
[
i
].
©om
 = 
	`__JS_AtomFromUI¡32
(i);

38637 *
±ab
 = 
èb
;

38638 *
∂í
 = 
Àn
;

38640 
	}
}

38642 
	$js_°rög_deföe_own_¥›îty
(
JSC⁄ãxt
 *
˘x
,

38643 
JSVÆueC⁄°
 
this_obj
,

38644 
JSAtom
 
¥›
, 
JSVÆueC⁄°
 
vÆ
,

38645 
JSVÆueC⁄°
 
gëãr
,

38646 
JSVÆueC⁄°
 
£âî
, 
Êags
)

38648 
uöt32_t
 
idx
;

38649 
JSObje˘
 *
p
;

38650 
JSSåög
 *
p1
, *
p2
;

38652 i‡(
	`__JS_AtomIsTaggedI¡
(
¥›
)) {

38653 
idx
 = 
	`__JS_AtomToUI¡32
(
¥›
);

38654 
p
 = 
	`JS_VALUE_GET_OBJ
(
this_obj
);

38655 i‡(
	`JS_VALUE_GET_TAG
(
p
->
u
.
obje˘_d©a
Ë!
JS_TAG_STRING
)

38656 
def
;

38657 
p1
 = 
	`JS_VALUE_GET_STRING
(
p
->
u
.
obje˘_d©a
);

38658 i‡(
idx
 >
p1
->
Àn
)

38659 
def
;

38660 i‡(!
	`check_deföe_¥›_Êags
(
JS_PROP_ENUMERABLE
, 
Êags
))

38661 
Áû
;

38663 i‡(
Êags
 & 
JS_PROP_HAS_VALUE
) {

38664 i‡(
	`JS_VALUE_GET_TAG
(
vÆ
Ë!
JS_TAG_STRING
)

38665 
Áû
;

38666 
p2
 = 
	`JS_VALUE_GET_STRING
(
vÆ
);

38667 i‡(
p2
->
Àn
 != 1)

38668 
Áû
;

38669 i‡(
	`°rög_gë
(
p1
, 
idx
Ë!°rög_gë(
p2
, 0)) {

38670 
Áû
:

38671  
	`JS_ThrowTy≥Eº‹OrFÆ£
(
˘x
, 
Êags
, "property isÇot configurable");

38674  
TRUE
;

38676 
def
:

38677  
	`JS_DeföePr›îty
(
˘x
, 
this_obj
, 
¥›
, 
vÆ
, 
gëãr
, 
£âî
,

38678 
Êags
 | 
JS_PROP_NO_EXOTIC
);

38680 
	}
}

38682 
	$js_°rög_dñëe_¥›îty
(
JSC⁄ãxt
 *
˘x
,

38683 
JSVÆueC⁄°
 
obj
, 
JSAtom
 
¥›
)

38685 
uöt32_t
 
idx
;

38687 i‡(
	`__JS_AtomIsTaggedI¡
(
¥›
)) {

38688 
idx
 = 
	`__JS_AtomToUI¡32
(
¥›
);

38689 i‡(
idx
 < 
	`js_°rög_obj_gë_Àngth
(
˘x
, 
obj
)) {

38690  
FALSE
;

38693  
TRUE
;

38694 
	}
}

38696 c⁄° 
JSCœssExŸicMëhods
 
	gjs_°rög_exŸic_mëhods
 = {

38697 .
gë_own_¥›îty
 = 
js_°rög_gë_own_¥›îty
,

38698 .
	ggë_own_¥›îty_«mes
 = 
js_°rög_gë_own_¥›îty_«mes
,

38699 .
	gdeföe_own_¥›îty
 = 
js_°rög_deföe_own_¥›îty
,

38700 .
	gdñëe_¥›îty
 = 
js_°rög_dñëe_¥›îty
,

38703 
JSVÆue
 
	$js_°rög_c⁄°ru˘‹
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
√w_èrgë
,

38704 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

38706 
JSVÆue
 
vÆ
, 
obj
;

38707 i‡(
¨gc
 == 0) {

38708 
vÆ
 = 
	`JS_AtomToSåög
(
˘x
, 
JS_ATOM_em±y_°rög
);

38710 i‡(
	`JS_IsUndeföed
(
√w_èrgë
Ë&& 
	`JS_IsSymbﬁ
(
¨gv
[0])) {

38711 
JSAtomSåu˘
 *
p
 = 
	`JS_VALUE_GET_PTR
(
¨gv
[0]);

38712 
vÆ
 = 
	`JS_C⁄ˇtSåög3
(
˘x
, "Symbﬁ(", 
	`JS_AtomToSåög
(˘x, 
	`js_gë_©om_ödex
(˘x->
π
, 
p
)), ")");

38714 
vÆ
 = 
	`JS_ToSåög
(
˘x
, 
¨gv
[0]);

38716 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

38717  
vÆ
;

38719 i‡(!
	`JS_IsUndeföed
(
√w_èrgë
)) {

38720 
JSSåög
 *
p1
 = 
	`JS_VALUE_GET_STRING
(
vÆ
);

38722 
obj
 = 
	`js_¸óã_‰om_˘‹
(
˘x
, 
√w_èrgë
, 
JS_CLASS_STRING
);

38723 i‡(!
	`JS_IsEx˚±i⁄
(
obj
)) {

38724 
	`JS_SëObje˘D©a
(
˘x
, 
obj
, 
vÆ
);

38725 
	`JS_DeföePr›îtyVÆue
(
˘x
, 
obj
, 
JS_ATOM_Àngth
, 
	`JS_NewI¡32
(˘x, 
p1
->
Àn
), 0);

38727  
obj
;

38729  
vÆ
;

38731 
	}
}

38733 
JSVÆue
 
	$js_thisSåögVÆue
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
)

38735 i‡(
	`JS_VALUE_GET_TAG
(
this_vÆ
Ë=
JS_TAG_STRING
)

38736  
	`JS_DupVÆue
(
˘x
, 
this_vÆ
);

38738 i‡(
	`JS_VALUE_GET_TAG
(
this_vÆ
Ë=
JS_TAG_OBJECT
) {

38739 
JSObje˘
 *
p
 = 
	`JS_VALUE_GET_OBJ
(
this_vÆ
);

38740 i‡(
p
->
˛ass_id
 =
JS_CLASS_STRING
) {

38741 i‡(
	`JS_VALUE_GET_TAG
(
p
->
u
.
obje˘_d©a
Ë=
JS_TAG_STRING
)

38742  
	`JS_DupVÆue
(
˘x
, 
p
->
u
.
obje˘_d©a
);

38745  
	`JS_ThrowTy≥Eº‹
(
˘x
, "notá string");

38746 
	}
}

38748 
JSVÆue
 
	$js_°rög_‰omCh¨Code
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

38749 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

38751 
i
;

38752 
SåögBuf„r
 
b_s
, *
b
 = &b_s;

38754 
	`°rög_buf„r_öô
(
˘x
, 
b
, 
¨gc
);

38756 
i
 = 0; i < 
¨gc
; i++) {

38757 
öt32_t
 
c
;

38758 i‡(
	`JS_ToI¡32
(
˘x
, &
c
, 
¨gv
[
i
]Ë|| 
	`°rög_buf„r_putc16
(
b
, c & 0xffff)) {

38759 
	`°rög_buf„r_‰ì
(
b
);

38760  
JS_EXCEPTION
;

38763  
	`°rög_buf„r_íd
(
b
);

38764 
	}
}

38766 
JSVÆue
 
	$js_°rög_‰omCodePoöt
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

38767 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

38769 
d
;

38770 
i
, 
c
;

38771 
SåögBuf„r
 
b_s
, *
b
 = &b_s;

38775 i‡(
	`°rög_buf„r_öô
(
˘x
, 
b
, 
¨gc
))

38776 
Áû
;

38777 
i
 = 0; i < 
¨gc
; i++) {

38778 i‡(
	`JS_VALUE_GET_TAG
(
¨gv
[
i
]Ë=
JS_TAG_INT
) {

38779 
c
 = 
	`JS_VALUE_GET_INT
(
¨gv
[
i
]);

38780 i‡(
c
 < 0 || c > 0x10ffff)

38781 
ønge_îr‹
;

38783 i‡(
	`JS_ToFlﬂt64
(
˘x
, &
d
, 
¨gv
[
i
]))

38784 
Áû
;

38785 i‡(
d
 < 0 || d > 0x10fff‡|| (
c
 = ()d) != d)

38786 
ønge_îr‹
;

38788 i‡(
	`°rög_buf„r_putc
(
b
, 
c
))

38789 
Áû
;

38791  
	`°rög_buf„r_íd
(
b
);

38793 
ønge_îr‹
:

38794 
	`JS_ThrowR™geEº‹
(
˘x
, "invalid codeÖoint");

38795 
Áû
:

38796 
	`°rög_buf„r_‰ì
(
b
);

38797  
JS_EXCEPTION
;

38798 
	}
}

38800 
JSVÆue
 
	$js_°rög_øw
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

38801 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

38804 
JSVÆue
 
cooked
, 
vÆ
, 
øw
;

38805 
SåögBuf„r
 
b_s
, *
b
 = &b_s;

38806 
söt64_t
 
i
, 
n
;

38808 
	`°rög_buf„r_öô
(
˘x
, 
b
, 0);

38809 
øw
 = 
JS_UNDEFINED
;

38810 
cooked
 = 
	`JS_ToObje˘
(
˘x
, 
¨gv
[0]);

38811 i‡(
	`JS_IsEx˚±i⁄
(
cooked
))

38812 
ex˚±i⁄
;

38813 
øw
 = 
	`JS_ToObje˘Fªe
(
˘x
, 
	`JS_GëPr›îty
(˘x, 
cooked
, 
JS_ATOM_øw
));

38814 i‡(
	`JS_IsEx˚±i⁄
(
øw
))

38815 
ex˚±i⁄
;

38816 i‡(
	`js_gë_Àngth64
(
˘x
, &
n
, 
øw
) < 0)

38817 
ex˚±i⁄
;

38819 
i
 = 0; i < 
n
; i++) {

38820 
vÆ
 = 
	`JS_ToSåögFªe
(
˘x
, 
	`JS_GëPr›îtyI¡64
(˘x, 
øw
, 
i
));

38821 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

38822 
ex˚±i⁄
;

38823 
	`°rög_buf„r_c⁄ˇt_vÆue_‰ì
(
b
, 
vÆ
);

38824 i‡(
i
 < 
n
 - 1 && i + 1 < 
¨gc
) {

38825 i‡(
	`°rög_buf„r_c⁄ˇt_vÆue
(
b
, 
¨gv
[
i
 + 1]))

38826 
ex˚±i⁄
;

38829 
	`JS_FªeVÆue
(
˘x
, 
cooked
);

38830 
	`JS_FªeVÆue
(
˘x
, 
øw
);

38831  
	`°rög_buf„r_íd
(
b
);

38833 
ex˚±i⁄
:

38834 
	`JS_FªeVÆue
(
˘x
, 
cooked
);

38835 
	`JS_FªeVÆue
(
˘x
, 
øw
);

38836 
	`°rög_buf„r_‰ì
(
b
);

38837  
JS_EXCEPTION
;

38838 
	}
}

38841 
JSVÆue
 
	$js_°rög_codePoötR™ge
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

38842 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

38844 
uöt32_t
 
°¨t
, 
íd
, 
i
, 
n
;

38845 
SåögBuf„r
 
b_s
, *
b
 = &b_s;

38847 i‡(
	`JS_ToUöt32
(
˘x
, &
°¨t
, 
¨gv
[0]) ||

38848 
	`JS_ToUöt32
(
˘x
, &
íd
, 
¨gv
[1]))

38849  
JS_EXCEPTION
;

38850 
íd
 = 
	`mö_uöt32
(end, 0x10ffff + 1);

38852 i‡(
°¨t
 > 
íd
) {

38853 
°¨t
 = 
íd
;

38855 
n
 = 
íd
 - 
°¨t
;

38856 i‡(
íd
 > 0x10000) {

38857 
n
 +
íd
 - 
	`max_uöt32
(
°¨t
, 0x10000);

38859 i‡(
	`°rög_buf„r_öô2
(
˘x
, 
b
, 
n
, 
íd
 >= 0x100))

38860  
JS_EXCEPTION
;

38861 
i
 = 
°¨t
; i < 
íd
; i++) {

38862 
	`°rög_buf„r_putc
(
b
, 
i
);

38864  
	`°rög_buf„r_íd
(
b
);

38865 
	}
}

38868 
JSVÆue
 
	$js_°rög___isS∑˚
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

38869 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

38871 
c
;

38872 i‡(
	`JS_ToI¡32
(
˘x
, &
c
, 
¨gv
[0]))

38873  
JS_EXCEPTION
;

38874  
	`JS_NewBoﬁ
(
˘x
, 
	`Ãe_is_•a˚
(
c
));

38875 
	}
}

38878 
JSVÆue
 
	$js_°rög_ch¨CodeAt
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

38879 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

38881 
JSVÆue
 
vÆ
, 
ªt
;

38882 
JSSåög
 *
p
;

38883 
idx
, 
c
;

38885 
vÆ
 = 
	`JS_ToSåögCheckObje˘
(
˘x
, 
this_vÆ
);

38886 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

38887  
vÆ
;

38888 
p
 = 
	`JS_VALUE_GET_STRING
(
vÆ
);

38889 i‡(
	`JS_ToI¡32S©
(
˘x
, &
idx
, 
¨gv
[0])) {

38890 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

38891  
JS_EXCEPTION
;

38893 i‡(
idx
 < 0 || idx >
p
->
Àn
) {

38894 
ªt
 = 
JS_NAN
;

38896 i‡(
p
->
is_wide_ch¨
)

38897 
c
 = 
p
->
u
.
°r16
[
idx
];

38899 
c
 = 
p
->
u
.
°r8
[
idx
];

38900 
ªt
 = 
	`JS_NewI¡32
(
˘x
, 
c
);

38902 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

38903  
ªt
;

38904 
	}
}

38906 
JSVÆue
 
	$js_°rög_ch¨At
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

38907 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

38909 
JSVÆue
 
vÆ
, 
ªt
;

38910 
JSSåög
 *
p
;

38911 
idx
, 
c
;

38913 
vÆ
 = 
	`JS_ToSåögCheckObje˘
(
˘x
, 
this_vÆ
);

38914 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

38915  
vÆ
;

38916 
p
 = 
	`JS_VALUE_GET_STRING
(
vÆ
);

38917 i‡(
	`JS_ToI¡32S©
(
˘x
, &
idx
, 
¨gv
[0])) {

38918 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

38919  
JS_EXCEPTION
;

38921 i‡(
idx
 < 0 || idx >
p
->
Àn
) {

38922 
ªt
 = 
	`js_√w_°rög8
(
˘x
, 
NULL
, 0);

38924 i‡(
p
->
is_wide_ch¨
)

38925 
c
 = 
p
->
u
.
°r16
[
idx
];

38927 
c
 = 
p
->
u
.
°r8
[
idx
];

38928 
ªt
 = 
	`js_√w_°rög_ch¨
(
˘x
, 
c
);

38930 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

38931  
ªt
;

38932 
	}
}

38934 
JSVÆue
 
	$js_°rög_codePoötAt
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

38935 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

38937 
JSVÆue
 
vÆ
, 
ªt
;

38938 
JSSåög
 *
p
;

38939 
idx
, 
c
;

38941 
vÆ
 = 
	`JS_ToSåögCheckObje˘
(
˘x
, 
this_vÆ
);

38942 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

38943  
vÆ
;

38944 
p
 = 
	`JS_VALUE_GET_STRING
(
vÆ
);

38945 i‡(
	`JS_ToI¡32S©
(
˘x
, &
idx
, 
¨gv
[0])) {

38946 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

38947  
JS_EXCEPTION
;

38949 i‡(
idx
 < 0 || idx >
p
->
Àn
) {

38950 
ªt
 = 
JS_UNDEFINED
;

38952 
c
 = 
	`°rög_gëc
(
p
, &
idx
);

38953 
ªt
 = 
	`JS_NewI¡32
(
˘x
, 
c
);

38955 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

38956  
ªt
;

38957 
	}
}

38959 
JSVÆue
 
	$js_°rög_c⁄ˇt
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

38960 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

38962 
JSVÆue
 
r
;

38963 
i
;

38968 
r
 = 
	`JS_ToSåögCheckObje˘
(
˘x
, 
this_vÆ
);

38969 
i
 = 0; i < 
¨gc
; i++) {

38970 i‡(
	`JS_IsEx˚±i⁄
(
r
))

38972 
r
 = 
	`JS_C⁄ˇtSåög
(
˘x
,Ñ, 
	`JS_DupVÆue
(˘x, 
¨gv
[
i
]));

38974  
r
;

38975 
	}
}

38977 
	$°rög_cmp
(
JSSåög
 *
p1
, JSSåög *
p2
, 
x1
, 
x2
, 
Àn
)

38979 
i
, 
c1
, 
c2
;

38980 
i
 = 0; i < 
Àn
; i++) {

38981 i‡((
c1
 = 
	`°rög_gë
(
p1
, 
x1
 + 
i
)Ë!(
c2
 = såög_gë(
p2
, 
x2
 + i)))

38982  
c1
 - 
c2
;

38985 
	}
}

38987 
	$°rög_ödexof_ch¨
(
JSSåög
 *
p
, 
c
, 
‰om
)

38990 
i
, 
Àn
 = 
p
->len;

38991 i‡(
p
->
is_wide_ch¨
) {

38992 
i
 = 
‰om
; i < 
Àn
; i++) {

38993 i‡(
p
->
u
.
°r16
[
i
] =
c
)

38994  
i
;

38997 i‡((
c
 & ~0xff) == 0) {

38998 
i
 = 
‰om
; i < 
Àn
; i++) {

38999 i‡(
p
->
u
.
°r8
[
i
] =(
uöt8_t
)
c
)

39000  
i
;

39005 
	}
}

39007 
	$°rög_ödexof
(
JSSåög
 *
p1
, JSSåög *
p2
, 
‰om
)

39010 
c
, 
i
, 
j
, 
Àn1
 = 
p1
->
Àn
, 
Àn2
 = 
p2
->len;

39011 i‡(
Àn2
 == 0)

39012  
‰om
;

39013 
i
 = 
‰om
, 
c
 = 
	`°rög_gë
(
p2
, 0); i + 
Àn2
 <
Àn1
; i = 
j
 + 1) {

39014 
j
 = 
	`°rög_ödexof_ch¨
(
p1
, 
c
, 
i
);

39015 i‡(
j
 < 0 || j + 
Àn2
 > 
Àn1
)

39017 i‡(!
	`°rög_cmp
(
p1
, 
p2
, 
j
 + 1, 1, 
Àn2
 - 1))

39018  
j
;

39021 
	}
}

39023 
söt64_t
 
	$°rög_adv™˚_ödex
(
JSSåög
 *
p
, 
öt64_t
 
ödex
, 
BOOL
 
unicode
)

39025 i‡(!
unicode
 || 
ödex
 >
p
->
Àn
 || !p->
is_wide_ch¨
) {

39026 
ödex
++;

39028 
ödex32
 = ()
ödex
;

39029 
	`°rög_gëc
(
p
, &
ödex32
);

39030 
ödex
 = 
ödex32
;

39032  
ödex
;

39033 
	}
}

39035 
JSVÆue
 
	$js_°rög_ödexOf
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

39036 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
, 
œ°IndexOf
)

39038 
JSVÆue
 
°r
, 
v
;

39039 
i
, 
Àn
, 
v_Àn
, 
pos
, 
°¨t
, 
°›
, 
ªt
, 
öc
;

39040 
JSSåög
 *
p
;

39041 
JSSåög
 *
p1
;

39043 
°r
 = 
	`JS_ToSåögCheckObje˘
(
˘x
, 
this_vÆ
);

39044 i‡(
	`JS_IsEx˚±i⁄
(
°r
))

39045  
°r
;

39046 
v
 = 
	`JS_ToSåög
(
˘x
, 
¨gv
[0]);

39047 i‡(
	`JS_IsEx˚±i⁄
(
v
))

39048 
Áû
;

39049 
p
 = 
	`JS_VALUE_GET_STRING
(
°r
);

39050 
p1
 = 
	`JS_VALUE_GET_STRING
(
v
);

39051 
Àn
 = 
p
->len;

39052 
v_Àn
 = 
p1
->
Àn
;

39053 i‡(
œ°IndexOf
) {

39054 
pos
 = 
Àn
 - 
v_Àn
;

39055 i‡(
¨gc
 > 1) {

39056 
d
;

39057 i‡(
	`JS_ToFlﬂt64
(
˘x
, &
d
, 
¨gv
[1]))

39058 
Áû
;

39059 i‡(!
	`i¢™
(
d
)) {

39060 i‡(
d
 <= 0)

39061 
pos
 = 0;

39062 i‡(
d
 < 
pos
)

39063 
pos
 = 
d
;

39066 
°¨t
 = 
pos
;

39067 
°›
 = 0;

39068 
öc
 = -1;

39070 
pos
 = 0;

39071 i‡(
¨gc
 > 1) {

39072 i‡(
	`JS_ToI¡32Cœmp
(
˘x
, &
pos
, 
¨gv
[1], 0, 
Àn
, 0))

39073 
Áû
;

39075 
°¨t
 = 
pos
;

39076 
°›
 = 
Àn
 - 
v_Àn
;

39077 
öc
 = 1;

39079 
ªt
 = -1;

39080 i‡(
Àn
 >
v_Àn
 && 
öc
 * (
°›
 - 
°¨t
) >= 0) {

39081 
i
 = 
°¨t
;; i +
öc
) {

39082 i‡(!
	`°rög_cmp
(
p
, 
p1
, 
i
, 0, 
v_Àn
)) {

39083 
ªt
 = 
i
;

39086 i‡(
i
 =
°›
)

39090 
	`JS_FªeVÆue
(
˘x
, 
°r
);

39091 
	`JS_FªeVÆue
(
˘x
, 
v
);

39092  
	`JS_NewI¡32
(
˘x
, 
ªt
);

39094 
Áû
:

39095 
	`JS_FªeVÆue
(
˘x
, 
°r
);

39096 
	`JS_FªeVÆue
(
˘x
, 
v
);

39097  
JS_EXCEPTION
;

39098 
	}
}

39101 
js_is_ªgexp
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
obj
);

39103 
JSVÆue
 
	$js_°rög_ö˛udes
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

39104 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
, 
magic
)

39106 
JSVÆue
 
°r
, 
v
 = 
JS_UNDEFINED
;

39107 
i
, 
Àn
, 
v_Àn
, 
pos
, 
°¨t
, 
°›
, 
ªt
;

39108 
JSSåög
 *
p
;

39109 
JSSåög
 *
p1
;

39111 
°r
 = 
	`JS_ToSåögCheckObje˘
(
˘x
, 
this_vÆ
);

39112 i‡(
	`JS_IsEx˚±i⁄
(
°r
))

39113  
°r
;

39114 
ªt
 = 
	`js_is_ªgexp
(
˘x
, 
¨gv
[0]);

39115 i‡(
ªt
) {

39116 i‡(
ªt
 > 0)

39117 
	`JS_ThrowTy≥Eº‹
(
˘x
, "regexÇot supported");

39118 
Áû
;

39120 
v
 = 
	`JS_ToSåög
(
˘x
, 
¨gv
[0]);

39121 i‡(
	`JS_IsEx˚±i⁄
(
v
))

39122 
Áû
;

39123 
p
 = 
	`JS_VALUE_GET_STRING
(
°r
);

39124 
p1
 = 
	`JS_VALUE_GET_STRING
(
v
);

39125 
Àn
 = 
p
->len;

39126 
v_Àn
 = 
p1
->
Àn
;

39127 
pos
 = (
magic
 & 2Ë? 
Àn
 : 0;

39128 i‡(
¨gc
 > 1 && !
	`JS_IsUndeföed
(
¨gv
[1])) {

39129 i‡(
	`JS_ToI¡32Cœmp
(
˘x
, &
pos
, 
¨gv
[1], 0, 
Àn
, 0))

39130 
Áû
;

39132 
Àn
 -
v_Àn
;

39133 
°¨t
 = 
pos
;

39134 
°›
 = 
Àn
;

39135 i‡(
magic
 & 1) {

39136 
°›
 = 
pos
;

39138 i‡(
magic
 & 2) {

39139 
pos
 -
v_Àn
;

39140 
°¨t
 = 
°›
 = 
pos
;

39142 
ªt
 = 0;

39143 i‡(
°¨t
 >0 && sèπ <
°›
) {

39144 
i
 = 
°¨t
;; i++) {

39145 i‡(!
	`°rög_cmp
(
p
, 
p1
, 
i
, 0, 
v_Àn
)) {

39146 
ªt
 = 1;

39149 i‡(
i
 =
°›
)

39153 
	`JS_FªeVÆue
(
˘x
, 
°r
);

39154 
	`JS_FªeVÆue
(
˘x
, 
v
);

39155  
	`JS_NewBoﬁ
(
˘x
, 
ªt
);

39157 
Áû
:

39158 
	`JS_FªeVÆue
(
˘x
, 
°r
);

39159 
	`JS_FªeVÆue
(
˘x
, 
v
);

39160  
JS_EXCEPTION
;

39161 
	}
}

39163 
	$check_ªgexp_g_Êag
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
ªgexp
)

39165 
ªt
;

39166 
JSVÆue
 
Êags
;

39168 
ªt
 = 
	`js_is_ªgexp
(
˘x
, 
ªgexp
);

39169 i‡(
ªt
 < 0)

39171 i‡(
ªt
) {

39172 
Êags
 = 
	`JS_GëPr›îty
(
˘x
, 
ªgexp
, 
JS_ATOM_Êags
);

39173 i‡(
	`JS_IsEx˚±i⁄
(
Êags
))

39175 i‡(
	`JS_IsUndeföed
(
Êags
Ë|| 
	`JS_IsNuŒ
(flags)) {

39176 
	`JS_ThrowTy≥Eº‹
(
˘x
, "cannot convertÅo object");

39179 
Êags
 = 
	`JS_ToSåögFªe
(
˘x
, flags);

39180 i‡(
	`JS_IsEx˚±i⁄
(
Êags
))

39182 
ªt
 = 
	`°rög_ödexof_ch¨
(
	`JS_VALUE_GET_STRING
(
Êags
), 'g', 0);

39183 
	`JS_FªeVÆue
(
˘x
, 
Êags
);

39184 i‡(
ªt
 < 0) {

39185 
	`JS_ThrowTy≥Eº‹
(
˘x
, "regexp must haveÅhe 'g' flag");

39190 
	}
}

39192 
JSVÆue
 
	$js_°rög_m©ch
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

39193 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
, 
©om
)

39197 
JSVÆueC⁄°
 
O
 = 
this_vÆ
, 
ªgexp
 = 
¨gv
[0], 
¨gs
[2];

39198 
JSVÆue
 
m©chî
, 
S
, 
rx
, 
ªsu…
, 
°r
;

39199 
¨gs_Àn
;

39201 i‡(
	`JS_IsUndeföed
(
O
Ë|| 
	`JS_IsNuŒ
(O))

39202  
	`JS_ThrowTy≥Eº‹
(
˘x
, "cannot convertÅo object");

39204 i‡(!
	`JS_IsUndeföed
(
ªgexp
Ë&& !
	`JS_IsNuŒ
(regexp)) {

39205 
m©chî
 = 
	`JS_GëPr›îty
(
˘x
, 
ªgexp
, 
©om
);

39206 i‡(
	`JS_IsEx˚±i⁄
(
m©chî
))

39207  
JS_EXCEPTION
;

39208 i‡(
©om
 =
JS_ATOM_Symbﬁ_m©chAŒ
) {

39209 i‡(
	`check_ªgexp_g_Êag
(
˘x
, 
ªgexp
) < 0) {

39210 
	`JS_FªeVÆue
(
˘x
, 
m©chî
);

39211  
JS_EXCEPTION
;

39214 i‡(!
	`JS_IsUndeföed
(
m©chî
Ë&& !
	`JS_IsNuŒ
(matcher)) {

39215  
	`JS_CÆlFªe
(
˘x
, 
m©chî
, 
ªgexp
, 1, &
O
);

39218 
S
 = 
	`JS_ToSåög
(
˘x
, 
O
);

39219 i‡(
	`JS_IsEx˚±i⁄
(
S
))

39220  
JS_EXCEPTION
;

39221 
¨gs_Àn
 = 1;

39222 
¨gs
[0] = 
ªgexp
;

39223 
°r
 = 
JS_UNDEFINED
;

39224 i‡(
©om
 =
JS_ATOM_Symbﬁ_m©chAŒ
) {

39225 
°r
 = 
	`JS_NewSåög
(
˘x
, "g");

39226 i‡(
	`JS_IsEx˚±i⁄
(
°r
))

39227 
Áû
;

39228 
¨gs
[
¨gs_Àn
++] = (
JSVÆueC⁄°
)
°r
;

39230 
rx
 = 
	`JS_CÆlC⁄°ru˘‹
(
˘x
, ctx->
ªgexp_˘‹
, 
¨gs_Àn
, 
¨gs
);

39231 
	`JS_FªeVÆue
(
˘x
, 
°r
);

39232 i‡(
	`JS_IsEx˚±i⁄
(
rx
)) {

39233 
Áû
:

39234 
	`JS_FªeVÆue
(
˘x
, 
S
);

39235  
JS_EXCEPTION
;

39237 
ªsu…
 = 
	`JS_InvokeFªe
(
˘x
, 
rx
, 
©om
, 1, (
JSVÆueC⁄°
 *)&
S
);

39238 
	`JS_FªeVÆue
(
˘x
, 
S
);

39239  
ªsu…
;

39240 
	}
}

39242 
JSVÆue
 
	$js_°rög___GëSub°ôuti⁄
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

39243 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

39246 
JSVÆueC⁄°
 
m©ched
, 
°r
, 
ˇ±uªs
, 
«medC≠tuªs
, 
ªp
;

39247 
JSVÆue
 
ˇ±uª
, 
«me
, 
s
;

39248 
uöt32_t
 
posôi⁄
, 
Àn
, 
m©ched_Àn
, 
ˇ±uªs_Àn
;

39249 
i
, 
j
, 
j0
, 
k
, 
k1
;

39250 
c
, 
c1
;

39251 
SåögBuf„r
 
b_s
, *
b
 = &b_s;

39252 
JSSåög
 *
•
, *
Ω
;

39254 
m©ched
 = 
¨gv
[0];

39255 
°r
 = 
¨gv
[1];

39256 
ˇ±uªs
 = 
¨gv
[3];

39257 
«medC≠tuªs
 = 
¨gv
[4];

39258 
ªp
 = 
¨gv
[5];

39260 i‡(!
	`JS_IsSåög
(
ªp
Ë|| !JS_IsSåög(
°r
))

39261  
	`JS_ThrowTy≥Eº‹
(
˘x
, "notá string");

39263 
•
 = 
	`JS_VALUE_GET_STRING
(
°r
);

39264 
Ω
 = 
	`JS_VALUE_GET_STRING
(
ªp
);

39266 
	`°rög_buf„r_öô
(
˘x
, 
b
, 0);

39268 
ˇ±uªs_Àn
 = 0;

39269 i‡(!
	`JS_IsUndeföed
(
ˇ±uªs
)) {

39270 i‡(
	`js_gë_Àngth32
(
˘x
, &
ˇ±uªs_Àn
, 
ˇ±uªs
))

39271 
ex˚±i⁄
;

39273 i‡(
	`js_gë_Àngth32
(
˘x
, &
m©ched_Àn
, 
m©ched
))

39274 
ex˚±i⁄
;

39275 i‡(
	`JS_ToUöt32
(
˘x
, &
posôi⁄
, 
¨gv
[2]) < 0)

39276 
ex˚±i⁄
;

39278 
Àn
 = 
Ω
->len;

39279 
i
 = 0;

39281 
j
 = 
	`°rög_ödexof_ch¨
(
Ω
, '$', 
i
);

39282 i‡(
j
 < 0 || j + 1 >
Àn
)

39284 
	`°rög_buf„r_c⁄ˇt
(
b
, 
Ω
, 
i
, 
j
);

39285 
j0
 = 
j
++;

39286 
c
 = 
	`°rög_gë
(
Ω
, 
j
++);

39287 i‡(
c
 == '$') {

39288 
	`°rög_buf„r_putc8
(
b
, '$');

39289 } i‡(
c
 == '&') {

39290 i‡(
	`°rög_buf„r_c⁄ˇt_vÆue
(
b
, 
m©ched
))

39291 
ex˚±i⁄
;

39292 } i‡(
c
 == '`') {

39293 
	`°rög_buf„r_c⁄ˇt
(
b
, 
•
, 0, 
posôi⁄
);

39294 } i‡(
c
 == '\'') {

39295 
	`°rög_buf„r_c⁄ˇt
(
b
, 
•
, 
posôi⁄
 + 
m©ched_Àn
, sp->
Àn
);

39296 } i‡(
c
 >= '0' && c <= '9') {

39297 
k
 = 
c
 - '0';

39298 
c1
 = 
	`°rög_gë
(
Ω
, 
j
);

39299 i‡(
c1
 >= '0' && c1 <= '9') {

39303 
k1
 = 
k
 * 10 + 
c1
 - '0';

39304 i‡(
k1
 >1 && k1 < 
ˇ±uªs_Àn
) {

39305 
k
 = 
k1
;

39306 
j
++;

39309 i‡(
k
 >1 && k < 
ˇ±uªs_Àn
) {

39310 
s
 = 
	`JS_GëPr›îtyI¡64
(
˘x
, 
ˇ±uªs
, 
k
);

39311 i‡(
	`JS_IsEx˚±i⁄
(
s
))

39312 
ex˚±i⁄
;

39313 i‡(!
	`JS_IsUndeföed
(
s
)) {

39314 i‡(
	`°rög_buf„r_c⁄ˇt_vÆue_‰ì
(
b
, 
s
))

39315 
ex˚±i⁄
;

39318 
n‹ï
;

39320 } i‡(
c
 ='<' && !
	`JS_IsUndeföed
(
«medC≠tuªs
)) {

39321 
k
 = 
	`°rög_ödexof_ch¨
(
Ω
, '>', 
j
);

39322 i‡(
k
 < 0)

39323 
n‹ï
;

39324 
«me
 = 
	`js_sub_°rög
(
˘x
, 
Ω
, 
j
, 
k
);

39325 i‡(
	`JS_IsEx˚±i⁄
(
«me
))

39326 
ex˚±i⁄
;

39327 
ˇ±uª
 = 
	`JS_GëPr›îtyVÆue
(
˘x
, 
«medC≠tuªs
, 
«me
);

39328 i‡(
	`JS_IsEx˚±i⁄
(
ˇ±uª
))

39329 
ex˚±i⁄
;

39330 i‡(!
	`JS_IsUndeföed
(
ˇ±uª
)) {

39331 i‡(
	`°rög_buf„r_c⁄ˇt_vÆue_‰ì
(
b
, 
ˇ±uª
))

39332 
ex˚±i⁄
;

39334 
j
 = 
k
 + 1;

39336 
n‹ï
:

39337 
	`°rög_buf„r_c⁄ˇt
(
b
, 
Ω
, 
j0
, 
j
);

39339 
i
 = 
j
;

39341 
	`°rög_buf„r_c⁄ˇt
(
b
, 
Ω
, 
i
,Ñp->
Àn
);

39342  
	`°rög_buf„r_íd
(
b
);

39343 
ex˚±i⁄
:

39344 
	`°rög_buf„r_‰ì
(
b
);

39345  
JS_EXCEPTION
;

39346 
	}
}

39348 
JSVÆue
 
	$js_°rög_ª∂a˚
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

39349 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
,

39350 
is_ª∂a˚AŒ
)

39353 
JSVÆueC⁄°
 
O
 = 
this_vÆ
, 
£¨chVÆue
 = 
¨gv
[0], 
ª∂a˚VÆue
 =árgv[1];

39354 
JSVÆueC⁄°
 
¨gs
[6];

39355 
JSVÆue
 
°r
, 
£¨ch_°r
, 
ª∂a˚VÆue_°r
, 
ª∂_°r
;

39356 
JSSåög
 *
•
, *
£¨chp
;

39357 
SåögBuf„r
 
b_s
, *
b
 = &b_s;

39358 
pos
, 
fun˘i⁄ÆRïœ˚
, 
ídOfLa°M©ch
;

39359 
BOOL
 
is_fú°
;

39361 i‡(
	`JS_IsUndeföed
(
O
Ë|| 
	`JS_IsNuŒ
(O))

39362  
	`JS_ThrowTy≥Eº‹
(
˘x
, "cannot convertÅo object");

39364 
£¨ch_°r
 = 
JS_UNDEFINED
;

39365 
ª∂a˚VÆue_°r
 = 
JS_UNDEFINED
;

39366 
ª∂_°r
 = 
JS_UNDEFINED
;

39368 i‡(!
	`JS_IsUndeföed
(
£¨chVÆue
Ë&& !
	`JS_IsNuŒ
(searchValue)) {

39369 
JSVÆue
 
ª∂a˚r
;

39370 i‡(
is_ª∂a˚AŒ
) {

39371 i‡(
	`check_ªgexp_g_Êag
(
˘x
, 
£¨chVÆue
) < 0)

39372  
JS_EXCEPTION
;

39374 
ª∂a˚r
 = 
	`JS_GëPr›îty
(
˘x
, 
£¨chVÆue
, 
JS_ATOM_Symbﬁ_ª∂a˚
);

39375 i‡(
	`JS_IsEx˚±i⁄
(
ª∂a˚r
))

39376  
JS_EXCEPTION
;

39377 i‡(!
	`JS_IsUndeföed
(
ª∂a˚r
Ë&& !
	`JS_IsNuŒ
(replacer)) {

39378 
¨gs
[0] = 
O
;

39379 
¨gs
[1] = 
ª∂a˚VÆue
;

39380  
	`JS_CÆlFªe
(
˘x
, 
ª∂a˚r
, 
£¨chVÆue
, 2, 
¨gs
);

39383 
	`°rög_buf„r_öô
(
˘x
, 
b
, 0);

39385 
°r
 = 
	`JS_ToSåög
(
˘x
, 
O
);

39386 i‡(
	`JS_IsEx˚±i⁄
(
°r
))

39387 
ex˚±i⁄
;

39388 
£¨ch_°r
 = 
	`JS_ToSåög
(
˘x
, 
£¨chVÆue
);

39389 i‡(
	`JS_IsEx˚±i⁄
(
£¨ch_°r
))

39390 
ex˚±i⁄
;

39391 
fun˘i⁄ÆRïœ˚
 = 
	`JS_IsFun˘i⁄
(
˘x
, 
ª∂a˚VÆue
);

39392 i‡(!
fun˘i⁄ÆRïœ˚
) {

39393 
ª∂a˚VÆue_°r
 = 
	`JS_ToSåög
(
˘x
, 
ª∂a˚VÆue
);

39394 i‡(
	`JS_IsEx˚±i⁄
(
ª∂a˚VÆue_°r
))

39395 
ex˚±i⁄
;

39398 
•
 = 
	`JS_VALUE_GET_STRING
(
°r
);

39399 
£¨chp
 = 
	`JS_VALUE_GET_STRING
(
£¨ch_°r
);

39400 
ídOfLa°M©ch
 = 0;

39401 
is_fú°
 = 
TRUE
;

39403 i‡(
	`u∆ikñy
(
£¨chp
->
Àn
 == 0)) {

39404 i‡(
is_fú°
)

39405 
pos
 = 0;

39406 i‡(
ídOfLa°M©ch
 >
•
->
Àn
)

39407 
pos
 = -1;

39409 
pos
 = 
ídOfLa°M©ch
 + 1;

39411 
pos
 = 
	`°rög_ödexof
(
•
, 
£¨chp
, 
ídOfLa°M©ch
);

39413 i‡(
pos
 < 0) {

39414 i‡(
is_fú°
) {

39415 
	`°rög_buf„r_‰ì
(
b
);

39416 
	`JS_FªeVÆue
(
˘x
, 
£¨ch_°r
);

39417 
	`JS_FªeVÆue
(
˘x
, 
ª∂a˚VÆue_°r
);

39418  
°r
;

39423 i‡(
fun˘i⁄ÆRïœ˚
) {

39424 
¨gs
[0] = 
£¨ch_°r
;

39425 
¨gs
[1] = 
	`JS_NewI¡32
(
˘x
, 
pos
);

39426 
¨gs
[2] = 
°r
;

39427 
ª∂_°r
 = 
	`JS_ToSåögFªe
(
˘x
, 
	`JS_CÆl
(˘x, 
ª∂a˚VÆue
, 
JS_UNDEFINED
, 3, 
¨gs
));

39429 
¨gs
[0] = 
£¨ch_°r
;

39430 
¨gs
[1] = 
°r
;

39431 
¨gs
[2] = 
	`JS_NewI¡32
(
˘x
, 
pos
);

39432 
¨gs
[3] = 
JS_UNDEFINED
;

39433 
¨gs
[4] = 
JS_UNDEFINED
;

39434 
¨gs
[5] = 
ª∂a˚VÆue_°r
;

39435 
ª∂_°r
 = 
	`js_°rög___GëSub°ôuti⁄
(
˘x
, 
JS_UNDEFINED
, 6, 
¨gs
);

39437 i‡(
	`JS_IsEx˚±i⁄
(
ª∂_°r
))

39438 
ex˚±i⁄
;

39440 
	`°rög_buf„r_c⁄ˇt
(
b
, 
•
, 
ídOfLa°M©ch
, 
pos
);

39441 
	`°rög_buf„r_c⁄ˇt_vÆue_‰ì
(
b
, 
ª∂_°r
);

39442 
ídOfLa°M©ch
 = 
pos
 + 
£¨chp
->
Àn
;

39443 
is_fú°
 = 
FALSE
;

39444 i‡(!
is_ª∂a˚AŒ
)

39447 
	`°rög_buf„r_c⁄ˇt
(
b
, 
•
, 
ídOfLa°M©ch
, sp->
Àn
);

39448 
	`JS_FªeVÆue
(
˘x
, 
£¨ch_°r
);

39449 
	`JS_FªeVÆue
(
˘x
, 
ª∂a˚VÆue_°r
);

39450 
	`JS_FªeVÆue
(
˘x
, 
°r
);

39451  
	`°rög_buf„r_íd
(
b
);

39453 
ex˚±i⁄
:

39454 
	`°rög_buf„r_‰ì
(
b
);

39455 
	`JS_FªeVÆue
(
˘x
, 
£¨ch_°r
);

39456 
	`JS_FªeVÆue
(
˘x
, 
ª∂a˚VÆue_°r
);

39457 
	`JS_FªeVÆue
(
˘x
, 
°r
);

39458  
JS_EXCEPTION
;

39459 
	}
}

39461 
JSVÆue
 
	$js_°rög_•lô
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

39462 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

39465 
JSVÆueC⁄°
 
O
 = 
this_vÆ
, 
£∑øt‹
 = 
¨gv
[0], 
limô
 =árgv[1];

39466 
JSVÆueC⁄°
 
¨gs
[2];

39467 
JSVÆue
 
S
, 
A
, 
R
, 
T
;

39468 
uöt32_t
 
lim
, 
ÀngthA
;

39469 
söt64_t
 
p
, 
q
, 
s
, 
r
, 
e
;

39470 
JSSåög
 *
•
, *
Ω
;

39472 i‡(
	`JS_IsUndeföed
(
O
Ë|| 
	`JS_IsNuŒ
(O))

39473  
	`JS_ThrowTy≥Eº‹
(
˘x
, "cannot convertÅo object");

39475 
S
 = 
JS_UNDEFINED
;

39476 
A
 = 
JS_UNDEFINED
;

39477 
R
 = 
JS_UNDEFINED
;

39479 i‡(!
	`JS_IsUndeföed
(
£∑øt‹
Ë&& !
	`JS_IsNuŒ
(separator)) {

39480 
JSVÆue
 
•lôãr
;

39481 
•lôãr
 = 
	`JS_GëPr›îty
(
˘x
, 
£∑øt‹
, 
JS_ATOM_Symbﬁ_•lô
);

39482 i‡(
	`JS_IsEx˚±i⁄
(
•lôãr
))

39483  
JS_EXCEPTION
;

39484 i‡(!
	`JS_IsUndeföed
(
•lôãr
Ë&& !
	`JS_IsNuŒ
(splitter)) {

39485 
¨gs
[0] = 
O
;

39486 
¨gs
[1] = 
limô
;

39487  
	`JS_CÆlFªe
(
˘x
, 
•lôãr
, 
£∑øt‹
, 2, 
¨gs
);

39490 
S
 = 
	`JS_ToSåög
(
˘x
, 
O
);

39491 i‡(
	`JS_IsEx˚±i⁄
(
S
))

39492 
ex˚±i⁄
;

39493 
A
 = 
	`JS_NewAºay
(
˘x
);

39494 i‡(
	`JS_IsEx˚±i⁄
(
A
))

39495 
ex˚±i⁄
;

39496 
ÀngthA
 = 0;

39497 i‡(
	`JS_IsUndeföed
(
limô
)) {

39498 
lim
 = 0xffffffff;

39500 i‡(
	`JS_ToUöt32
(
˘x
, &
lim
, 
limô
) < 0)

39501 
ex˚±i⁄
;

39503 
•
 = 
	`JS_VALUE_GET_STRING
(
S
);

39504 
s
 = 
•
->
Àn
;

39505 
R
 = 
	`JS_ToSåög
(
˘x
, 
£∑øt‹
);

39506 i‡(
	`JS_IsEx˚±i⁄
(
R
))

39507 
ex˚±i⁄
;

39508 
Ω
 = 
	`JS_VALUE_GET_STRING
(
R
);

39509 
r
 = 
Ω
->
Àn
;

39510 
p
 = 0;

39511 i‡(
lim
 == 0)

39512 
d⁄e
;

39513 i‡(
	`JS_IsUndeföed
(
£∑øt‹
))

39514 
add_èû
;

39515 i‡(
s
 == 0) {

39516 i‡(
r
 != 0)

39517 
add_èû
;

39518 
d⁄e
;

39520 
q
 = 
p
;

39521 
q
 = 
p
; (q +!
r
Ë<
s
 -Ñ - !r; q =Ö = 
e
 +Ñ) {

39522 
e
 = 
	`°rög_ödexof
(
•
, 
Ω
, 
q
);

39523 i‡(
e
 < 0)

39525 
T
 = 
	`js_sub_°rög
(
˘x
, 
•
, 
p
, 
e
);

39526 i‡(
	`JS_IsEx˚±i⁄
(
T
))

39527 
ex˚±i⁄
;

39528 i‡(
	`JS_Cª©eD©aPr›îtyUöt32
(
˘x
, 
A
, 
ÀngthA
++, 
T
, 0) < 0)

39529 
ex˚±i⁄
;

39530 i‡(
ÀngthA
 =
lim
)

39531 
d⁄e
;

39533 
add_èû
:

39534 
T
 = 
	`js_sub_°rög
(
˘x
, 
•
, 
p
, 
s
);

39535 i‡(
	`JS_IsEx˚±i⁄
(
T
))

39536 
ex˚±i⁄
;

39537 i‡(
	`JS_Cª©eD©aPr›îtyUöt32
(
˘x
, 
A
, 
ÀngthA
++, 
T
,0 ) < 0)

39538 
ex˚±i⁄
;

39539 
d⁄e
:

39540 
	`JS_FªeVÆue
(
˘x
, 
S
);

39541 
	`JS_FªeVÆue
(
˘x
, 
R
);

39542  
A
;

39544 
ex˚±i⁄
:

39545 
	`JS_FªeVÆue
(
˘x
, 
A
);

39546 
	`JS_FªeVÆue
(
˘x
, 
S
);

39547 
	`JS_FªeVÆue
(
˘x
, 
R
);

39548  
JS_EXCEPTION
;

39549 
	}
}

39551 
JSVÆue
 
	$js_°rög_sub°rög
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

39552 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

39554 
JSVÆue
 
°r
, 
ªt
;

39555 
a
, 
b
, 
°¨t
, 
íd
;

39556 
JSSåög
 *
p
;

39558 
°r
 = 
	`JS_ToSåögCheckObje˘
(
˘x
, 
this_vÆ
);

39559 i‡(
	`JS_IsEx˚±i⁄
(
°r
))

39560  
°r
;

39561 
p
 = 
	`JS_VALUE_GET_STRING
(
°r
);

39562 i‡(
	`JS_ToI¡32Cœmp
(
˘x
, &
a
, 
¨gv
[0], 0, 
p
->
Àn
, 0)) {

39563 
	`JS_FªeVÆue
(
˘x
, 
°r
);

39564  
JS_EXCEPTION
;

39566 
b
 = 
p
->
Àn
;

39567 i‡(!
	`JS_IsUndeföed
(
¨gv
[1])) {

39568 i‡(
	`JS_ToI¡32Cœmp
(
˘x
, &
b
, 
¨gv
[1], 0, 
p
->
Àn
, 0)) {

39569 
	`JS_FªeVÆue
(
˘x
, 
°r
);

39570  
JS_EXCEPTION
;

39573 i‡(
a
 < 
b
) {

39574 
°¨t
 = 
a
;

39575 
íd
 = 
b
;

39577 
°¨t
 = 
b
;

39578 
íd
 = 
a
;

39580 
ªt
 = 
	`js_sub_°rög
(
˘x
, 
p
, 
°¨t
, 
íd
);

39581 
	`JS_FªeVÆue
(
˘x
, 
°r
);

39582  
ªt
;

39583 
	}
}

39585 
JSVÆue
 
	$js_°rög_sub°r
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

39586 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

39588 
JSVÆue
 
°r
, 
ªt
;

39589 
a
, 
Àn
, 
n
;

39590 
JSSåög
 *
p
;

39592 
°r
 = 
	`JS_ToSåögCheckObje˘
(
˘x
, 
this_vÆ
);

39593 i‡(
	`JS_IsEx˚±i⁄
(
°r
))

39594  
°r
;

39595 
p
 = 
	`JS_VALUE_GET_STRING
(
°r
);

39596 
Àn
 = 
p
->len;

39597 i‡(
	`JS_ToI¡32Cœmp
(
˘x
, &
a
, 
¨gv
[0], 0, 
Àn
,Üen)) {

39598 
	`JS_FªeVÆue
(
˘x
, 
°r
);

39599  
JS_EXCEPTION
;

39601 
n
 = 
Àn
 - 
a
;

39602 i‡(!
	`JS_IsUndeföed
(
¨gv
[1])) {

39603 i‡(
	`JS_ToI¡32Cœmp
(
˘x
, &
n
, 
¨gv
[1], 0, 
Àn
 - 
a
, 0)) {

39604 
	`JS_FªeVÆue
(
˘x
, 
°r
);

39605  
JS_EXCEPTION
;

39608 
ªt
 = 
	`js_sub_°rög
(
˘x
, 
p
, 
a
,á + 
n
);

39609 
	`JS_FªeVÆue
(
˘x
, 
°r
);

39610  
ªt
;

39611 
	}
}

39613 
JSVÆue
 
	$js_°rög_¶i˚
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

39614 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

39616 
JSVÆue
 
°r
, 
ªt
;

39617 
Àn
, 
°¨t
, 
íd
;

39618 
JSSåög
 *
p
;

39620 
°r
 = 
	`JS_ToSåögCheckObje˘
(
˘x
, 
this_vÆ
);

39621 i‡(
	`JS_IsEx˚±i⁄
(
°r
))

39622  
°r
;

39623 
p
 = 
	`JS_VALUE_GET_STRING
(
°r
);

39624 
Àn
 = 
p
->len;

39625 i‡(
	`JS_ToI¡32Cœmp
(
˘x
, &
°¨t
, 
¨gv
[0], 0, 
Àn
,Üen)) {

39626 
	`JS_FªeVÆue
(
˘x
, 
°r
);

39627  
JS_EXCEPTION
;

39629 
íd
 = 
Àn
;

39630 i‡(!
	`JS_IsUndeföed
(
¨gv
[1])) {

39631 i‡(
	`JS_ToI¡32Cœmp
(
˘x
, &
íd
, 
¨gv
[1], 0, 
Àn
,Üen)) {

39632 
	`JS_FªeVÆue
(
˘x
, 
°r
);

39633  
JS_EXCEPTION
;

39636 
ªt
 = 
	`js_sub_°rög
(
˘x
, 
p
, 
°¨t
, 
	`max_öt
(
íd
, start));

39637 
	`JS_FªeVÆue
(
˘x
, 
°r
);

39638  
ªt
;

39639 
	}
}

39641 
JSVÆue
 
	$js_°rög_∑d
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

39642 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
, 
∑dEnd
)

39644 
JSVÆue
 
°r
, 
v
 = 
JS_UNDEFINED
;

39645 
SåögBuf„r
 
b_s
, *
b
 = &b_s;

39646 
JSSåög
 *
p
, *
p1
 = 
NULL
;

39647 
n
, 
Àn
, 
c
 = ' ';

39649 
°r
 = 
	`JS_ToSåögCheckObje˘
(
˘x
, 
this_vÆ
);

39650 i‡(
	`JS_IsEx˚±i⁄
(
°r
))

39651 
Áû1
;

39652 i‡(
	`JS_ToI¡32S©
(
˘x
, &
n
, 
¨gv
[0]))

39653 
Áû2
;

39654 
p
 = 
	`JS_VALUE_GET_STRING
(
°r
);

39655 
Àn
 = 
p
->len;

39656 i‡(
Àn
 >
n
)

39657  
°r
;

39658 i‡(
n
 > 
JS_STRING_LEN_MAX
) {

39659 
	`JS_ThrowI¡î«lEº‹
(
˘x
, "stringÅooÜong");

39660 
Áû2
;

39662 i‡(
¨gc
 > 1 && !
	`JS_IsUndeföed
(
¨gv
[1])) {

39663 
v
 = 
	`JS_ToSåög
(
˘x
, 
¨gv
[1]);

39664 i‡(
	`JS_IsEx˚±i⁄
(
v
))

39665 
Áû2
;

39666 
p1
 = 
	`JS_VALUE_GET_STRING
(
v
);

39667 i‡(
p1
->
Àn
 == 0) {

39668 
	`JS_FªeVÆue
(
˘x
, 
v
);

39669  
°r
;

39671 i‡(
p1
->
Àn
 == 1) {

39672 
c
 = 
	`°rög_gë
(
p1
, 0);

39673 
p1
 = 
NULL
;

39676 i‡(
	`°rög_buf„r_öô
(
˘x
, 
b
, 
n
))

39677 
Áû3
;

39678 
n
 -
Àn
;

39679 i‡(
∑dEnd
) {

39680 i‡(
	`°rög_buf„r_c⁄ˇt
(
b
, 
p
, 0, 
Àn
))

39681 
Áû
;

39683 i‡(
p1
) {

39684 
n
 > 0) {

39685 
chunk
 = 
	`mö_öt
(
n
, 
p1
->
Àn
);

39686 i‡(
	`°rög_buf„r_c⁄ˇt
(
b
, 
p1
, 0, 
chunk
))

39687 
Áû
;

39688 
n
 -
chunk
;

39691 i‡(
	`°rög_buf„r_fûl
(
b
, 
c
, 
n
))

39692 
Áû
;

39694 i‡(!
∑dEnd
) {

39695 i‡(
	`°rög_buf„r_c⁄ˇt
(
b
, 
p
, 0, 
Àn
))

39696 
Áû
;

39698 
	`JS_FªeVÆue
(
˘x
, 
v
);

39699 
	`JS_FªeVÆue
(
˘x
, 
°r
);

39700  
	`°rög_buf„r_íd
(
b
);

39702 
Áû
:

39703 
	`°rög_buf„r_‰ì
(
b
);

39704 
Áû3
:

39705 
	`JS_FªeVÆue
(
˘x
, 
v
);

39706 
Áû2
:

39707 
	`JS_FªeVÆue
(
˘x
, 
°r
);

39708 
Áû1
:

39709  
JS_EXCEPTION
;

39710 
	}
}

39712 
JSVÆue
 
	$js_°rög_ª≥©
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

39713 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

39715 
JSVÆue
 
°r
;

39716 
SåögBuf„r
 
b_s
, *
b
 = &b_s;

39717 
JSSåög
 *
p
;

39718 
söt64_t
 
vÆ
;

39719 
n
, 
Àn
;

39721 
°r
 = 
	`JS_ToSåögCheckObje˘
(
˘x
, 
this_vÆ
);

39722 i‡(
	`JS_IsEx˚±i⁄
(
°r
))

39723 
Áû
;

39724 i‡(
	`JS_ToI¡64S©
(
˘x
, &
vÆ
, 
¨gv
[0]))

39725 
Áû
;

39726 i‡(
vÆ
 < 0 || val > 2147483647) {

39727 
	`JS_ThrowR™geEº‹
(
˘x
, "invalidÑepeat count");

39728 
Áû
;

39730 
n
 = 
vÆ
;

39731 
p
 = 
	`JS_VALUE_GET_STRING
(
°r
);

39732 
Àn
 = 
p
->len;

39733 i‡(
Àn
 =0 || 
n
 == 1)

39734  
°r
;

39735 i‡(
vÆ
 * 
Àn
 > 
JS_STRING_LEN_MAX
) {

39736 
	`JS_ThrowI¡î«lEº‹
(
˘x
, "stringÅooÜong");

39737 
Áû
;

39739 i‡(
	`°rög_buf„r_öô2
(
˘x
, 
b
, 
n
 * 
Àn
, 
p
->
is_wide_ch¨
))

39740 
Áû
;

39741 i‡(
Àn
 == 1) {

39742 
	`°rög_buf„r_fûl
(
b
, 
	`°rög_gë
(
p
, 0), 
n
);

39744 
n
-- > 0) {

39745 
	`°rög_buf„r_c⁄ˇt
(
b
, 
p
, 0, 
Àn
);

39748 
	`JS_FªeVÆue
(
˘x
, 
°r
);

39749  
	`°rög_buf„r_íd
(
b
);

39751 
Áû
:

39752 
	`JS_FªeVÆue
(
˘x
, 
°r
);

39753  
JS_EXCEPTION
;

39754 
	}
}

39756 
JSVÆue
 
	$js_°rög_åim
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

39757 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
, 
magic
)

39759 
JSVÆue
 
°r
, 
ªt
;

39760 
a
, 
b
, 
Àn
;

39761 
JSSåög
 *
p
;

39763 
°r
 = 
	`JS_ToSåögCheckObje˘
(
˘x
, 
this_vÆ
);

39764 i‡(
	`JS_IsEx˚±i⁄
(
°r
))

39765  
°r
;

39766 
p
 = 
	`JS_VALUE_GET_STRING
(
°r
);

39767 
a
 = 0;

39768 
b
 = 
Àn
 = 
p
->len;

39769 i‡(
magic
 & 1) {

39770 
a
 < 
Àn
 && 
	`Ãe_is_•a˚
(
	`°rög_gë
(
p
,á)))

39771 
a
++;

39773 i‡(
magic
 & 2) {

39774 
b
 > 
a
 && 
	`Ãe_is_•a˚
(
	`°rög_gë
(
p
, b - 1)))

39775 
b
--;

39777 
ªt
 = 
	`js_sub_°rög
(
˘x
, 
p
, 
a
, 
b
);

39778 
	`JS_FªeVÆue
(
˘x
, 
°r
);

39779  
ªt
;

39780 
	}
}

39782 
JSVÆue
 
	$js_°rög___quŸe
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

39783 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

39785  
	`JS_ToQuŸedSåög
(
˘x
, 
this_vÆ
);

39786 
	}
}

39789 
	$°rög_¥evc
(
JSSåög
 *
p
, *
pidx
)

39791 
idx
, 
c
, 
c1
;

39793 
idx
 = *
pidx
;

39794 i‡(
idx
 <= 0)

39796 
idx
--;

39797 i‡(
p
->
is_wide_ch¨
) {

39798 
c
 = 
p
->
u
.
°r16
[
idx
];

39799 i‡(
c
 >0xdc00 && c < 0xe000 && 
idx
 > 0) {

39800 
c1
 = 
p
->
u
.
°r16
[
idx
 - 1];

39801 i‡(
c1
 >= 0xd800 && c1 <= 0xdc00) {

39802 
c
 = (((
c1
 & 0x3ff) << 10) | (c & 0x3ff)) + 0x10000;

39803 
idx
--;

39807 
c
 = 
p
->
u
.
°r8
[
idx
];

39809 *
pidx
 = 
idx
;

39810  
c
;

39811 
	}
}

39813 
BOOL
 
	$ã°_föÆ_sigma
(
JSSåög
 *
p
, 
sigma_pos
)

39815 
k
, 
c1
;

39819 
k
 = 
sigma_pos
;

39821 
c1
 = 
	`°rög_¥evc
(
p
, &
k
);

39822 i‡(!
	`Ãe_is_ˇ£_ign‹abÀ
(
c1
))

39825 i‡(!
	`Ãe_is_ˇ£d
(
c1
))

39826  
FALSE
;

39830 
k
 = 
sigma_pos
 + 1;

39832 i‡(
k
 >
p
->
Àn
)

39833  
TRUE
;

39834 
c1
 = 
	`°rög_gëc
(
p
, &
k
);

39835 i‡(!
	`Ãe_is_ˇ£_ign‹abÀ
(
c1
))

39838  !
	`Ãe_is_ˇ£d
(
c1
);

39839 
	}
}

39841 
JSVÆue
 
	$js_°rög_loˇÀCom∑ª
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

39842 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

39844 
JSVÆue
 
a
, 
b
;

39845 
cmp
;

39847 
a
 = 
	`JS_ToSåögCheckObje˘
(
˘x
, 
this_vÆ
);

39848 i‡(
	`JS_IsEx˚±i⁄
(
a
))

39849  
JS_EXCEPTION
;

39850 
b
 = 
	`JS_ToSåög
(
˘x
, 
¨gv
[0]);

39851 i‡(
	`JS_IsEx˚±i⁄
(
b
)) {

39852 
	`JS_FªeVÆue
(
˘x
, 
a
);

39853  
JS_EXCEPTION
;

39855 
cmp
 = 
	`js_°rög_com∑ª
(
˘x
, 
	`JS_VALUE_GET_STRING
(
a
), JS_VALUE_GET_STRING(
b
));

39856 
	`JS_FªeVÆue
(
˘x
, 
a
);

39857 
	`JS_FªeVÆue
(
˘x
, 
b
);

39858  
	`JS_NewI¡32
(
˘x
, 
cmp
);

39859 
	}
}

39861 
JSVÆue
 
	$js_°rög_toLowîCa£
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

39862 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
, 
to_lowî
)

39864 
JSVÆue
 
vÆ
;

39865 
SåögBuf„r
 
b_s
, *
b
 = &b_s;

39866 
JSSåög
 *
p
;

39867 
i
, 
c
, 
j
, 
l
;

39868 
uöt32_t
 
ªs
[
LRE_CC_RES_LEN_MAX
];

39870 
vÆ
 = 
	`JS_ToSåögCheckObje˘
(
˘x
, 
this_vÆ
);

39871 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

39872  
vÆ
;

39873 
p
 = 
	`JS_VALUE_GET_STRING
(
vÆ
);

39874 i‡(
p
->
Àn
 == 0)

39875  
vÆ
;

39876 i‡(
	`°rög_buf„r_öô
(
˘x
, 
b
, 
p
->
Àn
))

39877 
Áû
;

39878 
i
 = 0; i < 
p
->
Àn
;) {

39879 
c
 = 
	`°rög_gëc
(
p
, &
i
);

39880 i‡(
c
 =0x3a3 && 
to_lowî
 && 
	`ã°_föÆ_sigma
(
p
, 
i
 - 1)) {

39881 
ªs
[0] = 0x3c2;

39882 
l
 = 1;

39884 
l
 = 
	`Ãe_ˇ£_c⁄v
(
ªs
, 
c
, 
to_lowî
);

39886 
j
 = 0; j < 
l
; j++) {

39887 i‡(
	`°rög_buf„r_putc
(
b
, 
ªs
[
j
]))

39888 
Áû
;

39891 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

39892  
	`°rög_buf„r_íd
(
b
);

39893 
Áû
:

39894 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

39895 
	`°rög_buf„r_‰ì
(
b
);

39896  
JS_EXCEPTION
;

39897 
	}
}

39899 #ifde‡
CONFIG_ALL_UNICODE


39902 
	$JS_ToUTF32Såög
(
JSC⁄ãxt
 *
˘x
, 
uöt32_t
 **
pbuf
, 
JSVÆueC⁄°
 
vÆ1
)

39904 
JSVÆue
 
vÆ
;

39905 
JSSåög
 *
p
;

39906 
uöt32_t
 *
buf
;

39907 
i
, 
j
, 
Àn
;

39909 
vÆ
 = 
	`JS_ToSåög
(
˘x
, 
vÆ1
);

39910 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

39912 
p
 = 
	`JS_VALUE_GET_STRING
(
vÆ
);

39913 
Àn
 = 
p
->len;

39915 
buf
 = 
	`js_mÆloc
(
˘x
, (buf[0]Ë* 
	`max_öt
(
Àn
, 1));

39916 i‡(!
buf
) {

39917 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

39918 
Áû
;

39920 
i
 = 
j
 = 0; i < 
Àn
;)

39921 
buf
[
j
++] = 
	`°rög_gëc
(
p
, &
i
);

39922 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

39923 *
pbuf
 = 
buf
;

39924  
j
;

39925 
Áû
:

39926 *
pbuf
 = 
NULL
;

39928 
	}
}

39930 
JSVÆue
 
	$JS_NewUTF32Såög
(
JSC⁄ãxt
 *
˘x
, c⁄° 
uöt32_t
 *
buf
, 
Àn
)

39932 
i
;

39933 
SåögBuf„r
 
b_s
, *
b
 = &b_s;

39934 i‡(
	`°rög_buf„r_öô
(
˘x
, 
b
, 
Àn
))

39935  
JS_EXCEPTION
;

39936 
i
 = 0; i < 
Àn
; i++) {

39937 i‡(
	`°rög_buf„r_putc
(
b
, 
buf
[
i
]))

39938 
Áû
;

39940  
	`°rög_buf„r_íd
(
b
);

39941 
Áû
:

39942 
	`°rög_buf„r_‰ì
(
b
);

39943  
JS_EXCEPTION
;

39944 
	}
}

39946 
JSVÆue
 
	$js_°rög_n‹mÆize
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

39947 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

39949 c⁄° *
f‹m
, *
p
;

39950 
size_t
 
f‹m_Àn
;

39951 
is_com∑t
, 
buf_Àn
, 
out_Àn
;

39952 
UnicodeN‹mÆiz©i⁄Enum
 
n_ty≥
;

39953 
JSVÆue
 
vÆ
;

39954 
uöt32_t
 *
buf
, *
out_buf
;

39956 
vÆ
 = 
	`JS_ToSåögCheckObje˘
(
˘x
, 
this_vÆ
);

39957 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

39958  
vÆ
;

39959 
buf_Àn
 = 
	`JS_ToUTF32Såög
(
˘x
, &
buf
, 
vÆ
);

39960 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

39961 i‡(
buf_Àn
 < 0)

39962  
JS_EXCEPTION
;

39964 i‡(
¨gc
 =0 || 
	`JS_IsUndeföed
(
¨gv
[0])) {

39965 
n_ty≥
 = 
UNICODE_NFC
;

39967 
f‹m
 = 
	`JS_ToCSåögLí
(
˘x
, &
f‹m_Àn
, 
¨gv
[0]);

39968 i‡(!
f‹m
)

39969 
Áû1
;

39970 
p
 = 
f‹m
;

39971 i‡(
p
[0] != 'N' ||Ö[1] != 'F')

39972 
bad_f‹m
;

39973 
p
 += 2;

39974 
is_com∑t
 = 
FALSE
;

39975 i‡(*
p
 == 'K') {

39976 
is_com∑t
 = 
TRUE
;

39977 
p
++;

39979 i‡(*
p
 == 'C' || *p == 'D') {

39980 
n_ty≥
 = 
UNICODE_NFC
 + 
is_com∑t
 * 2 + (*
p
 - 'C');

39981 i‡((
p
 + 1 - 
f‹m
Ë!
f‹m_Àn
)

39982 
bad_f‹m
;

39984 
bad_f‹m
:

39985 
	`JS_FªeCSåög
(
˘x
, 
f‹m
);

39986 
	`JS_ThrowR™geEº‹
(
˘x
, "badÇormalization form");

39987 
Áû1
:

39988 
	`js_‰ì
(
˘x
, 
buf
);

39989  
JS_EXCEPTION
;

39991 
	`JS_FªeCSåög
(
˘x
, 
f‹m
);

39994 
out_Àn
 = 
	`unicode_n‹mÆize
(&
out_buf
, 
buf
, 
buf_Àn
, 
n_ty≥
,

39995 
˘x
->
π
, (
DynBufRóŒocFunc
 *)
js_ªÆloc_π
);

39996 
	`js_‰ì
(
˘x
, 
buf
);

39997 i‡(
out_Àn
 < 0)

39998  
JS_EXCEPTION
;

39999 
vÆ
 = 
	`JS_NewUTF32Såög
(
˘x
, 
out_buf
, 
out_Àn
);

40000 
	`js_‰ì
(
˘x
, 
out_buf
);

40001  
vÆ
;

40002 
	}
}

40006 
JSVÆue
 
	$js_°rög_toSåög
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

40007 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

40009  
	`js_thisSåögVÆue
(
˘x
, 
this_vÆ
);

40010 
	}
}

40013 
JSVÆue
 
	$js_°rög___toSåögCheckObje˘
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

40014 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

40016  
	`JS_ToSåögCheckObje˘
(
˘x
, 
¨gv
[0]);

40017 
	}
}

40019 
JSVÆue
 
	$js_°rög___toSåög
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

40020 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

40022  
	`JS_ToSåög
(
˘x
, 
¨gv
[0]);

40023 
	}
}

40025 
JSVÆue
 
	$js_°rög___adv™˚SåögIndex
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°


40026 
this_vÆ
,

40027 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

40029 
JSVÆue
 
°r
;

40030 
idx
;

40031 
BOOL
 
is_unicode
;

40032 
JSSåög
 *
p
;

40034 
°r
 = 
	`JS_ToSåög
(
˘x
, 
¨gv
[0]);

40035 i‡(
	`JS_IsEx˚±i⁄
(
°r
))

40036  
°r
;

40037 i‡(
	`JS_ToI¡32S©
(
˘x
, &
idx
, 
¨gv
[1])) {

40038 
	`JS_FªeVÆue
(
˘x
, 
°r
);

40039  
JS_EXCEPTION
;

40041 
is_unicode
 = 
	`JS_ToBoﬁ
(
˘x
, 
¨gv
[2]);

40042 
p
 = 
	`JS_VALUE_GET_STRING
(
°r
);

40043 i‡(!
is_unicode
 || ()
idx
 >
p
->
Àn
 || !p->
is_wide_ch¨
) {

40044 
idx
++;

40046 
	`°rög_gëc
(
p
, &
idx
);

40048 
	`JS_FªeVÆue
(
˘x
, 
°r
);

40049  
	`JS_NewI¡32
(
˘x
, 
idx
);

40050 
	}
}

40055 
JSVÆue
 
	$js_°rög_ôî©‹_√xt
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

40056 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
,

40057 
BOOL
 *
pd⁄e
, 
magic
)

40059 
JSAºayIãøt‹D©a
 *
ô
;

40060 
uöt32_t
 
idx
, 
c
, 
°¨t
;

40061 
JSSåög
 *
p
;

40063 
ô
 = 
	`JS_GëO∑que2
(
˘x
, 
this_vÆ
, 
JS_CLASS_STRING_ITERATOR
);

40064 i‡(!
ô
) {

40065 *
pd⁄e
 = 
FALSE
;

40066  
JS_EXCEPTION
;

40068 i‡(
	`JS_IsUndeföed
(
ô
->
obj
))

40069 
d⁄e
;

40070 
p
 = 
	`JS_VALUE_GET_STRING
(
ô
->
obj
);

40071 
idx
 = 
ô
->idx;

40072 i‡(
idx
 >
p
->
Àn
) {

40073 
	`JS_FªeVÆue
(
˘x
, 
ô
->
obj
);

40074 
ô
->
obj
 = 
JS_UNDEFINED
;

40075 
d⁄e
:

40076 *
pd⁄e
 = 
TRUE
;

40077  
JS_UNDEFINED
;

40080 
°¨t
 = 
idx
;

40081 
c
 = 
	`°rög_gëc
(
p
, (*)&
idx
);

40082 
ô
->
idx
 = idx;

40083 *
pd⁄e
 = 
FALSE
;

40084 i‡(
c
 <= 0xffff) {

40085  
	`js_√w_°rög_ch¨
(
˘x
, 
c
);

40087  
	`js_√w_°rög16
(
˘x
, 
p
->
u
.
°r16
 + 
°¨t
, 2);

40089 
	}
}

40093 
	mmagic_°rög_™ch‹
,

40094 
	mmagic_°rög_big
,

40095 
	mmagic_°rög_blök
,

40096 
	mmagic_°rög_bﬁd
,

40097 
	mmagic_°rög_fixed
,

40098 
	mmagic_°rög_f⁄tcﬁ‹
,

40099 
	mmagic_°rög_f⁄tsize
,

40100 
	mmagic_°rög_ôÆics
,

40101 
	mmagic_°rög_lök
,

40102 
	mmagic_°rög_smÆl
,

40103 
	mmagic_°rög_°rike
,

40104 
	mmagic_°rög_sub
,

40105 
	mmagic_°rög_sup
,

40108 
JSVÆue
 
	$js_°rög_Cª©eHTML
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

40109 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
, 
magic
)

40111 
JSVÆue
 
°r
;

40112 c⁄° 
JSSåög
 *
p
;

40113 
SåögBuf„r
 
b_s
, *
b
 = &b_s;

40114 °ru˘ { c⁄° *
èg
, *
©å
; } c⁄° 
defs
[] = {

40115 { "a", "«me" }, { "big", 
NULL
 }, { "blink", NULL }, { "b", NULL },

40116 { "â", 
NULL
 }, { "font", "color" }, { "font", "size" }, { "i", NULL },

40117 { "a", "hªf" }, { "smÆl", 
NULL
 }, { "strike", NULL },

40118 { "sub", 
NULL
 }, { "sup", NULL },

40121 
°r
 = 
	`JS_ToSåögCheckObje˘
(
˘x
, 
this_vÆ
);

40122 i‡(
	`JS_IsEx˚±i⁄
(
°r
))

40123  
JS_EXCEPTION
;

40124 
	`°rög_buf„r_öô
(
˘x
, 
b
, 7);

40125 
	`°rög_buf„r_putc8
(
b
, '<');

40126 
	`°rög_buf„r_puts8
(
b
, 
defs
[
magic
].
èg
);

40127 i‡(
defs
[
magic
].
©å
) {

40129 
JSVÆue
 
vÆue
;

40130 
i
;

40132 
	`°rög_buf„r_putc8
(
b
, ' ');

40133 
	`°rög_buf„r_puts8
(
b
, 
defs
[
magic
].
©å
);

40134 
	`°rög_buf„r_puts8
(
b
, "=\"");

40135 
vÆue
 = 
	`JS_ToSåögCheckObje˘
(
˘x
, 
¨gv
[0]);

40136 i‡(
	`JS_IsEx˚±i⁄
(
vÆue
)) {

40137 
	`JS_FªeVÆue
(
˘x
, 
°r
);

40138 
	`°rög_buf„r_‰ì
(
b
);

40139  
JS_EXCEPTION
;

40141 
p
 = 
	`JS_VALUE_GET_STRING
(
vÆue
);

40142 
i
 = 0; i < 
p
->
Àn
; i++) {

40143 
c
 = 
	`°rög_gë
(
p
, 
i
);

40144 i‡(
c
 == '"') {

40145 
	`°rög_buf„r_puts8
(
b
, "&quot;");

40147 
	`°rög_buf„r_putc16
(
b
, 
c
);

40150 
	`JS_FªeVÆue
(
˘x
, 
vÆue
);

40151 
	`°rög_buf„r_putc8
(
b
, '\"');

40154 
	`°rög_buf„r_putc8
(
b
, '>');

40155 
	`°rög_buf„r_c⁄ˇt_vÆue_‰ì
(
b
, 
°r
);

40156 
	`°rög_buf„r_puts8
(
b
, "</");

40157 
	`°rög_buf„r_puts8
(
b
, 
defs
[
magic
].
èg
);

40158 
	`°rög_buf„r_putc8
(
b
, '>');

40159  
	`°rög_buf„r_íd
(
b
);

40160 
	}
}

40162 c⁄° 
JSCFun˘i⁄Li°E¡ry
 
	gjs_°rög_funcs
[] = {

40163 
JS_CFUNC_DEF
("‰omCh¨Code", 1, 
js_°rög_‰omCh¨Code
 ),

40164 
JS_CFUNC_DEF
("‰omCodePoöt", 1, 
js_°rög_‰omCodePoöt
 ),

40165 
JS_CFUNC_DEF
("øw", 1, 
js_°rög_øw
 ),

40173 c⁄° 
JSCFun˘i⁄Li°E¡ry
 
	gjs_°rög_¥Ÿo_funcs
[] = {

40174 
JS_PROP_INT32_DEF
("Àngth", 0, 
JS_PROP_CONFIGURABLE
 ),

40175 
JS_CFUNC_DEF
("ch¨CodeAt", 1, 
js_°rög_ch¨CodeAt
 ),

40176 
JS_CFUNC_DEF
("ch¨At", 1, 
js_°rög_ch¨At
 ),

40177 
JS_CFUNC_DEF
("c⁄ˇt", 1, 
js_°rög_c⁄ˇt
 ),

40178 
JS_CFUNC_DEF
("codePoötAt", 1, 
js_°rög_codePoötAt
 ),

40179 
JS_CFUNC_MAGIC_DEF
("ödexOf", 1, 
js_°rög_ödexOf
, 0 ),

40180 
JS_CFUNC_MAGIC_DEF
("œ°IndexOf", 1, 
js_°rög_ödexOf
, 1 ),

40181 
JS_CFUNC_MAGIC_DEF
("ö˛udes", 1, 
js_°rög_ö˛udes
, 0 ),

40182 
JS_CFUNC_MAGIC_DEF
("ídsWôh", 1, 
js_°rög_ö˛udes
, 2 ),

40183 
JS_CFUNC_MAGIC_DEF
("°¨tsWôh", 1, 
js_°rög_ö˛udes
, 1 ),

40184 
JS_CFUNC_MAGIC_DEF
("m©ch", 1, 
js_°rög_m©ch
, 
JS_ATOM_Symbﬁ_m©ch
 ),

40185 
JS_CFUNC_MAGIC_DEF
("m©chAŒ", 1, 
js_°rög_m©ch
, 
JS_ATOM_Symbﬁ_m©chAŒ
 ),

40186 
JS_CFUNC_MAGIC_DEF
("£¨ch", 1, 
js_°rög_m©ch
, 
JS_ATOM_Symbﬁ_£¨ch
 ),

40187 
JS_CFUNC_DEF
("•lô", 2, 
js_°rög_•lô
 ),

40188 
JS_CFUNC_DEF
("sub°rög", 2, 
js_°rög_sub°rög
 ),

40189 
JS_CFUNC_DEF
("sub°r", 2, 
js_°rög_sub°r
 ),

40190 
JS_CFUNC_DEF
("¶i˚", 2, 
js_°rög_¶i˚
 ),

40191 
JS_CFUNC_DEF
("ª≥©", 1, 
js_°rög_ª≥©
 ),

40192 
JS_CFUNC_MAGIC_DEF
("ª∂a˚", 2, 
js_°rög_ª∂a˚
, 0 ),

40193 
JS_CFUNC_MAGIC_DEF
("ª∂a˚AŒ", 2, 
js_°rög_ª∂a˚
, 1 ),

40194 
JS_CFUNC_MAGIC_DEF
("∑dEnd", 1, 
js_°rög_∑d
, 1 ),

40195 
JS_CFUNC_MAGIC_DEF
("∑dSèπ", 1, 
js_°rög_∑d
, 0 ),

40196 
JS_CFUNC_MAGIC_DEF
("åim", 0, 
js_°rög_åim
, 3 ),

40197 
JS_CFUNC_MAGIC_DEF
("åimEnd", 0, 
js_°rög_åim
, 2 ),

40198 
JS_ALIAS_DEF
("trimRight", "trimEnd" ),

40199 
JS_CFUNC_MAGIC_DEF
("åimSèπ", 0, 
js_°rög_åim
, 1 ),

40200 
JS_ALIAS_DEF
("trimLeft", "trimStart" ),

40201 
JS_CFUNC_DEF
("toSåög", 0, 
js_°rög_toSåög
 ),

40202 
JS_CFUNC_DEF
("vÆueOf", 0, 
js_°rög_toSåög
 ),

40203 
JS_CFUNC_DEF
("__quŸe", 1, 
js_°rög___quŸe
 ),

40204 
JS_CFUNC_DEF
("loˇÀCom∑ª", 1, 
js_°rög_loˇÀCom∑ª
 ),

40205 
JS_CFUNC_MAGIC_DEF
("toLowîCa£", 0, 
js_°rög_toLowîCa£
, 1 ),

40206 
JS_CFUNC_MAGIC_DEF
("toUµîCa£", 0, 
js_°rög_toLowîCa£
, 0 ),

40207 
JS_CFUNC_MAGIC_DEF
("toLoˇÀLowîCa£", 0, 
js_°rög_toLowîCa£
, 1 ),

40208 
JS_CFUNC_MAGIC_DEF
("toLoˇÀUµîCa£", 0, 
js_°rög_toLowîCa£
, 0 ),

40209 
JS_CFUNC_MAGIC_DEF
("[Symbﬁ.ôî©‹]", 0, 
js_¸óã_¨øy_ôî©‹
, 
JS_ITERATOR_KIND_VALUE
 | 4 ),

40211 
JS_CFUNC_MAGIC_DEF
("™ch‹", 1, 
js_°rög_Cª©eHTML
, 
magic_°rög_™ch‹
 ),

40212 
JS_CFUNC_MAGIC_DEF
("big", 0, 
js_°rög_Cª©eHTML
, 
magic_°rög_big
 ),

40213 
JS_CFUNC_MAGIC_DEF
("blök", 0, 
js_°rög_Cª©eHTML
, 
magic_°rög_blök
 ),

40214 
JS_CFUNC_MAGIC_DEF
("bﬁd", 0, 
js_°rög_Cª©eHTML
, 
magic_°rög_bﬁd
 ),

40215 
JS_CFUNC_MAGIC_DEF
("fixed", 0, 
js_°rög_Cª©eHTML
, 
magic_°rög_fixed
 ),

40216 
JS_CFUNC_MAGIC_DEF
("f⁄tcﬁ‹", 1, 
js_°rög_Cª©eHTML
, 
magic_°rög_f⁄tcﬁ‹
 ),

40217 
JS_CFUNC_MAGIC_DEF
("f⁄tsize", 1, 
js_°rög_Cª©eHTML
, 
magic_°rög_f⁄tsize
 ),

40218 
JS_CFUNC_MAGIC_DEF
("ôÆics", 0, 
js_°rög_Cª©eHTML
, 
magic_°rög_ôÆics
 ),

40219 
JS_CFUNC_MAGIC_DEF
("lök", 1, 
js_°rög_Cª©eHTML
, 
magic_°rög_lök
 ),

40220 
JS_CFUNC_MAGIC_DEF
("smÆl", 0, 
js_°rög_Cª©eHTML
, 
magic_°rög_smÆl
 ),

40221 
JS_CFUNC_MAGIC_DEF
("°rike", 0, 
js_°rög_Cª©eHTML
, 
magic_°rög_°rike
 ),

40222 
JS_CFUNC_MAGIC_DEF
("sub", 0, 
js_°rög_Cª©eHTML
, 
magic_°rög_sub
 ),

40223 
JS_CFUNC_MAGIC_DEF
("sup", 0, 
js_°rög_Cª©eHTML
, 
magic_°rög_sup
 ),

40226 c⁄° 
JSCFun˘i⁄Li°E¡ry
 
	gjs_°rög_ôî©‹_¥Ÿo_funcs
[] = {

40227 
JS_ITERATOR_NEXT_DEF
("√xt", 0, 
js_°rög_ôî©‹_√xt
, 0 ),

40228 
JS_PROP_STRING_DEF
("[Symbﬁ.toSåögTag]", "Såög Iãøt‹", 
JS_PROP_CONFIGURABLE
 ),

40231 #ifde‡
CONFIG_ALL_UNICODE


40232 c⁄° 
JSCFun˘i⁄Li°E¡ry
 
	gjs_°rög_¥Ÿo_n‹mÆize
[] = {

40233 
JS_CFUNC_DEF
("n‹mÆize", 0, 
js_°rög_n‹mÆize
 ),

40237 
	$JS_AddI¡rösicSåögN‹mÆize
(
JSC⁄ãxt
 *
˘x
)

40239 #ifde‡
CONFIG_ALL_UNICODE


40240 
	`JS_SëPr›îtyFun˘i⁄Li°
(
˘x
, ctx->
˛ass_¥Ÿo
[
JS_CLASS_STRING
], 
js_°rög_¥Ÿo_n‹mÆize
,

40241 
	`cou¡of
(
js_°rög_¥Ÿo_n‹mÆize
));

40243 
	}
}

40248 
	$js_fmö
(
a
, 
b
)

40250 i‡(
a
 =0 && 
b
 == 0) {

40251 
JSFlﬂt64Uni⁄
 
a1
, 
b1
;

40252 
a1
.
d
 = 
a
;

40253 
b1
.
d
 = 
b
;

40254 
a1
.
u64
 |
b1
.u64;

40255  
a1
.
d
;

40257  
	`fmö
(
a
, 
b
);

40259 
	}
}

40262 
	$js_fmax
(
a
, 
b
)

40264 i‡(
a
 =0 && 
b
 == 0) {

40265 
JSFlﬂt64Uni⁄
 
a1
, 
b1
;

40266 
a1
.
d
 = 
a
;

40267 
b1
.
d
 = 
b
;

40268 
a1
.
u64
 &
b1
.u64;

40269  
a1
.
d
;

40271  
	`fmax
(
a
, 
b
);

40273 
	}
}

40275 
JSVÆue
 
	$js_m©h_mö_max
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

40276 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
, 
magic
)

40278 
BOOL
 
is_max
 = 
magic
;

40279 
r
, 
a
;

40280 
i
;

40281 
uöt32_t
 
èg
;

40283 i‡(
	`u∆ikñy
(
¨gc
 == 0)) {

40284  
	`__JS_NewFlﬂt64
(
˘x
, 
is_max
 ? -1.0 / 0.0 : 1.0 / 0.0);

40287 
èg
 = 
	`JS_VALUE_GET_TAG
(
¨gv
[0]);

40288 i‡(
èg
 =
JS_TAG_INT
) {

40289 
a1
, 
r1
 = 
	`JS_VALUE_GET_INT
(
¨gv
[0]);

40290 
i
 = 1; i < 
¨gc
; i++) {

40291 
èg
 = 
	`JS_VALUE_GET_TAG
(
¨gv
[
i
]);

40292 i‡(
èg
 !
JS_TAG_INT
) {

40293 
r
 = 
r1
;

40294 
gíîic_ˇ£
;

40296 
a1
 = 
	`JS_VALUE_GET_INT
(
¨gv
[
i
]);

40297 i‡(
is_max
)

40298 
r1
 = 
	`max_öt
‘1, 
a1
);

40300 
r1
 = 
	`mö_öt
‘1, 
a1
);

40303  
	`JS_NewI¡32
(
˘x
, 
r1
);

40305 i‡(
	`JS_ToFlﬂt64
(
˘x
, &
r
, 
¨gv
[0]))

40306  
JS_EXCEPTION
;

40307 
i
 = 1;

40308 
gíîic_ˇ£
:

40309 
i
 < 
¨gc
) {

40310 i‡(
	`JS_ToFlﬂt64
(
˘x
, &
a
, 
¨gv
[
i
]))

40311  
JS_EXCEPTION
;

40312 i‡(!
	`i¢™
(
r
)) {

40313 i‡(
	`i¢™
(
a
)) {

40314 
r
 = 
a
;

40316 i‡(
is_max
)

40317 
r
 = 
	`js_fmax
‘, 
a
);

40319 
r
 = 
	`js_fmö
‘, 
a
);

40322 
i
++;

40324  
	`JS_NewFlﬂt64
(
˘x
, 
r
);

40326 
	}
}

40328 
	$js_m©h_sign
(
a
)

40330 i‡(
	`i¢™
(
a
) ||á == 0.0)

40331  
a
;

40332 i‡(
a
 < 0)

40336 
	}
}

40338 
	$js_m©h_round
(
a
)

40340 
JSFlﬂt64Uni⁄
 
u
;

40341 
uöt64_t
 
‰ac_mask
, 
⁄e
;

40342 
e
, 
s
;

40344 
u
.
d
 = 
a
;

40345 
e
 = (
u
.
u64
 >> 52) & 0x7ff;

40346 i‡(
e
 < 1023) {

40348 i‡(
e
 =(1023 - 1Ë&& 
u
.
u64
 != 0xbfe0000000000000) {

40350 
u
.
u64
 = (u.u64 & ((
uöt64_t
)1 << 63)) | ((uint64_t)1023 << 52);

40353 
u
.
u64
 &(
uöt64_t
)1 << 63;

40355 } i‡(
e
 < (1023 + 52)) {

40356 
s
 = 
u
.
u64
 >> 63;

40357 
⁄e
 = (
uöt64_t
)1 << (52 - (
e
 - 1023));

40358 
‰ac_mask
 = 
⁄e
 - 1;

40359 
u
.
u64
 +(
⁄e
 >> 1Ë- 
s
;

40360 
u
.
u64
 &~
‰ac_mask
;

40363  
u
.
d
;

40364 
	}
}

40366 
JSVÆue
 
	$js_m©h_hypŸ
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

40367 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

40369 
r
, 
a
, 
b
;

40370 
i
;

40372 i‡(
¨gc
 == 2) {

40374 i‡(
	`JS_ToFlﬂt64
(
˘x
, &
a
, 
¨gv
[0]))

40375  
JS_EXCEPTION
;

40376 i‡(
	`JS_ToFlﬂt64
(
˘x
, &
b
, 
¨gv
[1]))

40377  
JS_EXCEPTION
;

40378 
r
 = 
	`hypŸ
(
a
, 
b
);

40379 } i‡(
¨gc
 == 0) {

40380 
r
 = 0;

40382 *
èb
, 
a_max
;

40383 
èb
 = 
	`js_mÆloc
(
˘x
, —ab[0]Ë* 
¨gc
);

40384 i‡(!
èb
)

40385  
JS_EXCEPTION
;

40387 
a_max
 = 0;

40388 
i
 = 0; i < 
¨gc
; i++) {

40389 i‡(
	`JS_ToFlﬂt64
(
˘x
, &
a
, 
¨gv
[
i
])) {

40390 
	`js_‰ì
(
˘x
, 
èb
);

40391  
JS_EXCEPTION
;

40393 
a
 = 
	`Ábs
(a);

40394 
èb
[
i
] = 
a
;

40395 i‡(
a
 > 
a_max
)

40396 
a_max
 = 
a
;

40398 i‡(
a_max
 =0 || !
	`isföôe
(a_max)) {

40399 
r
 = 
a_max
;

40401 
r
 = 0;

40402 
i
 = 0; i < 
¨gc
; i++) {

40403 
a
 = 
èb
[
i
] / 
a_max
;

40404 
r
 +
a
 *á;

40406 
r
 = 
a_max
 * 
	`sqπ
(r);

40408 
	`js_‰ì
(
˘x
, 
èb
);

40410  
	`JS_NewFlﬂt64
(
˘x
, 
r
);

40411 
	}
}

40413 
	$js_m©h_‰ound
(
a
)

40415  ()
a
;

40416 
	}
}

40418 
JSVÆue
 
	$js_m©h_imul
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

40419 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

40421 
a
, 
b
;

40423 i‡(
	`JS_ToI¡32
(
˘x
, &
a
, 
¨gv
[0]))

40424  
JS_EXCEPTION
;

40425 i‡(
	`JS_ToI¡32
(
˘x
, &
b
, 
¨gv
[1]))

40426  
JS_EXCEPTION
;

40428  
	`JS_NewI¡32
(
˘x
, 
a
 * 
b
);

40429 
	}
}

40431 
JSVÆue
 
	$js_m©h_˛z32
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

40432 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

40434 
uöt32_t
 
a
, 
r
;

40436 i‡(
	`JS_ToUöt32
(
˘x
, &
a
, 
¨gv
[0]))

40437  
JS_EXCEPTION
;

40438 i‡(
a
 == 0)

40439 
r
 = 32;

40441 
r
 = 
	`˛z32
(
a
);

40442  
	`JS_NewI¡32
(
˘x
, 
r
);

40443 
	}
}

40446 
uöt64_t
 
	$x‹shi·64°¨
(
uöt64_t
 *
p°©e
)

40448 
uöt64_t
 
x
;

40449 
x
 = *
p°©e
;

40450 
x
 ^= x >> 12;

40451 
x
 ^= x << 25;

40452 
x
 ^= x >> 27;

40453 *
p°©e
 = 
x
;

40454  
x
 * 0x2545F4914F6CDD1D;

40455 
	}
}

40457 
	$js_øndom_öô
(
JSC⁄ãxt
 *
˘x
)

40459 
timevÆ
 
tv
;

40460 
	`gëtimeofday
(&
tv
, 
NULL
);

40461 
˘x
->
øndom_°©e
 = ((
söt64_t
)
tv
.
tv_£c
 * 1000000Ë+Åv.
tv_u£c
;

40463 i‡(
˘x
->
øndom_°©e
 == 0)

40464 
˘x
->
øndom_°©e
 = 1;

40465 
	}
}

40467 
JSVÆue
 
	$js_m©h_øndom
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

40468 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

40470 
JSFlﬂt64Uni⁄
 
u
;

40471 
uöt64_t
 
v
;

40473 
v
 = 
	`x‹shi·64°¨
(&
˘x
->
øndom_°©e
);

40475 
u
.
u64
 = ((
uöt64_t
)0x3f‡<< 52Ë| (
v
 >> 12);

40476  
	`__JS_NewFlﬂt64
(
˘x
, 
u
.
d
 - 1.0);

40477 
	}
}

40479 c⁄° 
JSCFun˘i⁄Li°E¡ry
 
	gjs_m©h_funcs
[] = {

40480 
JS_CFUNC_MAGIC_DEF
("mö", 2, 
js_m©h_mö_max
, 0 ),

40481 
JS_CFUNC_MAGIC_DEF
("max", 2, 
js_m©h_mö_max
, 1 ),

40482 
JS_CFUNC_SPECIAL_DEF
("abs", 1, 
f_f
, 
Ábs
 ),

40483 
JS_CFUNC_SPECIAL_DEF
("Êo‹", 1, 
f_f
, 
Êo‹
 ),

40484 
JS_CFUNC_SPECIAL_DEF
("˚û", 1, 
f_f
, 
˚û
 ),

40485 
JS_CFUNC_SPECIAL_DEF
("round", 1, 
f_f
, 
js_m©h_round
 ),

40486 
JS_CFUNC_SPECIAL_DEF
("sqπ", 1, 
f_f
, 
sqπ
 ),

40488 
JS_CFUNC_SPECIAL_DEF
("acos", 1, 
f_f
, 
acos
 ),

40489 
JS_CFUNC_SPECIAL_DEF
("asö", 1, 
f_f
, 
asö
 ),

40490 
JS_CFUNC_SPECIAL_DEF
("©™", 1, 
f_f
, 
©™
 ),

40491 
JS_CFUNC_SPECIAL_DEF
("©™2", 2, 
f_f_f
, 
©™2
 ),

40492 
JS_CFUNC_SPECIAL_DEF
("cos", 1, 
f_f
, 
cos
 ),

40493 
JS_CFUNC_SPECIAL_DEF
("exp", 1, 
f_f
, 
exp
 ),

40494 
JS_CFUNC_SPECIAL_DEF
("log", 1, 
f_f
, 
log
 ),

40495 
JS_CFUNC_SPECIAL_DEF
("pow", 2, 
f_f_f
, 
js_pow
 ),

40496 
JS_CFUNC_SPECIAL_DEF
("sö", 1, 
f_f
, 
sö
 ),

40497 
JS_CFUNC_SPECIAL_DEF
("èn", 1, 
f_f
, 
èn
 ),

40499 
JS_CFUNC_SPECIAL_DEF
("åunc", 1, 
f_f
, 
åunc
 ),

40500 
JS_CFUNC_SPECIAL_DEF
("sign", 1, 
f_f
, 
js_m©h_sign
 ),

40501 
JS_CFUNC_SPECIAL_DEF
("cosh", 1, 
f_f
, 
cosh
 ),

40502 
JS_CFUNC_SPECIAL_DEF
("söh", 1, 
f_f
, 
söh
 ),

40503 
JS_CFUNC_SPECIAL_DEF
("ènh", 1, 
f_f
, 
ènh
 ),

40504 
JS_CFUNC_SPECIAL_DEF
("acosh", 1, 
f_f
, 
acosh
 ),

40505 
JS_CFUNC_SPECIAL_DEF
("asöh", 1, 
f_f
, 
asöh
 ),

40506 
JS_CFUNC_SPECIAL_DEF
("©™h", 1, 
f_f
, 
©™h
 ),

40507 
JS_CFUNC_SPECIAL_DEF
("expm1", 1, 
f_f
, 
expm1
 ),

40508 
JS_CFUNC_SPECIAL_DEF
("log1p", 1, 
f_f
, 
log1p
 ),

40509 
JS_CFUNC_SPECIAL_DEF
("log2", 1, 
f_f
, 
log2
 ),

40510 
JS_CFUNC_SPECIAL_DEF
("log10", 1, 
f_f
, 
log10
 ),

40511 
JS_CFUNC_SPECIAL_DEF
("cbπ", 1, 
f_f
, 
cbπ
 ),

40512 
JS_CFUNC_DEF
("hypŸ", 2, 
js_m©h_hypŸ
 ),

40513 
JS_CFUNC_DEF
("øndom", 0, 
js_m©h_øndom
 ),

40514 
JS_CFUNC_SPECIAL_DEF
("‰ound", 1, 
f_f
, 
js_m©h_‰ound
 ),

40515 
JS_CFUNC_DEF
("imul", 2, 
js_m©h_imul
 ),

40516 
JS_CFUNC_DEF
("˛z32", 1, 
js_m©h_˛z32
 ),

40517 
JS_PROP_STRING_DEF
("[Symbﬁ.toSåögTag]", "M©h", 
JS_PROP_CONFIGURABLE
 ),

40518 
JS_PROP_DOUBLE_DEF
("E", 2.718281828459045, 0 ),

40519 
JS_PROP_DOUBLE_DEF
("LN10", 2.302585092994046, 0 ),

40520 
JS_PROP_DOUBLE_DEF
("LN2", 0.6931471805599453, 0 ),

40521 
JS_PROP_DOUBLE_DEF
("LOG2E", 1.4426950408889634, 0 ),

40522 
JS_PROP_DOUBLE_DEF
("LOG10E", 0.4342944819032518, 0 ),

40523 
JS_PROP_DOUBLE_DEF
("PI", 3.141592653589793, 0 ),

40524 
JS_PROP_DOUBLE_DEF
("SQRT1_2", 0.7071067811865476, 0 ),

40525 
JS_PROP_DOUBLE_DEF
("SQRT2", 1.4142135623730951, 0 ),

40528 c⁄° 
JSCFun˘i⁄Li°E¡ry
 
	gjs_m©h_obj
[] = {

40529 
JS_OBJECT_DEF
("M©h", 
js_m©h_funcs
, 
cou¡of
(js_m©h_funcs), 
JS_PROP_WRITABLE
 | 
JS_PROP_CONFIGURABLE
 ),

40536 
JSVÆue
 
	$js___d©e_now
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

40537 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

40539 
öt64_t
 
d
;

40540 
timevÆ
 
tv
;

40541 
	`gëtimeofday
(&
tv
, 
NULL
);

40542 
d
 = (
öt64_t
)
tv
.
tv_£c
 * 1000 + (tv.
tv_u£c
 / 1000);

40543  
	`JS_NewI¡64
(
˘x
, 
d
);

40544 
	}
}

40548 
JSVÆue
 
	$js___d©e_˛ock
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

40549 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

40551 
söt64_t
 
d
;

40552 
timevÆ
 
tv
;

40553 
	`gëtimeofday
(&
tv
, 
NULL
);

40554 
d
 = (
söt64_t
)
tv
.
tv_£c
 * 1000000 +Åv.
tv_u£c
;

40555  
	`JS_NewI¡64
(
˘x
, 
d
);

40556 
	}
}

40560 
	$gëTimez⁄eOff£t
(
öt64_t
 
time
) {

40561 #i‡
	`deföed
(
_WIN32
)

40565 
time_t
 
ti
;

40566 
tm
Åm;

40568 
time
 /= 1000;

40569 i‡((
time_t
) == 4) {

40575 i‡((
time_t
)-1 < 0) {

40576 i‡(
time
 < 
INT32_MIN
) {

40577 
time
 = 
INT32_MIN
;

40578 } i‡(
time
 > 
INT32_MAX
) {

40579 
time
 = 
INT32_MAX
;

40582 i‡(
time
 < 0) {

40583 
time
 = 0;

40584 } i‡(
time
 > 
UINT32_MAX
) {

40585 
time
 = 
UINT32_MAX
;

40589 
ti
 = 
time
;

40590 
	`loˇ…ime_r
(&
ti
, &
tm
);

40591  -
tm
.
tm_gmtoff
 / 60;

40593 
	}
}

40596 
JSVÆue
 
	$js___d©e_gëTimez⁄eOff£t
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

40597 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

40599 
dd
;

40601 i‡(
	`JS_ToFlﬂt64
(
˘x
, &
dd
, 
¨gv
[0]))

40602  
JS_EXCEPTION
;

40603 i‡(
	`i¢™
(
dd
))

40604  
	`__JS_NewFlﬂt64
(
˘x
, 
dd
);

40606  
	`JS_NewI¡32
(
˘x
, 
	`gëTimez⁄eOff£t
((
öt64_t
)
dd
));

40607 
	}
}

40609 
JSVÆue
 
	$js_gë_¥ŸŸy≥_‰om_˘‹
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
˘‹
,

40610 
JSVÆueC⁄°
 
def_¥Ÿo
)

40612 
JSVÆue
 
¥Ÿo
;

40613 
¥Ÿo
 = 
	`JS_GëPr›îty
(
˘x
, 
˘‹
, 
JS_ATOM_¥ŸŸy≥
);

40614 i‡(
	`JS_IsEx˚±i⁄
(
¥Ÿo
))

40615  
¥Ÿo
;

40616 i‡(!
	`JS_IsObje˘
(
¥Ÿo
)) {

40617 
	`JS_FªeVÆue
(
˘x
, 
¥Ÿo
);

40618 
¥Ÿo
 = 
	`JS_DupVÆue
(
˘x
, 
def_¥Ÿo
);

40620  
¥Ÿo
;

40621 
	}
}

40624 
JSVÆue
 
	$js___d©e_¸óã
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

40625 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

40627 
JSVÆue
 
obj
, 
¥Ÿo
;

40628 
¥Ÿo
 = 
	`js_gë_¥ŸŸy≥_‰om_˘‹
(
˘x
, 
¨gv
[0],árgv[1]);

40629 i‡(
	`JS_IsEx˚±i⁄
(
¥Ÿo
))

40630  
¥Ÿo
;

40631 
obj
 = 
	`JS_NewObje˘PrŸoCœss
(
˘x
, 
¥Ÿo
, 
JS_CLASS_DATE
);

40632 
	`JS_FªeVÆue
(
˘x
, 
¥Ÿo
);

40633 i‡(!
	`JS_IsEx˚±i⁄
(
obj
))

40634 
	`JS_SëObje˘D©a
(
˘x
, 
obj
, 
	`JS_DupVÆue
(˘x, 
¨gv
[2]));

40635  
obj
;

40636 
	}
}

40641 
	$js_ªgexp_föÆizî
(
JSRu¡ime
 *
π
, 
JSVÆue
 
vÆ
)

40643 
JSObje˘
 *
p
 = 
	`JS_VALUE_GET_OBJ
(
vÆ
);

40644 
JSRegExp
 *
ª
 = &
p
->
u
.
ªgexp
;

40645 
	`JS_FªeVÆueRT
(
π
, 
	`JS_MKPTR
(
JS_TAG_STRING
, 
ª
->
byãcode
));

40646 
	`JS_FªeVÆueRT
(
π
, 
	`JS_MKPTR
(
JS_TAG_STRING
, 
ª
->
∑âîn
));

40647 
	}
}

40650 
JSVÆue
 
	$js_compûe_ªgexp
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
∑âîn
,

40651 
JSVÆueC⁄°
 
Êags
)

40653 c⁄° *
°r
;

40654 
ª_Êags
, 
mask
;

40655 
uöt8_t
 *
ª_byãcode_buf
;

40656 
size_t
 
i
, 
Àn
;

40657 
ª_byãcode_Àn
;

40658 
JSVÆue
 
ªt
;

40659 
îr‹_msg
[64];

40661 
ª_Êags
 = 0;

40662 i‡(!
	`JS_IsUndeföed
(
Êags
)) {

40663 
°r
 = 
	`JS_ToCSåögLí
(
˘x
, &
Àn
, 
Êags
);

40664 i‡(!
°r
)

40665  
JS_EXCEPTION
;

40667 
i
 = 0; i < 
Àn
; i++) {

40668 
°r
[
i
]) {

40670 
mask
 = 
LRE_FLAG_GLOBAL
;

40673 
mask
 = 
LRE_FLAG_IGNORECASE
;

40676 
mask
 = 
LRE_FLAG_MULTILINE
;

40679 
mask
 = 
LRE_FLAG_DOTALL
;

40682 
mask
 = 
LRE_FLAG_UTF16
;

40685 
mask
 = 
LRE_FLAG_STICKY
;

40688 
bad_Êags
;

40690 i‡((
ª_Êags
 & 
mask
) != 0) {

40691 
bad_Êags
:

40692 
	`JS_FªeCSåög
(
˘x
, 
°r
);

40693  
	`JS_ThrowSy¡axEº‹
(
˘x
, "invalidÑegularÉxpression flags");

40695 
ª_Êags
 |
mask
;

40697 
	`JS_FªeCSåög
(
˘x
, 
°r
);

40700 
°r
 = 
	`JS_ToCSåögLí2
(
˘x
, &
Àn
, 
∑âîn
, !(
ª_Êags
 & 
LRE_FLAG_UTF16
));

40701 i‡(!
°r
)

40702  
JS_EXCEPTION
;

40703 
ª_byãcode_buf
 = 
	`Ãe_compûe
(&
ª_byãcode_Àn
, 
îr‹_msg
,

40704 (
îr‹_msg
), 
°r
, 
Àn
, 
ª_Êags
, 
˘x
);

40705 
	`JS_FªeCSåög
(
˘x
, 
°r
);

40706 i‡(!
ª_byãcode_buf
) {

40707 
	`JS_ThrowSy¡axEº‹
(
˘x
, "%s", 
îr‹_msg
);

40708  
JS_EXCEPTION
;

40711 
ªt
 = 
	`js_√w_°rög8
(
˘x
, 
ª_byãcode_buf
, 
ª_byãcode_Àn
);

40712 
	`js_‰ì
(
˘x
, 
ª_byãcode_buf
);

40713  
ªt
;

40714 
	}
}

40718 
JSVÆue
 
	$js_ªgexp_c⁄°ru˘‹_öã∫Æ
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
˘‹
,

40719 
JSVÆue
 
∑âîn
, JSVÆuê
bc
)

40721 
JSVÆue
 
obj
;

40722 
JSObje˘
 *
p
;

40723 
JSRegExp
 *
ª
;

40726 i‡(
	`JS_VALUE_GET_TAG
(
bc
Ë!
JS_TAG_STRING
 ||

40727 
	`JS_VALUE_GET_TAG
(
∑âîn
Ë!
JS_TAG_STRING
) {

40728 
	`JS_ThrowTy≥Eº‹
(
˘x
, "stringÉxpected");

40729 
Áû
:

40730 
	`JS_FªeVÆue
(
˘x
, 
bc
);

40731 
	`JS_FªeVÆue
(
˘x
, 
∑âîn
);

40732  
JS_EXCEPTION
;

40735 
obj
 = 
	`js_¸óã_‰om_˘‹
(
˘x
, 
˘‹
, 
JS_CLASS_REGEXP
);

40736 i‡(
	`JS_IsEx˚±i⁄
(
obj
))

40737 
Áû
;

40738 
p
 = 
	`JS_VALUE_GET_OBJ
(
obj
);

40739 
ª
 = &
p
->
u
.
ªgexp
;

40740 
ª
->
∑âîn
 = 
	`JS_VALUE_GET_STRING
(pattern);

40741 
ª
->
byãcode
 = 
	`JS_VALUE_GET_STRING
(
bc
);

40742 
	`JS_DeföePr›îtyVÆue
(
˘x
, 
obj
, 
JS_ATOM_œ°Index
, 
	`JS_NewI¡32
(ctx, 0),

40743 
JS_PROP_WRITABLE
);

40744  
obj
;

40745 
	}
}

40747 
JSRegExp
 *
	$js_gë_ªgexp
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
obj
, 
BOOL
 
throw_îr‹
)

40749 i‡(
	`JS_VALUE_GET_TAG
(
obj
Ë=
JS_TAG_OBJECT
) {

40750 
JSObje˘
 *
p
 = 
	`JS_VALUE_GET_OBJ
(
obj
);

40751 i‡(
p
->
˛ass_id
 =
JS_CLASS_REGEXP
)

40752  &
p
->
u
.
ªgexp
;

40754 i‡(
throw_îr‹
) {

40755 
	`JS_ThrowTy≥Eº‹InvÆidCœss
(
˘x
, 
JS_CLASS_REGEXP
);

40757  
NULL
;

40758 
	}
}

40761 
	$js_is_ªgexp
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
obj
)

40763 
JSVÆue
 
m
;

40765 i‡(!
	`JS_IsObje˘
(
obj
))

40766  
FALSE
;

40767 
m
 = 
	`JS_GëPr›îty
(
˘x
, 
obj
, 
JS_ATOM_Symbﬁ_m©ch
);

40768 i‡(
	`JS_IsEx˚±i⁄
(
m
))

40770 i‡(!
	`JS_IsUndeföed
(
m
))

40771  
	`JS_ToBoﬁFªe
(
˘x
, 
m
);

40772  
	`js_gë_ªgexp
(
˘x
, 
obj
, 
FALSE
Ë!
NULL
;

40773 
	}
}

40775 
JSVÆue
 
	$js_ªgexp_c⁄°ru˘‹
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
√w_èrgë
,

40776 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

40778 
JSVÆue
 
∑âîn
, 
Êags
, 
bc
, 
vÆ
;

40779 
JSVÆueC⁄°
 
∑t
, 
Êags1
;

40780 
JSRegExp
 *
ª
;

40781 
∑t_is_ªgexp
;

40783 
∑t
 = 
¨gv
[0];

40784 
Êags1
 = 
¨gv
[1];

40785 
∑t_is_ªgexp
 = 
	`js_is_ªgexp
(
˘x
, 
∑t
);

40786 i‡(
∑t_is_ªgexp
 < 0)

40787  
JS_EXCEPTION
;

40788 i‡(
	`JS_IsUndeföed
(
√w_èrgë
)) {

40790 
√w_èrgë
 = 
	`JS_GëA˘iveFun˘i⁄
(
˘x
);

40791 i‡(
∑t_is_ªgexp
 && 
	`JS_IsUndeföed
(
Êags1
)) {

40792 
JSVÆue
 
˘‹
;

40793 
BOOL
 
ªs
;

40794 
˘‹
 = 
	`JS_GëPr›îty
(
˘x
, 
∑t
, 
JS_ATOM_c⁄°ru˘‹
);

40795 i‡(
	`JS_IsEx˚±i⁄
(
˘‹
))

40796  
˘‹
;

40797 
ªs
 = 
	`js_ßme_vÆue
(
˘x
, 
˘‹
, 
√w_èrgë
);

40798 
	`JS_FªeVÆue
(
˘x
, 
˘‹
);

40799 i‡(
ªs
)

40800  
	`JS_DupVÆue
(
˘x
, 
∑t
);

40803 
ª
 = 
	`js_gë_ªgexp
(
˘x
, 
∑t
, 
FALSE
);

40804 i‡(
ª
) {

40805 
∑âîn
 = 
	`JS_DupVÆue
(
˘x
, 
	`JS_MKPTR
(
JS_TAG_STRING
, 
ª
->pattern));

40806 i‡(
	`JS_IsUndeföed
(
Êags1
)) {

40807 
bc
 = 
	`JS_DupVÆue
(
˘x
, 
	`JS_MKPTR
(
JS_TAG_STRING
, 
ª
->
byãcode
));

40808 
no_compû©i⁄
;

40810 
Êags
 = 
	`JS_ToSåög
(
˘x
, 
Êags1
);

40811 i‡(
	`JS_IsEx˚±i⁄
(
Êags
))

40812 
Áû
;

40815 
Êags
 = 
JS_UNDEFINED
;

40816 i‡(
∑t_is_ªgexp
) {

40817 
∑âîn
 = 
	`JS_GëPr›îty
(
˘x
, 
∑t
, 
JS_ATOM_sour˚
);

40818 i‡(
	`JS_IsEx˚±i⁄
(
∑âîn
))

40819 
Áû
;

40820 i‡(
	`JS_IsUndeföed
(
Êags1
)) {

40821 
Êags
 = 
	`JS_GëPr›îty
(
˘x
, 
∑t
, 
JS_ATOM_Êags
);

40822 i‡(
	`JS_IsEx˚±i⁄
(
Êags
))

40823 
Áû
;

40825 
Êags
 = 
	`JS_DupVÆue
(
˘x
, 
Êags1
);

40828 
∑âîn
 = 
	`JS_DupVÆue
(
˘x
, 
∑t
);

40829 
Êags
 = 
	`JS_DupVÆue
(
˘x
, 
Êags1
);

40831 i‡(
	`JS_IsUndeföed
(
∑âîn
)) {

40832 
∑âîn
 = 
	`JS_AtomToSåög
(
˘x
, 
JS_ATOM_em±y_°rög
);

40834 
vÆ
 = 
∑âîn
;

40835 
∑âîn
 = 
	`JS_ToSåög
(
˘x
, 
vÆ
);

40836 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

40837 i‡(
	`JS_IsEx˚±i⁄
(
∑âîn
))

40838 
Áû
;

40841 
bc
 = 
	`js_compûe_ªgexp
(
˘x
, 
∑âîn
, 
Êags
);

40842 i‡(
	`JS_IsEx˚±i⁄
(
bc
))

40843 
Áû
;

40844 
	`JS_FªeVÆue
(
˘x
, 
Êags
);

40845 
no_compû©i⁄
:

40846  
	`js_ªgexp_c⁄°ru˘‹_öã∫Æ
(
˘x
, 
√w_èrgë
, 
∑âîn
, 
bc
);

40847 
Áû
:

40848 
	`JS_FªeVÆue
(
˘x
, 
∑âîn
);

40849 
	`JS_FªeVÆue
(
˘x
, 
Êags
);

40850  
JS_EXCEPTION
;

40851 
	}
}

40853 
JSVÆue
 
	$js_ªgexp_compûe
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

40854 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

40856 
JSRegExp
 *
ª1
, *
ª
;

40857 
JSVÆueC⁄°
 
∑âîn1
, 
Êags1
;

40858 
JSVÆue
 
bc
, 
∑âîn
;

40860 
ª
 = 
	`js_gë_ªgexp
(
˘x
, 
this_vÆ
, 
TRUE
);

40861 i‡(!
ª
)

40862  
JS_EXCEPTION
;

40863 
∑âîn1
 = 
¨gv
[0];

40864 
Êags1
 = 
¨gv
[1];

40865 
ª1
 = 
	`js_gë_ªgexp
(
˘x
, 
∑âîn1
, 
FALSE
);

40866 i‡(
ª1
) {

40867 i‡(!
	`JS_IsUndeföed
(
Êags1
))

40868  
	`JS_ThrowTy≥Eº‹
(
˘x
, "flags must be undefined");

40869 
∑âîn
 = 
	`JS_DupVÆue
(
˘x
, 
	`JS_MKPTR
(
JS_TAG_STRING
, 
ª1
->pattern));

40870 
bc
 = 
	`JS_DupVÆue
(
˘x
, 
	`JS_MKPTR
(
JS_TAG_STRING
, 
ª1
->
byãcode
));

40872 
bc
 = 
JS_UNDEFINED
;

40873 i‡(
	`JS_IsUndeföed
(
∑âîn1
))

40874 
∑âîn
 = 
	`JS_AtomToSåög
(
˘x
, 
JS_ATOM_em±y_°rög
);

40876 
∑âîn
 = 
	`JS_ToSåög
(
˘x
, 
∑âîn1
);

40877 i‡(
	`JS_IsEx˚±i⁄
(
∑âîn
))

40878 
Áû
;

40879 
bc
 = 
	`js_compûe_ªgexp
(
˘x
, 
∑âîn
, 
Êags1
);

40880 i‡(
	`JS_IsEx˚±i⁄
(
bc
))

40881 
Áû
;

40883 
	`JS_FªeVÆue
(
˘x
, 
	`JS_MKPTR
(
JS_TAG_STRING
, 
ª
->
∑âîn
));

40884 
	`JS_FªeVÆue
(
˘x
, 
	`JS_MKPTR
(
JS_TAG_STRING
, 
ª
->
byãcode
));

40885 
ª
->
∑âîn
 = 
	`JS_VALUE_GET_STRING
(pattern);

40886 
ª
->
byãcode
 = 
	`JS_VALUE_GET_STRING
(
bc
);

40887 i‡(
	`JS_SëPr›îty
(
˘x
, 
this_vÆ
, 
JS_ATOM_œ°Index
,

40888 
	`JS_NewI¡32
(
˘x
, 0)) < 0)

40889  
JS_EXCEPTION
;

40890  
	`JS_DupVÆue
(
˘x
, 
this_vÆ
);

40891 
Áû
:

40892 
	`JS_FªeVÆue
(
˘x
, 
∑âîn
);

40893 
	`JS_FªeVÆue
(
˘x
, 
bc
);

40894  
JS_EXCEPTION
;

40895 
	}
}

40898 
JSVÆue
 
	$js_ªgexp_gë___sour˚
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
)

40900 
JSRegExp
 *
ª
 = 
	`js_gë_ªgexp
(
˘x
, 
this_vÆ
, 
TRUE
);

40901 i‡(!
ª
)

40902  
JS_EXCEPTION
;

40903  
	`JS_DupVÆue
(
˘x
, 
	`JS_MKPTR
(
JS_TAG_STRING
, 
ª
->
∑âîn
));

40904 
	}
}

40906 
JSVÆue
 
	$js_ªgexp_gë___Êags
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
)

40908 
JSRegExp
 *
ª
 = 
	`js_gë_ªgexp
(
˘x
, 
this_vÆ
, 
TRUE
);

40909 
Êags
;

40911 i‡(!
ª
)

40912  
JS_EXCEPTION
;

40913 
Êags
 = 
	`Ãe_gë_Êags
(
ª
->
byãcode
->
u
.
°r8
);

40914  
	`JS_NewI¡32
(
˘x
, 
Êags
);

40915 
	}
}

40918 
JSVÆue
 
	$js_ªgexp_gë_sour˚
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
)

40920 
JSRegExp
 *
ª
;

40921 
JSSåög
 *
p
;

40922 
SåögBuf„r
 
b_s
, *
b
 = &b_s;

40923 
i
, 
n
, 
c
, 
c2
, 
bø
;

40925 i‡(
	`JS_VALUE_GET_TAG
(
this_vÆ
Ë!
JS_TAG_OBJECT
)

40926  
	`JS_ThrowTy≥Eº‹NŸAnObje˘
(
˘x
);

40928 i‡(
	`js_ßme_vÆue
(
˘x
, 
this_vÆ
, ctx->
˛ass_¥Ÿo
[
JS_CLASS_REGEXP
]))

40929 
em±y_ªgex
;

40931 
ª
 = 
	`js_gë_ªgexp
(
˘x
, 
this_vÆ
, 
TRUE
);

40932 i‡(!
ª
)

40933  
JS_EXCEPTION
;

40935 
p
 = 
ª
->
∑âîn
;

40937 i‡(
p
->
Àn
 == 0) {

40938 
em±y_ªgex
:

40939  
	`JS_NewSåög
(
˘x
, "(?:)");

40941 
	`°rög_buf„r_öô2
(
˘x
, 
b
, 
p
->
Àn
,Ö->
is_wide_ch¨
);

40944 
bø
 = 0;

40945 
i
 = 0, 
n
 = 
p
->
Àn
; i <Ç;) {

40946 
c2
 = -1;

40947 
c
 = 
	`°rög_gë
(
p
, 
i
++)) {

40949 i‡(
i
 < 
n
)

40950 
c2
 = 
	`°rög_gë
(
p
, 
i
++);

40953 
bø
 = 0;

40956 i‡(!
bø
) {

40957 i‡(
i
 < 
n
 && 
	`°rög_gë
(
p
, i) == ']')

40958 
c2
 = 
	`°rög_gë
(
p
, 
i
++);

40959 
bø
 = 1;

40963 
c
 = '\\';

40964 
c2
 = 'n';

40967 
c
 = '\\';

40968 
c2
 = 'r';

40971 i‡(!
bø
) {

40972 
c
 = '\\';

40973 
c2
 = '/';

40977 
	`°rög_buf„r_putc16
(
b
, 
c
);

40978 i‡(
c2
 >= 0)

40979 
	`°rög_buf„r_putc16
(
b
, 
c2
);

40981  
	`°rög_buf„r_íd
(
b
);

40982 
	}
}

40984 
JSVÆue
 
	$js_ªgexp_gë_Êag
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
, 
mask
)

40986 
JSRegExp
 *
ª
;

40987 
Êags
;

40989 i‡(
	`JS_VALUE_GET_TAG
(
this_vÆ
Ë!
JS_TAG_OBJECT
)

40990  
	`JS_ThrowTy≥Eº‹NŸAnObje˘
(
˘x
);

40992 
ª
 = 
	`js_gë_ªgexp
(
˘x
, 
this_vÆ
, 
FALSE
);

40993 i‡(!
ª
) {

40994 i‡(
	`js_ßme_vÆue
(
˘x
, 
this_vÆ
, ctx->
˛ass_¥Ÿo
[
JS_CLASS_REGEXP
]))

40995  
JS_UNDEFINED
;

40997  
	`JS_ThrowTy≥Eº‹InvÆidCœss
(
˘x
, 
JS_CLASS_REGEXP
);

41000 
Êags
 = 
	`Ãe_gë_Êags
(
ª
->
byãcode
->
u
.
°r8
);

41001  
	`JS_NewBoﬁ
(
˘x
, (
Êags
 & 
mask
) != 0);

41002 
	}
}

41004 
JSVÆue
 
	$js_ªgexp_gë_Êags
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
)

41006 
°r
[8], *
p
 = str;

41007 
ªs
;

41009 i‡(
	`JS_VALUE_GET_TAG
(
this_vÆ
Ë!
JS_TAG_OBJECT
)

41010  
	`JS_ThrowTy≥Eº‹NŸAnObje˘
(
˘x
);

41012 
ªs
 = 
	`JS_ToBoﬁFªe
(
˘x
, 
	`JS_GëPr›îty
(˘x, 
this_vÆ
, 
JS_ATOM_globÆ
));

41013 i‡(
ªs
 < 0)

41014 
ex˚±i⁄
;

41015 i‡(
ªs
)

41016 *
p
++ = 'g';

41017 
ªs
 = 
	`JS_ToBoﬁFªe
(
˘x
, 
	`JS_GëPr›îtySå
(˘x, 
this_vÆ
, "ignoreCase"));

41018 i‡(
ªs
 < 0)

41019 
ex˚±i⁄
;

41020 i‡(
ªs
)

41021 *
p
++ = 'i';

41022 
ªs
 = 
	`JS_ToBoﬁFªe
(
˘x
, 
	`JS_GëPr›îtySå
(˘x, 
this_vÆ
, "multiline"));

41023 i‡(
ªs
 < 0)

41024 
ex˚±i⁄
;

41025 i‡(
ªs
)

41026 *
p
++ = 'm';

41027 
ªs
 = 
	`JS_ToBoﬁFªe
(
˘x
, 
	`JS_GëPr›îtySå
(˘x, 
this_vÆ
, "dotAll"));

41028 i‡(
ªs
 < 0)

41029 
ex˚±i⁄
;

41030 i‡(
ªs
)

41031 *
p
++ = 's';

41032 
ªs
 = 
	`JS_ToBoﬁFªe
(
˘x
, 
	`JS_GëPr›îty
(˘x, 
this_vÆ
, 
JS_ATOM_unicode
));

41033 i‡(
ªs
 < 0)

41034 
ex˚±i⁄
;

41035 i‡(
ªs
)

41036 *
p
++ = 'u';

41037 
ªs
 = 
	`JS_ToBoﬁFªe
(
˘x
, 
	`JS_GëPr›îtySå
(˘x, 
this_vÆ
, "sticky"));

41038 i‡(
ªs
 < 0)

41039 
ex˚±i⁄
;

41040 i‡(
ªs
)

41041 *
p
++ = 'y';

41042  
	`JS_NewSåögLí
(
˘x
, 
°r
, 
p
 - str);

41044 
ex˚±i⁄
:

41045  
JS_EXCEPTION
;

41046 
	}
}

41048 
JSVÆue
 
	$js_ªgexp_toSåög
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

41049 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

41051 
JSVÆue
 
∑âîn
, 
Êags
;

41052 
SåögBuf„r
 
b_s
, *
b
 = &b_s;

41054 i‡(!
	`JS_IsObje˘
(
this_vÆ
))

41055  
	`JS_ThrowTy≥Eº‹NŸAnObje˘
(
˘x
);

41057 
	`°rög_buf„r_öô
(
˘x
, 
b
, 0);

41058 
	`°rög_buf„r_putc8
(
b
, '/');

41059 
∑âîn
 = 
	`JS_GëPr›îty
(
˘x
, 
this_vÆ
, 
JS_ATOM_sour˚
);

41060 i‡(
	`°rög_buf„r_c⁄ˇt_vÆue_‰ì
(
b
, 
∑âîn
))

41061 
Áû
;

41062 
	`°rög_buf„r_putc8
(
b
, '/');

41063 
Êags
 = 
	`JS_GëPr›îty
(
˘x
, 
this_vÆ
, 
JS_ATOM_Êags
);

41064 i‡(
	`°rög_buf„r_c⁄ˇt_vÆue_‰ì
(
b
, 
Êags
))

41065 
Áû
;

41066  
	`°rög_buf„r_íd
(
b
);

41068 
Áû
:

41069 
	`°rög_buf„r_‰ì
(
b
);

41070  
JS_EXCEPTION
;

41071 
	}
}

41073 
BOOL
 
	$Ãe_check_°ack_ovîÊow
(*
›aque
, 
size_t
 
Æloˇ_size
)

41075 
JSC⁄ãxt
 *
˘x
 = 
›aque
;

41076  
	`js_check_°ack_ovîÊow
(
˘x
->
π
, 
Æloˇ_size
);

41077 
	}
}

41079 *
	$Ãe_ªÆloc
(*
›aque
, *
±r
, 
size_t
 
size
)

41081 
JSC⁄ãxt
 *
˘x
 = 
›aque
;

41083  
	`js_ªÆloc_π
(
˘x
->
π
, 
±r
, 
size
);

41084 
	}
}

41086 
JSVÆue
 
	$js_ªgexp_exec
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

41087 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

41089 
JSRegExp
 *
ª
 = 
	`js_gë_ªgexp
(
˘x
, 
this_vÆ
, 
TRUE
);

41090 
JSSåög
 *
°r
;

41091 
JSVÆue
 
°r_vÆ
, 
obj
, 
vÆ
, 
groups
 = 
JS_UNDEFINED
;

41092 
uöt8_t
 *
ª_byãcode
;

41093 
ªt
;

41094 
uöt8_t
 **
ˇ±uª
, *
°r_buf
;

41095 
ˇ±uª_cou¡
, 
shi·
, 
i
, 
ª_Êags
;

41096 
söt64_t
 
œ°_ödex
;

41097 c⁄° *
group_«me_±r
;

41099 i‡(!
ª
)

41100  
JS_EXCEPTION
;

41101 
°r_vÆ
 = 
	`JS_ToSåög
(
˘x
, 
¨gv
[0]);

41102 i‡(
	`JS_IsEx˚±i⁄
(
°r_vÆ
))

41103  
°r_vÆ
;

41104 
vÆ
 = 
	`JS_GëPr›îty
(
˘x
, 
this_vÆ
, 
JS_ATOM_œ°Index
);

41105 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
) ||

41106 
	`JS_ToLígthFªe
(
˘x
, &
œ°_ödex
, 
vÆ
)) {

41107 
	`JS_FªeVÆue
(
˘x
, 
°r_vÆ
);

41108  
JS_EXCEPTION
;

41110 
ª_byãcode
 = 
ª
->
byãcode
->
u
.
°r8
;

41111 
ª_Êags
 = 
	`Ãe_gë_Êags
(
ª_byãcode
);

41112 i‡((
ª_Êags
 & (
LRE_FLAG_GLOBAL
 | 
LRE_FLAG_STICKY
)) == 0) {

41113 
œ°_ödex
 = 0;

41115 
°r
 = 
	`JS_VALUE_GET_STRING
(
°r_vÆ
);

41116 
ˇ±uª_cou¡
 = 
	`Ãe_gë_ˇ±uª_cou¡
(
ª_byãcode
);

41117 
ˇ±uª
 = 
NULL
;

41118 i‡(
ˇ±uª_cou¡
 > 0) {

41119 
ˇ±uª
 = 
	`js_mÆloc
(
˘x
, (ˇ±uª[0]Ë* 
ˇ±uª_cou¡
 * 2);

41120 i‡(!
ˇ±uª
) {

41121 
	`JS_FªeVÆue
(
˘x
, 
°r_vÆ
);

41122  
JS_EXCEPTION
;

41125 
shi·
 = 
°r
->
is_wide_ch¨
;

41126 
°r_buf
 = 
°r
->
u
.
°r8
;

41127 i‡(
œ°_ödex
 > 
°r
->
Àn
) {

41128 
ªt
 = 2;

41130 
ªt
 = 
	`Ãe_exec
(
ˇ±uª
, 
ª_byãcode
,

41131 
°r_buf
, 
œ°_ödex
, 
°r
->
Àn
,

41132 
shi·
, 
˘x
);

41134 
obj
 = 
JS_NULL
;

41135 i‡(
ªt
 != 1) {

41136 i‡(
ªt
 >= 0) {

41137 i‡(
ªt
 =2 || (
ª_Êags
 & (
LRE_FLAG_GLOBAL
 | 
LRE_FLAG_STICKY
))) {

41138 i‡(
	`JS_SëPr›îty
(
˘x
, 
this_vÆ
, 
JS_ATOM_œ°Index
,

41139 
	`JS_NewI¡32
(
˘x
, 0)) < 0)

41140 
Áû
;

41143 
	`JS_ThrowI¡î«lEº‹
(
˘x
, "out of memory inÑegexpÉxecution");

41144 
Áû
;

41146 
	`JS_FªeVÆue
(
˘x
, 
°r_vÆ
);

41148 
¥›_Êags
;

41149 i‡(
ª_Êags
 & (
LRE_FLAG_GLOBAL
 | 
LRE_FLAG_STICKY
)) {

41150 i‡(
	`JS_SëPr›îty
(
˘x
, 
this_vÆ
, 
JS_ATOM_œ°Index
,

41151 
	`JS_NewI¡32
(
˘x
, (
ˇ±uª
[1] - 
°r_buf
Ë>> 
shi·
)) < 0)

41152 
Áû
;

41154 
obj
 = 
	`JS_NewAºay
(
˘x
);

41155 i‡(
	`JS_IsEx˚±i⁄
(
obj
))

41156 
Áû
;

41157 
¥›_Êags
 = 
JS_PROP_C_W_E
 | 
JS_PROP_THROW
;

41158 
group_«me_±r
 = 
NULL
;

41159 i‡(
ª_Êags
 & 
LRE_FLAG_NAMED_GROUPS
) {

41160 
uöt32_t
 
ª_byãcode_Àn
;

41161 
groups
 = 
	`JS_NewObje˘PrŸo
(
˘x
, 
JS_NULL
);

41162 i‡(
	`JS_IsEx˚±i⁄
(
groups
))

41163 
Áû
;

41164 
ª_byãcode_Àn
 = 
	`gë_u32
(
ª_byãcode
 + 3);

41165 
group_«me_±r
 = (*)(
ª_byãcode
 + 7 + 
ª_byãcode_Àn
);

41168 
i
 = 0; i < 
ˇ±uª_cou¡
; i++) {

41169 
°¨t
, 
íd
;

41170 
JSVÆue
 
vÆ
;

41171 i‡(
ˇ±uª
[2 * 
i
] =
NULL
 ||

41172 
ˇ±uª
[2 * 
i
 + 1] =
NULL
) {

41173 
vÆ
 = 
JS_UNDEFINED
;

41175 
°¨t
 = (
ˇ±uª
[2 * 
i
] - 
°r_buf
Ë>> 
shi·
;

41176 
íd
 = (
ˇ±uª
[2 * 
i
 + 1] - 
°r_buf
Ë>> 
shi·
;

41177 
vÆ
 = 
	`js_sub_°rög
(
˘x
, 
°r
, 
°¨t
, 
íd
);

41178 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

41179 
Áû
;

41181 i‡(
group_«me_±r
 && 
i
 > 0) {

41182 i‡(*
group_«me_±r
) {

41183 i‡(
	`JS_DeföePr›îtyVÆueSå
(
˘x
, 
groups
, 
group_«me_±r
,

41184 
	`JS_DupVÆue
(
˘x
, 
vÆ
),

41185 
¥›_Êags
) < 0) {

41186 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

41187 
Áû
;

41190 
group_«me_±r
 +
	`°æí
(group_name_ptr) + 1;

41192 i‡(
	`JS_DeföePr›îtyVÆueUöt32
(
˘x
, 
obj
, 
i
, 
vÆ
, 
¥›_Êags
) < 0)

41193 
Áû
;

41195 i‡(
	`JS_DeföePr›îtyVÆue
(
˘x
, 
obj
, 
JS_ATOM_groups
,

41196 
groups
, 
¥›_Êags
) < 0)

41197 
Áû
;

41198 i‡(
	`JS_DeföePr›îtyVÆue
(
˘x
, 
obj
, 
JS_ATOM_ödex
,

41199 
	`JS_NewI¡32
(
˘x
, (
ˇ±uª
[0] - 
°r_buf
Ë>> 
shi·
), 
¥›_Êags
) < 0)

41200 
Áû
;

41201 i‡(
	`JS_DeföePr›îtyVÆue
(
˘x
, 
obj
, 
JS_ATOM_öput
, 
°r_vÆ
, 
¥›_Êags
) < 0)

41202 
Áû1
;

41204 
	`js_‰ì
(
˘x
, 
ˇ±uª
);

41205  
obj
;

41206 
Áû
:

41207 
	`JS_FªeVÆue
(
˘x
, 
groups
);

41208 
	`JS_FªeVÆue
(
˘x
, 
°r_vÆ
);

41209 
Áû1
:

41210 
	`JS_FªeVÆue
(
˘x
, 
obj
);

41211 
	`js_‰ì
(
˘x
, 
ˇ±uª
);

41212  
JS_EXCEPTION
;

41213 
	}
}

41216 
JSVÆue
 
	$JS_RegExpDñëe
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
, JSVÆueC⁄° 
¨g
)

41218 
JSRegExp
 *
ª
 = 
	`js_gë_ªgexp
(
˘x
, 
this_vÆ
, 
TRUE
);

41219 
JSSåög
 *
°r
;

41220 
JSVÆue
 
°r_vÆ
, 
vÆ
;

41221 
uöt8_t
 *
ª_byãcode
;

41222 
ªt
;

41223 
uöt8_t
 **
ˇ±uª
, *
°r_buf
;

41224 
ˇ±uª_cou¡
, 
shi·
, 
ª_Êags
;

41225 
√xt_§c_pos
, 
°¨t
, 
íd
;

41226 
söt64_t
 
œ°_ödex
;

41227 
SåögBuf„r
 
b_s
, *
b
 = &b_s;

41229 i‡(!
ª
)

41230  
JS_EXCEPTION
;

41232 
	`°rög_buf„r_öô
(
˘x
, 
b
, 0);

41234 
ˇ±uª
 = 
NULL
;

41235 
°r_vÆ
 = 
	`JS_ToSåög
(
˘x
, 
¨g
);

41236 i‡(
	`JS_IsEx˚±i⁄
(
°r_vÆ
))

41237 
Áû
;

41238 
°r
 = 
	`JS_VALUE_GET_STRING
(
°r_vÆ
);

41239 
ª_byãcode
 = 
ª
->
byãcode
->
u
.
°r8
;

41240 
ª_Êags
 = 
	`Ãe_gë_Êags
(
ª_byãcode
);

41241 i‡((
ª_Êags
 & (
LRE_FLAG_GLOBAL
 | 
LRE_FLAG_STICKY
)) == 0) {

41242 
œ°_ödex
 = 0;

41244 
vÆ
 = 
	`JS_GëPr›îty
(
˘x
, 
this_vÆ
, 
JS_ATOM_œ°Index
);

41245 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
Ë|| 
	`JS_ToLígthFªe
(
˘x
, &
œ°_ödex
, val))

41246 
Áû
;

41248 
ˇ±uª_cou¡
 = 
	`Ãe_gë_ˇ±uª_cou¡
(
ª_byãcode
);

41249 i‡(
ˇ±uª_cou¡
 > 0) {

41250 
ˇ±uª
 = 
	`js_mÆloc
(
˘x
, (ˇ±uª[0]Ë* 
ˇ±uª_cou¡
 * 2);

41251 i‡(!
ˇ±uª
)

41252 
Áû
;

41254 
shi·
 = 
°r
->
is_wide_ch¨
;

41255 
°r_buf
 = 
°r
->
u
.
°r8
;

41256 
√xt_§c_pos
 = 0;

41258 i‡(
œ°_ödex
 > 
°r
->
Àn
)

41261 
ªt
 = 
	`Ãe_exec
(
ˇ±uª
, 
ª_byãcode
,

41262 
°r_buf
, 
œ°_ödex
, 
°r
->
Àn
, 
shi·
, 
˘x
);

41263 i‡(
ªt
 != 1) {

41264 i‡(
ªt
 >= 0) {

41265 i‡(
ªt
 =2 || (
ª_Êags
 & (
LRE_FLAG_GLOBAL
 | 
LRE_FLAG_STICKY
))) {

41266 i‡(
	`JS_SëPr›îty
(
˘x
, 
this_vÆ
, 
JS_ATOM_œ°Index
,

41267 
	`JS_NewI¡32
(
˘x
, 0)) < 0)

41268 
Áû
;

41271 
	`JS_ThrowI¡î«lEº‹
(
˘x
, "out of memory inÑegexpÉxecution");

41272 
Áû
;

41276 
°¨t
 = (
ˇ±uª
[0] - 
°r_buf
Ë>> 
shi·
;

41277 
íd
 = (
ˇ±uª
[1] - 
°r_buf
Ë>> 
shi·
;

41278 
œ°_ödex
 = 
íd
;

41279 i‡(
√xt_§c_pos
 < 
°¨t
) {

41280 i‡(
	`°rög_buf„r_c⁄ˇt
(
b
, 
°r
, 
√xt_§c_pos
, 
°¨t
))

41281 
Áû
;

41283 
√xt_§c_pos
 = 
íd
;

41284 i‡(!(
ª_Êags
 & 
LRE_FLAG_GLOBAL
)) {

41285 i‡(
	`JS_SëPr›îty
(
˘x
, 
this_vÆ
, 
JS_ATOM_œ°Index
,

41286 
	`JS_NewI¡32
(
˘x
, 
íd
)) < 0)

41287 
Áû
;

41290 i‡(
íd
 =
°¨t
) {

41291 i‡(!(
ª_Êags
 & 
LRE_FLAG_UTF16
Ë|| ()
íd
 >
°r
->
Àn
 || !°r->
is_wide_ch¨
) {

41292 
íd
++;

41294 
	`°rög_gëc
(
°r
, &
íd
);

41297 
œ°_ödex
 = 
íd
;

41299 i‡(
	`°rög_buf„r_c⁄ˇt
(
b
, 
°r
, 
√xt_§c_pos
, så->
Àn
))

41300 
Áû
;

41301 
	`JS_FªeVÆue
(
˘x
, 
°r_vÆ
);

41302 
	`js_‰ì
(
˘x
, 
ˇ±uª
);

41303  
	`°rög_buf„r_íd
(
b
);

41304 
Áû
:

41305 
	`JS_FªeVÆue
(
˘x
, 
°r_vÆ
);

41306 
	`js_‰ì
(
˘x
, 
ˇ±uª
);

41307 
	`°rög_buf„r_‰ì
(
b
);

41308  
JS_EXCEPTION
;

41309 
	}
}

41311 
JSVÆue
 
	$JS_RegExpExec
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
r
, JSVÆueC⁄° 
s
)

41313 
JSVÆue
 
mëhod
, 
ªt
;

41315 
mëhod
 = 
	`JS_GëPr›îty
(
˘x
, 
r
, 
JS_ATOM_exec
);

41316 i‡(
	`JS_IsEx˚±i⁄
(
mëhod
))

41317  
mëhod
;

41318 i‡(
	`JS_IsFun˘i⁄
(
˘x
, 
mëhod
)) {

41319 
ªt
 = 
	`JS_CÆlFªe
(
˘x
, 
mëhod
, 
r
, 1, &
s
);

41320 i‡(
	`JS_IsEx˚±i⁄
(
ªt
))

41321  
ªt
;

41322 i‡(!
	`JS_IsObje˘
(
ªt
Ë&& !
	`JS_IsNuŒ
(ret)) {

41323 
	`JS_FªeVÆue
(
˘x
, 
ªt
);

41324  
	`JS_ThrowTy≥Eº‹
(
˘x
, "RegExpÉxec method mustÑeturnán object orÇull");

41326  
ªt
;

41328 
	`JS_FªeVÆue
(
˘x
, 
mëhod
);

41329  
	`js_ªgexp_exec
(
˘x
, 
r
, 1, &
s
);

41330 
	}
}

41333 
JSVÆue
 
	$js_ªgexp___RegExpExec
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

41334 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

41336  
	`JS_RegExpExec
(
˘x
, 
¨gv
[0],árgv[1]);

41337 
	}
}

41338 
JSVÆue
 
	$js_ªgexp___RegExpDñëe
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

41339 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

41341  
	`JS_RegExpDñëe
(
˘x
, 
¨gv
[0],árgv[1]);

41342 
	}
}

41345 
JSVÆue
 
	$js_ªgexp_ã°
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

41346 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

41348 
JSVÆue
 
vÆ
;

41349 
BOOL
 
ªt
;

41351 
vÆ
 = 
	`JS_RegExpExec
(
˘x
, 
this_vÆ
, 
¨gv
[0]);

41352 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

41353  
JS_EXCEPTION
;

41354 
ªt
 = !
	`JS_IsNuŒ
(
vÆ
);

41355 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

41356  
	`JS_NewBoﬁ
(
˘x
, 
ªt
);

41357 
	}
}

41359 
JSVÆue
 
	$js_ªgexp_Symbﬁ_m©ch
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

41360 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

41363 
JSVÆueC⁄°
 
rx
 = 
this_vÆ
;

41364 
JSVÆue
 
A
, 
S
, 
ªsu…
, 
m©chSå
;

41365 
globÆ
, 
n
, 
fuŒUnicode
, 
isEm±y
;

41366 
JSSåög
 *
p
;

41368 i‡(!
	`JS_IsObje˘
(
rx
))

41369  
	`JS_ThrowTy≥Eº‹NŸAnObje˘
(
˘x
);

41371 
A
 = 
JS_UNDEFINED
;

41372 
ªsu…
 = 
JS_UNDEFINED
;

41373 
m©chSå
 = 
JS_UNDEFINED
;

41374 
S
 = 
	`JS_ToSåög
(
˘x
, 
¨gv
[0]);

41375 i‡(
	`JS_IsEx˚±i⁄
(
S
))

41376 
ex˚±i⁄
;

41378 
globÆ
 = 
	`JS_ToBoﬁFªe
(
˘x
, 
	`JS_GëPr›îty
(˘x, 
rx
, 
JS_ATOM_globÆ
));

41379 i‡(
globÆ
 < 0)

41380 
ex˚±i⁄
;

41382 i‡(!
globÆ
) {

41383 
A
 = 
	`JS_RegExpExec
(
˘x
, 
rx
, 
S
);

41385 
fuŒUnicode
 = 
	`JS_ToBoﬁFªe
(
˘x
, 
	`JS_GëPr›îty
(˘x, 
rx
, 
JS_ATOM_unicode
));

41386 i‡(
fuŒUnicode
 < 0)

41387 
ex˚±i⁄
;

41389 i‡(
	`JS_SëPr›îty
(
˘x
, 
rx
, 
JS_ATOM_œ°Index
, 
	`JS_NewI¡32
(ctx, 0)) < 0)

41390 
ex˚±i⁄
;

41391 
A
 = 
	`JS_NewAºay
(
˘x
);

41392 i‡(
	`JS_IsEx˚±i⁄
(
A
))

41393 
ex˚±i⁄
;

41394 
n
 = 0;

41396 
	`JS_FªeVÆue
(
˘x
, 
ªsu…
);

41397 
ªsu…
 = 
	`JS_RegExpExec
(
˘x
, 
rx
, 
S
);

41398 i‡(
	`JS_IsEx˚±i⁄
(
ªsu…
))

41399 
ex˚±i⁄
;

41400 i‡(
	`JS_IsNuŒ
(
ªsu…
))

41402 
m©chSå
 = 
	`JS_ToSåögFªe
(
˘x
, 
	`JS_GëPr›îtyI¡64
(˘x, 
ªsu…
, 0));

41403 i‡(
	`JS_IsEx˚±i⁄
(
m©chSå
))

41404 
ex˚±i⁄
;

41405 
isEm±y
 = 
	`JS_IsEm±ySåög
(
m©chSå
);

41406 i‡(
	`JS_SëPr›îtyI¡64
(
˘x
, 
A
, 
n
++, 
m©chSå
) < 0)

41407 
ex˚±i⁄
;

41408 i‡(
isEm±y
) {

41409 
söt64_t
 
thisIndex
, 
√xtIndex
;

41410 i‡(
	`JS_ToLígthFªe
(
˘x
, &
thisIndex
,

41411 
	`JS_GëPr›îty
(
˘x
, 
rx
, 
JS_ATOM_œ°Index
)) < 0)

41412 
ex˚±i⁄
;

41413 
p
 = 
	`JS_VALUE_GET_STRING
(
S
);

41414 
√xtIndex
 = 
	`°rög_adv™˚_ödex
(
p
, 
thisIndex
, 
fuŒUnicode
);

41415 i‡(
	`JS_SëPr›îty
(
˘x
, 
rx
, 
JS_ATOM_œ°Index
, 
	`JS_NewI¡64
(˘x, 
√xtIndex
)) < 0)

41416 
ex˚±i⁄
;

41419 i‡(
n
 == 0) {

41420 
	`JS_FªeVÆue
(
˘x
, 
A
);

41421 
A
 = 
JS_NULL
;

41424 
	`JS_FªeVÆue
(
˘x
, 
ªsu…
);

41425 
	`JS_FªeVÆue
(
˘x
, 
S
);

41426  
A
;

41428 
ex˚±i⁄
:

41429 
	`JS_FªeVÆue
(
˘x
, 
A
);

41430 
	`JS_FªeVÆue
(
˘x
, 
ªsu…
);

41431 
	`JS_FªeVÆue
(
˘x
, 
S
);

41432  
JS_EXCEPTION
;

41433 
	}
}

41435 
	sJSRegExpSåögIãøt‹D©a
 {

41436 
JSVÆue
 
	môî©ög_ªgexp
;

41437 
JSVÆue
 
	môî©ed_°rög
;

41438 
BOOL
 
	mglobÆ
;

41439 
BOOL
 
	municode
;

41440 
BOOL
 
	md⁄e
;

41441 } 
	tJSRegExpSåögIãøt‹D©a
;

41443 
	$js_ªgexp_°rög_ôî©‹_föÆizî
(
JSRu¡ime
 *
π
, 
JSVÆue
 
vÆ
)

41445 
JSObje˘
 *
p
 = 
	`JS_VALUE_GET_OBJ
(
vÆ
);

41446 
JSRegExpSåögIãøt‹D©a
 *
ô
 = 
p
->
u
.
ªgexp_°rög_ôî©‹_d©a
;

41447 i‡(
ô
) {

41448 
	`JS_FªeVÆueRT
(
π
, 
ô
->
ôî©ög_ªgexp
);

41449 
	`JS_FªeVÆueRT
(
π
, 
ô
->
ôî©ed_°rög
);

41450 
	`js_‰ì_π
(
π
, 
ô
);

41452 
	}
}

41454 
	$js_ªgexp_°rög_ôî©‹_m¨k
(
JSRu¡ime
 *
π
, 
JSVÆueC⁄°
 
vÆ
,

41455 
JS_M¨kFunc
 *
m¨k_func
)

41457 
JSObje˘
 *
p
 = 
	`JS_VALUE_GET_OBJ
(
vÆ
);

41458 
JSRegExpSåögIãøt‹D©a
 *
ô
 = 
p
->
u
.
ªgexp_°rög_ôî©‹_d©a
;

41459 i‡(
ô
) {

41460 
	`JS_M¨kVÆue
(
π
, 
ô
->
ôî©ög_ªgexp
, 
m¨k_func
);

41461 
	`JS_M¨kVÆue
(
π
, 
ô
->
ôî©ed_°rög
, 
m¨k_func
);

41463 
	}
}

41465 
JSVÆue
 
	$js_ªgexp_°rög_ôî©‹_√xt
(
JSC⁄ãxt
 *
˘x
,

41466 
JSVÆueC⁄°
 
this_vÆ
,

41467 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
,

41468 
BOOL
 *
pd⁄e
, 
magic
)

41470 
JSRegExpSåögIãøt‹D©a
 *
ô
;

41471 
JSVÆueC⁄°
 
R
, 
S
;

41472 
JSVÆue
 
m©chSå
 = 
JS_UNDEFINED
, 
m©ch
 = JS_UNDEFINED;

41473 
JSSåög
 *
•
;

41475 
ô
 = 
	`JS_GëO∑que2
(
˘x
, 
this_vÆ
, 
JS_CLASS_REGEXP_STRING_ITERATOR
);

41476 i‡(!
ô
)

41477 
ex˚±i⁄
;

41478 i‡(
ô
->
d⁄e
) {

41479 *
pd⁄e
 = 
TRUE
;

41480  
JS_UNDEFINED
;

41482 
R
 = 
ô
->
ôî©ög_ªgexp
;

41483 
S
 = 
ô
->
ôî©ed_°rög
;

41484 
m©ch
 = 
	`JS_RegExpExec
(
˘x
, 
R
, 
S
);

41485 i‡(
	`JS_IsEx˚±i⁄
(
m©ch
))

41486 
ex˚±i⁄
;

41487 i‡(
	`JS_IsNuŒ
(
m©ch
)) {

41488 
ô
->
d⁄e
 = 
TRUE
;

41489 *
pd⁄e
 = 
TRUE
;

41490  
JS_UNDEFINED
;

41491 } i‡(
ô
->
globÆ
) {

41492 
m©chSå
 = 
	`JS_ToSåögFªe
(
˘x
, 
	`JS_GëPr›îtyI¡64
(˘x, 
m©ch
, 0));

41493 i‡(
	`JS_IsEx˚±i⁄
(
m©chSå
))

41494 
ex˚±i⁄
;

41495 i‡(
	`JS_IsEm±ySåög
(
m©chSå
)) {

41496 
söt64_t
 
thisIndex
, 
√xtIndex
;

41497 i‡(
	`JS_ToLígthFªe
(
˘x
, &
thisIndex
,

41498 
	`JS_GëPr›îty
(
˘x
, 
R
, 
JS_ATOM_œ°Index
)) < 0)

41499 
ex˚±i⁄
;

41500 
•
 = 
	`JS_VALUE_GET_STRING
(
S
);

41501 
√xtIndex
 = 
	`°rög_adv™˚_ödex
(
•
, 
thisIndex
, 
ô
->
unicode
);

41502 i‡(
	`JS_SëPr›îty
(
˘x
, 
R
, 
JS_ATOM_œ°Index
,

41503 
	`JS_NewI¡64
(
˘x
, 
√xtIndex
)) < 0)

41504 
ex˚±i⁄
;

41506 
	`JS_FªeVÆue
(
˘x
, 
m©chSå
);

41508 
ô
->
d⁄e
 = 
TRUE
;

41510 *
pd⁄e
 = 
FALSE
;

41511  
m©ch
;

41512 
ex˚±i⁄
:

41513 
	`JS_FªeVÆue
(
˘x
, 
m©ch
);

41514 
	`JS_FªeVÆue
(
˘x
, 
m©chSå
);

41515 *
pd⁄e
 = 
FALSE
;

41516  
JS_EXCEPTION
;

41517 
	}
}

41519 
JSVÆue
 
	$js_ªgexp_Symbﬁ_m©chAŒ
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

41520 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

41523 
JSVÆueC⁄°
 
R
 = 
this_vÆ
;

41524 
JSVÆue
 
S
, 
C
, 
Êags
, 
m©chî
, 
ôî
;

41525 
JSVÆueC⁄°
 
¨gs
[2];

41526 
JSSåög
 *
°Ω
;

41527 
söt64_t
 
œ°Index
;

41528 
JSRegExpSåögIãøt‹D©a
 *
ô
;

41530 i‡(!
	`JS_IsObje˘
(
R
))

41531  
	`JS_ThrowTy≥Eº‹NŸAnObje˘
(
˘x
);

41533 
C
 = 
JS_UNDEFINED
;

41534 
Êags
 = 
JS_UNDEFINED
;

41535 
m©chî
 = 
JS_UNDEFINED
;

41536 
ôî
 = 
JS_UNDEFINED
;

41538 
S
 = 
	`JS_ToSåög
(
˘x
, 
¨gv
[0]);

41539 i‡(
	`JS_IsEx˚±i⁄
(
S
))

41540 
ex˚±i⁄
;

41541 
C
 = 
	`JS_S≥cõsC⁄°ru˘‹
(
˘x
, 
R
, ctx->
ªgexp_˘‹
);

41542 i‡(
	`JS_IsEx˚±i⁄
(
C
))

41543 
ex˚±i⁄
;

41544 
Êags
 = 
	`JS_ToSåögFªe
(
˘x
, 
	`JS_GëPr›îty
(˘x, 
R
, 
JS_ATOM_Êags
));

41545 i‡(
	`JS_IsEx˚±i⁄
(
Êags
))

41546 
ex˚±i⁄
;

41547 
¨gs
[0] = 
R
;

41548 
¨gs
[1] = 
Êags
;

41549 
m©chî
 = 
	`JS_CÆlC⁄°ru˘‹
(
˘x
, 
C
, 2, 
¨gs
);

41550 i‡(
	`JS_IsEx˚±i⁄
(
m©chî
))

41551 
ex˚±i⁄
;

41552 i‡(
	`JS_ToLígthFªe
(
˘x
, &
œ°Index
,

41553 
	`JS_GëPr›îty
(
˘x
, 
R
, 
JS_ATOM_œ°Index
)))

41554 
ex˚±i⁄
;

41555 i‡(
	`JS_SëPr›îty
(
˘x
, 
m©chî
, 
JS_ATOM_œ°Index
,

41556 
	`JS_NewI¡64
(
˘x
, 
œ°Index
)) < 0)

41557 
ex˚±i⁄
;

41559 
ôî
 = 
	`JS_NewObje˘Cœss
(
˘x
, 
JS_CLASS_REGEXP_STRING_ITERATOR
);

41560 i‡(
	`JS_IsEx˚±i⁄
(
ôî
))

41561 
ex˚±i⁄
;

41562 
ô
 = 
	`js_mÆloc
(
˘x
, (*it));

41563 i‡(!
ô
)

41564 
ex˚±i⁄
;

41565 
ô
->
ôî©ög_ªgexp
 = 
m©chî
;

41566 
ô
->
ôî©ed_°rög
 = 
S
;

41567 
°Ω
 = 
	`JS_VALUE_GET_STRING
(
Êags
);

41568 
ô
->
globÆ
 = 
	`°rög_ödexof_ch¨
(
°Ω
, 'g', 0) >= 0;

41569 
ô
->
unicode
 = 
	`°rög_ödexof_ch¨
(
°Ω
, 'u', 0) >= 0;

41570 
ô
->
d⁄e
 = 
FALSE
;

41571 
	`JS_SëO∑que
(
ôî
, 
ô
);

41573 
	`JS_FªeVÆue
(
˘x
, 
C
);

41574 
	`JS_FªeVÆue
(
˘x
, 
Êags
);

41575  
ôî
;

41576 
ex˚±i⁄
:

41577 
	`JS_FªeVÆue
(
˘x
, 
S
);

41578 
	`JS_FªeVÆue
(
˘x
, 
C
);

41579 
	`JS_FªeVÆue
(
˘x
, 
Êags
);

41580 
	`JS_FªeVÆue
(
˘x
, 
m©chî
);

41581 
	`JS_FªeVÆue
(
˘x
, 
ôî
);

41582  
JS_EXCEPTION
;

41583 
	}
}

41585 
	sVÆueBuf„r
 {

41586 
JSC⁄ãxt
 *
	m˘x
;

41587 
JSVÆue
 *
	m¨r
;

41588 
JSVÆue
 
	mdef
[4];

41589 
	mÀn
;

41590 
	msize
;

41591 
	mîr‹_°©us
;

41592 } 
	tVÆueBuf„r
;

41594 
	$vÆue_buf„r_öô
(
JSC⁄ãxt
 *
˘x
, 
VÆueBuf„r
 *
b
)

41596 
b
->
˘x
 = ctx;

41597 
b
->
Àn
 = 0;

41598 
b
->
size
 = 4;

41599 
b
->
îr‹_°©us
 = 0;

41600 
b
->
¨r
 = b->
def
;

41602 
	}
}

41604 
	$vÆue_buf„r_‰ì
(
VÆueBuf„r
 *
b
)

41606 
b
->
Àn
 > 0)

41607 
	`JS_FªeVÆue
(
b
->
˘x
, b->
¨r
[--b->
Àn
]);

41608 i‡(
b
->
¨r
 !b->
def
)

41609 
	`js_‰ì
(
b
->
˘x
, b->
¨r
);

41610 
b
->
¨r
 = b->
def
;

41611 
b
->
size
 = 4;

41612 
	}
}

41614 
	$vÆue_buf„r_≠≥nd
(
VÆueBuf„r
 *
b
, 
JSVÆue
 
vÆ
)

41616 i‡(
b
->
îr‹_°©us
)

41619 i‡(
b
->
Àn
 >b->
size
) {

41620 
√w_size
 = (
b
->
Àn
 + (b->len >> 1) + 31) & ~16;

41621 
size_t
 
¶ack
;

41622 
JSVÆue
 *
√w_¨r
;

41624 i‡(
b
->
¨r
 =b->
def
) {

41625 
√w_¨r
 = 
	`js_ªÆloc2
(
b
->
˘x
, 
NULL
, (*b->
¨r
Ë* 
√w_size
, &
¶ack
);

41626 i‡(
√w_¨r
)

41627 
	`mem˝y
(
√w_¨r
, 
b
->
def
,  b->def);

41629 
√w_¨r
 = 
	`js_ªÆloc2
(
b
->
˘x
, b->
¨r
, (*b->¨rË* 
√w_size
, &
¶ack
);

41631 i‡(!
√w_¨r
) {

41632 
	`vÆue_buf„r_‰ì
(
b
);

41633 
	`JS_FªeVÆue
(
b
->
˘x
, 
vÆ
);

41634 
b
->
îr‹_°©us
 = -1;

41637 
√w_size
 +
¶ack
 / (*
√w_¨r
);

41638 
b
->
¨r
 = 
√w_¨r
;

41639 
b
->
size
 = 
√w_size
;

41641 
b
->
¨r
[b->
Àn
++] = 
vÆ
;

41643 
	}
}

41645 
	$js_is_°™d¨d_ªgexp
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
rx
)

41647 
JSVÆue
 
vÆ
;

41648 
ªs
;

41650 
vÆ
 = 
	`JS_GëPr›îty
(
˘x
, 
rx
, 
JS_ATOM_c⁄°ru˘‹
);

41651 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

41654 
ªs
 = 
	`js_ßme_vÆue
(
˘x
, 
vÆ
, ctx->
ªgexp_˘‹
);

41655 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

41656 i‡(
ªs
) {

41657 
vÆ
 = 
	`JS_GëPr›îty
(
˘x
, 
rx
, 
JS_ATOM_exec
);

41658 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

41661 
ªs
 = 
	`JS_IsCFun˘i⁄
(
˘x
, 
vÆ
, 
js_ªgexp_exec
, 0);

41662 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

41664  
ªs
;

41665 
	}
}

41667 
JSVÆue
 
	$js_ªgexp_Symbﬁ_ª∂a˚
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

41668 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

41671 
JSVÆueC⁄°
 
rx
 = 
this_vÆ
, 
ªp
 = 
¨gv
[1];

41672 
JSVÆueC⁄°
 
¨gs
[6];

41673 
JSVÆue
 
°r
, 
ªp_vÆ
, 
m©ched
, 
èb
, 
ªp_°r
, 
«medC≠tuªs
, 
ªs
;

41674 
JSSåög
 *
•
, *
Ω
;

41675 
SåögBuf„r
 
b_s
, *
b
 = &b_s;

41676 
VÆueBuf„r
 
v_b
, *
ªsu…s
 = &v_b;

41677 
√xtSour˚Posôi⁄
, 
n
, 
j
, 
fun˘i⁄ÆRïœ˚
, 
is_globÆ
, 
fuŒUnicode
;

41678 
uöt32_t
 
nC≠tuªs
;

41679 
söt64_t
 
posôi⁄
;

41681 i‡(!
	`JS_IsObje˘
(
rx
))

41682  
	`JS_ThrowTy≥Eº‹NŸAnObje˘
(
˘x
);

41684 
	`°rög_buf„r_öô
(
˘x
, 
b
, 0);

41685 
	`vÆue_buf„r_öô
(
˘x
, 
ªsu…s
);

41687 
ªp_vÆ
 = 
JS_UNDEFINED
;

41688 
m©ched
 = 
JS_UNDEFINED
;

41689 
èb
 = 
JS_UNDEFINED
;

41690 
ªp_°r
 = 
JS_UNDEFINED
;

41691 
«medC≠tuªs
 = 
JS_UNDEFINED
;

41693 
°r
 = 
	`JS_ToSåög
(
˘x
, 
¨gv
[0]);

41694 i‡(
	`JS_IsEx˚±i⁄
(
°r
))

41695 
ex˚±i⁄
;

41697 
•
 = 
	`JS_VALUE_GET_STRING
(
°r
);

41698 
Ω
 = 
NULL
;

41699 
fun˘i⁄ÆRïœ˚
 = 
	`JS_IsFun˘i⁄
(
˘x
, 
ªp
);

41700 i‡(!
fun˘i⁄ÆRïœ˚
) {

41701 
ªp_vÆ
 = 
	`JS_ToSåög
(
˘x
, 
ªp
);

41702 i‡(
	`JS_IsEx˚±i⁄
(
ªp_vÆ
))

41703 
ex˚±i⁄
;

41704 
Ω
 = 
	`JS_VALUE_GET_STRING
(
ªp_vÆ
);

41706 
fuŒUnicode
 = 0;

41707 
is_globÆ
 = 
	`JS_ToBoﬁFªe
(
˘x
, 
	`JS_GëPr›îty
(˘x, 
rx
, 
JS_ATOM_globÆ
));

41708 i‡(
is_globÆ
 < 0)

41709 
ex˚±i⁄
;

41710 i‡(
is_globÆ
) {

41711 
fuŒUnicode
 = 
	`JS_ToBoﬁFªe
(
˘x
, 
	`JS_GëPr›îty
(˘x, 
rx
, 
JS_ATOM_unicode
));

41712 i‡(
fuŒUnicode
 < 0)

41713 
ex˚±i⁄
;

41714 i‡(
	`JS_SëPr›îty
(
˘x
, 
rx
, 
JS_ATOM_œ°Index
, 
	`JS_NewI¡32
(ctx, 0)) < 0)

41715 
ex˚±i⁄
;

41718 i‡(
Ω
 &&Ñp->
Àn
 =0 && 
is_globÆ
 && 
	`js_is_°™d¨d_ªgexp
(
˘x
, 
rx
)) {

41720 
ªs
 = 
	`JS_RegExpDñëe
(
˘x
, 
rx
, 
°r
);

41721 
d⁄e
;

41724 
JSVÆue
 
ªsu…
;

41725 
ªsu…
 = 
	`JS_RegExpExec
(
˘x
, 
rx
, 
°r
);

41726 i‡(
	`JS_IsEx˚±i⁄
(
ªsu…
))

41727 
ex˚±i⁄
;

41728 i‡(
	`JS_IsNuŒ
(
ªsu…
))

41730 i‡(
	`vÆue_buf„r_≠≥nd
(
ªsu…s
, 
ªsu…
) < 0)

41731 
ex˚±i⁄
;

41732 i‡(!
is_globÆ
)

41734 
	`JS_FªeVÆue
(
˘x
, 
m©ched
);

41735 
m©ched
 = 
	`JS_ToSåögFªe
(
˘x
, 
	`JS_GëPr›îtyI¡64
(˘x, 
ªsu…
, 0));

41736 i‡(
	`JS_IsEx˚±i⁄
(
m©ched
))

41737 
ex˚±i⁄
;

41738 i‡(
	`JS_IsEm±ySåög
(
m©ched
)) {

41740 
söt64_t
 
thisIndex
, 
√xtIndex
;

41741 i‡(
	`JS_ToLígthFªe
(
˘x
, &
thisIndex
, 
	`JS_GëPr›îty
(˘x, 
rx
, 
JS_ATOM_œ°Index
)) < 0)

41742 
ex˚±i⁄
;

41743 
√xtIndex
 = 
	`°rög_adv™˚_ödex
(
•
, 
thisIndex
, 
fuŒUnicode
);

41744 i‡(
	`JS_SëPr›îty
(
˘x
, 
rx
, 
JS_ATOM_œ°Index
, 
	`JS_NewI¡64
(˘x, 
√xtIndex
)) < 0)

41745 
ex˚±i⁄
;

41748 
√xtSour˚Posôi⁄
 = 0;

41749 
j
 = 0; j < 
ªsu…s
->
Àn
; j++) {

41750 
JSVÆueC⁄°
 
ªsu…
;

41751 
ªsu…
 = 
ªsu…s
->
¨r
[
j
];

41752 i‡(
	`js_gë_Àngth32
(
˘x
, &
nC≠tuªs
, 
ªsu…
) < 0)

41753 
ex˚±i⁄
;

41754 
	`JS_FªeVÆue
(
˘x
, 
m©ched
);

41755 
m©ched
 = 
	`JS_ToSåögFªe
(
˘x
, 
	`JS_GëPr›îtyI¡64
(˘x, 
ªsu…
, 0));

41756 i‡(
	`JS_IsEx˚±i⁄
(
m©ched
))

41757 
ex˚±i⁄
;

41758 i‡(
	`JS_ToLígthFªe
(
˘x
, &
posôi⁄
, 
	`JS_GëPr›îty
(˘x, 
ªsu…
, 
JS_ATOM_ödex
)))

41759 
ex˚±i⁄
;

41760 i‡(
posôi⁄
 > 
•
->
Àn
)

41761 
posôi⁄
 = 
•
->
Àn
;

41762 i‡(
posôi⁄
 < 0)

41763 
posôi⁄
 = 0;

41766 
	`JS_FªeVÆue
(
˘x
, 
èb
);

41767 
èb
 = 
	`JS_NewAºay
(
˘x
);

41768 i‡(
	`JS_IsEx˚±i⁄
(
èb
))

41769 
ex˚±i⁄
;

41770 i‡(
	`JS_SëPr›îtyI¡64
(
˘x
, 
èb
, 0, 
	`JS_DupVÆue
(˘x, 
m©ched
)) < 0)

41771 
ex˚±i⁄
;

41772 
n
 = 1;Ç < 
nC≠tuªs
;Ç++) {

41773 
JSVÆue
 
ˇpN
;

41774 
ˇpN
 = 
	`JS_GëPr›îtyI¡64
(
˘x
, 
ªsu…
, 
n
);

41775 i‡(
	`JS_IsEx˚±i⁄
(
ˇpN
))

41776 
ex˚±i⁄
;

41777 i‡(!
	`JS_IsUndeföed
(
ˇpN
)) {

41778 
ˇpN
 = 
	`JS_ToSåögFªe
(
˘x
, capN);

41779 i‡(
	`JS_IsEx˚±i⁄
(
ˇpN
))

41780 
ex˚±i⁄
;

41782 i‡(
	`JS_SëPr›îtyI¡64
(
˘x
, 
èb
, 
n
, 
ˇpN
) < 0)

41783 
ex˚±i⁄
;

41785 
	`JS_FªeVÆue
(
˘x
, 
«medC≠tuªs
);

41786 
«medC≠tuªs
 = 
	`JS_GëPr›îty
(
˘x
, 
ªsu…
, 
JS_ATOM_groups
);

41787 i‡(
	`JS_IsEx˚±i⁄
(
«medC≠tuªs
))

41788 
ex˚±i⁄
;

41789 i‡(
fun˘i⁄ÆRïœ˚
) {

41790 i‡(
	`JS_SëPr›îtyI¡64
(
˘x
, 
èb
, 
n
++, 
	`JS_NewI¡32
(˘x, 
posôi⁄
)) < 0)

41791 
ex˚±i⁄
;

41792 i‡(
	`JS_SëPr›îtyI¡64
(
˘x
, 
èb
, 
n
++, 
	`JS_DupVÆue
(˘x, 
°r
)) < 0)

41793 
ex˚±i⁄
;

41794 i‡(!
	`JS_IsUndeföed
(
«medC≠tuªs
)) {

41795 i‡(
	`JS_SëPr›îtyI¡64
(
˘x
, 
èb
, 
n
++, 
	`JS_DupVÆue
(˘x, 
«medC≠tuªs
)) < 0)

41796 
ex˚±i⁄
;

41798 
¨gs
[0] = 
JS_UNDEFINED
;

41799 
¨gs
[1] = 
èb
;

41800 
	`JS_FªeVÆue
(
˘x
, 
ªp_°r
);

41801 
ªp_°r
 = 
	`JS_ToSåögFªe
(
˘x
, 
	`js_fun˘i⁄_≠∂y
(˘x, 
ªp
, 2, 
¨gs
, 0));

41803 
JSVÆue
 
«medC≠tuªs1
;

41804 i‡(!
	`JS_IsUndeföed
(
«medC≠tuªs
)) {

41805 
«medC≠tuªs1
 = 
	`JS_ToObje˘
(
˘x
, 
«medC≠tuªs
);

41806 i‡(
	`JS_IsEx˚±i⁄
(
«medC≠tuªs1
))

41807 
ex˚±i⁄
;

41809 
«medC≠tuªs1
 = 
JS_UNDEFINED
;

41811 
¨gs
[0] = 
m©ched
;

41812 
¨gs
[1] = 
°r
;

41813 
¨gs
[2] = 
	`JS_NewI¡32
(
˘x
, 
posôi⁄
);

41814 
¨gs
[3] = 
èb
;

41815 
¨gs
[4] = 
«medC≠tuªs1
;

41816 
¨gs
[5] = 
ªp_vÆ
;

41817 
	`JS_FªeVÆue
(
˘x
, 
ªp_°r
);

41818 
ªp_°r
 = 
	`js_°rög___GëSub°ôuti⁄
(
˘x
, 
JS_UNDEFINED
, 6, 
¨gs
);

41819 
	`JS_FªeVÆue
(
˘x
, 
«medC≠tuªs1
);

41821 i‡(
	`JS_IsEx˚±i⁄
(
ªp_°r
))

41822 
ex˚±i⁄
;

41823 i‡(
posôi⁄
 >
√xtSour˚Posôi⁄
) {

41824 
	`°rög_buf„r_c⁄ˇt
(
b
, 
•
, 
√xtSour˚Posôi⁄
, 
posôi⁄
);

41825 
	`°rög_buf„r_c⁄ˇt_vÆue
(
b
, 
ªp_°r
);

41826 
√xtSour˚Posôi⁄
 = 
posôi⁄
 + 
	`JS_VALUE_GET_STRING
(
m©ched
)->
Àn
;

41829 
	`°rög_buf„r_c⁄ˇt
(
b
, 
•
, 
√xtSour˚Posôi⁄
, sp->
Àn
);

41830 
ªs
 = 
	`°rög_buf„r_íd
(
b
);

41831 
d⁄e1
;

41833 
ex˚±i⁄
:

41834 
ªs
 = 
JS_EXCEPTION
;

41835 
d⁄e
:

41836 
	`°rög_buf„r_‰ì
(
b
);

41837 
d⁄e1
:

41838 
	`vÆue_buf„r_‰ì
(
ªsu…s
);

41839 
	`JS_FªeVÆue
(
˘x
, 
ªp_vÆ
);

41840 
	`JS_FªeVÆue
(
˘x
, 
m©ched
);

41841 
	`JS_FªeVÆue
(
˘x
, 
èb
);

41842 
	`JS_FªeVÆue
(
˘x
, 
ªp_°r
);

41843 
	`JS_FªeVÆue
(
˘x
, 
«medC≠tuªs
);

41844 
	`JS_FªeVÆue
(
˘x
, 
°r
);

41845  
ªs
;

41846 
	}
}

41848 
JSVÆue
 
	$js_ªgexp_Symbﬁ_£¨ch
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

41849 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

41851 
JSVÆueC⁄°
 
rx
 = 
this_vÆ
;

41852 
JSVÆue
 
°r
, 
¥eviousLa°Index
, 
cuºítLa°Index
, 
ªsu…
, 
ödex
;

41854 i‡(!
	`JS_IsObje˘
(
rx
))

41855  
	`JS_ThrowTy≥Eº‹NŸAnObje˘
(
˘x
);

41857 
ªsu…
 = 
JS_UNDEFINED
;

41858 
cuºítLa°Index
 = 
JS_UNDEFINED
;

41859 
¥eviousLa°Index
 = 
JS_UNDEFINED
;

41860 
°r
 = 
	`JS_ToSåög
(
˘x
, 
¨gv
[0]);

41861 i‡(
	`JS_IsEx˚±i⁄
(
°r
))

41862 
ex˚±i⁄
;

41864 
¥eviousLa°Index
 = 
	`JS_GëPr›îty
(
˘x
, 
rx
, 
JS_ATOM_œ°Index
);

41865 i‡(
	`JS_IsEx˚±i⁄
(
¥eviousLa°Index
))

41866 
ex˚±i⁄
;

41868 i‡(!
	`js_ßme_vÆue
(
˘x
, 
¥eviousLa°Index
, 
	`JS_NewI¡32
(ctx, 0))) {

41869 i‡(
	`JS_SëPr›îty
(
˘x
, 
rx
, 
JS_ATOM_œ°Index
, 
	`JS_NewI¡32
(ctx, 0)) < 0) {

41870 
ex˚±i⁄
;

41873 
ªsu…
 = 
	`JS_RegExpExec
(
˘x
, 
rx
, 
°r
);

41874 i‡(
	`JS_IsEx˚±i⁄
(
ªsu…
))

41875 
ex˚±i⁄
;

41876 
cuºítLa°Index
 = 
	`JS_GëPr›îty
(
˘x
, 
rx
, 
JS_ATOM_œ°Index
);

41877 i‡(
	`JS_IsEx˚±i⁄
(
cuºítLa°Index
))

41878 
ex˚±i⁄
;

41879 i‡(
	`js_ßme_vÆue
(
˘x
, 
cuºítLa°Index
, 
¥eviousLa°Index
)) {

41880 
	`JS_FªeVÆue
(
˘x
, 
¥eviousLa°Index
);

41882 i‡(
	`JS_SëPr›îty
(
˘x
, 
rx
, 
JS_ATOM_œ°Index
, 
¥eviousLa°Index
) < 0)

41883 
ex˚±i⁄
;

41885 
	`JS_FªeVÆue
(
˘x
, 
°r
);

41886 
	`JS_FªeVÆue
(
˘x
, 
cuºítLa°Index
);

41888 i‡(
	`JS_IsNuŒ
(
ªsu…
)) {

41889  
	`JS_NewI¡32
(
˘x
, -1);

41891 
ödex
 = 
	`JS_GëPr›îty
(
˘x
, 
ªsu…
, 
JS_ATOM_ödex
);

41892 
	`JS_FªeVÆue
(
˘x
, 
ªsu…
);

41893  
ödex
;

41896 
ex˚±i⁄
:

41897 
	`JS_FªeVÆue
(
˘x
, 
ªsu…
);

41898 
	`JS_FªeVÆue
(
˘x
, 
°r
);

41899 
	`JS_FªeVÆue
(
˘x
, 
cuºítLa°Index
);

41900 
	`JS_FªeVÆue
(
˘x
, 
¥eviousLa°Index
);

41901  
JS_EXCEPTION
;

41902 
	}
}

41904 
JSVÆue
 
	$js_ªgexp_Symbﬁ_•lô
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

41905 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

41908 
JSVÆueC⁄°
 
rx
 = 
this_vÆ
;

41909 
JSVÆueC⁄°
 
¨gs
[2];

41910 
JSVÆue
 
°r
, 
˘‹
, 
•lôãr
, 
A
, 
Êags
, 
z
, 
sub
;

41911 
JSSåög
 *
°Ω
;

41912 
uöt32_t
 
lim
, 
size
, 
p
, 
q
;

41913 
unicodeM©chög
;

41914 
söt64_t
 
ÀngthA
, 
e
, 
numbîOfC≠tuªs
, 
i
;

41916 i‡(!
	`JS_IsObje˘
(
rx
))

41917  
	`JS_ThrowTy≥Eº‹NŸAnObje˘
(
˘x
);

41919 
˘‹
 = 
JS_UNDEFINED
;

41920 
•lôãr
 = 
JS_UNDEFINED
;

41921 
A
 = 
JS_UNDEFINED
;

41922 
Êags
 = 
JS_UNDEFINED
;

41923 
z
 = 
JS_UNDEFINED
;

41924 
°r
 = 
	`JS_ToSåög
(
˘x
, 
¨gv
[0]);

41925 i‡(
	`JS_IsEx˚±i⁄
(
°r
))

41926 
ex˚±i⁄
;

41927 
˘‹
 = 
	`JS_S≥cõsC⁄°ru˘‹
(
˘x
, 
rx
, ctx->
ªgexp_˘‹
);

41928 i‡(
	`JS_IsEx˚±i⁄
(
˘‹
))

41929 
ex˚±i⁄
;

41930 
Êags
 = 
	`JS_ToSåögFªe
(
˘x
, 
	`JS_GëPr›îty
(˘x, 
rx
, 
JS_ATOM_Êags
));

41931 i‡(
	`JS_IsEx˚±i⁄
(
Êags
))

41932 
ex˚±i⁄
;

41933 
°Ω
 = 
	`JS_VALUE_GET_STRING
(
Êags
);

41934 
unicodeM©chög
 = 
	`°rög_ödexof_ch¨
(
°Ω
, 'u', 0) >= 0;

41935 i‡(
	`°rög_ödexof_ch¨
(
°Ω
, 'y', 0) < 0) {

41936 
Êags
 = 
	`JS_C⁄ˇtSåög3
(
˘x
, "", flags, "y");

41937 i‡(
	`JS_IsEx˚±i⁄
(
Êags
))

41938 
ex˚±i⁄
;

41940 
¨gs
[0] = 
rx
;

41941 
¨gs
[1] = 
Êags
;

41942 
•lôãr
 = 
	`JS_CÆlC⁄°ru˘‹
(
˘x
, 
˘‹
, 2, 
¨gs
);

41943 i‡(
	`JS_IsEx˚±i⁄
(
•lôãr
))

41944 
ex˚±i⁄
;

41945 
A
 = 
	`JS_NewAºay
(
˘x
);

41946 i‡(
	`JS_IsEx˚±i⁄
(
A
))

41947 
ex˚±i⁄
;

41948 
ÀngthA
 = 0;

41949 i‡(
	`JS_IsUndeföed
(
¨gv
[1])) {

41950 
lim
 = 0xffffffff;

41952 i‡(
	`JS_ToUöt32
(
˘x
, &
lim
, 
¨gv
[1]) < 0)

41953 
ex˚±i⁄
;

41954 i‡(
lim
 == 0)

41955 
d⁄e
;

41957 
°Ω
 = 
	`JS_VALUE_GET_STRING
(
°r
);

41958 
p
 = 
q
 = 0;

41959 
size
 = 
°Ω
->
Àn
;

41960 i‡(
size
 == 0) {

41961 
z
 = 
	`JS_RegExpExec
(
˘x
, 
•lôãr
, 
°r
);

41962 i‡(
	`JS_IsEx˚±i⁄
(
z
))

41963 
ex˚±i⁄
;

41964 i‡(
	`JS_IsNuŒ
(
z
))

41965 
add_èû
;

41966 
d⁄e
;

41968 
q
 < 
size
) {

41969 i‡(
	`JS_SëPr›îty
(
˘x
, 
•lôãr
, 
JS_ATOM_œ°Index
, 
	`JS_NewI¡32
(˘x, 
q
)) < 0)

41970 
ex˚±i⁄
;

41971 
	`JS_FªeVÆue
(
˘x
, 
z
);

41972 
z
 = 
	`JS_RegExpExec
(
˘x
, 
•lôãr
, 
°r
);

41973 i‡(
	`JS_IsEx˚±i⁄
(
z
))

41974 
ex˚±i⁄
;

41975 i‡(
	`JS_IsNuŒ
(
z
)) {

41976 
q
 = 
	`°rög_adv™˚_ödex
(
°Ω
, q, 
unicodeM©chög
);

41978 i‡(
	`JS_ToLígthFªe
(
˘x
, &
e
, 
	`JS_GëPr›îty
(˘x, 
•lôãr
, 
JS_ATOM_œ°Index
)))

41979 
ex˚±i⁄
;

41980 i‡(
e
 > 
size
)

41981 
e
 = 
size
;

41982 i‡(
e
 =
p
) {

41983 
q
 = 
	`°rög_adv™˚_ödex
(
°Ω
, q, 
unicodeM©chög
);

41985 
sub
 = 
	`js_sub_°rög
(
˘x
, 
°Ω
, 
p
, 
q
);

41986 i‡(
	`JS_IsEx˚±i⁄
(
sub
))

41987 
ex˚±i⁄
;

41988 i‡(
	`JS_SëPr›îtyI¡64
(
˘x
, 
A
, 
ÀngthA
++, 
sub
) < 0)

41989 
ex˚±i⁄
;

41990 i‡(
ÀngthA
 =
lim
)

41991 
d⁄e
;

41992 
p
 = 
e
;

41993 i‡(
	`js_gë_Àngth64
(
˘x
, &
numbîOfC≠tuªs
, 
z
))

41994 
ex˚±i⁄
;

41995 
i
 = 1; i < 
numbîOfC≠tuªs
; i++) {

41996 
sub
 = 
	`JS_ToSåögFªe
(
˘x
, 
	`JS_GëPr›îtyI¡64
(˘x, 
z
, 
i
));

41997 i‡(
	`JS_IsEx˚±i⁄
(
sub
))

41998 
ex˚±i⁄
;

41999 i‡(
	`JS_SëPr›îtyI¡64
(
˘x
, 
A
, 
ÀngthA
++, 
sub
) < 0)

42000 
ex˚±i⁄
;

42001 i‡(
ÀngthA
 =
lim
)

42002 
d⁄e
;

42004 
q
 = 
p
;

42008 
add_èû
:

42009 i‡(
p
 > 
size
)

42010 
p
 = 
size
;

42011 
sub
 = 
	`js_sub_°rög
(
˘x
, 
°Ω
, 
p
, 
size
);

42012 i‡(
	`JS_IsEx˚±i⁄
(
sub
))

42013 
ex˚±i⁄
;

42014 i‡(
	`JS_SëPr›îtyI¡64
(
˘x
, 
A
, 
ÀngthA
++, 
sub
) < 0)

42015 
ex˚±i⁄
;

42016 
d⁄e
;

42017 
ex˚±i⁄
:

42018 
	`JS_FªeVÆue
(
˘x
, 
A
);

42019 
A
 = 
JS_EXCEPTION
;

42020 
d⁄e
:

42021 
	`JS_FªeVÆue
(
˘x
, 
°r
);

42022 
	`JS_FªeVÆue
(
˘x
, 
˘‹
);

42023 
	`JS_FªeVÆue
(
˘x
, 
•lôãr
);

42024 
	`JS_FªeVÆue
(
˘x
, 
Êags
);

42025 
	`JS_FªeVÆue
(
˘x
, 
z
);

42026  
A
;

42027 
	}
}

42029 c⁄° 
JSCFun˘i⁄Li°E¡ry
 
	gjs_ªgexp_funcs
[] = {

42030 
JS_CGETSET_DEF
("[Symbﬁ.•ecõs]", 
js_gë_this
, 
NULL
 ),

42035 c⁄° 
JSCFun˘i⁄Li°E¡ry
 
	gjs_ªgexp_¥Ÿo_funcs
[] = {

42036 
JS_CGETSET_DEF
("Êags", 
js_ªgexp_gë_Êags
, 
NULL
 ),

42037 
JS_CGETSET_DEF
("sour˚", 
js_ªgexp_gë_sour˚
, 
NULL
 ),

42038 
JS_CGETSET_MAGIC_DEF
("globÆ", 
js_ªgexp_gë_Êag
, 
NULL
, 1 ),

42039 
JS_CGETSET_MAGIC_DEF
("ign‹eCa£", 
js_ªgexp_gë_Êag
, 
NULL
, 2 ),

42040 
JS_CGETSET_MAGIC_DEF
("mu…ûöe", 
js_ªgexp_gë_Êag
, 
NULL
, 4 ),

42041 
JS_CGETSET_MAGIC_DEF
("dŸAŒ", 
js_ªgexp_gë_Êag
, 
NULL
, 8 ),

42042 
JS_CGETSET_MAGIC_DEF
("unicode", 
js_ªgexp_gë_Êag
, 
NULL
, 16 ),

42043 
JS_CGETSET_MAGIC_DEF
("°icky", 
js_ªgexp_gë_Êag
, 
NULL
, 32 ),

42044 
JS_CFUNC_DEF
("exec", 1, 
js_ªgexp_exec
 ),

42045 
JS_CFUNC_DEF
("compûe", 2, 
js_ªgexp_compûe
 ),

42046 
JS_CFUNC_DEF
("ã°", 1, 
js_ªgexp_ã°
 ),

42047 
JS_CFUNC_DEF
("toSåög", 0, 
js_ªgexp_toSåög
 ),

42048 
JS_CFUNC_DEF
("[Symbﬁ.ª∂a˚]", 2, 
js_ªgexp_Symbﬁ_ª∂a˚
 ),

42049 
JS_CFUNC_DEF
("[Symbﬁ.m©ch]", 1, 
js_ªgexp_Symbﬁ_m©ch
 ),

42050 
JS_CFUNC_DEF
("[Symbﬁ.m©chAŒ]", 1, 
js_ªgexp_Symbﬁ_m©chAŒ
 ),

42051 
JS_CFUNC_DEF
("[Symbﬁ.£¨ch]", 1, 
js_ªgexp_Symbﬁ_£¨ch
 ),

42052 
JS_CFUNC_DEF
("[Symbﬁ.•lô]", 2, 
js_ªgexp_Symbﬁ_•lô
 ),

42057 c⁄° 
JSCFun˘i⁄Li°E¡ry
 
	gjs_ªgexp_°rög_ôî©‹_¥Ÿo_funcs
[] = {

42058 
JS_ITERATOR_NEXT_DEF
("√xt", 0, 
js_ªgexp_°rög_ôî©‹_√xt
, 0 ),

42059 
JS_PROP_STRING_DEF
("[Symbﬁ.toSåögTag]", "RegEx∞Såög Iãøt‹", 
JS_PROP_CONFIGURABLE
 ),

42062 
	$JS_AddI¡rösicRegExpCompûî
(
JSC⁄ãxt
 *
˘x
)

42064 
˘x
->
compûe_ªgexp
 = 
js_compûe_ªgexp
;

42065 
	}
}

42067 
	$JS_AddI¡rösicRegExp
(
JSC⁄ãxt
 *
˘x
)

42069 
JSVÆueC⁄°
 
obj
;

42071 
	`JS_AddI¡rösicRegExpCompûî
(
˘x
);

42073 
˘x
->
˛ass_¥Ÿo
[
JS_CLASS_REGEXP
] = 
	`JS_NewObje˘
(ctx);

42074 
	`JS_SëPr›îtyFun˘i⁄Li°
(
˘x
, ctx->
˛ass_¥Ÿo
[
JS_CLASS_REGEXP
], 
js_ªgexp_¥Ÿo_funcs
,

42075 
	`cou¡of
(
js_ªgexp_¥Ÿo_funcs
));

42076 
obj
 = 
	`JS_NewGlobÆCC⁄°ru˘‹
(
˘x
, "RegExp", 
js_ªgexp_c⁄°ru˘‹
, 2,

42077 
˘x
->
˛ass_¥Ÿo
[
JS_CLASS_REGEXP
]);

42078 
˘x
->
ªgexp_˘‹
 = 
	`JS_DupVÆue
(˘x, 
obj
);

42079 
	`JS_SëPr›îtyFun˘i⁄Li°
(
˘x
, 
obj
, 
js_ªgexp_funcs
, 
	`cou¡of
(js_regexp_funcs));

42081 
˘x
->
˛ass_¥Ÿo
[
JS_CLASS_REGEXP_STRING_ITERATOR
] =

42082 
	`JS_NewObje˘PrŸo
(
˘x
, ctx->
ôî©‹_¥Ÿo
);

42083 
	`JS_SëPr›îtyFun˘i⁄Li°
(
˘x
, ctx->
˛ass_¥Ÿo
[
JS_CLASS_REGEXP_STRING_ITERATOR
],

42084 
js_ªgexp_°rög_ôî©‹_¥Ÿo_funcs
,

42085 
	`cou¡of
(
js_ªgexp_°rög_ôî©‹_¥Ÿo_funcs
));

42086 
	}
}

42093 
JSVÆue
 
	$js⁄_∑r£_vÆue
(
JSP¨£Sèã
 *
s
)

42095 
JSC⁄ãxt
 *
˘x
 = 
s
->ctx;

42096 
JSVÆue
 
vÆ
 = 
JS_NULL
;

42097 
BOOL
 
is_√g
;

42098 
ªt
;

42100 
s
->
tokí
.
vÆ
) {

42103 
JSVÆue
 
¥›_vÆ
, 
¥›_°r
;

42105 i‡(
	`√xt_tokí
(
s
))

42106 
Áû
;

42107 
vÆ
 = 
	`JS_NewObje˘
(
˘x
);

42108 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

42109 
Áû
;

42110 i‡(
s
->
tokí
.
vÆ
 != '}') {

42112 i‡(
s
->
tokí
.
vÆ
 !
TOK_STRING
) {

42113 
	`js_∑r£_îr‹
(
s
, "expectingÖropertyÇame");

42114 
Áû
;

42116 
¥›_°r
 = 
	`JS_DupVÆue
(
˘x
, 
s
->
tokí
.
u
.
°r
.str);

42117 i‡(
	`√xt_tokí
(
s
)) {

42118 
	`JS_FªeVÆue
(
˘x
, 
¥›_°r
);

42119 
Áû
;

42121 i‡(
	`js_∑r£_ex≥˘
(
s
, ':')) {

42122 
	`JS_FªeVÆue
(
˘x
, 
¥›_°r
);

42123 
Áû
;

42125 
¥›_vÆ
 = 
	`js⁄_∑r£_vÆue
(
s
);

42126 i‡(
	`JS_IsEx˚±i⁄
(
¥›_vÆ
)) {

42127 
	`JS_FªeVÆue
(
˘x
, 
¥›_°r
);

42128 
Áû
;

42130 
ªt
 = 
	`JS_DeföePr›îtyVÆueVÆue
(
˘x
, 
vÆ
, 
¥›_°r
,

42131 
¥›_vÆ
, 
JS_PROP_C_W_E
);

42132 i‡(
ªt
 < 0)

42133 
Áû
;

42135 i‡(
s
->
tokí
.
vÆ
 != ',')

42137 i‡(
	`√xt_tokí
(
s
))

42138 
Áû
;

42141 i‡(
	`js_∑r£_ex≥˘
(
s
, '}'))

42142 
Áû
;

42147 
JSVÆue
 
ñ
;

42148 
uöt32_t
 
idx
;

42150 i‡(
	`√xt_tokí
(
s
))

42151 
Áû
;

42152 
vÆ
 = 
	`JS_NewAºay
(
˘x
);

42153 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

42154 
Áû
;

42155 i‡(
s
->
tokí
.
vÆ
 != ']') {

42156 
idx
 = 0;

42158 
ñ
 = 
	`js⁄_∑r£_vÆue
(
s
);

42159 i‡(
	`JS_IsEx˚±i⁄
(
ñ
))

42160 
Áû
;

42161 
ªt
 = 
	`JS_DeföePr›îtyVÆueUöt32
(
˘x
, 
vÆ
, 
idx
, 
ñ
, 
JS_PROP_C_W_E
);

42162 i‡(
ªt
 < 0)

42163 
Áû
;

42164 i‡(
s
->
tokí
.
vÆ
 != ',')

42166 i‡(
	`√xt_tokí
(
s
))

42167 
Áû
;

42168 
idx
++;

42171 i‡(
	`js_∑r£_ex≥˘
(
s
, ']'))

42172 
Áû
;

42175 
TOK_STRING
:

42176 
vÆ
 = 
	`JS_DupVÆue
(
˘x
, 
s
->
tokí
.
u
.
°r
.str);

42177 i‡(
	`√xt_tokí
(
s
))

42178 
Áû
;

42180 
TOK_NUMBER
:

42181 
is_√g
 = 0;

42182 
numbî
;

42184 i‡(
	`√xt_tokí
(
s
))

42185 
Áû
;

42186 i‡(
s
->
tokí
.
vÆ
 !
TOK_NUMBER
) {

42187 
	`js_∑r£_îr‹
(
s
, "numberÉxpected");

42188 
Áû
;

42190 
is_√g
 = 1;

42191 
numbî
:

42192 
vÆ
 = 
s
->
tokí
.
u
.
num
.val;

42193 i‡(
is_√g
) {

42194 
d
;

42195 
	`JS_ToFlﬂt64
(
˘x
, &
d
, 
vÆ
);

42196 
vÆ
 = 
	`JS_NewFlﬂt64
(
˘x
, -
d
);

42198 i‡(
	`√xt_tokí
(
s
))

42199 
Áû
;

42201 
TOK_FALSE
:

42202 
TOK_TRUE
:

42203 
vÆ
 = 
	`JS_NewBoﬁ
(
˘x
, 
s
->
tokí
.vÆ - 
TOK_FALSE
);

42204 i‡(
	`√xt_tokí
(
s
))

42205 
Áû
;

42207 
TOK_NULL
:

42208 i‡(
	`√xt_tokí
(
s
))

42209 
Áû
;

42212 i‡(
s
->
tokí
.
vÆ
 =
TOK_EOF
) {

42213 
	`js_∑r£_îr‹
(
s
, "unexpectedÉnd of input");

42215 
	`js_∑r£_îr‹
(
s
, "unexpectedÅoken: '%.*s'",

42216 ()(
s
->
buf_±r
 - s->
tokí
.
±r
), s->token.ptr);

42218 
Áû
;

42220  
vÆ
;

42221 
Áû
:

42222 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

42223  
JS_EXCEPTION
;

42224 
	}
}

42226 
JSVÆue
 
	$JS_P¨£JSON
(
JSC⁄ãxt
 *
˘x
, c⁄° *
buf
, 
size_t
 
buf_Àn
,

42227 c⁄° *
fûíame
)

42229 
JSP¨£Sèã
 
s1
, *
s
 = &s1;

42230 
JSVÆue
 
vÆ
;

42232 
	`js_∑r£_öô
(
˘x
, 
s
, 
buf
, 
buf_Àn
, 
fûíame
);

42234 i‡(
	`√xt_tokí
(
s
))

42235 
Áû
;

42236 
vÆ
 = 
	`js⁄_∑r£_vÆue
(
s
);

42237 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

42238 
Áû
;

42239 i‡(
s
->
tokí
.
vÆ
 !
TOK_EOF
) {

42240 i‡(
	`js_∑r£_îr‹
(
s
, "unexpected dataátÅheÉnd"))

42241 
Áû
;

42243  
vÆ
;

42244 
Áû
:

42245 
	`‰ì_tokí
(
s
, &s->
tokí
);

42246  
JS_EXCEPTION
;

42247 
	}
}

42249 
JSVÆue
 
	$öã∫Æize_js⁄_¥›îty
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
hﬁdî
,

42250 
JSAtom
 
«me
, 
JSVÆueC⁄°
 
ªvivî
)

42252 
JSVÆue
 
vÆ
, 
√w_ñ
, 
«me_vÆ
, 
ªs
;

42253 
JSVÆueC⁄°
 
¨gs
[2];

42254 
ªt
, 
is_¨øy
;

42255 
uöt32_t
 
i
, 
Àn
 = 0;

42256 
JSAtom
 
¥›
;

42257 
JSPr›îtyEnum
 *
©oms
 = 
NULL
;

42259 i‡(
	`js_check_°ack_ovîÊow
(
˘x
->
π
, 0)) {

42260  
	`JS_ThrowSèckOvîÊow
(
˘x
);

42263 
vÆ
 = 
	`JS_GëPr›îty
(
˘x
, 
hﬁdî
, 
«me
);

42264 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

42265  
vÆ
;

42266 i‡(
	`JS_IsObje˘
(
vÆ
)) {

42267 
is_¨øy
 = 
	`JS_IsAºay
(
˘x
, 
vÆ
);

42268 i‡(
is_¨øy
 < 0)

42269 
Áû
;

42270 i‡(
is_¨øy
) {

42271 i‡(
	`js_gë_Àngth32
(
˘x
, &
Àn
, 
vÆ
))

42272 
Áû
;

42274 
ªt
 = 
	`JS_GëOwnPr›îtyNamesI¡î«l
(
˘x
, &
©oms
, &
Àn
, 
	`JS_VALUE_GET_OBJ
(
vÆ
), 
JS_GPN_ENUM_ONLY
 | 
JS_GPN_STRING_MASK
);

42275 i‡(
ªt
 < 0)

42276 
Áû
;

42278 
i
 = 0; i < 
Àn
; i++) {

42279 i‡(
is_¨øy
) {

42280 
¥›
 = 
	`JS_NewAtomUI¡32
(
˘x
, 
i
);

42281 i‡(
¥›
 =
JS_ATOM_NULL
)

42282 
Áû
;

42284 
¥›
 = 
	`JS_DupAtom
(
˘x
, 
©oms
[
i
].
©om
);

42286 
√w_ñ
 = 
	`öã∫Æize_js⁄_¥›îty
(
˘x
, 
vÆ
, 
¥›
, 
ªvivî
);

42287 i‡(
	`JS_IsEx˚±i⁄
(
√w_ñ
)) {

42288 
	`JS_FªeAtom
(
˘x
, 
¥›
);

42289 
Áû
;

42291 i‡(
	`JS_IsUndeföed
(
√w_ñ
)) {

42292 
ªt
 = 
	`JS_DñëePr›îty
(
˘x
, 
vÆ
, 
¥›
, 0);

42294 
ªt
 = 
	`JS_DeföePr›îtyVÆue
(
˘x
, 
vÆ
, 
¥›
, 
√w_ñ
, 
JS_PROP_C_W_E
);

42296 
	`JS_FªeAtom
(
˘x
, 
¥›
);

42297 i‡(
ªt
 < 0)

42298 
Áû
;

42301 
	`js_‰ì_¥›_íum
(
˘x
, 
©oms
, 
Àn
);

42302 
©oms
 = 
NULL
;

42303 
«me_vÆ
 = 
	`JS_AtomToVÆue
(
˘x
, 
«me
);

42304 i‡(
	`JS_IsEx˚±i⁄
(
«me_vÆ
))

42305 
Áû
;

42306 
¨gs
[0] = 
«me_vÆ
;

42307 
¨gs
[1] = 
vÆ
;

42308 
ªs
 = 
	`JS_CÆl
(
˘x
, 
ªvivî
, 
hﬁdî
, 2, 
¨gs
);

42309 
	`JS_FªeVÆue
(
˘x
, 
«me_vÆ
);

42310 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

42311  
ªs
;

42312 
Áû
:

42313 
	`js_‰ì_¥›_íum
(
˘x
, 
©oms
, 
Àn
);

42314 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

42315  
JS_EXCEPTION
;

42316 
	}
}

42318 
JSVÆue
 
	$js_js⁄_∑r£
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

42319 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

42321 
JSVÆue
 
obj
, 
roŸ
;

42322 
JSVÆueC⁄°
 
ªvivî
;

42323 c⁄° *
°r
;

42324 
size_t
 
Àn
;

42326 
°r
 = 
	`JS_ToCSåögLí
(
˘x
, &
Àn
, 
¨gv
[0]);

42327 i‡(!
°r
)

42328  
JS_EXCEPTION
;

42329 
obj
 = 
	`JS_P¨£JSON
(
˘x
, 
°r
, 
Àn
, "<input>");

42330 
	`JS_FªeCSåög
(
˘x
, 
°r
);

42331 i‡(
	`JS_IsEx˚±i⁄
(
obj
))

42332  
obj
;

42333 i‡(
¨gc
 > 1 && 
	`JS_IsFun˘i⁄
(
˘x
, 
¨gv
[1])) {

42334 
ªvivî
 = 
¨gv
[1];

42335 
roŸ
 = 
	`JS_NewObje˘
(
˘x
);

42336 i‡(
	`JS_IsEx˚±i⁄
(
roŸ
)) {

42337 
	`JS_FªeVÆue
(
˘x
, 
obj
);

42338  
JS_EXCEPTION
;

42340 i‡(
	`JS_DeföePr›îtyVÆue
(
˘x
, 
roŸ
, 
JS_ATOM_em±y_°rög
, 
obj
,

42341 
JS_PROP_C_W_E
) < 0) {

42342 
	`JS_FªeVÆue
(
˘x
, 
roŸ
);

42343  
JS_EXCEPTION
;

42345 
obj
 = 
	`öã∫Æize_js⁄_¥›îty
(
˘x
, 
roŸ
, 
JS_ATOM_em±y_°rög
,

42346 
ªvivî
);

42347 
	`JS_FªeVÆue
(
˘x
, 
roŸ
);

42349  
obj
;

42350 
	}
}

42352 
	sJSONSåögifyC⁄ãxt
 {

42353 
JSVÆueC⁄°
 
	mª∂a˚r_func
;

42354 
JSVÆue
 
	m°ack
;

42355 
JSVÆue
 
	m¥›îty_li°
;

42356 
JSVÆue
 
	mg≠
;

42357 
JSVÆue
 
	mem±y
;

42358 
SåögBuf„r
 *
	mb
;

42359 } 
	tJSONSåögifyC⁄ãxt
;

42361 
JSVÆue
 
	$JS_ToQuŸedSåögFªe
(
JSC⁄ãxt
 *
˘x
, 
JSVÆue
 
vÆ
) {

42362 
JSVÆue
 
r
 = 
	`JS_ToQuŸedSåög
(
˘x
, 
vÆ
);

42363 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

42364  
r
;

42365 
	}
}

42367 
JSVÆue
 
	$js_js⁄_check
(
JSC⁄ãxt
 *
˘x
, 
JSONSåögifyC⁄ãxt
 *
jsc
,

42368 
JSVÆueC⁄°
 
hﬁdî
, 
JSVÆue
 
vÆ
, JSVÆueC⁄° 
key
)

42370 
JSVÆue
 
v
;

42371 
JSVÆueC⁄°
 
¨gs
[2];

42373 i‡(
	`JS_IsObje˘
(
vÆ
)

42374 #ifde‡
CONFIG_BIGNUM


42375 || 
	`JS_IsBigI¡
(
˘x
, 
vÆ
)

42378 
JSVÆue
 
f
 = 
	`JS_GëPr›îty
(
˘x
, 
vÆ
, 
JS_ATOM_toJSON
);

42379 i‡(
	`JS_IsEx˚±i⁄
(
f
))

42380 
ex˚±i⁄
;

42381 i‡(
	`JS_IsFun˘i⁄
(
˘x
, 
f
)) {

42382 
v
 = 
	`JS_CÆlFªe
(
˘x
, 
f
, 
vÆ
, 1, &
key
);

42383 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

42384 
vÆ
 = 
v
;

42385 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

42386 
ex˚±i⁄
;

42388 
	`JS_FªeVÆue
(
˘x
, 
f
);

42392 i‡(!
	`JS_IsUndeföed
(
jsc
->
ª∂a˚r_func
)) {

42393 
¨gs
[0] = 
key
;

42394 
¨gs
[1] = 
vÆ
;

42395 
v
 = 
	`JS_CÆl
(
˘x
, 
jsc
->
ª∂a˚r_func
, 
hﬁdî
, 2, 
¨gs
);

42396 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

42397 
vÆ
 = 
v
;

42398 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

42399 
ex˚±i⁄
;

42402 
	`JS_VALUE_GET_NORM_TAG
(
vÆ
)) {

42403 
JS_TAG_OBJECT
:

42404 i‡(
	`JS_IsFun˘i⁄
(
˘x
, 
vÆ
))

42406 
JS_TAG_STRING
:

42407 
JS_TAG_INT
:

42408 
JS_TAG_FLOAT64
:

42409 #ifde‡
CONFIG_BIGNUM


42410 
JS_TAG_BIG_FLOAT
:

42412 
JS_TAG_BOOL
:

42413 
JS_TAG_NULL
:

42414 #ifde‡
CONFIG_BIGNUM


42415 
JS_TAG_BIG_INT
:

42417 
JS_TAG_EXCEPTION
:

42418  
vÆ
;

42422 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

42423  
JS_UNDEFINED
;

42425 
ex˚±i⁄
:

42426 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

42427  
JS_EXCEPTION
;

42428 
	}
}

42430 
	$js_js⁄_to_°r
(
JSC⁄ãxt
 *
˘x
, 
JSONSåögifyC⁄ãxt
 *
jsc
,

42431 
JSVÆueC⁄°
 
hﬁdî
, 
JSVÆue
 
vÆ
,

42432 
JSVÆueC⁄°
 
ödít
)

42434 
JSVÆue
 
ödít1
, 
£p
, 
£p1
, 
èb
, 
v
, 
¥›
;

42435 
JSObje˘
 *
p
;

42436 
söt64_t
 
i
, 
Àn
;

42437 
˛
, 
ªt
;

42438 
BOOL
 
has_c⁄ã¡
;

42440 
ödít1
 = 
JS_UNDEFINED
;

42441 
£p
 = 
JS_UNDEFINED
;

42442 
£p1
 = 
JS_UNDEFINED
;

42443 
èb
 = 
JS_UNDEFINED
;

42444 
¥›
 = 
JS_UNDEFINED
;

42446 
	`JS_VALUE_GET_NORM_TAG
(
vÆ
)) {

42447 
JS_TAG_OBJECT
:

42448 
p
 = 
	`JS_VALUE_GET_OBJ
(
vÆ
);

42449 
˛
 = 
p
->
˛ass_id
;

42450 i‡(
˛
 =
JS_CLASS_STRING
) {

42451 
vÆ
 = 
	`JS_ToSåögFªe
(
˘x
, val);

42452 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

42453 
ex˚±i⁄
;

42454 
vÆ
 = 
	`JS_ToQuŸedSåögFªe
(
˘x
, val);

42455 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

42456 
ex˚±i⁄
;

42457  
	`°rög_buf„r_c⁄ˇt_vÆue_‰ì
(
jsc
->
b
, 
vÆ
);

42458 } i‡(
˛
 =
JS_CLASS_NUMBER
) {

42459 
vÆ
 = 
	`JS_ToNumbîFªe
(
˘x
, val);

42460 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

42461 
ex˚±i⁄
;

42462  
	`°rög_buf„r_c⁄ˇt_vÆue_‰ì
(
jsc
->
b
, 
vÆ
);

42463 } i‡(
˛
 =
JS_CLASS_BOOLEAN
) {

42464 
ªt
 = 
	`°rög_buf„r_c⁄ˇt_vÆue
(
jsc
->
b
, 
p
->
u
.
obje˘_d©a
);

42465 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

42466  
ªt
;

42468 #ifde‡
CONFIG_BIGNUM


42469 i‡(
˛
 =
JS_CLASS_BIG_FLOAT
) {

42470  
	`°rög_buf„r_c⁄ˇt_vÆue_‰ì
(
jsc
->
b
, 
vÆ
);

42471 } i‡(
˛
 =
JS_CLASS_BIG_INT
) {

42472 
	`JS_ThrowTy≥Eº‹
(
˘x
, "bigintáre forbidden in JSON.stringify");

42473 
ex˚±i⁄
;

42476 
v
 = 
	`js_¨øy_ö˛udes
(
˘x
, 
jsc
->
°ack
, 1, (
JSVÆueC⁄°
 *)&
vÆ
);

42477 i‡(
	`JS_IsEx˚±i⁄
(
v
))

42478 
ex˚±i⁄
;

42479 i‡(
	`JS_ToBoﬁFªe
(
˘x
, 
v
)) {

42480 
	`JS_ThrowTy≥Eº‹
(
˘x
, "circularÑeference");

42481 
ex˚±i⁄
;

42483 
ödít1
 = 
	`JS_C⁄ˇtSåög
(
˘x
, 
	`JS_DupVÆue
(˘x, 
ödít
), JS_DupVÆue(˘x, 
jsc
->
g≠
));

42484 i‡(
	`JS_IsEx˚±i⁄
(
ödít1
))

42485 
ex˚±i⁄
;

42486 i‡(!
	`JS_IsEm±ySåög
(
jsc
->
g≠
)) {

42487 
£p
 = 
	`JS_C⁄ˇtSåög3
(
˘x
, "\n", 
	`JS_DupVÆue
(˘x, 
ödít1
), "");

42488 i‡(
	`JS_IsEx˚±i⁄
(
£p
))

42489 
ex˚±i⁄
;

42490 
£p1
 = 
	`JS_NewSåög
(
˘x
, " ");

42491 i‡(
	`JS_IsEx˚±i⁄
(
£p1
))

42492 
ex˚±i⁄
;

42494 
£p
 = 
	`JS_DupVÆue
(
˘x
, 
jsc
->
em±y
);

42495 
£p1
 = 
	`JS_DupVÆue
(
˘x
, 
jsc
->
em±y
);

42497 
v
 = 
	`js_¨øy_push
(
˘x
, 
jsc
->
°ack
, 1, (
JSVÆueC⁄°
 *)&
vÆ
, 0);

42498 i‡(
	`check_ex˚±i⁄_‰ì
(
˘x
, 
v
))

42499 
ex˚±i⁄
;

42500 
ªt
 = 
	`JS_IsAºay
(
˘x
, 
vÆ
);

42501 i‡(
ªt
 < 0)

42502 
ex˚±i⁄
;

42503 i‡(
ªt
) {

42504 i‡(
	`js_gë_Àngth64
(
˘x
, &
Àn
, 
vÆ
))

42505 
ex˚±i⁄
;

42506 
	`°rög_buf„r_putc8
(
jsc
->
b
, '[');

42507 
i
 = 0; i < 
Àn
; i++) {

42508 i‡(
i
 > 0)

42509 
	`°rög_buf„r_putc8
(
jsc
->
b
, ',');

42510 
	`°rög_buf„r_c⁄ˇt_vÆue
(
jsc
->
b
, 
£p
);

42511 
v
 = 
	`JS_GëPr›îtyI¡64
(
˘x
, 
vÆ
, 
i
);

42512 i‡(
	`JS_IsEx˚±i⁄
(
v
))

42513 
ex˚±i⁄
;

42515 
¥›
 = 
	`JS_ToSåögFªe
(
˘x
, 
	`JS_NewI¡64
(˘x, 
i
));

42516 i‡(
	`JS_IsEx˚±i⁄
(
¥›
))

42517 
ex˚±i⁄
;

42518 
v
 = 
	`js_js⁄_check
(
˘x
, 
jsc
, 
vÆ
, v, 
¥›
);

42519 
	`JS_FªeVÆue
(
˘x
, 
¥›
);

42520 
¥›
 = 
JS_UNDEFINED
;

42521 i‡(
	`JS_IsEx˚±i⁄
(
v
))

42522 
ex˚±i⁄
;

42523 i‡(
	`JS_IsUndeföed
(
v
))

42524 
v
 = 
JS_NULL
;

42525 i‡(
	`js_js⁄_to_°r
(
˘x
, 
jsc
, 
vÆ
, 
v
, 
ödít1
))

42526 
ex˚±i⁄
;

42528 i‡(
Àn
 > 0 && !
	`JS_IsEm±ySåög
(
jsc
->
g≠
)) {

42529 
	`°rög_buf„r_putc8
(
jsc
->
b
, '\n');

42530 
	`°rög_buf„r_c⁄ˇt_vÆue
(
jsc
->
b
, 
ödít
);

42532 
	`°rög_buf„r_putc8
(
jsc
->
b
, ']');

42534 i‡(!
	`JS_IsUndeföed
(
jsc
->
¥›îty_li°
))

42535 
èb
 = 
	`JS_DupVÆue
(
˘x
, 
jsc
->
¥›îty_li°
);

42537 
èb
 = 
	`js_obje˘_keys
(
˘x
, 
JS_UNDEFINED
, 1, (
JSVÆueC⁄°
 *)&
vÆ
, 
JS_ITERATOR_KIND_KEY
);

42538 i‡(
	`JS_IsEx˚±i⁄
(
èb
))

42539 
ex˚±i⁄
;

42540 i‡(
	`js_gë_Àngth64
(
˘x
, &
Àn
, 
èb
))

42541 
ex˚±i⁄
;

42542 
	`°rög_buf„r_putc8
(
jsc
->
b
, '{');

42543 
has_c⁄ã¡
 = 
FALSE
;

42544 
i
 = 0; i < 
Àn
; i++) {

42545 
	`JS_FªeVÆue
(
˘x
, 
¥›
);

42546 
¥›
 = 
	`JS_GëPr›îtyI¡64
(
˘x
, 
èb
, 
i
);

42547 i‡(
	`JS_IsEx˚±i⁄
(
¥›
))

42548 
ex˚±i⁄
;

42549 
v
 = 
	`JS_GëPr›îtyVÆue
(
˘x
, 
vÆ
, 
	`JS_DupVÆue
(˘x, 
¥›
));

42550 i‡(
	`JS_IsEx˚±i⁄
(
v
))

42551 
ex˚±i⁄
;

42552 
v
 = 
	`js_js⁄_check
(
˘x
, 
jsc
, 
vÆ
, v, 
¥›
);

42553 i‡(
	`JS_IsEx˚±i⁄
(
v
))

42554 
ex˚±i⁄
;

42555 i‡(!
	`JS_IsUndeföed
(
v
)) {

42556 i‡(
has_c⁄ã¡
)

42557 
	`°rög_buf„r_putc8
(
jsc
->
b
, ',');

42558 
¥›
 = 
	`JS_ToQuŸedSåögFªe
(
˘x
,Örop);

42559 i‡(
	`JS_IsEx˚±i⁄
(
¥›
)) {

42560 
	`JS_FªeVÆue
(
˘x
, 
v
);

42561 
ex˚±i⁄
;

42563 
	`°rög_buf„r_c⁄ˇt_vÆue
(
jsc
->
b
, 
£p
);

42564 
	`°rög_buf„r_c⁄ˇt_vÆue
(
jsc
->
b
, 
¥›
);

42565 
	`°rög_buf„r_putc8
(
jsc
->
b
, ':');

42566 
	`°rög_buf„r_c⁄ˇt_vÆue
(
jsc
->
b
, 
£p1
);

42567 i‡(
	`js_js⁄_to_°r
(
˘x
, 
jsc
, 
vÆ
, 
v
, 
ödít1
))

42568 
ex˚±i⁄
;

42569 
has_c⁄ã¡
 = 
TRUE
;

42572 i‡(
has_c⁄ã¡
 && 
	`JS_VALUE_GET_STRING
(
jsc
->
g≠
)->
Àn
 != 0) {

42573 
	`°rög_buf„r_putc8
(
jsc
->
b
, '\n');

42574 
	`°rög_buf„r_c⁄ˇt_vÆue
(
jsc
->
b
, 
ödít
);

42576 
	`°rög_buf„r_putc8
(
jsc
->
b
, '}');

42578 i‡(
	`check_ex˚±i⁄_‰ì
(
˘x
, 
	`js_¨øy_p›
(˘x, 
jsc
->
°ack
, 0, 
NULL
, 0)))

42579 
ex˚±i⁄
;

42580 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

42581 
	`JS_FªeVÆue
(
˘x
, 
èb
);

42582 
	`JS_FªeVÆue
(
˘x
, 
£p
);

42583 
	`JS_FªeVÆue
(
˘x
, 
£p1
);

42584 
	`JS_FªeVÆue
(
˘x
, 
ödít1
);

42585 
	`JS_FªeVÆue
(
˘x
, 
¥›
);

42587 
JS_TAG_STRING
:

42588 
vÆ
 = 
	`JS_ToQuŸedSåögFªe
(
˘x
, val);

42589 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

42590 
ex˚±i⁄
;

42591 
c⁄ˇt_vÆue
;

42592 
JS_TAG_FLOAT64
:

42593 i‡(!
	`isföôe
(
	`JS_VALUE_GET_FLOAT64
(
vÆ
))) {

42594 
vÆ
 = 
JS_NULL
;

42596 
c⁄ˇt_vÆue
;

42597 
JS_TAG_INT
:

42598 #ifde‡
CONFIG_BIGNUM


42599 
JS_TAG_BIG_FLOAT
:

42601 
JS_TAG_BOOL
:

42602 
JS_TAG_NULL
:

42603 
c⁄ˇt_vÆue
:

42604  
	`°rög_buf„r_c⁄ˇt_vÆue_‰ì
(
jsc
->
b
, 
vÆ
);

42605 #ifde‡
CONFIG_BIGNUM


42606 
JS_TAG_BIG_INT
:

42607 
	`JS_ThrowTy≥Eº‹
(
˘x
, "bigintáre forbidden in JSON.stringify");

42608 
ex˚±i⁄
;

42611 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

42615 
ex˚±i⁄
:

42616 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

42617 
	`JS_FªeVÆue
(
˘x
, 
èb
);

42618 
	`JS_FªeVÆue
(
˘x
, 
£p
);

42619 
	`JS_FªeVÆue
(
˘x
, 
£p1
);

42620 
	`JS_FªeVÆue
(
˘x
, 
ödít1
);

42621 
	`JS_FªeVÆue
(
˘x
, 
¥›
);

42623 
	}
}

42625 
JSVÆue
 
	$JS_JSONSåögify
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
obj
,

42626 
JSVÆueC⁄°
 
ª∂a˚r
, JSVÆueC⁄° 
•a˚0
)

42628 
SåögBuf„r
 
b_s
;

42629 
JSONSåögifyC⁄ãxt
 
jsc_s
, *
jsc
 = &jsc_s;

42630 
JSVÆue
 
vÆ
, 
v
, 
•a˚
, 
ªt
, 
wøµî
;

42631 
ªs
;

42632 
söt64_t
 
i
, 
j
, 
n
;

42634 
jsc
->
ª∂a˚r_func
 = 
JS_UNDEFINED
;

42635 
jsc
->
°ack
 = 
JS_UNDEFINED
;

42636 
jsc
->
¥›îty_li°
 = 
JS_UNDEFINED
;

42637 
jsc
->
g≠
 = 
JS_UNDEFINED
;

42638 
jsc
->
b
 = &
b_s
;

42639 
jsc
->
em±y
 = 
	`JS_AtomToSåög
(
˘x
, 
JS_ATOM_em±y_°rög
);

42640 
ªt
 = 
JS_UNDEFINED
;

42641 
wøµî
 = 
JS_UNDEFINED
;

42643 
	`°rög_buf„r_öô
(
˘x
, 
jsc
->
b
, 0);

42644 
jsc
->
°ack
 = 
	`JS_NewAºay
(
˘x
);

42645 i‡(
	`JS_IsEx˚±i⁄
(
jsc
->
°ack
))

42646 
ex˚±i⁄
;

42647 i‡(
	`JS_IsFun˘i⁄
(
˘x
, 
ª∂a˚r
)) {

42648 
jsc
->
ª∂a˚r_func
 = 
ª∂a˚r
;

42650 
ªs
 = 
	`JS_IsAºay
(
˘x
, 
ª∂a˚r
);

42651 i‡(
ªs
 < 0)

42652 
ex˚±i⁄
;

42653 i‡(
ªs
) {

42655 
jsc
->
¥›îty_li°
 = 
	`JS_NewAºay
(
˘x
);

42656 i‡(
	`JS_IsEx˚±i⁄
(
jsc
->
¥›îty_li°
))

42657 
ex˚±i⁄
;

42658 i‡(
	`js_gë_Àngth64
(
˘x
, &
n
, 
ª∂a˚r
))

42659 
ex˚±i⁄
;

42660 
i
 = 
j
 = 0; i < 
n
; i++) {

42661 
JSVÆue
 
¥e£¡
;

42662 
v
 = 
	`JS_GëPr›îtyI¡64
(
˘x
, 
ª∂a˚r
, 
i
);

42663 i‡(
	`JS_IsEx˚±i⁄
(
v
))

42664 
ex˚±i⁄
;

42665 i‡(
	`JS_IsObje˘
(
v
)) {

42666 
JSObje˘
 *
p
 = 
	`JS_VALUE_GET_OBJ
(
v
);

42667 i‡(
p
->
˛ass_id
 =
JS_CLASS_STRING
 ||

42668 
p
->
˛ass_id
 =
JS_CLASS_NUMBER
) {

42669 
v
 = 
	`JS_ToSåögFªe
(
˘x
, v);

42670 i‡(
	`JS_IsEx˚±i⁄
(
v
))

42671 
ex˚±i⁄
;

42673 
	`JS_FªeVÆue
(
˘x
, 
v
);

42676 } i‡(
	`JS_IsNumbî
(
v
)) {

42677 
v
 = 
	`JS_ToSåögFªe
(
˘x
, v);

42678 i‡(
	`JS_IsEx˚±i⁄
(
v
))

42679 
ex˚±i⁄
;

42680 } i‡(!
	`JS_IsSåög
(
v
)) {

42681 
	`JS_FªeVÆue
(
˘x
, 
v
);

42684 
¥e£¡
 = 
	`js_¨øy_ö˛udes
(
˘x
, 
jsc
->
¥›îty_li°
,

42685 1, (
JSVÆueC⁄°
 *)&
v
);

42686 i‡(
	`JS_IsEx˚±i⁄
(
¥e£¡
)) {

42687 
	`JS_FªeVÆue
(
˘x
, 
v
);

42688 
ex˚±i⁄
;

42690 i‡(!
	`JS_ToBoﬁFªe
(
˘x
, 
¥e£¡
)) {

42691 
	`JS_SëPr›îtyI¡64
(
˘x
, 
jsc
->
¥›îty_li°
, 
j
++, 
v
);

42693 
	`JS_FªeVÆue
(
˘x
, 
v
);

42698 
•a˚
 = 
	`JS_DupVÆue
(
˘x
, 
•a˚0
);

42699 i‡(
	`JS_IsObje˘
(
•a˚
)) {

42700 
JSObje˘
 *
p
 = 
	`JS_VALUE_GET_OBJ
(
•a˚
);

42701 i‡(
p
->
˛ass_id
 =
JS_CLASS_NUMBER
) {

42702 
•a˚
 = 
	`JS_ToNumbîFªe
(
˘x
, space);

42703 } i‡(
p
->
˛ass_id
 =
JS_CLASS_STRING
) {

42704 
•a˚
 = 
	`JS_ToSåögFªe
(
˘x
, space);

42706 i‡(
	`JS_IsEx˚±i⁄
(
•a˚
)) {

42707 
	`JS_FªeVÆue
(
˘x
, 
•a˚
);

42708 
ex˚±i⁄
;

42711 i‡(
	`JS_IsNumbî
(
•a˚
)) {

42712 
n
;

42713 i‡(
	`JS_ToI¡32Cœmp
(
˘x
, &
n
, 
•a˚
, 0, 10, 0))

42714 
ex˚±i⁄
;

42715 
jsc
->
g≠
 = 
	`JS_NewSåögLí
(
˘x
, " ", 
n
);

42716 } i‡(
	`JS_IsSåög
(
•a˚
)) {

42717 
JSSåög
 *
p
 = 
	`JS_VALUE_GET_STRING
(
•a˚
);

42718 
jsc
->
g≠
 = 
	`js_sub_°rög
(
˘x
, 
p
, 0, 
	`mö_öt
’->
Àn
, 10));

42720 
jsc
->
g≠
 = 
	`JS_DupVÆue
(
˘x
, jsc->
em±y
);

42722 
	`JS_FªeVÆue
(
˘x
, 
•a˚
);

42723 i‡(
	`JS_IsEx˚±i⁄
(
jsc
->
g≠
))

42724 
ex˚±i⁄
;

42725 
wøµî
 = 
	`JS_NewObje˘
(
˘x
);

42726 i‡(
	`JS_IsEx˚±i⁄
(
wøµî
))

42727 
ex˚±i⁄
;

42728 i‡(
	`JS_DeföePr›îtyVÆue
(
˘x
, 
wøµî
, 
JS_ATOM_em±y_°rög
,

42729 
	`JS_DupVÆue
(
˘x
, 
obj
), 
JS_PROP_C_W_E
) < 0)

42730 
ex˚±i⁄
;

42731 
vÆ
 = 
	`JS_DupVÆue
(
˘x
, 
obj
);

42733 
vÆ
 = 
	`js_js⁄_check
(
˘x
, 
jsc
, 
wøµî
, vÆ, jsc->
em±y
);

42734 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

42735 
ex˚±i⁄
;

42736 i‡(
	`JS_IsUndeföed
(
vÆ
)) {

42737 
ªt
 = 
JS_UNDEFINED
;

42738 
d⁄e1
;

42740 i‡(
	`js_js⁄_to_°r
(
˘x
, 
jsc
, 
wøµî
, 
vÆ
, jsc->
em±y
))

42741 
ex˚±i⁄
;

42743 
ªt
 = 
	`°rög_buf„r_íd
(
jsc
->
b
);

42744 
d⁄e
;

42746 
ex˚±i⁄
:

42747 
ªt
 = 
JS_EXCEPTION
;

42748 
d⁄e1
:

42749 
	`°rög_buf„r_‰ì
(
jsc
->
b
);

42750 
d⁄e
:

42751 
	`JS_FªeVÆue
(
˘x
, 
wøµî
);

42752 
	`JS_FªeVÆue
(
˘x
, 
jsc
->
em±y
);

42753 
	`JS_FªeVÆue
(
˘x
, 
jsc
->
g≠
);

42754 
	`JS_FªeVÆue
(
˘x
, 
jsc
->
¥›îty_li°
);

42755 
	`JS_FªeVÆue
(
˘x
, 
jsc
->
°ack
);

42756  
ªt
;

42757 
	}
}

42759 
JSVÆue
 
	$js_js⁄_°rögify
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

42760 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

42763  
	`JS_JSONSåögify
(
˘x
, 
¨gv
[0],árgv[1],árgv[2]);

42764 
	}
}

42766 c⁄° 
JSCFun˘i⁄Li°E¡ry
 
	gjs_js⁄_funcs
[] = {

42767 
JS_CFUNC_DEF
("∑r£", 2, 
js_js⁄_∑r£
 ),

42768 
JS_CFUNC_DEF
("°rögify", 3, 
js_js⁄_°rögify
 ),

42769 
JS_PROP_STRING_DEF
("[Symbﬁ.toSåögTag]", "JSON", 
JS_PROP_CONFIGURABLE
 ),

42772 c⁄° 
JSCFun˘i⁄Li°E¡ry
 
	gjs_js⁄_obj
[] = {

42773 
JS_OBJECT_DEF
("JSON", 
js_js⁄_funcs
, 
cou¡of
(js_js⁄_funcs), 
JS_PROP_WRITABLE
 | 
JS_PROP_CONFIGURABLE
 ),

42776 
	$JS_AddI¡rösicJSON
(
JSC⁄ãxt
 *
˘x
)

42779 
	`JS_SëPr›îtyFun˘i⁄Li°
(
˘x
, ctx->
globÆ_obj
, 
js_js⁄_obj
, 
	`cou¡of
(js_json_obj));

42780 
	}
}

42784 
JSVÆue
 
	$js_ªÊe˘_≠∂y
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

42785 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

42787  
	`js_fun˘i⁄_≠∂y
(
˘x
, 
¨gv
[0], 
	`max_öt
(0, 
¨gc
 - 1),árgv + 1, 0);

42788 
	}
}

42790 
JSVÆue
 
	$js_ªÊe˘_c⁄°ru˘
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

42791 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

42793 
JSVÆueC⁄°
 
func
, 
¨øy_¨g
, 
√w_èrgë
;

42794 
JSVÆue
 *
èb
, 
ªt
;

42795 
uöt32_t
 
Àn
;

42797 
func
 = 
¨gv
[0];

42798 
¨øy_¨g
 = 
¨gv
[1];

42799 i‡(
¨gc
 > 2) {

42800 
√w_èrgë
 = 
¨gv
[2];

42801 i‡(!
	`JS_IsC⁄°ru˘‹
(
˘x
, 
√w_èrgë
))

42802  
	`JS_ThrowTy≥Eº‹
(
˘x
, "notá constructor");

42804 
√w_èrgë
 = 
func
;

42806 
èb
 = 
	`buûd_¨g_li°
(
˘x
, &
Àn
, 
¨øy_¨g
);

42807 i‡(!
èb
)

42808  
JS_EXCEPTION
;

42809 
ªt
 = 
	`JS_CÆlC⁄°ru˘‹2
(
˘x
, 
func
, 
√w_èrgë
, 
Àn
, (
JSVÆueC⁄°
 *)
èb
);

42810 
	`‰ì_¨g_li°
(
˘x
, 
èb
, 
Àn
);

42811  
ªt
;

42812 
	}
}

42814 
JSVÆue
 
	$js_ªÊe˘_dñëePr›îty
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

42815 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

42817 
JSVÆueC⁄°
 
obj
;

42818 
JSAtom
 
©om
;

42819 
ªt
;

42821 
obj
 = 
¨gv
[0];

42822 i‡(
	`JS_VALUE_GET_TAG
(
obj
Ë!
JS_TAG_OBJECT
)

42823  
	`JS_ThrowTy≥Eº‹NŸAnObje˘
(
˘x
);

42824 
©om
 = 
	`JS_VÆueToAtom
(
˘x
, 
¨gv
[1]);

42825 i‡(
	`u∆ikñy
(
©om
 =
JS_ATOM_NULL
))

42826  
JS_EXCEPTION
;

42827 
ªt
 = 
	`JS_DñëePr›îty
(
˘x
, 
obj
, 
©om
, 0);

42828 
	`JS_FªeAtom
(
˘x
, 
©om
);

42829 i‡(
ªt
 < 0)

42830  
JS_EXCEPTION
;

42832  
	`JS_NewBoﬁ
(
˘x
, 
ªt
);

42833 
	}
}

42835 
JSVÆue
 
	$js_ªÊe˘_gë
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

42836 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

42838 
JSVÆueC⁄°
 
obj
, 
¥›
, 
ª˚ivî
;

42839 
JSAtom
 
©om
;

42840 
JSVÆue
 
ªt
;

42842 
obj
 = 
¨gv
[0];

42843 
¥›
 = 
¨gv
[1];

42844 i‡(
	`JS_VALUE_GET_TAG
(
obj
Ë!
JS_TAG_OBJECT
)

42845  
	`JS_ThrowTy≥Eº‹NŸAnObje˘
(
˘x
);

42846 i‡(
¨gc
 > 2)

42847 
ª˚ivî
 = 
¨gv
[2];

42849 
ª˚ivî
 = 
obj
;

42850 
©om
 = 
	`JS_VÆueToAtom
(
˘x
, 
¥›
);

42851 i‡(
	`u∆ikñy
(
©om
 =
JS_ATOM_NULL
))

42852  
JS_EXCEPTION
;

42853 
ªt
 = 
	`JS_GëPr›îtyI¡î«l
(
˘x
, 
obj
, 
©om
, 
ª˚ivî
, 
FALSE
);

42854 
	`JS_FªeAtom
(
˘x
, 
©om
);

42855  
ªt
;

42856 
	}
}

42858 
JSVÆue
 
	$js_ªÊe˘_has
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

42859 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

42861 
JSVÆueC⁄°
 
obj
, 
¥›
;

42862 
JSAtom
 
©om
;

42863 
ªt
;

42865 
obj
 = 
¨gv
[0];

42866 
¥›
 = 
¨gv
[1];

42867 i‡(
	`JS_VALUE_GET_TAG
(
obj
Ë!
JS_TAG_OBJECT
)

42868  
	`JS_ThrowTy≥Eº‹NŸAnObje˘
(
˘x
);

42869 
©om
 = 
	`JS_VÆueToAtom
(
˘x
, 
¥›
);

42870 i‡(
	`u∆ikñy
(
©om
 =
JS_ATOM_NULL
))

42871  
JS_EXCEPTION
;

42872 
ªt
 = 
	`JS_HasPr›îty
(
˘x
, 
obj
, 
©om
);

42873 
	`JS_FªeAtom
(
˘x
, 
©om
);

42874 i‡(
ªt
 < 0)

42875  
JS_EXCEPTION
;

42877  
	`JS_NewBoﬁ
(
˘x
, 
ªt
);

42878 
	}
}

42880 
JSVÆue
 
	$js_ªÊe˘_£t
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

42881 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

42883 
JSVÆueC⁄°
 
obj
, 
¥›
, 
vÆ
, 
ª˚ivî
;

42884 
ªt
;

42885 
JSAtom
 
©om
;

42887 
obj
 = 
¨gv
[0];

42888 
¥›
 = 
¨gv
[1];

42889 
vÆ
 = 
¨gv
[2];

42890 i‡(
¨gc
 > 3)

42891 
ª˚ivî
 = 
¨gv
[3];

42893 
ª˚ivî
 = 
obj
;

42894 i‡(
	`JS_VALUE_GET_TAG
(
obj
Ë!
JS_TAG_OBJECT
)

42895  
	`JS_ThrowTy≥Eº‹NŸAnObje˘
(
˘x
);

42896 
©om
 = 
	`JS_VÆueToAtom
(
˘x
, 
¥›
);

42897 i‡(
	`u∆ikñy
(
©om
 =
JS_ATOM_NULL
))

42898  
JS_EXCEPTION
;

42899 
ªt
 = 
	`JS_SëPr›îtyGíîic
(
˘x
, 
	`JS_VALUE_GET_OBJ
(
obj
), 
©om
,

42900 
	`JS_DupVÆue
(
˘x
, 
vÆ
), 
ª˚ivî
, 0);

42901 
	`JS_FªeAtom
(
˘x
, 
©om
);

42902 i‡(
ªt
 < 0)

42903  
JS_EXCEPTION
;

42905  
	`JS_NewBoﬁ
(
˘x
, 
ªt
);

42906 
	}
}

42908 
JSVÆue
 
	$js_ªÊe˘_£tPrŸŸy≥Of
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

42909 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

42911 
ªt
;

42912 
ªt
 = 
	`JS_SëPrŸŸy≥I¡î«l
(
˘x
, 
¨gv
[0],árgv[1], 
FALSE
);

42913 i‡(
ªt
 < 0)

42914  
JS_EXCEPTION
;

42916  
	`JS_NewBoﬁ
(
˘x
, 
ªt
);

42917 
	}
}

42919 
JSVÆue
 
	$js_ªÊe˘_ownKeys
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

42920 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

42922 i‡(
	`JS_VALUE_GET_TAG
(
¨gv
[0]Ë!
JS_TAG_OBJECT
)

42923  
	`JS_ThrowTy≥Eº‹NŸAnObje˘
(
˘x
);

42924  
	`JS_GëOwnPr›îtyNames2
(
˘x
, 
¨gv
[0],

42925 
JS_GPN_STRING_MASK
 | 
JS_GPN_SYMBOL_MASK
,

42926 
JS_ITERATOR_KIND_KEY
);

42927 
	}
}

42929 c⁄° 
JSCFun˘i⁄Li°E¡ry
 
	gjs_ªÊe˘_funcs
[] = {

42930 
JS_CFUNC_DEF
("≠∂y", 3, 
js_ªÊe˘_≠∂y
 ),

42931 
JS_CFUNC_DEF
("c⁄°ru˘", 2, 
js_ªÊe˘_c⁄°ru˘
 ),

42932 
JS_CFUNC_MAGIC_DEF
("deföePr›îty", 3, 
js_obje˘_deföePr›îty
, 1 ),

42933 
JS_CFUNC_DEF
("dñëePr›îty", 2, 
js_ªÊe˘_dñëePr›îty
 ),

42934 
JS_CFUNC_DEF
("gë", 2, 
js_ªÊe˘_gë
 ),

42935 
JS_CFUNC_MAGIC_DEF
("gëOwnPr›îtyDes¸ùt‹", 2, 
js_obje˘_gëOwnPr›îtyDes¸ùt‹
, 1 ),

42936 
JS_CFUNC_MAGIC_DEF
("gëPrŸŸy≥Of", 1, 
js_obje˘_gëPrŸŸy≥Of
, 1 ),

42937 
JS_CFUNC_DEF
("has", 2, 
js_ªÊe˘_has
 ),

42938 
JS_CFUNC_MAGIC_DEF
("isExãnsibÀ", 1, 
js_obje˘_isExãnsibÀ
, 1 ),

42939 
JS_CFUNC_DEF
("ownKeys", 1, 
js_ªÊe˘_ownKeys
 ),

42940 
JS_CFUNC_MAGIC_DEF
("¥evítExãnsi⁄s", 1, 
js_obje˘_¥evítExãnsi⁄s
, 1 ),

42941 
JS_CFUNC_DEF
("£t", 3, 
js_ªÊe˘_£t
 ),

42942 
JS_CFUNC_DEF
("£tPrŸŸy≥Of", 2, 
js_ªÊe˘_£tPrŸŸy≥Of
 ),

42945 c⁄° 
JSCFun˘i⁄Li°E¡ry
 
	gjs_ªÊe˘_obj
[] = {

42946 
JS_OBJECT_DEF
("ReÊe˘", 
js_ªÊe˘_funcs
, 
cou¡of
(js_ªÊe˘_funcs), 
JS_PROP_WRITABLE
 | 
JS_PROP_CONFIGURABLE
 ),

42951 
	$js_¥oxy_föÆizî
(
JSRu¡ime
 *
π
, 
JSVÆue
 
vÆ
)

42953 
JSProxyD©a
 *
s
 = 
	`JS_GëO∑que
(
vÆ
, 
JS_CLASS_PROXY
);

42954 i‡(
s
) {

42955 
	`JS_FªeVÆueRT
(
π
, 
s
->
èrgë
);

42956 
	`JS_FªeVÆueRT
(
π
, 
s
->
h™dÀr
);

42957 
	`JS_FªeVÆueRT
(
π
, 
s
->
¥Ÿo
);

42958 
	`js_‰ì_π
(
π
, 
s
);

42960 
	}
}

42962 
	$js_¥oxy_m¨k
(
JSRu¡ime
 *
π
, 
JSVÆueC⁄°
 
vÆ
,

42963 
JS_M¨kFunc
 *
m¨k_func
)

42965 
JSProxyD©a
 *
s
 = 
	`JS_GëO∑que
(
vÆ
, 
JS_CLASS_PROXY
);

42966 i‡(
s
) {

42967 
	`JS_M¨kVÆue
(
π
, 
s
->
èrgë
, 
m¨k_func
);

42968 
	`JS_M¨kVÆue
(
π
, 
s
->
h™dÀr
, 
m¨k_func
);

42969 
	`JS_M¨kVÆue
(
π
, 
s
->
¥Ÿo
, 
m¨k_func
);

42971 
	}
}

42973 
JSVÆue
 
	$JS_ThrowTy≥Eº‹RevokedProxy
(
JSC⁄ãxt
 *
˘x
)

42975  
	`JS_ThrowTy≥Eº‹
(
˘x
, "revokedÖroxy");

42976 
	}
}

42978 
JSProxyD©a
 *
	$gë_¥oxy_mëhod
(
JSC⁄ãxt
 *
˘x
, 
JSVÆue
 *
pmëhod
,

42979 
JSVÆueC⁄°
 
obj
, 
JSAtom
 
«me
)

42981 
JSProxyD©a
 *
s
 = 
	`JS_GëO∑que
(
obj
, 
JS_CLASS_PROXY
);

42982 
JSVÆue
 
mëhod
;

42985 i‡(
	`js_check_°ack_ovîÊow
(
˘x
->
π
, 0)) {

42986 
	`JS_ThrowSèckOvîÊow
(
˘x
);

42987  
NULL
;

42991 i‡(
s
->
is_ªvoked
) {

42992 
	`JS_ThrowTy≥Eº‹RevokedProxy
(
˘x
);

42993  
NULL
;

42995 
mëhod
 = 
	`JS_GëPr›îty
(
˘x
, 
s
->
h™dÀr
, 
«me
);

42996 i‡(
	`JS_IsEx˚±i⁄
(
mëhod
))

42997  
NULL
;

42998 i‡(
	`JS_IsNuŒ
(
mëhod
))

42999 
mëhod
 = 
JS_UNDEFINED
;

43000 *
pmëhod
 = 
mëhod
;

43001  
s
;

43002 
	}
}

43004 
JSVÆueC⁄°
 
	$js_¥oxy_gëPrŸŸy≥Of
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
obj
)

43006 
JSProxyD©a
 *
s
;

43007 
JSVÆue
 
mëhod
, 
ªt
;

43008 
JSVÆueC⁄°
 
¥Ÿo1
;

43009 
ªs
;

43012 i‡(
	`js_pﬁl_öãºu±s
(
˘x
))

43013  
JS_EXCEPTION
;

43015 
s
 = 
	`gë_¥oxy_mëhod
(
˘x
, &
mëhod
, 
obj
, 
JS_ATOM_gëPrŸŸy≥Of
);

43016 i‡(!
s
)

43017  
JS_EXCEPTION
;

43018 i‡(
	`JS_IsUndeföed
(
mëhod
))

43019  
	`JS_GëPrŸŸy≥
(
˘x
, 
s
->
èrgë
);

43020 
ªt
 = 
	`JS_CÆlFªe
(
˘x
, 
mëhod
, 
s
->
h™dÀr
, 1, (
JSVÆueC⁄°
 *)&s->
èrgë
);

43021 i‡(
	`JS_IsEx˚±i⁄
(
ªt
))

43022  
ªt
;

43023 i‡(
	`JS_VALUE_GET_TAG
(
ªt
Ë!
JS_TAG_NULL
 &&

43024 
	`JS_VALUE_GET_TAG
(
ªt
Ë!
JS_TAG_OBJECT
) {

43025 
Áû
;

43027 
ªs
 = 
	`JS_IsExãnsibÀ
(
˘x
, 
s
->
èrgë
);

43028 i‡(
ªs
 < 0) {

43029 
	`JS_FªeVÆue
(
˘x
, 
ªt
);

43030  
JS_EXCEPTION
;

43032 i‡(!
ªs
) {

43034 
¥Ÿo1
 = 
	`JS_GëPrŸŸy≥
(
˘x
, 
s
->
èrgë
);

43035 i‡(
	`JS_IsEx˚±i⁄
(
¥Ÿo1
)) {

43036 
	`JS_FªeVÆue
(
˘x
, 
ªt
);

43037  
JS_EXCEPTION
;

43039 i‡(
	`JS_VALUE_GET_OBJ
(
¥Ÿo1
Ë!JS_VALUE_GET_OBJ(
ªt
)) {

43040 
Áû
:

43041 
	`JS_FªeVÆue
(
˘x
, 
ªt
);

43042  
	`JS_ThrowTy≥Eº‹
(
˘x
, "proxy: inconsistentÖrototype");

43046 
	`£t_vÆue
(
˘x
, &
s
->
¥Ÿo
, 
ªt
);

43047  (
JSVÆueC⁄°
)
ªt
;

43048 
	}
}

43050 
	$js_¥oxy_£tPrŸŸy≥Of
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
obj
,

43051 
JSVÆueC⁄°
 
¥Ÿo_vÆ
, 
BOOL
 
throw_Êag
)

43053 
JSProxyD©a
 *
s
;

43054 
JSVÆue
 
mëhod
, 
ªt
;

43055 
JSVÆueC⁄°
 
¨gs
[2], 
¥Ÿo1
;

43056 
BOOL
 
ªs
;

43057 
ªs2
;

43059 
s
 = 
	`gë_¥oxy_mëhod
(
˘x
, &
mëhod
, 
obj
, 
JS_ATOM_£tPrŸŸy≥Of
);

43060 i‡(!
s
)

43062 i‡(
	`JS_IsUndeföed
(
mëhod
))

43063  
	`JS_SëPrŸŸy≥I¡î«l
(
˘x
, 
s
->
èrgë
, 
¥Ÿo_vÆ
, 
throw_Êag
);

43064 
¨gs
[0] = 
s
->
èrgë
;

43065 
¨gs
[1] = 
¥Ÿo_vÆ
;

43066 
ªt
 = 
	`JS_CÆlFªe
(
˘x
, 
mëhod
, 
s
->
h™dÀr
, 2, 
¨gs
);

43067 i‡(
	`JS_IsEx˚±i⁄
(
ªt
))

43069 
ªs
 = 
	`JS_ToBoﬁFªe
(
˘x
, 
ªt
);

43070 i‡(!
ªs
) {

43071 i‡(
throw_Êag
) {

43072 
	`JS_ThrowTy≥Eº‹
(
˘x
, "proxy: badÖrototype");

43075  
FALSE
;

43078 
ªs2
 = 
	`JS_IsExãnsibÀ
(
˘x
, 
s
->
èrgë
);

43079 i‡(
ªs2
 < 0)

43081 i‡(!
ªs2
) {

43082 
¥Ÿo1
 = 
	`JS_GëPrŸŸy≥
(
˘x
, 
s
->
èrgë
);

43083 i‡(
	`JS_IsEx˚±i⁄
(
¥Ÿo1
))

43085 i‡(
	`JS_VALUE_GET_OBJ
(
¥Ÿo_vÆ
Ë!JS_VALUE_GET_OBJ(
¥Ÿo1
)) {

43086 
	`JS_ThrowTy≥Eº‹
(
˘x
, "proxy: inconsistentÖrototype");

43090  
TRUE
;

43091 
	}
}

43093 
	$js_¥oxy_isExãnsibÀ
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
obj
)

43095 
JSProxyD©a
 *
s
;

43096 
JSVÆue
 
mëhod
, 
ªt
;

43097 
BOOL
 
ªs
;

43098 
ªs2
;

43100 
s
 = 
	`gë_¥oxy_mëhod
(
˘x
, &
mëhod
, 
obj
, 
JS_ATOM_isExãnsibÀ
);

43101 i‡(!
s
)

43103 i‡(
	`JS_IsUndeföed
(
mëhod
))

43104  
	`JS_IsExãnsibÀ
(
˘x
, 
s
->
èrgë
);

43105 
ªt
 = 
	`JS_CÆlFªe
(
˘x
, 
mëhod
, 
s
->
h™dÀr
, 1, (
JSVÆueC⁄°
 *)&s->
èrgë
);

43106 i‡(
	`JS_IsEx˚±i⁄
(
ªt
))

43108 
ªs
 = 
	`JS_ToBoﬁFªe
(
˘x
, 
ªt
);

43109 
ªs2
 = 
	`JS_IsExãnsibÀ
(
˘x
, 
s
->
èrgë
);

43110 i‡(
ªs2
 < 0)

43111  
ªs2
;

43112 i‡(
ªs
 !
ªs2
) {

43113 
	`JS_ThrowTy≥Eº‹
(
˘x
, "proxy: inconsistent isExtensible");

43116  
ªs
;

43117 
	}
}

43119 
	$js_¥oxy_¥evítExãnsi⁄s
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
obj
)

43121 
JSProxyD©a
 *
s
;

43122 
JSVÆue
 
mëhod
, 
ªt
;

43123 
BOOL
 
ªs
;

43124 
ªs2
;

43126 
s
 = 
	`gë_¥oxy_mëhod
(
˘x
, &
mëhod
, 
obj
, 
JS_ATOM_¥evítExãnsi⁄s
);

43127 i‡(!
s
)

43129 i‡(
	`JS_IsUndeföed
(
mëhod
))

43130  
	`JS_PªvítExãnsi⁄s
(
˘x
, 
s
->
èrgë
);

43131 
ªt
 = 
	`JS_CÆlFªe
(
˘x
, 
mëhod
, 
s
->
h™dÀr
, 1, (
JSVÆueC⁄°
 *)&s->
èrgë
);

43132 i‡(
	`JS_IsEx˚±i⁄
(
ªt
))

43134 
ªs
 = 
	`JS_ToBoﬁFªe
(
˘x
, 
ªt
);

43135 i‡(
ªs
) {

43136 
ªs2
 = 
	`JS_IsExãnsibÀ
(
˘x
, 
s
->
èrgë
);

43137 i‡(
ªs2
 < 0)

43138  
ªs2
;

43139 i‡(
ªs2
) {

43140 
	`JS_ThrowTy≥Eº‹
(
˘x
, "proxy: inconsistentÖreventExtensions");

43144  
ªs
;

43145 
	}
}

43147 
	$js_¥oxy_has
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
obj
, 
JSAtom
 
©om
)

43149 
JSProxyD©a
 *
s
;

43150 
JSVÆue
 
mëhod
, 
ªt1
, 
©om_vÆ
;

43151 
ªt
, 
ªs
;

43152 
JSObje˘
 *
p
;

43153 
JSVÆueC⁄°
 
¨gs
[2];

43154 
BOOL
 
ªs2
;

43156 
s
 = 
	`gë_¥oxy_mëhod
(
˘x
, &
mëhod
, 
obj
, 
JS_ATOM_has
);

43157 i‡(!
s
)

43159 i‡(
	`JS_IsUndeföed
(
mëhod
))

43160  
	`JS_HasPr›îty
(
˘x
, 
s
->
èrgë
, 
©om
);

43161 
©om_vÆ
 = 
	`JS_AtomToVÆue
(
˘x
, 
©om
);

43162 i‡(
	`JS_IsEx˚±i⁄
(
©om_vÆ
)) {

43163 
	`JS_FªeVÆue
(
˘x
, 
mëhod
);

43166 
¨gs
[0] = 
s
->
èrgë
;

43167 
¨gs
[1] = 
©om_vÆ
;

43168 
ªt1
 = 
	`JS_CÆlFªe
(
˘x
, 
mëhod
, 
s
->
h™dÀr
, 2, 
¨gs
);

43169 
	`JS_FªeVÆue
(
˘x
, 
©om_vÆ
);

43170 i‡(
	`JS_IsEx˚±i⁄
(
ªt1
))

43172 
ªt
 = 
	`JS_ToBoﬁFªe
(
˘x
, 
ªt1
);

43173 i‡(!
ªt
) {

43174 
JSPr›îtyDes¸ùt‹
 
desc
;

43175 
p
 = 
	`JS_VALUE_GET_OBJ
(
s
->
èrgë
);

43176 
ªs
 = 
	`JS_GëOwnPr›îtyI¡î«l
(
˘x
, &
desc
, 
p
, 
©om
);

43177 i‡(
ªs
 < 0)

43179 i‡(
ªs
) {

43180 
ªs2
 = !(
desc
.
Êags
 & 
JS_PROP_CONFIGURABLE
);

43181 
	`js_‰ì_desc
(
˘x
, &
desc
);

43182 i‡(
ªs2
 || !
p
->
exãnsibÀ
) {

43183 
	`JS_ThrowTy≥Eº‹
(
˘x
, "proxy: inconsistent has");

43188  
ªt
;

43189 
	}
}

43191 
JSVÆue
 
	$js_¥oxy_gë
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
obj
, 
JSAtom
 
©om
,

43192 
JSVÆueC⁄°
 
ª˚ivî
)

43194 
JSProxyD©a
 *
s
;

43195 
JSVÆue
 
mëhod
, 
ªt
, 
©om_vÆ
;

43196 
ªs
;

43197 
JSVÆueC⁄°
 
¨gs
[3];

43198 
JSPr›îtyDes¸ùt‹
 
desc
;

43200 
s
 = 
	`gë_¥oxy_mëhod
(
˘x
, &
mëhod
, 
obj
, 
JS_ATOM_gë
);

43201 i‡(!
s
)

43202  
JS_EXCEPTION
;

43204 i‡(
	`JS_IsUndeföed
(
mëhod
))

43205  
	`JS_GëPr›îtyI¡î«l
(
˘x
, 
s
->
èrgë
, 
©om
, 
ª˚ivî
, 
FALSE
);

43206 
©om_vÆ
 = 
	`JS_AtomToVÆue
(
˘x
, 
©om
);

43207 i‡(
	`JS_IsEx˚±i⁄
(
©om_vÆ
)) {

43208 
	`JS_FªeVÆue
(
˘x
, 
mëhod
);

43209  
JS_EXCEPTION
;

43211 
¨gs
[0] = 
s
->
èrgë
;

43212 
¨gs
[1] = 
©om_vÆ
;

43213 
¨gs
[2] = 
ª˚ivî
;

43214 
ªt
 = 
	`JS_CÆlFªe
(
˘x
, 
mëhod
, 
s
->
h™dÀr
, 3, 
¨gs
);

43215 
	`JS_FªeVÆue
(
˘x
, 
©om_vÆ
);

43216 i‡(
	`JS_IsEx˚±i⁄
(
ªt
))

43217  
JS_EXCEPTION
;

43218 
ªs
 = 
	`JS_GëOwnPr›îtyI¡î«l
(
˘x
, &
desc
, 
	`JS_VALUE_GET_OBJ
(
s
->
èrgë
), 
©om
);

43219 i‡(
ªs
 < 0)

43220  
JS_EXCEPTION
;

43221 i‡(
ªs
) {

43222 i‡((
desc
.
Êags
 & (
JS_PROP_GETSET
 | 
JS_PROP_CONFIGURABLE
 | 
JS_PROP_WRITABLE
)) == 0) {

43223 i‡(!
	`js_ßme_vÆue
(
˘x
, 
desc
.
vÆue
, 
ªt
)) {

43224 
Áû
;

43226 } i‡((
desc
.
Êags
 & (
JS_PROP_GETSET
 | 
JS_PROP_CONFIGURABLE
)) == JS_PROP_GETSET) {

43227 i‡(
	`JS_IsUndeföed
(
desc
.
gëãr
Ë&& !JS_IsUndeföed(
ªt
)) {

43228 
Áû
:

43229 
	`js_‰ì_desc
(
˘x
, &
desc
);

43230 
	`JS_FªeVÆue
(
˘x
, 
ªt
);

43231  
	`JS_ThrowTy≥Eº‹
(
˘x
, "proxy: inconsistent get");

43234 
	`js_‰ì_desc
(
˘x
, &
desc
);

43236  
ªt
;

43237 
	}
}

43239 
	$js_¥oxy_£t
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
obj
, 
JSAtom
 
©om
,

43240 
JSVÆueC⁄°
 
vÆue
, JSVÆueC⁄° 
ª˚ivî
, 
Êags
)

43242 
JSProxyD©a
 *
s
;

43243 
JSVÆue
 
mëhod
, 
ªt1
, 
©om_vÆ
;

43244 
ªt
, 
ªs
;

43245 
JSVÆueC⁄°
 
¨gs
[4];

43247 
s
 = 
	`gë_¥oxy_mëhod
(
˘x
, &
mëhod
, 
obj
, 
JS_ATOM_£t
);

43248 i‡(!
s
)

43250 i‡(
	`JS_IsUndeföed
(
mëhod
)) {

43251  
	`JS_SëPr›îtyGíîic
(
˘x
, 
	`JS_VALUE_GET_OBJ
(
s
->
èrgë
), 
©om
,

43252 
	`JS_DupVÆue
(
˘x
, 
vÆue
), 
ª˚ivî
,

43253 
Êags
);

43255 
©om_vÆ
 = 
	`JS_AtomToVÆue
(
˘x
, 
©om
);

43256 i‡(
	`JS_IsEx˚±i⁄
(
©om_vÆ
)) {

43257 
	`JS_FªeVÆue
(
˘x
, 
mëhod
);

43260 
¨gs
[0] = 
s
->
èrgë
;

43261 
¨gs
[1] = 
©om_vÆ
;

43262 
¨gs
[2] = 
vÆue
;

43263 
¨gs
[3] = 
ª˚ivî
;

43264 
ªt1
 = 
	`JS_CÆlFªe
(
˘x
, 
mëhod
, 
s
->
h™dÀr
, 4, 
¨gs
);

43265 
	`JS_FªeVÆue
(
˘x
, 
©om_vÆ
);

43266 i‡(
	`JS_IsEx˚±i⁄
(
ªt1
))

43268 
ªt
 = 
	`JS_ToBoﬁFªe
(
˘x
, 
ªt1
);

43269 i‡(
ªt
) {

43270 
JSPr›îtyDes¸ùt‹
 
desc
;

43271 
ªs
 = 
	`JS_GëOwnPr›îtyI¡î«l
(
˘x
, &
desc
, 
	`JS_VALUE_GET_OBJ
(
s
->
èrgë
), 
©om
);

43272 i‡(
ªs
 < 0)

43274 i‡(
ªs
) {

43275 i‡((
desc
.
Êags
 & (
JS_PROP_GETSET
 | 
JS_PROP_CONFIGURABLE
 | 
JS_PROP_WRITABLE
)) == 0) {

43276 i‡(!
	`js_ßme_vÆue
(
˘x
, 
desc
.
vÆue
, value)) {

43277 
Áû
;

43279 } i‡((
desc
.
Êags
 & (
JS_PROP_GETSET
 | 
JS_PROP_CONFIGURABLE
)Ë=JS_PROP_GETSET && 
	`JS_IsUndeföed
(desc.
£âî
)) {

43280 
Áû
:

43281 
	`js_‰ì_desc
(
˘x
, &
desc
);

43282 
	`JS_ThrowTy≥Eº‹
(
˘x
, "proxy: inconsistent set");

43285 
	`js_‰ì_desc
(
˘x
, &
desc
);

43288 i‡((
Êags
 & 
JS_PROP_THROW
) ||

43289 ((
Êags
 & 
JS_PROP_THROW_STRICT
Ë&& 
	`is_°ri˘_mode
(
˘x
))) {

43290 
	`JS_ThrowTy≥Eº‹
(
˘x
, "proxy: cannot setÖroperty");

43294  
ªt
;

43295 
	}
}

43297 
JSVÆue
 
	$js_¸óã_desc
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
vÆ
,

43298 
JSVÆueC⁄°
 
gëãr
, JSVÆueC⁄° 
£âî
,

43299 
Êags
)

43301 
JSVÆue
 
ªt
;

43302 
ªt
 = 
	`JS_NewObje˘
(
˘x
);

43303 i‡(
	`JS_IsEx˚±i⁄
(
ªt
))

43304  
ªt
;

43305 i‡(
Êags
 & 
JS_PROP_HAS_GET
) {

43306 
	`JS_DeföePr›îtyVÆue
(
˘x
, 
ªt
, 
JS_ATOM_gë
, 
	`JS_DupVÆue
(˘x, 
gëãr
),

43307 
JS_PROP_C_W_E
);

43309 i‡(
Êags
 & 
JS_PROP_HAS_SET
) {

43310 
	`JS_DeföePr›îtyVÆue
(
˘x
, 
ªt
, 
JS_ATOM_£t
, 
	`JS_DupVÆue
(˘x, 
£âî
),

43311 
JS_PROP_C_W_E
);

43313 i‡(
Êags
 & 
JS_PROP_HAS_VALUE
) {

43314 
	`JS_DeföePr›îtyVÆue
(
˘x
, 
ªt
, 
JS_ATOM_vÆue
, 
	`JS_DupVÆue
(˘x, 
vÆ
),

43315 
JS_PROP_C_W_E
);

43317 i‡(
Êags
 & 
JS_PROP_HAS_WRITABLE
) {

43318 
	`JS_DeföePr›îtyVÆue
(
˘x
, 
ªt
, 
JS_ATOM_wrôabÀ
,

43319 
	`JS_NewBoﬁ
(
˘x
, (
Êags
 & 
JS_PROP_WRITABLE
) != 0),

43320 
JS_PROP_C_W_E
);

43322 i‡(
Êags
 & 
JS_PROP_HAS_ENUMERABLE
) {

43323 
	`JS_DeföePr›îtyVÆue
(
˘x
, 
ªt
, 
JS_ATOM_íumîabÀ
,

43324 
	`JS_NewBoﬁ
(
˘x
, (
Êags
 & 
JS_PROP_ENUMERABLE
) != 0),

43325 
JS_PROP_C_W_E
);

43327 i‡(
Êags
 & 
JS_PROP_HAS_CONFIGURABLE
) {

43328 
	`JS_DeföePr›îtyVÆue
(
˘x
, 
ªt
, 
JS_ATOM_c⁄figuøbÀ
,

43329 
	`JS_NewBoﬁ
(
˘x
, (
Êags
 & 
JS_PROP_CONFIGURABLE
) != 0),

43330 
JS_PROP_C_W_E
);

43332  
ªt
;

43333 
	}
}

43335 
	$js_¥oxy_gë_own_¥›îty
(
JSC⁄ãxt
 *
˘x
, 
JSPr›îtyDes¸ùt‹
 *
pdesc
,

43336 
JSVÆueC⁄°
 
obj
, 
JSAtom
 
¥›
)

43338 
JSProxyD©a
 *
s
;

43339 
JSVÆue
 
mëhod
, 
å≠_ªsu…_obj
, 
¥›_vÆ
;

43340 
ªs
, 
èrgë_desc_ªt
, 
ªt
;

43341 
JSObje˘
 *
p
;

43342 
JSVÆueC⁄°
 
¨gs
[2];

43343 
JSPr›îtyDes¸ùt‹
 
ªsu…_desc
, 
èrgë_desc
;

43345 
s
 = 
	`gë_¥oxy_mëhod
(
˘x
, &
mëhod
, 
obj
, 
JS_ATOM_gëOwnPr›îtyDes¸ùt‹
);

43346 i‡(!
s
)

43348 
p
 = 
	`JS_VALUE_GET_OBJ
(
s
->
èrgë
);

43349 i‡(
	`JS_IsUndeföed
(
mëhod
)) {

43350  
	`JS_GëOwnPr›îtyI¡î«l
(
˘x
, 
pdesc
, 
p
, 
¥›
);

43352 
¥›_vÆ
 = 
	`JS_AtomToVÆue
(
˘x
, 
¥›
);

43353 i‡(
	`JS_IsEx˚±i⁄
(
¥›_vÆ
)) {

43354 
	`JS_FªeVÆue
(
˘x
, 
mëhod
);

43357 
¨gs
[0] = 
s
->
èrgë
;

43358 
¨gs
[1] = 
¥›_vÆ
;

43359 
å≠_ªsu…_obj
 = 
	`JS_CÆlFªe
(
˘x
, 
mëhod
, 
s
->
h™dÀr
, 2, 
¨gs
);

43360 
	`JS_FªeVÆue
(
˘x
, 
¥›_vÆ
);

43361 i‡(
	`JS_IsEx˚±i⁄
(
å≠_ªsu…_obj
))

43363 i‡(!
	`JS_IsObje˘
(
å≠_ªsu…_obj
Ë&& !
	`JS_IsUndeföed
(trap_result_obj)) {

43364 
	`JS_FªeVÆue
(
˘x
, 
å≠_ªsu…_obj
);

43365 
Áû
;

43367 
èrgë_desc_ªt
 = 
	`JS_GëOwnPr›îtyI¡î«l
(
˘x
, &
èrgë_desc
, 
p
, 
¥›
);

43368 i‡(
èrgë_desc_ªt
 < 0) {

43369 
	`JS_FªeVÆue
(
˘x
, 
å≠_ªsu…_obj
);

43372 i‡(
èrgë_desc_ªt
)

43373 
	`js_‰ì_desc
(
˘x
, &
èrgë_desc
);

43374 i‡(
	`JS_IsUndeföed
(
å≠_ªsu…_obj
)) {

43375 i‡(
èrgë_desc_ªt
) {

43376 i‡(!(
èrgë_desc
.
Êags
 & 
JS_PROP_CONFIGURABLE
Ë|| !
p
->
exãnsibÀ
)

43377 
Áû
;

43379 
ªt
 = 
FALSE
;

43381 
Êags1
, 
exãnsibÀ_èrgë
;

43382 
exãnsibÀ_èrgë
 = 
	`JS_IsExãnsibÀ
(
˘x
, 
s
->
èrgë
);

43383 i‡(
exãnsibÀ_èrgë
 < 0) {

43384 
	`JS_FªeVÆue
(
˘x
, 
å≠_ªsu…_obj
);

43387 
ªs
 = 
	`js_obj_to_desc
(
˘x
, &
ªsu…_desc
, 
å≠_ªsu…_obj
);

43388 
	`JS_FªeVÆue
(
˘x
, 
å≠_ªsu…_obj
);

43389 i‡(
ªs
 < 0)

43392 i‡(
èrgë_desc_ªt
) {

43394 
Êags1
 = 
ªsu…_desc
.
Êags
 | 
JS_PROP_HAS_CONFIGURABLE
 | 
JS_PROP_HAS_ENUMERABLE
;

43395 i‡(
ªsu…_desc
.
Êags
 & 
JS_PROP_GETSET
)

43396 
Êags1
 |
JS_PROP_HAS_GET
 | 
JS_PROP_HAS_SET
;

43398 
Êags1
 |
JS_PROP_HAS_VALUE
 | 
JS_PROP_HAS_WRITABLE
;

43401 i‡(!
	`check_deföe_¥›_Êags
(
èrgë_desc
.
Êags
, 
Êags1
))

43402 
Áû1
;

43404 i‡(!
exãnsibÀ_èrgë
)

43405 
Áû1
;

43407 i‡(!(
ªsu…_desc
.
Êags
 & 
JS_PROP_CONFIGURABLE
)) {

43408 i‡(!
èrgë_desc_ªt
 || (
èrgë_desc
.
Êags
 & 
JS_PROP_CONFIGURABLE
))

43409 
Áû1
;

43410 i‡((
ªsu…_desc
.
Êags
 &

43411 (
JS_PROP_GETSET
 | 
JS_PROP_WRITABLE
)) == 0 &&

43412 
èrgë_desc_ªt
 &&

43413 (
èrgë_desc
.
Êags
 & 
JS_PROP_WRITABLE
) != 0) {

43415 
Áû1
:

43416 
	`js_‰ì_desc
(
˘x
, &
ªsu…_desc
);

43417 
Áû
:

43418 
	`JS_ThrowTy≥Eº‹
(
˘x
, "proxy: inconsistent getOwnPropertyDescriptor");

43422 
ªt
 = 
TRUE
;

43423 i‡(
pdesc
) {

43424 *
pdesc
 = 
ªsu…_desc
;

43426 
	`js_‰ì_desc
(
˘x
, &
ªsu…_desc
);

43429  
ªt
;

43430 
	}
}

43432 
	$js_¥oxy_deföe_own_¥›îty
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
obj
,

43433 
JSAtom
 
¥›
, 
JSVÆueC⁄°
 
vÆ
,

43434 
JSVÆueC⁄°
 
gëãr
, JSVÆueC⁄° 
£âî
,

43435 
Êags
)

43437 
JSProxyD©a
 *
s
;

43438 
JSVÆue
 
mëhod
, 
ªt1
, 
¥›_vÆ
, 
desc_vÆ
;

43439 
ªs
, 
ªt
;

43440 
JSObje˘
 *
p
;

43441 
JSVÆueC⁄°
 
¨gs
[3];

43442 
JSPr›îtyDes¸ùt‹
 
desc
;

43443 
BOOL
 
£âög_nŸ_c⁄figuøbÀ
;

43445 
s
 = 
	`gë_¥oxy_mëhod
(
˘x
, &
mëhod
, 
obj
, 
JS_ATOM_deföePr›îty
);

43446 i‡(!
s
)

43448 i‡(
	`JS_IsUndeföed
(
mëhod
)) {

43449  
	`JS_DeföePr›îty
(
˘x
, 
s
->
èrgë
, 
¥›
, 
vÆ
, 
gëãr
, 
£âî
, 
Êags
);

43451 
¥›_vÆ
 = 
	`JS_AtomToVÆue
(
˘x
, 
¥›
);

43452 i‡(
	`JS_IsEx˚±i⁄
(
¥›_vÆ
)) {

43453 
	`JS_FªeVÆue
(
˘x
, 
mëhod
);

43456 
desc_vÆ
 = 
	`js_¸óã_desc
(
˘x
, 
vÆ
, 
gëãr
, 
£âî
, 
Êags
);

43457 i‡(
	`JS_IsEx˚±i⁄
(
desc_vÆ
)) {

43458 
	`JS_FªeVÆue
(
˘x
, 
¥›_vÆ
);

43459 
	`JS_FªeVÆue
(
˘x
, 
mëhod
);

43462 
¨gs
[0] = 
s
->
èrgë
;

43463 
¨gs
[1] = 
¥›_vÆ
;

43464 
¨gs
[2] = 
desc_vÆ
;

43465 
ªt1
 = 
	`JS_CÆlFªe
(
˘x
, 
mëhod
, 
s
->
h™dÀr
, 3, 
¨gs
);

43466 
	`JS_FªeVÆue
(
˘x
, 
¥›_vÆ
);

43467 
	`JS_FªeVÆue
(
˘x
, 
desc_vÆ
);

43468 i‡(
	`JS_IsEx˚±i⁄
(
ªt1
))

43470 
ªt
 = 
	`JS_ToBoﬁFªe
(
˘x
, 
ªt1
);

43471 i‡(!
ªt
) {

43472 i‡(
Êags
 & 
JS_PROP_THROW
) {

43473 
	`JS_ThrowTy≥Eº‹
(
˘x
, "proxy: definePropertyÉxception");

43479 
p
 = 
	`JS_VALUE_GET_OBJ
(
s
->
èrgë
);

43480 
ªs
 = 
	`JS_GëOwnPr›îtyI¡î«l
(
˘x
, &
desc
, 
p
, 
¥›
);

43481 i‡(
ªs
 < 0)

43483 
£âög_nŸ_c⁄figuøbÀ
 = ((
Êags
 & (
JS_PROP_HAS_CONFIGURABLE
 |

43484 
JS_PROP_CONFIGURABLE
)) ==

43485 
JS_PROP_HAS_CONFIGURABLE
);

43486 i‡(!
ªs
) {

43487 i‡(!
p
->
exãnsibÀ
 || 
£âög_nŸ_c⁄figuøbÀ
)

43488 
Áû
;

43490 i‡(!
	`check_deföe_¥›_Êags
(
desc
.
Êags
, flags) ||

43491 ((
desc
.
Êags
 & 
JS_PROP_CONFIGURABLE
Ë&& 
£âög_nŸ_c⁄figuøbÀ
)) {

43492 
Áû1
;

43494 i‡(
Êags
 & (
JS_PROP_HAS_GET
 | 
JS_PROP_HAS_SET
)) {

43495 i‡((
desc
.
Êags
 & (
JS_PROP_GETSET
 | 
JS_PROP_CONFIGURABLE
)) ==

43496 
JS_PROP_GETSET
) {

43497 i‡((
Êags
 & 
JS_PROP_HAS_GET
) &&

43498 !
	`js_ßme_vÆue
(
˘x
, 
gëãr
, 
desc
.getter)) {

43499 
Áû1
;

43501 i‡((
Êags
 & 
JS_PROP_HAS_SET
) &&

43502 !
	`js_ßme_vÆue
(
˘x
, 
£âî
, 
desc
.setter)) {

43503 
Áû1
;

43506 } i‡(
Êags
 & 
JS_PROP_HAS_VALUE
) {

43507 i‡((
desc
.
Êags
 & (
JS_PROP_CONFIGURABLE
 | 
JS_PROP_WRITABLE
)) ==

43508 
JS_PROP_WRITABLE
 && !(
Êags
 & JS_PROP_WRITABLE)) {

43510 
Áû1
;

43511 } i‡((
desc
.
Êags
 & (
JS_PROP_CONFIGURABLE
 | 
JS_PROP_WRITABLE
)) == 0 &&

43512 !
	`js_ßme_vÆue
(
˘x
, 
vÆ
, 
desc
.
vÆue
)) {

43513 
Áû1
;

43516 i‡(
Êags
 & 
JS_PROP_HAS_WRITABLE
) {

43517 i‡((
desc
.
Êags
 & (
JS_PROP_GETSET
 | 
JS_PROP_CONFIGURABLE
 |

43518 
JS_PROP_WRITABLE
)) == JS_PROP_WRITABLE) {

43520 
Áû1
:

43521 
	`js_‰ì_desc
(
˘x
, &
desc
);

43522 
Áû
:

43523 
	`JS_ThrowTy≥Eº‹
(
˘x
, "proxy: inconsistent defineProperty");

43527 
	`js_‰ì_desc
(
˘x
, &
desc
);

43530 
	}
}

43532 
	$js_¥oxy_dñëe_¥›îty
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
obj
,

43533 
JSAtom
 
©om
)

43535 
JSProxyD©a
 *
s
;

43536 
JSVÆue
 
mëhod
, 
ªt
, 
©om_vÆ
;

43537 
ªs
, 
ªs2
, 
is_exãnsibÀ
;

43538 
JSVÆueC⁄°
 
¨gs
[2];

43540 
s
 = 
	`gë_¥oxy_mëhod
(
˘x
, &
mëhod
, 
obj
, 
JS_ATOM_dñëePr›îty
);

43541 i‡(!
s
)

43543 i‡(
	`JS_IsUndeföed
(
mëhod
)) {

43544  
	`JS_DñëePr›îty
(
˘x
, 
s
->
èrgë
, 
©om
, 0);

43546 
©om_vÆ
 = 
	`JS_AtomToVÆue
(
˘x
, 
©om
);;

43547 i‡(
	`JS_IsEx˚±i⁄
(
©om_vÆ
)) {

43548 
	`JS_FªeVÆue
(
˘x
, 
mëhod
);

43551 
¨gs
[0] = 
s
->
èrgë
;

43552 
¨gs
[1] = 
©om_vÆ
;

43553 
ªt
 = 
	`JS_CÆlFªe
(
˘x
, 
mëhod
, 
s
->
h™dÀr
, 2, 
¨gs
);

43554 
	`JS_FªeVÆue
(
˘x
, 
©om_vÆ
);

43555 i‡(
	`JS_IsEx˚±i⁄
(
ªt
))

43557 
ªs
 = 
	`JS_ToBoﬁFªe
(
˘x
, 
ªt
);

43558 i‡(
ªs
) {

43559 
JSPr›îtyDes¸ùt‹
 
desc
;

43560 
ªs2
 = 
	`JS_GëOwnPr›îtyI¡î«l
(
˘x
, &
desc
, 
	`JS_VALUE_GET_OBJ
(
s
->
èrgë
), 
©om
);

43561 i‡(
ªs2
 < 0)

43563 i‡(
ªs2
) {

43564 i‡(!(
desc
.
Êags
 & 
JS_PROP_CONFIGURABLE
))

43565 
Áû
;

43566 
is_exãnsibÀ
 = 
	`JS_IsExãnsibÀ
(
˘x
, 
s
->
èrgë
);

43567 i‡(
is_exãnsibÀ
 < 0)

43568 
Áû1
;

43569 i‡(!
is_exãnsibÀ
) {

43571 
Áû
:

43572 
	`JS_ThrowTy≥Eº‹
(
˘x
, "proxy: inconsistent deleteProperty");

43573 
Áû1
:

43574 
	`js_‰ì_desc
(
˘x
, &
desc
);

43577 
	`js_‰ì_desc
(
˘x
, &
desc
);

43580  
ªs
;

43581 
	}
}

43584 
	$föd_¥›_key
(c⁄° 
JSPr›îtyEnum
 *
èb
, 
n
, 
JSAtom
 
©om
)

43586 
i
;

43587 
i
 = 0; i < 
n
; i++) {

43588 i‡(
èb
[
i
].
©om
 ==átom)

43589  
i
;

43592 
	}
}

43594 
	$js_¥oxy_gë_own_¥›îty_«mes
(
JSC⁄ãxt
 *
˘x
,

43595 
JSPr›îtyEnum
 **
±ab
,

43596 
uöt32_t
 *
∂í
,

43597 
JSVÆueC⁄°
 
obj
)

43599 
JSProxyD©a
 *
s
;

43600 
JSVÆue
 
mëhod
, 
¥›_¨øy
, 
vÆ
;

43601 
uöt32_t
 
Àn
, 
i
, 
Àn2
;

43602 
JSPr›îtyEnum
 *
èb
, *
èb2
;

43603 
JSAtom
 
©om
;

43604 
JSPr›îtyDes¸ùt‹
 
desc
;

43605 
ªs
, 
is_exãnsibÀ
, 
idx
;

43607 
s
 = 
	`gë_¥oxy_mëhod
(
˘x
, &
mëhod
, 
obj
, 
JS_ATOM_ownKeys
);

43608 i‡(!
s
)

43610 i‡(
	`JS_IsUndeföed
(
mëhod
)) {

43611  
	`JS_GëOwnPr›îtyNamesI¡î«l
(
˘x
, 
±ab
, 
∂í
,

43612 
	`JS_VALUE_GET_OBJ
(
s
->
èrgë
),

43613 
JS_GPN_STRING_MASK
 | 
JS_GPN_SYMBOL_MASK
);

43615 
¥›_¨øy
 = 
	`JS_CÆlFªe
(
˘x
, 
mëhod
, 
s
->
h™dÀr
, 1, (
JSVÆueC⁄°
 *)&s->
èrgë
);

43616 i‡(
	`JS_IsEx˚±i⁄
(
¥›_¨øy
))

43618 
èb
 = 
NULL
;

43619 
Àn
 = 0;

43620 
èb2
 = 
NULL
;

43621 
Àn2
 = 0;

43622 i‡(
	`js_gë_Àngth32
(
˘x
, &
Àn
, 
¥›_¨øy
))

43623 
Áû
;

43624 i‡(
Àn
 > 0) {

43625 
èb
 = 
	`js_mÆlocz
(
˘x
, —ab[0]Ë* 
Àn
);

43626 i‡(!
èb
)

43627 
Áû
;

43629 
i
 = 0; i < 
Àn
; i++) {

43630 
vÆ
 = 
	`JS_GëPr›îtyUöt32
(
˘x
, 
¥›_¨øy
, 
i
);

43631 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

43632 
Áû
;

43633 i‡(!
	`JS_IsSåög
(
vÆ
Ë&& !
	`JS_IsSymbﬁ
(val)) {

43634 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

43635 
	`JS_ThrowTy≥Eº‹
(
˘x
, "proxy:Öroperties must be strings or symbols");

43636 
Áû
;

43638 
©om
 = 
	`JS_VÆueToAtom
(
˘x
, 
vÆ
);

43639 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

43640 i‡(
©om
 =
JS_ATOM_NULL
)

43641 
Áû
;

43642 
èb
[
i
].
©om
 =átom;

43643 
èb
[
i
].
is_íumîabÀ
 = 
FALSE
;

43648 
i
 = 1; i < 
Àn
; i++) {

43649 i‡(
	`föd_¥›_key
(
èb
, 
i
,Åab[i].
©om
) >= 0) {

43650 
	`JS_ThrowTy≥Eº‹
(
˘x
, "proxy: duplicateÖroperty");

43651 
Áû
;

43655 
is_exãnsibÀ
 = 
	`JS_IsExãnsibÀ
(
˘x
, 
s
->
èrgë
);

43656 i‡(
is_exãnsibÀ
 < 0)

43657 
Áû
;

43660 i‡(
s
->
is_ªvoked
) {

43661 
	`JS_ThrowTy≥Eº‹RevokedProxy
(
˘x
);

43662 
Áû
;

43664 i‡(
	`JS_GëOwnPr›îtyNamesI¡î«l
(
˘x
, &
èb2
, &
Àn2
, 
	`JS_VALUE_GET_OBJ
(
s
->
èrgë
),

43665 
JS_GPN_STRING_MASK
 | 
JS_GPN_SYMBOL_MASK
))

43666 
Áû
;

43667 
i
 = 0; i < 
Àn2
; i++) {

43668 i‡(
s
->
is_ªvoked
) {

43669 
	`JS_ThrowTy≥Eº‹RevokedProxy
(
˘x
);

43670 
Áû
;

43672 
ªs
 = 
	`JS_GëOwnPr›îtyI¡î«l
(
˘x
, &
desc
, 
	`JS_VALUE_GET_OBJ
(
s
->
èrgë
),

43673 
èb2
[
i
].
©om
);

43674 i‡(
ªs
 < 0)

43675 
Áû
;

43676 i‡(
ªs
) {

43677 
	`js_‰ì_desc
(
˘x
, &
desc
);

43678 i‡(!(
desc
.
Êags
 & 
JS_PROP_CONFIGURABLE
Ë|| !
is_exãnsibÀ
) {

43679 
idx
 = 
	`föd_¥›_key
(
èb
, 
Àn
, 
èb2
[
i
].
©om
);

43680 i‡(
idx
 < 0) {

43681 
	`JS_ThrowTy≥Eº‹
(
˘x
, "proxy:ÅargetÖroperty must beÖresent inÖroxy ownKeys");

43682 
Áû
;

43685 i‡(!
is_exãnsibÀ
)

43686 
èb
[
idx
].
is_íumîabÀ
 = 
TRUE
;

43690 i‡(!
is_exãnsibÀ
) {

43692 
i
 = 0; i < 
Àn
; i++) {

43693 i‡(!
èb
[
i
].
is_íumîabÀ
) {

43694 
	`JS_ThrowTy≥Eº‹
(
˘x
, "proxy:ÖropertyÇotÖresent inÅarget wereÑeturned byÇonÉxtensibleÖroxy");

43695 
Áû
;

43700 
	`js_‰ì_¥›_íum
(
˘x
, 
èb2
, 
Àn2
);

43701 
	`JS_FªeVÆue
(
˘x
, 
¥›_¨øy
);

43702 *
±ab
 = 
èb
;

43703 *
∂í
 = 
Àn
;

43705 
Áû
:

43706 
	`js_‰ì_¥›_íum
(
˘x
, 
èb2
, 
Àn2
);

43707 
	`js_‰ì_¥›_íum
(
˘x
, 
èb
, 
Àn
);

43708 
	`JS_FªeVÆue
(
˘x
, 
¥›_¨øy
);

43710 
	}
}

43712 
JSVÆue
 
	$js_¥oxy_ˇŒ_c⁄°ru˘‹
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
func_obj
,

43713 
JSVÆueC⁄°
 
√w_èrgë
,

43714 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

43716 
JSProxyD©a
 *
s
;

43717 
JSVÆue
 
mëhod
, 
¨g_¨øy
, 
ªt
;

43718 
JSVÆueC⁄°
 
¨gs
[3];

43720 
s
 = 
	`gë_¥oxy_mëhod
(
˘x
, &
mëhod
, 
func_obj
, 
JS_ATOM_c⁄°ru˘
);

43721 i‡(!
s
)

43722  
JS_EXCEPTION
;

43723 i‡(!
	`JS_IsC⁄°ru˘‹
(
˘x
, 
s
->
èrgë
))

43724  
	`JS_ThrowTy≥Eº‹
(
˘x
, "notá constructor");

43725 i‡(
	`JS_IsUndeföed
(
mëhod
))

43726  
	`JS_CÆlC⁄°ru˘‹2
(
˘x
, 
s
->
èrgë
, 
√w_èrgë
, 
¨gc
, 
¨gv
);

43727 
¨g_¨øy
 = 
	`js_¸óã_¨øy
(
˘x
, 
¨gc
, 
¨gv
);

43728 i‡(
	`JS_IsEx˚±i⁄
(
¨g_¨øy
)) {

43729 
ªt
 = 
JS_EXCEPTION
;

43730 
Áû
;

43732 
¨gs
[0] = 
s
->
èrgë
;

43733 
¨gs
[1] = 
¨g_¨øy
;

43734 
¨gs
[2] = 
√w_èrgë
;

43735 
ªt
 = 
	`JS_CÆl
(
˘x
, 
mëhod
, 
s
->
h™dÀr
, 3, 
¨gs
);

43736 i‡(!
	`JS_IsEx˚±i⁄
(
ªt
Ë&& 
	`JS_VALUE_GET_TAG
‘ëË!
JS_TAG_OBJECT
) {

43737 
	`JS_FªeVÆue
(
˘x
, 
ªt
);

43738 
ªt
 = 
	`JS_ThrowTy≥Eº‹NŸAnObje˘
(
˘x
);

43740 
Áû
:

43741 
	`JS_FªeVÆue
(
˘x
, 
mëhod
);

43742 
	`JS_FªeVÆue
(
˘x
, 
¨g_¨øy
);

43743  
ªt
;

43744 
	}
}

43746 
JSVÆue
 
	$js_¥oxy_ˇŒ
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
func_obj
,

43747 
JSVÆueC⁄°
 
this_obj
,

43748 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
, 
Êags
)

43750 
JSProxyD©a
 *
s
;

43751 
JSVÆue
 
mëhod
, 
¨g_¨øy
, 
ªt
;

43752 
JSVÆueC⁄°
 
¨gs
[3];

43754 i‡(
Êags
 & 
JS_CALL_FLAG_CONSTRUCTOR
)

43755  
	`js_¥oxy_ˇŒ_c⁄°ru˘‹
(
˘x
, 
func_obj
, 
this_obj
, 
¨gc
, 
¨gv
);

43757 
s
 = 
	`gë_¥oxy_mëhod
(
˘x
, &
mëhod
, 
func_obj
, 
JS_ATOM_≠∂y
);

43758 i‡(!
s
)

43759  
JS_EXCEPTION
;

43760 i‡(!
s
->
is_func
) {

43761 
	`JS_FªeVÆue
(
˘x
, 
mëhod
);

43762  
	`JS_ThrowTy≥Eº‹
(
˘x
, "notá function");

43764 i‡(
	`JS_IsUndeföed
(
mëhod
))

43765  
	`JS_CÆl
(
˘x
, 
s
->
èrgë
, 
this_obj
, 
¨gc
, 
¨gv
);

43766 
¨g_¨øy
 = 
	`js_¸óã_¨øy
(
˘x
, 
¨gc
, 
¨gv
);

43767 i‡(
	`JS_IsEx˚±i⁄
(
¨g_¨øy
)) {

43768 
ªt
 = 
JS_EXCEPTION
;

43769 
Áû
;

43771 
¨gs
[0] = 
s
->
èrgë
;

43772 
¨gs
[1] = 
this_obj
;

43773 
¨gs
[2] = 
¨g_¨øy
;

43774 
ªt
 = 
	`JS_CÆl
(
˘x
, 
mëhod
, 
s
->
h™dÀr
, 3, 
¨gs
);

43775 
Áû
:

43776 
	`JS_FªeVÆue
(
˘x
, 
mëhod
);

43777 
	`JS_FªeVÆue
(
˘x
, 
¨g_¨øy
);

43778  
ªt
;

43779 
	}
}

43781 
	$js_¥oxy_isAºay
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
obj
)

43783 
JSProxyD©a
 *
s
 = 
	`JS_GëO∑que
(
obj
, 
JS_CLASS_PROXY
);

43784 i‡(!
s
)

43785  
FALSE
;

43786 i‡(
s
->
is_ªvoked
) {

43787 
	`JS_ThrowTy≥Eº‹RevokedProxy
(
˘x
);

43790  
	`JS_IsAºay
(
˘x
, 
s
->
èrgë
);

43791 
	}
}

43793 c⁄° 
JSCœssExŸicMëhods
 
	gjs_¥oxy_exŸic_mëhods
 = {

43794 .
gë_own_¥›îty
 = 
js_¥oxy_gë_own_¥›îty
,

43795 .
	gdeföe_own_¥›îty
 = 
js_¥oxy_deföe_own_¥›îty
,

43796 .
	gdñëe_¥›îty
 = 
js_¥oxy_dñëe_¥›îty
,

43797 .
	ggë_own_¥›îty_«mes
 = 
js_¥oxy_gë_own_¥›îty_«mes
,

43798 .
	ghas_¥›îty
 = 
js_¥oxy_has
,

43799 .
	ggë_¥›îty
 = 
js_¥oxy_gë
,

43800 .
	g£t_¥›îty
 = 
js_¥oxy_£t
,

43803 
JSVÆue
 
	$js_¥oxy_c⁄°ru˘‹
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

43804 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

43806 
JSVÆueC⁄°
 
èrgë
, 
h™dÀr
;

43807 
JSVÆue
 
obj
;

43808 
JSProxyD©a
 *
s
;

43810 
èrgë
 = 
¨gv
[0];

43811 
h™dÀr
 = 
¨gv
[1];

43812 i‡(
	`JS_VALUE_GET_TAG
(
èrgë
Ë!
JS_TAG_OBJECT
 ||

43813 
	`JS_VALUE_GET_TAG
(
h™dÀr
Ë!
JS_TAG_OBJECT
)

43814  
	`JS_ThrowTy≥Eº‹NŸAnObje˘
(
˘x
);

43816 
obj
 = 
	`JS_NewObje˘PrŸoCœss
(
˘x
, 
JS_NULL
, 
JS_CLASS_PROXY
);

43817 i‡(
	`JS_IsEx˚±i⁄
(
obj
))

43818  
obj
;

43819 
s
 = 
	`js_mÆloc
(
˘x
, (
JSProxyD©a
));

43820 i‡(!
s
) {

43821 
	`JS_FªeVÆue
(
˘x
, 
obj
);

43822  
JS_EXCEPTION
;

43824 
s
->
èrgë
 = 
	`JS_DupVÆue
(
˘x
,Åarget);

43825 
s
->
h™dÀr
 = 
	`JS_DupVÆue
(
˘x
, handler);

43826 
s
->
¥Ÿo
 = 
JS_NULL
;

43827 
s
->
is_func
 = 
	`JS_IsFun˘i⁄
(
˘x
, 
èrgë
);

43828 
s
->
is_ªvoked
 = 
FALSE
;

43829 
	`JS_SëO∑que
(
obj
, 
s
);

43830 
	`JS_SëC⁄°ru˘‹Bô
(
˘x
, 
obj
, 
	`JS_IsC⁄°ru˘‹
(˘x, 
èrgë
));

43831  
obj
;

43832 
	}
}

43834 
JSVÆue
 
	$js_¥oxy_ªvoke
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

43835 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
, 
magic
,

43836 
JSVÆue
 *
func_d©a
)

43838 
JSProxyD©a
 *
s
 = 
	`JS_GëO∑que
(
func_d©a
[0], 
JS_CLASS_PROXY
);

43839 i‡(
s
) {

43842 
s
->
is_ªvoked
 = 
TRUE
;

43843 
	`JS_FªeVÆue
(
˘x
, 
func_d©a
[0]);

43844 
func_d©a
[0] = 
JS_NULL
;

43846  
JS_UNDEFINED
;

43847 
	}
}

43849 
JSVÆue
 
	$js_¥oxy_ªvoke_c⁄°ru˘‹
(
JSC⁄ãxt
 *
˘x
,

43850 
JSVÆueC⁄°
 
¥oxy_obj
)

43852  
	`JS_NewCFun˘i⁄D©a
(
˘x
, 
js_¥oxy_ªvoke
, 0, 0, 1, &
¥oxy_obj
);

43853 
	}
}

43855 
JSVÆue
 
	$js_¥oxy_ªvoˇbÀ
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

43856 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

43858 
JSVÆue
 
¥oxy_obj
, 
ªvoke_obj
 = 
JS_UNDEFINED
, 
obj
;

43860 
¥oxy_obj
 = 
	`js_¥oxy_c⁄°ru˘‹
(
˘x
, 
JS_UNDEFINED
, 
¨gc
, 
¨gv
);

43861 i‡(
	`JS_IsEx˚±i⁄
(
¥oxy_obj
))

43862 
Áû
;

43863 
ªvoke_obj
 = 
	`js_¥oxy_ªvoke_c⁄°ru˘‹
(
˘x
, 
¥oxy_obj
);

43864 i‡(
	`JS_IsEx˚±i⁄
(
ªvoke_obj
))

43865 
Áû
;

43866 
obj
 = 
	`JS_NewObje˘
(
˘x
);

43867 i‡(
	`JS_IsEx˚±i⁄
(
obj
))

43868 
Áû
;

43870 
	`JS_DeföePr›îtyVÆue
(
˘x
, 
obj
, 
JS_ATOM_¥oxy
, 
¥oxy_obj
, 
JS_PROP_C_W_E
);

43871 
	`JS_DeföePr›îtyVÆue
(
˘x
, 
obj
, 
JS_ATOM_ªvoke
, 
ªvoke_obj
, 
JS_PROP_C_W_E
);

43872  
obj
;

43873 
Áû
:

43874 
	`JS_FªeVÆue
(
˘x
, 
¥oxy_obj
);

43875 
	`JS_FªeVÆue
(
˘x
, 
ªvoke_obj
);

43876  
JS_EXCEPTION
;

43877 
	}
}

43879 c⁄° 
JSCFun˘i⁄Li°E¡ry
 
	gjs_¥oxy_funcs
[] = {

43880 
JS_CFUNC_DEF
("ªvoˇbÀ", 2, 
js_¥oxy_ªvoˇbÀ
 ),

43883 c⁄° 
JSCœssSh‹tDef
 
	gjs_¥oxy_˛ass_def
[] = {

43884 { 
JS_ATOM_Obje˘
, 
js_¥oxy_föÆizî
, 
js_¥oxy_m¨k
 },

43887 
	$JS_AddI¡rösicProxy
(
JSC⁄ãxt
 *
˘x
)

43889 
JSRu¡ime
 *
π
 = 
˘x
->rt;

43890 
JSVÆue
 
obj1
;

43892 i‡(!
	`JS_IsRegi°îedCœss
(
π
, 
JS_CLASS_PROXY
)) {

43893 
	`öô_˛ass_ønge
(
π
, 
js_¥oxy_˛ass_def
, 
JS_CLASS_PROXY
,

43894 
	`cou¡of
(
js_¥oxy_˛ass_def
));

43895 
π
->
˛ass_¨øy
[
JS_CLASS_PROXY
].
exŸic
 = &
js_¥oxy_exŸic_mëhods
;

43896 
π
->
˛ass_¨øy
[
JS_CLASS_PROXY
].
ˇŒ
 = 
js_¥oxy_ˇŒ
;

43899 
obj1
 = 
	`JS_NewCFun˘i⁄2
(
˘x
, 
js_¥oxy_c⁄°ru˘‹
, "Proxy", 2,

43900 
JS_CFUNC_c⁄°ru˘‹
, 0);

43901 
	`JS_SëC⁄°ru˘‹Bô
(
˘x
, 
obj1
, 
TRUE
);

43902 
	`JS_SëPr›îtyFun˘i⁄Li°
(
˘x
, 
obj1
, 
js_¥oxy_funcs
,

43903 
	`cou¡of
(
js_¥oxy_funcs
));

43904 
	`JS_DeföePr›îtyVÆueSå
(
˘x
, ctx->
globÆ_obj
, "Proxy",

43905 
obj1
, 
JS_PROP_WRITABLE
 | 
JS_PROP_CONFIGURABLE
);

43906 
	}
}

43910 
JSVÆue
 
	$js_symbﬁ_c⁄°ru˘‹
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
√w_èrgë
,

43911 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

43913 
JSVÆue
 
°r
;

43914 
JSSåög
 *
p
;

43916 i‡(!
	`JS_IsUndeföed
(
√w_èrgë
))

43917  
	`JS_ThrowTy≥Eº‹
(
˘x
, "notá constructor");

43918 i‡(
¨gc
 =0 || 
	`JS_IsUndeföed
(
¨gv
[0])) {

43919 
p
 = 
NULL
;

43921 
°r
 = 
	`JS_ToSåög
(
˘x
, 
¨gv
[0]);

43922 i‡(
	`JS_IsEx˚±i⁄
(
°r
))

43923  
JS_EXCEPTION
;

43924 
p
 = 
	`JS_VALUE_GET_STRING
(
°r
);

43926  
	`JS_NewSymbﬁ
(
˘x
, 
p
, 
JS_ATOM_TYPE_SYMBOL
);

43927 
	}
}

43929 
JSVÆue
 
	$js_thisSymbﬁVÆue
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
)

43931 i‡(
	`JS_VALUE_GET_TAG
(
this_vÆ
Ë=
JS_TAG_SYMBOL
)

43932  
	`JS_DupVÆue
(
˘x
, 
this_vÆ
);

43934 i‡(
	`JS_VALUE_GET_TAG
(
this_vÆ
Ë=
JS_TAG_OBJECT
) {

43935 
JSObje˘
 *
p
 = 
	`JS_VALUE_GET_OBJ
(
this_vÆ
);

43936 i‡(
p
->
˛ass_id
 =
JS_CLASS_SYMBOL
) {

43937 i‡(
	`JS_VALUE_GET_TAG
(
p
->
u
.
obje˘_d©a
Ë=
JS_TAG_SYMBOL
)

43938  
	`JS_DupVÆue
(
˘x
, 
p
->
u
.
obje˘_d©a
);

43941  
	`JS_ThrowTy≥Eº‹
(
˘x
, "notá symbol");

43942 
	}
}

43944 
JSVÆue
 
	$js_symbﬁ_toSåög
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

43945 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

43947 
JSVÆue
 
vÆ
, 
ªt
;

43948 
vÆ
 = 
	`js_thisSymbﬁVÆue
(
˘x
, 
this_vÆ
);

43949 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

43950  
vÆ
;

43952 
ªt
 = 
	`js_°rög_c⁄°ru˘‹
(
˘x
, 
JS_UNDEFINED
, 1, (
JSVÆueC⁄°
 *)&
vÆ
);

43953 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

43954  
ªt
;

43955 
	}
}

43957 
JSVÆue
 
	$js_symbﬁ_vÆueOf
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

43958 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

43960  
	`js_thisSymbﬁVÆue
(
˘x
, 
this_vÆ
);

43961 
	}
}

43963 
JSVÆue
 
	$js_symbﬁ_gë_des¸ùti⁄
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
)

43965 
JSVÆue
 
vÆ
, 
ªt
;

43966 
JSAtomSåu˘
 *
p
;

43968 
vÆ
 = 
	`js_thisSymbﬁVÆue
(
˘x
, 
this_vÆ
);

43969 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

43970  
vÆ
;

43971 
p
 = 
	`JS_VALUE_GET_PTR
(
vÆ
);

43972 i‡(
p
->
Àn
 =0 &&Ö->
is_wide_ch¨
 != 0) {

43973 
ªt
 = 
JS_UNDEFINED
;

43975 
ªt
 = 
	`JS_AtomToSåög
(
˘x
, 
	`js_gë_©om_ödex
(˘x->
π
, 
p
));

43977 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

43978  
ªt
;

43979 
	}
}

43981 c⁄° 
JSCFun˘i⁄Li°E¡ry
 
	gjs_symbﬁ_¥Ÿo_funcs
[] = {

43982 
JS_CFUNC_DEF
("toSåög", 0, 
js_symbﬁ_toSåög
 ),

43983 
JS_CFUNC_DEF
("vÆueOf", 0, 
js_symbﬁ_vÆueOf
 ),

43985 
JS_CFUNC_DEF
("[Symbﬁ.toPrimôive]", 1, 
js_symbﬁ_vÆueOf
 ),

43986 
JS_PROP_STRING_DEF
("[Symbﬁ.toSåögTag]", "Symbﬁ", 
JS_PROP_CONFIGURABLE
 ),

43987 
JS_CGETSET_DEF
("des¸ùti⁄", 
js_symbﬁ_gë_des¸ùti⁄
, 
NULL
 ),

43990 
JSVÆue
 
	$js_symbﬁ_f‹
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

43991 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

43993 
JSVÆue
 
°r
;

43995 
°r
 = 
	`JS_ToSåög
(
˘x
, 
¨gv
[0]);

43996 i‡(
	`JS_IsEx˚±i⁄
(
°r
))

43997  
JS_EXCEPTION
;

43998  
	`JS_NewSymbﬁ
(
˘x
, 
	`JS_VALUE_GET_STRING
(
°r
), 
JS_ATOM_TYPE_GLOBAL_SYMBOL
);

43999 
	}
}

44001 
JSVÆue
 
	$js_symbﬁ_keyF‹
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

44002 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

44004 
JSAtomSåu˘
 *
p
;

44006 i‡(!
	`JS_IsSymbﬁ
(
¨gv
[0]))

44007  
	`JS_ThrowTy≥Eº‹
(
˘x
, "notá symbol");

44008 
p
 = 
	`JS_VALUE_GET_PTR
(
¨gv
[0]);

44009 i‡(
p
->
©om_ty≥
 !
JS_ATOM_TYPE_GLOBAL_SYMBOL
)

44010  
JS_UNDEFINED
;

44011  
	`JS_DupVÆue
(
˘x
, 
	`JS_MKPTR
(
JS_TAG_STRING
, 
p
));

44012 
	}
}

44014 c⁄° 
JSCFun˘i⁄Li°E¡ry
 
	gjs_symbﬁ_funcs
[] = {

44015 
JS_CFUNC_DEF
("f‹", 1, 
js_symbﬁ_f‹
 ),

44016 
JS_CFUNC_DEF
("keyF‹", 1, 
js_symbﬁ_keyF‹
 ),

44021 
	sJSM≠Rec‹d
 {

44022 
	mªf_cou¡
;

44023 
BOOL
 
	mem±y
;

44024 
JSM≠Sèã
 *
	mm≠
;

44025 
JSM≠Rec‹d
 *
	m√xt_wók_ªf
;

44026 
li°_hód
 
	mlök
;

44027 
li°_hód
 
	mhash_lök
;

44028 
JSVÆue
 
	mkey
;

44029 
JSVÆue
 
	mvÆue
;

44030 } 
	tJSM≠Rec‹d
;

44032 
	sJSM≠Sèã
 {

44033 
BOOL
 
	mis_wók
;

44034 
li°_hód
 
	mªc‹ds
;

44035 
uöt32_t
 
	mªc‹d_cou¡
;

44036 
li°_hód
 *
	mhash_èbÀ
;

44037 
uöt32_t
 
	mhash_size
;

44038 
uöt32_t
 
	mªc‹d_cou¡_thªshﬁd
;

44040 } 
	tJSM≠Sèã
;

44042 
	#MAGIC_SET
 (1 << 0)

	)

44043 
	#MAGIC_WEAK
 (1 << 1)

	)

44045 
JSVÆue
 
	$js_m≠_c⁄°ru˘‹
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
√w_èrgë
,

44046 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
, 
magic
)

44048 
JSM≠Sèã
 *
s
;

44049 
JSVÆue
 
obj
, 
addî
 = 
JS_UNDEFINED
, 
ôî
 = JS_UNDEFINED, 
√xt_mëhod
 = JS_UNDEFINED;

44050 
JSVÆueC⁄°
 
¨r
;

44051 
BOOL
 
is_£t
, 
is_wók
;

44053 
is_£t
 = 
magic
 & 
MAGIC_SET
;

44054 
is_wók
 = ((
magic
 & 
MAGIC_WEAK
) != 0);

44055 
obj
 = 
	`js_¸óã_‰om_˘‹
(
˘x
, 
√w_èrgë
, 
JS_CLASS_MAP
 + 
magic
);

44056 i‡(
	`JS_IsEx˚±i⁄
(
obj
))

44057  
JS_EXCEPTION
;

44058 
s
 = 
	`js_mÆlocz
(
˘x
, (*s));

44059 i‡(!
s
)

44060 
Áû
;

44061 
	`öô_li°_hód
(&
s
->
ªc‹ds
);

44062 
s
->
is_wók
 = is_weak;

44063 
	`JS_SëO∑que
(
obj
, 
s
);

44064 
s
->
hash_size
 = 1;

44065 
s
->
hash_èbÀ
 = 
	`js_mÆloc
(
˘x
, (s->hash_èbÀ[0]Ë* s->
hash_size
);

44066 i‡(!
s
->
hash_èbÀ
)

44067 
Áû
;

44068 
	`öô_li°_hód
(&
s
->
hash_èbÀ
[0]);

44069 
s
->
ªc‹d_cou¡_thªshﬁd
 = 4;

44071 
¨r
 = 
JS_UNDEFINED
;

44072 i‡(
¨gc
 > 0)

44073 
¨r
 = 
¨gv
[0];

44074 i‡(!
	`JS_IsUndeföed
(
¨r
Ë&& !
	`JS_IsNuŒ
(arr)) {

44075 
JSVÆue
 
ôem
, 
ªt
;

44076 
BOOL
 
d⁄e
;

44078 
addî
 = 
	`JS_GëPr›îty
(
˘x
, 
obj
, 
is_£t
 ? 
JS_ATOM_add
 : 
JS_ATOM_£t
);

44079 i‡(
	`JS_IsEx˚±i⁄
(
addî
))

44080 
Áû
;

44081 i‡(!
	`JS_IsFun˘i⁄
(
˘x
, 
addî
)) {

44082 
	`JS_ThrowTy≥Eº‹
(
˘x
, "set/add isÇotá function");

44083 
Áû
;

44086 
ôî
 = 
	`JS_GëIãøt‹
(
˘x
, 
¨r
, 
FALSE
);

44087 i‡(
	`JS_IsEx˚±i⁄
(
ôî
))

44088 
Áû
;

44089 
√xt_mëhod
 = 
	`JS_GëPr›îty
(
˘x
, 
ôî
, 
JS_ATOM_√xt
);

44090 i‡(
	`JS_IsEx˚±i⁄
(
√xt_mëhod
))

44091 
Áû
;

44094 
ôem
 = 
	`JS_Iãøt‹Next
(
˘x
, 
ôî
, 
√xt_mëhod
, 0, 
NULL
, &
d⁄e
);

44095 i‡(
	`JS_IsEx˚±i⁄
(
ôem
))

44096 
Áû
;

44097 i‡(
d⁄e
) {

44098 
	`JS_FªeVÆue
(
˘x
, 
ôem
);

44101 i‡(
is_£t
) {

44102 
ªt
 = 
	`JS_CÆl
(
˘x
, 
addî
, 
obj
, 1, (
JSVÆueC⁄°
 *)&
ôem
);

44103 i‡(
	`JS_IsEx˚±i⁄
(
ªt
)) {

44104 
	`JS_FªeVÆue
(
˘x
, 
ôem
);

44105 
Áû
;

44108 
JSVÆue
 
key
, 
vÆue
;

44109 
JSVÆueC⁄°
 
¨gs
[2];

44110 
key
 = 
JS_UNDEFINED
;

44111 
vÆue
 = 
JS_UNDEFINED
;

44112 i‡(!
	`JS_IsObje˘
(
ôem
)) {

44113 
	`JS_ThrowTy≥Eº‹NŸAnObje˘
(
˘x
);

44114 
Áû1
;

44116 
key
 = 
	`JS_GëPr›îtyUöt32
(
˘x
, 
ôem
, 0);

44117 i‡(
	`JS_IsEx˚±i⁄
(
key
))

44118 
Áû1
;

44119 
vÆue
 = 
	`JS_GëPr›îtyUöt32
(
˘x
, 
ôem
, 1);

44120 i‡(
	`JS_IsEx˚±i⁄
(
vÆue
))

44121 
Áû1
;

44122 
¨gs
[0] = 
key
;

44123 
¨gs
[1] = 
vÆue
;

44124 
ªt
 = 
	`JS_CÆl
(
˘x
, 
addî
, 
obj
, 2, 
¨gs
);

44125 i‡(
	`JS_IsEx˚±i⁄
(
ªt
)) {

44126 
Áû1
:

44127 
	`JS_FªeVÆue
(
˘x
, 
ôem
);

44128 
	`JS_FªeVÆue
(
˘x
, 
key
);

44129 
	`JS_FªeVÆue
(
˘x
, 
vÆue
);

44130 
Áû
;

44132 
	`JS_FªeVÆue
(
˘x
, 
key
);

44133 
	`JS_FªeVÆue
(
˘x
, 
vÆue
);

44135 
	`JS_FªeVÆue
(
˘x
, 
ªt
);

44136 
	`JS_FªeVÆue
(
˘x
, 
ôem
);

44138 
	`JS_FªeVÆue
(
˘x
, 
√xt_mëhod
);

44139 
	`JS_FªeVÆue
(
˘x
, 
ôî
);

44140 
	`JS_FªeVÆue
(
˘x
, 
addî
);

44142  
obj
;

44143 
Áû
:

44144 i‡(
	`JS_IsObje˘
(
ôî
)) {

44146 
	`JS_Iãøt‹Clo£
(
˘x
, 
ôî
, 
TRUE
);

44148 
	`JS_FªeVÆue
(
˘x
, 
√xt_mëhod
);

44149 
	`JS_FªeVÆue
(
˘x
, 
ôî
);

44150 
	`JS_FªeVÆue
(
˘x
, 
addî
);

44151 
	`JS_FªeVÆue
(
˘x
, 
obj
);

44152  
JS_EXCEPTION
;

44153 
	}
}

44156 
JSVÆueC⁄°
 
	$m≠_n‹mÆize_key
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
key
)

44158 
uöt32_t
 
èg
 = 
	`JS_VALUE_GET_TAG
(
key
);

44160 i‡(
	`JS_TAG_IS_FLOAT64
(
èg
Ë&& 
	`JS_VALUE_GET_FLOAT64
(
key
) == 0.0) {

44161 
key
 = 
	`JS_NewI¡32
(
˘x
, 0);

44163  
key
;

44164 
	}
}

44167 
uöt32_t
 
	$m≠_hash_key
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
key
)

44169 
uöt32_t
 
èg
 = 
	`JS_VALUE_GET_NORM_TAG
(
key
);

44170 
uöt32_t
 
h
;

44171 
d
;

44172 
JSFlﬂt64Uni⁄
 
u
;

44174 
èg
) {

44175 
JS_TAG_BOOL
:

44176 
h
 = 
	`JS_VALUE_GET_INT
(
key
);

44178 
JS_TAG_STRING
:

44179 
h
 = 
	`hash_°rög
(
	`JS_VALUE_GET_STRING
(
key
), 0);

44181 
JS_TAG_OBJECT
:

44182 
JS_TAG_SYMBOL
:

44183 
h
 = (
uöçå_t
)
	`JS_VALUE_GET_PTR
(
key
) * 3163;

44185 
JS_TAG_INT
:

44186 
d
 = 
	`JS_VALUE_GET_INT
(
key
) * 3163;

44187 
hash_Êﬂt64
;

44188 
JS_TAG_FLOAT64
:

44189 
d
 = 
	`JS_VALUE_GET_FLOAT64
(
key
);

44191 i‡(
	`i¢™
(
d
))

44192 
d
 = 
JS_FLOAT64_NAN
;

44193 
hash_Êﬂt64
:

44194 
u
.
d
 = d;

44195 
h
 = (
u
.
u32
[0] ^ u.u32[1]) * 3163;

44198 
h
 = 0;

44201 
h
 ^
èg
;

44202  
h
;

44203 
	}
}

44205 
JSM≠Rec‹d
 *
	$m≠_föd_ªc‹d
(
JSC⁄ãxt
 *
˘x
, 
JSM≠Sèã
 *
s
,

44206 
JSVÆueC⁄°
 
key
)

44208 
li°_hód
 *
ñ
;

44209 
JSM≠Rec‹d
 *
mr
;

44210 
uöt32_t
 
h
;

44211 
h
 = 
	`m≠_hash_key
(
˘x
, 
key
Ë& (
s
->
hash_size
 - 1);

44212 
	`li°_f‹_óch
(
ñ
, &
s
->
hash_èbÀ
[
h
]) {

44213 
mr
 = 
	`li°_íåy
(
ñ
, 
JSM≠Rec‹d
, 
hash_lök
);

44214 i‡(
	`js_ßme_vÆue_zîo
(
˘x
, 
mr
->
key
, key))

44215  
mr
;

44217  
NULL
;

44218 
	}
}

44220 
	$m≠_hash_ªsize
(
JSC⁄ãxt
 *
˘x
, 
JSM≠Sèã
 *
s
)

44222 
uöt32_t
 
√w_hash_size
, 
i
, 
h
;

44223 
size_t
 
¶ack
;

44224 
li°_hód
 *
√w_hash_èbÀ
, *
ñ
;

44225 
JSM≠Rec‹d
 *
mr
;

44228 i‡(
s
->
hash_size
 == 1)

44229 
√w_hash_size
 = 4;

44231 
√w_hash_size
 = 
s
->
hash_size
 * 2;

44232 
√w_hash_èbÀ
 = 
	`js_ªÆloc2
(
˘x
, 
s
->
hash_èbÀ
,

44233 (
√w_hash_èbÀ
[0]Ë* 
√w_hash_size
, &
¶ack
);

44234 i‡(!
√w_hash_èbÀ
)

44236 
√w_hash_size
 +
¶ack
 / (*
√w_hash_èbÀ
);

44238 
i
 = 0; i < 
√w_hash_size
; i++)

44239 
	`öô_li°_hód
(&
√w_hash_èbÀ
[
i
]);

44241 
	`li°_f‹_óch
(
ñ
, &
s
->
ªc‹ds
) {

44242 
mr
 = 
	`li°_íåy
(
ñ
, 
JSM≠Rec‹d
, 
lök
);

44243 i‡(!
mr
->
em±y
) {

44244 
h
 = 
	`m≠_hash_key
(
˘x
, 
mr
->
key
Ë& (
√w_hash_size
 - 1);

44245 
	`li°_add_èû
(&
mr
->
hash_lök
, &
√w_hash_èbÀ
[
h
]);

44248 
s
->
hash_èbÀ
 = 
√w_hash_èbÀ
;

44249 
s
->
hash_size
 = 
√w_hash_size
;

44250 
s
->
ªc‹d_cou¡_thªshﬁd
 = 
√w_hash_size
 * 2;

44251 
	}
}

44253 
JSM≠Rec‹d
 *
	$m≠_add_ªc‹d
(
JSC⁄ãxt
 *
˘x
, 
JSM≠Sèã
 *
s
,

44254 
JSVÆueC⁄°
 
key
)

44256 
uöt32_t
 
h
;

44257 
JSM≠Rec‹d
 *
mr
;

44259 
mr
 = 
	`js_mÆloc
(
˘x
, (*mr));

44260 i‡(!
mr
)

44261  
NULL
;

44262 
mr
->
ªf_cou¡
 = 1;

44263 
mr
->
m≠
 = 
s
;

44264 
mr
->
em±y
 = 
FALSE
;

44265 i‡(
s
->
is_wók
) {

44266 
JSObje˘
 *
p
 = 
	`JS_VALUE_GET_OBJ
(
key
);

44268 
mr
->
√xt_wók_ªf
 = 
p
->
fú°_wók_ªf
;

44269 
p
->
fú°_wók_ªf
 = 
mr
;

44271 
	`JS_DupVÆue
(
˘x
, 
key
);

44273 
mr
->
key
 = (
JSVÆue
)key;

44274 
h
 = 
	`m≠_hash_key
(
˘x
, 
key
Ë& (
s
->
hash_size
 - 1);

44275 
	`li°_add_èû
(&
mr
->
hash_lök
, &
s
->
hash_èbÀ
[
h
]);

44276 
	`li°_add_èû
(&
mr
->
lök
, &
s
->
ªc‹ds
);

44277 
s
->
ªc‹d_cou¡
++;

44278 i‡(
s
->
ªc‹d_cou¡
 >s->
ªc‹d_cou¡_thªshﬁd
) {

44279 
	`m≠_hash_ªsize
(
˘x
, 
s
);

44281  
mr
;

44282 
	}
}

44288 
	$dñëe_wók_ªf
(
JSRu¡ime
 *
π
, 
JSM≠Rec‹d
 *
mr
)

44290 
JSM≠Rec‹d
 **
pmr
, *
mr1
;

44291 
JSObje˘
 *
p
;

44293 
p
 = 
	`JS_VALUE_GET_OBJ
(
mr
->
key
);

44294 
pmr
 = &
p
->
fú°_wók_ªf
;

44296 
mr1
 = *
pmr
;

44297 
	`as£π
(
mr1
 !
NULL
);

44298 i‡(
mr1
 =
mr
)

44300 
pmr
 = &
mr1
->
√xt_wók_ªf
;

44302 *
pmr
 = 
mr1
->
√xt_wók_ªf
;

44303 
	}
}

44305 
	$m≠_dñëe_ªc‹d
(
JSRu¡ime
 *
π
, 
JSM≠Sèã
 *
s
, 
JSM≠Rec‹d
 *
mr
)

44307 i‡(
mr
->
em±y
)

44309 
	`li°_dñ
(&
mr
->
hash_lök
);

44310 i‡(
s
->
is_wók
) {

44311 
	`dñëe_wók_ªf
(
π
, 
mr
);

44313 
	`JS_FªeVÆueRT
(
π
, 
mr
->
key
);

44315 
	`JS_FªeVÆueRT
(
π
, 
mr
->
vÆue
);

44316 i‡(--
mr
->
ªf_cou¡
 == 0) {

44317 
	`li°_dñ
(&
mr
->
lök
);

44318 
	`js_‰ì_π
(
π
, 
mr
);

44321 
mr
->
em±y
 = 
TRUE
;

44322 
mr
->
key
 = 
JS_UNDEFINED
;

44323 
mr
->
vÆue
 = 
JS_UNDEFINED
;

44325 
s
->
ªc‹d_cou¡
--;

44326 
	}
}

44328 
	$m≠_de¸ef_ªc‹d
(
JSRu¡ime
 *
π
, 
JSM≠Rec‹d
 *
mr
)

44330 i‡(--
mr
->
ªf_cou¡
 == 0) {

44332 
	`as£π
(
mr
->
em±y
);

44333 
	`li°_dñ
(&
mr
->
lök
);

44334 
	`js_‰ì_π
(
π
, 
mr
);

44336 
	}
}

44338 
	$ª£t_wók_ªf
(
JSRu¡ime
 *
π
, 
JSObje˘
 *
p
)

44340 
JSM≠Rec‹d
 *
mr
, *
mr_√xt
;

44341 
JSM≠Sèã
 *
s
;

44345 
mr
 = 
p
->
fú°_wók_ªf
; m∏!
NULL
; m∏mr->
√xt_wók_ªf
) {

44346 
s
 = 
mr
->
m≠
;

44347 
	`as£π
(
s
->
is_wók
);

44348 
	`as£π
(!
mr
->
em±y
);

44349 
	`li°_dñ
(&
mr
->
hash_lök
);

44350 
	`li°_dñ
(&
mr
->
lök
);

44355 
mr
 = 
p
->
fú°_wók_ªf
; m∏!
NULL
; m∏
mr_√xt
) {

44356 
mr_√xt
 = 
mr
->
√xt_wók_ªf
;

44357 
	`JS_FªeVÆueRT
(
π
, 
mr
->
vÆue
);

44358 
	`js_‰ì_π
(
π
, 
mr
);

44361 
p
->
fú°_wók_ªf
 = 
NULL
;

44362 
	}
}

44364 
JSVÆue
 
	$js_m≠_£t
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

44365 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
, 
magic
)

44367 
JSM≠Sèã
 *
s
 = 
	`JS_GëO∑que2
(
˘x
, 
this_vÆ
, 
JS_CLASS_MAP
 + 
magic
);

44368 
JSM≠Rec‹d
 *
mr
;

44369 
JSVÆueC⁄°
 
key
, 
vÆue
;

44371 i‡(!
s
)

44372  
JS_EXCEPTION
;

44373 
key
 = 
	`m≠_n‹mÆize_key
(
˘x
, 
¨gv
[0]);

44374 i‡(
s
->
is_wók
 && !
	`JS_IsObje˘
(
key
))

44375  
	`JS_ThrowTy≥Eº‹NŸAnObje˘
(
˘x
);

44376 i‡(
magic
 & 
MAGIC_SET
)

44377 
vÆue
 = 
JS_UNDEFINED
;

44379 
vÆue
 = 
¨gv
[1];

44380 
mr
 = 
	`m≠_föd_ªc‹d
(
˘x
, 
s
, 
key
);

44381 i‡(
mr
) {

44382 
	`JS_FªeVÆue
(
˘x
, 
mr
->
vÆue
);

44384 
mr
 = 
	`m≠_add_ªc‹d
(
˘x
, 
s
, 
key
);

44385 i‡(!
mr
)

44386  
JS_EXCEPTION
;

44388 
mr
->
vÆue
 = 
	`JS_DupVÆue
(
˘x
, value);

44389  
	`JS_DupVÆue
(
˘x
, 
this_vÆ
);

44390 
	}
}

44392 
JSVÆue
 
	$js_m≠_gë
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

44393 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
, 
magic
)

44395 
JSM≠Sèã
 *
s
 = 
	`JS_GëO∑que2
(
˘x
, 
this_vÆ
, 
JS_CLASS_MAP
 + 
magic
);

44396 
JSM≠Rec‹d
 *
mr
;

44397 
JSVÆueC⁄°
 
key
;

44399 i‡(!
s
)

44400  
JS_EXCEPTION
;

44401 
key
 = 
	`m≠_n‹mÆize_key
(
˘x
, 
¨gv
[0]);

44402 
mr
 = 
	`m≠_föd_ªc‹d
(
˘x
, 
s
, 
key
);

44403 i‡(!
mr
)

44404  
JS_UNDEFINED
;

44406  
	`JS_DupVÆue
(
˘x
, 
mr
->
vÆue
);

44407 
	}
}

44409 
JSVÆue
 
	$js_m≠_has
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

44410 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
, 
magic
)

44412 
JSM≠Sèã
 *
s
 = 
	`JS_GëO∑que2
(
˘x
, 
this_vÆ
, 
JS_CLASS_MAP
 + 
magic
);

44413 
JSM≠Rec‹d
 *
mr
;

44414 
JSVÆueC⁄°
 
key
;

44416 i‡(!
s
)

44417  
JS_EXCEPTION
;

44418 
key
 = 
	`m≠_n‹mÆize_key
(
˘x
, 
¨gv
[0]);

44419 
mr
 = 
	`m≠_föd_ªc‹d
(
˘x
, 
s
, 
key
);

44420  
	`JS_NewBoﬁ
(
˘x
, (
mr
 !
NULL
));

44421 
	}
}

44423 
JSVÆue
 
	$js_m≠_dñëe
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

44424 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
, 
magic
)

44426 
JSM≠Sèã
 *
s
 = 
	`JS_GëO∑que2
(
˘x
, 
this_vÆ
, 
JS_CLASS_MAP
 + 
magic
);

44427 
JSM≠Rec‹d
 *
mr
;

44428 
JSVÆueC⁄°
 
key
;

44430 i‡(!
s
)

44431  
JS_EXCEPTION
;

44432 
key
 = 
	`m≠_n‹mÆize_key
(
˘x
, 
¨gv
[0]);

44433 
mr
 = 
	`m≠_föd_ªc‹d
(
˘x
, 
s
, 
key
);

44434 i‡(!
mr
)

44435  
JS_FALSE
;

44436 
	`m≠_dñëe_ªc‹d
(
˘x
->
π
, 
s
, 
mr
);

44437  
JS_TRUE
;

44438 
	}
}

44440 
JSVÆue
 
	$js_m≠_˛ór
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

44441 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
, 
magic
)

44443 
JSM≠Sèã
 *
s
 = 
	`JS_GëO∑que2
(
˘x
, 
this_vÆ
, 
JS_CLASS_MAP
 + 
magic
);

44444 
li°_hód
 *
ñ
, *
ñ1
;

44445 
JSM≠Rec‹d
 *
mr
;

44447 i‡(!
s
)

44448  
JS_EXCEPTION
;

44449 
	`li°_f‹_óch_ß„
(
ñ
, 
ñ1
, &
s
->
ªc‹ds
) {

44450 
mr
 = 
	`li°_íåy
(
ñ
, 
JSM≠Rec‹d
, 
lök
);

44451 
	`m≠_dñëe_ªc‹d
(
˘x
->
π
, 
s
, 
mr
);

44453  
JS_UNDEFINED
;

44454 
	}
}

44456 
JSVÆue
 
	$js_m≠_gë_size
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
, 
magic
)

44458 
JSM≠Sèã
 *
s
 = 
	`JS_GëO∑que2
(
˘x
, 
this_vÆ
, 
JS_CLASS_MAP
 + 
magic
);

44459 i‡(!
s
)

44460  
JS_EXCEPTION
;

44461  
	`JS_NewUöt32
(
˘x
, 
s
->
ªc‹d_cou¡
);

44462 
	}
}

44464 
JSVÆue
 
	$js_m≠_f‹Each
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

44465 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
, 
magic
)

44467 
JSM≠Sèã
 *
s
 = 
	`JS_GëO∑que2
(
˘x
, 
this_vÆ
, 
JS_CLASS_MAP
 + 
magic
);

44468 
JSVÆueC⁄°
 
func
, 
this_¨g
;

44469 
JSVÆue
 
ªt
, 
¨gs
[3];

44470 
li°_hód
 *
ñ
;

44471 
JSM≠Rec‹d
 *
mr
;

44473 i‡(!
s
)

44474  
JS_EXCEPTION
;

44475 
func
 = 
¨gv
[0];

44476 i‡(
¨gc
 > 1)

44477 
this_¨g
 = 
¨gv
[1];

44479 
this_¨g
 = 
JS_UNDEFINED
;

44480 i‡(
	`check_fun˘i⁄
(
˘x
, 
func
))

44481  
JS_EXCEPTION
;

44484 
ñ
 = 
s
->
ªc‹ds
.
√xt
;

44485 
ñ
 !&
s
->
ªc‹ds
) {

44486 
mr
 = 
	`li°_íåy
(
ñ
, 
JSM≠Rec‹d
, 
lök
);

44487 i‡(!
mr
->
em±y
) {

44488 
mr
->
ªf_cou¡
++;

44490 
¨gs
[1] = 
	`JS_DupVÆue
(
˘x
, 
mr
->
key
);

44491 i‡(
magic
)

44492 
¨gs
[0] =árgs[1];

44494 
¨gs
[0] = 
	`JS_DupVÆue
(
˘x
, 
mr
->
vÆue
);

44495 
¨gs
[2] = (
JSVÆue
)
this_vÆ
;

44496 
ªt
 = 
	`JS_CÆl
(
˘x
, 
func
, 
this_¨g
, 3, (
JSVÆueC⁄°
 *)
¨gs
);

44497 
	`JS_FªeVÆue
(
˘x
, 
¨gs
[0]);

44498 i‡(!
magic
)

44499 
	`JS_FªeVÆue
(
˘x
, 
¨gs
[1]);

44500 
ñ
 =Él->
√xt
;

44501 
	`m≠_de¸ef_ªc‹d
(
˘x
->
π
, 
mr
);

44502 i‡(
	`JS_IsEx˚±i⁄
(
ªt
))

44503  
ªt
;

44504 
	`JS_FªeVÆue
(
˘x
, 
ªt
);

44506 
ñ
 =Él->
√xt
;

44509  
JS_UNDEFINED
;

44510 
	}
}

44512 
	$js_m≠_föÆizî
(
JSRu¡ime
 *
π
, 
JSVÆue
 
vÆ
)

44514 
JSObje˘
 *
p
;

44515 
JSM≠Sèã
 *
s
;

44516 
li°_hód
 *
ñ
, *
ñ1
;

44517 
JSM≠Rec‹d
 *
mr
;

44519 
p
 = 
	`JS_VALUE_GET_OBJ
(
vÆ
);

44520 
s
 = 
p
->
u
.
m≠_°©e
;

44521 i‡(
s
) {

44524 
	`li°_f‹_óch_ß„
(
ñ
, 
ñ1
, &
s
->
ªc‹ds
) {

44525 
mr
 = 
	`li°_íåy
(
ñ
, 
JSM≠Rec‹d
, 
lök
);

44526 i‡(!
mr
->
em±y
) {

44527 i‡(
s
->
is_wók
)

44528 
	`dñëe_wók_ªf
(
π
, 
mr
);

44530 
	`JS_FªeVÆueRT
(
π
, 
mr
->
key
);

44531 
	`JS_FªeVÆueRT
(
π
, 
mr
->
vÆue
);

44533 
	`js_‰ì_π
(
π
, 
mr
);

44535 
	`js_‰ì_π
(
π
, 
s
->
hash_èbÀ
);

44536 
	`js_‰ì_π
(
π
, 
s
);

44538 
	}
}

44540 
	$js_m≠_m¨k
(
JSRu¡ime
 *
π
, 
JSVÆueC⁄°
 
vÆ
, 
JS_M¨kFunc
 *
m¨k_func
)

44542 
JSObje˘
 *
p
 = 
	`JS_VALUE_GET_OBJ
(
vÆ
);

44543 
JSM≠Sèã
 *
s
;

44544 
li°_hód
 *
ñ
;

44545 
JSM≠Rec‹d
 *
mr
;

44547 
s
 = 
p
->
u
.
m≠_°©e
;

44548 i‡(
s
) {

44549 
	`li°_f‹_óch
(
ñ
, &
s
->
ªc‹ds
) {

44550 
mr
 = 
	`li°_íåy
(
ñ
, 
JSM≠Rec‹d
, 
lök
);

44551 i‡(!
s
->
is_wók
)

44552 
	`JS_M¨kVÆue
(
π
, 
mr
->
key
, 
m¨k_func
);

44553 
	`JS_M¨kVÆue
(
π
, 
mr
->
vÆue
, 
m¨k_func
);

44556 
	}
}

44560 
	sJSM≠Iãøt‹D©a
 {

44561 
JSVÆue
 
	mobj
;

44562 
JSIãøt‹KödEnum
 
	mköd
;

44563 
JSM≠Rec‹d
 *
	mcur_ªc‹d
;

44564 } 
	tJSM≠Iãøt‹D©a
;

44566 
	$js_m≠_ôî©‹_föÆizî
(
JSRu¡ime
 *
π
, 
JSVÆue
 
vÆ
)

44568 
JSObje˘
 *
p
;

44569 
JSM≠Iãøt‹D©a
 *
ô
;

44571 
p
 = 
	`JS_VALUE_GET_OBJ
(
vÆ
);

44572 
ô
 = 
p
->
u
.
m≠_ôî©‹_d©a
;

44573 i‡(
ô
) {

44576 i‡(
	`JS_IsLiveObje˘
(
π
, 
ô
->
obj
Ë&& it->
cur_ªc‹d
) {

44577 
	`m≠_de¸ef_ªc‹d
(
π
, 
ô
->
cur_ªc‹d
);

44579 
	`JS_FªeVÆueRT
(
π
, 
ô
->
obj
);

44580 
	`js_‰ì_π
(
π
, 
ô
);

44582 
	}
}

44584 
	$js_m≠_ôî©‹_m¨k
(
JSRu¡ime
 *
π
, 
JSVÆueC⁄°
 
vÆ
,

44585 
JS_M¨kFunc
 *
m¨k_func
)

44587 
JSObje˘
 *
p
 = 
	`JS_VALUE_GET_OBJ
(
vÆ
);

44588 
JSM≠Iãøt‹D©a
 *
ô
;

44589 
ô
 = 
p
->
u
.
m≠_ôî©‹_d©a
;

44590 i‡(
ô
) {

44592 
	`JS_M¨kVÆue
(
π
, 
ô
->
obj
, 
m¨k_func
);

44594 
	}
}

44596 
JSVÆue
 
	$js_¸óã_m≠_ôî©‹
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

44597 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
, 
magic
)

44599 
JSIãøt‹KödEnum
 
köd
;

44600 
JSM≠Sèã
 *
s
;

44601 
JSM≠Iãøt‹D©a
 *
ô
;

44602 
JSVÆue
 
íum_obj
;

44604 
köd
 = 
magic
 >> 2;

44605 
magic
 &= 3;

44606 
s
 = 
	`JS_GëO∑que2
(
˘x
, 
this_vÆ
, 
JS_CLASS_MAP
 + 
magic
);

44607 i‡(!
s
)

44608  
JS_EXCEPTION
;

44609 
íum_obj
 = 
	`JS_NewObje˘Cœss
(
˘x
, 
JS_CLASS_MAP_ITERATOR
 + 
magic
);

44610 i‡(
	`JS_IsEx˚±i⁄
(
íum_obj
))

44611 
Áû
;

44612 
ô
 = 
	`js_mÆloc
(
˘x
, (*it));

44613 i‡(!
ô
) {

44614 
	`JS_FªeVÆue
(
˘x
, 
íum_obj
);

44615 
Áû
;

44617 
ô
->
obj
 = 
	`JS_DupVÆue
(
˘x
, 
this_vÆ
);

44618 
ô
->
köd
 = kind;

44619 
ô
->
cur_ªc‹d
 = 
NULL
;

44620 
	`JS_SëO∑que
(
íum_obj
, 
ô
);

44621  
íum_obj
;

44622 
Áû
:

44623  
JS_EXCEPTION
;

44624 
	}
}

44626 
JSVÆue
 
	$js_m≠_ôî©‹_√xt
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

44627 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
,

44628 
BOOL
 *
pd⁄e
, 
magic
)

44630 
JSM≠Iãøt‹D©a
 *
ô
;

44631 
JSM≠Sèã
 *
s
;

44632 
JSM≠Rec‹d
 *
mr
;

44633 
li°_hód
 *
ñ
;

44635 
ô
 = 
	`JS_GëO∑que2
(
˘x
, 
this_vÆ
, 
JS_CLASS_MAP_ITERATOR
 + 
magic
);

44636 i‡(!
ô
) {

44637 *
pd⁄e
 = 
FALSE
;

44638  
JS_EXCEPTION
;

44640 i‡(
	`JS_IsUndeföed
(
ô
->
obj
))

44641 
d⁄e
;

44642 
s
 = 
	`JS_GëO∑que
(
ô
->
obj
, 
JS_CLASS_MAP
 + 
magic
);

44643 
	`as£π
(
s
 !
NULL
);

44644 i‡(!
ô
->
cur_ªc‹d
) {

44645 
ñ
 = 
s
->
ªc‹ds
.
√xt
;

44647 
mr
 = 
ô
->
cur_ªc‹d
;

44648 
ñ
 = 
mr
->
lök
.
√xt
;

44649 
	`m≠_de¸ef_ªc‹d
(
˘x
->
π
, 
mr
);

44652 i‡(
ñ
 =&
s
->
ªc‹ds
) {

44654 
ô
->
cur_ªc‹d
 = 
NULL
;

44655 
	`JS_FªeVÆue
(
˘x
, 
ô
->
obj
);

44656 
ô
->
obj
 = 
JS_UNDEFINED
;

44657 
d⁄e
:

44659 *
pd⁄e
 = 
TRUE
;

44660  
JS_UNDEFINED
;

44662 
mr
 = 
	`li°_íåy
(
ñ
, 
JSM≠Rec‹d
, 
lök
);

44663 i‡(!
mr
->
em±y
)

44666 
ñ
 = 
mr
->
lök
.
√xt
;

44670 
mr
->
ªf_cou¡
++;

44671 
ô
->
cur_ªc‹d
 = 
mr
;

44672 *
pd⁄e
 = 
FALSE
;

44674 i‡(
ô
->
köd
 =
JS_ITERATOR_KIND_KEY
) {

44675  
	`JS_DupVÆue
(
˘x
, 
mr
->
key
);

44677 
JSVÆueC⁄°
 
¨gs
[2];

44678 
¨gs
[0] = 
mr
->
key
;

44679 i‡(
magic
)

44680 
¨gs
[1] = 
mr
->
key
;

44682 
¨gs
[1] = 
mr
->
vÆue
;

44683 i‡(
ô
->
köd
 =
JS_ITERATOR_KIND_VALUE
) {

44684  
	`JS_DupVÆue
(
˘x
, 
¨gs
[1]);

44686  
	`js_¸óã_¨øy
(
˘x
, 2, 
¨gs
);

44689 
	}
}

44691 c⁄° 
JSCFun˘i⁄Li°E¡ry
 
	gjs_m≠_funcs
[] = {

44692 
JS_CGETSET_DEF
("[Symbﬁ.•ecõs]", 
js_gë_this
, 
NULL
 ),

44695 c⁄° 
JSCFun˘i⁄Li°E¡ry
 
	gjs_m≠_¥Ÿo_funcs
[] = {

44696 
JS_CFUNC_MAGIC_DEF
("£t", 2, 
js_m≠_£t
, 0 ),

44697 
JS_CFUNC_MAGIC_DEF
("gë", 1, 
js_m≠_gë
, 0 ),

44698 
JS_CFUNC_MAGIC_DEF
("has", 1, 
js_m≠_has
, 0 ),

44699 
JS_CFUNC_MAGIC_DEF
("dñëe", 1, 
js_m≠_dñëe
, 0 ),

44700 
JS_CFUNC_MAGIC_DEF
("˛ór", 0, 
js_m≠_˛ór
, 0 ),

44701 
JS_CGETSET_MAGIC_DEF
("size", 
js_m≠_gë_size
, 
NULL
, 0),

44702 
JS_CFUNC_MAGIC_DEF
("f‹Each", 1, 
js_m≠_f‹Each
, 0 ),

44703 
JS_CFUNC_MAGIC_DEF
("vÆues", 0, 
js_¸óã_m≠_ôî©‹
, (
JS_ITERATOR_KIND_VALUE
 << 2) | 0 ),

44704 
JS_CFUNC_MAGIC_DEF
("keys", 0, 
js_¸óã_m≠_ôî©‹
, (
JS_ITERATOR_KIND_KEY
 << 2) | 0 ),

44705 
JS_CFUNC_MAGIC_DEF
("íåõs", 0, 
js_¸óã_m≠_ôî©‹
, (
JS_ITERATOR_KIND_KEY_AND_VALUE
 << 2) | 0 ),

44706 
JS_ALIAS_DEF
("[Symbol.iterator]", "entries" ),

44707 
JS_PROP_STRING_DEF
("[Symbﬁ.toSåögTag]", "M≠", 
JS_PROP_CONFIGURABLE
 ),

44710 c⁄° 
JSCFun˘i⁄Li°E¡ry
 
	gjs_m≠_ôî©‹_¥Ÿo_funcs
[] = {

44711 
JS_ITERATOR_NEXT_DEF
("√xt", 0, 
js_m≠_ôî©‹_√xt
, 0 ),

44712 
JS_PROP_STRING_DEF
("[Symbﬁ.toSåögTag]", "M≠ Iãøt‹", 
JS_PROP_CONFIGURABLE
 ),

44715 c⁄° 
JSCFun˘i⁄Li°E¡ry
 
	gjs_£t_¥Ÿo_funcs
[] = {

44716 
JS_CFUNC_MAGIC_DEF
("add", 1, 
js_m≠_£t
, 
MAGIC_SET
 ),

44717 
JS_CFUNC_MAGIC_DEF
("has", 1, 
js_m≠_has
, 
MAGIC_SET
 ),

44718 
JS_CFUNC_MAGIC_DEF
("dñëe", 1, 
js_m≠_dñëe
, 
MAGIC_SET
 ),

44719 
JS_CFUNC_MAGIC_DEF
("˛ór", 0, 
js_m≠_˛ór
, 
MAGIC_SET
 ),

44720 
JS_CGETSET_MAGIC_DEF
("size", 
js_m≠_gë_size
, 
NULL
, 
MAGIC_SET
 ),

44721 
JS_CFUNC_MAGIC_DEF
("f‹Each", 1, 
js_m≠_f‹Each
, 
MAGIC_SET
 ),

44722 
JS_CFUNC_MAGIC_DEF
("vÆues", 0, 
js_¸óã_m≠_ôî©‹
, (
JS_ITERATOR_KIND_KEY
 << 2Ë| 
MAGIC_SET
 ),

44723 
JS_ALIAS_DEF
("keys", "values" ),

44724 
JS_ALIAS_DEF
("[Symbol.iterator]", "values" ),

44725 
JS_CFUNC_MAGIC_DEF
("íåõs", 0, 
js_¸óã_m≠_ôî©‹
, (
JS_ITERATOR_KIND_KEY_AND_VALUE
 << 2Ë| 
MAGIC_SET
 ),

44726 
JS_PROP_STRING_DEF
("[Symbﬁ.toSåögTag]", "Së", 
JS_PROP_CONFIGURABLE
 ),

44729 c⁄° 
JSCFun˘i⁄Li°E¡ry
 
	gjs_£t_ôî©‹_¥Ÿo_funcs
[] = {

44730 
JS_ITERATOR_NEXT_DEF
("√xt", 0, 
js_m≠_ôî©‹_√xt
, 
MAGIC_SET
 ),

44731 
JS_PROP_STRING_DEF
("[Symbﬁ.toSåögTag]", "Së Iãøt‹", 
JS_PROP_CONFIGURABLE
 ),

44734 c⁄° 
JSCFun˘i⁄Li°E¡ry
 
	gjs_wók_m≠_¥Ÿo_funcs
[] = {

44735 
JS_CFUNC_MAGIC_DEF
("£t", 2, 
js_m≠_£t
, 
MAGIC_WEAK
 ),

44736 
JS_CFUNC_MAGIC_DEF
("gë", 1, 
js_m≠_gë
, 
MAGIC_WEAK
 ),

44737 
JS_CFUNC_MAGIC_DEF
("has", 1, 
js_m≠_has
, 
MAGIC_WEAK
 ),

44738 
JS_CFUNC_MAGIC_DEF
("dñëe", 1, 
js_m≠_dñëe
, 
MAGIC_WEAK
 ),

44739 
JS_PROP_STRING_DEF
("[Symbﬁ.toSåögTag]", "WókM≠", 
JS_PROP_CONFIGURABLE
 ),

44742 c⁄° 
JSCFun˘i⁄Li°E¡ry
 
	gjs_wók_£t_¥Ÿo_funcs
[] = {

44743 
JS_CFUNC_MAGIC_DEF
("add", 1, 
js_m≠_£t
, 
MAGIC_SET
 | 
MAGIC_WEAK
 ),

44744 
JS_CFUNC_MAGIC_DEF
("has", 1, 
js_m≠_has
, 
MAGIC_SET
 | 
MAGIC_WEAK
 ),

44745 
JS_CFUNC_MAGIC_DEF
("dñëe", 1, 
js_m≠_dñëe
, 
MAGIC_SET
 | 
MAGIC_WEAK
 ),

44746 
JS_PROP_STRING_DEF
("[Symbﬁ.toSåögTag]", "WókSë", 
JS_PROP_CONFIGURABLE
 ),

44749 c⁄° 
JSCFun˘i⁄Li°E¡ry
 * c⁄° 
	gjs_m≠_¥Ÿo_funcs_±r
[6] = {

44750 
js_m≠_¥Ÿo_funcs
,

44751 
js_£t_¥Ÿo_funcs
,

44752 
js_wók_m≠_¥Ÿo_funcs
,

44753 
js_wók_£t_¥Ÿo_funcs
,

44754 
js_m≠_ôî©‹_¥Ÿo_funcs
,

44755 
js_£t_ôî©‹_¥Ÿo_funcs
,

44758 c⁄° 
uöt8_t
 
	gjs_m≠_¥Ÿo_funcs_cou¡
[6] = {

44759 
cou¡of
(
js_m≠_¥Ÿo_funcs
),

44760 
cou¡of
(
js_£t_¥Ÿo_funcs
),

44761 
cou¡of
(
js_wók_m≠_¥Ÿo_funcs
),

44762 
cou¡of
(
js_wók_£t_¥Ÿo_funcs
),

44763 
cou¡of
(
js_m≠_ôî©‹_¥Ÿo_funcs
),

44764 
cou¡of
(
js_£t_ôî©‹_¥Ÿo_funcs
),

44767 
	$JS_AddI¡rösicM≠Së
(
JSC⁄ãxt
 *
˘x
)

44769 
i
;

44770 
JSVÆue
 
obj1
;

44771 
buf
[
ATOM_GET_STR_BUF_SIZE
];

44773 
i
 = 0; i < 4; i++) {

44774 c⁄° *
«me
 = 
	`JS_AtomGëSå
(
˘x
, 
buf
, (buf),

44775 
JS_ATOM_M≠
 + 
i
);

44776 
˘x
->
˛ass_¥Ÿo
[
JS_CLASS_MAP
 + 
i
] = 
	`JS_NewObje˘
(ctx);

44777 
	`JS_SëPr›îtyFun˘i⁄Li°
(
˘x
, ctx->
˛ass_¥Ÿo
[
JS_CLASS_MAP
 + 
i
],

44778 
js_m≠_¥Ÿo_funcs_±r
[
i
],

44779 
js_m≠_¥Ÿo_funcs_cou¡
[
i
]);

44780 
obj1
 = 
	`JS_NewCFun˘i⁄Magic
(
˘x
, 
js_m≠_c⁄°ru˘‹
, 
«me
, 0,

44781 
JS_CFUNC_c⁄°ru˘‹_magic
, 
i
);

44782 i‡(
i
 < 2) {

44783 
	`JS_SëPr›îtyFun˘i⁄Li°
(
˘x
, 
obj1
, 
js_m≠_funcs
,

44784 
	`cou¡of
(
js_m≠_funcs
));

44786 
	`JS_NewGlobÆCC⁄°ru˘‹2
(
˘x
, 
obj1
, 
«me
, ctx->
˛ass_¥Ÿo
[
JS_CLASS_MAP
 + 
i
]);

44789 
i
 = 0; i < 2; i++) {

44790 
˘x
->
˛ass_¥Ÿo
[
JS_CLASS_MAP_ITERATOR
 + 
i
] =

44791 
	`JS_NewObje˘PrŸo
(
˘x
, ctx->
ôî©‹_¥Ÿo
);

44792 
	`JS_SëPr›îtyFun˘i⁄Li°
(
˘x
, ctx->
˛ass_¥Ÿo
[
JS_CLASS_MAP_ITERATOR
 + 
i
],

44793 
js_m≠_¥Ÿo_funcs_±r
[
i
 + 4],

44794 
js_m≠_¥Ÿo_funcs_cou¡
[
i
 + 4]);

44796 
	}
}

44799 c⁄° 
JSCFun˘i⁄Li°E¡ry
 
	gjs_gíî©‹_fun˘i⁄_¥Ÿo_funcs
[] = {

44800 
JS_PROP_STRING_DEF
("[Symbﬁ.toSåögTag]", "Gíî©‹Fun˘i⁄", 
JS_PROP_CONFIGURABLE
),

44803 c⁄° 
JSCFun˘i⁄Li°E¡ry
 
	gjs_gíî©‹_¥Ÿo_funcs
[] = {

44804 
JS_ITERATOR_NEXT_DEF
("√xt", 1, 
js_gíî©‹_√xt
, 
GEN_MAGIC_NEXT
 ),

44805 
JS_ITERATOR_NEXT_DEF
("ªtu∫", 1, 
js_gíî©‹_√xt
, 
GEN_MAGIC_RETURN
 ),

44806 
JS_ITERATOR_NEXT_DEF
("throw", 1, 
js_gíî©‹_√xt
, 
GEN_MAGIC_THROW
 ),

44807 
JS_PROP_STRING_DEF
("[Symbﬁ.toSåögTag]", "Gíî©‹", 
JS_PROP_CONFIGURABLE
),

44812 
	eJSPromi£SèãEnum
 {

44813 
	mJS_PROMISE_PENDING
,

44814 
	mJS_PROMISE_FULFILLED
,

44815 
	mJS_PROMISE_REJECTED
,

44816 } 
	tJSPromi£SèãEnum
;

44818 
	sJSPromi£D©a
 {

44819 
JSPromi£SèãEnum
 
	m¥omi£_°©e
;

44821 
li°_hód
 
	m¥omi£_ªa˘i⁄s
[2];

44822 
BOOL
 
	mis_h™dÀd
;

44823 
JSVÆue
 
	m¥omi£_ªsu…
;

44824 } 
	tJSPromi£D©a
;

44826 
	sJSPromi£Fun˘i⁄D©aResﬁved
 {

44827 
	mªf_cou¡
;

44828 
BOOL
 
	mÆªady_ªsﬁved
;

44829 } 
	tJSPromi£Fun˘i⁄D©aResﬁved
;

44831 
	sJSPromi£Fun˘i⁄D©a
 {

44832 
JSVÆue
 
	m¥omi£
;

44833 
JSPromi£Fun˘i⁄D©aResﬁved
 *
	m¥esﬁved
;

44834 } 
	tJSPromi£Fun˘i⁄D©a
;

44836 
	sJSPromi£Ró˘i⁄D©a
 {

44837 
li°_hód
 
	mlök
;

44838 
JSVÆue
 
	mªsﬁvög_funcs
[2];

44839 
JSVÆue
 
	mh™dÀr
;

44840 } 
	tJSPromi£Ró˘i⁄D©a
;

44842 
js_¸óã_ªsﬁvög_fun˘i⁄s
(
JSC⁄ãxt
 *
˘x
, 
JSVÆue
 *
¨gs
,

44843 
JSVÆueC⁄°
 
¥omi£
);

44845 
	$¥omi£_ªa˘i⁄_d©a_‰ì
(
JSRu¡ime
 *
π
,

44846 
JSPromi£Ró˘i⁄D©a
 *
rd
)

44848 
	`JS_FªeVÆueRT
(
π
, 
rd
->
ªsﬁvög_funcs
[0]);

44849 
	`JS_FªeVÆueRT
(
π
, 
rd
->
ªsﬁvög_funcs
[1]);

44850 
	`JS_FªeVÆueRT
(
π
, 
rd
->
h™dÀr
);

44851 
	`js_‰ì_π
(
π
, 
rd
);

44852 
	}
}

44854 
JSVÆue
 
	$¥omi£_ªa˘i⁄_job
(
JSC⁄ãxt
 *
˘x
, 
¨gc
,

44855 
JSVÆueC⁄°
 *
¨gv
)

44857 
JSVÆueC⁄°
 
h™dÀr
, 
¨g
, 
func
;

44858 
JSVÆue
 
ªs
, 
ªs2
;

44859 
BOOL
 
is_ªje˘
;

44861 
	`as£π
(
¨gc
 == 5);

44862 
h™dÀr
 = 
¨gv
[2];

44863 
is_ªje˘
 = 
	`JS_ToBoﬁ
(
˘x
, 
¨gv
[3]);

44864 
¨g
 = 
¨gv
[4];

44865 #ifde‡
DUMP_PROMISE


44866 
	`¥ötf
("¥omi£_ªa˘i⁄_job: is_ªje˘=%d\n", 
is_ªje˘
);

44869 i‡(
	`JS_IsUndeföed
(
h™dÀr
)) {

44870 i‡(
is_ªje˘
) {

44871 
ªs
 = 
	`JS_Throw
(
˘x
, 
	`JS_DupVÆue
(˘x, 
¨g
));

44873 
ªs
 = 
	`JS_DupVÆue
(
˘x
, 
¨g
);

44876 
ªs
 = 
	`JS_CÆl
(
˘x
, 
h™dÀr
, 
JS_UNDEFINED
, 1, &
¨g
);

44878 
is_ªje˘
 = 
	`JS_IsEx˚±i⁄
(
ªs
);

44879 i‡(
is_ªje˘
)

44880 
ªs
 = 
	`JS_GëEx˚±i⁄
(
˘x
);

44881 
func
 = 
¨gv
[
is_ªje˘
];

44885 i‡(!
	`JS_IsUndeföed
(
func
)) {

44886 
ªs2
 = 
	`JS_CÆl
(
˘x
, 
func
, 
JS_UNDEFINED
,

44887 1, (
JSVÆueC⁄°
 *)&
ªs
);

44889 
ªs2
 = 
JS_UNDEFINED
;

44891 
	`JS_FªeVÆue
(
˘x
, 
ªs
);

44893  
ªs2
;

44894 
	}
}

44896 
	$JS_SëHo°Promi£Reje˘i⁄Tøckî
(
JSRu¡ime
 *
π
,

44897 
JSHo°Promi£Reje˘i⁄Tøckî
 *
cb
,

44898 *
›aque
)

44900 
π
->
ho°_¥omi£_ªje˘i⁄_åackî
 = 
cb
;

44901 
π
->
ho°_¥omi£_ªje˘i⁄_åackî_›aque
 = 
›aque
;

44902 
	}
}

44904 
	$fulfûl_‹_ªje˘_¥omi£
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
¥omi£
,

44905 
JSVÆueC⁄°
 
vÆue
, 
BOOL
 
is_ªje˘
)

44907 
JSPromi£D©a
 *
s
 = 
	`JS_GëO∑que
(
¥omi£
, 
JS_CLASS_PROMISE
);

44908 
li°_hód
 *
ñ
, *
ñ1
;

44909 
JSPromi£Ró˘i⁄D©a
 *
rd
;

44910 
JSVÆueC⁄°
 
¨gs
[5];

44912 i‡(!
s
 || s->
¥omi£_°©e
 !
JS_PROMISE_PENDING
)

44914 
	`£t_vÆue
(
˘x
, &
s
->
¥omi£_ªsu…
, 
	`JS_DupVÆue
(˘x, 
vÆue
));

44915 
s
->
¥omi£_°©e
 = 
JS_PROMISE_FULFILLED
 + 
is_ªje˘
;

44916 #ifde‡
DUMP_PROMISE


44917 
	`¥ötf
("fulfûl_‹_ªje˘_¥omi£: is_ªje˘=%d\n", 
is_ªje˘
);

44919 i‡(
s
->
¥omi£_°©e
 =
JS_PROMISE_REJECTED
 && !s->
is_h™dÀd
) {

44920 
JSRu¡ime
 *
π
 = 
˘x
->rt;

44921 i‡(
π
->
ho°_¥omi£_ªje˘i⁄_åackî
) {

44922 
π
->
	`ho°_¥omi£_ªje˘i⁄_åackî
(
˘x
, 
¥omi£
, 
vÆue
, 
FALSE
,

44923 
π
->
ho°_¥omi£_ªje˘i⁄_åackî_›aque
);

44927 
	`li°_f‹_óch_ß„
(
ñ
, 
ñ1
, &
s
->
¥omi£_ªa˘i⁄s
[
is_ªje˘
]) {

44928 
rd
 = 
	`li°_íåy
(
ñ
, 
JSPromi£Ró˘i⁄D©a
, 
lök
);

44929 
¨gs
[0] = 
rd
->
ªsﬁvög_funcs
[0];

44930 
¨gs
[1] = 
rd
->
ªsﬁvög_funcs
[1];

44931 
¨gs
[2] = 
rd
->
h™dÀr
;

44932 
¨gs
[3] = 
	`JS_NewBoﬁ
(
˘x
, 
is_ªje˘
);

44933 
¨gs
[4] = 
vÆue
;

44934 
	`JS_EnqueueJob
(
˘x
, 
¥omi£_ªa˘i⁄_job
, 5, 
¨gs
);

44935 
	`li°_dñ
(&
rd
->
lök
);

44936 
	`¥omi£_ªa˘i⁄_d©a_‰ì
(
˘x
->
π
, 
rd
);

44939 
	`li°_f‹_óch_ß„
(
ñ
, 
ñ1
, &
s
->
¥omi£_ªa˘i⁄s
[1 - 
is_ªje˘
]) {

44940 
rd
 = 
	`li°_íåy
(
ñ
, 
JSPromi£Ró˘i⁄D©a
, 
lök
);

44941 
	`li°_dñ
(&
rd
->
lök
);

44942 
	`¥omi£_ªa˘i⁄_d©a_‰ì
(
˘x
->
π
, 
rd
);

44944 
	}
}

44946 
	$ªje˘_¥omi£
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
¥omi£
,

44947 
JSVÆueC⁄°
 
vÆue
)

44949 
	`fulfûl_‹_ªje˘_¥omi£
(
˘x
, 
¥omi£
, 
vÆue
, 
TRUE
);

44950 
	}
}

44952 
JSVÆue
 
	$js_¥omi£_ªsﬁve_thíabÀ_job
(
JSC⁄ãxt
 *
˘x
,

44953 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

44955 
JSVÆueC⁄°
 
¥omi£
, 
thíabÀ
, 
thí
;

44956 
JSVÆue
 
¨gs
[2], 
ªs
;

44958 #ifde‡
DUMP_PROMISE


44959 
	`¥ötf
("js_promise_resolve_thenable_job\n");

44961 
	`as£π
(
¨gc
 == 3);

44962 
¥omi£
 = 
¨gv
[0];

44963 
thíabÀ
 = 
¨gv
[1];

44964 
thí
 = 
¨gv
[2];

44965 i‡(
	`js_¸óã_ªsﬁvög_fun˘i⁄s
(
˘x
, 
¨gs
, 
¥omi£
) < 0)

44966  
JS_EXCEPTION
;

44967 
ªs
 = 
	`JS_CÆl
(
˘x
, 
thí
, 
thíabÀ
, 2, (
JSVÆueC⁄°
 *)
¨gs
);

44968 i‡(
	`JS_IsEx˚±i⁄
(
ªs
)) {

44969 
JSVÆue
 
îr‹
 = 
	`JS_GëEx˚±i⁄
(
˘x
);

44970 
ªs
 = 
	`JS_CÆl
(
˘x
, 
¨gs
[1], 
JS_UNDEFINED
, 1, (
JSVÆueC⁄°
 *)&
îr‹
);

44971 
	`JS_FªeVÆue
(
˘x
, 
îr‹
);

44973 
	`JS_FªeVÆue
(
˘x
, 
¨gs
[0]);

44974 
	`JS_FªeVÆue
(
˘x
, 
¨gs
[1]);

44975  
ªs
;

44976 
	}
}

44978 
	$js_¥omi£_ªsﬁve_fun˘i⁄_‰ì_ªsﬁved
(
JSRu¡ime
 *
π
,

44979 
JSPromi£Fun˘i⁄D©aResﬁved
 *
§
)

44981 i‡(--
§
->
ªf_cou¡
 == 0) {

44982 
	`js_‰ì_π
(
π
, 
§
);

44984 
	}
}

44986 
	$js_¸óã_ªsﬁvög_fun˘i⁄s
(
JSC⁄ãxt
 *
˘x
,

44987 
JSVÆue
 *
ªsﬁvög_funcs
,

44988 
JSVÆueC⁄°
 
¥omi£
)

44991 
JSVÆue
 
obj
;

44992 
JSPromi£Fun˘i⁄D©a
 *
s
;

44993 
JSPromi£Fun˘i⁄D©aResﬁved
 *
§
;

44994 
i
, 
ªt
;

44996 
§
 = 
	`js_mÆloc
(
˘x
, (*sr));

44997 i‡(!
§
)

44999 
§
->
ªf_cou¡
 = 1;

45000 
§
->
Æªady_ªsﬁved
 = 
FALSE
;

45001 
ªt
 = 0;

45002 
i
 = 0; i < 2; i++) {

45003 
obj
 = 
	`JS_NewObje˘PrŸoCœss
(
˘x
, ctx->
fun˘i⁄_¥Ÿo
,

45004 
JS_CLASS_PROMISE_RESOLVE_FUNCTION
 + 
i
);

45005 i‡(
	`JS_IsEx˚±i⁄
(
obj
))

45006 
Áû
;

45007 
s
 = 
	`js_mÆloc
(
˘x
, (*s));

45008 i‡(!
s
) {

45009 
	`JS_FªeVÆue
(
˘x
, 
obj
);

45010 
Áû
:

45012 i‡(
i
 != 0)

45013 
	`JS_FªeVÆue
(
˘x
, 
ªsﬁvög_funcs
[0]);

45014 
ªt
 = -1;

45017 
§
->
ªf_cou¡
++;

45018 
s
->
¥esﬁved
 = 
§
;

45019 
s
->
¥omi£
 = 
	`JS_DupVÆue
(
˘x
,Öromise);

45020 
	`JS_SëO∑que
(
obj
, 
s
);

45021 
	`js_fun˘i⁄_£t_¥›îtõs
(
˘x
, 
obj
, 
JS_ATOM_em±y_°rög
, 1);

45022 
ªsﬁvög_funcs
[
i
] = 
obj
;

45024 
	`js_¥omi£_ªsﬁve_fun˘i⁄_‰ì_ªsﬁved
(
˘x
->
π
, 
§
);

45025  
ªt
;

45026 
	}
}

45028 
	$js_¥omi£_ªsﬁve_fun˘i⁄_föÆizî
(
JSRu¡ime
 *
π
, 
JSVÆue
 
vÆ
)

45030 
JSPromi£Fun˘i⁄D©a
 *
s
 = 
	`JS_VALUE_GET_OBJ
(
vÆ
)->
u
.
¥omi£_fun˘i⁄_d©a
;

45031 i‡(
s
) {

45032 
	`js_¥omi£_ªsﬁve_fun˘i⁄_‰ì_ªsﬁved
(
π
, 
s
->
¥esﬁved
);

45033 
	`JS_FªeVÆueRT
(
π
, 
s
->
¥omi£
);

45034 
	`js_‰ì_π
(
π
, 
s
);

45036 
	}
}

45038 
	$js_¥omi£_ªsﬁve_fun˘i⁄_m¨k
(
JSRu¡ime
 *
π
, 
JSVÆueC⁄°
 
vÆ
,

45039 
JS_M¨kFunc
 *
m¨k_func
)

45041 
JSPromi£Fun˘i⁄D©a
 *
s
 = 
	`JS_VALUE_GET_OBJ
(
vÆ
)->
u
.
¥omi£_fun˘i⁄_d©a
;

45042 i‡(
s
) {

45043 
	`JS_M¨kVÆue
(
π
, 
s
->
¥omi£
, 
m¨k_func
);

45045 
	}
}

45047 
JSVÆue
 
	$js_¥omi£_ªsﬁve_fun˘i⁄_ˇŒ
(
JSC⁄ãxt
 *
˘x
,

45048 
JSVÆueC⁄°
 
func_obj
,

45049 
JSVÆueC⁄°
 
this_vÆ
,

45050 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
,

45051 
Êags
)

45053 
JSObje˘
 *
p
 = 
	`JS_VALUE_GET_OBJ
(
func_obj
);

45054 
JSPromi£Fun˘i⁄D©a
 *
s
;

45055 
JSVÆueC⁄°
 
ªsﬁuti⁄
, 
¨gs
[3];

45056 
JSVÆue
 
thí
;

45057 
BOOL
 
is_ªje˘
;

45059 
s
 = 
p
->
u
.
¥omi£_fun˘i⁄_d©a
;

45060 i‡(!
s
 || s->
¥esﬁved
->
Æªady_ªsﬁved
)

45061  
JS_UNDEFINED
;

45062 
s
->
¥esﬁved
->
Æªady_ªsﬁved
 = 
TRUE
;

45063 
is_ªje˘
 = 
p
->
˛ass_id
 - 
JS_CLASS_PROMISE_RESOLVE_FUNCTION
;

45064 i‡(
¨gc
 > 0)

45065 
ªsﬁuti⁄
 = 
¨gv
[0];

45067 
ªsﬁuti⁄
 = 
JS_UNDEFINED
;

45068 #ifde‡
DUMP_PROMISE


45069 
	`¥ötf
("js_¥omi£_ªsﬁvög_fun˘i⁄_ˇŒ: is_ªje˘=%dÑesﬁuti⁄=", 
is_ªje˘
);

45070 
	`JS_DumpVÆue
(
˘x
, 
ªsﬁuti⁄
);

45071 
	`¥ötf
("\n");

45073 i‡(
is_ªje˘
 || !
	`JS_IsObje˘
(
ªsﬁuti⁄
)) {

45074 
d⁄e
;

45075 } i‡(
	`js_ßme_vÆue
(
˘x
, 
ªsﬁuti⁄
, 
s
->
¥omi£
)) {

45076 
	`JS_ThrowTy≥Eº‹
(
˘x
, "promise selfÑesolution");

45077 
Áû_ªje˘
;

45079 
thí
 = 
	`JS_GëPr›îty
(
˘x
, 
ªsﬁuti⁄
, 
JS_ATOM_thí
);

45080 i‡(
	`JS_IsEx˚±i⁄
(
thí
)) {

45081 
JSVÆue
 
îr‹
;

45082 
Áû_ªje˘
:

45083 
îr‹
 = 
	`JS_GëEx˚±i⁄
(
˘x
);

45084 
	`ªje˘_¥omi£
(
˘x
, 
s
->
¥omi£
, 
îr‹
);

45085 
	`JS_FªeVÆue
(
˘x
, 
îr‹
);

45086 } i‡(!
	`JS_IsFun˘i⁄
(
˘x
, 
thí
)) {

45087 
	`JS_FªeVÆue
(
˘x
, 
thí
);

45088 
d⁄e
:

45089 
	`fulfûl_‹_ªje˘_¥omi£
(
˘x
, 
s
->
¥omi£
, 
ªsﬁuti⁄
, 
is_ªje˘
);

45091 
¨gs
[0] = 
s
->
¥omi£
;

45092 
¨gs
[1] = 
ªsﬁuti⁄
;

45093 
¨gs
[2] = 
thí
;

45094 
	`JS_EnqueueJob
(
˘x
, 
js_¥omi£_ªsﬁve_thíabÀ_job
, 3, 
¨gs
);

45095 
	`JS_FªeVÆue
(
˘x
, 
thí
);

45097  
JS_UNDEFINED
;

45098 
	}
}

45100 
	$js_¥omi£_föÆizî
(
JSRu¡ime
 *
π
, 
JSVÆue
 
vÆ
)

45102 
JSPromi£D©a
 *
s
 = 
	`JS_GëO∑que
(
vÆ
, 
JS_CLASS_PROMISE
);

45103 
li°_hód
 *
ñ
, *
ñ1
;

45104 
i
;

45106 i‡(!
s
)

45108 
i
 = 0; i < 2; i++) {

45109 
	`li°_f‹_óch_ß„
(
ñ
, 
ñ1
, &
s
->
¥omi£_ªa˘i⁄s
[
i
]) {

45110 
JSPromi£Ró˘i⁄D©a
 *
rd
 =

45111 
	`li°_íåy
(
ñ
, 
JSPromi£Ró˘i⁄D©a
, 
lök
);

45112 
	`¥omi£_ªa˘i⁄_d©a_‰ì
(
π
, 
rd
);

45115 
	`JS_FªeVÆueRT
(
π
, 
s
->
¥omi£_ªsu…
);

45116 
	`js_‰ì_π
(
π
, 
s
);

45117 
	}
}

45119 
	$js_¥omi£_m¨k
(
JSRu¡ime
 *
π
, 
JSVÆueC⁄°
 
vÆ
,

45120 
JS_M¨kFunc
 *
m¨k_func
)

45122 
JSPromi£D©a
 *
s
 = 
	`JS_GëO∑que
(
vÆ
, 
JS_CLASS_PROMISE
);

45123 
li°_hód
 *
ñ
;

45124 
i
;

45126 i‡(!
s
)

45128 
i
 = 0; i < 2; i++) {

45129 
	`li°_f‹_óch
(
ñ
, &
s
->
¥omi£_ªa˘i⁄s
[
i
]) {

45130 
JSPromi£Ró˘i⁄D©a
 *
rd
 =

45131 
	`li°_íåy
(
ñ
, 
JSPromi£Ró˘i⁄D©a
, 
lök
);

45132 
	`JS_M¨kVÆue
(
π
, 
rd
->
ªsﬁvög_funcs
[0], 
m¨k_func
);

45133 
	`JS_M¨kVÆue
(
π
, 
rd
->
ªsﬁvög_funcs
[1], 
m¨k_func
);

45134 
	`JS_M¨kVÆue
(
π
, 
rd
->
h™dÀr
, 
m¨k_func
);

45137 
	`JS_M¨kVÆue
(
π
, 
s
->
¥omi£_ªsu…
, 
m¨k_func
);

45138 
	}
}

45140 
JSVÆue
 
	$js_¥omi£_c⁄°ru˘‹
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
√w_èrgë
,

45141 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

45143 
JSVÆueC⁄°
 
execut‹
;

45144 
JSVÆue
 
obj
;

45145 
JSPromi£D©a
 *
s
;

45146 
JSVÆue
 
¨gs
[2], 
ªt
;

45147 
i
;

45149 
execut‹
 = 
¨gv
[0];

45150 i‡(
	`check_fun˘i⁄
(
˘x
, 
execut‹
))

45151  
JS_EXCEPTION
;

45152 
obj
 = 
	`js_¸óã_‰om_˘‹
(
˘x
, 
√w_èrgë
, 
JS_CLASS_PROMISE
);

45153 i‡(
	`JS_IsEx˚±i⁄
(
obj
))

45154  
JS_EXCEPTION
;

45155 
s
 = 
	`js_mÆlocz
(
˘x
, (*s));

45156 i‡(!
s
)

45157 
Áû
;

45158 
s
->
¥omi£_°©e
 = 
JS_PROMISE_PENDING
;

45159 
s
->
is_h™dÀd
 = 
FALSE
;

45160 
i
 = 0; i < 2; i++)

45161 
	`öô_li°_hód
(&
s
->
¥omi£_ªa˘i⁄s
[
i
]);

45162 
s
->
¥omi£_ªsu…
 = 
JS_UNDEFINED
;

45163 
	`JS_SëO∑que
(
obj
, 
s
);

45164 i‡(
	`js_¸óã_ªsﬁvög_fun˘i⁄s
(
˘x
, 
¨gs
, 
obj
))

45165 
Áû
;

45166 
ªt
 = 
	`JS_CÆl
(
˘x
, 
execut‹
, 
JS_UNDEFINED
, 2, (
JSVÆueC⁄°
 *)
¨gs
);

45167 i‡(
	`JS_IsEx˚±i⁄
(
ªt
)) {

45168 
JSVÆue
 
ªt2
, 
îr‹
;

45169 
îr‹
 = 
	`JS_GëEx˚±i⁄
(
˘x
);

45170 
ªt2
 = 
	`JS_CÆl
(
˘x
, 
¨gs
[1], 
JS_UNDEFINED
, 1, (
JSVÆueC⁄°
 *)&
îr‹
);

45171 
	`JS_FªeVÆue
(
˘x
, 
îr‹
);

45172 i‡(
	`JS_IsEx˚±i⁄
(
ªt2
))

45173 
Áû1
;

45174 
	`JS_FªeVÆue
(
˘x
, 
ªt2
);

45176 
	`JS_FªeVÆue
(
˘x
, 
ªt
);

45177 
	`JS_FªeVÆue
(
˘x
, 
¨gs
[0]);

45178 
	`JS_FªeVÆue
(
˘x
, 
¨gs
[1]);

45179  
obj
;

45180 
Áû1
:

45181 
	`JS_FªeVÆue
(
˘x
, 
¨gs
[0]);

45182 
	`JS_FªeVÆue
(
˘x
, 
¨gs
[1]);

45183 
Áû
:

45184 
	`JS_FªeVÆue
(
˘x
, 
obj
);

45185  
JS_EXCEPTION
;

45186 
	}
}

45188 
JSVÆue
 
	$js_¥omi£_execut‹
(
JSC⁄ãxt
 *
˘x
,

45189 
JSVÆueC⁄°
 
this_vÆ
,

45190 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
,

45191 
magic
, 
JSVÆue
 *
func_d©a
)

45193 
i
;

45195 
i
 = 0; i < 2; i++) {

45196 i‡(!
	`JS_IsUndeföed
(
func_d©a
[
i
]))

45197  
	`JS_ThrowTy≥Eº‹
(
˘x
, "resolving functionálready set");

45198 
func_d©a
[
i
] = 
	`JS_DupVÆue
(
˘x
, 
¨gv
[i]);

45200  
JS_UNDEFINED
;

45201 
	}
}

45203 
JSVÆue
 
	$js_¥omi£_execut‹_√w
(
JSC⁄ãxt
 *
˘x
)

45205 
JSVÆueC⁄°
 
func_d©a
[2];

45207 
func_d©a
[0] = 
JS_UNDEFINED
;

45208 
func_d©a
[1] = 
JS_UNDEFINED
;

45209  
	`JS_NewCFun˘i⁄D©a
(
˘x
, 
js_¥omi£_execut‹
, 2,

45210 0, 2, 
func_d©a
);

45211 
	}
}

45213 
JSVÆue
 
	$js_√w_¥omi£_ˇ∑bûôy
(
JSC⁄ãxt
 *
˘x
,

45214 
JSVÆue
 *
ªsﬁvög_funcs
,

45215 
JSVÆueC⁄°
 
˘‹
)

45217 
JSVÆue
 
execut‹
, 
ªsu…_¥omi£
;

45218 
JSCFun˘i⁄D©aRec‹d
 *
s
;

45219 
i
;

45221 
execut‹
 = 
	`js_¥omi£_execut‹_√w
(
˘x
);

45222 i‡(
	`JS_IsEx˚±i⁄
(
execut‹
))

45223  
execut‹
;

45225 i‡(
	`JS_IsUndeföed
(
˘‹
)) {

45226 
ªsu…_¥omi£
 = 
	`js_¥omi£_c⁄°ru˘‹
(
˘x
, 
˘‹
, 1,

45227 (
JSVÆueC⁄°
 *)&
execut‹
);

45229 
ªsu…_¥omi£
 = 
	`JS_CÆlC⁄°ru˘‹
(
˘x
, 
˘‹
, 1,

45230 (
JSVÆueC⁄°
 *)&
execut‹
);

45232 i‡(
	`JS_IsEx˚±i⁄
(
ªsu…_¥omi£
))

45233 
Áû
;

45234 
s
 = 
	`JS_GëO∑que
(
execut‹
, 
JS_CLASS_C_FUNCTION_DATA
);

45235 
i
 = 0; i < 2; i++) {

45236 i‡(
	`check_fun˘i⁄
(
˘x
, 
s
->
d©a
[
i
]))

45237 
Áû
;

45239 
i
 = 0; i < 2; i++)

45240 
ªsﬁvög_funcs
[
i
] = 
	`JS_DupVÆue
(
˘x
, 
s
->
d©a
[i]);

45241 
	`JS_FªeVÆue
(
˘x
, 
execut‹
);

45242  
ªsu…_¥omi£
;

45243 
Áû
:

45244 
	`JS_FªeVÆue
(
˘x
, 
execut‹
);

45245 
	`JS_FªeVÆue
(
˘x
, 
ªsu…_¥omi£
);

45246  
JS_EXCEPTION
;

45247 
	}
}

45249 
JSVÆue
 
	$JS_NewPromi£C≠abûôy
(
JSC⁄ãxt
 *
˘x
, 
JSVÆue
 *
ªsﬁvög_funcs
)

45251  
	`js_√w_¥omi£_ˇ∑bûôy
(
˘x
, 
ªsﬁvög_funcs
, 
JS_UNDEFINED
);

45252 
	}
}

45254 
JSVÆue
 
	$js_¥omi£_ªsﬁve
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

45255 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
, 
magic
)

45257 
JSVÆue
 
ªsu…_¥omi£
, 
ªsﬁvög_funcs
[2], 
ªt
;

45258 
BOOL
 
is_ªje˘
 = 
magic
;

45260 i‡(!
	`JS_IsObje˘
(
this_vÆ
))

45261  
	`JS_ThrowTy≥Eº‹NŸAnObje˘
(
˘x
);

45262 i‡(!
is_ªje˘
 && 
	`JS_GëO∑que
(
¨gv
[0], 
JS_CLASS_PROMISE
)) {

45263 
JSVÆue
 
˘‹
;

45264 
BOOL
 
is_ßme
;

45265 
˘‹
 = 
	`JS_GëPr›îty
(
˘x
, 
¨gv
[0], 
JS_ATOM_c⁄°ru˘‹
);

45266 i‡(
	`JS_IsEx˚±i⁄
(
˘‹
))

45267  
˘‹
;

45268 
is_ßme
 = 
	`js_ßme_vÆue
(
˘x
, 
˘‹
, 
this_vÆ
);

45269 
	`JS_FªeVÆue
(
˘x
, 
˘‹
);

45270 i‡(
is_ßme
)

45271  
	`JS_DupVÆue
(
˘x
, 
¨gv
[0]);

45273 
ªsu…_¥omi£
 = 
	`js_√w_¥omi£_ˇ∑bûôy
(
˘x
, 
ªsﬁvög_funcs
, 
this_vÆ
);

45274 i‡(
	`JS_IsEx˚±i⁄
(
ªsu…_¥omi£
))

45275  
ªsu…_¥omi£
;

45276 
ªt
 = 
	`JS_CÆl
(
˘x
, 
ªsﬁvög_funcs
[
is_ªje˘
], 
JS_UNDEFINED
, 1, 
¨gv
);

45277 
	`JS_FªeVÆue
(
˘x
, 
ªsﬁvög_funcs
[0]);

45278 
	`JS_FªeVÆue
(
˘x
, 
ªsﬁvög_funcs
[1]);

45279 i‡(
	`JS_IsEx˚±i⁄
(
ªt
)) {

45280 
	`JS_FªeVÆue
(
˘x
, 
ªsu…_¥omi£
);

45281  
ªt
;

45283 
	`JS_FªeVÆue
(
˘x
, 
ªt
);

45284  
ªsu…_¥omi£
;

45285 
	}
}

45288 
JSVÆue
 
	$js_¥omi£___√wPromi£C≠abûôy
(
JSC⁄ãxt
 *
˘x
,

45289 
JSVÆueC⁄°
 
this_vÆ
,

45290 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

45292 
JSVÆue
 
ªsu…_¥omi£
, 
ªsﬁvög_funcs
[2], 
obj
;

45293 
JSVÆueC⁄°
 
˘‹
;

45294 
˘‹
 = 
¨gv
[0];

45295 i‡(!
	`JS_IsObje˘
(
˘‹
))

45296  
	`JS_ThrowTy≥Eº‹NŸAnObje˘
(
˘x
);

45297 
ªsu…_¥omi£
 = 
	`js_√w_¥omi£_ˇ∑bûôy
(
˘x
, 
ªsﬁvög_funcs
, 
˘‹
);

45298 i‡(
	`JS_IsEx˚±i⁄
(
ªsu…_¥omi£
))

45299  
ªsu…_¥omi£
;

45300 
obj
 = 
	`JS_NewObje˘
(
˘x
);

45301 i‡(
	`JS_IsEx˚±i⁄
(
obj
)) {

45302 
	`JS_FªeVÆue
(
˘x
, 
ªsﬁvög_funcs
[0]);

45303 
	`JS_FªeVÆue
(
˘x
, 
ªsﬁvög_funcs
[1]);

45304 
	`JS_FªeVÆue
(
˘x
, 
ªsu…_¥omi£
);

45305  
JS_EXCEPTION
;

45307 
	`JS_DeföePr›îtyVÆue
(
˘x
, 
obj
, 
JS_ATOM_¥omi£
, 
ªsu…_¥omi£
, 
JS_PROP_C_W_E
);

45308 
	`JS_DeföePr›îtyVÆue
(
˘x
, 
obj
, 
JS_ATOM_ªsﬁve
, 
ªsﬁvög_funcs
[0], 
JS_PROP_C_W_E
);

45309 
	`JS_DeföePr›îtyVÆue
(
˘x
, 
obj
, 
JS_ATOM_ªje˘
, 
ªsﬁvög_funcs
[1], 
JS_PROP_C_W_E
);

45310  
obj
;

45311 
	}
}

45314 
__ex˚±i⁄
 
	$ªmaöögEÀmítsCou¡_add
(
JSC⁄ãxt
 *
˘x
,

45315 
JSVÆueC⁄°
 
ªsﬁve_ñemít_ív
,

45316 
addíd
)

45318 
JSVÆue
 
vÆ
;

45319 
ªmaöögEÀmítsCou¡
;

45321 
vÆ
 = 
	`JS_GëPr›îtyUöt32
(
˘x
, 
ªsﬁve_ñemít_ív
, 0);

45322 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

45324 i‡(
	`JS_ToI¡32Fªe
(
˘x
, &
ªmaöögEÀmítsCou¡
, 
vÆ
))

45326 
ªmaöögEÀmítsCou¡
 +
addíd
;

45327 i‡(
	`JS_SëPr›îtyUöt32
(
˘x
, 
ªsﬁve_ñemít_ív
, 0,

45328 
	`JS_NewI¡32
(
˘x
, 
ªmaöögEÀmítsCou¡
)) < 0)

45330  (
ªmaöögEÀmítsCou¡
 == 0);

45331 
	}
}

45333 
	#PROMISE_MAGIC_Æl
 0

	)

45334 
	#PROMISE_MAGIC_ÆlSëéed
 1

	)

45335 
	#PROMISE_MAGIC_™y
 2

	)

45337 
JSVÆue
 
	$js_¥omi£_Æl_ªsﬁve_ñemít
(
JSC⁄ãxt
 *
˘x
,

45338 
JSVÆueC⁄°
 
this_vÆ
,

45339 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
,

45340 
magic
,

45341 
JSVÆue
 *
func_d©a
)

45343 
ªsﬁve_ty≥
 = 
magic
 & 3;

45344 
is_ªje˘
 = 
magic
 & 4;

45345 
BOOL
 
ÆªadyCÆÀd
 = 
	`JS_ToBoﬁ
(
˘x
, 
func_d©a
[0]);

45346 
JSVÆueC⁄°
 
vÆues
 = 
func_d©a
[2];

45347 
JSVÆueC⁄°
 
ªsﬁve
 = 
func_d©a
[3];

45348 
JSVÆueC⁄°
 
ªsﬁve_ñemít_ív
 = 
func_d©a
[4];

45349 
JSVÆue
 
ªt
, 
obj
;

45350 
is_zîo
, 
ödex
;

45352 i‡(
	`JS_ToI¡32
(
˘x
, &
ödex
, 
func_d©a
[1]))

45353  
JS_EXCEPTION
;

45354 i‡(
ÆªadyCÆÀd
)

45355  
JS_UNDEFINED
;

45356 
func_d©a
[0] = 
	`JS_NewBoﬁ
(
˘x
, 
TRUE
);

45358 i‡(
ªsﬁve_ty≥
 =
PROMISE_MAGIC_ÆlSëéed
) {

45359 
JSVÆue
 
°r
;

45361 
obj
 = 
	`JS_NewObje˘
(
˘x
);

45362 i‡(
	`JS_IsEx˚±i⁄
(
obj
))

45363  
JS_EXCEPTION
;

45364 
°r
 = 
	`JS_NewSåög
(
˘x
, 
is_ªje˘
 ? "rejected" : "fulfilled");

45365 i‡(
	`JS_IsEx˚±i⁄
(
°r
))

45366 
Áû1
;

45367 i‡(
	`JS_DeföePr›îtyVÆue
(
˘x
, 
obj
, 
JS_ATOM_°©us
,

45368 
°r
,

45369 
JS_PROP_C_W_E
) < 0)

45370 
Áû1
;

45371 i‡(
	`JS_DeföePr›îtyVÆue
(
˘x
, 
obj
,

45372 
is_ªje˘
 ? 
JS_ATOM_ªas⁄
 : 
JS_ATOM_vÆue
,

45373 
	`JS_DupVÆue
(
˘x
, 
¨gv
[0]),

45374 
JS_PROP_C_W_E
) < 0) {

45375 
Áû1
:

45376 
	`JS_FªeVÆue
(
˘x
, 
obj
);

45377  
JS_EXCEPTION
;

45380 
obj
 = 
	`JS_DupVÆue
(
˘x
, 
¨gv
[0]);

45382 i‡(
	`JS_DeföePr›îtyVÆueUöt32
(
˘x
, 
vÆues
, 
ödex
,

45383 
obj
, 
JS_PROP_C_W_E
) < 0)

45384  
JS_EXCEPTION
;

45386 
is_zîo
 = 
	`ªmaöögEÀmítsCou¡_add
(
˘x
, 
ªsﬁve_ñemít_ív
, -1);

45387 i‡(
is_zîo
 < 0)

45388  
JS_EXCEPTION
;

45389 i‡(
is_zîo
) {

45390 i‡(
ªsﬁve_ty≥
 =
PROMISE_MAGIC_™y
) {

45391 
JSVÆue
 
îr‹
;

45392 
îr‹
 = 
	`js_aggªg©e_îr‹_c⁄°ru˘‹
(
˘x
, 
vÆues
);

45393 i‡(
	`JS_IsEx˚±i⁄
(
îr‹
))

45394  
JS_EXCEPTION
;

45395 
ªt
 = 
	`JS_CÆl
(
˘x
, 
ªsﬁve
, 
JS_UNDEFINED
, 1, (
JSVÆueC⁄°
 *)&
îr‹
);

45396 
	`JS_FªeVÆue
(
˘x
, 
îr‹
);

45398 
ªt
 = 
	`JS_CÆl
(
˘x
, 
ªsﬁve
, 
JS_UNDEFINED
, 1, (
JSVÆueC⁄°
 *)&
vÆues
);

45400 i‡(
	`JS_IsEx˚±i⁄
(
ªt
))

45401  
ªt
;

45402 
	`JS_FªeVÆue
(
˘x
, 
ªt
);

45404  
JS_UNDEFINED
;

45405 
	}
}

45408 
JSVÆue
 
	$js_¥omi£_Æl
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

45409 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
, 
magic
)

45411 
JSVÆue
 
ªsu…_¥omi£
, 
ªsﬁvög_funcs
[2], 
ôî
, 
ôem
, 
√xt_¥omi£
, 
ªt
;

45412 
JSVÆue
 
√xt_mëhod
 = 
JS_UNDEFINED
, 
vÆues
 = JS_UNDEFINED;

45413 
JSVÆue
 
ªsﬁve_ñemít_ív
 = 
JS_UNDEFINED
, 
ªsﬁve_ñemít
, 
ªje˘_ñemít
;

45414 
JSVÆue
 
¥omi£_ªsﬁve
 = 
JS_UNDEFINED
;

45415 
JSVÆueC⁄°
 
thí_¨gs
[2], 
ªsﬁve_ñemít_d©a
[5];

45416 
BOOL
 
d⁄e
;

45417 
ödex
, 
is_zîo
, 
is_¥omi£_™y
 = (
magic
 =
PROMISE_MAGIC_™y
);

45419 i‡(!
	`JS_IsObje˘
(
this_vÆ
))

45420  
	`JS_ThrowTy≥Eº‹NŸAnObje˘
(
˘x
);

45421 
ªsu…_¥omi£
 = 
	`js_√w_¥omi£_ˇ∑bûôy
(
˘x
, 
ªsﬁvög_funcs
, 
this_vÆ
);

45422 i‡(
	`JS_IsEx˚±i⁄
(
ªsu…_¥omi£
))

45423  
ªsu…_¥omi£
;

45424 
ôî
 = 
	`JS_GëIãøt‹
(
˘x
, 
¨gv
[0], 
FALSE
);

45425 i‡(
	`JS_IsEx˚±i⁄
(
ôî
)) {

45426 
JSVÆue
 
îr‹
;

45427 
Áû_ªje˘
:

45428 
îr‹
 = 
	`JS_GëEx˚±i⁄
(
˘x
);

45429 
ªt
 = 
	`JS_CÆl
(
˘x
, 
ªsﬁvög_funcs
[1], 
JS_UNDEFINED
, 1,

45430 (
JSVÆueC⁄°
 *)&
îr‹
);

45431 
	`JS_FªeVÆue
(
˘x
, 
îr‹
);

45432 i‡(
	`JS_IsEx˚±i⁄
(
ªt
))

45433 
Áû
;

45434 
	`JS_FªeVÆue
(
˘x
, 
ªt
);

45436 
√xt_mëhod
 = 
	`JS_GëPr›îty
(
˘x
, 
ôî
, 
JS_ATOM_√xt
);

45437 i‡(
	`JS_IsEx˚±i⁄
(
√xt_mëhod
))

45438 
Áû_ªje˘
;

45439 
vÆues
 = 
	`JS_NewAºay
(
˘x
);

45440 i‡(
	`JS_IsEx˚±i⁄
(
vÆues
))

45441 
Áû_ªje˘
;

45442 
ªsﬁve_ñemít_ív
 = 
	`JS_NewAºay
(
˘x
);

45443 i‡(
	`JS_IsEx˚±i⁄
(
ªsﬁve_ñemít_ív
))

45444 
Áû_ªje˘
;

45446 i‡(
	`JS_DeföePr›îtyVÆueUöt32
(
˘x
, 
ªsﬁve_ñemít_ív
, 0,

45447 
	`JS_NewI¡32
(
˘x
, 1),

45448 
JS_PROP_CONFIGURABLE
 | 
JS_PROP_ENUMERABLE
 | 
JS_PROP_WRITABLE
) < 0)

45449 
Áû_ªje˘
;

45451 
¥omi£_ªsﬁve
 = 
	`JS_GëPr›îty
(
˘x
, 
this_vÆ
, 
JS_ATOM_ªsﬁve
);

45452 i‡(
	`JS_IsEx˚±i⁄
(
¥omi£_ªsﬁve
) ||

45453 
	`check_fun˘i⁄
(
˘x
, 
¥omi£_ªsﬁve
))

45454 
Áû_ªje˘1
;

45456 
ödex
 = 0;

45460 
ôem
 = 
	`JS_Iãøt‹Next
(
˘x
, 
ôî
, 
√xt_mëhod
, 0, 
NULL
, &
d⁄e
);

45461 i‡(
	`JS_IsEx˚±i⁄
(
ôem
))

45462 
Áû_ªje˘
;

45463 i‡(
d⁄e
)

45465 
√xt_¥omi£
 = 
	`JS_CÆl
(
˘x
, 
¥omi£_ªsﬁve
,

45466 
this_vÆ
, 1, (
JSVÆueC⁄°
 *)&
ôem
);

45467 
	`JS_FªeVÆue
(
˘x
, 
ôem
);

45468 i‡(
	`JS_IsEx˚±i⁄
(
√xt_¥omi£
)) {

45469 
Áû_ªje˘1
:

45470 
	`JS_Iãøt‹Clo£
(
˘x
, 
ôî
, 
TRUE
);

45471 
Áû_ªje˘
;

45473 
ªsﬁve_ñemít_d©a
[0] = 
	`JS_NewBoﬁ
(
˘x
, 
FALSE
);

45474 
ªsﬁve_ñemít_d©a
[1] = (
JSVÆueC⁄°
)
	`JS_NewI¡32
(
˘x
, 
ödex
);

45475 
ªsﬁve_ñemít_d©a
[2] = 
vÆues
;

45476 
ªsﬁve_ñemít_d©a
[3] = 
ªsﬁvög_funcs
[
is_¥omi£_™y
];

45477 
ªsﬁve_ñemít_d©a
[4] = 
ªsﬁve_ñemít_ív
;

45478 
ªsﬁve_ñemít
 =

45479 
	`JS_NewCFun˘i⁄D©a
(
˘x
, 
js_¥omi£_Æl_ªsﬁve_ñemít
, 1,

45480 
magic
, 5, 
ªsﬁve_ñemít_d©a
);

45481 i‡(
	`JS_IsEx˚±i⁄
(
ªsﬁve_ñemít
)) {

45482 
	`JS_FªeVÆue
(
˘x
, 
√xt_¥omi£
);

45483 
Áû_ªje˘1
;

45486 i‡(
magic
 =
PROMISE_MAGIC_ÆlSëéed
) {

45487 
ªje˘_ñemít
 =

45488 
	`JS_NewCFun˘i⁄D©a
(
˘x
, 
js_¥omi£_Æl_ªsﬁve_ñemít
, 1,

45489 
magic
 | 4, 5, 
ªsﬁve_ñemít_d©a
);

45490 i‡(
	`JS_IsEx˚±i⁄
(
ªje˘_ñemít
)) {

45491 
	`JS_FªeVÆue
(
˘x
, 
√xt_¥omi£
);

45492 
Áû_ªje˘1
;

45494 } i‡(
magic
 =
PROMISE_MAGIC_™y
) {

45495 i‡(
	`JS_DeföePr›îtyVÆueUöt32
(
˘x
, 
vÆues
, 
ödex
,

45496 
JS_UNDEFINED
, 
JS_PROP_C_W_E
) < 0)

45497 
Áû_ªje˘1
;

45498 
ªje˘_ñemít
 = 
ªsﬁve_ñemít
;

45499 
ªsﬁve_ñemít
 = 
	`JS_DupVÆue
(
˘x
, 
ªsﬁvög_funcs
[0]);

45501 
ªje˘_ñemít
 = 
	`JS_DupVÆue
(
˘x
, 
ªsﬁvög_funcs
[1]);

45504 i‡(
	`ªmaöögEÀmítsCou¡_add
(
˘x
, 
ªsﬁve_ñemít_ív
, 1) < 0) {

45505 
	`JS_FªeVÆue
(
˘x
, 
√xt_¥omi£
);

45506 
	`JS_FªeVÆue
(
˘x
, 
ªsﬁve_ñemít
);

45507 
	`JS_FªeVÆue
(
˘x
, 
ªje˘_ñemít
);

45508 
Áû_ªje˘1
;

45511 
thí_¨gs
[0] = 
ªsﬁve_ñemít
;

45512 
thí_¨gs
[1] = 
ªje˘_ñemít
;

45513 
ªt
 = 
	`JS_InvokeFªe
(
˘x
, 
√xt_¥omi£
, 
JS_ATOM_thí
, 2, 
thí_¨gs
);

45514 
	`JS_FªeVÆue
(
˘x
, 
ªsﬁve_ñemít
);

45515 
	`JS_FªeVÆue
(
˘x
, 
ªje˘_ñemít
);

45516 i‡(
	`check_ex˚±i⁄_‰ì
(
˘x
, 
ªt
))

45517 
Áû_ªje˘1
;

45518 
ödex
++;

45521 
is_zîo
 = 
	`ªmaöögEÀmítsCou¡_add
(
˘x
, 
ªsﬁve_ñemít_ív
, -1);

45522 i‡(
is_zîo
 < 0)

45523 
Áû_ªje˘
;

45524 i‡(
is_zîo
) {

45525 i‡(
magic
 =
PROMISE_MAGIC_™y
) {

45526 
JSVÆue
 
îr‹
;

45527 
îr‹
 = 
	`js_aggªg©e_îr‹_c⁄°ru˘‹
(
˘x
, 
vÆues
);

45528 i‡(
	`JS_IsEx˚±i⁄
(
îr‹
))

45529 
Áû_ªje˘
;

45530 
	`JS_FªeVÆue
(
˘x
, 
vÆues
);

45531 
vÆues
 = 
îr‹
;

45533 
ªt
 = 
	`JS_CÆl
(
˘x
, 
ªsﬁvög_funcs
[
is_¥omi£_™y
], 
JS_UNDEFINED
,

45534 1, (
JSVÆueC⁄°
 *)&
vÆues
);

45535 i‡(
	`check_ex˚±i⁄_‰ì
(
˘x
, 
ªt
))

45536 
Áû_ªje˘
;

45539 
d⁄e
:

45540 
	`JS_FªeVÆue
(
˘x
, 
¥omi£_ªsﬁve
);

45541 
	`JS_FªeVÆue
(
˘x
, 
ªsﬁve_ñemít_ív
);

45542 
	`JS_FªeVÆue
(
˘x
, 
vÆues
);

45543 
	`JS_FªeVÆue
(
˘x
, 
√xt_mëhod
);

45544 
	`JS_FªeVÆue
(
˘x
, 
ôî
);

45545 
	`JS_FªeVÆue
(
˘x
, 
ªsﬁvög_funcs
[0]);

45546 
	`JS_FªeVÆue
(
˘x
, 
ªsﬁvög_funcs
[1]);

45547  
ªsu…_¥omi£
;

45548 
Áû
:

45549 
	`JS_FªeVÆue
(
˘x
, 
ªsu…_¥omi£
);

45550 
ªsu…_¥omi£
 = 
JS_EXCEPTION
;

45551 
d⁄e
;

45552 
	}
}

45554 
JSVÆue
 
	$js_¥omi£_ø˚
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

45555 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

45557 
JSVÆue
 
ªsu…_¥omi£
, 
ªsﬁvög_funcs
[2], 
ôî
, 
ôem
, 
√xt_¥omi£
, 
ªt
;

45558 
JSVÆue
 
√xt_mëhod
 = 
JS_UNDEFINED
;

45559 
JSVÆue
 
¥omi£_ªsﬁve
 = 
JS_UNDEFINED
;

45560 
BOOL
 
d⁄e
;

45562 i‡(!
	`JS_IsObje˘
(
this_vÆ
))

45563  
	`JS_ThrowTy≥Eº‹NŸAnObje˘
(
˘x
);

45564 
ªsu…_¥omi£
 = 
	`js_√w_¥omi£_ˇ∑bûôy
(
˘x
, 
ªsﬁvög_funcs
, 
this_vÆ
);

45565 i‡(
	`JS_IsEx˚±i⁄
(
ªsu…_¥omi£
))

45566  
ªsu…_¥omi£
;

45567 
ôî
 = 
	`JS_GëIãøt‹
(
˘x
, 
¨gv
[0], 
FALSE
);

45568 i‡(
	`JS_IsEx˚±i⁄
(
ôî
)) {

45569 
JSVÆue
 
îr‹
;

45570 
Áû_ªje˘
:

45571 
îr‹
 = 
	`JS_GëEx˚±i⁄
(
˘x
);

45572 
ªt
 = 
	`JS_CÆl
(
˘x
, 
ªsﬁvög_funcs
[1], 
JS_UNDEFINED
, 1,

45573 (
JSVÆueC⁄°
 *)&
îr‹
);

45574 
	`JS_FªeVÆue
(
˘x
, 
îr‹
);

45575 i‡(
	`JS_IsEx˚±i⁄
(
ªt
))

45576 
Áû
;

45577 
	`JS_FªeVÆue
(
˘x
, 
ªt
);

45579 
√xt_mëhod
 = 
	`JS_GëPr›îty
(
˘x
, 
ôî
, 
JS_ATOM_√xt
);

45580 i‡(
	`JS_IsEx˚±i⁄
(
√xt_mëhod
))

45581 
Áû_ªje˘
;

45583 
¥omi£_ªsﬁve
 = 
	`JS_GëPr›îty
(
˘x
, 
this_vÆ
, 
JS_ATOM_ªsﬁve
);

45584 i‡(
	`JS_IsEx˚±i⁄
(
¥omi£_ªsﬁve
) ||

45585 
	`check_fun˘i⁄
(
˘x
, 
¥omi£_ªsﬁve
))

45586 
Áû_ªje˘1
;

45591 
ôem
 = 
	`JS_Iãøt‹Next
(
˘x
, 
ôî
, 
√xt_mëhod
, 0, 
NULL
, &
d⁄e
);

45592 i‡(
	`JS_IsEx˚±i⁄
(
ôem
))

45593 
Áû_ªje˘
;

45594 i‡(
d⁄e
)

45596 
√xt_¥omi£
 = 
	`JS_CÆl
(
˘x
, 
¥omi£_ªsﬁve
,

45597 
this_vÆ
, 1, (
JSVÆueC⁄°
 *)&
ôem
);

45598 
	`JS_FªeVÆue
(
˘x
, 
ôem
);

45599 i‡(
	`JS_IsEx˚±i⁄
(
√xt_¥omi£
)) {

45600 
Áû_ªje˘1
:

45601 
	`JS_Iãøt‹Clo£
(
˘x
, 
ôî
, 
TRUE
);

45602 
Áû_ªje˘
;

45604 
ªt
 = 
	`JS_InvokeFªe
(
˘x
, 
√xt_¥omi£
, 
JS_ATOM_thí
, 2,

45605 (
JSVÆueC⁄°
 *)
ªsﬁvög_funcs
);

45606 i‡(
	`check_ex˚±i⁄_‰ì
(
˘x
, 
ªt
))

45607 
Áû_ªje˘1
;

45610 
d⁄e
:

45611 
	`JS_FªeVÆue
(
˘x
, 
¥omi£_ªsﬁve
);

45612 
	`JS_FªeVÆue
(
˘x
, 
√xt_mëhod
);

45613 
	`JS_FªeVÆue
(
˘x
, 
ôî
);

45614 
	`JS_FªeVÆue
(
˘x
, 
ªsﬁvög_funcs
[0]);

45615 
	`JS_FªeVÆue
(
˘x
, 
ªsﬁvög_funcs
[1]);

45616  
ªsu…_¥omi£
;

45617 
Áû
:

45619 
	`JS_FªeVÆue
(
˘x
, 
ªsu…_¥omi£
);

45620 
ªsu…_¥omi£
 = 
JS_EXCEPTION
;

45621 
d⁄e
;

45622 
	}
}

45624 
__ex˚±i⁄
 
	$≥rf‹m_¥omi£_thí
(
JSC⁄ãxt
 *
˘x
,

45625 
JSVÆueC⁄°
 
¥omi£
,

45626 
JSVÆueC⁄°
 *
ªsﬁve_ªje˘
,

45627 
JSVÆueC⁄°
 *
ˇp_ªsﬁvög_funcs
)

45629 
JSPromi£D©a
 *
s
 = 
	`JS_GëO∑que
(
¥omi£
, 
JS_CLASS_PROMISE
);

45630 
JSPromi£Ró˘i⁄D©a
 *
rd_¨øy
[2], *
rd
;

45631 
i
, 
j
;

45633 
rd_¨øy
[0] = 
NULL
;

45634 
rd_¨øy
[1] = 
NULL
;

45635 
i
 = 0; i < 2; i++) {

45636 
JSVÆueC⁄°
 
h™dÀr
;

45637 
rd
 = 
	`js_mÆlocz
(
˘x
, (*rd));

45638 i‡(!
rd
) {

45639 i‡(
i
 == 1)

45640 
	`¥omi£_ªa˘i⁄_d©a_‰ì
(
˘x
->
π
, 
rd_¨øy
[0]);

45643 
j
 = 0; j < 2; j++)

45644 
rd
->
ªsﬁvög_funcs
[
j
] = 
	`JS_DupVÆue
(
˘x
, 
ˇp_ªsﬁvög_funcs
[j]);

45645 
h™dÀr
 = 
ªsﬁve_ªje˘
[
i
];

45646 i‡(!
	`JS_IsFun˘i⁄
(
˘x
, 
h™dÀr
))

45647 
h™dÀr
 = 
JS_UNDEFINED
;

45648 
rd
->
h™dÀr
 = 
	`JS_DupVÆue
(
˘x
, handler);

45649 
rd_¨øy
[
i
] = 
rd
;

45652 i‡(
s
->
¥omi£_°©e
 =
JS_PROMISE_PENDING
) {

45653 
i
 = 0; i < 2; i++)

45654 
	`li°_add_èû
(&
rd_¨øy
[
i
]->
lök
, &
s
->
¥omi£_ªa˘i⁄s
[i]);

45656 
JSVÆueC⁄°
 
¨gs
[5];

45657 i‡(
s
->
¥omi£_°©e
 =
JS_PROMISE_REJECTED
 && !s->
is_h™dÀd
) {

45658 
JSRu¡ime
 *
π
 = 
˘x
->rt;

45659 i‡(
π
->
ho°_¥omi£_ªje˘i⁄_åackî
) {

45660 
π
->
	`ho°_¥omi£_ªje˘i⁄_åackî
(
˘x
, 
¥omi£
, 
s
->
¥omi£_ªsu…
,

45661 
TRUE
, 
π
->
ho°_¥omi£_ªje˘i⁄_åackî_›aque
);

45664 
i
 = 
s
->
¥omi£_°©e
 - 
JS_PROMISE_FULFILLED
;

45665 
rd
 = 
rd_¨øy
[
i
];

45666 
¨gs
[0] = 
rd
->
ªsﬁvög_funcs
[0];

45667 
¨gs
[1] = 
rd
->
ªsﬁvög_funcs
[1];

45668 
¨gs
[2] = 
rd
->
h™dÀr
;

45669 
¨gs
[3] = 
	`JS_NewBoﬁ
(
˘x
, 
i
);

45670 
¨gs
[4] = 
s
->
¥omi£_ªsu…
;

45671 
	`JS_EnqueueJob
(
˘x
, 
¥omi£_ªa˘i⁄_job
, 5, 
¨gs
);

45672 
i
 = 0; i < 2; i++)

45673 
	`¥omi£_ªa˘i⁄_d©a_‰ì
(
˘x
->
π
, 
rd_¨øy
[
i
]);

45675 
s
->
is_h™dÀd
 = 
TRUE
;

45677 
	}
}

45679 
JSVÆue
 
	$js_¥omi£_thí
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

45680 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

45682 
JSVÆue
 
˘‹
, 
ªsu…_¥omi£
, 
ªsﬁvög_funcs
[2];

45683 
JSPromi£D©a
 *
s
;

45684 
i
, 
ªt
;

45686 
s
 = 
	`JS_GëO∑que2
(
˘x
, 
this_vÆ
, 
JS_CLASS_PROMISE
);

45687 i‡(!
s
)

45688  
JS_EXCEPTION
;

45690 
˘‹
 = 
	`JS_S≥cõsC⁄°ru˘‹
(
˘x
, 
this_vÆ
, 
JS_UNDEFINED
);

45691 i‡(
	`JS_IsEx˚±i⁄
(
˘‹
))

45692  
˘‹
;

45693 
ªsu…_¥omi£
 = 
	`js_√w_¥omi£_ˇ∑bûôy
(
˘x
, 
ªsﬁvög_funcs
, 
˘‹
);

45694 
	`JS_FªeVÆue
(
˘x
, 
˘‹
);

45695 i‡(
	`JS_IsEx˚±i⁄
(
ªsu…_¥omi£
))

45696  
ªsu…_¥omi£
;

45697 
ªt
 = 
	`≥rf‹m_¥omi£_thí
(
˘x
, 
this_vÆ
, 
¨gv
,

45698 (
JSVÆueC⁄°
 *)
ªsﬁvög_funcs
);

45699 
i
 = 0; i < 2; i++)

45700 
	`JS_FªeVÆue
(
˘x
, 
ªsﬁvög_funcs
[
i
]);

45701 i‡(
ªt
) {

45702 
	`JS_FªeVÆue
(
˘x
, 
ªsu…_¥omi£
);

45703  
JS_EXCEPTION
;

45705  
ªsu…_¥omi£
;

45706 
	}
}

45708 
JSVÆue
 
	$js_¥omi£_ˇtch
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

45709 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

45711 
JSVÆueC⁄°
 
¨gs
[2];

45712 
¨gs
[0] = 
JS_UNDEFINED
;

45713 
¨gs
[1] = 
¨gv
[0];

45714  
	`JS_Invoke
(
˘x
, 
this_vÆ
, 
JS_ATOM_thí
, 2, 
¨gs
);

45715 
	}
}

45717 
JSVÆue
 
	$js_¥omi£_föÆly_vÆue_thunk
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

45718 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
,

45719 
magic
, 
JSVÆue
 *
func_d©a
)

45721  
	`JS_DupVÆue
(
˘x
, 
func_d©a
[0]);

45722 
	}
}

45724 
JSVÆue
 
	$js_¥omi£_föÆly_throwî
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

45725 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
,

45726 
magic
, 
JSVÆue
 *
func_d©a
)

45728  
	`JS_Throw
(
˘x
, 
	`JS_DupVÆue
(˘x, 
func_d©a
[0]));

45729 
	}
}

45731 
JSVÆue
 
	$js_¥omi£_thí_föÆly_func
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

45732 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
,

45733 
magic
, 
JSVÆue
 *
func_d©a
)

45735 
JSVÆueC⁄°
 
˘‹
 = 
func_d©a
[0];

45736 
JSVÆueC⁄°
 
⁄FöÆly
 = 
func_d©a
[1];

45737 
JSVÆue
 
ªs
, 
¥omi£
, 
ªsﬁvög_funcs
[2], 
ªt
, 
thí_func
;

45739 
ªs
 = 
	`JS_CÆl
(
˘x
, 
⁄FöÆly
, 
JS_UNDEFINED
, 0, 
NULL
);

45740 i‡(
	`JS_IsEx˚±i⁄
(
ªs
))

45741  
ªs
;

45742 
¥omi£
 = 
	`js_√w_¥omi£_ˇ∑bûôy
(
˘x
, 
ªsﬁvög_funcs
, 
˘‹
);

45743 i‡(
	`JS_IsEx˚±i⁄
(
¥omi£
)) {

45744 
	`JS_FªeVÆue
(
˘x
, 
ªs
);

45745  
JS_EXCEPTION
;

45747 
ªt
 = 
	`JS_CÆl
(
˘x
, 
ªsﬁvög_funcs
[0], 
JS_UNDEFINED
,

45748 1, (
JSVÆueC⁄°
*)&
ªs
);

45749 
	`JS_FªeVÆue
(
˘x
, 
ªs
);

45750 
	`JS_FªeVÆue
(
˘x
, 
ªsﬁvög_funcs
[0]);

45751 
	`JS_FªeVÆue
(
˘x
, 
ªsﬁvög_funcs
[1]);

45752 i‡(
	`JS_IsEx˚±i⁄
(
ªt
)) {

45753 
	`JS_FªeVÆue
(
˘x
, 
¥omi£
);

45754  
ªt
;

45756 
	`JS_FªeVÆue
(
˘x
, 
ªt
);

45757 i‡(
magic
 == 0) {

45758 
thí_func
 = 
	`JS_NewCFun˘i⁄D©a
(
˘x
, 
js_¥omi£_föÆly_vÆue_thunk
, 0,

45759 0, 1, 
¨gv
);

45761 
thí_func
 = 
	`JS_NewCFun˘i⁄D©a
(
˘x
, 
js_¥omi£_föÆly_throwî
, 0,

45762 0, 1, 
¨gv
);

45764 i‡(
	`JS_IsEx˚±i⁄
(
thí_func
)) {

45765 
	`JS_FªeVÆue
(
˘x
, 
¥omi£
);

45766  
thí_func
;

45768 
ªt
 = 
	`JS_InvokeFªe
(
˘x
, 
¥omi£
, 
JS_ATOM_thí
, 1, (
JSVÆueC⁄°
 *)&
thí_func
);

45769 
	`JS_FªeVÆue
(
˘x
, 
thí_func
);

45770  
ªt
;

45771 
	}
}

45773 
JSVÆue
 
	$js_¥omi£_föÆly
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

45774 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

45776 
JSVÆueC⁄°
 
⁄FöÆly
 = 
¨gv
[0];

45777 
JSVÆue
 
˘‹
, 
ªt
;

45778 
JSVÆue
 
thí_funcs
[2];

45779 
JSVÆueC⁄°
 
func_d©a
[2];

45780 
i
;

45782 
˘‹
 = 
	`JS_S≥cõsC⁄°ru˘‹
(
˘x
, 
this_vÆ
, 
JS_UNDEFINED
);

45783 i‡(
	`JS_IsEx˚±i⁄
(
˘‹
))

45784  
˘‹
;

45785 i‡(!
	`JS_IsFun˘i⁄
(
˘x
, 
⁄FöÆly
)) {

45786 
thí_funcs
[0] = 
	`JS_DupVÆue
(
˘x
, 
⁄FöÆly
);

45787 
thí_funcs
[1] = 
	`JS_DupVÆue
(
˘x
, 
⁄FöÆly
);

45789 
func_d©a
[0] = 
˘‹
;

45790 
func_d©a
[1] = 
⁄FöÆly
;

45791 
i
 = 0; i < 2; i++) {

45792 
thí_funcs
[
i
] = 
	`JS_NewCFun˘i⁄D©a
(
˘x
, 
js_¥omi£_thí_föÆly_func
, 1, i, 2, 
func_d©a
);

45793 i‡(
	`JS_IsEx˚±i⁄
(
thí_funcs
[
i
])) {

45794 i‡(
i
 == 1)

45795 
	`JS_FªeVÆue
(
˘x
, 
thí_funcs
[0]);

45796 
	`JS_FªeVÆue
(
˘x
, 
˘‹
);

45797  
JS_EXCEPTION
;

45801 
	`JS_FªeVÆue
(
˘x
, 
˘‹
);

45802 
ªt
 = 
	`JS_Invoke
(
˘x
, 
this_vÆ
, 
JS_ATOM_thí
, 2, (
JSVÆueC⁄°
 *)
thí_funcs
);

45803 
	`JS_FªeVÆue
(
˘x
, 
thí_funcs
[0]);

45804 
	`JS_FªeVÆue
(
˘x
, 
thí_funcs
[1]);

45805  
ªt
;

45806 
	}
}

45808 c⁄° 
JSCFun˘i⁄Li°E¡ry
 
	gjs_¥omi£_funcs
[] = {

45809 
JS_CFUNC_MAGIC_DEF
("ªsﬁve", 1, 
js_¥omi£_ªsﬁve
, 0 ),

45810 
JS_CFUNC_MAGIC_DEF
("ªje˘", 1, 
js_¥omi£_ªsﬁve
, 1 ),

45811 
JS_CFUNC_MAGIC_DEF
("Æl", 1, 
js_¥omi£_Æl
, 
PROMISE_MAGIC_Æl
 ),

45812 
JS_CFUNC_MAGIC_DEF
("ÆlSëéed", 1, 
js_¥omi£_Æl
, 
PROMISE_MAGIC_ÆlSëéed
 ),

45813 
JS_CFUNC_MAGIC_DEF
("™y", 1, 
js_¥omi£_Æl
, 
PROMISE_MAGIC_™y
 ),

45814 
JS_CFUNC_DEF
("ø˚", 1, 
js_¥omi£_ø˚
 ),

45816 
JS_CGETSET_DEF
("[Symbﬁ.•ecõs]", 
js_gë_this
, 
NULL
),

45819 c⁄° 
JSCFun˘i⁄Li°E¡ry
 
	gjs_¥omi£_¥Ÿo_funcs
[] = {

45820 
JS_CFUNC_DEF
("thí", 2, 
js_¥omi£_thí
 ),

45821 
JS_CFUNC_DEF
("ˇtch", 1, 
js_¥omi£_ˇtch
 ),

45822 
JS_CFUNC_DEF
("föÆly", 1, 
js_¥omi£_föÆly
 ),

45823 
JS_PROP_STRING_DEF
("[Symbﬁ.toSåögTag]", "Promi£", 
JS_PROP_CONFIGURABLE
 ),

45827 c⁄° 
JSCFun˘i⁄Li°E¡ry
 
	gjs_async_fun˘i⁄_¥Ÿo_funcs
[] = {

45828 
JS_PROP_STRING_DEF
("[Symbﬁ.toSåögTag]", "AsyncFun˘i⁄", 
JS_PROP_CONFIGURABLE
 ),

45831 
JSVÆue
 
	$js_async_‰om_sync_ôî©‹_unwøp
(
JSC⁄ãxt
 *
˘x
,

45832 
JSVÆueC⁄°
 
this_vÆ
,

45833 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
,

45834 
magic
, 
JSVÆue
 *
func_d©a
)

45836  
	`js_¸óã_ôî©‹_ªsu…
(
˘x
, 
	`JS_DupVÆue
(˘x, 
¨gv
[0]),

45837 
	`JS_ToBoﬁ
(
˘x
, 
func_d©a
[0]));

45838 
	}
}

45840 
JSVÆue
 
	$js_async_‰om_sync_ôî©‹_unwøp_func_¸óã
(
JSC⁄ãxt
 *
˘x
,

45841 
BOOL
 
d⁄e
)

45843 
JSVÆueC⁄°
 
func_d©a
[1];

45845 
func_d©a
[0] = (
JSVÆueC⁄°
)
	`JS_NewBoﬁ
(
˘x
, 
d⁄e
);

45846  
	`JS_NewCFun˘i⁄D©a
(
˘x
, 
js_async_‰om_sync_ôî©‹_unwøp
,

45847 1, 0, 1, 
func_d©a
);

45848 
	}
}

45852 c⁄° 
JSCFun˘i⁄Li°E¡ry
 
	gjs_async_ôî©‹_¥Ÿo_funcs
[] = {

45853 
JS_CFUNC_DEF
("[Symbﬁ.asyncIãøt‹]", 0, 
js_ôî©‹_¥Ÿo_ôî©‹
 ),

45858 
	sJSAsyncFromSyncIãøt‹D©a
 {

45859 
JSVÆue
 
	msync_ôî
;

45860 
JSVÆue
 
	m√xt_mëhod
;

45861 } 
	tJSAsyncFromSyncIãøt‹D©a
;

45863 
	$js_async_‰om_sync_ôî©‹_föÆizî
(
JSRu¡ime
 *
π
, 
JSVÆue
 
vÆ
)

45865 
JSAsyncFromSyncIãøt‹D©a
 *
s
 =

45866 
	`JS_GëO∑que
(
vÆ
, 
JS_CLASS_ASYNC_FROM_SYNC_ITERATOR
);

45867 i‡(
s
) {

45868 
	`JS_FªeVÆueRT
(
π
, 
s
->
sync_ôî
);

45869 
	`JS_FªeVÆueRT
(
π
, 
s
->
√xt_mëhod
);

45870 
	`js_‰ì_π
(
π
, 
s
);

45872 
	}
}

45874 
	$js_async_‰om_sync_ôî©‹_m¨k
(
JSRu¡ime
 *
π
, 
JSVÆueC⁄°
 
vÆ
,

45875 
JS_M¨kFunc
 *
m¨k_func
)

45877 
JSAsyncFromSyncIãøt‹D©a
 *
s
 =

45878 
	`JS_GëO∑que
(
vÆ
, 
JS_CLASS_ASYNC_FROM_SYNC_ITERATOR
);

45879 i‡(
s
) {

45880 
	`JS_M¨kVÆue
(
π
, 
s
->
sync_ôî
, 
m¨k_func
);

45881 
	`JS_M¨kVÆue
(
π
, 
s
->
√xt_mëhod
, 
m¨k_func
);

45883 
	}
}

45885 
JSVÆue
 
	$JS_Cª©eAsyncFromSyncIãøt‹
(
JSC⁄ãxt
 *
˘x
,

45886 
JSVÆueC⁄°
 
sync_ôî
)

45888 
JSVÆue
 
async_ôî
, 
√xt_mëhod
;

45889 
JSAsyncFromSyncIãøt‹D©a
 *
s
;

45891 
√xt_mëhod
 = 
	`JS_GëPr›îty
(
˘x
, 
sync_ôî
, 
JS_ATOM_√xt
);

45892 i‡(
	`JS_IsEx˚±i⁄
(
√xt_mëhod
))

45893  
JS_EXCEPTION
;

45894 
async_ôî
 = 
	`JS_NewObje˘Cœss
(
˘x
, 
JS_CLASS_ASYNC_FROM_SYNC_ITERATOR
);

45895 i‡(
	`JS_IsEx˚±i⁄
(
async_ôî
)) {

45896 
	`JS_FªeVÆue
(
˘x
, 
√xt_mëhod
);

45897  
async_ôî
;

45899 
s
 = 
	`js_mÆlocz
(
˘x
, (*s));

45900 i‡(!
s
) {

45901 
	`JS_FªeVÆue
(
˘x
, 
async_ôî
);

45902 
	`JS_FªeVÆue
(
˘x
, 
√xt_mëhod
);

45903  
JS_EXCEPTION
;

45905 
s
->
sync_ôî
 = 
	`JS_DupVÆue
(
˘x
, sync_iter);

45906 
s
->
√xt_mëhod
 =Çext_method;

45907 
	`JS_SëO∑que
(
async_ôî
, 
s
);

45908  
async_ôî
;

45909 
	}
}

45911 
JSVÆue
 
	$js_async_‰om_sync_ôî©‹_√xt
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

45912 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
,

45913 
magic
)

45915 
JSVÆue
 
¥omi£
, 
ªsﬁvög_funcs
[2], 
vÆue
, 
îr
, 
mëhod
;

45916 
JSAsyncFromSyncIãøt‹D©a
 *
s
;

45917 
d⁄e
;

45918 
is_ªje˘
;

45920 
¥omi£
 = 
	`JS_NewPromi£C≠abûôy
(
˘x
, 
ªsﬁvög_funcs
);

45921 i‡(
	`JS_IsEx˚±i⁄
(
¥omi£
))

45922  
JS_EXCEPTION
;

45923 
s
 = 
	`JS_GëO∑que
(
this_vÆ
, 
JS_CLASS_ASYNC_FROM_SYNC_ITERATOR
);

45924 i‡(!
s
) {

45925 
	`JS_ThrowTy≥Eº‹
(
˘x
, "notán Async-from-Sync Iterator");

45926 
ªje˘
;

45929 i‡(
magic
 =
GEN_MAGIC_NEXT
) {

45930 
mëhod
 = 
	`JS_DupVÆue
(
˘x
, 
s
->
√xt_mëhod
);

45932 
mëhod
 = 
	`JS_GëPr›îty
(
˘x
, 
s
->
sync_ôî
,

45933 
magic
 =
GEN_MAGIC_RETURN
 ? 
JS_ATOM_ªtu∫
 :

45934 
JS_ATOM_throw
);

45935 i‡(
	`JS_IsEx˚±i⁄
(
mëhod
))

45936 
ªje˘
;

45937 i‡(
	`JS_IsUndeföed
(
mëhod
Ë|| 
	`JS_IsNuŒ
(method)) {

45938 i‡(
magic
 =
GEN_MAGIC_RETURN
) {

45939 
îr
 = 
	`js_¸óã_ôî©‹_ªsu…
(
˘x
, 
	`JS_DupVÆue
(˘x, 
¨gv
[0]), 
TRUE
);

45940 
is_ªje˘
 = 0;

45942 
îr
 = 
	`JS_DupVÆue
(
˘x
, 
¨gv
[0]);

45943 
is_ªje˘
 = 1;

45945 
d⁄e_ªsﬁve
;

45948 
vÆue
 = 
	`JS_Iãøt‹Next2
(
˘x
, 
s
->
sync_ôî
, 
mëhod
,

45949 
¨gc
 >1 ? 1 : 0, 
¨gv
, &
d⁄e
);

45950 
	`JS_FªeVÆue
(
˘x
, 
mëhod
);

45951 i‡(
	`JS_IsEx˚±i⁄
(
vÆue
))

45952 
ªje˘
;

45953 i‡(
d⁄e
 == 2) {

45954 
JSVÆue
 
obj
 = 
vÆue
;

45955 
vÆue
 = 
	`JS_Iãøt‹GëCom∂ëeVÆue
(
˘x
, 
obj
, &
d⁄e
);

45956 
	`JS_FªeVÆue
(
˘x
, 
obj
);

45957 i‡(
	`JS_IsEx˚±i⁄
(
vÆue
))

45958 
ªje˘
;

45961 i‡(
	`JS_IsEx˚±i⁄
(
vÆue
)) {

45962 
JSVÆue
 
ªs2
;

45963 
ªje˘
:

45964 
îr
 = 
	`JS_GëEx˚±i⁄
(
˘x
);

45965 
is_ªje˘
 = 1;

45966 
d⁄e_ªsﬁve
:

45967 
ªs2
 = 
	`JS_CÆl
(
˘x
, 
ªsﬁvög_funcs
[
is_ªje˘
], 
JS_UNDEFINED
,

45968 1, (
JSVÆueC⁄°
 *)&
îr
);

45969 
	`JS_FªeVÆue
(
˘x
, 
îr
);

45970 
	`JS_FªeVÆue
(
˘x
, 
ªs2
);

45971 
	`JS_FªeVÆue
(
˘x
, 
ªsﬁvög_funcs
[0]);

45972 
	`JS_FªeVÆue
(
˘x
, 
ªsﬁvög_funcs
[1]);

45973  
¥omi£
;

45976 
JSVÆue
 
vÆue_wøµî_¥omi£
, 
ªsﬁve_ªje˘
[2];

45977 
ªs
;

45979 
vÆue_wøµî_¥omi£
 = 
	`js_¥omi£_ªsﬁve
(
˘x
, ctx->
¥omi£_˘‹
,

45980 1, (
JSVÆueC⁄°
 *)&
vÆue
, 0);

45981 i‡(
	`JS_IsEx˚±i⁄
(
vÆue_wøµî_¥omi£
)) {

45982 
	`JS_FªeVÆue
(
˘x
, 
vÆue
);

45983 
ªje˘
;

45986 
ªsﬁve_ªje˘
[0] =

45987 
	`js_async_‰om_sync_ôî©‹_unwøp_func_¸óã
(
˘x
, 
d⁄e
);

45988 i‡(
	`JS_IsEx˚±i⁄
(
ªsﬁve_ªje˘
[0])) {

45989 
	`JS_FªeVÆue
(
˘x
, 
vÆue_wøµî_¥omi£
);

45990 
Áû
;

45992 
	`JS_FªeVÆue
(
˘x
, 
vÆue
);

45993 
ªsﬁve_ªje˘
[1] = 
JS_UNDEFINED
;

45995 
ªs
 = 
	`≥rf‹m_¥omi£_thí
(
˘x
, 
vÆue_wøµî_¥omi£
,

45996 (
JSVÆueC⁄°
 *)
ªsﬁve_ªje˘
,

45997 (
JSVÆueC⁄°
 *)
ªsﬁvög_funcs
);

45998 
	`JS_FªeVÆue
(
˘x
, 
ªsﬁve_ªje˘
[0]);

45999 
	`JS_FªeVÆue
(
˘x
, 
vÆue_wøµî_¥omi£
);

46000 
	`JS_FªeVÆue
(
˘x
, 
ªsﬁvög_funcs
[0]);

46001 
	`JS_FªeVÆue
(
˘x
, 
ªsﬁvög_funcs
[1]);

46002 i‡(
ªs
) {

46003 
	`JS_FªeVÆue
(
˘x
, 
¥omi£
);

46004  
JS_EXCEPTION
;

46007  
¥omi£
;

46008 
Áû
:

46009 
	`JS_FªeVÆue
(
˘x
, 
vÆue
);

46010 
	`JS_FªeVÆue
(
˘x
, 
ªsﬁvög_funcs
[0]);

46011 
	`JS_FªeVÆue
(
˘x
, 
ªsﬁvög_funcs
[1]);

46012 
	`JS_FªeVÆue
(
˘x
, 
¥omi£
);

46013  
JS_EXCEPTION
;

46014 
	}
}

46016 c⁄° 
JSCFun˘i⁄Li°E¡ry
 
	gjs_async_‰om_sync_ôî©‹_¥Ÿo_funcs
[] = {

46017 
JS_CFUNC_MAGIC_DEF
("√xt", 1, 
js_async_‰om_sync_ôî©‹_√xt
, 
GEN_MAGIC_NEXT
 ),

46018 
JS_CFUNC_MAGIC_DEF
("ªtu∫", 1, 
js_async_‰om_sync_ôî©‹_√xt
, 
GEN_MAGIC_RETURN
 ),

46019 
JS_CFUNC_MAGIC_DEF
("throw", 1, 
js_async_‰om_sync_ôî©‹_√xt
, 
GEN_MAGIC_THROW
 ),

46024 c⁄° 
JSCFun˘i⁄Li°E¡ry
 
	gjs_async_gíî©‹_fun˘i⁄_¥Ÿo_funcs
[] = {

46025 
JS_PROP_STRING_DEF
("[Symbﬁ.toSåögTag]", "AsyncGíî©‹Fun˘i⁄", 
JS_PROP_CONFIGURABLE
 ),

46030 c⁄° 
JSCFun˘i⁄Li°E¡ry
 
	gjs_async_gíî©‹_¥Ÿo_funcs
[] = {

46031 
JS_CFUNC_MAGIC_DEF
("√xt", 1, 
js_async_gíî©‹_√xt
, 
GEN_MAGIC_NEXT
 ),

46032 
JS_CFUNC_MAGIC_DEF
("ªtu∫", 1, 
js_async_gíî©‹_√xt
, 
GEN_MAGIC_RETURN
 ),

46033 
JS_CFUNC_MAGIC_DEF
("throw", 1, 
js_async_gíî©‹_√xt
, 
GEN_MAGIC_THROW
 ),

46034 
JS_PROP_STRING_DEF
("[Symbﬁ.toSåögTag]", "AsyncGíî©‹", 
JS_PROP_CONFIGURABLE
 ),

46037 
JSCœssSh‹tDef
 c⁄° 
	gjs_async_˛ass_def
[] = {

46038 { 
JS_ATOM_Promi£
, 
js_¥omi£_föÆizî
, 
js_¥omi£_m¨k
 },

46039 { 
JS_ATOM_Promi£ResﬁveFun˘i⁄
, 
js_¥omi£_ªsﬁve_fun˘i⁄_föÆizî
, 
js_¥omi£_ªsﬁve_fun˘i⁄_m¨k
 },

46040 { 
JS_ATOM_Promi£Reje˘Fun˘i⁄
, 
js_¥omi£_ªsﬁve_fun˘i⁄_föÆizî
, 
js_¥omi£_ªsﬁve_fun˘i⁄_m¨k
 },

46041 { 
JS_ATOM_AsyncFun˘i⁄
, 
js_byãcode_fun˘i⁄_föÆizî
, 
js_byãcode_fun˘i⁄_m¨k
 },

46042 { 
JS_ATOM_AsyncFun˘i⁄Resﬁve
, 
js_async_fun˘i⁄_ªsﬁve_föÆizî
, 
js_async_fun˘i⁄_ªsﬁve_m¨k
 },

46043 { 
JS_ATOM_AsyncFun˘i⁄Reje˘
, 
js_async_fun˘i⁄_ªsﬁve_föÆizî
, 
js_async_fun˘i⁄_ªsﬁve_m¨k
 },

46044 { 
JS_ATOM_em±y_°rög
, 
js_async_‰om_sync_ôî©‹_föÆizî
, 
js_async_‰om_sync_ôî©‹_m¨k
 },

46045 { 
JS_ATOM_AsyncGíî©‹Fun˘i⁄
, 
js_byãcode_fun˘i⁄_föÆizî
, 
js_byãcode_fun˘i⁄_m¨k
 },

46046 { 
JS_ATOM_AsyncGíî©‹
, 
js_async_gíî©‹_föÆizî
, 
js_async_gíî©‹_m¨k
 },

46049 
	$JS_AddI¡rösicPromi£
(
JSC⁄ãxt
 *
˘x
)

46051 
JSRu¡ime
 *
π
 = 
˘x
->rt;

46052 
JSVÆue
 
obj1
;

46054 i‡(!
	`JS_IsRegi°îedCœss
(
π
, 
JS_CLASS_PROMISE
)) {

46055 
	`öô_˛ass_ønge
(
π
, 
js_async_˛ass_def
, 
JS_CLASS_PROMISE
,

46056 
	`cou¡of
(
js_async_˛ass_def
));

46057 
π
->
˛ass_¨øy
[
JS_CLASS_PROMISE_RESOLVE_FUNCTION
].
ˇŒ
 = 
js_¥omi£_ªsﬁve_fun˘i⁄_ˇŒ
;

46058 
π
->
˛ass_¨øy
[
JS_CLASS_PROMISE_REJECT_FUNCTION
].
ˇŒ
 = 
js_¥omi£_ªsﬁve_fun˘i⁄_ˇŒ
;

46059 
π
->
˛ass_¨øy
[
JS_CLASS_ASYNC_FUNCTION
].
ˇŒ
 = 
js_async_fun˘i⁄_ˇŒ
;

46060 
π
->
˛ass_¨øy
[
JS_CLASS_ASYNC_FUNCTION_RESOLVE
].
ˇŒ
 = 
js_async_fun˘i⁄_ªsﬁve_ˇŒ
;

46061 
π
->
˛ass_¨øy
[
JS_CLASS_ASYNC_FUNCTION_REJECT
].
ˇŒ
 = 
js_async_fun˘i⁄_ªsﬁve_ˇŒ
;

46062 
π
->
˛ass_¨øy
[
JS_CLASS_ASYNC_GENERATOR_FUNCTION
].
ˇŒ
 = 
js_async_gíî©‹_fun˘i⁄_ˇŒ
;

46066 
˘x
->
˛ass_¥Ÿo
[
JS_CLASS_PROMISE
] = 
	`JS_NewObje˘
(ctx);

46067 
	`JS_SëPr›îtyFun˘i⁄Li°
(
˘x
, ctx->
˛ass_¥Ÿo
[
JS_CLASS_PROMISE
],

46068 
js_¥omi£_¥Ÿo_funcs
,

46069 
	`cou¡of
(
js_¥omi£_¥Ÿo_funcs
));

46070 
obj1
 = 
	`JS_NewCFun˘i⁄2
(
˘x
, 
js_¥omi£_c⁄°ru˘‹
, "Promise", 1,

46071 
JS_CFUNC_c⁄°ru˘‹
, 0);

46072 
˘x
->
¥omi£_˘‹
 = 
	`JS_DupVÆue
(˘x, 
obj1
);

46073 
	`JS_SëPr›îtyFun˘i⁄Li°
(
˘x
, 
obj1
,

46074 
js_¥omi£_funcs
,

46075 
	`cou¡of
(
js_¥omi£_funcs
));

46076 
	`JS_NewGlobÆCC⁄°ru˘‹2
(
˘x
, 
obj1
, "Promise",

46077 
˘x
->
˛ass_¥Ÿo
[
JS_CLASS_PROMISE
]);

46080 
˘x
->
˛ass_¥Ÿo
[
JS_CLASS_ASYNC_FUNCTION
] = 
	`JS_NewObje˘PrŸo
(˘x, ctx->
fun˘i⁄_¥Ÿo
);

46081 
obj1
 = 
	`JS_NewCFun˘i⁄3
(
˘x
, (
JSCFun˘i⁄
 *)
js_fun˘i⁄_c⁄°ru˘‹
,

46083 
JS_CFUNC_c⁄°ru˘‹_‹_func_magic
, 
JS_FUNC_ASYNC
,

46084 
˘x
->
fun˘i⁄_˘‹
);

46085 
	`JS_SëPr›îtyFun˘i⁄Li°
(
˘x
,

46086 
˘x
->
˛ass_¥Ÿo
[
JS_CLASS_ASYNC_FUNCTION
],

46087 
js_async_fun˘i⁄_¥Ÿo_funcs
,

46088 
	`cou¡of
(
js_async_fun˘i⁄_¥Ÿo_funcs
));

46089 
	`JS_SëC⁄°ru˘‹2
(
˘x
, 
obj1
, ctx->
˛ass_¥Ÿo
[
JS_CLASS_ASYNC_FUNCTION
],

46090 0, 
JS_PROP_CONFIGURABLE
);

46091 
	`JS_FªeVÆue
(
˘x
, 
obj1
);

46094 
˘x
->
async_ôî©‹_¥Ÿo
 = 
	`JS_NewObje˘
(ctx);

46095 
	`JS_SëPr›îtyFun˘i⁄Li°
(
˘x
, ctx->
async_ôî©‹_¥Ÿo
,

46096 
js_async_ôî©‹_¥Ÿo_funcs
,

46097 
	`cou¡of
(
js_async_ôî©‹_¥Ÿo_funcs
));

46100 
˘x
->
˛ass_¥Ÿo
[
JS_CLASS_ASYNC_FROM_SYNC_ITERATOR
] =

46101 
	`JS_NewObje˘PrŸo
(
˘x
, ctx->
async_ôî©‹_¥Ÿo
);

46102 
	`JS_SëPr›îtyFun˘i⁄Li°
(
˘x
, ctx->
˛ass_¥Ÿo
[
JS_CLASS_ASYNC_FROM_SYNC_ITERATOR
],

46103 
js_async_‰om_sync_ôî©‹_¥Ÿo_funcs
,

46104 
	`cou¡of
(
js_async_‰om_sync_ôî©‹_¥Ÿo_funcs
));

46107 
˘x
->
˛ass_¥Ÿo
[
JS_CLASS_ASYNC_GENERATOR
] =

46108 
	`JS_NewObje˘PrŸo
(
˘x
, ctx->
async_ôî©‹_¥Ÿo
);

46109 
	`JS_SëPr›îtyFun˘i⁄Li°
(
˘x
,

46110 
˘x
->
˛ass_¥Ÿo
[
JS_CLASS_ASYNC_GENERATOR
],

46111 
js_async_gíî©‹_¥Ÿo_funcs
,

46112 
	`cou¡of
(
js_async_gíî©‹_¥Ÿo_funcs
));

46115 
˘x
->
˛ass_¥Ÿo
[
JS_CLASS_ASYNC_GENERATOR_FUNCTION
] =

46116 
	`JS_NewObje˘PrŸo
(
˘x
, ctx->
fun˘i⁄_¥Ÿo
);

46117 
obj1
 = 
	`JS_NewCFun˘i⁄3
(
˘x
, (
JSCFun˘i⁄
 *)
js_fun˘i⁄_c⁄°ru˘‹
,

46119 
JS_CFUNC_c⁄°ru˘‹_‹_func_magic
,

46120 
JS_FUNC_ASYNC_GENERATOR
,

46121 
˘x
->
fun˘i⁄_˘‹
);

46122 
	`JS_SëPr›îtyFun˘i⁄Li°
(
˘x
,

46123 
˘x
->
˛ass_¥Ÿo
[
JS_CLASS_ASYNC_GENERATOR_FUNCTION
],

46124 
js_async_gíî©‹_fun˘i⁄_¥Ÿo_funcs
,

46125 
	`cou¡of
(
js_async_gíî©‹_fun˘i⁄_¥Ÿo_funcs
));

46126 
	`JS_SëC⁄°ru˘‹2
(
˘x
, ctx->
˛ass_¥Ÿo
[
JS_CLASS_ASYNC_GENERATOR_FUNCTION
],

46127 
˘x
->
˛ass_¥Ÿo
[
JS_CLASS_ASYNC_GENERATOR
],

46128 
JS_PROP_CONFIGURABLE
, JS_PROP_CONFIGURABLE);

46129 
	`JS_SëC⁄°ru˘‹2
(
˘x
, 
obj1
, ctx->
˛ass_¥Ÿo
[
JS_CLASS_ASYNC_GENERATOR_FUNCTION
],

46130 0, 
JS_PROP_CONFIGURABLE
);

46131 
	`JS_FªeVÆue
(
˘x
, 
obj1
);

46132 
	}
}

46136 
	$°rög_gë_hex
(
JSSåög
 *
p
, 
k
, 
n
) {

46137 
c
 = 0, 
h
;

46138 
n
-- > 0) {

46139 i‡((
h
 = 
	`‰om_hex
(
	`°rög_gë
(
p
, 
k
++))) < 0)

46141 
c
 = (¯<< 4Ë| 
h
;

46143  
c
;

46144 
	}
}

46146 
	$isURIRe£rved
(
c
) {

46147  
c
 < 0x100 && 
	`memchr
(";/?:@&=+$,#", c, (";/?:@&=+$,#"Ë- 1Ë!
NULL
;

46148 
	}
}

46150 
__©åibuã__
((
	$f‹m©
(
¥ötf
, 2, 3))Ë
	$js_throw_URIEº‹
(
JSC⁄ãxt
 *
˘x
, c⁄° *
fmt
, ...)

46152 
va_li°
 
≠
;

46154 
	`va_°¨t
(
≠
, 
fmt
);

46155 
	`JS_ThrowEº‹
(
˘x
, 
JS_URI_ERROR
, 
fmt
, 
≠
);

46156 
	`va_íd
(
≠
);

46158 
	}
}

46160 
	$hex_decode
(
JSC⁄ãxt
 *
˘x
, 
JSSåög
 *
p
, 
k
) {

46161 
c
;

46163 i‡(
k
 >
p
->
Àn
 || 
	`°rög_gë
(p, k) != '%')

46164  
	`js_throw_URIEº‹
(
˘x
, "expecting %%");

46165 i‡(
k
 + 2 >
p
->
Àn
 || (
c
 = 
	`°rög_gë_hex
(p, k + 1, 2)) < 0)

46166  
	`js_throw_URIEº‹
(
˘x
, "expecting hex digit");

46168  
c
;

46169 
	}
}

46171 
JSVÆue
 
	$js_globÆ_decodeURI
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

46172 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
, 
isComp⁄ít
)

46174 
JSVÆue
 
°r
;

46175 
SåögBuf„r
 
b_s
, *
b
 = &b_s;

46176 
JSSåög
 *
p
;

46177 
k
, 
c
, 
c1
, 
n
, 
c_mö
;

46179 
°r
 = 
	`JS_ToSåög
(
˘x
, 
¨gv
[0]);

46180 i‡(
	`JS_IsEx˚±i⁄
(
°r
))

46181  
°r
;

46183 
	`°rög_buf„r_öô
(
˘x
, 
b
, 0);

46185 
p
 = 
	`JS_VALUE_GET_STRING
(
°r
);

46186 
k
 = 0; k < 
p
->
Àn
;) {

46187 
c
 = 
	`°rög_gë
(
p
, 
k
);

46188 i‡(
c
 == '%') {

46189 
c
 = 
	`hex_decode
(
˘x
, 
p
, 
k
);

46190 i‡(
c
 < 0)

46191 
Áû
;

46192 
k
 += 3;

46193 i‡(
c
 < 0x80) {

46194 i‡(!
isComp⁄ít
 && 
	`isURIRe£rved
(
c
)) {

46195 
c
 = '%';

46196 
k
 -= 2;

46200 i‡(
c
 >= 0xc0 && c <= 0xdf) {

46201 
n
 = 1;

46202 
c_mö
 = 0x80;

46203 
c
 &= 0x1f;

46204 } i‡(
c
 >= 0xe0 && c <= 0xef) {

46205 
n
 = 2;

46206 
c_mö
 = 0x800;

46207 
c
 &= 0xf;

46208 } i‡(
c
 >= 0xf0 && c <= 0xf7) {

46209 
n
 = 3;

46210 
c_mö
 = 0x10000;

46211 
c
 &= 0x7;

46213 
n
 = 0;

46214 
c_mö
 = 1;

46215 
c
 = 0;

46217 
n
-- > 0) {

46218 
c1
 = 
	`hex_decode
(
˘x
, 
p
, 
k
);

46219 i‡(
c1
 < 0)

46220 
Áû
;

46221 
k
 += 3;

46222 i‡((
c1
 & 0xc0) != 0x80) {

46223 
c
 = 0;

46226 
c
 = (¯<< 6Ë| (
c1
 & 0x3f);

46228 i‡(
c
 < 
c_mö
 || c > 0x10FFFF ||

46229 (
c
 >= 0xd800 && c < 0xe000)) {

46230 
	`js_throw_URIEº‹
(
˘x
, "malformed UTF-8");

46231 
Áû
;

46235 
k
++;

46237 
	`°rög_buf„r_putc
(
b
, 
c
);

46239 
	`JS_FªeVÆue
(
˘x
, 
°r
);

46240  
	`°rög_buf„r_íd
(
b
);

46242 
Áû
:

46243 
	`JS_FªeVÆue
(
˘x
, 
°r
);

46244 
	`°rög_buf„r_‰ì
(
b
);

46245  
JS_EXCEPTION
;

46246 
	}
}

46248 
	$isU√sˇ≥d
(
c
) {

46249 c⁄° 
u√sˇ≥d_ch¨s
[] =

46254  
c
 < 0x100 &&

46255 
	`memchr
(
u√sˇ≥d_ch¨s
, 
c
, (unescaped_chars) - 1);

46256 
	}
}

46258 
	$isURIU√sˇ≥d
(
c
, 
isComp⁄ít
) {

46259  
c
 < 0x100 &&

46260 ((
c
 >= 0x61 && c <= 0x7a) ||

46261 (
c
 >= 0x41 && c <= 0x5a) ||

46262 (
c
 >= 0x30 && c <= 0x39) ||

46263 
	`memchr
("-_.!~*'()", 
c
, ("-_.!~*'()"Ë- 1Ë!
NULL
 ||

46264 (!
isComp⁄ít
 && 
	`isURIRe£rved
(
c
)));

46265 
	}
}

46267 
	$ícodeURI_hex
(
SåögBuf„r
 *
b
, 
c
) {

46268 
uöt8_t
 
buf
[6];

46269 
n
 = 0;

46270 c⁄° *
hex
 = "0123456789ABCDEF";

46272 
buf
[
n
++] = '%';

46273 i‡(
c
 >= 256) {

46274 
buf
[
n
++] = 'u';

46275 
buf
[
n
++] = 
hex
[(
c
 >> 12) & 15];

46276 
buf
[
n
++] = 
hex
[(
c
 >> 8) & 15];

46278 
buf
[
n
++] = 
hex
[(
c
 >> 4) & 15];

46279 
buf
[
n
++] = 
hex
[(
c
 >> 0) & 15];

46280  
	`°rög_buf„r_wrôe8
(
b
, 
buf
, 
n
);

46281 
	}
}

46283 
JSVÆue
 
	$js_globÆ_ícodeURI
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

46284 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
,

46285 
isComp⁄ít
)

46287 
JSVÆue
 
°r
;

46288 
SåögBuf„r
 
b_s
, *
b
 = &b_s;

46289 
JSSåög
 *
p
;

46290 
k
, 
c
, 
c1
;

46292 
°r
 = 
	`JS_ToSåög
(
˘x
, 
¨gv
[0]);

46293 i‡(
	`JS_IsEx˚±i⁄
(
°r
))

46294  
°r
;

46296 
p
 = 
	`JS_VALUE_GET_STRING
(
°r
);

46297 
	`°rög_buf„r_öô
(
˘x
, 
b
, 
p
->
Àn
);

46298 
k
 = 0; k < 
p
->
Àn
;) {

46299 
c
 = 
	`°rög_gë
(
p
, 
k
);

46300 
k
++;

46301 i‡(
	`isURIU√sˇ≥d
(
c
, 
isComp⁄ít
)) {

46302 
	`°rög_buf„r_putc16
(
b
, 
c
);

46304 i‡(
c
 >= 0xdc00 && c <= 0xdfff) {

46305 
	`js_throw_URIEº‹
(
˘x
, "invalid character");

46306 
Áû
;

46307 } i‡(
c
 >= 0xd800 && c <= 0xdbff) {

46308 i‡(
k
 >
p
->
Àn
) {

46309 
	`js_throw_URIEº‹
(
˘x
, "expecting surrogateÖair");

46310 
Áû
;

46312 
c1
 = 
	`°rög_gë
(
p
, 
k
);

46313 
k
++;

46314 i‡(
c1
 < 0xdc00 || c1 > 0xdfff) {

46315 
	`js_throw_URIEº‹
(
˘x
, "expecting surrogateÖair");

46316 
Áû
;

46318 
c
 = (((¯& 0x3ffË<< 10Ë| (
c1
 & 0x3ff)) + 0x10000;

46320 i‡(
c
 < 0x80) {

46321 
	`ícodeURI_hex
(
b
, 
c
);

46324 i‡(
c
 < 0x800) {

46325 
	`ícodeURI_hex
(
b
, (
c
 >> 6) | 0xc0);

46327 i‡(
c
 < 0x10000) {

46328 
	`ícodeURI_hex
(
b
, (
c
 >> 12) | 0xe0);

46330 
	`ícodeURI_hex
(
b
, (
c
 >> 18) | 0xf0);

46331 
	`ícodeURI_hex
(
b
, ((
c
 >> 12) & 0x3f) | 0x80);

46333 
	`ícodeURI_hex
(
b
, ((
c
 >> 6) & 0x3f) | 0x80);

46335 
	`ícodeURI_hex
(
b
, (
c
 & 0x3f) | 0x80);

46339 
	`JS_FªeVÆue
(
˘x
, 
°r
);

46340  
	`°rög_buf„r_íd
(
b
);

46342 
Áû
:

46343 
	`JS_FªeVÆue
(
˘x
, 
°r
);

46344 
	`°rög_buf„r_‰ì
(
b
);

46345  
JS_EXCEPTION
;

46346 
	}
}

46348 
JSVÆue
 
	$js_globÆ_esˇ≥
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

46349 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

46351 
JSVÆue
 
°r
;

46352 
SåögBuf„r
 
b_s
, *
b
 = &b_s;

46353 
JSSåög
 *
p
;

46354 
i
, 
Àn
, 
c
;

46356 
°r
 = 
	`JS_ToSåög
(
˘x
, 
¨gv
[0]);

46357 i‡(
	`JS_IsEx˚±i⁄
(
°r
))

46358  
°r
;

46360 
p
 = 
	`JS_VALUE_GET_STRING
(
°r
);

46361 
	`°rög_buf„r_öô
(
˘x
, 
b
, 
p
->
Àn
);

46362 
i
 = 0, 
Àn
 = 
p
->len; i <Üen; i++) {

46363 
c
 = 
	`°rög_gë
(
p
, 
i
);

46364 i‡(
	`isU√sˇ≥d
(
c
)) {

46365 
	`°rög_buf„r_putc16
(
b
, 
c
);

46367 
	`ícodeURI_hex
(
b
, 
c
);

46370 
	`JS_FªeVÆue
(
˘x
, 
°r
);

46371  
	`°rög_buf„r_íd
(
b
);

46372 
	}
}

46374 
JSVÆue
 
	$js_globÆ_u√sˇ≥
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

46375 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

46377 
JSVÆue
 
°r
;

46378 
SåögBuf„r
 
b_s
, *
b
 = &b_s;

46379 
JSSåög
 *
p
;

46380 
i
, 
Àn
, 
c
, 
n
;

46382 
°r
 = 
	`JS_ToSåög
(
˘x
, 
¨gv
[0]);

46383 i‡(
	`JS_IsEx˚±i⁄
(
°r
))

46384  
°r
;

46386 
	`°rög_buf„r_öô
(
˘x
, 
b
, 0);

46387 
p
 = 
	`JS_VALUE_GET_STRING
(
°r
);

46388 
i
 = 0, 
Àn
 = 
p
->len; i <Üen; i++) {

46389 
c
 = 
	`°rög_gë
(
p
, 
i
);

46390 i‡(
c
 == '%') {

46391 i‡(
i
 + 6 <
Àn


46392 && 
	`°rög_gë
(
p
, 
i
 + 1) == 'u'

46393 && (
n
 = 
	`°rög_gë_hex
(
p
, 
i
 + 2, 4)) >= 0) {

46394 
c
 = 
n
;

46395 
i
 += 6 - 1;

46397 i‡(
i
 + 3 <
Àn


46398 && (
n
 = 
	`°rög_gë_hex
(
p
, 
i
 + 1, 2)) >= 0) {

46399 
c
 = 
n
;

46400 
i
 += 3 - 1;

46403 
	`°rög_buf„r_putc16
(
b
, 
c
);

46405 
	`JS_FªeVÆue
(
˘x
, 
°r
);

46406  
	`°rög_buf„r_íd
(
b
);

46407 
	}
}

46411 c⁄° 
JSCFun˘i⁄Li°E¡ry
 
	gjs_globÆ_funcs
[] = {

46412 
JS_CFUNC_DEF
("∑r£I¡", 2, 
js_∑r£I¡
 ),

46413 
JS_CFUNC_DEF
("∑r£Flﬂt", 1, 
js_∑r£Flﬂt
 ),

46414 
JS_CFUNC_DEF
("isNaN", 1, 
js_globÆ_isNaN
 ),

46415 
JS_CFUNC_DEF
("isFöôe", 1, 
js_globÆ_isFöôe
 ),

46417 
JS_CFUNC_MAGIC_DEF
("decodeURI", 1, 
js_globÆ_decodeURI
, 0 ),

46418 
JS_CFUNC_MAGIC_DEF
("decodeURIComp⁄ít", 1, 
js_globÆ_decodeURI
, 1 ),

46419 
JS_CFUNC_MAGIC_DEF
("ícodeURI", 1, 
js_globÆ_ícodeURI
, 0 ),

46420 
JS_CFUNC_MAGIC_DEF
("ícodeURIComp⁄ít", 1, 
js_globÆ_ícodeURI
, 1 ),

46421 
JS_CFUNC_DEF
("esˇ≥", 1, 
js_globÆ_esˇ≥
 ),

46422 
JS_CFUNC_DEF
("u√sˇ≥", 1, 
js_globÆ_u√sˇ≥
 ),

46423 
JS_PROP_DOUBLE_DEF
("Infinity", 1.0 / 0.0, 0 ),

46424 
JS_PROP_DOUBLE_DEF
("NaN", 
NAN
, 0 ),

46425 
JS_PROP_UNDEFINED_DEF
("undefined", 0 ),

46428 
JS_CFUNC_DEF
("__d©e_˛ock", 0, 
js___d©e_˛ock
 ),

46436 
söt64_t
 
	$m©h_mod
(
öt64_t
 
a
, 
söt64_t
 
b
) {

46438 
söt64_t
 
m
 = 
a
 % 
b
;

46439  
m
 + (m < 0Ë* 
b
;

46440 
	}
}

46442 
söt64_t
 
	$Êo‹_div
(
öt64_t
 
a
, 
söt64_t
 
b
) {

46444 
söt64_t
 
m
 = 
a
 % 
b
;

46445  (
a
 - (
m
 + (m < 0Ë* 
b
)) / b;

46446 
	}
}

46448 
JSVÆue
 
js_D©e_∑r£
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

46449 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
);

46451 
__ex˚±i⁄
 
	$JS_ThisTimeVÆue
(
JSC⁄ãxt
 *
˘x
, *
vÆp
, 
JSVÆueC⁄°
 
this_vÆ
)

46453 i‡(
	`JS_VALUE_GET_TAG
(
this_vÆ
Ë=
JS_TAG_OBJECT
) {

46454 
JSObje˘
 *
p
 = 
	`JS_VALUE_GET_OBJ
(
this_vÆ
);

46455 i‡(
p
->
˛ass_id
 =
JS_CLASS_DATE
 && 
	`JS_IsNumbî
’->
u
.
obje˘_d©a
))

46456  
	`JS_ToFlﬂt64
(
˘x
, 
vÆp
, 
p
->
u
.
obje˘_d©a
);

46458 
	`JS_ThrowTy≥Eº‹
(
˘x
, "notá Date object");

46460 
	}
}

46462 
JSVÆue
 
	$JS_SëThisTimeVÆue
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
, 
v
)

46464 i‡(
	`JS_VALUE_GET_TAG
(
this_vÆ
Ë=
JS_TAG_OBJECT
) {

46465 
JSObje˘
 *
p
 = 
	`JS_VALUE_GET_OBJ
(
this_vÆ
);

46466 i‡(
p
->
˛ass_id
 =
JS_CLASS_DATE
) {

46467 
	`JS_FªeVÆue
(
˘x
, 
p
->
u
.
obje˘_d©a
);

46468 
p
->
u
.
obje˘_d©a
 = 
	`__JS_NewFlﬂt64
(
˘x
, 
v
);

46469  
	`JS_DupVÆue
(
˘x
, 
p
->
u
.
obje˘_d©a
);

46472  
	`JS_ThrowTy≥Eº‹
(
˘x
, "notá Date object");

46473 
	}
}

46475 
söt64_t
 
	$days_‰om_yór
(
öt64_t
 
y
) {

46476  365 * (
y
 - 1970Ë+ 
	`Êo‹_div
(y - 1969, 4) -

46477 
	`Êo‹_div
(
y
 - 1901, 100) + floor_div(y - 1601, 400);

46478 
	}
}

46480 
söt64_t
 
	$days_ö_yór
(
öt64_t
 
y
) {

46481  365 + !(
y
 % 4) - !(y % 100) + !(y % 400);

46482 
	}
}

46485 
söt64_t
 
	$yór_‰om_days
(
öt64_t
 *
days
) {

46486 
söt64_t
 
y
, 
d1
, 
nd
, 
d
 = *
days
;

46487 
y
 = 
	`Êo‹_div
(
d
 * 10000, 3652425) + 1970;

46491 
d1
 = 
d
 - 
	`days_‰om_yór
(
y
);

46492 i‡(
d1
 < 0) {

46493 
y
--;

46494 
d1
 +
	`days_ö_yór
(
y
);

46496 
nd
 = 
	`days_ö_yór
(
y
);

46497 i‡(
d1
 < 
nd
)

46499 
d1
 -
nd
;

46500 
y
++;

46503 *
days
 = 
d1
;

46504  
y
;

46505 
	}
}

46507 c⁄° 
	gm⁄th_days
[] = { 31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31 };

46508 c⁄° 
	gm⁄th_«mes
[] = "JanFebMarAprMayJunJulAugSepOctNovDec";

46509 c⁄° 
	gday_«mes
[] = "SunMonTueWedThuFriSat";

46511 
__ex˚±i⁄
 
	$gë_d©e_fõlds
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
obj
,

46512 
öt64_t
 
fõlds
[9], 
is_loˇl
, 
f‹˚
)

46514 
dvÆ
;

46515 
söt64_t
 
d
, 
days
, 
wd
, 
y
, 
i
, 
md
, 
h
, 
m
, 
s
, 
ms
, 
tz
 = 0;

46517 i‡(
	`JS_ThisTimeVÆue
(
˘x
, &
dvÆ
, 
obj
))

46520 i‡(
	`i¢™
(
dvÆ
)) {

46521 i‡(!
f‹˚
)

46522  
FALSE
;

46523 
d
 = 0;

46525 
d
 = 
dvÆ
;

46526 i‡(
is_loˇl
) {

46527 
tz
 = -
	`gëTimez⁄eOff£t
(
d
);

46528 
d
 +
tz
 * 60000;

46533 
h
 = 
	`m©h_mod
(
d
, 86400000);

46534 
days
 = (
d
 - 
h
) / 86400000;

46535 
ms
 = 
h
 % 1000;

46536 
h
 = (h - 
ms
) / 1000;

46537 
s
 = 
h
 % 60;

46538 
h
 = (h - 
s
) / 60;

46539 
m
 = 
h
 % 60;

46540 
h
 = (h - 
m
) / 60;

46541 
wd
 = 
	`m©h_mod
(
days
 + 4, 7);

46542 
y
 = 
	`yór_‰om_days
(&
days
);

46544 
i
 = 0; i < 11; i++) {

46545 
md
 = 
m⁄th_days
[
i
];

46546 i‡(
i
 == 1)

46547 
md
 +
	`days_ö_yór
(
y
) - 365;

46548 i‡(
days
 < 
md
)

46550 
days
 -
md
;

46552 
fõlds
[0] = 
y
;

46553 
fõlds
[1] = 
i
;

46554 
fõlds
[2] = 
days
 + 1;

46555 
fõlds
[3] = 
h
;

46556 
fõlds
[4] = 
m
;

46557 
fõlds
[5] = 
s
;

46558 
fõlds
[6] = 
ms
;

46559 
fõlds
[7] = 
wd
;

46560 
fõlds
[8] = 
tz
;

46561  
TRUE
;

46562 
	}
}

46564 
	$time_˛ù
(
t
) {

46565 i‡(
t
 >= -8.64e15 &&Å <= 8.64e15)

46566  
	`åunc
(
t
) + 0.0;

46568  
NAN
;

46569 
	}
}

46571 
	$£t_d©e_fõlds
(
söt64_t
 
fõlds
[], 
is_loˇl
) {

46572 
söt64_t
 
days
, 
y
, 
m
, 
md
, 
h
, 
d
, 
i
;

46574 
i
 = 
fõlds
[1];

46575 
m
 = 
	`m©h_mod
(
i
, 12);

46576 
y
 = 
fõlds
[0] + (
i
 - 
m
) / 12;

46577 
days
 = 
	`days_‰om_yór
(
y
);

46579 
i
 = 0; i < 
m
; i++) {

46580 
md
 = 
m⁄th_days
[
i
];

46581 i‡(
i
 == 1)

46582 
md
 +
	`days_ö_yór
(
y
) - 365;

46583 
days
 +
md
;

46585 
days
 +
fõlds
[2] - 1;

46586 
h
 = ((
fõlds
[3] * 60 + fields[4]) * 60 + fields[5]) * 1000 + fields[6];

46587 
d
 = 
days
 * 86400000 + 
h
;

46588 i‡(
is_loˇl
)

46589 
d
 +
	`gëTimez⁄eOff£t
(d) * 60000;

46590  
	`time_˛ù
(
d
);

46591 
	}
}

46593 
JSVÆue
 
	$gë_d©e_fõld
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

46594 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
, 
magic
)

46597 
söt64_t
 
fõlds
[9];

46598 
ªs
, 
n
, 
is_loˇl
;

46600 
is_loˇl
 = 
magic
 & 0x0F;

46601 
n
 = (
magic
 >> 4) & 0x0F;

46602 
ªs
 = 
	`gë_d©e_fõlds
(
˘x
, 
this_vÆ
, 
fõlds
, 
is_loˇl
, 0);

46603 i‡(
ªs
 < 0)

46604  
JS_EXCEPTION
;

46605 i‡(!
ªs
)

46606  
JS_NAN
;

46608 i‡(
magic
 & 0x100) {

46609 
fõlds
[0] -= 1900;

46611  
	`JS_NewI¡64
(
˘x
, 
fõlds
[
n
]);

46612 
	}
}

46614 
JSVÆue
 
	$£t_d©e_fõld
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

46615 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
, 
magic
)

46618 
söt64_t
 
fõlds
[9];

46619 
ªs
, 
fú°_fõld
, 
íd_fõld
, 
is_loˇl
, 
i
, 
n
;

46620 
d
, 
a
;

46622 
d
 = 
NAN
;

46623 
fú°_fõld
 = (
magic
 >> 8) & 0x0F;

46624 
íd_fõld
 = (
magic
 >> 4) & 0x0F;

46625 
is_loˇl
 = 
magic
 & 0x0F;

46627 
ªs
 = 
	`gë_d©e_fõlds
(
˘x
, 
this_vÆ
, 
fõlds
, 
is_loˇl
, 
fú°_fõld
 == 0);

46628 i‡(
ªs
 < 0)

46629  
JS_EXCEPTION
;

46630 i‡(
ªs
 && 
¨gc
 > 0) {

46631 
n
 = 
íd_fõld
 - 
fú°_fõld
;

46632 i‡(
¨gc
 < 
n
)

46633 
n
 = 
¨gc
;

46634 
i
 = 0; i < 
n
; i++) {

46635 i‡(
	`JS_ToFlﬂt64
(
˘x
, &
a
, 
¨gv
[
i
]))

46636  
JS_EXCEPTION
;

46637 i‡(!
	`isföôe
(
a
))

46638 
d⁄e
;

46639 
fõlds
[
fú°_fõld
 + 
i
] = 
	`åunc
(
a
);

46641 
d
 = 
	`£t_d©e_fõlds
(
fõlds
, 
is_loˇl
);

46643 
d⁄e
:

46644  
	`JS_SëThisTimeVÆue
(
˘x
, 
this_vÆ
, 
d
);

46645 
	}
}

46655 
JSVÆue
 
	$gë_d©e_°rög
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

46656 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
, 
magic
)

46659 
buf
[64];

46660 
söt64_t
 
fõlds
[9];

46661 
ªs
, 
fmt
, 
∑π
, 
pos
;

46662 
y
, 
m⁄
, 
d
, 
h
, 
m
, 
s
, 
ms
, 
wd
, 
tz
;

46664 
fmt
 = (
magic
 >> 4) & 0x0F;

46665 
∑π
 = 
magic
 & 0x0F;

46667 
ªs
 = 
	`gë_d©e_fõlds
(
˘x
, 
this_vÆ
, 
fõlds
, 
fmt
 & 1, 0);

46668 i‡(
ªs
 < 0)

46669  
JS_EXCEPTION
;

46670 i‡(!
ªs
) {

46671 i‡(
fmt
 == 2)

46672  
	`JS_ThrowR™geEº‹
(
˘x
, "Date value is NaN");

46674  
	`JS_NewSåög
(
˘x
, "Invalid Date");

46677 
y
 = 
fõlds
[0];

46678 
m⁄
 = 
fõlds
[1];

46679 
d
 = 
fõlds
[2];

46680 
h
 = 
fõlds
[3];

46681 
m
 = 
fõlds
[4];

46682 
s
 = 
fõlds
[5];

46683 
ms
 = 
fõlds
[6];

46684 
wd
 = 
fõlds
[7];

46685 
tz
 = 
fõlds
[8];

46687 
pos
 = 0;

46689 i‡(
∑π
 & 1) {

46690 
fmt
) {

46692 
pos
 +
	`¢¥ötf
(
buf
 +Öos, (buf) -Öos,

46694 
day_«mes
 + 
wd
 * 3, 
d
,

46695 
m⁄th_«mes
 + 
m⁄
 * 3, 4 + (
y
 < 0), y);

46698 
pos
 +
	`¢¥ötf
(
buf
 +Öos, (buf) -Öos,

46700 
day_«mes
 + 
wd
 * 3,

46701 
m⁄th_«mes
 + 
m⁄
 * 3, 
d
, 4 + (
y
 < 0), y);

46702 i‡(
∑π
 == 3) {

46703 
buf
[
pos
++] = ' ';

46707 i‡(
y
 >= 0 && y <= 9999) {

46708 
pos
 +
	`¢¥ötf
(
buf
 +Öos, (buf) -Öos,

46709 "%04d", 
y
);

46711 
pos
 +
	`¢¥ötf
(
buf
 +Öos, (buf) -Öos,

46712 "%+07d", 
y
);

46714 
pos
 +
	`¢¥ötf
(
buf
 +Öos, (buf) -Öos,

46715 "-%02d-%02dT", 
m⁄
 + 1, 
d
);

46718 
pos
 +
	`¢¥ötf
(
buf
 +Öos, (buf) -Öos,

46719 "%02d/%02d/%0*d", 
m⁄
 + 1, 
d
, 4 + (
y
 < 0), y);

46720 i‡(
∑π
 == 3) {

46721 
buf
[
pos
++] = ',';

46722 
buf
[
pos
++] = ' ';

46727 i‡(
∑π
 & 2) {

46728 
fmt
) {

46730 
pos
 +
	`¢¥ötf
(
buf
 +Öos, (buf) -Öos,

46731 "%02d:%02d:%02d GMT", 
h
, 
m
, 
s
);

46734 
pos
 +
	`¢¥ötf
(
buf
 +Öos, (buf) -Öos,

46735 "%02d:%02d:%02d GMT", 
h
, 
m
, 
s
);

46736 i‡(
tz
 < 0) {

46737 
buf
[
pos
++] = '-';

46738 
tz
 = -tz;

46740 
buf
[
pos
++] = '+';

46743 
pos
 +
	`¢¥ötf
(
buf
 +Öos, (buf) -Öos,

46744 "%02d%02d", 
tz
 / 60,Åz % 60);

46748 
pos
 +
	`¢¥ötf
(
buf
 +Öos, (buf) -Öos,

46749 "%02d:%02d:%02d.%03dZ", 
h
, 
m
, 
s
, 
ms
);

46752 
pos
 +
	`¢¥ötf
(
buf
 +Öos, (buf) -Öos,

46753 "%02d:%02d:%02d %cM", (
h
 + 1Ë% 12 - 1, 
m
, 
s
,

46754 (
h
 < 12) ? 'A' : 'P');

46758  
	`JS_NewSåögLí
(
˘x
, 
buf
, 
pos
);

46759 
	}
}

46762 
söt64_t
 
	$d©e_now
() {

46763 
timevÆ
 
tv
;

46764 
	`gëtimeofday
(&
tv
, 
NULL
);

46765  (
söt64_t
)
tv
.
tv_£c
 * 1000 + (tv.
tv_u£c
 / 1000);

46766 
	}
}

46768 
JSVÆue
 
	$js_d©e_c⁄°ru˘‹
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
√w_èrgë
,

46769 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

46772 
JSVÆue
 
rv
;

46773 
i
, 
n
;

46774 
a
, 
vÆ
;

46776 i‡(
	`JS_IsUndeföed
(
√w_èrgë
)) {

46778 
¨gc
 = 0;

46780 
n
 = 
¨gc
;

46781 i‡(
n
 == 0) {

46782 
vÆ
 = 
	`d©e_now
();

46783 } i‡(
n
 == 1) {

46784 
JSVÆue
 
v
, 
dv
;

46785 i‡(
	`JS_VALUE_GET_TAG
(
¨gv
[0]Ë=
JS_TAG_OBJECT
) {

46786 
JSObje˘
 *
p
 = 
	`JS_VALUE_GET_OBJ
(
¨gv
[0]);

46787 i‡(
p
->
˛ass_id
 =
JS_CLASS_DATE
 && 
	`JS_IsNumbî
’->
u
.
obje˘_d©a
)) {

46788 i‡(
	`JS_ToFlﬂt64
(
˘x
, &
vÆ
, 
p
->
u
.
obje˘_d©a
))

46789  
JS_EXCEPTION
;

46790 
vÆ
 = 
	`time_˛ù
(val);

46791 
has_vÆ
;

46794 
v
 = 
	`JS_ToPrimôive
(
˘x
, 
¨gv
[0], 
HINT_NONE
);

46795 i‡(
	`JS_IsSåög
(
v
)) {

46796 
dv
 = 
	`js_D©e_∑r£
(
˘x
, 
JS_UNDEFINED
, 1, (
JSVÆueC⁄°
 *)&
v
);

46797 
	`JS_FªeVÆue
(
˘x
, 
v
);

46798 i‡(
	`JS_IsEx˚±i⁄
(
dv
))

46799  
JS_EXCEPTION
;

46800 i‡(
	`JS_ToFlﬂt64Fªe
(
˘x
, &
vÆ
, 
dv
))

46801  
JS_EXCEPTION
;

46803 i‡(
	`JS_ToFlﬂt64Fªe
(
˘x
, &
vÆ
, 
v
))

46804  
JS_EXCEPTION
;

46806 
vÆ
 = 
	`time_˛ù
(val);

46808 
söt64_t
 
fõlds
[] = { 0, 0, 1, 0, 0, 0, 0 };

46809 i‡(
n
 > 7)

46810 
n
 = 7;

46811 
i
 = 0; i < 
n
; i++) {

46812 i‡(
	`JS_ToFlﬂt64
(
˘x
, &
a
, 
¨gv
[
i
]))

46813  
JS_EXCEPTION
;

46814 i‡(!
	`isföôe
(
a
))

46816 
fõlds
[
i
] = 
	`åunc
(
a
);

46817 i‡(
i
 =0 && 
fõlds
[0] >= 0 && fields[0] < 100)

46818 
fõlds
[0] += 1900;

46820 
vÆ
 = (
i
 =
n
Ë? 
	`£t_d©e_fõlds
(
fõlds
, 1Ë: 
NAN
;

46822 
has_vÆ
:

46824 
JSVÆueC⁄°
 
¨gs
[3];

46825 
¨gs
[0] = 
√w_èrgë
;

46826 
¨gs
[1] = 
˘x
->
˛ass_¥Ÿo
[
JS_CLASS_DATE
];

46827 
¨gs
[2] = 
	`__JS_NewFlﬂt64
(
˘x
, 
vÆ
);

46828 
rv
 = 
	`js___d©e_¸óã
(
˘x
, 
JS_UNDEFINED
, 3, 
¨gs
);

46830 
rv
 = 
	`js_¸óã_‰om_˘‹
(
˘x
, 
√w_èrgë
, 
JS_CLASS_DATE
);

46831 i‡(!
	`JS_IsEx˚±i⁄
(
rv
))

46832 
	`JS_SëObje˘D©a
(
˘x
, 
rv
, 
	`__JS_NewFlﬂt64
(˘x, 
vÆ
));

46834 i‡(!
	`JS_IsEx˚±i⁄
(
rv
Ë&& 
	`JS_IsUndeföed
(
√w_èrgë
)) {

46836 
JSVÆue
 
s
;

46837 
s
 = 
	`gë_d©e_°rög
(
˘x
, 
rv
, 0, 
NULL
, 0x13);

46838 
	`JS_FªeVÆue
(
˘x
, 
rv
);

46839 
rv
 = 
s
;

46841  
rv
;

46842 
	}
}

46844 
JSVÆue
 
	$js_D©e_UTC
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

46845 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

46848 
söt64_t
 
fõlds
[] = { 0, 0, 1, 0, 0, 0, 0 };

46849 
i
, 
n
;

46850 
a
;

46852 
n
 = 
¨gc
;

46853 i‡(
n
 == 0)

46854  
JS_NAN
;

46855 i‡(
n
 > 7)

46856 
n
 = 7;

46857 
i
 = 0; i < 
n
; i++) {

46858 i‡(
	`JS_ToFlﬂt64
(
˘x
, &
a
, 
¨gv
[
i
]))

46859  
JS_EXCEPTION
;

46860 i‡(!
	`isföôe
(
a
))

46861  
JS_NAN
;

46862 
fõlds
[
i
] = 
	`åunc
(
a
);

46863 i‡(
i
 =0 && 
fõlds
[0] >= 0 && fields[0] < 100)

46864 
fõlds
[0] += 1900;

46866  
	`__JS_NewFlﬂt64
(
˘x
, 
	`£t_d©e_fõlds
(
fõlds
, 0));

46867 
	}
}

46869 
	$°rög_skù_•a˚s
(
JSSåög
 *
•
, *
µ
) {

46870 *
µ
 < 
•
->
Àn
 && 
	`°rög_gë
(sp, *pp) == ' ')

46871 *
µ
 += 1;

46872 
	}
}

46874 
	$°rög_skù_n⁄_•a˚s
(
JSSåög
 *
•
, *
µ
) {

46875 *
µ
 < 
•
->
Àn
 && 
	`°rög_gë
(sp, *pp) != ' ')

46876 *
µ
 += 1;

46877 
	}
}

46880 
	$°rög_gë_fõld
(
JSSåög
 *
•
, *
µ
, 
öt64_t
 *
pvÆ
) {

46881 
söt64_t
 
v
 = 0;

46882 
c
, 
p
 = *
µ
;

46885 
p
 < 
•
->
Àn
) {

46886 
c
 = 
	`°rög_gë
(
•
, 
p
);

46887 i‡(
c
 >= '0' && c <= '9')

46889 
p
++;

46891 i‡(
p
 >
•
->
Àn
)

46893 
p
 < 
•
->
Àn
) {

46894 
c
 = 
	`°rög_gë
(
•
, 
p
);

46895 i‡(!(
c
 >= '0' && c <= '9'))

46897 
v
 = v * 10 + 
c
 - '0';

46898 
p
++;

46900 *
pvÆ
 = 
v
;

46901 *
µ
 = 
p
;

46903 
	}
}

46906 
	$°rög_gë_digôs
(
JSSåög
 *
•
, *
µ
, 
n
, 
söt64_t
 *
pvÆ
) {

46907 
söt64_t
 
v
 = 0;

46908 
i
, 
c
, 
p
 = *
µ
;

46910 
i
 = 0; i < 
n
; i++) {

46911 i‡(
p
 >
•
->
Àn
)

46913 
c
 = 
	`°rög_gë
(
•
, 
p
);

46914 i‡(!(
c
 >= '0' && c <= '9'))

46916 
v
 = v * 10 + 
c
 - '0';

46917 
p
++;

46919 *
pvÆ
 = 
v
;

46920 *
µ
 = 
p
;

46922 
	}
}

46925 
	$°rög_gë_sig√d_fõld
(
JSSåög
 *
•
, *
µ
, 
söt64_t
 *
pvÆ
) {

46926 
sgn
, 
ªs
;

46928 i‡(*
µ
 >
•
->
Àn
)

46931 
sgn
 = 
	`°rög_gë
(
•
, *
µ
);

46932 i‡(
sgn
 == '-' || sgn == '+')

46933 *
µ
 += 1;

46935 
ªs
 = 
	`°rög_gë_fõld
(
•
, 
µ
, 
pvÆ
);

46936 i‡(
ªs
 =0 && 
sgn
 == '-')

46937 *
pvÆ
 = -*pval;

46938  
ªs
;

46939 
	}
}

46941 
	$föd_abbªv
(
JSSåög
 *
•
, 
p
, c⁄° *
li°
, 
cou¡
) {

46942 
n
, 
i
;

46944 i‡(
p
 + 3 <
•
->
Àn
) {

46945 
n
 = 0;Ç < 
cou¡
;Ç++) {

46946 
i
 = 0; i < 3; i++) {

46947 i‡(
	`°rög_gë
(
•
, 
p
 + 
i
Ë!
m⁄th_«mes
[
n
 * 3 + i])

46948 
√xt
;

46950  
n
;

46951 
√xt
:;

46955 
	}
}

46957 
	$°rög_gë_m⁄th
(
JSSåög
 *
•
, *
µ
, 
söt64_t
 *
pvÆ
) {

46958 
n
;

46960 
	`°rög_skù_•a˚s
(
•
, 
µ
);

46961 
n
 = 
	`föd_abbªv
(
•
, *
µ
, 
m⁄th_«mes
, 12);

46962 i‡(
n
 < 0)

46965 *
pvÆ
 = 
n
;

46966 *
µ
 += 3;

46968 
	}
}

46970 
JSVÆue
 
	$js_D©e_∑r£
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

46971 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

46974 
JSVÆue
 
s
, 
rv
;

46975 
söt64_t
 
fõlds
[] = { 0, 1, 1, 0, 0, 0, 0 };

46976 
söt64_t
 
tz
, 
hh
, 
mm
;

46977 
d
;

46978 
p
, 
i
, 
c
, 
sgn
;

46979 
JSSåög
 *
•
;

46980 
BOOL
 
is_loˇl
;

46982 
rv
 = 
JS_NAN
;

46984 
s
 = 
	`JS_ToSåög
(
˘x
, 
¨gv
[0]);

46985 i‡(
	`JS_IsEx˚±i⁄
(
s
))

46986  
JS_EXCEPTION
;

46988 
•
 = 
	`JS_VALUE_GET_STRING
(
s
);

46989 
p
 = 0;

46990 i‡(
p
 < 
•
->
Àn
 && (((
c
 = 
	`°rög_gë
(sp,Ö)) >= '0' && c <= '9') || c == '+' || c == '-')) {

46994 i‡(
	`°rög_gë_sig√d_fõld
(
•
, &
p
, &
fõlds
[0]))

46995 
d⁄e
;

46997 
is_loˇl
 = 
TRUE
;

46998 
i
 = 1; i < 6; i++) {

46999 i‡(
	`°rög_gë_fõld
(
•
, &
p
, &
fõlds
[
i
]))

47002 i‡(
i
 <= 3) {

47004 
is_loˇl
 = 
FALSE
;

47005 } i‡(
i
 =6 && 
p
 < 
•
->
Àn
 && 
	`°rög_gë
(sp,Ö) == '.') {

47008 
mul
 = 1000, 
ms
 = 0;

47009 ++
p
 < 
•
->
Àn
) {

47010 
c
 = 
	`°rög_gë
(
•
, 
p
);

47011 i‡(!(
c
 >= '0' && c <= '9'))

47013 i‡(
mul
 =1 && 
c
 >= '5')

47014 
ms
 += 1;

47015 
ms
 +(
c
 - '0'Ë* (
mul
 /= 10);

47017 
fõlds
[6] = 
ms
;

47019 
fõlds
[1] -= 1;

47022 
tz
 = 0;

47023 i‡(
p
 < 
•
->
Àn
) {

47024 
sgn
 = 
	`°rög_gë
(
•
, 
p
);

47025 i‡(
sgn
 == '+' || sgn == '-') {

47026 i‡(
	`°rög_gë_fõld
(
•
, &
p
, &
hh
))

47027 
d⁄e
;

47028 i‡(
	`°rög_gë_fõld
(
•
, &
p
, &
mm
))

47029 
d⁄e
;

47030 
tz
 = 
hh
 * 60 + 
mm
;

47031 i‡(
sgn
 == '-')

47032 
tz
 = -tz;

47033 
is_loˇl
 = 
FALSE
;

47034 } i‡(
sgn
 == 'Z') {

47035 
is_loˇl
 = 
FALSE
;

47041 
	`°rög_skù_n⁄_•a˚s
(
•
, &
p
);

47042 
	`°rög_skù_•a˚s
(
•
, &
p
);

47043 i‡(
p
 >
•
->
Àn
)

47044 
d⁄e
;

47045 
c
 = 
	`°rög_gë
(
•
, 
p
);

47046 i‡(
c
 >= '0' && c <= '9') {

47048 i‡(
	`°rög_gë_fõld
(
•
, &
p
, &
fõlds
[2]))

47049 
d⁄e
;

47050 i‡(
	`°rög_gë_m⁄th
(
•
, &
p
, &
fõlds
[1]))

47051 
d⁄e
;

47054 i‡(
	`°rög_gë_m⁄th
(
•
, &
p
, &
fõlds
[1]))

47055 
d⁄e
;

47056 i‡(
	`°rög_gë_fõld
(
•
, &
p
, &
fõlds
[2]))

47057 
d⁄e
;

47059 
	`°rög_skù_•a˚s
(
•
, &
p
);

47060 i‡(
	`°rög_gë_sig√d_fõld
(
•
, &
p
, &
fõlds
[0]))

47061 
d⁄e
;

47064 
i
 = 0; i < 3; i++) {

47065 i‡(
	`°rög_gë_fõld
(
•
, &
p
, &
fõlds
[3 + 
i
]))

47066 
d⁄e
;

47071 
is_loˇl
 = 
FALSE
;

47072 
tz
 = 0;

47073 
tz
 = 0; 
p
 < 
•
->
Àn
;Ö++) {

47074 
sgn
 = 
	`°rög_gë
(
•
, 
p
);

47075 i‡(
sgn
 == '+' || sgn == '-') {

47076 
p
++;

47077 i‡(
	`°rög_gë_digôs
(
•
, &
p
, 2, &
hh
))

47078 
d⁄e
;

47079 i‡(
	`°rög_gë_digôs
(
•
, &
p
, 2, &
mm
))

47080 
d⁄e
;

47081 
tz
 = 
hh
 * 60 + 
mm
;

47082 i‡(
sgn
 == '-')

47083 
tz
 = -tz;

47088 
d
 = 
	`£t_d©e_fõlds
(
fõlds
, 
is_loˇl
Ë- 
tz
 * 60000;

47089 
rv
 = 
	`__JS_NewFlﬂt64
(
˘x
, 
d
);

47091 
d⁄e
:

47092 
	`JS_FªeVÆue
(
˘x
, 
s
);

47093  
rv
;

47094 
	}
}

47096 
JSVÆue
 
	$js_D©e_now
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

47097 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

47100  
	`JS_NewI¡64
(
˘x
, 
	`d©e_now
());

47101 
	}
}

47103 
JSVÆue
 
	$js_d©e_Symbﬁ_toPrimôive
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

47104 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

47107 
JSVÆueC⁄°
 
obj
 = 
this_vÆ
;

47108 
JSAtom
 
höt
 = 
JS_ATOM_NULL
;

47109 
höt_num
;

47111 i‡(!
	`JS_IsObje˘
(
obj
))

47112  
	`JS_ThrowTy≥Eº‹NŸAnObje˘
(
˘x
);

47114 i‡(
	`JS_IsSåög
(
¨gv
[0])) {

47115 
höt
 = 
	`JS_VÆueToAtom
(
˘x
, 
¨gv
[0]);

47116 i‡(
höt
 =
JS_ATOM_NULL
)

47117  
JS_EXCEPTION
;

47118 
	`JS_FªeAtom
(
˘x
, 
höt
);

47120 
höt
) {

47121 
JS_ATOM_numbî
:

47122 #ifde‡
CONFIG_BIGNUM


47123 
JS_ATOM_öãgî
:

47125 
höt_num
 = 
HINT_NUMBER
;

47127 
JS_ATOM_°rög
:

47128 
JS_ATOM_deÁu…
:

47129 
höt_num
 = 
HINT_STRING
;

47132  
	`JS_ThrowTy≥Eº‹
(
˘x
, "invalid hint");

47134  
	`JS_ToPrimôive
(
˘x
, 
obj
, 
höt_num
 | 
HINT_FORCE_ORDINARY
);

47135 
	}
}

47137 
JSVÆue
 
	$js_d©e_gëTimez⁄eOff£t
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

47138 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

47141 
v
;

47143 i‡(
	`JS_ThisTimeVÆue
(
˘x
, &
v
, 
this_vÆ
))

47144  
JS_EXCEPTION
;

47145 i‡(
	`i¢™
(
v
))

47146  
JS_NAN
;

47148  
	`JS_NewI¡64
(
˘x
, 
	`gëTimez⁄eOff£t
((
söt64_t
)
	`åunc
(
v
)));

47149 
	}
}

47151 
JSVÆue
 
	$js_d©e_gëTime
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

47152 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

47155 
v
;

47157 i‡(
	`JS_ThisTimeVÆue
(
˘x
, &
v
, 
this_vÆ
))

47158  
JS_EXCEPTION
;

47159  
	`__JS_NewFlﬂt64
(
˘x
, 
v
);

47160 
	}
}

47162 
JSVÆue
 
	$js_d©e_£tTime
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

47163 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

47166 
v
;

47168 i‡(
	`JS_ThisTimeVÆue
(
˘x
, &
v
, 
this_vÆ
Ë|| 
	`JS_ToFlﬂt64
(˘x, &v, 
¨gv
[0]))

47169  
JS_EXCEPTION
;

47170  
	`JS_SëThisTimeVÆue
(
˘x
, 
this_vÆ
, 
	`time_˛ù
(
v
));

47171 
	}
}

47173 
JSVÆue
 
	$js_d©e_£tYór
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

47174 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

47177 
y
;

47178 
JSVÆueC⁄°
 
¨gs
[1];

47180 i‡(
	`JS_ThisTimeVÆue
(
˘x
, &
y
, 
this_vÆ
Ë|| 
	`JS_ToFlﬂt64
(˘x, &y, 
¨gv
[0]))

47181  
JS_EXCEPTION
;

47182 
y
 = +y;

47183 i‡(
	`isföôe
(
y
)) {

47184 
y
 = 
	`åunc
(y);

47185 i‡(
y
 >= 0 && y < 100)

47186 
y
 += 1900;

47188 
¨gs
[0] = 
	`__JS_NewFlﬂt64
(
˘x
, 
y
);

47189  
	`£t_d©e_fõld
(
˘x
, 
this_vÆ
, 1, 
¨gs
, 0x011);

47190 
	}
}

47192 
JSVÆue
 
	$js_d©e_toJSON
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

47193 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

47196 
JSVÆue
 
obj
, 
tv
, 
mëhod
, 
rv
;

47197 
d
;

47199 
rv
 = 
JS_EXCEPTION
;

47200 
tv
 = 
JS_UNDEFINED
;

47202 
obj
 = 
	`JS_ToObje˘
(
˘x
, 
this_vÆ
);

47203 
tv
 = 
	`JS_ToPrimôive
(
˘x
, 
obj
, 
HINT_NUMBER
);

47204 i‡(
	`JS_IsEx˚±i⁄
(
tv
))

47205 
ex˚±i⁄
;

47206 i‡(
	`JS_IsNumbî
(
tv
)) {

47207 i‡(
	`JS_ToFlﬂt64
(
˘x
, &
d
, 
tv
) < 0)

47208 
ex˚±i⁄
;

47209 i‡(!
	`isföôe
(
d
)) {

47210 
rv
 = 
JS_NULL
;

47211 
d⁄e
;

47214 
mëhod
 = 
	`JS_GëPr›îtySå
(
˘x
, 
obj
, "toISOString");

47215 i‡(
	`JS_IsEx˚±i⁄
(
mëhod
))

47216 
ex˚±i⁄
;

47217 i‡(!
	`JS_IsFun˘i⁄
(
˘x
, 
mëhod
)) {

47218 
	`JS_ThrowTy≥Eº‹
(
˘x
, "objectÇeedsÅoISOString method");

47219 
	`JS_FªeVÆue
(
˘x
, 
mëhod
);

47220 
ex˚±i⁄
;

47222 
rv
 = 
	`JS_CÆlFªe
(
˘x
, 
mëhod
, 
obj
, 0, 
NULL
);

47223 
ex˚±i⁄
:

47224 
d⁄e
:

47225 
	`JS_FªeVÆue
(
˘x
, 
obj
);

47226 
	`JS_FªeVÆue
(
˘x
, 
tv
);

47227  
rv
;

47228 
	}
}

47230 c⁄° 
JSCFun˘i⁄Li°E¡ry
 
	gjs_d©e_funcs
[] = {

47231 
JS_CFUNC_DEF
("now", 0, 
js_D©e_now
 ),

47232 
JS_CFUNC_DEF
("∑r£", 1, 
js_D©e_∑r£
 ),

47233 
JS_CFUNC_DEF
("UTC", 7, 
js_D©e_UTC
 ),

47236 c⁄° 
JSCFun˘i⁄Li°E¡ry
 
	gjs_d©e_¥Ÿo_funcs
[] = {

47237 
JS_CFUNC_DEF
("vÆueOf", 0, 
js_d©e_gëTime
 ),

47238 
JS_CFUNC_MAGIC_DEF
("toSåög", 0, 
gë_d©e_°rög
, 0x13 ),

47239 
JS_CFUNC_DEF
("[Symbﬁ.toPrimôive]", 1, 
js_d©e_Symbﬁ_toPrimôive
 ),

47240 
JS_CFUNC_MAGIC_DEF
("toUTCSåög", 0, 
gë_d©e_°rög
, 0x03 ),

47241 
JS_ALIAS_DEF
("toGMTString", "toUTCString" ),

47242 
JS_CFUNC_MAGIC_DEF
("toISOSåög", 0, 
gë_d©e_°rög
, 0x23 ),

47243 
JS_CFUNC_MAGIC_DEF
("toD©eSåög", 0, 
gë_d©e_°rög
, 0x11 ),

47244 
JS_CFUNC_MAGIC_DEF
("toTimeSåög", 0, 
gë_d©e_°rög
, 0x12 ),

47245 
JS_CFUNC_MAGIC_DEF
("toLoˇÀSåög", 0, 
gë_d©e_°rög
, 0x33 ),

47246 
JS_CFUNC_MAGIC_DEF
("toLoˇÀD©eSåög", 0, 
gë_d©e_°rög
, 0x31 ),

47247 
JS_CFUNC_MAGIC_DEF
("toLoˇÀTimeSåög", 0, 
gë_d©e_°rög
, 0x32 ),

47248 
JS_CFUNC_DEF
("gëTimez⁄eOff£t", 0, 
js_d©e_gëTimez⁄eOff£t
 ),

47249 
JS_CFUNC_DEF
("gëTime", 0, 
js_d©e_gëTime
 ),

47250 
JS_CFUNC_MAGIC_DEF
("gëYór", 0, 
gë_d©e_fõld
, 0x101 ),

47251 
JS_CFUNC_MAGIC_DEF
("gëFuŒYór", 0, 
gë_d©e_fõld
, 0x01 ),

47252 
JS_CFUNC_MAGIC_DEF
("gëUTCFuŒYór", 0, 
gë_d©e_fõld
, 0x00 ),

47253 
JS_CFUNC_MAGIC_DEF
("gëM⁄th", 0, 
gë_d©e_fõld
, 0x11 ),

47254 
JS_CFUNC_MAGIC_DEF
("gëUTCM⁄th", 0, 
gë_d©e_fõld
, 0x10 ),

47255 
JS_CFUNC_MAGIC_DEF
("gëD©e", 0, 
gë_d©e_fõld
, 0x21 ),

47256 
JS_CFUNC_MAGIC_DEF
("gëUTCD©e", 0, 
gë_d©e_fõld
, 0x20 ),

47257 
JS_CFUNC_MAGIC_DEF
("gëHours", 0, 
gë_d©e_fõld
, 0x31 ),

47258 
JS_CFUNC_MAGIC_DEF
("gëUTCHours", 0, 
gë_d©e_fõld
, 0x30 ),

47259 
JS_CFUNC_MAGIC_DEF
("gëMöuãs", 0, 
gë_d©e_fõld
, 0x41 ),

47260 
JS_CFUNC_MAGIC_DEF
("gëUTCMöuãs", 0, 
gë_d©e_fõld
, 0x40 ),

47261 
JS_CFUNC_MAGIC_DEF
("gëSec⁄ds", 0, 
gë_d©e_fõld
, 0x51 ),

47262 
JS_CFUNC_MAGIC_DEF
("gëUTCSec⁄ds", 0, 
gë_d©e_fõld
, 0x50 ),

47263 
JS_CFUNC_MAGIC_DEF
("gëMûli£c⁄ds", 0, 
gë_d©e_fõld
, 0x61 ),

47264 
JS_CFUNC_MAGIC_DEF
("gëUTCMûli£c⁄ds", 0, 
gë_d©e_fõld
, 0x60 ),

47265 
JS_CFUNC_MAGIC_DEF
("gëDay", 0, 
gë_d©e_fõld
, 0x71 ),

47266 
JS_CFUNC_MAGIC_DEF
("gëUTCDay", 0, 
gë_d©e_fõld
, 0x70 ),

47267 
JS_CFUNC_DEF
("£tTime", 1, 
js_d©e_£tTime
 ),

47268 
JS_CFUNC_MAGIC_DEF
("£tMûli£c⁄ds", 1, 
£t_d©e_fõld
, 0x671 ),

47269 
JS_CFUNC_MAGIC_DEF
("£tUTCMûli£c⁄ds", 1, 
£t_d©e_fõld
, 0x670 ),

47270 
JS_CFUNC_MAGIC_DEF
("£tSec⁄ds", 2, 
£t_d©e_fõld
, 0x571 ),

47271 
JS_CFUNC_MAGIC_DEF
("£tUTCSec⁄ds", 2, 
£t_d©e_fõld
, 0x570 ),

47272 
JS_CFUNC_MAGIC_DEF
("£tMöuãs", 3, 
£t_d©e_fõld
, 0x471 ),

47273 
JS_CFUNC_MAGIC_DEF
("£tUTCMöuãs", 3, 
£t_d©e_fõld
, 0x470 ),

47274 
JS_CFUNC_MAGIC_DEF
("£tHours", 4, 
£t_d©e_fõld
, 0x371 ),

47275 
JS_CFUNC_MAGIC_DEF
("£tUTCHours", 4, 
£t_d©e_fõld
, 0x370 ),

47276 
JS_CFUNC_MAGIC_DEF
("£tD©e", 1, 
£t_d©e_fõld
, 0x231 ),

47277 
JS_CFUNC_MAGIC_DEF
("£tUTCD©e", 1, 
£t_d©e_fõld
, 0x230 ),

47278 
JS_CFUNC_MAGIC_DEF
("£tM⁄th", 2, 
£t_d©e_fõld
, 0x131 ),

47279 
JS_CFUNC_MAGIC_DEF
("£tUTCM⁄th", 2, 
£t_d©e_fõld
, 0x130 ),

47280 
JS_CFUNC_DEF
("£tYór", 1, 
js_d©e_£tYór
 ),

47281 
JS_CFUNC_MAGIC_DEF
("£tFuŒYór", 3, 
£t_d©e_fõld
, 0x031 ),

47282 
JS_CFUNC_MAGIC_DEF
("£tUTCFuŒYór", 3, 
£t_d©e_fõld
, 0x030 ),

47283 
JS_CFUNC_DEF
("toJSON", 1, 
js_d©e_toJSON
 ),

47286 
	$JS_AddI¡rösicD©e
(
JSC⁄ãxt
 *
˘x
)

47288 
JSVÆueC⁄°
 
obj
;

47291 
˘x
->
˛ass_¥Ÿo
[
JS_CLASS_DATE
] = 
	`JS_NewObje˘
(ctx);

47292 
	`JS_SëPr›îtyFun˘i⁄Li°
(
˘x
, ctx->
˛ass_¥Ÿo
[
JS_CLASS_DATE
], 
js_d©e_¥Ÿo_funcs
,

47293 
	`cou¡of
(
js_d©e_¥Ÿo_funcs
));

47294 
obj
 = 
	`JS_NewGlobÆCC⁄°ru˘‹
(
˘x
, "D©e", 
js_d©e_c⁄°ru˘‹
, 7,

47295 
˘x
->
˛ass_¥Ÿo
[
JS_CLASS_DATE
]);

47296 
	`JS_SëPr›îtyFun˘i⁄Li°
(
˘x
, 
obj
, 
js_d©e_funcs
, 
	`cou¡of
(js_date_funcs));

47297 
	}
}

47301 
	$JS_AddI¡rösicEvÆ
(
JSC⁄ãxt
 *
˘x
)

47303 
˘x
->
evÆ_öã∫Æ
 = 
__JS_EvÆI¡î«l
;

47304 
	}
}

47306 #ifde‡
CONFIG_BIGNUM


47310 
	$js_›î©‹_£t_föÆizî
(
JSRu¡ime
 *
π
, 
JSVÆue
 
vÆ
)

47312 
JSO≥øt‹SëD©a
 *
›£t
 = 
	`JS_GëO∑que
(
vÆ
, 
JS_CLASS_OPERATOR_SET
);

47313 
i
, 
j
;

47314 
JSBö¨yO≥øt‹DefE¡ry
 *
ít
;

47316 i‡(
›£t
) {

47317 
i
 = 0; i < 
JS_OVOP_COUNT
; i++) {

47318 i‡(
›£t
->
£lf_›s
[
i
])

47319 
	`JS_FªeVÆueRT
(
π
, 
	`JS_MKPTR
(
JS_TAG_OBJECT
, 
›£t
->
£lf_›s
[
i
]));

47321 
j
 = 0; j < 
›£t
->
À·
.
cou¡
; j++) {

47322 
ít
 = &
›£t
->
À·
.
èb
[
j
];

47323 
i
 = 0; i < 
JS_OVOP_BINARY_COUNT
; i++) {

47324 i‡(
ít
->
›s
[
i
])

47325 
	`JS_FªeVÆueRT
(
π
, 
	`JS_MKPTR
(
JS_TAG_OBJECT
, 
ít
->
›s
[
i
]));

47328 
	`js_‰ì_π
(
π
, 
›£t
->
À·
.
èb
);

47329 
j
 = 0; j < 
›£t
->
right
.
cou¡
; j++) {

47330 
ít
 = &
›£t
->
right
.
èb
[
j
];

47331 
i
 = 0; i < 
JS_OVOP_BINARY_COUNT
; i++) {

47332 i‡(
ít
->
›s
[
i
])

47333 
	`JS_FªeVÆueRT
(
π
, 
	`JS_MKPTR
(
JS_TAG_OBJECT
, 
ít
->
›s
[
i
]));

47336 
	`js_‰ì_π
(
π
, 
›£t
->
right
.
èb
);

47337 
	`js_‰ì_π
(
π
, 
›£t
);

47339 
	}
}

47341 
	$js_›î©‹_£t_m¨k
(
JSRu¡ime
 *
π
, 
JSVÆueC⁄°
 
vÆ
,

47342 
JS_M¨kFunc
 *
m¨k_func
)

47344 
JSO≥øt‹SëD©a
 *
›£t
 = 
	`JS_GëO∑que
(
vÆ
, 
JS_CLASS_OPERATOR_SET
);

47345 
i
, 
j
;

47346 
JSBö¨yO≥øt‹DefE¡ry
 *
ít
;

47348 i‡(
›£t
) {

47349 
i
 = 0; i < 
JS_OVOP_COUNT
; i++) {

47350 i‡(
›£t
->
£lf_›s
[
i
])

47351 
	`JS_M¨kVÆue
(
π
, 
	`JS_MKPTR
(
JS_TAG_OBJECT
, 
›£t
->
£lf_›s
[
i
]),

47352 
m¨k_func
);

47354 
j
 = 0; j < 
›£t
->
À·
.
cou¡
; j++) {

47355 
ít
 = &
›£t
->
À·
.
èb
[
j
];

47356 
i
 = 0; i < 
JS_OVOP_BINARY_COUNT
; i++) {

47357 i‡(
ít
->
›s
[
i
])

47358 
	`JS_M¨kVÆue
(
π
, 
	`JS_MKPTR
(
JS_TAG_OBJECT
, 
ít
->
›s
[
i
]),

47359 
m¨k_func
);

47362 
j
 = 0; j < 
›£t
->
right
.
cou¡
; j++) {

47363 
ít
 = &
›£t
->
right
.
èb
[
j
];

47364 
i
 = 0; i < 
JS_OVOP_BINARY_COUNT
; i++) {

47365 i‡(
ít
->
›s
[
i
])

47366 
	`JS_M¨kVÆue
(
π
, 
	`JS_MKPTR
(
JS_TAG_OBJECT
, 
ít
->
›s
[
i
]),

47367 
m¨k_func
);

47371 
	}
}

47375 
JSVÆue
 
	$js_›î©‹s_¸óã_öã∫Æ
(
JSC⁄ãxt
 *
˘x
,

47376 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
,

47377 
BOOL
 
is_¥imôive
)

47379 
JSVÆue
 
›£t_obj
, 
¥›
, 
obj
;

47380 
JSO≥øt‹SëD©a
 *
›£t
, *
›£t1
;

47381 
JSBö¨yO≥øt‹Def
 *
def
;

47382 
JSVÆueC⁄°
 
¨g
;

47383 
i
, 
j
;

47384 
JSBö¨yO≥øt‹DefE¡ry
 *
√w_èb
;

47385 
JSBö¨yO≥øt‹DefE¡ry
 *
ít
;

47386 
uöt32_t
 
›_cou¡
;

47388 i‡(
˘x
->
π
->
›î©‹_cou¡
 =
UINT32_MAX
) {

47389  
	`JS_ThrowTy≥Eº‹
(
˘x
, "too many operators");

47391 
›£t_obj
 = 
	`JS_NewObje˘PrŸoCœss
(
˘x
, 
JS_NULL
, 
JS_CLASS_OPERATOR_SET
);

47392 i‡(
	`JS_IsEx˚±i⁄
(
›£t_obj
))

47393 
Áû
;

47394 
›£t
 = 
	`js_mÆlocz
(
˘x
, (*opset));

47395 i‡(!
›£t
)

47396 
Áû
;

47397 
	`JS_SëO∑que
(
›£t_obj
, 
›£t
);

47398 i‡(
¨gc
 >= 1) {

47399 
¨g
 = 
¨gv
[0];

47401 
i
 = 0; i < 
JS_OVOP_COUNT
; i++) {

47402 
¥›
 = 
	`JS_GëPr›îtySå
(
˘x
, 
¨g
, 
js_ovîlﬂdabÀ_›î©‹_«mes
[
i
]);

47403 i‡(
	`JS_IsEx˚±i⁄
(
¥›
))

47404 
Áû
;

47405 i‡(!
	`JS_IsUndeföed
(
¥›
)) {

47406 i‡(
	`check_fun˘i⁄
(
˘x
, 
¥›
)) {

47407 
	`JS_FªeVÆue
(
˘x
, 
¥›
);

47408 
Áû
;

47410 
›£t
->
£lf_›s
[
i
] = 
	`JS_VALUE_GET_OBJ
(
¥›
);

47415 
j
 = 1; j < 
¨gc
; j++) {

47416 
¨g
 = 
¨gv
[
j
];

47417 
¥›
 = 
	`JS_GëPr›îtySå
(
˘x
, 
¨g
, "left");

47418 i‡(
	`JS_IsEx˚±i⁄
(
¥›
))

47419 
Áû
;

47420 
def
 = &
›£t
->
right
;

47421 i‡(
	`JS_IsUndeföed
(
¥›
)) {

47422 
¥›
 = 
	`JS_GëPr›îtySå
(
˘x
, 
¨g
, "right");

47423 i‡(
	`JS_IsEx˚±i⁄
(
¥›
))

47424 
Áû
;

47425 i‡(
	`JS_IsUndeföed
(
¥›
)) {

47426 
	`JS_ThrowTy≥Eº‹
(
˘x
, "left orÑightÖroperty must beÖresent");

47427 
Áû
;

47429 
def
 = &
›£t
->
À·
;

47432 
obj
 = 
	`JS_GëPr›îty
(
˘x
, 
¥›
, 
JS_ATOM_¥ŸŸy≥
);

47433 
	`JS_FªeVÆue
(
˘x
, 
¥›
);

47434 i‡(
	`JS_IsEx˚±i⁄
(
obj
))

47435 
Áû
;

47436 
¥›
 = 
	`JS_GëPr›îty
(
˘x
, 
obj
, 
JS_ATOM_Symbﬁ_›î©‹Së
);

47437 
	`JS_FªeVÆue
(
˘x
, 
obj
);

47438 i‡(
	`JS_IsEx˚±i⁄
(
¥›
))

47439 
Áû
;

47440 
›£t1
 = 
	`JS_GëO∑que2
(
˘x
, 
¥›
, 
JS_CLASS_OPERATOR_SET
);

47441 i‡(!
›£t1
) {

47442 
	`JS_FªeVÆue
(
˘x
, 
¥›
);

47443 
Áû
;

47445 
›_cou¡
 = 
›£t1
->
›î©‹_cou¡î
;

47446 
	`JS_FªeVÆue
(
˘x
, 
¥›
);

47449 
√w_èb
 = 
	`js_ªÆloc
(
˘x
, 
def
->
èb
,

47450 (
def
->
cou¡
 + 1Ë* (def->
èb
[0]));

47451 i‡(!
√w_èb
)

47452 
Áû
;

47453 
def
->
èb
 = 
√w_èb
;

47454 
def
->
cou¡
++;

47455 
ít
 = 
def
->
èb
 + def->
cou¡
 - 1;

47456 
	`mem£t
(
ít
, 0, (
def
->
èb
[0]));

47457 
ít
->
›î©‹_ödex
 = 
›_cou¡
;

47459 
i
 = 0; i < 
JS_OVOP_BINARY_COUNT
; i++) {

47460 
¥›
 = 
	`JS_GëPr›îtySå
(
˘x
, 
¨g
,

47461 
js_ovîlﬂdabÀ_›î©‹_«mes
[
i
]);

47462 i‡(
	`JS_IsEx˚±i⁄
(
¥›
))

47463 
Áû
;

47464 i‡(!
	`JS_IsUndeföed
(
¥›
)) {

47465 i‡(
	`check_fun˘i⁄
(
˘x
, 
¥›
)) {

47466 
	`JS_FªeVÆue
(
˘x
, 
¥›
);

47467 
Áû
;

47469 
ít
->
›s
[
i
] = 
	`JS_VALUE_GET_OBJ
(
¥›
);

47473 
›£t
->
is_¥imôive
 = is_primitive;

47474 
›£t
->
›î©‹_cou¡î
 = 
˘x
->
π
->
›î©‹_cou¡
++;

47475  
›£t_obj
;

47476 
Áû
:

47477 
	`JS_FªeVÆue
(
˘x
, 
›£t_obj
);

47478  
JS_EXCEPTION
;

47479 
	}
}

47481 
JSVÆue
 
	$js_›î©‹s_¸óã
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

47482 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

47484  
	`js_›î©‹s_¸óã_öã∫Æ
(
˘x
, 
¨gc
, 
¨gv
, 
FALSE
);

47485 
	}
}

47487 
JSVÆue
 
	$js_›î©‹s_upd©eBigI¡O≥øt‹s
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

47488 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

47490 
JSVÆue
 
›£t_obj
, 
¥›
;

47491 
JSO≥øt‹SëD©a
 *
›£t
;

47492 c⁄° 
JSOvîlﬂdabÀO≥øt‹Enum
 
›s
[2] = { 
JS_OVOP_DIV
, 
JS_OVOP_POW
 };

47493 
JSOvîlﬂdabÀO≥øt‹Enum
 
›
;

47494 
i
;

47496 
›£t_obj
 = 
	`JS_GëPr›îty
(
˘x
, ctx->
˛ass_¥Ÿo
[
JS_CLASS_BIG_INT
],

47497 
JS_ATOM_Symbﬁ_›î©‹Së
);

47498 i‡(
	`JS_IsEx˚±i⁄
(
›£t_obj
))

47499 
Áû
;

47500 
›£t
 = 
	`JS_GëO∑que2
(
˘x
, 
›£t_obj
, 
JS_CLASS_OPERATOR_SET
);

47501 i‡(!
›£t
)

47502 
Áû
;

47503 
i
 = 0; i < 
	`cou¡of
(
›s
); i++) {

47504 
›
 = 
›s
[
i
];

47505 
¥›
 = 
	`JS_GëPr›îtySå
(
˘x
, 
¨gv
[0],

47506 
js_ovîlﬂdabÀ_›î©‹_«mes
[
›
]);

47507 i‡(
	`JS_IsEx˚±i⁄
(
¥›
))

47508 
Áû
;

47509 i‡(!
	`JS_IsUndeföed
(
¥›
)) {

47510 i‡(!
	`JS_IsNuŒ
(
¥›
Ë&& 
	`check_fun˘i⁄
(
˘x
,Örop)) {

47511 
	`JS_FªeVÆue
(
˘x
, 
¥›
);

47512 
Áû
;

47514 i‡(
›£t
->
£lf_›s
[
›
])

47515 
	`JS_FªeVÆue
(
˘x
, 
	`JS_MKPTR
(
JS_TAG_OBJECT
, 
›£t
->
£lf_›s
[
›
]));

47516 i‡(
	`JS_IsNuŒ
(
¥›
)) {

47517 
›£t
->
£lf_›s
[
›
] = 
NULL
;

47519 
›£t
->
£lf_›s
[
›
] = 
	`JS_VALUE_GET_PTR
(
¥›
);

47523 
	`JS_FªeVÆue
(
˘x
, 
›£t_obj
);

47524  
JS_UNDEFINED
;

47525 
Áû
:

47526 
	`JS_FªeVÆue
(
˘x
, 
›£t_obj
);

47527  
JS_EXCEPTION
;

47528 
	}
}

47530 
	$js_›î©‹s_£t_deÁu…
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
obj
)

47532 
JSVÆue
 
›£t_obj
;

47534 i‡(!
	`JS_IsObje˘
(
obj
))

47536 
›£t_obj
 = 
	`js_›î©‹s_¸óã_öã∫Æ
(
˘x
, 0, 
NULL
, 
TRUE
);

47537 i‡(
	`JS_IsEx˚±i⁄
(
›£t_obj
))

47540 
	`JS_DeföePr›îtyVÆue
(
˘x
, 
obj
, 
JS_ATOM_Symbﬁ_›î©‹Së
,

47541 
›£t_obj
, 0);

47543 
	}
}

47545 
JSVÆue
 
	$js_dummy_›î©‹s_˘‹
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
√w_èrgë
,

47546 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

47548  
	`js_¸óã_‰om_˘‹
(
˘x
, 
√w_èrgë
, 
JS_CLASS_OBJECT
);

47549 
	}
}

47551 
JSVÆue
 
	$js_globÆ_›î©‹s
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

47552 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

47554 
JSVÆue
 
func_obj
, 
¥Ÿo
, 
›£t_obj
;

47556 
func_obj
 = 
JS_UNDEFINED
;

47557 
¥Ÿo
 = 
	`JS_NewObje˘
(
˘x
);

47558 i‡(
	`JS_IsEx˚±i⁄
(
¥Ÿo
))

47559  
JS_EXCEPTION
;

47560 
›£t_obj
 = 
	`js_›î©‹s_¸óã_öã∫Æ
(
˘x
, 
¨gc
, 
¨gv
, 
FALSE
);

47561 i‡(
	`JS_IsEx˚±i⁄
(
›£t_obj
))

47562 
Áû
;

47563 
	`JS_DeföePr›îtyVÆue
(
˘x
, 
¥Ÿo
, 
JS_ATOM_Symbﬁ_›î©‹Së
,

47564 
›£t_obj
, 
JS_PROP_WRITABLE
 | 
JS_PROP_CONFIGURABLE
);

47565 
func_obj
 = 
	`JS_NewCFun˘i⁄2
(
˘x
, 
js_dummy_›î©‹s_˘‹
, "Operators",

47566 0, 
JS_CFUNC_c⁄°ru˘‹
, 0);

47567 i‡(
	`JS_IsEx˚±i⁄
(
func_obj
))

47568 
Áû
;

47569 
	`JS_SëC⁄°ru˘‹2
(
˘x
, 
func_obj
, 
¥Ÿo
,

47570 0, 
JS_PROP_WRITABLE
 | 
JS_PROP_CONFIGURABLE
);

47571 
	`JS_FªeVÆue
(
˘x
, 
¥Ÿo
);

47572  
func_obj
;

47573 
Áû
:

47574 
	`JS_FªeVÆue
(
˘x
, 
¥Ÿo
);

47575 
	`JS_FªeVÆue
(
˘x
, 
func_obj
);

47576  
JS_EXCEPTION
;

47577 
	}
}

47579 c⁄° 
JSCFun˘i⁄Li°E¡ry
 
	gjs_›î©‹s_funcs
[] = {

47580 
JS_CFUNC_DEF
("¸óã", 1, 
js_›î©‹s_¸óã
 ),

47581 
JS_CFUNC_DEF
("upd©eBigI¡O≥øt‹s", 2, 
js_›î©‹s_upd©eBigI¡O≥øt‹s
 ),

47585 
	$JS_AddI¡rösicO≥øt‹s
(
JSC⁄ãxt
 *
˘x
)

47587 
JSVÆue
 
obj
;

47589 
˘x
->
Ælow_›î©‹_ovîlﬂdög
 = 
TRUE
;

47590 
obj
 = 
	`JS_NewCFun˘i⁄
(
˘x
, 
js_globÆ_›î©‹s
, "Operators", 1);

47591 
	`JS_SëPr›îtyFun˘i⁄Li°
(
˘x
, 
obj
,

47592 
js_›î©‹s_funcs
,

47593 
	`cou¡of
(
js_›î©‹s_funcs
));

47594 
	`JS_DeföePr›îtyVÆue
(
˘x
, ctx->
globÆ_obj
, 
JS_ATOM_O≥øt‹s
,

47595 
obj
,

47596 
JS_PROP_WRITABLE
 | 
JS_PROP_CONFIGURABLE
);

47598 
	`js_›î©‹s_£t_deÁu…
(
˘x
, ctx->
˛ass_¥Ÿo
[
JS_CLASS_BOOLEAN
]);

47599 
	`js_›î©‹s_£t_deÁu…
(
˘x
, ctx->
˛ass_¥Ÿo
[
JS_CLASS_NUMBER
]);

47600 
	`js_›î©‹s_£t_deÁu…
(
˘x
, ctx->
˛ass_¥Ÿo
[
JS_CLASS_STRING
]);

47601 
	`js_›î©‹s_£t_deÁu…
(
˘x
, ctx->
˛ass_¥Ÿo
[
JS_CLASS_BIG_INT
]);

47602 
	`js_›î©‹s_£t_deÁu…
(
˘x
, ctx->
˛ass_¥Ÿo
[
JS_CLASS_BIG_FLOAT
]);

47603 
	`js_›î©‹s_£t_deÁu…
(
˘x
, ctx->
˛ass_¥Ÿo
[
JS_CLASS_BIG_DECIMAL
]);

47604 
	}
}

47608 
JSVÆue
 
	$JS_ToBigI¡Ct‹Fªe
(
JSC⁄ãxt
 *
˘x
, 
JSVÆue
 
vÆ
)

47610 
uöt32_t
 
èg
;

47612 
ªdo
:

47613 
èg
 = 
	`JS_VALUE_GET_NORM_TAG
(
vÆ
);

47614 
èg
) {

47615 
JS_TAG_INT
:

47616 
JS_TAG_BOOL
:

47617 
vÆ
 = 
	`JS_NewBigI¡64
(
˘x
, 
	`JS_VALUE_GET_INT
(val));

47619 
JS_TAG_BIG_INT
:

47621 
JS_TAG_FLOAT64
:

47622 
JS_TAG_BIG_FLOAT
:

47624 
bf_t
 *
a
, 
a_s
;

47626 
a
 = 
	`JS_ToBigFlﬂt
(
˘x
, &
a_s
, 
vÆ
);

47627 i‡(!
	`bf_is_föôe
(
a
)) {

47628 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

47629 
vÆ
 = 
	`JS_ThrowR™geEº‹
(
˘x
, "cannot convert NaN or InfinityÅo bigint");

47631 
JSVÆue
 
vÆ1
 = 
	`JS_NewBigI¡
(
˘x
);

47632 
bf_t
 *
r
;

47633 
ªt
;

47634 i‡(
	`JS_IsEx˚±i⁄
(
vÆ1
)) {

47635 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

47636  
JS_EXCEPTION
;

47638 
r
 = 
	`JS_GëBigI¡
(
vÆ1
);

47639 
ªt
 = 
	`bf_£t
(
r
, 
a
);

47640 
ªt
 |
	`bf_röt
(
r
, 
BF_RNDZ
);

47641 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

47642 i‡(
ªt
 & 
BF_ST_MEM_ERROR
) {

47643 
	`JS_FªeVÆue
(
˘x
, 
vÆ1
);

47644 
vÆ
 = 
	`JS_ThrowOutOfMem‹y
(
˘x
);

47645 } i‡(
ªt
 & 
BF_ST_INEXACT
) {

47646 
	`JS_FªeVÆue
(
˘x
, 
vÆ1
);

47647 
vÆ
 = 
	`JS_ThrowR™geEº‹
(
˘x
, "cannot convertÅo bigint:Çotán integer");

47649 
vÆ
 = 
	`JS_Com∑˘BigI¡
(
˘x
, 
vÆ1
);

47652 i‡(
a
 =&
a_s
)

47653 
	`bf_dñëe
(
a
);

47656 
JS_TAG_BIG_DECIMAL
:

47657 
vÆ
 = 
	`JS_ToSåögFªe
(
˘x
, val);

47658 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

47660 
ªdo
;

47661 
JS_TAG_STRING
:

47662 
vÆ
 = 
	`JS_SåögToBigI¡Eº
(
˘x
, val);

47664 
JS_TAG_OBJECT
:

47665 
vÆ
 = 
	`JS_ToPrimôiveFªe
(
˘x
, vÆ, 
HINT_NUMBER
);

47666 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

47668 
ªdo
;

47669 
JS_TAG_NULL
:

47670 
JS_TAG_UNDEFINED
:

47672 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

47673  
	`JS_ThrowTy≥Eº‹
(
˘x
, "cannot convertÅo bigint");

47675  
vÆ
;

47676 
	}
}

47678 
JSVÆue
 
	$js_bigöt_c⁄°ru˘‹
(
JSC⁄ãxt
 *
˘x
,

47679 
JSVÆueC⁄°
 
this_vÆ
,

47680 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

47682  
	`JS_ToBigI¡Ct‹Fªe
(
˘x
, 
	`JS_DupVÆue
(˘x, 
¨gv
[0]));

47683 
	}
}

47685 
JSVÆue
 
	$js_thisBigI¡VÆue
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
)

47687 i‡(
	`JS_IsBigI¡
(
˘x
, 
this_vÆ
))

47688  
	`JS_DupVÆue
(
˘x
, 
this_vÆ
);

47690 i‡(
	`JS_VALUE_GET_TAG
(
this_vÆ
Ë=
JS_TAG_OBJECT
) {

47691 
JSObje˘
 *
p
 = 
	`JS_VALUE_GET_OBJ
(
this_vÆ
);

47692 i‡(
p
->
˛ass_id
 =
JS_CLASS_BIG_INT
) {

47693 i‡(
	`JS_IsBigI¡
(
˘x
, 
p
->
u
.
obje˘_d©a
))

47694  
	`JS_DupVÆue
(
˘x
, 
p
->
u
.
obje˘_d©a
);

47697  
	`JS_ThrowTy≥Eº‹
(
˘x
, "notá bigint");

47698 
	}
}

47700 
JSVÆue
 
	$js_bigöt_toSåög
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

47701 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

47703 
JSVÆue
 
vÆ
;

47704 
ba£
;

47705 
JSVÆue
 
ªt
;

47707 
vÆ
 = 
	`js_thisBigI¡VÆue
(
˘x
, 
this_vÆ
);

47708 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

47709  
vÆ
;

47710 i‡(
¨gc
 =0 || 
	`JS_IsUndeföed
(
¨gv
[0])) {

47711 
ba£
 = 10;

47713 
ba£
 = 
	`js_gë_ødix
(
˘x
, 
¨gv
[0]);

47714 i‡(
ba£
 < 0)

47715 
Áû
;

47717 
ªt
 = 
	`js_bigöt_to_°rög1
(
˘x
, 
vÆ
, 
ba£
);

47718 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

47719  
ªt
;

47720 
Áû
:

47721 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

47722  
JS_EXCEPTION
;

47723 
	}
}

47725 
JSVÆue
 
	$js_bigöt_vÆueOf
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

47726 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

47728  
	`js_thisBigI¡VÆue
(
˘x
, 
this_vÆ
);

47729 
	}
}

47731 
JSVÆue
 
	$js_bigöt_div
(
JSC⁄ãxt
 *
˘x
,

47732 
JSVÆueC⁄°
 
this_vÆ
,

47733 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
, 
magic
)

47735 
bf_t
 
a_s
, 
b_s
, *
a
, *
b
, *
r
, *
q
;

47736 
°©us
;

47737 
JSVÆue
 
q_vÆ
, 
r_vÆ
;

47739 
q_vÆ
 = 
	`JS_NewBigI¡
(
˘x
);

47740 i‡(
	`JS_IsEx˚±i⁄
(
q_vÆ
))

47741  
JS_EXCEPTION
;

47742 
r_vÆ
 = 
	`JS_NewBigI¡
(
˘x
);

47743 i‡(
	`JS_IsEx˚±i⁄
(
r_vÆ
))

47744 
Áû
;

47745 
b
 = 
NULL
;

47746 
a
 = 
	`JS_ToBigI¡
(
˘x
, &
a_s
, 
¨gv
[0]);

47747 i‡(!
a
)

47748 
Áû
;

47749 
b
 = 
	`JS_ToBigI¡
(
˘x
, &
b_s
, 
¨gv
[1]);

47750 i‡(!
b
) {

47751 
	`JS_FªeBigI¡
(
˘x
, 
a
, &
a_s
);

47752 
Áû
;

47754 
q
 = 
	`JS_GëBigI¡
(
q_vÆ
);

47755 
r
 = 
	`JS_GëBigI¡
(
r_vÆ
);

47756 
°©us
 = 
	`bf_divªm
(
q
, 
r
, 
a
, 
b
, 
BF_PREC_INF
, 
BF_RNDZ
, 
magic
 & 0xf);

47757 
	`JS_FªeBigI¡
(
˘x
, 
a
, &
a_s
);

47758 
	`JS_FªeBigI¡
(
˘x
, 
b
, &
b_s
);

47759 i‡(
	`u∆ikñy
(
°©us
)) {

47760 
	`throw_bf_ex˚±i⁄
(
˘x
, 
°©us
);

47761 
Áû
;

47763 
q_vÆ
 = 
	`JS_Com∑˘BigI¡
(
˘x
, q_val);

47764 i‡(
magic
 & 0x10) {

47765 
JSVÆue
 
ªt
;

47766 
ªt
 = 
	`JS_NewAºay
(
˘x
);

47767 i‡(
	`JS_IsEx˚±i⁄
(
ªt
))

47768 
Áû
;

47769 
	`JS_SëPr›îtyUöt32
(
˘x
, 
ªt
, 0, 
q_vÆ
);

47770 
	`JS_SëPr›îtyUöt32
(
˘x
, 
ªt
, 1, 
	`JS_Com∑˘BigI¡
(˘x, 
r_vÆ
));

47771  
ªt
;

47773 
	`JS_FªeVÆue
(
˘x
, 
r_vÆ
);

47774  
q_vÆ
;

47776 
Áû
:

47777 
	`JS_FªeVÆue
(
˘x
, 
q_vÆ
);

47778 
	`JS_FªeVÆue
(
˘x
, 
r_vÆ
);

47779  
JS_EXCEPTION
;

47780 
	}
}

47782 
JSVÆue
 
	$js_bigöt_sqπ
(
JSC⁄ãxt
 *
˘x
,

47783 
JSVÆueC⁄°
 
this_vÆ
,

47784 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
, 
magic
)

47786 
bf_t
 
a_s
, *
a
, *
r
, *
ªm
;

47787 
°©us
;

47788 
JSVÆue
 
r_vÆ
, 
ªm_vÆ
;

47790 
r_vÆ
 = 
	`JS_NewBigI¡
(
˘x
);

47791 i‡(
	`JS_IsEx˚±i⁄
(
r_vÆ
))

47792  
JS_EXCEPTION
;

47793 
ªm_vÆ
 = 
	`JS_NewBigI¡
(
˘x
);

47794 i‡(
	`JS_IsEx˚±i⁄
(
ªm_vÆ
))

47795  
JS_EXCEPTION
;

47796 
r
 = 
	`JS_GëBigI¡
(
r_vÆ
);

47797 
ªm
 = 
	`JS_GëBigI¡
(
ªm_vÆ
);

47799 
a
 = 
	`JS_ToBigI¡
(
˘x
, &
a_s
, 
¨gv
[0]);

47800 i‡(!
a
)

47801 
Áû
;

47802 
°©us
 = 
	`bf_sqπªm
(
r
, 
ªm
, 
a
);

47803 
	`JS_FªeBigI¡
(
˘x
, 
a
, &
a_s
);

47804 i‡(
	`u∆ikñy
(
°©us
 & ~
BF_ST_INEXACT
)) {

47805 
	`throw_bf_ex˚±i⁄
(
˘x
, 
°©us
);

47806 
Áû
;

47808 
r_vÆ
 = 
	`JS_Com∑˘BigI¡
(
˘x
,Ñ_val);

47809 i‡(
magic
) {

47810 
JSVÆue
 
ªt
;

47811 
ªt
 = 
	`JS_NewAºay
(
˘x
);

47812 i‡(
	`JS_IsEx˚±i⁄
(
ªt
))

47813 
Áû
;

47814 
	`JS_SëPr›îtyUöt32
(
˘x
, 
ªt
, 0, 
r_vÆ
);

47815 
	`JS_SëPr›îtyUöt32
(
˘x
, 
ªt
, 1, 
	`JS_Com∑˘BigI¡
(˘x, 
ªm_vÆ
));

47816  
ªt
;

47818 
	`JS_FªeVÆue
(
˘x
, 
ªm_vÆ
);

47819  
r_vÆ
;

47821 
Áû
:

47822 
	`JS_FªeVÆue
(
˘x
, 
r_vÆ
);

47823 
	`JS_FªeVÆue
(
˘x
, 
ªm_vÆ
);

47824  
JS_EXCEPTION
;

47825 
	}
}

47827 
JSVÆue
 
	$js_bigöt_›1
(
JSC⁄ãxt
 *
˘x
,

47828 
JSVÆueC⁄°
 
this_vÆ
,

47829 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
,

47830 
magic
)

47832 
bf_t
 
a_s
, *
a
;

47833 
öt64_t
 
ªs
;

47835 
a
 = 
	`JS_ToBigI¡
(
˘x
, &
a_s
, 
¨gv
[0]);

47836 i‡(!
a
)

47837  
JS_EXCEPTION
;

47838 
magic
) {

47840 i‡(
a
->
sign
 ||á->
ex≤
 <= 0) {

47841 
ªs
 = -1;

47843 
ªs
 = 
a
->
ex≤
 - 1;

47847 i‡(
	`bf_is_zîo
(
a
)) {

47848 
ªs
 = -1;

47850 
ªs
 = 
	`bf_gë_exp_mö
(
a
);

47854 
	`ab‹t
();

47856 
	`JS_FªeBigI¡
(
˘x
, 
a
, &
a_s
);

47857  
	`JS_NewBigI¡64
(
˘x
, 
ªs
);

47858 
	}
}

47860 
JSVÆue
 
	$js_bigöt_asUötN
(
JSC⁄ãxt
 *
˘x
,

47861 
JSVÆueC⁄°
 
this_vÆ
,

47862 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
, 
asI¡N
)

47864 
uöt64_t
 
bôs
;

47865 
bf_t
 
a_s
, *
a
 = &a_s, *
r
, 
mask_s
, *
mask
 = &mask_s;

47866 
JSVÆue
 
ªs
;

47868 i‡(
	`JS_ToIndex
(
˘x
, &
bôs
, 
¨gv
[0]))

47869  
JS_EXCEPTION
;

47870 
ªs
 = 
	`JS_NewBigI¡
(
˘x
);

47871 i‡(
	`JS_IsEx˚±i⁄
(
ªs
))

47872  
JS_EXCEPTION
;

47873 
r
 = 
	`JS_GëBigI¡
(
ªs
);

47874 
a
 = 
	`JS_ToBigI¡
(
˘x
, &
a_s
, 
¨gv
[1]);

47875 i‡(!
a
) {

47876 
	`JS_FªeVÆue
(
˘x
, 
ªs
);

47877  
JS_EXCEPTION
;

47880 
r
 = 
	`JS_GëBigI¡
(
ªs
);

47881 
	`bf_öô
(
˘x
->
bf_˘x
, 
mask
);

47882 
	`bf_£t_ui
(
mask
, 1);

47883 
	`bf_mul_2exp
(
mask
, 
bôs
, 
BF_PREC_INF
, 
BF_RNDZ
);

47884 
	`bf_add_si
(
mask
, mask, -1, 
BF_PREC_INF
, 
BF_RNDZ
);

47885 
	`bf_logic_™d
(
r
, 
a
, 
mask
);

47886 i‡(
asI¡N
 && 
bôs
 != 0) {

47887 
	`bf_£t_ui
(
mask
, 1);

47888 
	`bf_mul_2exp
(
mask
, 
bôs
 - 1, 
BF_PREC_INF
, 
BF_RNDZ
);

47889 i‡(
	`bf_cmpu
(
r
, 
mask
) >= 0) {

47890 
	`bf_£t_ui
(
mask
, 1);

47891 
	`bf_mul_2exp
(
mask
, 
bôs
, 
BF_PREC_INF
, 
BF_RNDZ
);

47892 
	`bf_sub
(
r
,Ñ, 
mask
, 
BF_PREC_INF
, 
BF_RNDZ
);

47895 
	`bf_dñëe
(
mask
);

47896 
	`JS_FªeBigI¡
(
˘x
, 
a
, &
a_s
);

47897  
	`JS_Com∑˘BigI¡
(
˘x
, 
ªs
);

47898 
	}
}

47900 c⁄° 
JSCFun˘i⁄Li°E¡ry
 
	gjs_bigöt_funcs
[] = {

47901 
JS_CFUNC_MAGIC_DEF
("asUötN", 2, 
js_bigöt_asUötN
, 0 ),

47902 
JS_CFUNC_MAGIC_DEF
("asI¡N", 2, 
js_bigöt_asUötN
, 1 ),

47904 
JS_CFUNC_MAGIC_DEF
("tdiv", 2, 
js_bigöt_div
, 
BF_RNDZ
 ),

47905 
JS_CFUNC_MAGIC_DEF
("fdiv", 2, 
js_bigöt_div
, 
BF_RNDD
 ),

47906 
JS_CFUNC_MAGIC_DEF
("cdiv", 2, 
js_bigöt_div
, 
BF_RNDU
 ),

47907 
JS_CFUNC_MAGIC_DEF
("ediv", 2, 
js_bigöt_div
, 
BF_DIVREM_EUCLIDIAN
 ),

47908 
JS_CFUNC_MAGIC_DEF
("tdivªm", 2, 
js_bigöt_div
, 
BF_RNDZ
 | 0x10 ),

47909 
JS_CFUNC_MAGIC_DEF
("fdivªm", 2, 
js_bigöt_div
, 
BF_RNDD
 | 0x10 ),

47910 
JS_CFUNC_MAGIC_DEF
("cdivªm", 2, 
js_bigöt_div
, 
BF_RNDU
 | 0x10 ),

47911 
JS_CFUNC_MAGIC_DEF
("edivªm", 2, 
js_bigöt_div
, 
BF_DIVREM_EUCLIDIAN
 | 0x10 ),

47912 
JS_CFUNC_MAGIC_DEF
("sqπ", 1, 
js_bigöt_sqπ
, 0 ),

47913 
JS_CFUNC_MAGIC_DEF
("sqπªm", 1, 
js_bigöt_sqπ
, 1 ),

47914 
JS_CFUNC_MAGIC_DEF
("Êo‹Log2", 1, 
js_bigöt_›1
, 0 ),

47915 
JS_CFUNC_MAGIC_DEF
("˘z", 1, 
js_bigöt_›1
, 1 ),

47918 c⁄° 
JSCFun˘i⁄Li°E¡ry
 
	gjs_bigöt_¥Ÿo_funcs
[] = {

47919 
JS_CFUNC_DEF
("toSåög", 0, 
js_bigöt_toSåög
 ),

47920 
JS_CFUNC_DEF
("vÆueOf", 0, 
js_bigöt_vÆueOf
 ),

47921 
JS_PROP_STRING_DEF
("[Symbﬁ.toSåögTag]", "BigI¡", 
JS_PROP_CONFIGURABLE
 ),

47924 
	$JS_AddI¡rösicBigI¡
(
JSC⁄ãxt
 *
˘x
)

47926 
JSRu¡ime
 *
π
 = 
˘x
->rt;

47927 
JSVÆue
 
obj1
;

47929 
π
->
bigöt_›s
.
to_°rög
 = 
js_bigöt_to_°rög
;

47930 
π
->
bigöt_›s
.
‰om_°rög
 = 
js_°rög_to_bigöt
;

47931 
π
->
bigöt_›s
.
u«ry_¨ôh
 = 
js_u«ry_¨ôh_bigöt
;

47932 
π
->
bigöt_›s
.
bö¨y_¨ôh
 = 
js_bö¨y_¨ôh_bigöt
;

47933 
π
->
bigöt_›s
.
com∑ª
 = 
js_com∑ª_bigÊﬂt
;

47935 
˘x
->
˛ass_¥Ÿo
[
JS_CLASS_BIG_INT
] = 
	`JS_NewObje˘
(ctx);

47936 
	`JS_SëPr›îtyFun˘i⁄Li°
(
˘x
, ctx->
˛ass_¥Ÿo
[
JS_CLASS_BIG_INT
],

47937 
js_bigöt_¥Ÿo_funcs
,

47938 
	`cou¡of
(
js_bigöt_¥Ÿo_funcs
));

47939 
obj1
 = 
	`JS_NewCFun˘i⁄
(
˘x
, 
js_bigöt_c⁄°ru˘‹
, "BigInt", 1);

47940 
	`JS_NewGlobÆCC⁄°ru˘‹2
(
˘x
, 
obj1
, "BigInt",

47941 
˘x
->
˛ass_¥Ÿo
[
JS_CLASS_BIG_INT
]);

47942 
	`JS_SëPr›îtyFun˘i⁄Li°
(
˘x
, 
obj1
, 
js_bigöt_funcs
,

47943 
	`cou¡of
(
js_bigöt_funcs
));

47944 
	}
}

47948 
JSVÆue
 
	$js_thisBigFlﬂtVÆue
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
)

47950 i‡(
	`JS_IsBigFlﬂt
(
this_vÆ
))

47951  
	`JS_DupVÆue
(
˘x
, 
this_vÆ
);

47953 i‡(
	`JS_VALUE_GET_TAG
(
this_vÆ
Ë=
JS_TAG_OBJECT
) {

47954 
JSObje˘
 *
p
 = 
	`JS_VALUE_GET_OBJ
(
this_vÆ
);

47955 i‡(
p
->
˛ass_id
 =
JS_CLASS_BIG_FLOAT
) {

47956 i‡(
	`JS_IsBigFlﬂt
(
p
->
u
.
obje˘_d©a
))

47957  
	`JS_DupVÆue
(
˘x
, 
p
->
u
.
obje˘_d©a
);

47960  
	`JS_ThrowTy≥Eº‹
(
˘x
, "notá bigfloat");

47961 
	}
}

47963 
JSVÆue
 
	$js_bigÊﬂt_toSåög
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

47964 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

47966 
JSVÆue
 
vÆ
;

47967 
ba£
;

47968 
JSVÆue
 
ªt
;

47970 
vÆ
 = 
	`js_thisBigFlﬂtVÆue
(
˘x
, 
this_vÆ
);

47971 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

47972  
vÆ
;

47973 i‡(
¨gc
 =0 || 
	`JS_IsUndeföed
(
¨gv
[0])) {

47974 
ba£
 = 10;

47976 
ba£
 = 
	`js_gë_ødix
(
˘x
, 
¨gv
[0]);

47977 i‡(
ba£
 < 0)

47978 
Áû
;

47980 
ªt
 = 
	`js_·ﬂ
(
˘x
, 
vÆ
, 
ba£
, 0, 
BF_RNDN
 | 
BF_FTOA_FORMAT_FREE_MIN
);

47981 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

47982  
ªt
;

47983 
Áû
:

47984 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

47985  
JS_EXCEPTION
;

47986 
	}
}

47988 
JSVÆue
 
	$js_bigÊﬂt_vÆueOf
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

47989 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

47991  
	`js_thisBigFlﬂtVÆue
(
˘x
, 
this_vÆ
);

47992 
	}
}

47994 
	$bigÊﬂt_gë_∫d_mode
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
vÆ
)

47996 
∫d_mode
;

47997 i‡(
	`JS_ToI¡32S©
(
˘x
, &
∫d_mode
, 
vÆ
))

47999 i‡(
∫d_mode
 < 
BF_RNDN
 ||Ñnd_modê> 
BF_RNDF
) {

48000 
	`JS_ThrowR™geEº‹
(
˘x
, "invalidÑounding mode");

48003  
∫d_mode
;

48004 
	}
}

48006 
JSVÆue
 
	$js_bigÊﬂt_toFixed
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

48007 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

48009 
JSVÆue
 
vÆ
, 
ªt
;

48010 
öt64_t
 
f
;

48011 
∫d_mode
, 
ødix
;

48013 
vÆ
 = 
	`js_thisBigFlﬂtVÆue
(
˘x
, 
this_vÆ
);

48014 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

48015  
vÆ
;

48016 i‡(
	`JS_ToI¡64S©
(
˘x
, &
f
, 
¨gv
[0]))

48017 
Áû
;

48018 i‡(
f
 < 0 || f > 
BF_PREC_MAX
) {

48019 
	`JS_ThrowR™geEº‹
(
˘x
, "invalidÇumber of digits");

48020 
Áû
;

48022 
∫d_mode
 = 
BF_RNDNA
;

48023 
ødix
 = 10;

48025 i‡(
¨gc
 > 1) {

48026 
∫d_mode
 = 
	`bigÊﬂt_gë_∫d_mode
(
˘x
, 
¨gv
[1]);

48027 i‡(
∫d_mode
 < 0)

48028 
Áû
;

48030 i‡(
¨gc
 > 2) {

48031 
ødix
 = 
	`js_gë_ødix
(
˘x
, 
¨gv
[2]);

48032 i‡(
ødix
 < 0)

48033 
Áû
;

48035 
ªt
 = 
	`js_·ﬂ
(
˘x
, 
vÆ
, 
ødix
, 
f
, 
∫d_mode
 | 
BF_FTOA_FORMAT_FRAC
);

48036 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

48037  
ªt
;

48038 
Áû
:

48039 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

48040  
JS_EXCEPTION
;

48041 
	}
}

48043 
BOOL
 
	$js_bigÊﬂt_is_föôe
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
vÆ
)

48045 
BOOL
 
ªs
;

48046 
uöt32_t
 
èg
;

48048 
èg
 = 
	`JS_VALUE_GET_NORM_TAG
(
vÆ
);

48049 
èg
) {

48050 
JS_TAG_BIG_FLOAT
:

48052 
JSBigFlﬂt
 *
p
 = 
	`JS_VALUE_GET_PTR
(
vÆ
);

48053 
ªs
 = 
	`bf_is_föôe
(&
p
->
num
);

48057 
ªs
 = 
FALSE
;

48060  
ªs
;

48061 
	}
}

48063 
JSVÆue
 
	$js_bigÊﬂt_toExp⁄ítül
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

48064 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

48066 
JSVÆue
 
vÆ
, 
ªt
;

48067 
öt64_t
 
f
;

48068 
∫d_mode
, 
ødix
;

48070 
vÆ
 = 
	`js_thisBigFlﬂtVÆue
(
˘x
, 
this_vÆ
);

48071 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

48072  
vÆ
;

48073 i‡(
	`JS_ToI¡64S©
(
˘x
, &
f
, 
¨gv
[0]))

48074 
Áû
;

48075 i‡(!
	`js_bigÊﬂt_is_föôe
(
˘x
, 
vÆ
)) {

48076 
ªt
 = 
	`JS_ToSåög
(
˘x
, 
vÆ
);

48077 } i‡(
	`JS_IsUndeföed
(
¨gv
[0])) {

48078 
ªt
 = 
	`js_·ﬂ
(
˘x
, 
vÆ
, 10, 0,

48079 
BF_RNDN
 | 
BF_FTOA_FORMAT_FREE_MIN
 | 
BF_FTOA_FORCE_EXP
);

48081 i‡(
f
 < 0 || f > 
BF_PREC_MAX
) {

48082 
	`JS_ThrowR™geEº‹
(
˘x
, "invalidÇumber of digits");

48083 
Áû
;

48085 
∫d_mode
 = 
BF_RNDNA
;

48086 
ødix
 = 10;

48087 i‡(
¨gc
 > 1) {

48088 
∫d_mode
 = 
	`bigÊﬂt_gë_∫d_mode
(
˘x
, 
¨gv
[1]);

48089 i‡(
∫d_mode
 < 0)

48090 
Áû
;

48092 i‡(
¨gc
 > 2) {

48093 
ødix
 = 
	`js_gë_ødix
(
˘x
, 
¨gv
[2]);

48094 i‡(
ødix
 < 0)

48095 
Áû
;

48097 
ªt
 = 
	`js_·ﬂ
(
˘x
, 
vÆ
, 
ødix
, 
f
 + 1,

48098 
∫d_mode
 | 
BF_FTOA_FORMAT_FIXED
 | 
BF_FTOA_FORCE_EXP
);

48100 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

48101  
ªt
;

48102 
Áû
:

48103 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

48104  
JS_EXCEPTION
;

48105 
	}
}

48107 
JSVÆue
 
	$js_bigÊﬂt_toPªcisi⁄
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

48108 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

48110 
JSVÆue
 
vÆ
, 
ªt
;

48111 
öt64_t
 
p
;

48112 
∫d_mode
, 
ødix
;

48114 
vÆ
 = 
	`js_thisBigFlﬂtVÆue
(
˘x
, 
this_vÆ
);

48115 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

48116  
vÆ
;

48117 i‡(
	`JS_IsUndeföed
(
¨gv
[0]))

48118 
to_°rög
;

48119 i‡(
	`JS_ToI¡64S©
(
˘x
, &
p
, 
¨gv
[0]))

48120 
Áû
;

48121 i‡(!
	`js_bigÊﬂt_is_föôe
(
˘x
, 
vÆ
)) {

48122 
to_°rög
:

48123 
ªt
 = 
	`JS_ToSåög
(
˘x
, 
this_vÆ
);

48125 i‡(
p
 < 1 ||Ö > 
BF_PREC_MAX
) {

48126 
	`JS_ThrowR™geEº‹
(
˘x
, "invalidÇumber of digits");

48127 
Áû
;

48129 
∫d_mode
 = 
BF_RNDNA
;

48130 
ødix
 = 10;

48131 i‡(
¨gc
 > 1) {

48132 
∫d_mode
 = 
	`bigÊﬂt_gë_∫d_mode
(
˘x
, 
¨gv
[1]);

48133 i‡(
∫d_mode
 < 0)

48134 
Áû
;

48136 i‡(
¨gc
 > 2) {

48137 
ødix
 = 
	`js_gë_ødix
(
˘x
, 
¨gv
[2]);

48138 i‡(
ødix
 < 0)

48139 
Áû
;

48141 
ªt
 = 
	`js_·ﬂ
(
˘x
, 
vÆ
, 
ødix
, 
p
, 
∫d_mode
 | 
BF_FTOA_FORMAT_FIXED
);

48143 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

48144  
ªt
;

48145 
Áû
:

48146 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

48147  
JS_EXCEPTION
;

48148 
	}
}

48150 c⁄° 
JSCFun˘i⁄Li°E¡ry
 
	gjs_bigÊﬂt_¥Ÿo_funcs
[] = {

48151 
JS_CFUNC_DEF
("toSåög", 0, 
js_bigÊﬂt_toSåög
 ),

48152 
JS_CFUNC_DEF
("vÆueOf", 0, 
js_bigÊﬂt_vÆueOf
 ),

48153 
JS_CFUNC_DEF
("toPªcisi⁄", 1, 
js_bigÊﬂt_toPªcisi⁄
 ),

48154 
JS_CFUNC_DEF
("toFixed", 1, 
js_bigÊﬂt_toFixed
 ),

48155 
JS_CFUNC_DEF
("toExp⁄ítül", 1, 
js_bigÊﬂt_toExp⁄ítül
 ),

48158 
JSVÆue
 
	$js_bigÊﬂt_c⁄°ru˘‹
(
JSC⁄ãxt
 *
˘x
,

48159 
JSVÆueC⁄°
 
this_vÆ
,

48160 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

48162 
JSVÆue
 
vÆ
;

48163 i‡(
¨gc
 == 0) {

48164 
bf_t
 *
r
;

48165 
vÆ
 = 
	`JS_NewBigFlﬂt
(
˘x
);

48166 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

48167  
vÆ
;

48168 
r
 = 
	`JS_GëBigFlﬂt
(
vÆ
);

48169 
	`bf_£t_zîo
(
r
, 0);

48171 
vÆ
 = 
	`JS_DupVÆue
(
˘x
, 
¨gv
[0]);

48172 
ªdo
:

48173 
	`JS_VALUE_GET_NORM_TAG
(
vÆ
)) {

48174 
JS_TAG_BIG_FLOAT
:

48176 
JS_TAG_FLOAT64
:

48178 
bf_t
 *
r
;

48179 
d
 = 
	`JS_VALUE_GET_FLOAT64
(
vÆ
);

48180 
vÆ
 = 
	`JS_NewBigFlﬂt
(
˘x
);

48181 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

48183 
r
 = 
	`JS_GëBigFlﬂt
(
vÆ
);

48184 i‡(
	`bf_£t_Êﬂt64
(
r
, 
d
))

48185 
Áû
;

48188 
JS_TAG_INT
:

48190 
bf_t
 *
r
;

48191 
öt32_t
 
v
 = 
	`JS_VALUE_GET_INT
(
vÆ
);

48192 
vÆ
 = 
	`JS_NewBigFlﬂt
(
˘x
);

48193 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

48195 
r
 = 
	`JS_GëBigFlﬂt
(
vÆ
);

48196 i‡(
	`bf_£t_si
(
r
, 
v
))

48197 
Áû
;

48200 
JS_TAG_BIG_INT
:

48203 
JSBigFlﬂt
 *
p
 = 
	`JS_VALUE_GET_PTR
(
vÆ
);

48204 
vÆ
 = 
	`JS_MKPTR
(
JS_TAG_BIG_FLOAT
, 
p
);

48207 
JS_TAG_BIG_DECIMAL
:

48208 
vÆ
 = 
	`JS_ToSåögFªe
(
˘x
, val);

48209 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

48211 
ªdo
;

48212 
JS_TAG_STRING
:

48214 c⁄° *
°r
, *
p
;

48215 
size_t
 
Àn
;

48216 
îr
;

48218 
°r
 = 
	`JS_ToCSåögLí
(
˘x
, &
Àn
, 
vÆ
);

48219 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

48220 i‡(!
°r
)

48221  
JS_EXCEPTION
;

48222 
p
 = 
°r
;

48223 
p
 +
	`skù_•a˚s
(p);

48224 i‡((
p
 - 
°r
Ë=
Àn
) {

48225 
bf_t
 *
r
;

48226 
vÆ
 = 
	`JS_NewBigFlﬂt
(
˘x
);

48227 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

48229 
r
 = 
	`JS_GëBigFlﬂt
(
vÆ
);

48230 
	`bf_£t_zîo
(
r
, 0);

48231 
îr
 = 0;

48233 
vÆ
 = 
	`js_©of
(
˘x
, 
p
, &p, 0, 
ATOD_ACCEPT_BIN_OCT
 |

48234 
ATOD_TYPE_BIG_FLOAT
 |

48235 
ATOD_ACCEPT_PREFIX_AFTER_SIGN
);

48236 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
)) {

48237 
	`JS_FªeCSåög
(
˘x
, 
°r
);

48238  
JS_EXCEPTION
;

48240 
p
 +
	`skù_•a˚s
(p);

48241 
îr
 = ((
p
 - 
°r
Ë!
Àn
);

48243 
	`JS_FªeCSåög
(
˘x
, 
°r
);

48244 i‡(
îr
) {

48245 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

48246  
	`JS_ThrowSy¡axEº‹
(
˘x
, "invalid bigfloatÜiteral");

48250 
JS_TAG_OBJECT
:

48251 
vÆ
 = 
	`JS_ToPrimôiveFªe
(
˘x
, vÆ, 
HINT_NUMBER
);

48252 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

48254 
ªdo
;

48255 
JS_TAG_NULL
:

48256 
JS_TAG_UNDEFINED
:

48258 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

48259  
	`JS_ThrowTy≥Eº‹
(
˘x
, "cannot convertÅo bigfloat");

48262  
vÆ
;

48263 
Áû
:

48264 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

48265  
JS_EXCEPTION
;

48266 
	}
}

48268 
JSVÆue
 
	$js_bigÊﬂt_gë_c⁄°
(
JSC⁄ãxt
 *
˘x
,

48269 
JSVÆueC⁄°
 
this_vÆ
, 
magic
)

48271 
bf_t
 *
r
;

48272 
JSVÆue
 
vÆ
;

48273 
vÆ
 = 
	`JS_NewBigFlﬂt
(
˘x
);

48274 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

48275  
vÆ
;

48276 
r
 = 
	`JS_GëBigFlﬂt
(
vÆ
);

48277 
magic
) {

48279 
	`bf_c⁄°_pi
(
r
, 
˘x
->
Â_ív
.
¥ec
, ctx->Â_ív.
Êags
);

48282 
	`bf_c⁄°_log2
(
r
, 
˘x
->
Â_ív
.
¥ec
, ctx->Â_ív.
Êags
);

48287 
¶imb_t
 
e_ønge
, 
e
;

48288 
e_ønge
 = (
limb_t
)1 << (
	`bf_gë_exp_bôs
(
˘x
->
Â_ív
.
Êags
) - 1);

48289 
	`bf_£t_ui
(
r
, 1);

48290 i‡(
magic
 == 2) {

48291 
e
 = -
e_ønge
 + 2;

48292 i‡(
˘x
->
Â_ív
.
Êags
 & 
BF_FLAG_SUBNORMAL
)

48293 
e
 -
˘x
->
Â_ív
.
¥ec
 - 1;

48294 
	`bf_mul_2exp
(
r
, 
e
, 
˘x
->
Â_ív
.
¥ec
, ctx->Â_ív.
Êags
);

48296 
	`bf_mul_2exp
(
r
, 
˘x
->
Â_ív
.
¥ec
, ctx->fp_env.prec,

48297 
˘x
->
Â_ív
.
Êags
);

48298 
	`bf_add_si
(
r
,Ñ, -1, 
˘x
->
Â_ív
.
¥ec
, ctx->Â_ív.
Êags
);

48299 
	`bf_mul_2exp
(
r
, 
e_ønge
 - 
˘x
->
Â_ív
.
¥ec
, ctx->fp_env.prec,

48300 
˘x
->
Â_ív
.
Êags
);

48305 
	`bf_£t_ui
(
r
, 1);

48306 
	`bf_mul_2exp
(
r
, 1 - 
˘x
->
Â_ív
.
¥ec
,

48307 
˘x
->
Â_ív
.
¥ec
, ctx->Â_ív.
Êags
);

48310 
	`ab‹t
();

48312  
vÆ
;

48313 
	}
}

48315 
JSVÆue
 
	$js_bigÊﬂt_∑r£Flﬂt
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

48316 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

48318 
bf_t
 *
a
;

48319 c⁄° *
°r
;

48320 
JSVÆue
 
ªt
;

48321 
ødix
;

48322 
JSFlﬂtEnv
 *
„
;

48324 
°r
 = 
	`JS_ToCSåög
(
˘x
, 
¨gv
[0]);

48325 i‡(!
°r
)

48326  
JS_EXCEPTION
;

48327 i‡(
	`JS_ToI¡32
(
˘x
, &
ødix
, 
¨gv
[1])) {

48328 
Áû
:

48329 
	`JS_FªeCSåög
(
˘x
, 
°r
);

48330  
JS_EXCEPTION
;

48332 i‡(
ødix
 != 0 && (radix < 2 ||Ñadix > 36)) {

48333 
	`JS_ThrowR™geEº‹
(
˘x
, "radix must be between 2ánd 36");

48334 
Áû
;

48336 
„
 = &
˘x
->
Â_ív
;

48337 i‡(
¨gc
 > 2) {

48338 
„
 = 
	`JS_GëO∑que2
(
˘x
, 
¨gv
[2], 
JS_CLASS_FLOAT_ENV
);

48339 i‡(!
„
)

48340 
Áû
;

48342 
ªt
 = 
	`JS_NewBigFlﬂt
(
˘x
);

48343 i‡(
	`JS_IsEx˚±i⁄
(
ªt
))

48344 
d⁄e
;

48345 
a
 = 
	`JS_GëBigFlﬂt
(
ªt
);

48347 
	`bf_©of
(
a
, 
°r
, 
NULL
, 
ødix
, 
„
->
¥ec
, fe->
Êags
);

48348 
d⁄e
:

48349 
	`JS_FªeCSåög
(
˘x
, 
°r
);

48350  
ªt
;

48351 
	}
}

48353 
JSVÆue
 
	$js_bigÊﬂt_isFöôe
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

48354 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

48356 
JSVÆueC⁄°
 
vÆ
 = 
¨gv
[0];

48357 
JSBigFlﬂt
 *
p
;

48359 i‡(
	`JS_VALUE_GET_NORM_TAG
(
vÆ
Ë!
JS_TAG_BIG_FLOAT
)

48360  
JS_FALSE
;

48361 
p
 = 
	`JS_VALUE_GET_PTR
(
vÆ
);

48362  
	`JS_NewBoﬁ
(
˘x
, 
	`bf_is_föôe
(&
p
->
num
));

48363 
	}
}

48365 
JSVÆue
 
	$js_bigÊﬂt_isNaN
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

48366 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

48368 
JSVÆueC⁄°
 
vÆ
 = 
¨gv
[0];

48369 
JSBigFlﬂt
 *
p
;

48371 i‡(
	`JS_VALUE_GET_NORM_TAG
(
vÆ
Ë!
JS_TAG_BIG_FLOAT
)

48372  
JS_FALSE
;

48373 
p
 = 
	`JS_VALUE_GET_PTR
(
vÆ
);

48374  
	`JS_NewBoﬁ
(
˘x
, 
	`bf_is_«n
(&
p
->
num
));

48375 
	}
}

48378 
	mMATH_OP_ABS
,

48379 
	mMATH_OP_FLOOR
,

48380 
	mMATH_OP_CEIL
,

48381 
	mMATH_OP_ROUND
,

48382 
	mMATH_OP_TRUNC
,

48383 
	mMATH_OP_SQRT
,

48384 
	mMATH_OP_FPROUND
,

48385 
	mMATH_OP_ACOS
,

48386 
	mMATH_OP_ASIN
,

48387 
	mMATH_OP_ATAN
,

48388 
	mMATH_OP_ATAN2
,

48389 
	mMATH_OP_COS
,

48390 
	mMATH_OP_EXP
,

48391 
	mMATH_OP_LOG
,

48392 
	mMATH_OP_POW
,

48393 
	mMATH_OP_SIN
,

48394 
	mMATH_OP_TAN
,

48395 
	mMATH_OP_FMOD
,

48396 
	mMATH_OP_REM
,

48397 
	mMATH_OP_SIGN
,

48399 
	mMATH_OP_ADD
,

48400 
	mMATH_OP_SUB
,

48401 
	mMATH_OP_MUL
,

48402 
	mMATH_OP_DIV
,

48405 
JSVÆue
 
	$js_bigÊﬂt_f›
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

48406 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
, 
magic
)

48408 
bf_t
 
a_s
, *
a
, *
r
;

48409 
JSFlﬂtEnv
 *
„
;

48410 
∫d_mode
;

48411 
JSVÆue
 
›1
, 
ªs
;

48413 
›1
 = 
	`JS_ToNumîic
(
˘x
, 
¨gv
[0]);

48414 i‡(
	`JS_IsEx˚±i⁄
(
›1
))

48415  
›1
;

48416 
a
 = 
	`JS_ToBigFlﬂt
(
˘x
, &
a_s
, 
›1
);

48417 
„
 = &
˘x
->
Â_ív
;

48418 i‡(
¨gc
 > 1) {

48419 
„
 = 
	`JS_GëO∑que2
(
˘x
, 
¨gv
[1], 
JS_CLASS_FLOAT_ENV
);

48420 i‡(!
„
)

48421 
Áû
;

48423 
ªs
 = 
	`JS_NewBigFlﬂt
(
˘x
);

48424 i‡(
	`JS_IsEx˚±i⁄
(
ªs
)) {

48425 
Áû
:

48426 i‡(
a
 =&
a_s
)

48427 
	`bf_dñëe
(
a
);

48428 
	`JS_FªeVÆue
(
˘x
, 
›1
);

48429  
JS_EXCEPTION
;

48431 
r
 = 
	`JS_GëBigFlﬂt
(
ªs
);

48432 
magic
) {

48433 
MATH_OP_ABS
:

48434 
	`bf_£t
(
r
, 
a
);

48435 
r
->
sign
 = 0;

48437 
MATH_OP_FLOOR
:

48438 
∫d_mode
 = 
BF_RNDD
;

48439 
röt
;

48440 
MATH_OP_CEIL
:

48441 
∫d_mode
 = 
BF_RNDU
;

48442 
röt
;

48443 
MATH_OP_ROUND
:

48444 
∫d_mode
 = 
BF_RNDNA
;

48445 
röt
;

48446 
MATH_OP_TRUNC
:

48447 
∫d_mode
 = 
BF_RNDZ
;

48448 
röt
:

48449 
	`bf_£t
(
r
, 
a
);

48450 
„
->
°©us
 |
	`bf_röt
(
r
, 
∫d_mode
);

48452 
MATH_OP_SQRT
:

48453 
„
->
°©us
 |
	`bf_sqπ
(
r
, 
a
, fe->
¥ec
, fe->
Êags
);

48455 
MATH_OP_FPROUND
:

48456 
	`bf_£t
(
r
, 
a
);

48457 
„
->
°©us
 |
	`bf_round
(
r
, fe->
¥ec
, fe->
Êags
);

48459 
MATH_OP_ACOS
:

48460 
„
->
°©us
 |
	`bf_acos
(
r
, 
a
, fe->
¥ec
, fe->
Êags
);

48462 
MATH_OP_ASIN
:

48463 
„
->
°©us
 |
	`bf_asö
(
r
, 
a
, fe->
¥ec
, fe->
Êags
);

48465 
MATH_OP_ATAN
:

48466 
„
->
°©us
 |
	`bf_©™
(
r
, 
a
, fe->
¥ec
, fe->
Êags
);

48468 
MATH_OP_COS
:

48469 
„
->
°©us
 |
	`bf_cos
(
r
, 
a
, fe->
¥ec
, fe->
Êags
);

48471 
MATH_OP_EXP
:

48472 
„
->
°©us
 |
	`bf_exp
(
r
, 
a
, fe->
¥ec
, fe->
Êags
);

48474 
MATH_OP_LOG
:

48475 
„
->
°©us
 |
	`bf_log
(
r
, 
a
, fe->
¥ec
, fe->
Êags
);

48477 
MATH_OP_SIN
:

48478 
„
->
°©us
 |
	`bf_sö
(
r
, 
a
, fe->
¥ec
, fe->
Êags
);

48480 
MATH_OP_TAN
:

48481 
„
->
°©us
 |
	`bf_èn
(
r
, 
a
, fe->
¥ec
, fe->
Êags
);

48483 
MATH_OP_SIGN
:

48484 i‡(
	`bf_is_«n
(
a
Ë|| 
	`bf_is_zîo
(a)) {

48485 
	`bf_£t
(
r
, 
a
);

48487 
	`bf_£t_si
(
r
, 1 - 2 * 
a
->
sign
);

48491 
	`ab‹t
();

48493 i‡(
a
 =&
a_s
)

48494 
	`bf_dñëe
(
a
);

48495 
	`JS_FªeVÆue
(
˘x
, 
›1
);

48496  
ªs
;

48497 
	}
}

48499 
JSVÆue
 
	$js_bigÊﬂt_f›2
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

48500 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
, 
magic
)

48502 
bf_t
 
a_s
, *
a
, 
b_s
, *
b
, 
r_s
, *
r
 = &r_s;

48503 
JSFlﬂtEnv
 *
„
;

48504 
JSVÆue
 
›1
, 
›2
, 
ªs
;

48506 
›1
 = 
	`JS_ToNumîic
(
˘x
, 
¨gv
[0]);

48507 i‡(
	`JS_IsEx˚±i⁄
(
›1
))

48508  
›1
;

48509 
›2
 = 
	`JS_ToNumîic
(
˘x
, 
¨gv
[1]);

48510 i‡(
	`JS_IsEx˚±i⁄
(
›2
)) {

48511 
	`JS_FªeVÆue
(
˘x
, 
›1
);

48512  
›2
;

48514 
a
 = 
	`JS_ToBigFlﬂt
(
˘x
, &
a_s
, 
›1
);

48515 
b
 = 
	`JS_ToBigFlﬂt
(
˘x
, &
b_s
, 
›2
);

48516 
„
 = &
˘x
->
Â_ív
;

48517 i‡(
¨gc
 > 2) {

48518 
„
 = 
	`JS_GëO∑que2
(
˘x
, 
¨gv
[2], 
JS_CLASS_FLOAT_ENV
);

48519 i‡(!
„
)

48520 
Áû
;

48522 
ªs
 = 
	`JS_NewBigFlﬂt
(
˘x
);

48523 i‡(
	`JS_IsEx˚±i⁄
(
ªs
)) {

48524 
Áû
:

48525 i‡(
a
 =&
a_s
)

48526 
	`bf_dñëe
(
a
);

48527 i‡(
b
 =&
b_s
)

48528 
	`bf_dñëe
(
b
);

48529 
	`JS_FªeVÆue
(
˘x
, 
›1
);

48530 
	`JS_FªeVÆue
(
˘x
, 
›2
);

48531  
JS_EXCEPTION
;

48533 
r
 = 
	`JS_GëBigFlﬂt
(
ªs
);

48534 
magic
) {

48535 
MATH_OP_ATAN2
:

48536 
„
->
°©us
 |
	`bf_©™2
(
r
, 
a
, 
b
, fe->
¥ec
, fe->
Êags
);

48538 
MATH_OP_POW
:

48539 
„
->
°©us
 |
	`bf_pow
(
r
, 
a
, 
b
, fe->
¥ec
, fe->
Êags
 | 
BF_POW_JS_QUIRKS
);

48541 
MATH_OP_FMOD
:

48542 
„
->
°©us
 |
	`bf_ªm
(
r
, 
a
, 
b
, fe->
¥ec
, fe->
Êags
, 
BF_RNDZ
);

48544 
MATH_OP_REM
:

48545 
„
->
°©us
 |
	`bf_ªm
(
r
, 
a
, 
b
, fe->
¥ec
, fe->
Êags
, 
BF_RNDN
);

48547 
MATH_OP_ADD
:

48548 
„
->
°©us
 |
	`bf_add
(
r
, 
a
, 
b
, fe->
¥ec
, fe->
Êags
);

48550 
MATH_OP_SUB
:

48551 
„
->
°©us
 |
	`bf_sub
(
r
, 
a
, 
b
, fe->
¥ec
, fe->
Êags
);

48553 
MATH_OP_MUL
:

48554 
„
->
°©us
 |
	`bf_mul
(
r
, 
a
, 
b
, fe->
¥ec
, fe->
Êags
);

48556 
MATH_OP_DIV
:

48557 
„
->
°©us
 |
	`bf_div
(
r
, 
a
, 
b
, fe->
¥ec
, fe->
Êags
);

48560 
	`ab‹t
();

48562 i‡(
a
 =&
a_s
)

48563 
	`bf_dñëe
(
a
);

48564 i‡(
b
 =&
b_s
)

48565 
	`bf_dñëe
(
b
);

48566 
	`JS_FªeVÆue
(
˘x
, 
›1
);

48567 
	`JS_FªeVÆue
(
˘x
, 
›2
);

48568  
ªs
;

48569 
	}
}

48571 c⁄° 
JSCFun˘i⁄Li°E¡ry
 
	gjs_bigÊﬂt_funcs
[] = {

48572 
JS_CGETSET_MAGIC_DEF
("PI", 
js_bigÊﬂt_gë_c⁄°
, 
NULL
, 0 ),

48573 
JS_CGETSET_MAGIC_DEF
("LN2", 
js_bigÊﬂt_gë_c⁄°
, 
NULL
, 1 ),

48574 
JS_CGETSET_MAGIC_DEF
("MIN_VALUE", 
js_bigÊﬂt_gë_c⁄°
, 
NULL
, 2 ),

48575 
JS_CGETSET_MAGIC_DEF
("MAX_VALUE", 
js_bigÊﬂt_gë_c⁄°
, 
NULL
, 3 ),

48576 
JS_CGETSET_MAGIC_DEF
("EPSILON", 
js_bigÊﬂt_gë_c⁄°
, 
NULL
, 4 ),

48577 
JS_CFUNC_DEF
("∑r£Flﬂt", 1, 
js_bigÊﬂt_∑r£Flﬂt
 ),

48578 
JS_CFUNC_DEF
("isFöôe", 1, 
js_bigÊﬂt_isFöôe
 ),

48579 
JS_CFUNC_DEF
("isNaN", 1, 
js_bigÊﬂt_isNaN
 ),

48580 
JS_CFUNC_MAGIC_DEF
("abs", 1, 
js_bigÊﬂt_f›
, 
MATH_OP_ABS
 ),

48581 
JS_CFUNC_MAGIC_DEF
("ÂRound", 1, 
js_bigÊﬂt_f›
, 
MATH_OP_FPROUND
 ),

48582 
JS_CFUNC_MAGIC_DEF
("Êo‹", 1, 
js_bigÊﬂt_f›
, 
MATH_OP_FLOOR
 ),

48583 
JS_CFUNC_MAGIC_DEF
("˚û", 1, 
js_bigÊﬂt_f›
, 
MATH_OP_CEIL
 ),

48584 
JS_CFUNC_MAGIC_DEF
("round", 1, 
js_bigÊﬂt_f›
, 
MATH_OP_ROUND
 ),

48585 
JS_CFUNC_MAGIC_DEF
("åunc", 1, 
js_bigÊﬂt_f›
, 
MATH_OP_TRUNC
 ),

48586 
JS_CFUNC_MAGIC_DEF
("sqπ", 1, 
js_bigÊﬂt_f›
, 
MATH_OP_SQRT
 ),

48587 
JS_CFUNC_MAGIC_DEF
("acos", 1, 
js_bigÊﬂt_f›
, 
MATH_OP_ACOS
 ),

48588 
JS_CFUNC_MAGIC_DEF
("asö", 1, 
js_bigÊﬂt_f›
, 
MATH_OP_ASIN
 ),

48589 
JS_CFUNC_MAGIC_DEF
("©™", 1, 
js_bigÊﬂt_f›
, 
MATH_OP_ATAN
 ),

48590 
JS_CFUNC_MAGIC_DEF
("©™2", 2, 
js_bigÊﬂt_f›2
, 
MATH_OP_ATAN2
 ),

48591 
JS_CFUNC_MAGIC_DEF
("cos", 1, 
js_bigÊﬂt_f›
, 
MATH_OP_COS
 ),

48592 
JS_CFUNC_MAGIC_DEF
("exp", 1, 
js_bigÊﬂt_f›
, 
MATH_OP_EXP
 ),

48593 
JS_CFUNC_MAGIC_DEF
("log", 1, 
js_bigÊﬂt_f›
, 
MATH_OP_LOG
 ),

48594 
JS_CFUNC_MAGIC_DEF
("pow", 2, 
js_bigÊﬂt_f›2
, 
MATH_OP_POW
 ),

48595 
JS_CFUNC_MAGIC_DEF
("sö", 1, 
js_bigÊﬂt_f›
, 
MATH_OP_SIN
 ),

48596 
JS_CFUNC_MAGIC_DEF
("èn", 1, 
js_bigÊﬂt_f›
, 
MATH_OP_TAN
 ),

48597 
JS_CFUNC_MAGIC_DEF
("sign", 1, 
js_bigÊﬂt_f›
, 
MATH_OP_SIGN
 ),

48598 
JS_CFUNC_MAGIC_DEF
("add", 2, 
js_bigÊﬂt_f›2
, 
MATH_OP_ADD
 ),

48599 
JS_CFUNC_MAGIC_DEF
("sub", 2, 
js_bigÊﬂt_f›2
, 
MATH_OP_SUB
 ),

48600 
JS_CFUNC_MAGIC_DEF
("mul", 2, 
js_bigÊﬂt_f›2
, 
MATH_OP_MUL
 ),

48601 
JS_CFUNC_MAGIC_DEF
("div", 2, 
js_bigÊﬂt_f›2
, 
MATH_OP_DIV
 ),

48602 
JS_CFUNC_MAGIC_DEF
("fmod", 2, 
js_bigÊﬂt_f›2
, 
MATH_OP_FMOD
 ),

48603 
JS_CFUNC_MAGIC_DEF
("ªmaödî", 2, 
js_bigÊﬂt_f›2
, 
MATH_OP_REM
 ),

48608 
JSVÆue
 
	$js_Êﬂt_ív_c⁄°ru˘‹
(
JSC⁄ãxt
 *
˘x
,

48609 
JSVÆueC⁄°
 
√w_èrgë
,

48610 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

48612 
JSVÆue
 
obj
;

48613 
JSFlﬂtEnv
 *
„
;

48614 
öt64_t
 
¥ec
;

48615 
Êags
, 
∫dmode
;

48617 
¥ec
 = 
˘x
->
Â_ív
.prec;

48618 
Êags
 = 
˘x
->
Â_ív
.flags;

48619 i‡(!
	`JS_IsUndeföed
(
¨gv
[0])) {

48620 i‡(
	`JS_ToI¡64S©
(
˘x
, &
¥ec
, 
¨gv
[0]))

48621  
JS_EXCEPTION
;

48622 i‡(
¥ec
 < 
BF_PREC_MIN
 ||Öª¯> 
BF_PREC_MAX
)

48623  
	`JS_ThrowR™geEº‹
(
˘x
, "invalidÖrecision");

48624 
Êags
 = 
BF_RNDN
;

48625 i‡(
¨gc
 > 1 && !
	`JS_IsUndeföed
(
¨gv
[1])) {

48626 i‡(
	`JS_ToI¡32S©
(
˘x
, &
∫dmode
, 
¨gv
[1]))

48627  
JS_EXCEPTION
;

48628 i‡(
∫dmode
 < 
BF_RNDN
 ||Ñndmodê> 
BF_RNDF
)

48629  
	`JS_ThrowR™geEº‹
(
˘x
, "invalidÑounding mode");

48630 
Êags
 = 
∫dmode
;

48634 
obj
 = 
	`JS_NewObje˘Cœss
(
˘x
, 
JS_CLASS_FLOAT_ENV
);

48635 i‡(
	`JS_IsEx˚±i⁄
(
obj
))

48636  
JS_EXCEPTION
;

48637 
„
 = 
	`js_mÆloc
(
˘x
, (*fe));

48638 i‡(!
„
)

48639  
JS_EXCEPTION
;

48640 
„
->
¥ec
 =Örec;

48641 
„
->
Êags
 = flags;

48642 
„
->
°©us
 = 0;

48643 
	`JS_SëO∑que
(
obj
, 
„
);

48644  
obj
;

48645 
	}
}

48647 
	$js_Êﬂt_ív_föÆizî
(
JSRu¡ime
 *
π
, 
JSVÆue
 
vÆ
)

48649 
JSFlﬂtEnv
 *
„
 = 
	`JS_GëO∑que
(
vÆ
, 
JS_CLASS_FLOAT_ENV
);

48650 
	`js_‰ì_π
(
π
, 
„
);

48651 
	}
}

48653 
JSVÆue
 
	$js_Êﬂt_ív_gë_¥ec
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
)

48655  
	`JS_NewI¡64
(
˘x
, ctx->
Â_ív
.
¥ec
);

48656 
	}
}

48658 
JSVÆue
 
	$js_Êﬂt_ív_gë_expBôs
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
)

48660  
	`JS_NewI¡32
(
˘x
, 
	`bf_gë_exp_bôs
(˘x->
Â_ív
.
Êags
));

48661 
	}
}

48663 
JSVÆue
 
	$js_Êﬂt_ív_£tPªc
(
JSC⁄ãxt
 *
˘x
,

48664 
JSVÆueC⁄°
 
this_vÆ
,

48665 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

48667 
JSVÆueC⁄°
 
func
;

48668 
exp_bôs
, 
Êags
, 
ßved_Êags
;

48669 
JSVÆue
 
ªt
;

48670 
limb_t
 
ßved_¥ec
;

48671 
öt64_t
 
¥ec
;

48673 
func
 = 
¨gv
[0];

48674 i‡(
	`JS_ToI¡64S©
(
˘x
, &
¥ec
, 
¨gv
[1]))

48675  
JS_EXCEPTION
;

48676 i‡(
¥ec
 < 
BF_PREC_MIN
 ||Öª¯> 
BF_PREC_MAX
)

48677  
	`JS_ThrowR™geEº‹
(
˘x
, "invalidÖrecision");

48678 
exp_bôs
 = 
BF_EXP_BITS_MAX
;

48680 i‡(
¨gc
 > 2 && !
	`JS_IsUndeföed
(
¨gv
[2])) {

48681 i‡(
	`JS_ToI¡32S©
(
˘x
, &
exp_bôs
, 
¨gv
[2]))

48682  
JS_EXCEPTION
;

48683 i‡(
exp_bôs
 < 
BF_EXP_BITS_MIN
 ||Éxp_bô†> 
BF_EXP_BITS_MAX
)

48684  
	`JS_ThrowR™geEº‹
(
˘x
, "invalidÇumber ofÉxponent bits");

48687 
Êags
 = 
BF_RNDN
 | 
BF_FLAG_SUBNORMAL
 | 
	`bf_£t_exp_bôs
(
exp_bôs
);

48689 
ßved_¥ec
 = 
˘x
->
Â_ív
.
¥ec
;

48690 
ßved_Êags
 = 
˘x
->
Â_ív
.
Êags
;

48692 
˘x
->
Â_ív
.
¥ec
 =Örec;

48693 
˘x
->
Â_ív
.
Êags
 = flags;

48695 
ªt
 = 
	`JS_CÆl
(
˘x
, 
func
, 
JS_UNDEFINED
, 0, 
NULL
);

48697 
˘x
->
Â_ív
.
¥ec
 = 
ßved_¥ec
;

48698 
˘x
->
Â_ív
.
Êags
 = 
ßved_Êags
;

48699  
ªt
;

48700 
	}
}

48702 
	#FE_PREC
 (-1)

	)

48703 
	#FE_EXP
 (-2)

	)

48704 
	#FE_RNDMODE
 (-3)

	)

48705 
	#FE_SUBNORMAL
 (-4)

	)

48707 
JSVÆue
 
	$js_Êﬂt_ív_¥Ÿo_gë_°©us
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
, 
magic
)

48709 
JSFlﬂtEnv
 *
„
;

48710 
„
 = 
	`JS_GëO∑que2
(
˘x
, 
this_vÆ
, 
JS_CLASS_FLOAT_ENV
);

48711 i‡(!
„
)

48712  
JS_EXCEPTION
;

48713 
magic
) {

48714 
FE_PREC
:

48715  
	`JS_NewI¡64
(
˘x
, 
„
->
¥ec
);

48716 
FE_EXP
:

48717  
	`JS_NewI¡32
(
˘x
, 
	`bf_gë_exp_bôs
(
„
->
Êags
));

48718 
FE_RNDMODE
:

48719  
	`JS_NewI¡32
(
˘x
, 
„
->
Êags
 & 
BF_RND_MASK
);

48720 
FE_SUBNORMAL
:

48721  
	`JS_NewBoﬁ
(
˘x
, (
„
->
Êags
 & 
BF_FLAG_SUBNORMAL
) != 0);

48723  
	`JS_NewBoﬁ
(
˘x
, (
„
->
°©us
 & 
magic
) != 0);

48725 
	}
}

48727 
JSVÆue
 
	$js_Êﬂt_ív_¥Ÿo_£t_°©us
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
, JSVÆueC⁄° 
vÆ
, 
magic
)

48729 
JSFlﬂtEnv
 *
„
;

48730 
b
;

48731 
öt64_t
 
¥ec
;

48733 
„
 = 
	`JS_GëO∑que2
(
˘x
, 
this_vÆ
, 
JS_CLASS_FLOAT_ENV
);

48734 i‡(!
„
)

48735  
JS_EXCEPTION
;

48736 
magic
) {

48737 
FE_PREC
:

48738 i‡(
	`JS_ToI¡64S©
(
˘x
, &
¥ec
, 
vÆ
))

48739  
JS_EXCEPTION
;

48740 i‡(
¥ec
 < 
BF_PREC_MIN
 ||Öª¯> 
BF_PREC_MAX
)

48741  
	`JS_ThrowR™geEº‹
(
˘x
, "invalidÖrecision");

48742 
„
->
¥ec
 =Örec;

48744 
FE_EXP
:

48745 i‡(
	`JS_ToI¡32S©
(
˘x
, &
b
, 
vÆ
))

48746  
JS_EXCEPTION
;

48747 i‡(
b
 < 
BF_EXP_BITS_MIN
 || b > 
BF_EXP_BITS_MAX
)

48748  
	`JS_ThrowR™geEº‹
(
˘x
, "invalidÇumber ofÉxponent bits");

48749 
„
->
Êags
 = („->Êag†& ~(
BF_EXP_BITS_MASK
 << 
BF_EXP_BITS_SHIFT
)) |

48750 
	`bf_£t_exp_bôs
(
b
);

48752 
FE_RNDMODE
:

48753 
b
 = 
	`bigÊﬂt_gë_∫d_mode
(
˘x
, 
vÆ
);

48754 i‡(
b
 < 0)

48755  
JS_EXCEPTION
;

48756 
„
->
Êags
 = („->Êag†& ~
BF_RND_MASK
Ë| 
b
;

48758 
FE_SUBNORMAL
:

48759 
b
 = 
	`JS_ToBoﬁ
(
˘x
, 
vÆ
);

48760 
„
->
Êags
 = („->Êag†& ~
BF_FLAG_SUBNORMAL
Ë| (
b
 ? BF_FLAG_SUBNORMAL: 0);

48763 
b
 = 
	`JS_ToBoﬁ
(
˘x
, 
vÆ
);

48764 
„
->
°©us
 = („->°©u†& ~
magic
Ë& ((-
b
) & magic);

48767  
JS_UNDEFINED
;

48768 
	}
}

48770 
JSVÆue
 
	$js_Êﬂt_ív_˛órSètus
(
JSC⁄ãxt
 *
˘x
,

48771 
JSVÆueC⁄°
 
this_vÆ
,

48772 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

48774 
JSFlﬂtEnv
 *
„
 = 
	`JS_GëO∑que2
(
˘x
, 
this_vÆ
, 
JS_CLASS_FLOAT_ENV
);

48775 i‡(!
„
)

48776  
JS_EXCEPTION
;

48777 
„
->
°©us
 = 0;

48778  
JS_UNDEFINED
;

48779 
	}
}

48781 c⁄° 
JSCFun˘i⁄Li°E¡ry
 
	gjs_Êﬂt_ív_funcs
[] = {

48782 
JS_CGETSET_DEF
("¥ec", 
js_Êﬂt_ív_gë_¥ec
, 
NULL
 ),

48783 
JS_CGETSET_DEF
("expBôs", 
js_Êﬂt_ív_gë_expBôs
, 
NULL
 ),

48784 
JS_CFUNC_DEF
("£tPªc", 2, 
js_Êﬂt_ív_£tPªc
 ),

48785 
JS_PROP_INT32_DEF
("RNDN", 
BF_RNDN
, 0 ),

48786 
JS_PROP_INT32_DEF
("RNDZ", 
BF_RNDZ
, 0 ),

48787 
JS_PROP_INT32_DEF
("RNDU", 
BF_RNDU
, 0 ),

48788 
JS_PROP_INT32_DEF
("RNDD", 
BF_RNDD
, 0 ),

48789 
JS_PROP_INT32_DEF
("RNDNA", 
BF_RNDNA
, 0 ),

48790 
JS_PROP_INT32_DEF
("RNDA", 
BF_RNDA
, 0 ),

48791 
JS_PROP_INT32_DEF
("RNDF", 
BF_RNDF
, 0 ),

48792 
JS_PROP_INT32_DEF
("¥ecMö", 
BF_PREC_MIN
, 0 ),

48793 
JS_PROP_INT64_DEF
("¥ecMax", 
BF_PREC_MAX
, 0 ),

48794 
JS_PROP_INT32_DEF
("expBôsMö", 
BF_EXP_BITS_MIN
, 0 ),

48795 
JS_PROP_INT32_DEF
("expBôsMax", 
BF_EXP_BITS_MAX
, 0 ),

48798 c⁄° 
JSCFun˘i⁄Li°E¡ry
 
	gjs_Êﬂt_ív_¥Ÿo_funcs
[] = {

48799 
JS_CGETSET_MAGIC_DEF
("¥ec", 
js_Êﬂt_ív_¥Ÿo_gë_°©us
,

48800 
js_Êﬂt_ív_¥Ÿo_£t_°©us
, 
FE_PREC
 ),

48801 
JS_CGETSET_MAGIC_DEF
("expBôs", 
js_Êﬂt_ív_¥Ÿo_gë_°©us
,

48802 
js_Êﬂt_ív_¥Ÿo_£t_°©us
, 
FE_EXP
 ),

48803 
JS_CGETSET_MAGIC_DEF
("∫dMode", 
js_Êﬂt_ív_¥Ÿo_gë_°©us
,

48804 
js_Êﬂt_ív_¥Ÿo_£t_°©us
, 
FE_RNDMODE
 ),

48805 
JS_CGETSET_MAGIC_DEF
("subn‹mÆ", 
js_Êﬂt_ív_¥Ÿo_gë_°©us
,

48806 
js_Êﬂt_ív_¥Ÿo_£t_°©us
, 
FE_SUBNORMAL
 ),

48807 
JS_CGETSET_MAGIC_DEF
("övÆidO≥øti⁄", 
js_Êﬂt_ív_¥Ÿo_gë_°©us
,

48808 
js_Êﬂt_ív_¥Ÿo_£t_°©us
, 
BF_ST_INVALID_OP
 ),

48809 
JS_CGETSET_MAGIC_DEF
("divideByZîo", 
js_Êﬂt_ív_¥Ÿo_gë_°©us
,

48810 
js_Êﬂt_ív_¥Ÿo_£t_°©us
, 
BF_ST_DIVIDE_ZERO
 ),

48811 
JS_CGETSET_MAGIC_DEF
("ovîÊow", 
js_Êﬂt_ív_¥Ÿo_gë_°©us
,

48812 
js_Êﬂt_ív_¥Ÿo_£t_°©us
, 
BF_ST_OVERFLOW
 ),

48813 
JS_CGETSET_MAGIC_DEF
("undîÊow", 
js_Êﬂt_ív_¥Ÿo_gë_°©us
,

48814 
js_Êﬂt_ív_¥Ÿo_£t_°©us
, 
BF_ST_UNDERFLOW
 ),

48815 
JS_CGETSET_MAGIC_DEF
("öexa˘", 
js_Êﬂt_ív_¥Ÿo_gë_°©us
,

48816 
js_Êﬂt_ív_¥Ÿo_£t_°©us
, 
BF_ST_INEXACT
 ),

48817 
JS_CFUNC_DEF
("˛órSètus", 0, 
js_Êﬂt_ív_˛órSètus
 ),

48820 
	$JS_AddI¡rösicBigFlﬂt
(
JSC⁄ãxt
 *
˘x
)

48822 
JSRu¡ime
 *
π
 = 
˘x
->rt;

48823 
JSVÆue
 
obj1
;

48824 
JSVÆueC⁄°
 
obj2
;

48826 
π
->
bigÊﬂt_›s
.
to_°rög
 = 
js_bigÊﬂt_to_°rög
;

48827 
π
->
bigÊﬂt_›s
.
‰om_°rög
 = 
js_°rög_to_bigÊﬂt
;

48828 
π
->
bigÊﬂt_›s
.
u«ry_¨ôh
 = 
js_u«ry_¨ôh_bigÊﬂt
;

48829 
π
->
bigÊﬂt_›s
.
bö¨y_¨ôh
 = 
js_bö¨y_¨ôh_bigÊﬂt
;

48830 
π
->
bigÊﬂt_›s
.
com∑ª
 = 
js_com∑ª_bigÊﬂt
;

48831 
π
->
bigÊﬂt_›s
.
mul_pow10_to_Êﬂt64
 = 
js_mul_pow10_to_Êﬂt64
;

48832 
π
->
bigÊﬂt_›s
.
mul_pow10
 = 
js_mul_pow10
;

48834 
˘x
->
˛ass_¥Ÿo
[
JS_CLASS_BIG_FLOAT
] = 
	`JS_NewObje˘
(ctx);

48835 
	`JS_SëPr›îtyFun˘i⁄Li°
(
˘x
, ctx->
˛ass_¥Ÿo
[
JS_CLASS_BIG_FLOAT
],

48836 
js_bigÊﬂt_¥Ÿo_funcs
,

48837 
	`cou¡of
(
js_bigÊﬂt_¥Ÿo_funcs
));

48838 
obj1
 = 
	`JS_NewCFun˘i⁄
(
˘x
, 
js_bigÊﬂt_c⁄°ru˘‹
, "BigFloat", 1);

48839 
	`JS_NewGlobÆCC⁄°ru˘‹2
(
˘x
, 
obj1
, "BigFloat",

48840 
˘x
->
˛ass_¥Ÿo
[
JS_CLASS_BIG_FLOAT
]);

48841 
	`JS_SëPr›îtyFun˘i⁄Li°
(
˘x
, 
obj1
, 
js_bigÊﬂt_funcs
,

48842 
	`cou¡of
(
js_bigÊﬂt_funcs
));

48844 
˘x
->
˛ass_¥Ÿo
[
JS_CLASS_FLOAT_ENV
] = 
	`JS_NewObje˘
(ctx);

48845 
	`JS_SëPr›îtyFun˘i⁄Li°
(
˘x
, ctx->
˛ass_¥Ÿo
[
JS_CLASS_FLOAT_ENV
],

48846 
js_Êﬂt_ív_¥Ÿo_funcs
,

48847 
	`cou¡of
(
js_Êﬂt_ív_¥Ÿo_funcs
));

48848 
obj2
 = 
	`JS_NewGlobÆCC⁄°ru˘‹O∆y
(
˘x
, "BigFloatEnv",

48849 
js_Êﬂt_ív_c⁄°ru˘‹
, 1,

48850 
˘x
->
˛ass_¥Ÿo
[
JS_CLASS_FLOAT_ENV
]);

48851 
	`JS_SëPr›îtyFun˘i⁄Li°
(
˘x
, 
obj2
, 
js_Êﬂt_ív_funcs
,

48852 
	`cou¡of
(
js_Êﬂt_ív_funcs
));

48853 
	}
}

48857 
JSVÆue
 
	$JS_ToBigDecimÆFªe
(
JSC⁄ãxt
 *
˘x
, 
JSVÆue
 
vÆ
,

48858 
BOOL
 
Ælow_nuŒ_‹_undeföed
)

48860 
ªdo
:

48861 
	`JS_VALUE_GET_NORM_TAG
(
vÆ
)) {

48862 
JS_TAG_BIG_DECIMAL
:

48864 
JS_TAG_NULL
:

48865 i‡(!
Ælow_nuŒ_‹_undeföed
)

48866 
Áû
;

48868 
JS_TAG_BOOL
:

48869 
JS_TAG_INT
:

48871 
bfdec_t
 *
r
;

48872 
öt32_t
 
v
 = 
	`JS_VALUE_GET_INT
(
vÆ
);

48874 
vÆ
 = 
	`JS_NewBigDecimÆ
(
˘x
);

48875 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

48877 
r
 = 
	`JS_GëBigDecimÆ
(
vÆ
);

48878 i‡(
	`bfdec_£t_si
(
r
, 
v
)) {

48879 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

48880 
vÆ
 = 
JS_EXCEPTION
;

48885 
JS_TAG_FLOAT64
:

48886 
JS_TAG_BIG_INT
:

48887 
JS_TAG_BIG_FLOAT
:

48888 
vÆ
 = 
	`JS_ToSåögFªe
(
˘x
, val);

48889 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

48891 
ªdo
;

48892 
JS_TAG_STRING
:

48894 c⁄° *
°r
, *
p
;

48895 
size_t
 
Àn
;

48896 
îr
;

48898 
°r
 = 
	`JS_ToCSåögLí
(
˘x
, &
Àn
, 
vÆ
);

48899 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

48900 i‡(!
°r
)

48901  
JS_EXCEPTION
;

48902 
p
 = 
°r
;

48903 
p
 +
	`skù_•a˚s
(p);

48904 i‡((
p
 - 
°r
Ë=
Àn
) {

48905 
bfdec_t
 *
r
;

48906 
vÆ
 = 
	`JS_NewBigDecimÆ
(
˘x
);

48907 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

48909 
r
 = 
	`JS_GëBigDecimÆ
(
vÆ
);

48910 
	`bfdec_£t_zîo
(
r
, 0);

48911 
îr
 = 0;

48913 
vÆ
 = 
	`js_©of
(
˘x
, 
p
, &p, 0, 
ATOD_TYPE_BIG_DECIMAL
);

48914 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
)) {

48915 
	`JS_FªeCSåög
(
˘x
, 
°r
);

48916  
JS_EXCEPTION
;

48918 
p
 +
	`skù_•a˚s
(p);

48919 
îr
 = ((
p
 - 
°r
Ë!
Àn
);

48921 
	`JS_FªeCSåög
(
˘x
, 
°r
);

48922 i‡(
îr
) {

48923 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

48924  
	`JS_ThrowSy¡axEº‹
(
˘x
, "invalid bigdecimalÜiteral");

48928 
JS_TAG_OBJECT
:

48929 
vÆ
 = 
	`JS_ToPrimôiveFªe
(
˘x
, vÆ, 
HINT_NUMBER
);

48930 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

48932 
ªdo
;

48933 
JS_TAG_UNDEFINED
:

48935 
bfdec_t
 *
r
;

48936 i‡(!
Ælow_nuŒ_‹_undeföed
)

48937 
Áû
;

48938 
vÆ
 = 
	`JS_NewBigDecimÆ
(
˘x
);

48939 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

48941 
r
 = 
	`JS_GëBigDecimÆ
(
vÆ
);

48942 
	`bfdec_£t_«n
(
r
);

48946 
Áû
:

48947 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

48948  
	`JS_ThrowTy≥Eº‹
(
˘x
, "cannot convertÅo bigdecimal");

48950  
vÆ
;

48951 
	}
}

48953 
JSVÆue
 
	$js_bigdecimÆ_c⁄°ru˘‹
(
JSC⁄ãxt
 *
˘x
,

48954 
JSVÆueC⁄°
 
this_vÆ
,

48955 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

48957 
JSVÆue
 
vÆ
;

48958 i‡(
¨gc
 == 0) {

48959 
bfdec_t
 *
r
;

48960 
vÆ
 = 
	`JS_NewBigDecimÆ
(
˘x
);

48961 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

48962  
vÆ
;

48963 
r
 = 
	`JS_GëBigDecimÆ
(
vÆ
);

48964 
	`bfdec_£t_zîo
(
r
, 0);

48966 
vÆ
 = 
	`JS_ToBigDecimÆFªe
(
˘x
, 
	`JS_DupVÆue
(˘x, 
¨gv
[0]), 
FALSE
);

48968  
vÆ
;

48969 
	}
}

48971 
JSVÆue
 
	$js_thisBigDecimÆVÆue
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
)

48973 i‡(
	`JS_IsBigDecimÆ
(
this_vÆ
))

48974  
	`JS_DupVÆue
(
˘x
, 
this_vÆ
);

48976 i‡(
	`JS_VALUE_GET_TAG
(
this_vÆ
Ë=
JS_TAG_OBJECT
) {

48977 
JSObje˘
 *
p
 = 
	`JS_VALUE_GET_OBJ
(
this_vÆ
);

48978 i‡(
p
->
˛ass_id
 =
JS_CLASS_BIG_DECIMAL
) {

48979 i‡(
	`JS_IsBigDecimÆ
(
p
->
u
.
obje˘_d©a
))

48980  
	`JS_DupVÆue
(
˘x
, 
p
->
u
.
obje˘_d©a
);

48983  
	`JS_ThrowTy≥Eº‹
(
˘x
, "notá bigdecimal");

48984 
	}
}

48986 
JSVÆue
 
	$js_bigdecimÆ_toSåög
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

48987 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

48989 
JSVÆue
 
vÆ
;

48991 
vÆ
 = 
	`js_thisBigDecimÆVÆue
(
˘x
, 
this_vÆ
);

48992 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

48993  
vÆ
;

48994  
	`JS_ToSåögFªe
(
˘x
, 
vÆ
);

48995 
	}
}

48997 
JSVÆue
 
	$js_bigdecimÆ_vÆueOf
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

48998 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

49000  
	`js_thisBigDecimÆVÆue
(
˘x
, 
this_vÆ
);

49001 
	}
}

49003 
	$js_bigdecimÆ_gë_∫d_mode
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
obj
)

49005 c⁄° *
°r
;

49006 
size_t
 
size
;

49007 
∫d_mode
;

49009 
°r
 = 
	`JS_ToCSåögLí
(
˘x
, &
size
, 
obj
);

49010 i‡(!
°r
)

49012 i‡(
	`°æí
(
°r
Ë!
size
)

49013 
övÆid_roundög_mode
;

49014 i‡(!
	`°rcmp
(
°r
, "floor")) {

49015 
∫d_mode
 = 
BF_RNDD
;

49016 } i‡(!
	`°rcmp
(
°r
, "ceiling")) {

49017 
∫d_mode
 = 
BF_RNDU
;

49018 } i‡(!
	`°rcmp
(
°r
, "down")) {

49019 
∫d_mode
 = 
BF_RNDZ
;

49020 } i‡(!
	`°rcmp
(
°r
, "up")) {

49021 
∫d_mode
 = 
BF_RNDA
;

49022 } i‡(!
	`°rcmp
(
°r
, "half-even")) {

49023 
∫d_mode
 = 
BF_RNDN
;

49024 } i‡(!
	`°rcmp
(
°r
, "half-up")) {

49025 
∫d_mode
 = 
BF_RNDNA
;

49027 
övÆid_roundög_mode
:

49028 
	`JS_FªeCSåög
(
˘x
, 
°r
);

49029 
	`JS_ThrowTy≥Eº‹
(
˘x
, "invalidÑounding mode");

49032 
	`JS_FªeCSåög
(
˘x
, 
°r
);

49033  
∫d_mode
;

49034 
	}
}

49037 
öt64_t
 
	m¥ec
;

49038 
bf_Êags_t
 
	mÊags
;

49039 } 
	tBigDecimÆEnv
;

49041 
	$js_bigdecimÆ_gë_ív
(
JSC⁄ãxt
 *
˘x
, 
BigDecimÆEnv
 *
„
,

49042 
JSVÆueC⁄°
 
obj
)

49044 
JSVÆue
 
¥›
;

49045 
öt64_t
 
vÆ
;

49046 
BOOL
 
has_¥ec
;

49047 
∫d_mode
;

49049 i‡(!
	`JS_IsObje˘
(
obj
)) {

49050 
	`JS_ThrowTy≥Eº‹NŸAnObje˘
(
˘x
);

49053 
¥›
 = 
	`JS_GëPr›îty
(
˘x
, 
obj
, 
JS_ATOM_roundögMode
);

49054 i‡(
	`JS_IsEx˚±i⁄
(
¥›
))

49056 
∫d_mode
 = 
	`js_bigdecimÆ_gë_∫d_mode
(
˘x
, 
¥›
);

49057 
	`JS_FªeVÆue
(
˘x
, 
¥›
);

49058 i‡(
∫d_mode
 < 0)

49060 
„
->
Êags
 = 
∫d_mode
;

49062 
¥›
 = 
	`JS_GëPr›îty
(
˘x
, 
obj
, 
JS_ATOM_maximumSignifiˇ¡Digôs
);

49063 i‡(
	`JS_IsEx˚±i⁄
(
¥›
))

49065 
has_¥ec
 = 
FALSE
;

49066 i‡(!
	`JS_IsUndeföed
(
¥›
)) {

49067 i‡(
	`JS_ToI¡64S©Fªe
(
˘x
, &
vÆ
, 
¥›
))

49069 i‡(
vÆ
 < 1 || vÆ > 
BF_PREC_MAX
)

49070 
övÆid_¥ecisi⁄
;

49071 
„
->
¥ec
 = 
vÆ
;

49072 
has_¥ec
 = 
TRUE
;

49075 
¥›
 = 
	`JS_GëPr›îty
(
˘x
, 
obj
, 
JS_ATOM_maximumFø˘i⁄Digôs
);

49076 i‡(
	`JS_IsEx˚±i⁄
(
¥›
))

49078 i‡(!
	`JS_IsUndeföed
(
¥›
)) {

49079 i‡(
has_¥ec
) {

49080 
	`JS_FªeVÆue
(
˘x
, 
¥›
);

49081 
	`JS_ThrowTy≥Eº‹
(
˘x
, "cannotÖrovide both maximumSignificantDigitsánd maximumFractionDigits");

49084 i‡(
	`JS_ToI¡64S©Fªe
(
˘x
, &
vÆ
, 
¥›
))

49086 i‡(
vÆ
 < 0 || vÆ > 
BF_PREC_MAX
) {

49087 
övÆid_¥ecisi⁄
:

49088 
	`JS_ThrowTy≥Eº‹
(
˘x
, "invalidÖrecision");

49091 
„
->
¥ec
 = 
vÆ
;

49092 
„
->
Êags
 |
BF_FLAG_RADPNT_PREC
;

49093 
has_¥ec
 = 
TRUE
;

49095 i‡(!
has_¥ec
) {

49096 
	`JS_ThrowTy≥Eº‹
(
˘x
, "precision must beÖresent");

49100 
	}
}

49103 
JSVÆue
 
	$js_bigdecimÆ_f›
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

49104 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
, 
magic
)

49106 
bfdec_t
 *
a
, *
b
, 
r_s
, *
r
 = &r_s;

49107 
JSVÆue
 
›1
, 
›2
, 
ªs
;

49108 
BigDecimÆEnv
 
„_s
, *
„
 = &fe_s;

49109 
›_cou¡
, 
ªt
;

49111 i‡(
magic
 =
MATH_OP_SQRT
 ||

49112 
magic
 =
MATH_OP_ROUND
)

49113 
›_cou¡
 = 1;

49115 
›_cou¡
 = 2;

49117 
›1
 = 
	`JS_ToNumîic
(
˘x
, 
¨gv
[0]);

49118 i‡(
	`JS_IsEx˚±i⁄
(
›1
))

49119  
›1
;

49120 
a
 = 
	`JS_ToBigDecimÆ
(
˘x
, 
›1
);

49121 i‡(!
a
) {

49122 
	`JS_FªeVÆue
(
˘x
, 
›1
);

49123  
JS_EXCEPTION
;

49125 i‡(
›_cou¡
 >= 2) {

49126 
›2
 = 
	`JS_ToNumîic
(
˘x
, 
¨gv
[1]);

49127 i‡(
	`JS_IsEx˚±i⁄
(
›2
)) {

49128 
	`JS_FªeVÆue
(
˘x
, 
›1
);

49129  
›2
;

49131 
b
 = 
	`JS_ToBigDecimÆ
(
˘x
, 
›2
);

49132 i‡(!
b
)

49133 
Áû
;

49135 
›2
 = 
JS_UNDEFINED
;

49136 
b
 = 
NULL
;

49138 
„
->
Êags
 = 
BF_RNDZ
;

49139 
„
->
¥ec
 = 
BF_PREC_INF
;

49140 i‡(
›_cou¡
 < 
¨gc
) {

49141 i‡(
	`js_bigdecimÆ_gë_ív
(
˘x
, 
„
, 
¨gv
[
›_cou¡
]))

49142 
Áû
;

49145 
ªs
 = 
	`JS_NewBigDecimÆ
(
˘x
);

49146 i‡(
	`JS_IsEx˚±i⁄
(
ªs
)) {

49147 
Áû
:

49148 
	`JS_FªeVÆue
(
˘x
, 
›1
);

49149 
	`JS_FªeVÆue
(
˘x
, 
›2
);

49150  
JS_EXCEPTION
;

49152 
r
 = 
	`JS_GëBigDecimÆ
(
ªs
);

49153 
magic
) {

49154 
MATH_OP_ADD
:

49155 
ªt
 = 
	`bfdec_add
(
r
, 
a
, 
b
, 
„
->
¥ec
, fe->
Êags
);

49157 
MATH_OP_SUB
:

49158 
ªt
 = 
	`bfdec_sub
(
r
, 
a
, 
b
, 
„
->
¥ec
, fe->
Êags
);

49160 
MATH_OP_MUL
:

49161 
ªt
 = 
	`bfdec_mul
(
r
, 
a
, 
b
, 
„
->
¥ec
, fe->
Êags
);

49163 
MATH_OP_DIV
:

49164 
ªt
 = 
	`bfdec_div
(
r
, 
a
, 
b
, 
„
->
¥ec
, fe->
Êags
);

49166 
MATH_OP_FMOD
:

49167 
ªt
 = 
	`bfdec_ªm
(
r
, 
a
, 
b
, 
„
->
¥ec
, fe->
Êags
, 
BF_RNDZ
);

49169 
MATH_OP_SQRT
:

49170 
ªt
 = 
	`bfdec_sqπ
(
r
, 
a
, 
„
->
¥ec
, fe->
Êags
);

49172 
MATH_OP_ROUND
:

49173 
ªt
 = 
	`bfdec_£t
(
r
, 
a
);

49174 i‡(!(
ªt
 & 
BF_ST_MEM_ERROR
))

49175 
ªt
 = 
	`bfdec_round
(
r
, 
„
->
¥ec
, fe->
Êags
);

49178 
	`ab‹t
();

49180 
	`JS_FªeVÆue
(
˘x
, 
›1
);

49181 
	`JS_FªeVÆue
(
˘x
, 
›2
);

49182 
ªt
 &
BF_ST_MEM_ERROR
 | 
BF_ST_DIVIDE_ZERO
 | 
BF_ST_INVALID_OP
 |

49183 
BF_ST_OVERFLOW
;

49184 i‡(
ªt
 != 0) {

49185 
	`JS_FªeVÆue
(
˘x
, 
ªs
);

49186  
	`throw_bf_ex˚±i⁄
(
˘x
, 
ªt
);

49188  
ªs
;

49190 
	}
}

49192 
JSVÆue
 
	$js_bigdecimÆ_toFixed
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

49193 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

49195 
JSVÆue
 
vÆ
, 
ªt
;

49196 
öt64_t
 
f
;

49197 
∫d_mode
;

49199 
vÆ
 = 
	`js_thisBigDecimÆVÆue
(
˘x
, 
this_vÆ
);

49200 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

49201  
vÆ
;

49202 i‡(
	`JS_ToI¡64S©
(
˘x
, &
f
, 
¨gv
[0]))

49203 
Áû
;

49204 i‡(
f
 < 0 || f > 
BF_PREC_MAX
) {

49205 
	`JS_ThrowR™geEº‹
(
˘x
, "invalidÇumber of digits");

49206 
Áû
;

49208 
∫d_mode
 = 
BF_RNDNA
;

49209 i‡(
¨gc
 > 1) {

49210 
∫d_mode
 = 
	`js_bigdecimÆ_gë_∫d_mode
(
˘x
, 
¨gv
[1]);

49211 i‡(
∫d_mode
 < 0)

49212 
Áû
;

49214 
ªt
 = 
	`js_bigdecimÆ_to_°rög1
(
˘x
, 
vÆ
, 
f
, 
∫d_mode
 | 
BF_FTOA_FORMAT_FRAC
);

49215 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

49216  
ªt
;

49217 
Áû
:

49218 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

49219  
JS_EXCEPTION
;

49220 
	}
}

49222 
JSVÆue
 
	$js_bigdecimÆ_toExp⁄ítül
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

49223 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

49225 
JSVÆue
 
vÆ
, 
ªt
;

49226 
öt64_t
 
f
;

49227 
∫d_mode
;

49229 
vÆ
 = 
	`js_thisBigDecimÆVÆue
(
˘x
, 
this_vÆ
);

49230 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

49231  
vÆ
;

49232 i‡(
	`JS_ToI¡64S©
(
˘x
, &
f
, 
¨gv
[0]))

49233 
Áû
;

49234 i‡(
	`JS_IsUndeföed
(
¨gv
[0])) {

49235 
ªt
 = 
	`js_bigdecimÆ_to_°rög1
(
˘x
, 
vÆ
, 0,

49236 
BF_RNDN
 | 
BF_FTOA_FORMAT_FREE_MIN
 | 
BF_FTOA_FORCE_EXP
);

49238 i‡(
f
 < 0 || f > 
BF_PREC_MAX
) {

49239 
	`JS_ThrowR™geEº‹
(
˘x
, "invalidÇumber of digits");

49240 
Áû
;

49242 
∫d_mode
 = 
BF_RNDNA
;

49243 i‡(
¨gc
 > 1) {

49244 
∫d_mode
 = 
	`js_bigdecimÆ_gë_∫d_mode
(
˘x
, 
¨gv
[1]);

49245 i‡(
∫d_mode
 < 0)

49246 
Áû
;

49248 
ªt
 = 
	`js_bigdecimÆ_to_°rög1
(
˘x
, 
vÆ
, 
f
 + 1,

49249 
∫d_mode
 | 
BF_FTOA_FORMAT_FIXED
 | 
BF_FTOA_FORCE_EXP
);

49251 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

49252  
ªt
;

49253 
Áû
:

49254 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

49255  
JS_EXCEPTION
;

49256 
	}
}

49258 
JSVÆue
 
	$js_bigdecimÆ_toPªcisi⁄
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

49259 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

49261 
JSVÆue
 
vÆ
, 
ªt
;

49262 
öt64_t
 
p
;

49263 
∫d_mode
;

49265 
vÆ
 = 
	`js_thisBigDecimÆVÆue
(
˘x
, 
this_vÆ
);

49266 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

49267  
vÆ
;

49268 i‡(
	`JS_IsUndeföed
(
¨gv
[0])) {

49269  
	`JS_ToSåögFªe
(
˘x
, 
vÆ
);

49271 i‡(
	`JS_ToI¡64S©
(
˘x
, &
p
, 
¨gv
[0]))

49272 
Áû
;

49273 i‡(
p
 < 1 ||Ö > 
BF_PREC_MAX
) {

49274 
	`JS_ThrowR™geEº‹
(
˘x
, "invalidÇumber of digits");

49275 
Áû
;

49277 
∫d_mode
 = 
BF_RNDNA
;

49278 i‡(
¨gc
 > 1) {

49279 
∫d_mode
 = 
	`js_bigdecimÆ_gë_∫d_mode
(
˘x
, 
¨gv
[1]);

49280 i‡(
∫d_mode
 < 0)

49281 
Áû
;

49283 
ªt
 = 
	`js_bigdecimÆ_to_°rög1
(
˘x
, 
vÆ
, 
p
,

49284 
∫d_mode
 | 
BF_FTOA_FORMAT_FIXED
);

49285 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

49286  
ªt
;

49287 
Áû
:

49288 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

49289  
JS_EXCEPTION
;

49290 
	}
}

49292 c⁄° 
JSCFun˘i⁄Li°E¡ry
 
	gjs_bigdecimÆ_¥Ÿo_funcs
[] = {

49293 
JS_CFUNC_DEF
("toSåög", 0, 
js_bigdecimÆ_toSåög
 ),

49294 
JS_CFUNC_DEF
("vÆueOf", 0, 
js_bigdecimÆ_vÆueOf
 ),

49295 
JS_CFUNC_DEF
("toPªcisi⁄", 1, 
js_bigdecimÆ_toPªcisi⁄
 ),

49296 
JS_CFUNC_DEF
("toFixed", 1, 
js_bigdecimÆ_toFixed
 ),

49297 
JS_CFUNC_DEF
("toExp⁄ítül", 1, 
js_bigdecimÆ_toExp⁄ítül
 ),

49300 c⁄° 
JSCFun˘i⁄Li°E¡ry
 
	gjs_bigdecimÆ_funcs
[] = {

49301 
JS_CFUNC_MAGIC_DEF
("add", 2, 
js_bigdecimÆ_f›
, 
MATH_OP_ADD
 ),

49302 
JS_CFUNC_MAGIC_DEF
("sub", 2, 
js_bigdecimÆ_f›
, 
MATH_OP_SUB
 ),

49303 
JS_CFUNC_MAGIC_DEF
("mul", 2, 
js_bigdecimÆ_f›
, 
MATH_OP_MUL
 ),

49304 
JS_CFUNC_MAGIC_DEF
("div", 2, 
js_bigdecimÆ_f›
, 
MATH_OP_DIV
 ),

49305 
JS_CFUNC_MAGIC_DEF
("mod", 2, 
js_bigdecimÆ_f›
, 
MATH_OP_FMOD
 ),

49306 
JS_CFUNC_MAGIC_DEF
("round", 1, 
js_bigdecimÆ_f›
, 
MATH_OP_ROUND
 ),

49307 
JS_CFUNC_MAGIC_DEF
("sqπ", 1, 
js_bigdecimÆ_f›
, 
MATH_OP_SQRT
 ),

49310 
	$JS_AddI¡rösicBigDecimÆ
(
JSC⁄ãxt
 *
˘x
)

49312 
JSRu¡ime
 *
π
 = 
˘x
->rt;

49313 
JSVÆue
 
obj1
;

49315 
π
->
bigdecimÆ_›s
.
to_°rög
 = 
js_bigdecimÆ_to_°rög
;

49316 
π
->
bigdecimÆ_›s
.
‰om_°rög
 = 
js_°rög_to_bigdecimÆ
;

49317 
π
->
bigdecimÆ_›s
.
u«ry_¨ôh
 = 
js_u«ry_¨ôh_bigdecimÆ
;

49318 
π
->
bigdecimÆ_›s
.
bö¨y_¨ôh
 = 
js_bö¨y_¨ôh_bigdecimÆ
;

49319 
π
->
bigdecimÆ_›s
.
com∑ª
 = 
js_com∑ª_bigdecimÆ
;

49321 
˘x
->
˛ass_¥Ÿo
[
JS_CLASS_BIG_DECIMAL
] = 
	`JS_NewObje˘
(ctx);

49322 
	`JS_SëPr›îtyFun˘i⁄Li°
(
˘x
, ctx->
˛ass_¥Ÿo
[
JS_CLASS_BIG_DECIMAL
],

49323 
js_bigdecimÆ_¥Ÿo_funcs
,

49324 
	`cou¡of
(
js_bigdecimÆ_¥Ÿo_funcs
));

49325 
obj1
 = 
	`JS_NewCFun˘i⁄
(
˘x
, 
js_bigdecimÆ_c⁄°ru˘‹
, "BigDecimal", 1);

49326 
	`JS_NewGlobÆCC⁄°ru˘‹2
(
˘x
, 
obj1
, "BigDecimal",

49327 
˘x
->
˛ass_¥Ÿo
[
JS_CLASS_BIG_DECIMAL
]);

49328 
	`JS_SëPr›îtyFun˘i⁄Li°
(
˘x
, 
obj1
, 
js_bigdecimÆ_funcs
,

49329 
	`cou¡of
(
js_bigdecimÆ_funcs
));

49330 
	}
}

49332 
	$JS_E«bÀBignumExt
(
JSC⁄ãxt
 *
˘x
, 
BOOL
 
íabÀ
)

49334 
˘x
->
bignum_ext
 = 
íabÀ
;

49335 
	}
}

49339 c⁄° * c⁄° 
	g«tive_îr‹_«me
[
JS_NATIVE_ERROR_COUNT
] = {

49347 
	$JS_AddI¡rösicBasicObje˘s
(
JSC⁄ãxt
 *
˘x
)

49349 
JSVÆue
 
¥Ÿo
;

49350 
i
;

49352 
˘x
->
˛ass_¥Ÿo
[
JS_CLASS_OBJECT
] = 
	`JS_NewObje˘PrŸo
(˘x, 
JS_NULL
);

49353 
˘x
->
fun˘i⁄_¥Ÿo
 = 
	`JS_NewCFun˘i⁄3
(˘x, 
js_fun˘i⁄_¥Ÿo
, "", 0,

49354 
JS_CFUNC_gíîic
, 0,

49355 
˘x
->
˛ass_¥Ÿo
[
JS_CLASS_OBJECT
]);

49356 
˘x
->
˛ass_¥Ÿo
[
JS_CLASS_BYTECODE_FUNCTION
] = 
	`JS_DupVÆue
(˘x, ctx->
fun˘i⁄_¥Ÿo
);

49357 
˘x
->
˛ass_¥Ÿo
[
JS_CLASS_ERROR
] = 
	`JS_NewObje˘
(ctx);

49361 
	`JS_DeföePr›îtyVÆue
(
˘x
, ctx->
˛ass_¥Ÿo
[
JS_CLASS_ERROR
], 
JS_ATOM_«me
,

49362 
	`JS_AtomToSåög
(
˘x
, 
JS_ATOM_Eº‹
),

49363 
JS_PROP_WRITABLE
 | 
JS_PROP_CONFIGURABLE
);

49364 
	`JS_DeföePr›îtyVÆue
(
˘x
, ctx->
˛ass_¥Ÿo
[
JS_CLASS_ERROR
], 
JS_ATOM_mesßge
,

49365 
	`JS_AtomToSåög
(
˘x
, 
JS_ATOM_em±y_°rög
),

49366 
JS_PROP_WRITABLE
 | 
JS_PROP_CONFIGURABLE
);

49368 
	`JS_SëPr›îtyFun˘i⁄Li°
(
˘x
, ctx->
˛ass_¥Ÿo
[
JS_CLASS_ERROR
],

49369 
js_îr‹_¥Ÿo_funcs
,

49370 
	`cou¡of
(
js_îr‹_¥Ÿo_funcs
));

49372 
i
 = 0; i < 
JS_NATIVE_ERROR_COUNT
; i++) {

49373 
¥Ÿo
 = 
	`JS_NewObje˘PrŸo
(
˘x
, ctx->
˛ass_¥Ÿo
[
JS_CLASS_ERROR
]);

49374 
	`JS_DeföePr›îtyVÆue
(
˘x
, 
¥Ÿo
, 
JS_ATOM_«me
,

49375 
	`JS_NewAtomSåög
(
˘x
, 
«tive_îr‹_«me
[
i
]),

49376 
JS_PROP_WRITABLE
 | 
JS_PROP_CONFIGURABLE
);

49377 
	`JS_DeföePr›îtyVÆue
(
˘x
, 
¥Ÿo
, 
JS_ATOM_mesßge
,

49378 
	`JS_AtomToSåög
(
˘x
, 
JS_ATOM_em±y_°rög
),

49379 
JS_PROP_WRITABLE
 | 
JS_PROP_CONFIGURABLE
);

49380 
˘x
->
«tive_îr‹_¥Ÿo
[
i
] = 
¥Ÿo
;

49382 
	`JS_SëPr›îtyFun˘i⁄Li°
(
˘x
, ctx->
«tive_îr‹_¥Ÿo
[
JS_AGGREGATE_ERROR
],

49383 
js_aggªg©e_îr‹_¥Ÿo_funcs
,

49384 
	`cou¡of
(
js_aggªg©e_îr‹_¥Ÿo_funcs
));

49387 
˘x
->
˛ass_¥Ÿo
[
JS_CLASS_ARRAY
] =

49388 
	`JS_NewObje˘PrŸoCœss
(
˘x
, ctx->
˛ass_¥Ÿo
[
JS_CLASS_OBJECT
],

49389 
JS_CLASS_ARRAY
);

49391 
˘x
->
¨øy_sh≠e
 = 
	`js_√w_sh≠e2
(˘x, 
	`gë_¥Ÿo_obj
(˘x->
˛ass_¥Ÿo
[
JS_CLASS_ARRAY
]),

49392 
JS_PROP_INITIAL_HASH_SIZE
, 1);

49393 
	`add_sh≠e_¥›îty
(
˘x
, &˘x->
¨øy_sh≠e
, 
NULL
,

49394 
JS_ATOM_Àngth
, 
JS_PROP_WRITABLE
 | 
JS_PROP_LENGTH
);

49402 
	}
}

49404 
	$JS_AddI¡rösicBa£Obje˘s
(
JSC⁄ãxt
 *
˘x
)

49406 
i
;

49407 
JSVÆueC⁄°
 
obj
, 
numbî_obj
;

49408 
JSVÆue
 
obj1
;

49410 
˘x
->
throw_ty≥_îr‹
 = 
	`JS_NewCFun˘i⁄
(˘x, 
js_throw_ty≥_îr‹
, 
NULL
, 0);

49413 
obj1
 = 
	`JS_NewCFun˘i⁄
(
˘x
, 
js_fun˘i⁄_¥Ÿo_ˇŒî
, 
NULL
, 0);

49414 
	`JS_DeföePr›îty
(
˘x
, ctx->
fun˘i⁄_¥Ÿo
, 
JS_ATOM_ˇŒî
, 
JS_UNDEFINED
,

49415 
obj1
, 
˘x
->
throw_ty≥_îr‹
,

49416 
JS_PROP_HAS_GET
 | 
JS_PROP_HAS_SET
 |

49417 
JS_PROP_HAS_CONFIGURABLE
 | 
JS_PROP_CONFIGURABLE
);

49418 
	`JS_DeföePr›îty
(
˘x
, ctx->
fun˘i⁄_¥Ÿo
, 
JS_ATOM_¨gumíts
, 
JS_UNDEFINED
,

49419 
obj1
, 
˘x
->
throw_ty≥_îr‹
,

49420 
JS_PROP_HAS_GET
 | 
JS_PROP_HAS_SET
 |

49421 
JS_PROP_HAS_CONFIGURABLE
 | 
JS_PROP_CONFIGURABLE
);

49422 
	`JS_FªeVÆue
(
˘x
, 
obj1
);

49423 
	`JS_FªeVÆue
(
˘x
, 
	`js_obje˘_£Æ
(˘x, 
JS_UNDEFINED
, 1, (
JSVÆueC⁄°
 *)&˘x->
throw_ty≥_îr‹
, 1));

49425 
˘x
->
globÆ_obj
 = 
	`JS_NewObje˘
(ctx);

49426 
˘x
->
globÆ_v¨_obj
 = 
	`JS_NewObje˘PrŸo
(˘x, 
JS_NULL
);

49429 
obj
 = 
	`JS_NewGlobÆCC⁄°ru˘‹
(
˘x
, "Obje˘", 
js_obje˘_c⁄°ru˘‹
, 1,

49430 
˘x
->
˛ass_¥Ÿo
[
JS_CLASS_OBJECT
]);

49431 
	`JS_SëPr›îtyFun˘i⁄Li°
(
˘x
, 
obj
, 
js_obje˘_funcs
, 
	`cou¡of
(js_object_funcs));

49432 
	`JS_SëPr›îtyFun˘i⁄Li°
(
˘x
, ctx->
˛ass_¥Ÿo
[
JS_CLASS_OBJECT
],

49433 
js_obje˘_¥Ÿo_funcs
, 
	`cou¡of
(js_object_proto_funcs));

49436 
	`JS_SëPr›îtyFun˘i⁄Li°
(
˘x
, ctx->
fun˘i⁄_¥Ÿo
, 
js_fun˘i⁄_¥Ÿo_funcs
, 
	`cou¡of
(js_function_proto_funcs));

49437 
˘x
->
fun˘i⁄_˘‹
 = 
	`JS_NewCFun˘i⁄Magic
(˘x, 
js_fun˘i⁄_c⁄°ru˘‹
,

49438 "Fun˘i⁄", 1, 
JS_CFUNC_c⁄°ru˘‹_‹_func_magic
,

49439 
JS_FUNC_NORMAL
);

49440 
	`JS_NewGlobÆCC⁄°ru˘‹2
(
˘x
, 
	`JS_DupVÆue
(˘x, ctx->
fun˘i⁄_˘‹
), "Function",

49441 
˘x
->
fun˘i⁄_¥Ÿo
);

49444 
obj1
 = 
	`JS_NewCFun˘i⁄Magic
(
˘x
, 
js_îr‹_c⁄°ru˘‹
,

49445 "Eº‹", 1, 
JS_CFUNC_c⁄°ru˘‹_‹_func_magic
, -1);

49446 
	`JS_NewGlobÆCC⁄°ru˘‹2
(
˘x
, 
obj1
,

49447 "Eº‹", 
˘x
->
˛ass_¥Ÿo
[
JS_CLASS_ERROR
]);

49449 
i
 = 0; i < 
JS_NATIVE_ERROR_COUNT
; i++) {

49450 
JSVÆue
 
func_obj
;

49451 
n_¨gs
;

49452 
n_¨gs
 = 1 + (
i
 =
JS_AGGREGATE_ERROR
);

49453 
func_obj
 = 
	`JS_NewCFun˘i⁄3
(
˘x
, (
JSCFun˘i⁄
 *)
js_îr‹_c⁄°ru˘‹
,

49454 
«tive_îr‹_«me
[
i
], 
n_¨gs
,

49455 
JS_CFUNC_c⁄°ru˘‹_‹_func_magic
, 
i
, 
obj1
);

49456 
	`JS_NewGlobÆCC⁄°ru˘‹2
(
˘x
, 
func_obj
, 
«tive_îr‹_«me
[
i
],

49457 
˘x
->
«tive_îr‹_¥Ÿo
[
i
]);

49461 
˘x
->
ôî©‹_¥Ÿo
 = 
	`JS_NewObje˘
(ctx);

49462 
	`JS_SëPr›îtyFun˘i⁄Li°
(
˘x
, ctx->
ôî©‹_¥Ÿo
,

49463 
js_ôî©‹_¥Ÿo_funcs
,

49464 
	`cou¡of
(
js_ôî©‹_¥Ÿo_funcs
));

49467 
	`JS_SëPr›îtyFun˘i⁄Li°
(
˘x
, ctx->
˛ass_¥Ÿo
[
JS_CLASS_ARRAY
],

49468 
js_¨øy_¥Ÿo_funcs
,

49469 
	`cou¡of
(
js_¨øy_¥Ÿo_funcs
));

49471 
obj
 = 
	`JS_NewGlobÆCC⁄°ru˘‹
(
˘x
, "Aºay", 
js_¨øy_c⁄°ru˘‹
, 1,

49472 
˘x
->
˛ass_¥Ÿo
[
JS_CLASS_ARRAY
]);

49473 
˘x
->
¨øy_˘‹
 = 
	`JS_DupVÆue
(˘x, 
obj
);

49474 
	`JS_SëPr›îtyFun˘i⁄Li°
(
˘x
, 
obj
, 
js_¨øy_funcs
,

49475 
	`cou¡of
(
js_¨øy_funcs
));

49480 c⁄° 
unsc›abÀs
[] = "copyWithin" "\0" "entries" "\0" "fill" "\0" "find" "\0"

49482 c⁄° *
p
 = 
unsc›abÀs
;

49483 
obj1
 = 
	`JS_NewObje˘PrŸo
(
˘x
, 
JS_NULL
);

49484 
p
 = 
unsc›abÀs
; *p;Ö +
	`°æí
(p) + 1) {

49485 
	`JS_DeföePr›îtyVÆueSå
(
˘x
, 
obj1
, 
p
, 
JS_TRUE
, 
JS_PROP_C_W_E
);

49487 
	`JS_DeföePr›îtyVÆue
(
˘x
, ctx->
˛ass_¥Ÿo
[
JS_CLASS_ARRAY
],

49488 
JS_ATOM_Symbﬁ_unsc›abÀs
, 
obj1
,

49489 
JS_PROP_CONFIGURABLE
);

49493 
˘x
->
¨øy_¥Ÿo_vÆues
 =

49494 
	`JS_GëPr›îty
(
˘x
, ctx->
˛ass_¥Ÿo
[
JS_CLASS_ARRAY
], 
JS_ATOM_vÆues
);

49496 
˘x
->
˛ass_¥Ÿo
[
JS_CLASS_ARRAY_ITERATOR
] = 
	`JS_NewObje˘PrŸo
(˘x, ctx->
ôî©‹_¥Ÿo
);

49497 
	`JS_SëPr›îtyFun˘i⁄Li°
(
˘x
, ctx->
˛ass_¥Ÿo
[
JS_CLASS_ARRAY_ITERATOR
],

49498 
js_¨øy_ôî©‹_¥Ÿo_funcs
,

49499 
	`cou¡of
(
js_¨øy_ôî©‹_¥Ÿo_funcs
));

49504 
	`JS_SëPr›îtyFun˘i⁄Li°
(
˘x
, ctx->
globÆ_obj
, 
js_globÆ_funcs
,

49505 
	`cou¡of
(
js_globÆ_funcs
));

49508 
˘x
->
˛ass_¥Ÿo
[
JS_CLASS_NUMBER
] = 
	`JS_NewObje˘PrŸoCœss
(˘x, ctx->˛ass_¥Ÿo[
JS_CLASS_OBJECT
],

49509 
JS_CLASS_NUMBER
);

49510 
	`JS_SëObje˘D©a
(
˘x
, ctx->
˛ass_¥Ÿo
[
JS_CLASS_NUMBER
], 
	`JS_NewI¡32
(ctx, 0));

49511 
	`JS_SëPr›îtyFun˘i⁄Li°
(
˘x
, ctx->
˛ass_¥Ÿo
[
JS_CLASS_NUMBER
],

49512 
js_numbî_¥Ÿo_funcs
,

49513 
	`cou¡of
(
js_numbî_¥Ÿo_funcs
));

49514 
numbî_obj
 = 
	`JS_NewGlobÆCC⁄°ru˘‹
(
˘x
, "Numbî", 
js_numbî_c⁄°ru˘‹
, 1,

49515 
˘x
->
˛ass_¥Ÿo
[
JS_CLASS_NUMBER
]);

49516 
	`JS_SëPr›îtyFun˘i⁄Li°
(
˘x
, 
numbî_obj
, 
js_numbî_funcs
, 
	`cou¡of
(js_number_funcs));

49519 
˘x
->
˛ass_¥Ÿo
[
JS_CLASS_BOOLEAN
] = 
	`JS_NewObje˘PrŸoCœss
(˘x, ctx->˛ass_¥Ÿo[
JS_CLASS_OBJECT
],

49520 
JS_CLASS_BOOLEAN
);

49521 
	`JS_SëObje˘D©a
(
˘x
, ctx->
˛ass_¥Ÿo
[
JS_CLASS_BOOLEAN
], 
	`JS_NewBoﬁ
(˘x, 
FALSE
));

49522 
	`JS_SëPr›îtyFun˘i⁄Li°
(
˘x
, ctx->
˛ass_¥Ÿo
[
JS_CLASS_BOOLEAN
], 
js_boﬁón_¥Ÿo_funcs
,

49523 
	`cou¡of
(
js_boﬁón_¥Ÿo_funcs
));

49524 
	`JS_NewGlobÆCC⁄°ru˘‹
(
˘x
, "Boﬁón", 
js_boﬁón_c⁄°ru˘‹
, 1,

49525 
˘x
->
˛ass_¥Ÿo
[
JS_CLASS_BOOLEAN
]);

49528 
˘x
->
˛ass_¥Ÿo
[
JS_CLASS_STRING
] = 
	`JS_NewObje˘PrŸoCœss
(˘x, ctx->˛ass_¥Ÿo[
JS_CLASS_OBJECT
],

49529 
JS_CLASS_STRING
);

49530 
	`JS_SëObje˘D©a
(
˘x
, ctx->
˛ass_¥Ÿo
[
JS_CLASS_STRING
], 
	`JS_AtomToSåög
(˘x, 
JS_ATOM_em±y_°rög
));

49531 
obj
 = 
	`JS_NewGlobÆCC⁄°ru˘‹
(
˘x
, "Såög", 
js_°rög_c⁄°ru˘‹
, 1,

49532 
˘x
->
˛ass_¥Ÿo
[
JS_CLASS_STRING
]);

49533 
	`JS_SëPr›îtyFun˘i⁄Li°
(
˘x
, 
obj
, 
js_°rög_funcs
,

49534 
	`cou¡of
(
js_°rög_funcs
));

49535 
	`JS_SëPr›îtyFun˘i⁄Li°
(
˘x
, ctx->
˛ass_¥Ÿo
[
JS_CLASS_STRING
], 
js_°rög_¥Ÿo_funcs
,

49536 
	`cou¡of
(
js_°rög_¥Ÿo_funcs
));

49538 
˘x
->
˛ass_¥Ÿo
[
JS_CLASS_STRING_ITERATOR
] = 
	`JS_NewObje˘PrŸo
(˘x, ctx->
ôî©‹_¥Ÿo
);

49539 
	`JS_SëPr›îtyFun˘i⁄Li°
(
˘x
, ctx->
˛ass_¥Ÿo
[
JS_CLASS_STRING_ITERATOR
],

49540 
js_°rög_ôî©‹_¥Ÿo_funcs
,

49541 
	`cou¡of
(
js_°rög_ôî©‹_¥Ÿo_funcs
));

49544 
	`js_øndom_öô
(
˘x
);

49545 
	`JS_SëPr›îtyFun˘i⁄Li°
(
˘x
, ctx->
globÆ_obj
, 
js_m©h_obj
, 
	`cou¡of
(js_math_obj));

49548 
	`JS_SëPr›îtyFun˘i⁄Li°
(
˘x
, ctx->
globÆ_obj
, 
js_ªÊe˘_obj
, 
	`cou¡of
(js_reflect_obj));

49551 
˘x
->
˛ass_¥Ÿo
[
JS_CLASS_SYMBOL
] = 
	`JS_NewObje˘
(ctx);

49552 
	`JS_SëPr›îtyFun˘i⁄Li°
(
˘x
, ctx->
˛ass_¥Ÿo
[
JS_CLASS_SYMBOL
], 
js_symbﬁ_¥Ÿo_funcs
,

49553 
	`cou¡of
(
js_symbﬁ_¥Ÿo_funcs
));

49554 
obj
 = 
	`JS_NewGlobÆCC⁄°ru˘‹
(
˘x
, "Symbﬁ", 
js_symbﬁ_c⁄°ru˘‹
, 0,

49555 
˘x
->
˛ass_¥Ÿo
[
JS_CLASS_SYMBOL
]);

49556 
	`JS_SëPr›îtyFun˘i⁄Li°
(
˘x
, 
obj
, 
js_symbﬁ_funcs
,

49557 
	`cou¡of
(
js_symbﬁ_funcs
));

49558 
i
 = 
JS_ATOM_Symbﬁ_toPrimôive
; i < 
JS_ATOM_END
; i++) {

49559 
buf
[
ATOM_GET_STR_BUF_SIZE
];

49560 c⁄° *
°r
, *
p
;

49561 
°r
 = 
	`JS_AtomGëSå
(
˘x
, 
buf
, (buf), 
i
);

49563 
p
 = 
	`°rchr
(
°r
, '.');

49564 i‡(
p
)

49565 
°r
 = 
p
 + 1;

49566 
	`JS_DeföePr›îtyVÆueSå
(
˘x
, 
obj
, 
°r
, 
	`JS_AtomToVÆue
(˘x, 
i
), 0);

49570 
˘x
->
˛ass_¥Ÿo
[
JS_CLASS_GENERATOR
] = 
	`JS_NewObje˘PrŸo
(˘x, ctx->
ôî©‹_¥Ÿo
);

49571 
	`JS_SëPr›îtyFun˘i⁄Li°
(
˘x
, ctx->
˛ass_¥Ÿo
[
JS_CLASS_GENERATOR
],

49572 
js_gíî©‹_¥Ÿo_funcs
,

49573 
	`cou¡of
(
js_gíî©‹_¥Ÿo_funcs
));

49575 
˘x
->
˛ass_¥Ÿo
[
JS_CLASS_GENERATOR_FUNCTION
] = 
	`JS_NewObje˘PrŸo
(˘x, ctx->
fun˘i⁄_¥Ÿo
);

49576 
obj1
 = 
	`JS_NewCFun˘i⁄Magic
(
˘x
, 
js_fun˘i⁄_c⁄°ru˘‹
,

49578 
JS_CFUNC_c⁄°ru˘‹_‹_func_magic
, 
JS_FUNC_GENERATOR
);

49579 
	`JS_SëPr›îtyFun˘i⁄Li°
(
˘x
,

49580 
˘x
->
˛ass_¥Ÿo
[
JS_CLASS_GENERATOR_FUNCTION
],

49581 
js_gíî©‹_fun˘i⁄_¥Ÿo_funcs
,

49582 
	`cou¡of
(
js_gíî©‹_fun˘i⁄_¥Ÿo_funcs
));

49583 
	`JS_SëC⁄°ru˘‹2
(
˘x
, ctx->
˛ass_¥Ÿo
[
JS_CLASS_GENERATOR_FUNCTION
],

49584 
˘x
->
˛ass_¥Ÿo
[
JS_CLASS_GENERATOR
],

49585 
JS_PROP_CONFIGURABLE
, JS_PROP_CONFIGURABLE);

49586 
	`JS_SëC⁄°ru˘‹2
(
˘x
, 
obj1
, ctx->
˛ass_¥Ÿo
[
JS_CLASS_GENERATOR_FUNCTION
],

49587 0, 
JS_PROP_CONFIGURABLE
);

49588 
	`JS_FªeVÆue
(
˘x
, 
obj1
);

49591 
˘x
->
evÆ_obj
 = 
	`JS_NewCFun˘i⁄
(˘x, 
js_globÆ_evÆ
, "eval", 1);

49592 
	`JS_DeföePr›îtyVÆue
(
˘x
, ctx->
globÆ_obj
, 
JS_ATOM_evÆ
,

49593 
	`JS_DupVÆue
(
˘x
, ctx->
evÆ_obj
),

49594 
JS_PROP_WRITABLE
 | 
JS_PROP_CONFIGURABLE
);

49596 
	`JS_DeföePr›îtyVÆue
(
˘x
, ctx->
globÆ_obj
, 
JS_ATOM_globÆThis
,

49597 
	`JS_DupVÆue
(
˘x
, ctx->
globÆ_obj
),

49598 
JS_PROP_CONFIGURABLE
 | 
JS_PROP_WRITABLE
);

49599 
	}
}

49603 
uöt8_t
 c⁄° 
	gty≥d_¨øy_size_log2
[
JS_TYPED_ARRAY_COUNT
] = {

49605 #ifde‡
CONFIG_BIGNUM


49611 
JSVÆue
 
	$js_¨øy_buf„r_c⁄°ru˘‹3
(
JSC⁄ãxt
 *
˘x
,

49612 
JSVÆueC⁄°
 
√w_èrgë
,

49613 
uöt64_t
 
Àn
, 
JSCœssID
 
˛ass_id
,

49614 
uöt8_t
 *
buf
,

49615 
JSFªeAºayBuf„rD©aFunc
 *
‰ì_func
,

49616 *
›aque
, 
BOOL
 
Æloc_Êag
)

49618 
JSVÆue
 
obj
;

49619 
JSAºayBuf„r
 *
abuf
 = 
NULL
;

49621 
obj
 = 
	`js_¸óã_‰om_˘‹
(
˘x
, 
√w_èrgë
, 
˛ass_id
);

49622 i‡(
	`JS_IsEx˚±i⁄
(
obj
))

49623  
obj
;

49625 i‡(
Àn
 > 
INT32_MAX
) {

49626 
	`JS_ThrowR™geEº‹
(
˘x
, "invalidárray bufferÜength");

49627 
Áû
;

49629 
abuf
 = 
	`js_mÆloc
(
˘x
, (*abuf));

49630 i‡(!
abuf
)

49631 
Áû
;

49632 
abuf
->
byã_Àngth
 = 
Àn
;

49633 i‡(
Æloc_Êag
) {

49635 
abuf
->
d©a
 = 
	`js_mÆlocz
(
˘x
, 
	`max_öt
(
Àn
, 1));

49636 i‡(!
abuf
->
d©a
)

49637 
Áû
;

49639 
abuf
->
d©a
 = 
buf
;

49641 
	`öô_li°_hód
(&
abuf
->
¨øy_li°
);

49642 
abuf
->
dëached
 = 
FALSE
;

49643 
abuf
->
sh¨ed
 = (
˛ass_id
 =
JS_CLASS_SHARED_ARRAY_BUFFER
);

49644 
abuf
->
›aque
 = opaque;

49645 
abuf
->
‰ì_func
 = free_func;

49646 i‡(
Æloc_Êag
 && 
buf
)

49647 
	`mem˝y
(
abuf
->
d©a
, 
buf
, 
Àn
);

49648 
	`JS_SëO∑que
(
obj
, 
abuf
);

49649  
obj
;

49650 
Áû
:

49651 
	`JS_FªeVÆue
(
˘x
, 
obj
);

49652 
	`js_‰ì
(
˘x
, 
abuf
);

49653  
JS_EXCEPTION
;

49654 
	}
}

49656 
	$js_¨øy_buf„r_‰ì
(
JSRu¡ime
 *
π
, *
›aque
, *
±r
)

49658 
	`js_‰ì_π
(
π
, 
±r
);

49659 
	}
}

49661 
JSVÆue
 
	$js_¨øy_buf„r_c⁄°ru˘‹2
(
JSC⁄ãxt
 *
˘x
,

49662 
JSVÆueC⁄°
 
√w_èrgë
,

49663 
uöt64_t
 
Àn
, 
JSCœssID
 
˛ass_id
)

49665  
	`js_¨øy_buf„r_c⁄°ru˘‹3
(
˘x
, 
√w_èrgë
, 
Àn
, 
˛ass_id
,

49666 
NULL
, 
js_¨øy_buf„r_‰ì
, NULL,

49667 
TRUE
);

49668 
	}
}

49670 
JSVÆue
 
	$js_¨øy_buf„r_c⁄°ru˘‹1
(
JSC⁄ãxt
 *
˘x
,

49671 
JSVÆueC⁄°
 
√w_èrgë
,

49672 
uöt64_t
 
Àn
)

49674  
	`js_¨øy_buf„r_c⁄°ru˘‹2
(
˘x
, 
√w_èrgë
, 
Àn
,

49675 
JS_CLASS_ARRAY_BUFFER
);

49676 
	}
}

49678 
JSVÆue
 
	$JS_NewAºayBuf„r
(
JSC⁄ãxt
 *
˘x
, 
uöt8_t
 *
buf
, 
size_t
 
Àn
,

49679 
JSFªeAºayBuf„rD©aFunc
 *
‰ì_func
, *
›aque
,

49680 
BOOL
 
is_sh¨ed
)

49682  
	`js_¨øy_buf„r_c⁄°ru˘‹3
(
˘x
, 
JS_UNDEFINED
, 
Àn
,

49683 
is_sh¨ed
 ? 
JS_CLASS_SHARED_ARRAY_BUFFER
 : 
JS_CLASS_ARRAY_BUFFER
,

49684 
buf
, 
‰ì_func
, 
›aque
, 
FALSE
);

49685 
	}
}

49688 
JSVÆue
 
	$JS_NewAºayBuf„rC›y
(
JSC⁄ãxt
 *
˘x
, c⁄° 
uöt8_t
 *
buf
, 
size_t
 
Àn
)

49690  
	`js_¨øy_buf„r_c⁄°ru˘‹3
(
˘x
, 
JS_UNDEFINED
, 
Àn
,

49691 
JS_CLASS_ARRAY_BUFFER
,

49692 (
uöt8_t
 *)
buf
,

49693 
js_¨øy_buf„r_‰ì
, 
NULL
,

49694 
TRUE
);

49695 
	}
}

49697 
JSVÆue
 
	$js_¨øy_buf„r_c⁄°ru˘‹
(
JSC⁄ãxt
 *
˘x
,

49698 
JSVÆueC⁄°
 
√w_èrgë
,

49699 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

49701 
uöt64_t
 
Àn
;

49702 i‡(
	`JS_ToIndex
(
˘x
, &
Àn
, 
¨gv
[0]))

49703  
JS_EXCEPTION
;

49704  
	`js_¨øy_buf„r_c⁄°ru˘‹1
(
˘x
, 
√w_èrgë
, 
Àn
);

49705 
	}
}

49707 
JSVÆue
 
	$js_sh¨ed_¨øy_buf„r_c⁄°ru˘‹
(
JSC⁄ãxt
 *
˘x
,

49708 
JSVÆueC⁄°
 
√w_èrgë
,

49709 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

49711 
uöt64_t
 
Àn
;

49712 i‡(
	`JS_ToIndex
(
˘x
, &
Àn
, 
¨gv
[0]))

49713  
JS_EXCEPTION
;

49714  
	`js_¨øy_buf„r_c⁄°ru˘‹2
(
˘x
, 
√w_èrgë
, 
Àn
,

49715 
JS_CLASS_SHARED_ARRAY_BUFFER
);

49716 
	}
}

49719 
	$js_¨øy_buf„r_föÆizî
(
JSRu¡ime
 *
π
, 
JSVÆue
 
vÆ
)

49721 
JSObje˘
 *
p
 = 
	`JS_VALUE_GET_OBJ
(
vÆ
);

49722 
JSAºayBuf„r
 *
abuf
 = 
p
->
u
.
¨øy_buf„r
;

49723 i‡(
abuf
) {

49728 i‡(
abuf
->
‰ì_func
)

49729 
abuf
->
	`‰ì_func
(
π
,ábuf->
›aque
,ábuf->
d©a
);

49730 
	`js_‰ì_π
(
π
, 
abuf
);

49732 
	}
}

49734 
JSVÆue
 
	$js_¨øy_buf„r_isVõw
(
JSC⁄ãxt
 *
˘x
,

49735 
JSVÆueC⁄°
 
this_vÆ
,

49736 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

49738 
JSObje˘
 *
p
;

49739 
BOOL
 
ªs
;

49740 
ªs
 = 
FALSE
;

49741 i‡(
	`JS_VALUE_GET_TAG
(
¨gv
[0]Ë=
JS_TAG_OBJECT
) {

49742 
p
 = 
	`JS_VALUE_GET_OBJ
(
¨gv
[0]);

49743 i‡(
p
->
˛ass_id
 >
JS_CLASS_UINT8C_ARRAY
 &&

49744 
p
->
˛ass_id
 <
JS_CLASS_DATAVIEW
) {

49745 
ªs
 = 
TRUE
;

49748  
	`JS_NewBoﬁ
(
˘x
, 
ªs
);

49749 
	}
}

49751 c⁄° 
JSCFun˘i⁄Li°E¡ry
 
	gjs_¨øy_buf„r_funcs
[] = {

49752 
JS_CFUNC_DEF
("isVõw", 1, 
js_¨øy_buf„r_isVõw
 ),

49753 
JS_CGETSET_DEF
("[Symbﬁ.•ecõs]", 
js_gë_this
, 
NULL
 ),

49756 
JSVÆue
 
	$JS_ThrowTy≥Eº‹DëachedAºayBuf„r
(
JSC⁄ãxt
 *
˘x
)

49758  
	`JS_ThrowTy≥Eº‹
(
˘x
, "ArrayBuffer is detached");

49759 
	}
}

49761 
JSVÆue
 
	$js_¨øy_buf„r_gë_byãLígth
(
JSC⁄ãxt
 *
˘x
,

49762 
JSVÆueC⁄°
 
this_vÆ
,

49763 
˛ass_id
)

49765 
JSAºayBuf„r
 *
abuf
 = 
	`JS_GëO∑que2
(
˘x
, 
this_vÆ
, 
˛ass_id
);

49766 i‡(!
abuf
)

49767  
JS_EXCEPTION
;

49768 i‡(
abuf
->
dëached
)

49769  
	`JS_ThrowTy≥Eº‹DëachedAºayBuf„r
(
˘x
);

49770  
	`JS_NewUöt32
(
˘x
, 
abuf
->
byã_Àngth
);

49771 
	}
}

49773 
	$JS_DëachAºayBuf„r
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
obj
)

49775 
JSAºayBuf„r
 *
abuf
 = 
	`JS_GëO∑que
(
obj
, 
JS_CLASS_ARRAY_BUFFER
);

49776 
li°_hód
 *
ñ
;

49778 i‡(!
abuf
 ||ábuf->
dëached
)

49780 i‡(
abuf
->
‰ì_func
)

49781 
abuf
->
	`‰ì_func
(
˘x
->
π
,ábuf->
›aque
,ábuf->
d©a
);

49782 
abuf
->
d©a
 = 
NULL
;

49783 
abuf
->
byã_Àngth
 = 0;

49784 
abuf
->
dëached
 = 
TRUE
;

49786 
	`li°_f‹_óch
(
ñ
, &
abuf
->
¨øy_li°
) {

49787 
JSTy≥dAºay
 *
è
;

49788 
JSObje˘
 *
p
;

49790 
è
 = 
	`li°_íåy
(
ñ
, 
JSTy≥dAºay
, 
lök
);

49791 
p
 = 
è
->
obj
;

49793 i‡(
p
->
˛ass_id
 !
JS_CLASS_DATAVIEW
) {

49794 
p
->
u
.
¨øy
.
cou¡
 = 0;

49795 
p
->
u
.
¨øy
.u.
±r
 = 
NULL
;

49798 
	}
}

49801 
JSAºayBuf„r
 *
	$js_gë_¨øy_buf„r
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
obj
)

49803 
JSObje˘
 *
p
;

49804 i‡(
	`JS_VALUE_GET_TAG
(
obj
Ë!
JS_TAG_OBJECT
)

49805 
Áû
;

49806 
p
 = 
	`JS_VALUE_GET_OBJ
(
obj
);

49807 i‡(
p
->
˛ass_id
 !
JS_CLASS_ARRAY_BUFFER
 &&

49808 
p
->
˛ass_id
 !
JS_CLASS_SHARED_ARRAY_BUFFER
) {

49809 
Áû
:

49810 
	`JS_ThrowTy≥Eº‹InvÆidCœss
(
˘x
, 
JS_CLASS_ARRAY_BUFFER
);

49811  
NULL
;

49813  
p
->
u
.
¨øy_buf„r
;

49814 
	}
}

49818 
uöt8_t
 *
	$JS_GëAºayBuf„r
(
JSC⁄ãxt
 *
˘x
, 
size_t
 *
psize
, 
JSVÆueC⁄°
 
obj
)

49820 
JSAºayBuf„r
 *
abuf
 = 
	`js_gë_¨øy_buf„r
(
˘x
, 
obj
);

49821 i‡(!
abuf
)

49822 
Áû
;

49823 i‡(
abuf
->
dëached
) {

49824 
	`JS_ThrowTy≥Eº‹DëachedAºayBuf„r
(
˘x
);

49825 
Áû
;

49827 *
psize
 = 
abuf
->
byã_Àngth
;

49828  
abuf
->
d©a
;

49829 
Áû
:

49830 *
psize
 = 0;

49831  
NULL
;

49832 
	}
}

49834 
JSVÆue
 
	$js_¨øy_buf„r_¶i˚
(
JSC⁄ãxt
 *
˘x
,

49835 
JSVÆueC⁄°
 
this_vÆ
,

49836 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
, 
˛ass_id
)

49838 
JSAºayBuf„r
 *
abuf
, *
√w_abuf
;

49839 
söt64_t
 
Àn
, 
°¨t
, 
íd
, 
√w_Àn
;

49840 
JSVÆue
 
˘‹
, 
√w_obj
;

49842 
abuf
 = 
	`JS_GëO∑que2
(
˘x
, 
this_vÆ
, 
˛ass_id
);

49843 i‡(!
abuf
)

49844  
JS_EXCEPTION
;

49845 i‡(
abuf
->
dëached
)

49846  
	`JS_ThrowTy≥Eº‹DëachedAºayBuf„r
(
˘x
);

49847 
Àn
 = 
abuf
->
byã_Àngth
;

49849 i‡(
	`JS_ToI¡64Cœmp
(
˘x
, &
°¨t
, 
¨gv
[0], 0, 
Àn
,Üen))

49850  
JS_EXCEPTION
;

49852 
íd
 = 
Àn
;

49853 i‡(!
	`JS_IsUndeföed
(
¨gv
[1])) {

49854 i‡(
	`JS_ToI¡64Cœmp
(
˘x
, &
íd
, 
¨gv
[1], 0, 
Àn
,Üen))

49855  
JS_EXCEPTION
;

49857 
√w_Àn
 = 
	`max_öt64
(
íd
 - 
°¨t
, 0);

49858 
˘‹
 = 
	`JS_S≥cõsC⁄°ru˘‹
(
˘x
, 
this_vÆ
, 
JS_UNDEFINED
);

49859 i‡(
	`JS_IsEx˚±i⁄
(
˘‹
))

49860  
˘‹
;

49861 i‡(
	`JS_IsUndeföed
(
˘‹
)) {

49862 
√w_obj
 = 
	`js_¨øy_buf„r_c⁄°ru˘‹2
(
˘x
, 
JS_UNDEFINED
, 
√w_Àn
,

49863 
˛ass_id
);

49865 
JSVÆue
 
¨gs
[1];

49866 
¨gs
[0] = 
	`JS_NewI¡64
(
˘x
, 
√w_Àn
);

49867 
√w_obj
 = 
	`JS_CÆlC⁄°ru˘‹
(
˘x
, 
˘‹
, 1, (
JSVÆueC⁄°
 *)
¨gs
);

49868 
	`JS_FªeVÆue
(
˘x
, 
˘‹
);

49869 
	`JS_FªeVÆue
(
˘x
, 
¨gs
[0]);

49871 i‡(
	`JS_IsEx˚±i⁄
(
√w_obj
))

49872  
√w_obj
;

49873 
√w_abuf
 = 
	`JS_GëO∑que2
(
˘x
, 
√w_obj
, 
˛ass_id
);

49874 i‡(!
√w_abuf
)

49875 
Áû
;

49876 i‡(
	`js_ßme_vÆue
(
˘x
, 
√w_obj
, 
this_vÆ
)) {

49877 
	`JS_ThrowTy≥Eº‹
(
˘x
, "cannot use identical ArrayBuffer");

49878 
Áû
;

49880 i‡(
√w_abuf
->
dëached
) {

49881 
	`JS_ThrowTy≥Eº‹DëachedAºayBuf„r
(
˘x
);

49882 
Áû
;

49884 i‡(
√w_abuf
->
byã_Àngth
 < 
√w_Àn
) {

49885 
	`JS_ThrowTy≥Eº‹
(
˘x
, "new ArrayBuffer isÅoo small");

49886 
Áû
;

49889 i‡(
abuf
->
dëached
) {

49890 
	`JS_ThrowTy≥Eº‹DëachedAºayBuf„r
(
˘x
);

49891 
Áû
;

49893 
	`mem˝y
(
√w_abuf
->
d©a
, 
abuf
->d©®+ 
°¨t
, 
√w_Àn
);

49894  
√w_obj
;

49895 
Áû
:

49896 
	`JS_FªeVÆue
(
˘x
, 
√w_obj
);

49897  
JS_EXCEPTION
;

49898 
	}
}

49900 c⁄° 
JSCFun˘i⁄Li°E¡ry
 
	gjs_¨øy_buf„r_¥Ÿo_funcs
[] = {

49901 
JS_CGETSET_MAGIC_DEF
("byãLígth", 
js_¨øy_buf„r_gë_byãLígth
, 
NULL
, 
JS_CLASS_ARRAY_BUFFER
 ),

49902 
JS_CFUNC_MAGIC_DEF
("¶i˚", 2, 
js_¨øy_buf„r_¶i˚
, 
JS_CLASS_ARRAY_BUFFER
 ),

49903 
JS_PROP_STRING_DEF
("[Symbﬁ.toSåögTag]", "AºayBuf„r", 
JS_PROP_CONFIGURABLE
 ),

49908 c⁄° 
JSCFun˘i⁄Li°E¡ry
 
	gjs_sh¨ed_¨øy_buf„r_funcs
[] = {

49909 
JS_CGETSET_DEF
("[Symbﬁ.•ecõs]", 
js_gë_this
, 
NULL
 ),

49912 c⁄° 
JSCFun˘i⁄Li°E¡ry
 
	gjs_sh¨ed_¨øy_buf„r_¥Ÿo_funcs
[] = {

49913 
JS_CGETSET_MAGIC_DEF
("byãLígth", 
js_¨øy_buf„r_gë_byãLígth
, 
NULL
, 
JS_CLASS_SHARED_ARRAY_BUFFER
 ),

49914 
JS_CFUNC_MAGIC_DEF
("¶i˚", 2, 
js_¨øy_buf„r_¶i˚
, 
JS_CLASS_SHARED_ARRAY_BUFFER
 ),

49915 
JS_PROP_STRING_DEF
("[Symbﬁ.toSåögTag]", "Sh¨edAºayBuf„r", 
JS_PROP_CONFIGURABLE
 ),

49918 
JSObje˘
 *
	$gë_ty≥d_¨øy
(
JSC⁄ãxt
 *
˘x
,

49919 
JSVÆueC⁄°
 
this_vÆ
,

49920 
is_d©avõw
)

49922 
JSObje˘
 *
p
;

49923 i‡(
	`JS_VALUE_GET_TAG
(
this_vÆ
Ë!
JS_TAG_OBJECT
)

49924 
Áû
;

49925 
p
 = 
	`JS_VALUE_GET_OBJ
(
this_vÆ
);

49926 i‡(
is_d©avõw
) {

49927 i‡(
p
->
˛ass_id
 !
JS_CLASS_DATAVIEW
)

49928 
Áû
;

49930 i‡(!(
p
->
˛ass_id
 >
JS_CLASS_UINT8C_ARRAY
 &&

49931 
p
->
˛ass_id
 <
JS_CLASS_FLOAT64_ARRAY
)) {

49932 
Áû
:

49933 
	`JS_ThrowTy≥Eº‹
(
˘x
, "nŸá %s", 
is_d©avõw
 ? "DataView" : "TypedArray");

49934  
NULL
;

49937  
p
;

49938 
	}
}

49941 
BOOL
 
	$ty≥d_¨øy_is_dëached
(
JSC⁄ãxt
 *
˘x
, 
JSObje˘
 *
p
)

49943 
JSTy≥dAºay
 *
è
 = 
p
->
u
.
ty≥d_¨øy
;

49944 
JSAºayBuf„r
 *
abuf
 = 
è
->
buf„r
->
u
.
¨øy_buf„r
;

49947  
abuf
->
dëached
;

49948 
	}
}

49952 
uöt32_t
 
	$ty≥d_¨øy_gë_Àngth
(
JSC⁄ãxt
 *
˘x
, 
JSObje˘
 *
p
)

49954 
JSTy≥dAºay
 *
è
 = 
p
->
u
.
ty≥d_¨øy
;

49955 
size_log2
 = 
	`ty≥d_¨øy_size_log2
(
p
->
˛ass_id
);

49956  
è
->
Àngth
 >> 
size_log2
;

49957 
	}
}

49959 
	$vÆid©e_ty≥d_¨øy
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
)

49961 
JSObje˘
 *
p
;

49962 
p
 = 
	`gë_ty≥d_¨øy
(
˘x
, 
this_vÆ
, 0);

49963 i‡(!
p
)

49965 i‡(
	`ty≥d_¨øy_is_dëached
(
˘x
, 
p
)) {

49966 
	`JS_ThrowTy≥Eº‹DëachedAºayBuf„r
(
˘x
);

49970 
	}
}

49972 
JSVÆue
 
	$js_ty≥d_¨øy_gë_Àngth
(
JSC⁄ãxt
 *
˘x
,

49973 
JSVÆueC⁄°
 
this_vÆ
)

49975 
JSObje˘
 *
p
;

49976 
p
 = 
	`gë_ty≥d_¨øy
(
˘x
, 
this_vÆ
, 0);

49977 i‡(!
p
)

49978  
JS_EXCEPTION
;

49979  
	`JS_NewI¡32
(
˘x
, 
p
->
u
.
¨øy
.
cou¡
);

49980 
	}
}

49982 
JSVÆue
 
	$js_ty≥d_¨øy_gë_buf„r
(
JSC⁄ãxt
 *
˘x
,

49983 
JSVÆueC⁄°
 
this_vÆ
, 
is_d©avõw
)

49985 
JSObje˘
 *
p
;

49986 
JSTy≥dAºay
 *
è
;

49987 
p
 = 
	`gë_ty≥d_¨øy
(
˘x
, 
this_vÆ
, 
is_d©avõw
);

49988 i‡(!
p
)

49989  
JS_EXCEPTION
;

49990 
è
 = 
p
->
u
.
ty≥d_¨øy
;

49991  
	`JS_DupVÆue
(
˘x
, 
	`JS_MKPTR
(
JS_TAG_OBJECT
, 
è
->
buf„r
));

49992 
	}
}

49994 
JSVÆue
 
	$js_ty≥d_¨øy_gë_byãLígth
(
JSC⁄ãxt
 *
˘x
,

49995 
JSVÆueC⁄°
 
this_vÆ
,

49996 
is_d©avõw
)

49998 
JSObje˘
 *
p
;

49999 
JSTy≥dAºay
 *
è
;

50000 
p
 = 
	`gë_ty≥d_¨øy
(
˘x
, 
this_vÆ
, 
is_d©avõw
);

50001 i‡(!
p
)

50002  
JS_EXCEPTION
;

50003 i‡(
	`ty≥d_¨øy_is_dëached
(
˘x
, 
p
)) {

50004 i‡(
is_d©avõw
) {

50005  
	`JS_ThrowTy≥Eº‹DëachedAºayBuf„r
(
˘x
);

50007  
	`JS_NewI¡32
(
˘x
, 0);

50010 
è
 = 
p
->
u
.
ty≥d_¨øy
;

50011  
	`JS_NewI¡32
(
˘x
, 
è
->
Àngth
);

50012 
	}
}

50014 
JSVÆue
 
	$js_ty≥d_¨øy_gë_byãOff£t
(
JSC⁄ãxt
 *
˘x
,

50015 
JSVÆueC⁄°
 
this_vÆ
,

50016 
is_d©avõw
)

50018 
JSObje˘
 *
p
;

50019 
JSTy≥dAºay
 *
è
;

50020 
p
 = 
	`gë_ty≥d_¨øy
(
˘x
, 
this_vÆ
, 
is_d©avõw
);

50021 i‡(!
p
)

50022  
JS_EXCEPTION
;

50023 i‡(
	`ty≥d_¨øy_is_dëached
(
˘x
, 
p
)) {

50024 i‡(
is_d©avõw
) {

50025  
	`JS_ThrowTy≥Eº‹DëachedAºayBuf„r
(
˘x
);

50027  
	`JS_NewI¡32
(
˘x
, 0);

50030 
è
 = 
p
->
u
.
ty≥d_¨øy
;

50031  
	`JS_NewI¡32
(
˘x
, 
è
->
off£t
);

50032 
	}
}

50037 
JSVÆue
 
	$JS_GëTy≥dAºayBuf„r
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
obj
,

50038 
size_t
 *
pbyã_off£t
,

50039 
size_t
 *
pbyã_Àngth
,

50040 
size_t
 *
pbyãs_≥r_ñemít
)

50042 
JSObje˘
 *
p
;

50043 
JSTy≥dAºay
 *
è
;

50044 
p
 = 
	`gë_ty≥d_¨øy
(
˘x
, 
obj
, 
FALSE
);

50045 i‡(!
p
)

50046  
JS_EXCEPTION
;

50047 i‡(
	`ty≥d_¨øy_is_dëached
(
˘x
, 
p
))

50048  
	`JS_ThrowTy≥Eº‹DëachedAºayBuf„r
(
˘x
);

50049 
è
 = 
p
->
u
.
ty≥d_¨øy
;

50050 i‡(
pbyã_off£t
)

50051 *
pbyã_off£t
 = 
è
->
off£t
;

50052 i‡(
pbyã_Àngth
)

50053 *
pbyã_Àngth
 = 
è
->
Àngth
;

50054 i‡(
pbyãs_≥r_ñemít
) {

50055 *
pbyãs_≥r_ñemít
 = 1 << 
	`ty≥d_¨øy_size_log2
(
p
->
˛ass_id
);

50057  
	`JS_DupVÆue
(
˘x
, 
	`JS_MKPTR
(
JS_TAG_OBJECT
, 
è
->
buf„r
));

50058 
	}
}

50060 
JSVÆue
 
	$js_ty≥d_¨øy_gë_toSåögTag
(
JSC⁄ãxt
 *
˘x
,

50061 
JSVÆueC⁄°
 
this_vÆ
)

50063 
JSObje˘
 *
p
;

50064 i‡(
	`JS_VALUE_GET_TAG
(
this_vÆ
Ë!
JS_TAG_OBJECT
)

50065  
JS_UNDEFINED
;

50066 
p
 = 
	`JS_VALUE_GET_OBJ
(
this_vÆ
);

50067 i‡(!(
p
->
˛ass_id
 >
JS_CLASS_UINT8C_ARRAY
 &&

50068 
p
->
˛ass_id
 <
JS_CLASS_FLOAT64_ARRAY
))

50069  
JS_UNDEFINED
;

50070  
	`JS_AtomToSåög
(
˘x
, ctx->
π
->
˛ass_¨øy
[
p
->
˛ass_id
].
˛ass_«me
);

50071 
	}
}

50073 
JSVÆue
 
	$js_ty≥d_¨øy_£t_öã∫Æ
(
JSC⁄ãxt
 *
˘x
,

50074 
JSVÆueC⁄°
 
d°
,

50075 
JSVÆueC⁄°
 
§c
,

50076 
JSVÆueC⁄°
 
off
)

50078 
JSObje˘
 *
p
;

50079 
JSObje˘
 *
§c_p
;

50080 
uöt32_t
 
i
;

50081 
söt64_t
 
§c_Àn
, 
off£t
;

50082 
JSVÆue
 
vÆ
, 
§c_obj
 = 
JS_UNDEFINED
;

50084 
p
 = 
	`gë_ty≥d_¨øy
(
˘x
, 
d°
, 0);

50085 i‡(!
p
)

50086 
Áû
;

50087 i‡(
	`JS_ToI¡64S©
(
˘x
, &
off£t
, 
off
))

50088 
Áû
;

50089 i‡(
off£t
 < 0)

50090 
ønge_îr‹
;

50091 i‡(
	`ty≥d_¨øy_is_dëached
(
˘x
, 
p
)) {

50092 
dëached
:

50093 
	`JS_ThrowTy≥Eº‹DëachedAºayBuf„r
(
˘x
);

50094 
Áû
;

50096 
§c_obj
 = 
	`JS_ToObje˘
(
˘x
, 
§c
);

50097 i‡(
	`JS_IsEx˚±i⁄
(
§c_obj
))

50098 
Áû
;

50099 
§c_p
 = 
	`JS_VALUE_GET_OBJ
(
§c_obj
);

50100 i‡(
§c_p
->
˛ass_id
 >
JS_CLASS_UINT8C_ARRAY
 &&

50101 
§c_p
->
˛ass_id
 <
JS_CLASS_FLOAT64_ARRAY
) {

50102 
JSTy≥dAºay
 *
de°_è
 = 
p
->
u
.
ty≥d_¨øy
;

50103 
JSAºayBuf„r
 *
de°_abuf
 = 
de°_è
->
buf„r
->
u
.
¨øy_buf„r
;

50104 
JSTy≥dAºay
 *
§c_è
 = 
§c_p
->
u
.
ty≥d_¨øy
;

50105 
JSAºayBuf„r
 *
§c_abuf
 = 
§c_è
->
buf„r
->
u
.
¨øy_buf„r
;

50106 
shi·
 = 
	`ty≥d_¨øy_size_log2
(
p
->
˛ass_id
);

50108 i‡(
§c_abuf
->
dëached
)

50109 
dëached
;

50111 
§c_Àn
 = 
§c_p
->
u
.
¨øy
.
cou¡
;

50112 i‡(
off£t
 > (
söt64_t
)(
p
->
u
.
¨øy
.
cou¡
 - 
§c_Àn
))

50113 
ønge_îr‹
;

50116 i‡(
§c_p
->
˛ass_id
 =
p
->class_id) {

50118 
	`memmove
(
de°_abuf
->
d©a
 + 
de°_è
->
off£t
 + (off£à<< 
shi·
),

50119 
§c_abuf
->
d©a
 + 
§c_è
->
off£t
, 
§c_Àn
 << 
shi·
);

50120 
d⁄e
;

50122 i‡(
de°_abuf
->
d©a
 =
§c_abuf
->data) {

50128 i‡(
	`js_gë_Àngth64
(
˘x
, &
§c_Àn
, 
§c_obj
))

50129 
Áû
;

50130 i‡(
off£t
 > (
söt64_t
)(
p
->
u
.
¨øy
.
cou¡
 - 
§c_Àn
)) {

50131 
ønge_îr‹
:

50132 
	`JS_ThrowR™geEº‹
(
˘x
, "invalidárrayÜength");

50133 
Áû
;

50136 
i
 = 0; i < 
§c_Àn
; i++) {

50137 
vÆ
 = 
	`JS_GëPr›îtyUöt32
(
˘x
, 
§c_obj
, 
i
);

50138 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

50139 
Áû
;

50140 i‡(
	`JS_SëPr›îtyUöt32
(
˘x
, 
d°
, 
off£t
 + 
i
, 
vÆ
) < 0)

50141 
Áû
;

50143 
d⁄e
:

50144 
	`JS_FªeVÆue
(
˘x
, 
§c_obj
);

50145  
JS_UNDEFINED
;

50146 
Áû
:

50147 
	`JS_FªeVÆue
(
˘x
, 
§c_obj
);

50148  
JS_EXCEPTION
;

50149 
	}
}

50151 
JSVÆue
 
	$js_ty≥d_¨øy_£t
(
JSC⁄ãxt
 *
˘x
,

50152 
JSVÆueC⁄°
 
this_vÆ
,

50153 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

50155 
JSVÆueC⁄°
 
off£t
 = 
JS_UNDEFINED
;

50156 i‡(
¨gc
 > 1) {

50157 
off£t
 = 
¨gv
[1];

50159  
	`js_ty≥d_¨øy_£t_öã∫Æ
(
˘x
, 
this_vÆ
, 
¨gv
[0], 
off£t
);

50160 
	}
}

50162 
JSVÆue
 
	$js_¸óã_ty≥d_¨øy_ôî©‹
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

50163 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
, 
magic
)

50165 i‡(
	`vÆid©e_ty≥d_¨øy
(
˘x
, 
this_vÆ
))

50166  
JS_EXCEPTION
;

50167  
	`js_¸óã_¨øy_ôî©‹
(
˘x
, 
this_vÆ
, 
¨gc
, 
¨gv
, 
magic
);

50168 
	}
}

50171 
	$js_ty≥d_¨øy_gë_Àngth_öã∫Æ
(
JSC⁄ãxt
 *
˘x
,

50172 
JSVÆueC⁄°
 
obj
)

50174 
JSObje˘
 *
p
;

50175 
p
 = 
	`gë_ty≥d_¨øy
(
˘x
, 
obj
, 0);

50176 i‡(!
p
)

50178 i‡(
	`ty≥d_¨øy_is_dëached
(
˘x
, 
p
)) {

50179 
	`JS_ThrowTy≥Eº‹DëachedAºayBuf„r
(
˘x
);

50182  
p
->
u
.
¨øy
.
cou¡
;

50183 
	}
}

50187 
JSVÆue
 
	$js_ty≥d_¨øy___gëLígth
(
JSC⁄ãxt
 *
˘x
,

50188 
JSVÆueC⁄°
 
this_vÆ
,

50189 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

50191 
BOOL
 
ign‹e_dëached
 = 
	`JS_ToBoﬁ
(
˘x
, 
¨gv
[1]);

50193 i‡(
ign‹e_dëached
) {

50194  
	`js_ty≥d_¨øy_gë_Àngth
(
˘x
, 
¨gv
[0]);

50196 
Àn
;

50197 
Àn
 = 
	`js_ty≥d_¨øy_gë_Àngth_öã∫Æ
(
˘x
, 
¨gv
[0]);

50198 i‡(
Àn
 < 0)

50199  
JS_EXCEPTION
;

50200  
	`JS_NewI¡32
(
˘x
, 
Àn
);

50202 
	}
}

50205 
JSVÆue
 
js_ty≥d_¨øy_c⁄°ru˘‹
(
JSC⁄ãxt
 *
˘x
,

50206 
JSVÆueC⁄°
 
this_vÆ
,

50207 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
,

50208 
˛assid
);

50210 
JSVÆue
 
	$js_ty≥d_¨øy_¸óã
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
˘‹
,

50211 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

50213 
JSVÆue
 
ªt
;

50214 
√w_Àn
;

50215 
söt64_t
 
Àn
;

50217 
ªt
 = 
	`JS_CÆlC⁄°ru˘‹
(
˘x
, 
˘‹
, 
¨gc
, 
¨gv
);

50218 i‡(
	`JS_IsEx˚±i⁄
(
ªt
))

50219  
ªt
;

50221 
√w_Àn
 = 
	`js_ty≥d_¨øy_gë_Àngth_öã∫Æ
(
˘x
, 
ªt
);

50222 i‡(
√w_Àn
 < 0)

50223 
Áû
;

50224 i‡(
¨gc
 == 1) {

50226 i‡(
	`JS_ToLígthFªe
(
˘x
, &
Àn
, 
	`JS_DupVÆue
(˘x, 
¨gv
[0])))

50227 
Áû
;

50228 i‡(
√w_Àn
 < 
Àn
) {

50229 
	`JS_ThrowTy≥Eº‹
(
˘x
, "TypedArrayÜength isÅoo small");

50230 
Áû
:

50231 
	`JS_FªeVÆue
(
˘x
, 
ªt
);

50232  
JS_EXCEPTION
;

50235  
ªt
;

50236 
	}
}

50239 
JSVÆue
 
	$js_ty≥d_¨øy___¸óã
(
JSC⁄ãxt
 *
˘x
,

50240 
JSVÆueC⁄°
 
this_vÆ
,

50241 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

50243  
	`js_ty≥d_¨øy_¸óã
(
˘x
, 
¨gv
[0], 
	`max_öt
(
¨gc
 - 1, 0),árgv + 1);

50244 
	}
}

50247 
JSVÆue
 
	$js_ty≥d_¨øy___•ecõsCª©e
(
JSC⁄ãxt
 *
˘x
,

50248 
JSVÆueC⁄°
 
this_vÆ
,

50249 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

50251 
JSVÆueC⁄°
 
obj
;

50252 
JSObje˘
 *
p
;

50253 
JSVÆue
 
˘‹
, 
ªt
;

50254 
¨gc1
;

50256 
obj
 = 
¨gv
[0];

50257 
p
 = 
	`gë_ty≥d_¨øy
(
˘x
, 
obj
, 0);

50258 i‡(!
p
)

50259  
JS_EXCEPTION
;

50260 
˘‹
 = 
	`JS_S≥cõsC⁄°ru˘‹
(
˘x
, 
obj
, 
JS_UNDEFINED
);

50261 i‡(
	`JS_IsEx˚±i⁄
(
˘‹
))

50262  
˘‹
;

50263 
¨gc1
 = 
	`max_öt
(
¨gc
 - 1, 0);

50264 i‡(
	`JS_IsUndeföed
(
˘‹
)) {

50265 
ªt
 = 
	`js_ty≥d_¨øy_c⁄°ru˘‹
(
˘x
, 
JS_UNDEFINED
, 
¨gc1
, 
¨gv
 + 1,

50266 
p
->
˛ass_id
);

50268 
ªt
 = 
	`js_ty≥d_¨øy_¸óã
(
˘x
, 
˘‹
, 
¨gc1
, 
¨gv
 + 1);

50269 
	`JS_FªeVÆue
(
˘x
, 
˘‹
);

50271  
ªt
;

50272 
	}
}

50274 
JSVÆue
 
	$js_ty≥d_¨øy_‰om
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

50275 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

50278 
JSVÆueC⁄°
 
ôems
 = 
¨gv
[0], 
m≠‚
, 
this_¨g
;

50279 
JSVÆueC⁄°
 
¨gs
[2];

50280 
JSVÆue
 
°ack
[2];

50281 
JSVÆue
 
ôî
, 
¨r
, 
r
, 
v
, 
v2
;

50282 
söt64_t
 
k
, 
Àn
;

50283 
d⁄e
, 
m≠pög
;

50285 
m≠pög
 = 
FALSE
;

50286 
m≠‚
 = 
JS_UNDEFINED
;

50287 
this_¨g
 = 
JS_UNDEFINED
;

50288 
r
 = 
JS_UNDEFINED
;

50289 
¨r
 = 
JS_UNDEFINED
;

50290 
°ack
[0] = 
JS_UNDEFINED
;

50291 
°ack
[1] = 
JS_UNDEFINED
;

50293 i‡(
¨gc
 > 1) {

50294 
m≠‚
 = 
¨gv
[1];

50295 i‡(!
	`JS_IsUndeföed
(
m≠‚
)) {

50296 i‡(
	`check_fun˘i⁄
(
˘x
, 
m≠‚
))

50297 
ex˚±i⁄
;

50298 
m≠pög
 = 1;

50299 i‡(
¨gc
 > 2)

50300 
this_¨g
 = 
¨gv
[2];

50303 
ôî
 = 
	`JS_GëPr›îty
(
˘x
, 
ôems
, 
JS_ATOM_Symbﬁ_ôî©‹
);

50304 i‡(
	`JS_IsEx˚±i⁄
(
ôî
))

50305 
ex˚±i⁄
;

50306 i‡(!
	`JS_IsUndeföed
(
ôî
)) {

50307 
	`JS_FªeVÆue
(
˘x
, 
ôî
);

50308 
¨r
 = 
	`JS_NewAºay
(
˘x
);

50309 i‡(
	`JS_IsEx˚±i⁄
(
¨r
))

50310 
ex˚±i⁄
;

50311 
°ack
[0] = 
	`JS_DupVÆue
(
˘x
, 
ôems
);

50312 i‡(
	`js_f‹_of_°¨t
(
˘x
, &
°ack
[1], 
FALSE
))

50313 
ex˚±i⁄
;

50314 
k
 = 0;; k++) {

50315 
v
 = 
	`JS_Iãøt‹Next
(
˘x
, 
°ack
[0], sèck[1], 0, 
NULL
, &
d⁄e
);

50316 i‡(
	`JS_IsEx˚±i⁄
(
v
))

50317 
ex˚±i⁄_˛o£
;

50318 i‡(
d⁄e
)

50320 i‡(
	`JS_DeföePr›îtyVÆueI¡64
(
˘x
, 
¨r
, 
k
, 
v
, 
JS_PROP_C_W_E
 | 
JS_PROP_THROW
) < 0)

50321 
ex˚±i⁄_˛o£
;

50324 
¨r
 = 
	`JS_ToObje˘
(
˘x
, 
ôems
);

50325 i‡(
	`JS_IsEx˚±i⁄
(
¨r
))

50326 
ex˚±i⁄
;

50328 i‡(
	`js_gë_Àngth64
(
˘x
, &
Àn
, 
¨r
) < 0)

50329 
ex˚±i⁄
;

50330 
v
 = 
	`JS_NewI¡64
(
˘x
, 
Àn
);

50331 
¨gs
[0] = 
v
;

50332 
r
 = 
	`js_ty≥d_¨øy_¸óã
(
˘x
, 
this_vÆ
, 1, 
¨gs
);

50333 
	`JS_FªeVÆue
(
˘x
, 
v
);

50334 i‡(
	`JS_IsEx˚±i⁄
(
r
))

50335 
ex˚±i⁄
;

50336 
k
 = 0; k < 
Àn
; k++) {

50337 
v
 = 
	`JS_GëPr›îtyI¡64
(
˘x
, 
¨r
, 
k
);

50338 i‡(
	`JS_IsEx˚±i⁄
(
v
))

50339 
ex˚±i⁄
;

50340 i‡(
m≠pög
) {

50341 
¨gs
[0] = 
v
;

50342 
¨gs
[1] = 
	`JS_NewI¡32
(
˘x
, 
k
);

50343 
v2
 = 
	`JS_CÆl
(
˘x
, 
m≠‚
, 
this_¨g
, 2, 
¨gs
);

50344 
	`JS_FªeVÆue
(
˘x
, 
v
);

50345 
v
 = 
v2
;

50346 i‡(
	`JS_IsEx˚±i⁄
(
v
))

50347 
ex˚±i⁄
;

50349 i‡(
	`JS_SëPr›îtyI¡64
(
˘x
, 
r
, 
k
, 
v
) < 0)

50350 
ex˚±i⁄
;

50352 
d⁄e
;

50354 
ex˚±i⁄_˛o£
:

50355 i‡(!
	`JS_IsUndeföed
(
°ack
[0]))

50356 
	`JS_Iãøt‹Clo£
(
˘x
, 
°ack
[0], 
TRUE
);

50357 
ex˚±i⁄
:

50358 
	`JS_FªeVÆue
(
˘x
, 
r
);

50359 
r
 = 
JS_EXCEPTION
;

50360 
d⁄e
:

50361 
	`JS_FªeVÆue
(
˘x
, 
¨r
);

50362 
	`JS_FªeVÆue
(
˘x
, 
°ack
[0]);

50363 
	`JS_FªeVÆue
(
˘x
, 
°ack
[1]);

50364  
r
;

50365 
	}
}

50367 
JSVÆue
 
	$js_ty≥d_¨øy_of
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

50368 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

50370 
JSVÆue
 
obj
;

50371 
JSVÆueC⁄°
 
¨gs
[1];

50372 
i
;

50374 
¨gs
[0] = 
	`JS_NewI¡32
(
˘x
, 
¨gc
);

50375 
obj
 = 
	`js_ty≥d_¨øy_¸óã
(
˘x
, 
this_vÆ
, 1, 
¨gs
);

50376 i‡(
	`JS_IsEx˚±i⁄
(
obj
))

50377  
obj
;

50379 
i
 = 0; i < 
¨gc
; i++) {

50380 i‡(
	`JS_SëPr›îtyUöt32
(
˘x
, 
obj
, 
i
, 
	`JS_DupVÆue
(˘x, 
¨gv
[i])) < 0) {

50381 
	`JS_FªeVÆue
(
˘x
, 
obj
);

50382  
JS_EXCEPTION
;

50385  
obj
;

50386 
	}
}

50388 
JSVÆue
 
	$js_ty≥d_¨øy_c›yWôhö
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

50389 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

50391 
JSObje˘
 *
p
;

50392 
Àn
, 
to
, 
‰om
, 
föÆ
, 
cou¡
, 
shi·
;

50394 
Àn
 = 
	`js_ty≥d_¨øy_gë_Àngth_öã∫Æ
(
˘x
, 
this_vÆ
);

50395 i‡(
Àn
 < 0)

50396  
JS_EXCEPTION
;

50398 i‡(
	`JS_ToI¡32Cœmp
(
˘x
, &
to
, 
¨gv
[0], 0, 
Àn
,Üen))

50399  
JS_EXCEPTION
;

50401 i‡(
	`JS_ToI¡32Cœmp
(
˘x
, &
‰om
, 
¨gv
[1], 0, 
Àn
,Üen))

50402  
JS_EXCEPTION
;

50404 
föÆ
 = 
Àn
;

50405 i‡(
¨gc
 > 2 && !
	`JS_IsUndeföed
(
¨gv
[2])) {

50406 i‡(
	`JS_ToI¡32Cœmp
(
˘x
, &
föÆ
, 
¨gv
[2], 0, 
Àn
,Üen))

50407  
JS_EXCEPTION
;

50410 
cou¡
 = 
	`mö_öt
(
föÆ
 - 
‰om
, 
Àn
 - 
to
);

50411 i‡(
cou¡
 > 0) {

50412 
p
 = 
	`JS_VALUE_GET_OBJ
(
this_vÆ
);

50413 i‡(
	`ty≥d_¨øy_is_dëached
(
˘x
, 
p
))

50414  
	`JS_ThrowTy≥Eº‹DëachedAºayBuf„r
(
˘x
);

50415 
shi·
 = 
	`ty≥d_¨øy_size_log2
(
p
->
˛ass_id
);

50416 
	`memmove
(
p
->
u
.
¨øy
.u.
uöt8_±r
 + (
to
 << 
shi·
),

50417 
p
->
u
.
¨øy
.u.
uöt8_±r
 + (
‰om
 << 
shi·
),

50418 
cou¡
 << 
shi·
);

50420  
	`JS_DupVÆue
(
˘x
, 
this_vÆ
);

50421 
	}
}

50423 
JSVÆue
 
	$js_ty≥d_¨øy_fûl
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

50424 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

50426 
JSObje˘
 *
p
;

50427 
Àn
, 
k
, 
föÆ
, 
shi·
;

50428 
uöt64_t
 
v64
;

50430 
Àn
 = 
	`js_ty≥d_¨øy_gë_Àngth_öã∫Æ
(
˘x
, 
this_vÆ
);

50431 i‡(
Àn
 < 0)

50432  
JS_EXCEPTION
;

50433 
p
 = 
	`JS_VALUE_GET_OBJ
(
this_vÆ
);

50435 i‡(
p
->
˛ass_id
 =
JS_CLASS_UINT8C_ARRAY
) {

50436 
öt32_t
 
v
;

50437 i‡(
	`JS_ToUöt8CœmpFªe
(
˘x
, &
v
, 
	`JS_DupVÆue
(˘x, 
¨gv
[0])))

50438  
JS_EXCEPTION
;

50439 
v64
 = 
v
;

50440 } i‡(
p
->
˛ass_id
 <
JS_CLASS_UINT32_ARRAY
) {

50441 
uöt32_t
 
v
;

50442 i‡(
	`JS_ToUöt32
(
˘x
, &
v
, 
¨gv
[0]))

50443  
JS_EXCEPTION
;

50444 
v64
 = 
v
;

50446 #ifde‡
CONFIG_BIGNUM


50447 i‡(
p
->
˛ass_id
 <
JS_CLASS_BIG_UINT64_ARRAY
) {

50448 i‡(
	`JS_ToBigI¡64
(
˘x
, (
öt64_t
 *)&
v64
, 
¨gv
[0]))

50449  
JS_EXCEPTION
;

50453 
d
;

50454 i‡(
	`JS_ToFlﬂt64
(
˘x
, &
d
, 
¨gv
[0]))

50455  
JS_EXCEPTION
;

50456 i‡(
p
->
˛ass_id
 =
JS_CLASS_FLOAT32_ARRAY
) {

50458 
f
;

50459 
uöt32_t
 
u32
;

50460 } 
u
;

50461 
u
.
f
 = 
d
;

50462 
v64
 = 
u
.
u32
;

50464 
JSFlﬂt64Uni⁄
 
u
;

50465 
u
.
d
 = d;

50466 
v64
 = 
u
.
u64
;

50470 
k
 = 0;

50471 i‡(
¨gc
 > 1) {

50472 i‡(
	`JS_ToI¡32Cœmp
(
˘x
, &
k
, 
¨gv
[1], 0, 
Àn
,Üen))

50473  
JS_EXCEPTION
;

50476 
föÆ
 = 
Àn
;

50477 i‡(
¨gc
 > 2 && !
	`JS_IsUndeföed
(
¨gv
[2])) {

50478 i‡(
	`JS_ToI¡32Cœmp
(
˘x
, &
föÆ
, 
¨gv
[2], 0, 
Àn
,Üen))

50479  
JS_EXCEPTION
;

50482 i‡(
	`ty≥d_¨øy_is_dëached
(
˘x
, 
p
))

50483  
	`JS_ThrowTy≥Eº‹DëachedAºayBuf„r
(
˘x
);

50485 
shi·
 = 
	`ty≥d_¨øy_size_log2
(
p
->
˛ass_id
);

50486 
shi·
) {

50488 i‡(
k
 < 
föÆ
) {

50489 
	`mem£t
(
p
->
u
.
¨øy
.u.
uöt8_±r
 + 
k
, 
v64
, 
föÆ
 - k);

50493 ; 
k
 < 
föÆ
; k++) {

50494 
p
->
u
.
¨øy
.u.
uöt16_±r
[
k
] = 
v64
;

50498 ; 
k
 < 
föÆ
; k++) {

50499 
p
->
u
.
¨øy
.u.
uöt32_±r
[
k
] = 
v64
;

50503 ; 
k
 < 
föÆ
; k++) {

50504 
p
->
u
.
¨øy
.u.
uöt64_±r
[
k
] = 
v64
;

50508 
	`ab‹t
();

50510  
	`JS_DupVÆue
(
˘x
, 
this_vÆ
);

50511 
	}
}

50513 
JSVÆue
 
	$js_ty≥d_¨øy_föd
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

50514 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
, 
födIndex
)

50516 
JSVÆueC⁄°
 
func
, 
this_¨g
;

50517 
JSVÆueC⁄°
 
¨gs
[3];

50518 
JSVÆue
 
vÆ
, 
ödex_vÆ
, 
ªs
;

50519 
Àn
, 
k
;

50521 
vÆ
 = 
JS_UNDEFINED
;

50522 
Àn
 = 
	`js_ty≥d_¨øy_gë_Àngth_öã∫Æ
(
˘x
, 
this_vÆ
);

50523 i‡(
Àn
 < 0)

50524 
ex˚±i⁄
;

50526 
func
 = 
¨gv
[0];

50527 i‡(
	`check_fun˘i⁄
(
˘x
, 
func
))

50528 
ex˚±i⁄
;

50530 
this_¨g
 = 
JS_UNDEFINED
;

50531 i‡(
¨gc
 > 1)

50532 
this_¨g
 = 
¨gv
[1];

50534 
k
 = 0; k < 
Àn
; k++) {

50535 
ödex_vÆ
 = 
	`JS_NewI¡32
(
˘x
, 
k
);

50536 
vÆ
 = 
	`JS_GëPr›îtyVÆue
(
˘x
, 
this_vÆ
, 
ödex_vÆ
);

50537 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

50538 
ex˚±i⁄
;

50539 
¨gs
[0] = 
vÆ
;

50540 
¨gs
[1] = 
ödex_vÆ
;

50541 
¨gs
[2] = 
this_vÆ
;

50542 
ªs
 = 
	`JS_CÆl
(
˘x
, 
func
, 
this_¨g
, 3, 
¨gs
);

50543 i‡(
	`JS_IsEx˚±i⁄
(
ªs
))

50544 
ex˚±i⁄
;

50545 i‡(
	`JS_ToBoﬁFªe
(
˘x
, 
ªs
)) {

50546 i‡(
födIndex
) {

50547 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

50548  
ödex_vÆ
;

50550  
vÆ
;

50553 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

50555 i‡(
födIndex
)

50556  
	`JS_NewI¡32
(
˘x
, -1);

50558  
JS_UNDEFINED
;

50560 
ex˚±i⁄
:

50561 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

50562  
JS_EXCEPTION
;

50563 
	}
}

50565 
	#•ecül_ödexOf
 0

	)

50566 
	#•ecül_œ°IndexOf
 1

	)

50567 
	#•ecül_ö˛udes
 -1

	)

50569 
JSVÆue
 
	$js_ty≥d_¨øy_ödexOf
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

50570 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
, 
•ecül
)

50572 
JSObje˘
 *
p
;

50573 
Àn
, 
èg
, 
is_öt
, 
is_bigöt
, 
k
, 
°›
, 
öc
, 
ªs
 = -1;

50574 
söt64_t
 
v64
;

50575 
d
;

50576 
f
;

50578 
Àn
 = 
	`js_ty≥d_¨øy_gë_Àngth_öã∫Æ
(
˘x
, 
this_vÆ
);

50579 i‡(
Àn
 < 0)

50580 
ex˚±i⁄
;

50581 i‡(
Àn
 == 0)

50582 
d⁄e
;

50584 i‡(
•ecül
 =
•ecül_œ°IndexOf
) {

50585 
k
 = 
Àn
 - 1;

50586 i‡(
¨gc
 > 1) {

50587 i‡(
	`JS_ToFlﬂt64
(
˘x
, &
d
, 
¨gv
[1]))

50588 
ex˚±i⁄
;

50589 i‡(
	`i¢™
(
d
)) {

50590 
k
 = 0;

50592 i‡(
d
 >= 0) {

50593 i‡(
d
 < 
k
) {

50594 
k
 = 
d
;

50597 
d
 +
Àn
;

50598 i‡(
d
 < 0)

50599 
d⁄e
;

50600 
k
 = 
d
;

50604 
°›
 = -1;

50605 
öc
 = -1;

50607 
k
 = 0;

50608 i‡(
¨gc
 > 1) {

50609 i‡(
	`JS_ToI¡32Cœmp
(
˘x
, &
k
, 
¨gv
[1], 0, 
Àn
,Üen))

50610 
ex˚±i⁄
;

50612 
°›
 = 
Àn
;

50613 
öc
 = 1;

50616 i‡(
	`vÆid©e_ty≥d_¨øy
(
˘x
, 
this_vÆ
))

50617 
ex˚±i⁄
;

50618 
p
 = 
	`JS_VALUE_GET_OBJ
(
this_vÆ
);

50620 
is_bigöt
 = 0;

50621 
is_öt
 = 0;

50622 
v64
 = 0;

50623 
èg
 = 
	`JS_VALUE_GET_NORM_TAG
(
¨gv
[0]);

50624 i‡(
èg
 =
JS_TAG_INT
) {

50625 
is_öt
 = 1;

50626 
v64
 = 
	`JS_VALUE_GET_INT
(
¨gv
[0]);

50627 
d
 = 
v64
;

50629 i‡(
èg
 =
JS_TAG_FLOAT64
) {

50630 
d
 = 
	`JS_VALUE_GET_FLOAT64
(
¨gv
[0]);

50631 
v64
 = 
d
;

50632 
is_öt
 = (
v64
 =
d
);

50634 #ifde‡
CONFIG_BIGNUM


50635 i‡(
èg
 =
JS_TAG_BIG_INT
) {

50636 
JSBigFlﬂt
 *
p1
 = 
	`JS_VALUE_GET_PTR
(
¨gv
[0]);

50638 i‡(
p
->
˛ass_id
 =
JS_CLASS_BIG_INT64_ARRAY
) {

50639 i‡(
	`bf_gë_öt64
(&
v64
, &
p1
->
num
, 0) != 0)

50640 
d⁄e
;

50641 } i‡(
p
->
˛ass_id
 =
JS_CLASS_BIG_UINT64_ARRAY
) {

50642 i‡(
	`bf_gë_uöt64
((
uöt64_t
 *)&
v64
, &
p1
->
num
) != 0)

50643 
d⁄e
;

50645 
d⁄e
;

50647 
d
 = 0;

50648 
is_bigöt
 = 1;

50652 
d⁄e
;

50655 
p
 = 
	`JS_VALUE_GET_OBJ
(
this_vÆ
);

50656 
p
->
˛ass_id
) {

50657 
JS_CLASS_INT8_ARRAY
:

50658 i‡(
is_öt
 && (
öt8_t
)
v64
 == v64)

50659 
sˇn8
;

50661 
JS_CLASS_UINT8C_ARRAY
:

50662 
JS_CLASS_UINT8_ARRAY
:

50663 i‡(
is_öt
 && (
uöt8_t
)
v64
 == v64) {

50664 c⁄° 
uöt8_t
 *
pv
, *
µ
;

50665 
uöt16_t
 
v
;

50666 
sˇn8
:

50667 
pv
 = 
p
->
u
.
¨øy
.u.
uöt8_±r
;

50668 
v
 = 
v64
;

50669 i‡(
öc
 > 0) {

50670 
µ
 = 
	`memchr
(
pv
 + 
k
, 
v
, 
Àn
 - k);

50671 i‡(
µ
)

50672 
ªs
 = 
µ
 - 
pv
;

50674 ; 
k
 !
°›
; k +
öc
) {

50675 i‡(
pv
[
k
] =
v
) {

50676 
ªs
 = 
k
;

50683 
JS_CLASS_INT16_ARRAY
:

50684 i‡(
is_öt
 && (
öt16_t
)
v64
 == v64)

50685 
sˇn16
;

50687 
JS_CLASS_UINT16_ARRAY
:

50688 i‡(
is_öt
 && (
uöt16_t
)
v64
 == v64) {

50689 c⁄° 
uöt16_t
 *
pv
;

50690 
uöt16_t
 
v
;

50691 
sˇn16
:

50692 
pv
 = 
p
->
u
.
¨øy
.u.
uöt16_±r
;

50693 
v
 = 
v64
;

50694 ; 
k
 !
°›
; k +
öc
) {

50695 i‡(
pv
[
k
] =
v
) {

50696 
ªs
 = 
k
;

50702 
JS_CLASS_INT32_ARRAY
:

50703 i‡(
is_öt
 && (
öt32_t
)
v64
 == v64)

50704 
sˇn32
;

50706 
JS_CLASS_UINT32_ARRAY
:

50707 i‡(
is_öt
 && (
uöt32_t
)
v64
 == v64) {

50708 c⁄° 
uöt32_t
 *
pv
;

50709 
uöt32_t
 
v
;

50710 
sˇn32
:

50711 
pv
 = 
p
->
u
.
¨øy
.u.
uöt32_±r
;

50712 
v
 = 
v64
;

50713 ; 
k
 !
°›
; k +
öc
) {

50714 i‡(
pv
[
k
] =
v
) {

50715 
ªs
 = 
k
;

50721 
JS_CLASS_FLOAT32_ARRAY
:

50722 i‡(
is_bigöt
)

50724 i‡(
	`i¢™
(
d
)) {

50725 c⁄° *
pv
 = 
p
->
u
.
¨øy
.u.
Êﬂt_±r
;

50727 i‡(
•ecül
 !
•ecül_ö˛udes
)

50728 
d⁄e
;

50729 ; 
k
 !
°›
; k +
öc
) {

50730 i‡(
	`i¢™
(
pv
[
k
])) {

50731 
ªs
 = 
k
;

50735 } i‡((
f
 = ()
d
) == d) {

50736 c⁄° *
pv
 = 
p
->
u
.
¨øy
.u.
Êﬂt_±r
;

50737 ; 
k
 !
°›
; k +
öc
) {

50738 i‡(
pv
[
k
] =
f
) {

50739 
ªs
 = 
k
;

50745 
JS_CLASS_FLOAT64_ARRAY
:

50746 i‡(
is_bigöt
)

50748 i‡(
	`i¢™
(
d
)) {

50749 c⁄° *
pv
 = 
p
->
u
.
¨øy
.u.
doubÀ_±r
;

50751 i‡(
•ecül
 !
•ecül_ö˛udes
)

50752 
d⁄e
;

50753 ; 
k
 !
°›
; k +
öc
) {

50754 i‡(
	`i¢™
(
pv
[
k
])) {

50755 
ªs
 = 
k
;

50760 c⁄° *
pv
 = 
p
->
u
.
¨øy
.u.
doubÀ_±r
;

50761 ; 
k
 !
°›
; k +
öc
) {

50762 i‡(
pv
[
k
] =
d
) {

50763 
ªs
 = 
k
;

50769 #ifde‡
CONFIG_BIGNUM


50770 
JS_CLASS_BIG_INT64_ARRAY
:

50771 i‡(
is_bigöt
 || (
	`is_m©h_mode
(
˘x
Ë&& 
is_öt
 &&

50772 
v64
 >-
MAX_SAFE_INTEGER
 &&

50773 
v64
 <
MAX_SAFE_INTEGER
)) {

50774 
sˇn64
;

50777 
JS_CLASS_BIG_UINT64_ARRAY
:

50778 i‡(
is_bigöt
 || (
	`is_m©h_mode
(
˘x
Ë&& 
is_öt
 &&

50779 
v64
 >0 && v64 <
MAX_SAFE_INTEGER
)) {

50780 c⁄° 
uöt64_t
 *
pv
;

50781 
uöt64_t
 
v
;

50782 
sˇn64
:

50783 
pv
 = 
p
->
u
.
¨øy
.u.
uöt64_±r
;

50784 
v
 = 
v64
;

50785 ; 
k
 !
°›
; k +
öc
) {

50786 i‡(
pv
[
k
] =
v
) {

50787 
ªs
 = 
k
;

50796 
d⁄e
:

50797 i‡(
•ecül
 =
•ecül_ö˛udes
)

50798  
	`JS_NewBoﬁ
(
˘x
, 
ªs
 >= 0);

50800  
	`JS_NewI¡32
(
˘x
, 
ªs
);

50802 
ex˚±i⁄
:

50803  
JS_EXCEPTION
;

50804 
	}
}

50806 
JSVÆue
 
	$js_ty≥d_¨øy_joö
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

50807 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
, 
toLoˇÀSåög
)

50809 
JSVÆue
 
£p
 = 
JS_UNDEFINED
, 
ñ
;

50810 
SåögBuf„r
 
b_s
, *
b
 = &b_s;

50811 
JSSåög
 *
p
 = 
NULL
;

50812 
i
, 
n
;

50813 
c
;

50815 
n
 = 
	`js_ty≥d_¨øy_gë_Àngth_öã∫Æ
(
˘x
, 
this_vÆ
);

50816 i‡(
n
 < 0)

50817 
ex˚±i⁄
;

50819 
c
 = ',';

50820 i‡(!
toLoˇÀSåög
 && 
¨gc
 > 0 && !
	`JS_IsUndeföed
(
¨gv
[0])) {

50821 
£p
 = 
	`JS_ToSåög
(
˘x
, 
¨gv
[0]);

50822 i‡(
	`JS_IsEx˚±i⁄
(
£p
))

50823 
ex˚±i⁄
;

50824 
p
 = 
	`JS_VALUE_GET_STRING
(
£p
);

50825 i‡(
p
->
Àn
 =1 && !p->
is_wide_ch¨
)

50826 
c
 = 
p
->
u
.
°r8
[0];

50828 
c
 = -1;

50830 
	`°rög_buf„r_öô
(
˘x
, 
b
, 0);

50833 
i
 = 0; i < 
n
; i++) {

50834 i‡(
i
 > 0) {

50835 i‡(
c
 >= 0) {

50836 i‡(
	`°rög_buf„r_putc8
(
b
, 
c
))

50837 
Áû
;

50839 i‡(
	`°rög_buf„r_c⁄ˇt
(
b
, 
p
, 0,Ö->
Àn
))

50840 
Áû
;

50843 
ñ
 = 
	`JS_GëPr›îtyUöt32
(
˘x
, 
this_vÆ
, 
i
);

50844 i‡(
	`JS_IsEx˚±i⁄
(
ñ
))

50845 
Áû
;

50846 i‡(
toLoˇÀSåög
) {

50847 
ñ
 = 
	`JS_ToLoˇÀSåögFªe
(
˘x
,Él);

50849 i‡(
	`°rög_buf„r_c⁄ˇt_vÆue_‰ì
(
b
, 
ñ
))

50850 
Áû
;

50852 
	`JS_FªeVÆue
(
˘x
, 
£p
);

50853  
	`°rög_buf„r_íd
(
b
);

50855 
Áû
:

50856 
	`°rög_buf„r_‰ì
(
b
);

50857 
	`JS_FªeVÆue
(
˘x
, 
£p
);

50858 
ex˚±i⁄
:

50859  
JS_EXCEPTION
;

50860 
	}
}

50862 
JSVÆue
 
	$js_ty≥d_¨øy_ªvî£
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

50863 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

50865 
JSObje˘
 *
p
;

50866 
Àn
;

50868 
Àn
 = 
	`js_ty≥d_¨øy_gë_Àngth_öã∫Æ
(
˘x
, 
this_vÆ
);

50869 i‡(
Àn
 < 0)

50870  
JS_EXCEPTION
;

50871 i‡(
Àn
 > 0) {

50872 
p
 = 
	`JS_VALUE_GET_OBJ
(
this_vÆ
);

50873 
	`ty≥d_¨øy_size_log2
(
p
->
˛ass_id
)) {

50876 
uöt8_t
 *
p1
 = 
p
->
u
.
¨øy
.u.
uöt8_±r
;

50877 
uöt8_t
 *
p2
 = 
p1
 + 
Àn
 - 1;

50878 
p1
 < 
p2
) {

50879 
uöt8_t
 
v
 = *
p1
;

50880 *
p1
++ = *
p2
;

50881 *
p2
-- = 
v
;

50887 
uöt16_t
 *
p1
 = 
p
->
u
.
¨øy
.u.
uöt16_±r
;

50888 
uöt16_t
 *
p2
 = 
p1
 + 
Àn
 - 1;

50889 
p1
 < 
p2
) {

50890 
uöt16_t
 
v
 = *
p1
;

50891 *
p1
++ = *
p2
;

50892 *
p2
-- = 
v
;

50898 
uöt32_t
 *
p1
 = 
p
->
u
.
¨øy
.u.
uöt32_±r
;

50899 
uöt32_t
 *
p2
 = 
p1
 + 
Àn
 - 1;

50900 
p1
 < 
p2
) {

50901 
uöt32_t
 
v
 = *
p1
;

50902 *
p1
++ = *
p2
;

50903 *
p2
-- = 
v
;

50909 
uöt64_t
 *
p1
 = 
p
->
u
.
¨øy
.u.
uöt64_±r
;

50910 
uöt64_t
 *
p2
 = 
p1
 + 
Àn
 - 1;

50911 
p1
 < 
p2
) {

50912 
uöt64_t
 
v
 = *
p1
;

50913 *
p1
++ = *
p2
;

50914 *
p2
-- = 
v
;

50919 
	`ab‹t
();

50922  
	`JS_DupVÆue
(
˘x
, 
this_vÆ
);

50923 
	}
}

50925 
JSVÆue
 
	$js_ty≥d_¨øy_¶i˚
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

50926 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

50928 
JSVÆueC⁄°
 
¨gs
[2];

50929 
JSVÆue
 
¨r
, 
vÆ
;

50930 
JSObje˘
 *
p
, *
p1
;

50931 
n
, 
Àn
, 
°¨t
, 
föÆ
, 
cou¡
, 
shi·
;

50933 
¨r
 = 
JS_UNDEFINED
;

50934 
Àn
 = 
	`js_ty≥d_¨øy_gë_Àngth_öã∫Æ
(
˘x
, 
this_vÆ
);

50935 i‡(
Àn
 < 0)

50936 
ex˚±i⁄
;

50938 i‡(
	`JS_ToI¡32Cœmp
(
˘x
, &
°¨t
, 
¨gv
[0], 0, 
Àn
,Üen))

50939 
ex˚±i⁄
;

50940 
föÆ
 = 
Àn
;

50941 i‡(!
	`JS_IsUndeföed
(
¨gv
[1])) {

50942 i‡(
	`JS_ToI¡32Cœmp
(
˘x
, &
föÆ
, 
¨gv
[1], 0, 
Àn
,Üen))

50943 
ex˚±i⁄
;

50945 
cou¡
 = 
	`max_öt
(
föÆ
 - 
°¨t
, 0);

50947 
p
 = 
	`gë_ty≥d_¨øy
(
˘x
, 
this_vÆ
, 0);

50948 i‡(
p
 =
NULL
)

50949 
ex˚±i⁄
;

50950 
shi·
 = 
	`ty≥d_¨øy_size_log2
(
p
->
˛ass_id
);

50952 
¨gs
[0] = 
this_vÆ
;

50953 
¨gs
[1] = 
	`JS_NewI¡32
(
˘x
, 
cou¡
);

50954 
¨r
 = 
	`js_ty≥d_¨øy___•ecõsCª©e
(
˘x
, 
JS_UNDEFINED
, 2, 
¨gs
);

50955 i‡(
	`JS_IsEx˚±i⁄
(
¨r
))

50956 
ex˚±i⁄
;

50958 i‡(
cou¡
 > 0) {

50959 i‡(
	`vÆid©e_ty≥d_¨øy
(
˘x
, 
this_vÆ
)

50960 || 
	`vÆid©e_ty≥d_¨øy
(
˘x
, 
¨r
))

50961 
ex˚±i⁄
;

50963 
p1
 = 
	`gë_ty≥d_¨øy
(
˘x
, 
¨r
, 0);

50964 i‡(
p1
 !
NULL
 && 
p
->
˛ass_id
 ==Ö1->class_id &&

50965 
	`ty≥d_¨øy_gë_Àngth
(
˘x
, 
p1
Ë>
cou¡
 &&

50966 
	`ty≥d_¨øy_gë_Àngth
(
˘x
, 
p
Ë>
°¨t
 + 
cou¡
) {

50967 
	`mem˝y
(
p1
->
u
.
¨øy
.u.
uöt8_±r
,

50968 
p
->
u
.
¨øy
.u.
uöt8_±r
 + (
°¨t
 << 
shi·
),

50969 
cou¡
 << 
shi·
);

50971 
n
 = 0;Ç < 
cou¡
;Ç++) {

50972 
vÆ
 = 
	`JS_GëPr›îtyVÆue
(
˘x
, 
this_vÆ
, 
	`JS_NewI¡32
(˘x, 
°¨t
 + 
n
));

50973 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

50974 
ex˚±i⁄
;

50975 i‡(
	`JS_SëPr›îtyVÆue
(
˘x
, 
¨r
, 
	`JS_NewI¡32
(˘x, 
n
), 
vÆ
,

50976 
JS_PROP_THROW
) < 0)

50977 
ex˚±i⁄
;

50981  
¨r
;

50983 
ex˚±i⁄
:

50984 
	`JS_FªeVÆue
(
˘x
, 
¨r
);

50985  
JS_EXCEPTION
;

50986 
	}
}

50988 
JSVÆue
 
	$js_ty≥d_¨øy_sub¨øy
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

50989 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

50991 
JSVÆueC⁄°
 
¨gs
[4];

50992 
JSVÆue
 
¨r
, 
byãOff£t
, 
è_buf„r
;

50993 
JSObje˘
 *
p
;

50994 
Àn
, 
°¨t
, 
föÆ
, 
cou¡
, 
shi·
, 
off£t
;

50996 
p
 = 
	`gë_ty≥d_¨øy
(
˘x
, 
this_vÆ
, 0);

50997 i‡(!
p
)

50998 
ex˚±i⁄
;

50999 
Àn
 = 
p
->
u
.
¨øy
.
cou¡
;

51000 i‡(
	`JS_ToI¡32Cœmp
(
˘x
, &
°¨t
, 
¨gv
[0], 0, 
Àn
,Üen))

51001 
ex˚±i⁄
;

51003 
föÆ
 = 
Àn
;

51004 i‡(!
	`JS_IsUndeföed
(
¨gv
[1])) {

51005 i‡(
	`JS_ToI¡32Cœmp
(
˘x
, &
föÆ
, 
¨gv
[1], 0, 
Àn
,Üen))

51006 
ex˚±i⁄
;

51008 
cou¡
 = 
	`max_öt
(
föÆ
 - 
°¨t
, 0);

51009 
byãOff£t
 = 
	`js_ty≥d_¨øy_gë_byãOff£t
(
˘x
, 
this_vÆ
, 0);

51010 i‡(
	`JS_IsEx˚±i⁄
(
byãOff£t
))

51011 
ex˚±i⁄
;

51012 
shi·
 = 
	`ty≥d_¨øy_size_log2
(
p
->
˛ass_id
);

51013 
off£t
 = 
	`JS_VALUE_GET_INT
(
byãOff£t
Ë+ (
°¨t
 << 
shi·
);

51014 
	`JS_FªeVÆue
(
˘x
, 
byãOff£t
);

51015 
è_buf„r
 = 
	`js_ty≥d_¨øy_gë_buf„r
(
˘x
, 
this_vÆ
, 0);

51016 i‡(
	`JS_IsEx˚±i⁄
(
è_buf„r
))

51017 
ex˚±i⁄
;

51018 
¨gs
[0] = 
this_vÆ
;

51019 
¨gs
[1] = 
è_buf„r
;

51020 
¨gs
[2] = 
	`JS_NewI¡32
(
˘x
, 
off£t
);

51021 
¨gs
[3] = 
	`JS_NewI¡32
(
˘x
, 
cou¡
);

51022 
¨r
 = 
	`js_ty≥d_¨øy___•ecõsCª©e
(
˘x
, 
JS_UNDEFINED
, 4, 
¨gs
);

51023 
	`JS_FªeVÆue
(
˘x
, 
è_buf„r
);

51024  
¨r
;

51026 
ex˚±i⁄
:

51027  
JS_EXCEPTION
;

51028 
	}
}

51032 
	$js_cmp_doubÀs
(
x
, 
y
)

51034 i‡(
	`i¢™
(
x
)Ë i¢™(
y
) ? 0 : +1;

51035 i‡(
	`i¢™
(
y
))  -1;

51036 i‡(
x
 < 
y
)  -1;

51037 i‡(
x
 > 
y
)  1;

51038 i‡(
x
 != 0)  0;

51039 i‡(
	`signbô
(
x
)Ë signbô(
y
) ? 0 : -1;

51040  
	`signbô
(
y
) ? 1 : 0;

51041 
	}
}

51043 
	$js_TA_cmp_öt8
(c⁄° *
a
, c⁄° *
b
, *
›aque
) {

51044  *(c⁄° 
öt8_t
 *)
a
 - *(c⁄° i¡8_à*)
b
;

51045 
	}
}

51047 
	$js_TA_cmp_uöt8
(c⁄° *
a
, c⁄° *
b
, *
›aque
) {

51048  *(c⁄° 
uöt8_t
 *)
a
 - *(c⁄° uöt8_à*)
b
;

51049 
	}
}

51051 
	$js_TA_cmp_öt16
(c⁄° *
a
, c⁄° *
b
, *
›aque
) {

51052  *(c⁄° 
öt16_t
 *)
a
 - *(c⁄° i¡16_à*)
b
;

51053 
	}
}

51055 
	$js_TA_cmp_uöt16
(c⁄° *
a
, c⁄° *
b
, *
›aque
) {

51056  *(c⁄° 
uöt16_t
 *)
a
 - *(c⁄° uöt16_à*)
b
;

51057 
	}
}

51059 
	$js_TA_cmp_öt32
(c⁄° *
a
, c⁄° *
b
, *
›aque
) {

51060 
öt32_t
 
x
 = *(c⁄° i¡32_à*)
a
;

51061 
öt32_t
 
y
 = *(c⁄° i¡32_à*)
b
;

51062  (
y
 < 
x
) - (y > x);

51063 
	}
}

51065 
	$js_TA_cmp_uöt32
(c⁄° *
a
, c⁄° *
b
, *
›aque
) {

51066 
uöt32_t
 
x
 = *(c⁄° uöt32_à*)
a
;

51067 
uöt32_t
 
y
 = *(c⁄° uöt32_à*)
b
;

51068  (
y
 < 
x
) - (y > x);

51069 
	}
}

51071 #ifde‡
CONFIG_BIGNUM


51072 
	$js_TA_cmp_öt64
(c⁄° *
a
, c⁄° *
b
, *
›aque
) {

51073 
öt64_t
 
x
 = *(c⁄° i¡64_à*)
a
;

51074 
öt64_t
 
y
 = *(c⁄° i¡64_à*)
b
;

51075  (
y
 < 
x
) - (y > x);

51076 
	}
}

51078 
	$js_TA_cmp_uöt64
(c⁄° *
a
, c⁄° *
b
, *
›aque
) {

51079 
uöt64_t
 
x
 = *(c⁄° uöt64_à*)
a
;

51080 
uöt64_t
 
y
 = *(c⁄° uöt64_à*)
b
;

51081  (
y
 < 
x
) - (y > x);

51082 
	}
}

51085 
	$js_TA_cmp_Êﬂt32
(c⁄° *
a
, c⁄° *
b
, *
›aque
) {

51086  
	`js_cmp_doubÀs
(*(c⁄° *)
a
, *(c⁄° *)
b
);

51087 
	}
}

51089 
	$js_TA_cmp_Êﬂt64
(c⁄° *
a
, c⁄° *
b
, *
›aque
) {

51090  
	`js_cmp_doubÀs
(*(c⁄° *)
a
, *(c⁄° *)
b
);

51091 
	}
}

51093 
JSVÆue
 
	$js_TA_gë_öt8
(
JSC⁄ãxt
 *
˘x
, c⁄° *
a
) {

51094  
	`JS_NewI¡32
(
˘x
, *(c⁄° 
öt8_t
 *)
a
);

51095 
	}
}

51097 
JSVÆue
 
	$js_TA_gë_uöt8
(
JSC⁄ãxt
 *
˘x
, c⁄° *
a
) {

51098  
	`JS_NewI¡32
(
˘x
, *(c⁄° 
uöt8_t
 *)
a
);

51099 
	}
}

51101 
JSVÆue
 
	$js_TA_gë_öt16
(
JSC⁄ãxt
 *
˘x
, c⁄° *
a
) {

51102  
	`JS_NewI¡32
(
˘x
, *(c⁄° 
öt16_t
 *)
a
);

51103 
	}
}

51105 
JSVÆue
 
	$js_TA_gë_uöt16
(
JSC⁄ãxt
 *
˘x
, c⁄° *
a
) {

51106  
	`JS_NewI¡32
(
˘x
, *(c⁄° 
uöt16_t
 *)
a
);

51107 
	}
}

51109 
JSVÆue
 
	$js_TA_gë_öt32
(
JSC⁄ãxt
 *
˘x
, c⁄° *
a
) {

51110  
	`JS_NewI¡32
(
˘x
, *(c⁄° 
öt32_t
 *)
a
);

51111 
	}
}

51113 
JSVÆue
 
	$js_TA_gë_uöt32
(
JSC⁄ãxt
 *
˘x
, c⁄° *
a
) {

51114  
	`JS_NewUöt32
(
˘x
, *(c⁄° 
uöt32_t
 *)
a
);

51115 
	}
}

51117 #ifde‡
CONFIG_BIGNUM


51118 
JSVÆue
 
	$js_TA_gë_öt64
(
JSC⁄ãxt
 *
˘x
, c⁄° *
a
) {

51119  
	`JS_NewBigI¡64
(
˘x
, *(
öt64_t
 *)
a
);

51120 
	}
}

51122 
JSVÆue
 
	$js_TA_gë_uöt64
(
JSC⁄ãxt
 *
˘x
, c⁄° *
a
) {

51123  
	`JS_NewBigUöt64
(
˘x
, *(
uöt64_t
 *)
a
);

51124 
	}
}

51127 
JSVÆue
 
	$js_TA_gë_Êﬂt32
(
JSC⁄ãxt
 *
˘x
, c⁄° *
a
) {

51128  
	`__JS_NewFlﬂt64
(
˘x
, *(c⁄° *)
a
);

51129 
	}
}

51131 
JSVÆue
 
	$js_TA_gë_Êﬂt64
(
JSC⁄ãxt
 *
˘x
, c⁄° *
a
) {

51132  
	`__JS_NewFlﬂt64
(
˘x
, *(c⁄° *)
a
);

51133 
	}
}

51135 
	sTA_s‹t_c⁄ãxt
 {

51136 
JSC⁄ãxt
 *
	m˘x
;

51137 
	mex˚±i⁄
;

51138 
JSVÆueC⁄°
 
	m¨r
;

51139 
JSVÆueC⁄°
 
	mcmp
;

51140 
JSVÆue
 (*
gëfun
)(
JSC⁄ãxt
 *
	m˘x
, c⁄° *
	ma
);

51141 
uöt8_t
 *
	m¨øy_±r
;

51142 
	mñt_size
;

51145 
	$js_TA_cmp_gíîic
(c⁄° *
a
, c⁄° *
b
, *
›aque
) {

51146 
TA_s‹t_c⁄ãxt
 *
psc
 = 
›aque
;

51147 
JSC⁄ãxt
 *
˘x
 = 
psc
->ctx;

51148 
uöt32_t
 
a_idx
, 
b_idx
;

51149 
JSVÆueC⁄°
 
¨gv
[2];

51150 
JSVÆue
 
ªs
;

51151 
cmp
;

51153 
cmp
 = 0;

51154 i‡(!
psc
->
ex˚±i⁄
) {

51155 
a_idx
 = *(
uöt32_t
 *)
a
;

51156 
b_idx
 = *(
uöt32_t
 *)
b
;

51157 
¨gv
[0] = 
psc
->
	`gëfun
(
˘x
,Ösc->
¨øy_±r
 +

51158 
a_idx
 * (
size_t
)
psc
->
ñt_size
);

51159 
¨gv
[1] = 
psc
->
	`gëfun
(
˘x
,Ösc->
¨øy_±r
 +

51160 
b_idx
 * (
size_t
)(
psc
->
ñt_size
));

51161 
ªs
 = 
	`JS_CÆl
(
˘x
, 
psc
->
cmp
, 
JS_UNDEFINED
, 2, 
¨gv
);

51162 i‡(
	`JS_IsEx˚±i⁄
(
ªs
)) {

51163 
psc
->
ex˚±i⁄
 = 1;

51164 
d⁄e
;

51166 i‡(
	`JS_VALUE_GET_TAG
(
ªs
Ë=
JS_TAG_INT
) {

51167 
vÆ
 = 
	`JS_VALUE_GET_INT
(
ªs
);

51168 
cmp
 = (
vÆ
 > 0) - (val < 0);

51170 
vÆ
;

51171 i‡(
	`JS_ToFlﬂt64Fªe
(
˘x
, &
vÆ
, 
ªs
) < 0) {

51172 
psc
->
ex˚±i⁄
 = 1;

51173 
d⁄e
;

51175 
cmp
 = (
vÆ
 > 0) - (val < 0);

51178 i‡(
cmp
 == 0) {

51180 
cmp
 = (
a_idx
 > 
b_idx
) - (a_idx < b_idx);

51182 i‡(
	`vÆid©e_ty≥d_¨øy
(
˘x
, 
psc
->
¨r
) < 0) {

51183 
psc
->
ex˚±i⁄
 = 1;

51185 
d⁄e
:

51186 
	`JS_FªeVÆue
(
˘x
, (
JSVÆue
)
¨gv
[0]);

51187 
	`JS_FªeVÆue
(
˘x
, (
JSVÆue
)
¨gv
[1]);

51189  
cmp
;

51190 
	}
}

51192 
JSVÆue
 
	$js_ty≥d_¨øy_s‹t
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
this_vÆ
,

51193 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

51195 
JSObje˘
 *
p
;

51196 
Àn
;

51197 
size_t
 
ñt_size
;

51198 
TA_s‹t_c⁄ãxt
 
tsc
;

51199 *
¨øy_±r
;

51200 (*
cmpfun
)(c⁄° *
a
, c⁄° *
b
, *
›aque
);

51202 
tsc
.
˘x
 = ctx;

51203 
tsc
.
ex˚±i⁄
 = 0;

51204 
tsc
.
¨r
 = 
this_vÆ
;

51205 
tsc
.
cmp
 = 
¨gv
[0];

51207 
Àn
 = 
	`js_ty≥d_¨øy_gë_Àngth_öã∫Æ
(
˘x
, 
this_vÆ
);

51208 i‡(
Àn
 < 0)

51209  
JS_EXCEPTION
;

51210 i‡(!
	`JS_IsUndeföed
(
tsc
.
cmp
Ë&& 
	`check_fun˘i⁄
(
˘x
,Åsc.cmp))

51211  
JS_EXCEPTION
;

51213 i‡(
Àn
 > 1) {

51214 
p
 = 
	`JS_VALUE_GET_OBJ
(
this_vÆ
);

51215 
p
->
˛ass_id
) {

51216 
JS_CLASS_INT8_ARRAY
:

51217 
tsc
.
gëfun
 = 
js_TA_gë_öt8
;

51218 
cmpfun
 = 
js_TA_cmp_öt8
;

51220 
JS_CLASS_UINT8C_ARRAY
:

51221 
JS_CLASS_UINT8_ARRAY
:

51222 
tsc
.
gëfun
 = 
js_TA_gë_uöt8
;

51223 
cmpfun
 = 
js_TA_cmp_uöt8
;

51225 
JS_CLASS_INT16_ARRAY
:

51226 
tsc
.
gëfun
 = 
js_TA_gë_öt16
;

51227 
cmpfun
 = 
js_TA_cmp_öt16
;

51229 
JS_CLASS_UINT16_ARRAY
:

51230 
tsc
.
gëfun
 = 
js_TA_gë_uöt16
;

51231 
cmpfun
 = 
js_TA_cmp_uöt16
;

51233 
JS_CLASS_INT32_ARRAY
:

51234 
tsc
.
gëfun
 = 
js_TA_gë_öt32
;

51235 
cmpfun
 = 
js_TA_cmp_öt32
;

51237 
JS_CLASS_UINT32_ARRAY
:

51238 
tsc
.
gëfun
 = 
js_TA_gë_uöt32
;

51239 
cmpfun
 = 
js_TA_cmp_uöt32
;

51241 #ifde‡
CONFIG_BIGNUM


51242 
JS_CLASS_BIG_INT64_ARRAY
:

51243 
tsc
.
gëfun
 = 
js_TA_gë_öt64
;

51244 
cmpfun
 = 
js_TA_cmp_öt64
;

51246 
JS_CLASS_BIG_UINT64_ARRAY
:

51247 
tsc
.
gëfun
 = 
js_TA_gë_uöt64
;

51248 
cmpfun
 = 
js_TA_cmp_uöt64
;

51251 
JS_CLASS_FLOAT32_ARRAY
:

51252 
tsc
.
gëfun
 = 
js_TA_gë_Êﬂt32
;

51253 
cmpfun
 = 
js_TA_cmp_Êﬂt32
;

51255 
JS_CLASS_FLOAT64_ARRAY
:

51256 
tsc
.
gëfun
 = 
js_TA_gë_Êﬂt64
;

51257 
cmpfun
 = 
js_TA_cmp_Êﬂt64
;

51260 
	`ab‹t
();

51262 
¨øy_±r
 = 
p
->
u
.
¨øy
.u.
±r
;

51263 
ñt_size
 = 1 << 
	`ty≥d_¨øy_size_log2
(
p
->
˛ass_id
);

51264 i‡(!
	`JS_IsUndeföed
(
tsc
.
cmp
)) {

51265 
uöt32_t
 *
¨øy_idx
;

51266 *
¨øy_tmp
;

51267 
size_t
 
i
, 
j
;

51270 
¨øy_idx
 = 
	`js_mÆloc
(
˘x
, 
Àn
 * (array_idx[0]));

51271 i‡(!
¨øy_idx
)

51272  
JS_EXCEPTION
;

51273 
i
 = 0; i < 
Àn
; i++)

51274 
¨øy_idx
[
i
] = i;

51275 
tsc
.
¨øy_±r
 =árray_ptr;

51276 
tsc
.
ñt_size
 =Élt_size;

51277 
	`rqs‹t
(
¨øy_idx
, 
Àn
, (array_idx[0]),

51278 
js_TA_cmp_gíîic
, &
tsc
);

51279 i‡(
tsc
.
ex˚±i⁄
)

51280 
Áû
;

51281 
¨øy_tmp
 = 
	`js_mÆloc
(
˘x
, 
Àn
 * 
ñt_size
);

51282 i‡(!
¨øy_tmp
) {

51283 
Áû
:

51284 
	`js_‰ì
(
˘x
, 
¨øy_idx
);

51285  
JS_EXCEPTION
;

51287 
	`mem˝y
(
¨øy_tmp
, 
¨øy_±r
, 
Àn
 * 
ñt_size
);

51288 
ñt_size
) {

51290 
i
 = 0; i < 
Àn
; i++) {

51291 
j
 = 
¨øy_idx
[
i
];

51292 ((
uöt8_t
 *)
¨øy_±r
)[
i
] = ((uöt8_à*)
¨øy_tmp
)[
j
];

51296 
i
 = 0; i < 
Àn
; i++) {

51297 
j
 = 
¨øy_idx
[
i
];

51298 ((
uöt16_t
 *)
¨øy_±r
)[
i
] = ((uöt16_à*)
¨øy_tmp
)[
j
];

51302 
i
 = 0; i < 
Àn
; i++) {

51303 
j
 = 
¨øy_idx
[
i
];

51304 ((
uöt32_t
 *)
¨øy_±r
)[
i
] = ((uöt32_à*)
¨øy_tmp
)[
j
];

51308 
i
 = 0; i < 
Àn
; i++) {

51309 
j
 = 
¨øy_idx
[
i
];

51310 ((
uöt64_t
 *)
¨øy_±r
)[
i
] = ((uöt64_à*)
¨øy_tmp
)[
j
];

51314 
	`ab‹t
();

51316 
	`js_‰ì
(
˘x
, 
¨øy_tmp
);

51317 
	`js_‰ì
(
˘x
, 
¨øy_idx
);

51319 
	`rqs‹t
(
¨øy_±r
, 
Àn
, 
ñt_size
, 
cmpfun
, &
tsc
);

51320 i‡(
tsc
.
ex˚±i⁄
)

51321  
JS_EXCEPTION
;

51324  
	`JS_DupVÆue
(
˘x
, 
this_vÆ
);

51325 
	}
}

51327 c⁄° 
JSCFun˘i⁄Li°E¡ry
 
	gjs_ty≥d_¨øy_ba£_funcs
[] = {

51328 
JS_CFUNC_DEF
("‰om", 1, 
js_ty≥d_¨øy_‰om
 ),

51329 
JS_CFUNC_DEF
("of", 0, 
js_ty≥d_¨øy_of
 ),

51330 
JS_CGETSET_DEF
("[Symbﬁ.•ecõs]", 
js_gë_this
, 
NULL
 ),

51336 c⁄° 
JSCFun˘i⁄Li°E¡ry
 
	gjs_ty≥d_¨øy_ba£_¥Ÿo_funcs
[] = {

51337 
JS_CGETSET_DEF
("Àngth", 
js_ty≥d_¨øy_gë_Àngth
, 
NULL
 ),

51338 
JS_CGETSET_MAGIC_DEF
("buf„r", 
js_ty≥d_¨øy_gë_buf„r
, 
NULL
, 0 ),

51339 
JS_CGETSET_MAGIC_DEF
("byãLígth", 
js_ty≥d_¨øy_gë_byãLígth
, 
NULL
, 0 ),

51340 
JS_CGETSET_MAGIC_DEF
("byãOff£t", 
js_ty≥d_¨øy_gë_byãOff£t
, 
NULL
, 0 ),

51341 
JS_CFUNC_DEF
("£t", 1, 
js_ty≥d_¨øy_£t
 ),

51342 
JS_CFUNC_MAGIC_DEF
("vÆues", 0, 
js_¸óã_ty≥d_¨øy_ôî©‹
, 
JS_ITERATOR_KIND_VALUE
 ),

51343 
JS_ALIAS_DEF
("[Symbol.iterator]", "values" ),

51344 
JS_CFUNC_MAGIC_DEF
("keys", 0, 
js_¸óã_ty≥d_¨øy_ôî©‹
, 
JS_ITERATOR_KIND_KEY
 ),

51345 
JS_CFUNC_MAGIC_DEF
("íåõs", 0, 
js_¸óã_ty≥d_¨øy_ôî©‹
, 
JS_ITERATOR_KIND_KEY_AND_VALUE
 ),

51346 
JS_CGETSET_DEF
("[Symbﬁ.toSåögTag]", 
js_ty≥d_¨øy_gë_toSåögTag
, 
NULL
 ),

51347 
JS_CFUNC_DEF
("c›yWôhö", 2, 
js_ty≥d_¨øy_c›yWôhö
 ),

51348 
JS_CFUNC_MAGIC_DEF
("evîy", 1, 
js_¨øy_evîy
, 
•ecül_evîy
 | 
•ecül_TA
 ),

51349 
JS_CFUNC_MAGIC_DEF
("some", 1, 
js_¨øy_evîy
, 
•ecül_some
 | 
•ecül_TA
 ),

51350 
JS_CFUNC_MAGIC_DEF
("f‹Each", 1, 
js_¨øy_evîy
, 
•ecül_f‹Each
 | 
•ecül_TA
 ),

51351 
JS_CFUNC_MAGIC_DEF
("m≠", 1, 
js_¨øy_evîy
, 
•ecül_m≠
 | 
•ecül_TA
 ),

51352 
JS_CFUNC_MAGIC_DEF
("fûãr", 1, 
js_¨øy_evîy
, 
•ecül_fûãr
 | 
•ecül_TA
 ),

51353 
JS_CFUNC_MAGIC_DEF
("ªdu˚", 1, 
js_¨øy_ªdu˚
, 
•ecül_ªdu˚
 | 
•ecül_TA
 ),

51354 
JS_CFUNC_MAGIC_DEF
("ªdu˚Right", 1, 
js_¨øy_ªdu˚
, 
•ecül_ªdu˚Right
 | 
•ecül_TA
 ),

51355 
JS_CFUNC_DEF
("fûl", 1, 
js_ty≥d_¨øy_fûl
 ),

51356 
JS_CFUNC_MAGIC_DEF
("föd", 1, 
js_ty≥d_¨øy_föd
, 0 ),

51357 
JS_CFUNC_MAGIC_DEF
("födIndex", 1, 
js_ty≥d_¨øy_föd
, 1 ),

51358 
JS_CFUNC_DEF
("ªvî£", 0, 
js_ty≥d_¨øy_ªvî£
 ),

51359 
JS_CFUNC_DEF
("¶i˚", 2, 
js_ty≥d_¨øy_¶i˚
 ),

51360 
JS_CFUNC_DEF
("sub¨øy", 2, 
js_ty≥d_¨øy_sub¨øy
 ),

51361 
JS_CFUNC_DEF
("s‹t", 1, 
js_ty≥d_¨øy_s‹t
 ),

51362 
JS_CFUNC_MAGIC_DEF
("joö", 1, 
js_ty≥d_¨øy_joö
, 0 ),

51363 
JS_CFUNC_MAGIC_DEF
("toLoˇÀSåög", 0, 
js_ty≥d_¨øy_joö
, 1 ),

51364 
JS_CFUNC_MAGIC_DEF
("ödexOf", 1, 
js_ty≥d_¨øy_ödexOf
, 
•ecül_ödexOf
 ),

51365 
JS_CFUNC_MAGIC_DEF
("œ°IndexOf", 1, 
js_ty≥d_¨øy_ödexOf
, 
•ecül_œ°IndexOf
 ),

51366 
JS_CFUNC_MAGIC_DEF
("ö˛udes", 1, 
js_ty≥d_¨øy_ödexOf
, 
•ecül_ö˛udes
 ),

51370 
JSVÆue
 
	$js_ty≥d_¨øy_ba£_c⁄°ru˘‹
(
JSC⁄ãxt
 *
˘x
,

51371 
JSVÆueC⁄°
 
this_vÆ
,

51372 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

51374  
	`JS_ThrowTy≥Eº‹
(
˘x
, "cannot be called");

51375 
	}
}

51378 
	$ty≥d_¨øy_öô
(
JSC⁄ãxt
 *
˘x
, 
JSVÆueC⁄°
 
obj
,

51379 
JSVÆue
 
buf„r
, 
uöt64_t
 
off£t
, uöt64_à
Àn
)

51381 
JSTy≥dAºay
 *
è
;

51382 
JSObje˘
 *
p
, *
pbuf„r
;

51383 
JSAºayBuf„r
 *
abuf
;

51384 
size_log2
;

51386 
p
 = 
	`JS_VALUE_GET_OBJ
(
obj
);

51387 
size_log2
 = 
	`ty≥d_¨øy_size_log2
(
p
->
˛ass_id
);

51388 
è
 = 
	`js_mÆloc
(
˘x
, (*ta));

51389 i‡(!
è
) {

51390 
	`JS_FªeVÆue
(
˘x
, 
buf„r
);

51393 
pbuf„r
 = 
	`JS_VALUE_GET_OBJ
(
buf„r
);

51394 
abuf
 = 
pbuf„r
->
u
.
¨øy_buf„r
;

51395 
è
->
obj
 = 
p
;

51396 
è
->
buf„r
 = 
pbuf„r
;

51397 
è
->
off£t
 = offset;

51398 
è
->
Àngth
 = 
Àn
 << 
size_log2
;

51399 
	`li°_add_èû
(&
è
->
lök
, &
abuf
->
¨øy_li°
);

51400 
p
->
u
.
ty≥d_¨øy
 = 
è
;

51401 
p
->
u
.
¨øy
.
cou¡
 = 
Àn
;

51402 
p
->
u
.
¨øy
.u.
±r
 = 
abuf
->
d©a
 + 
off£t
;

51404 
	}
}

51407 
JSVÆue
 
	$js_¨øy_‰om_ôî©‹
(
JSC⁄ãxt
 *
˘x
, 
uöt32_t
 *
∂í
,

51408 
JSVÆueC⁄°
 
obj
, JSVÆueC⁄° 
mëhod
)

51410 
JSVÆue
 
¨r
, 
ôî
, 
√xt_mëhod
 = 
JS_UNDEFINED
, 
vÆ
;

51411 
BOOL
 
d⁄e
;

51412 
uöt32_t
 
k
;

51414 *
∂í
 = 0;

51415 
¨r
 = 
	`JS_NewAºay
(
˘x
);

51416 i‡(
	`JS_IsEx˚±i⁄
(
¨r
))

51417  
¨r
;

51418 
ôî
 = 
	`JS_GëIãøt‹2
(
˘x
, 
obj
, 
mëhod
);

51419 i‡(
	`JS_IsEx˚±i⁄
(
ôî
))

51420 
Áû
;

51421 
√xt_mëhod
 = 
	`JS_GëPr›îty
(
˘x
, 
ôî
, 
JS_ATOM_√xt
);

51422 i‡(
	`JS_IsEx˚±i⁄
(
√xt_mëhod
))

51423 
Áû
;

51424 
k
 = 0;

51426 
vÆ
 = 
	`JS_Iãøt‹Next
(
˘x
, 
ôî
, 
√xt_mëhod
, 0, 
NULL
, &
d⁄e
);

51427 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

51428 
Áû
;

51429 i‡(
d⁄e
) {

51430 
	`JS_FªeVÆue
(
˘x
, 
vÆ
);

51433 i‡(
	`JS_Cª©eD©aPr›îtyUöt32
(
˘x
, 
¨r
, 
k
, 
vÆ
, 
JS_PROP_THROW
) < 0)

51434 
Áû
;

51435 
k
++;

51437 
	`JS_FªeVÆue
(
˘x
, 
√xt_mëhod
);

51438 
	`JS_FªeVÆue
(
˘x
, 
ôî
);

51439 *
∂í
 = 
k
;

51440  
¨r
;

51441 
Áû
:

51442 
	`JS_FªeVÆue
(
˘x
, 
√xt_mëhod
);

51443 
	`JS_FªeVÆue
(
˘x
, 
ôî
);

51444 
	`JS_FªeVÆue
(
˘x
, 
¨r
);

51445  
JS_EXCEPTION
;

51446 
	}
}

51448 
JSVÆue
 
	$js_ty≥d_¨øy_c⁄°ru˘‹_obj
(
JSC⁄ãxt
 *
˘x
,

51449 
JSVÆueC⁄°
 
√w_èrgë
,

51450 
JSVÆueC⁄°
 
obj
,

51451 
˛assid
)

51453 
JSVÆue
 
ôî
, 
ªt
, 
¨r
 = 
JS_UNDEFINED
, 
vÆ
, 
buf„r
;

51454 
uöt32_t
 
i
;

51455 
size_log2
;

51456 
söt64_t
 
Àn
;

51458 
size_log2
 = 
	`ty≥d_¨øy_size_log2
(
˛assid
);

51459 
ªt
 = 
	`js_¸óã_‰om_˘‹
(
˘x
, 
√w_èrgë
, 
˛assid
);

51460 i‡(
	`JS_IsEx˚±i⁄
(
ªt
))

51461  
JS_EXCEPTION
;

51463 
ôî
 = 
	`JS_GëPr›îty
(
˘x
, 
obj
, 
JS_ATOM_Symbﬁ_ôî©‹
);

51464 i‡(
	`JS_IsEx˚±i⁄
(
ôî
))

51465 
Áû
;

51466 i‡(!
	`JS_IsUndeföed
(
ôî
Ë&& !
	`JS_IsNuŒ
(iter)) {

51467 
uöt32_t
 
Àn1
;

51468 
¨r
 = 
	`js_¨øy_‰om_ôî©‹
(
˘x
, &
Àn1
, 
obj
, 
ôî
);

51469 
	`JS_FªeVÆue
(
˘x
, 
ôî
);

51470 i‡(
	`JS_IsEx˚±i⁄
(
¨r
))

51471 
Áû
;

51472 
Àn
 = 
Àn1
;

51474 i‡(
	`js_gë_Àngth64
(
˘x
, &
Àn
, 
obj
))

51475 
Áû
;

51476 
¨r
 = 
	`JS_DupVÆue
(
˘x
, 
obj
);

51479 
buf„r
 = 
	`js_¨øy_buf„r_c⁄°ru˘‹1
(
˘x
, 
JS_UNDEFINED
,

51480 
Àn
 << 
size_log2
);

51481 i‡(
	`JS_IsEx˚±i⁄
(
buf„r
))

51482 
Áû
;

51483 i‡(
	`ty≥d_¨øy_öô
(
˘x
, 
ªt
, 
buf„r
, 0, 
Àn
))

51484 
Áû
;

51486 
i
 = 0; i < 
Àn
; i++) {

51487 
vÆ
 = 
	`JS_GëPr›îtyUöt32
(
˘x
, 
¨r
, 
i
);

51488 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

51489 
Áû
;

51490 i‡(
	`JS_SëPr›îtyUöt32
(
˘x
, 
ªt
, 
i
, 
vÆ
) < 0)

51491 
Áû
;

51493 
	`JS_FªeVÆue
(
˘x
, 
¨r
);

51494  
ªt
;

51495 
Áû
:

51496 
	`JS_FªeVÆue
(
˘x
, 
¨r
);

51497 
	`JS_FªeVÆue
(
˘x
, 
ªt
);

51498  
JS_EXCEPTION
;

51499 
	}
}

51501 
JSVÆue
 
	$js_ty≥d_¨øy_c⁄°ru˘‹_è
(
JSC⁄ãxt
 *
˘x
,

51502 
JSVÆueC⁄°
 
√w_èrgë
,

51503 
JSVÆueC⁄°
 
§c_obj
,

51504 
˛assid
)

51506 
JSObje˘
 *
p
, *
§c_buf„r
;

51507 
JSTy≥dAºay
 *
è
;

51508 
JSVÆue
 
˘‹
, 
obj
, 
buf„r
;

51509 
uöt32_t
 
Àn
, 
i
;

51510 
size_log2
;

51511 
JSAºayBuf„r
 *
§c_abuf
, *
abuf
;

51513 
obj
 = 
	`js_¸óã_‰om_˘‹
(
˘x
, 
√w_èrgë
, 
˛assid
);

51514 i‡(
	`JS_IsEx˚±i⁄
(
obj
))

51515  
obj
;

51516 
p
 = 
	`JS_VALUE_GET_OBJ
(
§c_obj
);

51517 i‡(
	`ty≥d_¨øy_is_dëached
(
˘x
, 
p
)) {

51518 
	`JS_ThrowTy≥Eº‹DëachedAºayBuf„r
(
˘x
);

51519 
Áû
;

51521 
è
 = 
p
->
u
.
ty≥d_¨øy
;

51522 
Àn
 = 
p
->
u
.
¨øy
.
cou¡
;

51523 
§c_buf„r
 = 
è
->
buf„r
;

51524 
§c_abuf
 = 
§c_buf„r
->
u
.
¨øy_buf„r
;

51525 i‡(!
§c_abuf
->
sh¨ed
) {

51526 
˘‹
 = 
	`JS_S≥cõsC⁄°ru˘‹
(
˘x
, 
	`JS_MKPTR
(
JS_TAG_OBJECT
, 
§c_buf„r
),

51527 
JS_UNDEFINED
);

51528 i‡(
	`JS_IsEx˚±i⁄
(
˘‹
))

51529 
Áû
;

51532 
˘‹
 = 
JS_UNDEFINED
;

51534 
size_log2
 = 
	`ty≥d_¨øy_size_log2
(
˛assid
);

51535 
buf„r
 = 
	`js_¨øy_buf„r_c⁄°ru˘‹1
(
˘x
, 
˘‹
,

51536 (
uöt64_t
)
Àn
 << 
size_log2
);

51537 
	`JS_FªeVÆue
(
˘x
, 
˘‹
);

51538 i‡(
	`JS_IsEx˚±i⁄
(
buf„r
))

51539 
Áû
;

51541 i‡(
	`ty≥d_¨øy_is_dëached
(
˘x
, 
p
)) {

51542 
	`JS_FªeVÆue
(
˘x
, 
buf„r
);

51543 
	`JS_ThrowTy≥Eº‹DëachedAºayBuf„r
(
˘x
);

51544 
Áû
;

51546 
abuf
 = 
	`JS_GëO∑que
(
buf„r
, 
JS_CLASS_ARRAY_BUFFER
);

51547 i‡(
	`ty≥d_¨øy_öô
(
˘x
, 
obj
, 
buf„r
, 0, 
Àn
))

51548 
Áû
;

51549 i‡(
p
->
˛ass_id
 =
˛assid
) {

51551 
	`mem˝y
(
abuf
->
d©a
, 
§c_abuf
->d©®+ 
è
->
off£t
,ábuf->
byã_Àngth
);

51553 
i
 = 0; i < 
Àn
; i++) {

51554 
JSVÆue
 
vÆ
;

51555 
vÆ
 = 
	`JS_GëPr›îtyUöt32
(
˘x
, 
§c_obj
, 
i
);

51556 i‡(
	`JS_IsEx˚±i⁄
(
vÆ
))

51557 
Áû
;

51558 i‡(
	`JS_SëPr›îtyUöt32
(
˘x
, 
obj
, 
i
, 
vÆ
) < 0)

51559 
Áû
;

51562  
obj
;

51563 
Áû
:

51564 
	`JS_FªeVÆue
(
˘x
, 
obj
);

51565  
JS_EXCEPTION
;

51566 
	}
}

51568 
JSVÆue
 
	$js_ty≥d_¨øy_c⁄°ru˘‹
(
JSC⁄ãxt
 *
˘x
,

51569 
JSVÆueC⁄°
 
√w_èrgë
,

51570 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
,

51571 
˛assid
)

51573 
JSVÆue
 
buf„r
, 
obj
;

51574 
JSAºayBuf„r
 *
abuf
;

51575 
size_log2
;

51576 
uöt64_t
 
Àn
, 
off£t
;

51578 
size_log2
 = 
	`ty≥d_¨øy_size_log2
(
˛assid
);

51579 i‡(
	`JS_VALUE_GET_TAG
(
¨gv
[0]Ë!
JS_TAG_OBJECT
) {

51580 i‡(
	`JS_ToIndex
(
˘x
, &
Àn
, 
¨gv
[0]))

51581  
JS_EXCEPTION
;

51582 
buf„r
 = 
	`js_¨øy_buf„r_c⁄°ru˘‹1
(
˘x
, 
JS_UNDEFINED
,

51583 
Àn
 << 
size_log2
);

51584 i‡(
	`JS_IsEx˚±i⁄
(
buf„r
))

51585  
JS_EXCEPTION
;

51586 
off£t
 = 0;

51588 
JSObje˘
 *
p
 = 
	`JS_VALUE_GET_OBJ
(
¨gv
[0]);

51589 i‡(
p
->
˛ass_id
 =
JS_CLASS_ARRAY_BUFFER
 ||

51590 
p
->
˛ass_id
 =
JS_CLASS_SHARED_ARRAY_BUFFER
) {

51591 
abuf
 = 
p
->
u
.
¨øy_buf„r
;

51592 i‡(
	`JS_ToIndex
(
˘x
, &
off£t
, 
¨gv
[1]))

51593  
JS_EXCEPTION
;

51594 i‡(
abuf
->
dëached
)

51595  
	`JS_ThrowTy≥Eº‹DëachedAºayBuf„r
(
˘x
);

51596 i‡((
off£t
 & ((1 << 
size_log2
) - 1)) != 0 ||

51597 
off£t
 > 
abuf
->
byã_Àngth
)

51598  
	`JS_ThrowR™geEº‹
(
˘x
, "invalid offset");

51599 i‡(
	`JS_IsUndeföed
(
¨gv
[2])) {

51600 i‡((
abuf
->
byã_Àngth
 & ((1 << 
size_log2
) - 1)) != 0)

51601 
övÆid_Àngth
;

51602 
Àn
 = (
abuf
->
byã_Àngth
 - 
off£t
Ë>> 
size_log2
;

51604 i‡(
	`JS_ToIndex
(
˘x
, &
Àn
, 
¨gv
[2]))

51605  
JS_EXCEPTION
;

51606 i‡(
abuf
->
dëached
)

51607  
	`JS_ThrowTy≥Eº‹DëachedAºayBuf„r
(
˘x
);

51608 i‡((
off£t
 + (
Àn
 << 
size_log2
)Ë> 
abuf
->
byã_Àngth
) {

51609 
övÆid_Àngth
:

51610  
	`JS_ThrowR™geEº‹
(
˘x
, "invalidÜength");

51613 
buf„r
 = 
	`JS_DupVÆue
(
˘x
, 
¨gv
[0]);

51615 i‡(
p
->
˛ass_id
 >
JS_CLASS_UINT8C_ARRAY
 &&

51616 
p
->
˛ass_id
 <
JS_CLASS_FLOAT64_ARRAY
) {

51617  
	`js_ty≥d_¨øy_c⁄°ru˘‹_è
(
˘x
, 
√w_èrgë
, 
¨gv
[0], 
˛assid
);

51619  
	`js_ty≥d_¨øy_c⁄°ru˘‹_obj
(
˘x
, 
√w_èrgë
, 
¨gv
[0], 
˛assid
);

51624 
obj
 = 
	`js_¸óã_‰om_˘‹
(
˘x
, 
√w_èrgë
, 
˛assid
);

51625 i‡(
	`JS_IsEx˚±i⁄
(
obj
)) {

51626 
	`JS_FªeVÆue
(
˘x
, 
buf„r
);

51627  
JS_EXCEPTION
;

51629 i‡(
	`ty≥d_¨øy_öô
(
˘x
, 
obj
, 
buf„r
, 
off£t
, 
Àn
)) {

51630 
	`JS_FªeVÆue
(
˘x
, 
obj
);

51631  
JS_EXCEPTION
;

51633  
obj
;

51634 
	}
}

51636 
	$js_ty≥d_¨øy_föÆizî
(
JSRu¡ime
 *
π
, 
JSVÆue
 
vÆ
)

51638 
JSObje˘
 *
p
 = 
	`JS_VALUE_GET_OBJ
(
vÆ
);

51639 
JSTy≥dAºay
 *
è
 = 
p
->
u
.
ty≥d_¨øy
;

51640 i‡(
è
) {

51643 i‡(
	`JS_IsLiveObje˘
(
π
, 
	`JS_MKPTR
(
JS_TAG_OBJECT
, 
è
->
buf„r
))) {

51644 
	`li°_dñ
(&
è
->
lök
);

51646 
	`JS_FªeVÆueRT
(
π
, 
	`JS_MKPTR
(
JS_TAG_OBJECT
, 
è
->
buf„r
));

51647 
	`js_‰ì_π
(
π
, 
è
);

51649 
	}
}

51651 
	$js_ty≥d_¨øy_m¨k
(
JSRu¡ime
 *
π
, 
JSVÆueC⁄°
 
vÆ
,

51652 
JS_M¨kFunc
 *
m¨k_func
)

51654 
JSObje˘
 *
p
 = 
	`JS_VALUE_GET_OBJ
(
vÆ
);

51655 
JSTy≥dAºay
 *
è
 = 
p
->
u
.
ty≥d_¨øy
;

51656 i‡(
è
) {

51657 
	`JS_M¨kVÆue
(
π
, 
	`JS_MKPTR
(
JS_TAG_OBJECT
, 
è
->
buf„r
), 
m¨k_func
);

51659 
	}
}

51661 
JSVÆue
 
	$js_d©avõw_c⁄°ru˘‹
(
JSC⁄ãxt
 *
˘x
,

51662 
JSVÆueC⁄°
 
√w_èrgë
,

51663 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

51665 
JSAºayBuf„r
 *
abuf
;

51666 
uöt64_t
 
off£t
;

51667 
uöt32_t
 
Àn
;

51668 
JSVÆueC⁄°
 
buf„r
;

51669 
JSVÆue
 
obj
;

51670 
JSTy≥dAºay
 *
è
;

51671 
JSObje˘
 *
p
;

51673 
buf„r
 = 
¨gv
[0];

51674 
abuf
 = 
	`js_gë_¨øy_buf„r
(
˘x
, 
buf„r
);

51675 i‡(!
abuf
)

51676  
JS_EXCEPTION
;

51677 
off£t
 = 0;

51678 i‡(
¨gc
 > 1) {

51679 i‡(
	`JS_ToIndex
(
˘x
, &
off£t
, 
¨gv
[1]))

51680  
JS_EXCEPTION
;

51682 i‡(
abuf
->
dëached
)

51683  
	`JS_ThrowTy≥Eº‹DëachedAºayBuf„r
(
˘x
);

51684 i‡(
off£t
 > 
abuf
->
byã_Àngth
)

51685  
	`JS_ThrowR™geEº‹
(
˘x
, "invalid byteOffset");

51686 
Àn
 = 
abuf
->
byã_Àngth
 - 
off£t
;

51687 i‡(
¨gc
 > 2 && !
	`JS_IsUndeföed
(
¨gv
[2])) {

51688 
uöt64_t
 
l
;

51689 i‡(
	`JS_ToIndex
(
˘x
, &
l
, 
¨gv
[2]))

51690  
JS_EXCEPTION
;

51691 i‡(
l
 > 
Àn
)

51692  
	`JS_ThrowR™geEº‹
(
˘x
, "invalid byteLength");

51693 
Àn
 = 
l
;

51696 
obj
 = 
	`js_¸óã_‰om_˘‹
(
˘x
, 
√w_èrgë
, 
JS_CLASS_DATAVIEW
);

51697 i‡(
	`JS_IsEx˚±i⁄
(
obj
))

51698  
JS_EXCEPTION
;

51699 i‡(
abuf
->
dëached
) {

51701 
	`JS_ThrowTy≥Eº‹DëachedAºayBuf„r
(
˘x
);

51702 
Áû
;

51704 
è
 = 
	`js_mÆloc
(
˘x
, (*ta));

51705 i‡(!
è
) {

51706 
Áû
:

51707 
	`JS_FªeVÆue
(
˘x
, 
obj
);

51708  
JS_EXCEPTION
;

51710 
p
 = 
	`JS_VALUE_GET_OBJ
(
obj
);

51711 
è
->
obj
 = 
p
;

51712 
è
->
buf„r
 = 
	`JS_VALUE_GET_OBJ
(
	`JS_DupVÆue
(
˘x
, buffer));

51713 
è
->
off£t
 = offset;

51714 
è
->
Àngth
 = 
Àn
;

51715 
	`li°_add_èû
(&
è
->
lök
, &
abuf
->
¨øy_li°
);

51716 
p
->
u
.
ty≥d_¨øy
 = 
è
;

51717  
obj
;

51718 
	}
}

51720 
JSVÆue
 
	$js_d©avõw_gëVÆue
(
JSC⁄ãxt
 *
˘x
,

51721 
JSVÆueC⁄°
 
this_obj
,

51722 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
, 
˛ass_id
)

51724 
JSTy≥dAºay
 *
è
;

51725 
JSAºayBuf„r
 *
abuf
;

51726 
is_sw≠
, 
size
;

51727 
uöt8_t
 *
±r
;

51728 
uöt32_t
 
v
;

51729 
uöt64_t
 
pos
;

51731 
è
 = 
	`JS_GëO∑que2
(
˘x
, 
this_obj
, 
JS_CLASS_DATAVIEW
);

51732 i‡(!
è
)

51733  
JS_EXCEPTION
;

51734 
size
 = 1 << 
	`ty≥d_¨øy_size_log2
(
˛ass_id
);

51735 i‡(
	`JS_ToIndex
(
˘x
, &
pos
, 
¨gv
[0]))

51736  
JS_EXCEPTION
;

51737 
is_sw≠
 = 
FALSE
;

51738 i‡(
¨gc
 > 1)

51739 
is_sw≠
 = 
	`JS_ToBoﬁ
(
˘x
, 
¨gv
[1]);

51740 #i‚de‡
WORDS_BIGENDIAN


51741 
is_sw≠
 ^= 1;

51743 
abuf
 = 
è
->
buf„r
->
u
.
¨øy_buf„r
;

51744 i‡(
abuf
->
dëached
)

51745  
	`JS_ThrowTy≥Eº‹DëachedAºayBuf„r
(
˘x
);

51746 i‡((
pos
 + 
size
Ë> 
è
->
Àngth
)

51747  
	`JS_ThrowR™geEº‹
(
˘x
, "out of bound");

51748 
±r
 = 
abuf
->
d©a
 + 
è
->
off£t
 + 
pos
;

51750 
˛ass_id
) {

51751 
JS_CLASS_INT8_ARRAY
:

51752  
	`JS_NewI¡32
(
˘x
, *(
öt8_t
 *)
±r
);

51753 
JS_CLASS_UINT8_ARRAY
:

51754  
	`JS_NewI¡32
(
˘x
, *(
uöt8_t
 *)
±r
);

51755 
JS_CLASS_INT16_ARRAY
:

51756 
v
 = 
	`gë_u16
(
±r
);

51757 i‡(
is_sw≠
)

51758 
v
 = 
	`bsw≠16
(v);

51759  
	`JS_NewI¡32
(
˘x
, (
öt16_t
)
v
);

51760 
JS_CLASS_UINT16_ARRAY
:

51761 
v
 = 
	`gë_u16
(
±r
);

51762 i‡(
is_sw≠
)

51763 
v
 = 
	`bsw≠16
(v);

51764  
	`JS_NewI¡32
(
˘x
, 
v
);

51765 
JS_CLASS_INT32_ARRAY
:

51766 
v
 = 
	`gë_u32
(
±r
);

51767 i‡(
is_sw≠
)

51768 
v
 = 
	`bsw≠32
(v);

51769  
	`JS_NewI¡32
(
˘x
, 
v
);

51770 
JS_CLASS_UINT32_ARRAY
:

51771 
v
 = 
	`gë_u32
(
±r
);

51772 i‡(
is_sw≠
)

51773 
v
 = 
	`bsw≠32
(v);

51774  
	`JS_NewUöt32
(
˘x
, 
v
);

51775 #ifde‡
CONFIG_BIGNUM


51776 
JS_CLASS_BIG_INT64_ARRAY
:

51778 
uöt64_t
 
v
;

51779 
v
 = 
	`gë_u64
(
±r
);

51780 i‡(
is_sw≠
)

51781 
v
 = 
	`bsw≠64
(v);

51782  
	`JS_NewBigI¡64
(
˘x
, 
v
);

51785 
JS_CLASS_BIG_UINT64_ARRAY
:

51787 
uöt64_t
 
v
;

51788 
v
 = 
	`gë_u64
(
±r
);

51789 i‡(
is_sw≠
)

51790 
v
 = 
	`bsw≠64
(v);

51791  
	`JS_NewBigUöt64
(
˘x
, 
v
);

51795 
JS_CLASS_FLOAT32_ARRAY
:

51798 
f
;

51799 
uöt32_t
 
i
;

51800 } 
u
;

51801 
v
 = 
	`gë_u32
(
±r
);

51802 i‡(
is_sw≠
)

51803 
v
 = 
	`bsw≠32
(v);

51804 
u
.
i
 = 
v
;

51805  
	`__JS_NewFlﬂt64
(
˘x
, 
u
.
f
);

51807 
JS_CLASS_FLOAT64_ARRAY
:

51810 
f
;

51811 
uöt64_t
 
i
;

51812 } 
u
;

51813 
u
.
i
 = 
	`gë_u64
(
±r
);

51814 i‡(
is_sw≠
)

51815 
u
.
i
 = 
	`bsw≠64
(u.i);

51816  
	`__JS_NewFlﬂt64
(
˘x
, 
u
.
f
);

51819 
	`ab‹t
();

51821 
	}
}

51823 
JSVÆue
 
	$js_d©avõw_£tVÆue
(
JSC⁄ãxt
 *
˘x
,

51824 
JSVÆueC⁄°
 
this_obj
,

51825 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
, 
˛ass_id
)

51827 
JSTy≥dAºay
 *
è
;

51828 
JSAºayBuf„r
 *
abuf
;

51829 
is_sw≠
, 
size
;

51830 
uöt8_t
 *
±r
;

51831 
uöt64_t
 
v64
;

51832 
uöt32_t
 
v
;

51833 
uöt64_t
 
pos
;

51834 
JSVÆueC⁄°
 
vÆ
;

51836 
è
 = 
	`JS_GëO∑que2
(
˘x
, 
this_obj
, 
JS_CLASS_DATAVIEW
);

51837 i‡(!
è
)

51838  
JS_EXCEPTION
;

51839 
size
 = 1 << 
	`ty≥d_¨øy_size_log2
(
˛ass_id
);

51840 i‡(
	`JS_ToIndex
(
˘x
, &
pos
, 
¨gv
[0]))

51841  
JS_EXCEPTION
;

51842 
vÆ
 = 
¨gv
[1];

51843 
v
 = 0;

51844 
v64
 = 0;

51845 i‡(
˛ass_id
 <
JS_CLASS_UINT32_ARRAY
) {

51846 i‡(
	`JS_ToUöt32
(
˘x
, &
v
, 
vÆ
))

51847  
JS_EXCEPTION
;

51849 #ifde‡
CONFIG_BIGNUM


51850 i‡(
˛ass_id
 <
JS_CLASS_BIG_UINT64_ARRAY
) {

51851 i‡(
	`JS_ToBigI¡64
(
˘x
, (
öt64_t
 *)&
v64
, 
vÆ
))

51852  
JS_EXCEPTION
;

51856 
d
;

51857 i‡(
	`JS_ToFlﬂt64
(
˘x
, &
d
, 
vÆ
))

51858  
JS_EXCEPTION
;

51859 i‡(
˛ass_id
 =
JS_CLASS_FLOAT32_ARRAY
) {

51861 
f
;

51862 
uöt32_t
 
i
;

51863 } 
u
;

51864 
u
.
f
 = 
d
;

51865 
v
 = 
u
.
i
;

51867 
JSFlﬂt64Uni⁄
 
u
;

51868 
u
.
d
 = d;

51869 
v64
 = 
u
.
u64
;

51872 
is_sw≠
 = 
FALSE
;

51873 i‡(
¨gc
 > 2)

51874 
is_sw≠
 = 
	`JS_ToBoﬁ
(
˘x
, 
¨gv
[2]);

51875 #i‚de‡
WORDS_BIGENDIAN


51876 
is_sw≠
 ^= 1;

51878 
abuf
 = 
è
->
buf„r
->
u
.
¨øy_buf„r
;

51879 i‡(
abuf
->
dëached
)

51880  
	`JS_ThrowTy≥Eº‹DëachedAºayBuf„r
(
˘x
);

51881 i‡((
pos
 + 
size
Ë> 
è
->
Àngth
)

51882  
	`JS_ThrowR™geEº‹
(
˘x
, "out of bound");

51883 
±r
 = 
abuf
->
d©a
 + 
è
->
off£t
 + 
pos
;

51885 
˛ass_id
) {

51886 
JS_CLASS_INT8_ARRAY
:

51887 
JS_CLASS_UINT8_ARRAY
:

51888 *
±r
 = 
v
;

51890 
JS_CLASS_INT16_ARRAY
:

51891 
JS_CLASS_UINT16_ARRAY
:

51892 i‡(
is_sw≠
)

51893 
v
 = 
	`bsw≠16
(v);

51894 
	`put_u16
(
±r
, 
v
);

51896 
JS_CLASS_INT32_ARRAY
:

51897 
JS_CLASS_UINT32_ARRAY
:

51898 
JS_CLASS_FLOAT32_ARRAY
:

51899 i‡(
is_sw≠
)

51900 
v
 = 
	`bsw≠32
(v);

51901 
	`put_u32
(
±r
, 
v
);

51903 #ifde‡
CONFIG_BIGNUM


51904 
JS_CLASS_BIG_INT64_ARRAY
:

51905 
JS_CLASS_BIG_UINT64_ARRAY
:

51907 
JS_CLASS_FLOAT64_ARRAY
:

51908 i‡(
is_sw≠
)

51909 
v64
 = 
	`bsw≠64
(v64);

51910 
	`put_u64
(
±r
, 
v64
);

51913 
	`ab‹t
();

51915  
JS_UNDEFINED
;

51916 
	}
}

51918 c⁄° 
JSCFun˘i⁄Li°E¡ry
 
	gjs_d©avõw_¥Ÿo_funcs
[] = {

51919 
JS_CGETSET_MAGIC_DEF
("buf„r", 
js_ty≥d_¨øy_gë_buf„r
, 
NULL
, 1 ),

51920 
JS_CGETSET_MAGIC_DEF
("byãLígth", 
js_ty≥d_¨øy_gë_byãLígth
, 
NULL
, 1 ),

51921 
JS_CGETSET_MAGIC_DEF
("byãOff£t", 
js_ty≥d_¨øy_gë_byãOff£t
, 
NULL
, 1 ),

51922 
JS_CFUNC_MAGIC_DEF
("gëI¡8", 1, 
js_d©avõw_gëVÆue
, 
JS_CLASS_INT8_ARRAY
 ),

51923 
JS_CFUNC_MAGIC_DEF
("gëUöt8", 1, 
js_d©avõw_gëVÆue
, 
JS_CLASS_UINT8_ARRAY
 ),

51924 
JS_CFUNC_MAGIC_DEF
("gëI¡16", 1, 
js_d©avõw_gëVÆue
, 
JS_CLASS_INT16_ARRAY
 ),

51925 
JS_CFUNC_MAGIC_DEF
("gëUöt16", 1, 
js_d©avõw_gëVÆue
, 
JS_CLASS_UINT16_ARRAY
 ),

51926 
JS_CFUNC_MAGIC_DEF
("gëI¡32", 1, 
js_d©avõw_gëVÆue
, 
JS_CLASS_INT32_ARRAY
 ),

51927 
JS_CFUNC_MAGIC_DEF
("gëUöt32", 1, 
js_d©avõw_gëVÆue
, 
JS_CLASS_UINT32_ARRAY
 ),

51928 #ifde‡
CONFIG_BIGNUM


51929 
JS_CFUNC_MAGIC_DEF
("gëBigI¡64", 1, 
js_d©avõw_gëVÆue
, 
JS_CLASS_BIG_INT64_ARRAY
 ),

51930 
JS_CFUNC_MAGIC_DEF
("gëBigUöt64", 1, 
js_d©avõw_gëVÆue
, 
JS_CLASS_BIG_UINT64_ARRAY
 ),

51932 
JS_CFUNC_MAGIC_DEF
("gëFlﬂt32", 1, 
js_d©avõw_gëVÆue
, 
JS_CLASS_FLOAT32_ARRAY
 ),

51933 
JS_CFUNC_MAGIC_DEF
("gëFlﬂt64", 1, 
js_d©avõw_gëVÆue
, 
JS_CLASS_FLOAT64_ARRAY
 ),

51934 
JS_CFUNC_MAGIC_DEF
("£tI¡8", 2, 
js_d©avõw_£tVÆue
, 
JS_CLASS_INT8_ARRAY
 ),

51935 
JS_CFUNC_MAGIC_DEF
("£tUöt8", 2, 
js_d©avõw_£tVÆue
, 
JS_CLASS_UINT8_ARRAY
 ),

51936 
JS_CFUNC_MAGIC_DEF
("£tI¡16", 2, 
js_d©avõw_£tVÆue
, 
JS_CLASS_INT16_ARRAY
 ),

51937 
JS_CFUNC_MAGIC_DEF
("£tUöt16", 2, 
js_d©avõw_£tVÆue
, 
JS_CLASS_UINT16_ARRAY
 ),

51938 
JS_CFUNC_MAGIC_DEF
("£tI¡32", 2, 
js_d©avõw_£tVÆue
, 
JS_CLASS_INT32_ARRAY
 ),

51939 
JS_CFUNC_MAGIC_DEF
("£tUöt32", 2, 
js_d©avõw_£tVÆue
, 
JS_CLASS_UINT32_ARRAY
 ),

51940 #ifde‡
CONFIG_BIGNUM


51941 
JS_CFUNC_MAGIC_DEF
("£tBigI¡64", 2, 
js_d©avõw_£tVÆue
, 
JS_CLASS_BIG_INT64_ARRAY
 ),

51942 
JS_CFUNC_MAGIC_DEF
("£tBigUöt64", 2, 
js_d©avõw_£tVÆue
, 
JS_CLASS_BIG_UINT64_ARRAY
 ),

51944 
JS_CFUNC_MAGIC_DEF
("£tFlﬂt32", 2, 
js_d©avõw_£tVÆue
, 
JS_CLASS_FLOAT32_ARRAY
 ),

51945 
JS_CFUNC_MAGIC_DEF
("£tFlﬂt64", 2, 
js_d©avõw_£tVÆue
, 
JS_CLASS_FLOAT64_ARRAY
 ),

51946 
JS_PROP_STRING_DEF
("[Symbﬁ.toSåögTag]", "D©aVõw", 
JS_PROP_CONFIGURABLE
 ),

51950 #ifde‡
CONFIG_ATOMICS


51952 
	eAtomicsOpEnum
 {

51953 
	mATOMICS_OP_ADD
,

51954 
	mATOMICS_OP_AND
,

51955 
	mATOMICS_OP_OR
,

51956 
	mATOMICS_OP_SUB
,

51957 
	mATOMICS_OP_XOR
,

51958 
	mATOMICS_OP_EXCHANGE
,

51959 
	mATOMICS_OP_COMPARE_EXCHANGE
,

51960 
	mATOMICS_OP_LOAD
,

51961 } 
	tAtomicsOpEnum
;

51963 *
	$js_©omics_gë_±r
(
JSC⁄ãxt
 *
˘x
,

51964 *
psize_log2
, 
JSCœssID
 *
p˛ass_id
,

51965 
JSVÆueC⁄°
 
obj
, JSVÆueC⁄° 
idx_vÆ
,

51966 
BOOL
 
is_waôabÀ
)

51968 
JSObje˘
 *
p
;

51969 
JSTy≥dAºay
 *
è
;

51970 
JSAºayBuf„r
 *
abuf
;

51971 *
±r
;

51972 
uöt64_t
 
idx
;

51973 
BOOL
 
îr
;

51974 
size_log2
;

51976 i‡(
	`JS_VALUE_GET_TAG
(
obj
Ë!
JS_TAG_OBJECT
)

51977 
Áû
;

51978 
p
 = 
	`JS_VALUE_GET_OBJ
(
obj
);

51979 #ifde‡
CONFIG_BIGNUM


51980 i‡(
is_waôabÀ
)

51981 
îr
 = (
p
->
˛ass_id
 !
JS_CLASS_INT32_ARRAY
 &&

51982 
p
->
˛ass_id
 !
JS_CLASS_BIG_INT64_ARRAY
);

51984 
îr
 = !(
p
->
˛ass_id
 >
JS_CLASS_INT8_ARRAY
 &&

51985 
p
->
˛ass_id
 <
JS_CLASS_BIG_UINT64_ARRAY
);

51987 i‡(
is_waôabÀ
)

51988 
îr
 = (
p
->
˛ass_id
 !
JS_CLASS_INT32_ARRAY
);

51990 
îr
 = !(
p
->
˛ass_id
 >
JS_CLASS_INT8_ARRAY
 &&

51991 
p
->
˛ass_id
 <
JS_CLASS_UINT32_ARRAY
);

51993 i‡(
îr
) {

51994 
Áû
:

51995 
	`JS_ThrowTy≥Eº‹
(
˘x
, "integer TypedArrayÉxpected");

51996  
NULL
;

51998 
è
 = 
p
->
u
.
ty≥d_¨øy
;

51999 
abuf
 = 
è
->
buf„r
->
u
.
¨øy_buf„r
;

52000 i‡(!
abuf
->
sh¨ed
) {

52001 
	`JS_ThrowTy≥Eº‹
(
˘x
, "notá SharedArrayBuffer TypedArray");

52002  
NULL
;

52004 i‡(
	`JS_ToIndex
(
˘x
, &
idx
, 
idx_vÆ
)) {

52005  
NULL
;

52007 i‡(
idx
 >
p
->
u
.
¨øy
.
cou¡
) {

52008 
	`JS_ThrowR™geEº‹
(
˘x
, "out-of-boundáccess");

52009  
NULL
;

52011 
size_log2
 = 
	`ty≥d_¨øy_size_log2
(
p
->
˛ass_id
);

52012 
±r
 = 
p
->
u
.
¨øy
.u.
uöt8_±r
 + ((
uöçå_t
)
idx
 << 
size_log2
);

52013 i‡(
psize_log2
)

52014 *
psize_log2
 = 
size_log2
;

52015 i‡(
p˛ass_id
)

52016 *
p˛ass_id
 = 
p
->
˛ass_id
;

52017  
±r
;

52018 
	}
}

52020 
JSVÆue
 
	$js_©omics_›
(
JSC⁄ãxt
 *
˘x
,

52021 
JSVÆueC⁄°
 
this_obj
,

52022 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
, 
›
)

52024 
size_log2
;

52025 #ifde‡
CONFIG_BIGNUM


52026 
uöt64_t
 
v
, 
a
, 
ªp_vÆ
;

52028 
uöt32_t
 
v
, 
a
, 
ªp_vÆ
;

52030 *
±r
;

52031 
JSVÆue
 
ªt
;

52032 
JSCœssID
 
˛ass_id
;

52034 
±r
 = 
	`js_©omics_gë_±r
(
˘x
, &
size_log2
, &
˛ass_id
,

52035 
¨gv
[0],árgv[1], 
FALSE
);

52036 i‡(!
±r
)

52037  
JS_EXCEPTION
;

52038 
ªp_vÆ
 = 0;

52039 i‡(
›
 =
ATOMICS_OP_LOAD
) {

52040 
v
 = 0;

52042 #ifde‡
CONFIG_BIGNUM


52043 i‡(
size_log2
 == 3) {

52044 
öt64_t
 
v64
;

52045 i‡(
	`JS_ToBigI¡64
(
˘x
, &
v64
, 
¨gv
[2]))

52046  
JS_EXCEPTION
;

52047 
v
 = 
v64
;

52048 i‡(
›
 =
ATOMICS_OP_COMPARE_EXCHANGE
) {

52049 i‡(
	`JS_ToBigI¡64
(
˘x
, &
v64
, 
¨gv
[3]))

52050  
JS_EXCEPTION
;

52051 
ªp_vÆ
 = 
v64
;

52056 
uöt32_t
 
v32
;

52057 i‡(
	`JS_ToUöt32
(
˘x
, &
v32
, 
¨gv
[2]))

52058  
JS_EXCEPTION
;

52059 
v
 = 
v32
;

52060 i‡(
›
 =
ATOMICS_OP_COMPARE_EXCHANGE
) {

52061 i‡(
	`JS_ToUöt32
(
˘x
, &
v32
, 
¨gv
[3]))

52062  
JS_EXCEPTION
;

52063 
ªp_vÆ
 = 
v32
;

52066 
›
 | (
size_log2
 << 3)) {

52068 #ifde‡
CONFIG_BIGNUM


52069 
	#OP
(
›_«me
, 
func_«me
) \

52070 
ATOMICS_OP_
 ## 
›_«me
 | (0 << 3): \

52071 
a
 = 
	`func_«me
((
	`_Atomic
(
uöt8_t
Ë*)
±r
, 
v
); \

52073 
ATOMICS_OP_
 ## 
›_«me
 | (1 << 3): \

52074 
a
 = 
	`func_«me
((
	`_Atomic
(
uöt16_t
Ë*)
±r
, 
v
); \

52076 
ATOMICS_OP_
 ## 
›_«me
 | (2 << 3): \

52077 
a
 = 
	`func_«me
((
	`_Atomic
(
uöt32_t
Ë*)
±r
, 
v
); \

52079 
ATOMICS_OP_
 ## 
›_«me
 | (3 << 3): \

52080 
a
 = 
	`func_«me
((
	`_Atomic
(
uöt64_t
Ë*)
±r
, 
v
); \

52081 ;

	)

52083 
	#OP
(
›_«me
, 
func_«me
) \

52084 
ATOMICS_OP_
 ## 
›_«me
 | (0 << 3): \

52085 
a
 = 
	`func_«me
((
	`_Atomic
(
uöt8_t
Ë*)
±r
, 
v
); \

52087 
ATOMICS_OP_
 ## 
›_«me
 | (1 << 3): \

52088 
a
 = 
	`func_«me
((
	`_Atomic
(
uöt16_t
Ë*)
±r
, 
v
); \

52090 
ATOMICS_OP_
 ## 
›_«me
 | (2 << 3): \

52091 
a
 = 
	`func_«me
((
	`_Atomic
(
uöt32_t
Ë*)
±r
, 
v
); \

52092 ;

	)

52094 
	`OP
(
ADD
, 
©omic_„tch_add
)

52095 
	`OP
(
AND
, 
©omic_„tch_™d
)

52096 
	`OP
(
OR
, 
©omic_„tch_‹
)

52097 
	`OP
(
SUB
, 
©omic_„tch_sub
)

52098 
	`OP
(
XOR
, 
©omic_„tch_x‹
)

52099 
	`OP
(
EXCHANGE
, 
©omic_exch™ge
)

52100 #unde‡
OP


52102 
ATOMICS_OP_LOAD
 | (0 << 3):

52103 
a
 = 
	`©omic_lﬂd
((
	`_Atomic
(
uöt8_t
Ë*)
±r
);

52105 
ATOMICS_OP_LOAD
 | (1 << 3):

52106 
a
 = 
	`©omic_lﬂd
((
	`_Atomic
(
uöt16_t
Ë*)
±r
);

52108 
ATOMICS_OP_LOAD
 | (2 << 3):

52109 
a
 = 
	`©omic_lﬂd
((
	`_Atomic
(
uöt32_t
Ë*)
±r
);

52111 #ifde‡
CONFIG_BIGNUM


52112 
ATOMICS_OP_LOAD
 | (3 << 3):

52113 
a
 = 
	`©omic_lﬂd
((
	`_Atomic
(
uöt64_t
Ë*)
±r
);

52117 
ATOMICS_OP_COMPARE_EXCHANGE
 | (0 << 3):

52119 
uöt8_t
 
v1
 = 
v
;

52120 
	`©omic_com∑ª_exch™ge_°r⁄g
((
	`_Atomic
(
uöt8_t
Ë*)
±r
, &
v1
, 
ªp_vÆ
);

52121 
a
 = 
v1
;

52124 
ATOMICS_OP_COMPARE_EXCHANGE
 | (1 << 3):

52126 
uöt16_t
 
v1
 = 
v
;

52127 
	`©omic_com∑ª_exch™ge_°r⁄g
((
	`_Atomic
(
uöt16_t
Ë*)
±r
, &
v1
, 
ªp_vÆ
);

52128 
a
 = 
v1
;

52131 
ATOMICS_OP_COMPARE_EXCHANGE
 | (2 << 3):

52133 
uöt32_t
 
v1
 = 
v
;

52134 
	`©omic_com∑ª_exch™ge_°r⁄g
((
	`_Atomic
(
uöt32_t
Ë*)
±r
, &
v1
, 
ªp_vÆ
);

52135 
a
 = 
v1
;

52138 #ifde‡
CONFIG_BIGNUM


52139 
ATOMICS_OP_COMPARE_EXCHANGE
 | (3 << 3):

52141 
uöt64_t
 
v1
 = 
v
;

52142 
	`©omic_com∑ª_exch™ge_°r⁄g
((
	`_Atomic
(
uöt64_t
Ë*)
±r
, &
v1
, 
ªp_vÆ
);

52143 
a
 = 
v1
;

52148 
	`ab‹t
();

52151 
˛ass_id
) {

52152 
JS_CLASS_INT8_ARRAY
:

52153 
a
 = (
öt8_t
)a;

52154 
d⁄e
;

52155 
JS_CLASS_UINT8_ARRAY
:

52156 
a
 = (
uöt8_t
)a;

52157 
d⁄e
;

52158 
JS_CLASS_INT16_ARRAY
:

52159 
a
 = (
öt16_t
)a;

52160 
d⁄e
;

52161 
JS_CLASS_UINT16_ARRAY
:

52162 
a
 = (
uöt16_t
)a;

52163 
d⁄e
;

52164 
JS_CLASS_INT32_ARRAY
:

52165 
d⁄e
:

52166 
ªt
 = 
	`JS_NewI¡32
(
˘x
, 
a
);

52168 
JS_CLASS_UINT32_ARRAY
:

52169 
ªt
 = 
	`JS_NewUöt32
(
˘x
, 
a
);

52171 #ifde‡
CONFIG_BIGNUM


52172 
JS_CLASS_BIG_INT64_ARRAY
:

52173 
ªt
 = 
	`JS_NewBigI¡64
(
˘x
, 
a
);

52175 
JS_CLASS_BIG_UINT64_ARRAY
:

52176 
ªt
 = 
	`JS_NewBigUöt64
(
˘x
, 
a
);

52180 
	`ab‹t
();

52182  
ªt
;

52183 
	}
}

52185 
JSVÆue
 
	$js_©omics_°‹e
(
JSC⁄ãxt
 *
˘x
,

52186 
JSVÆueC⁄°
 
this_obj
,

52187 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

52189 
size_log2
;

52190 *
±r
;

52191 
JSVÆue
 
ªt
;

52193 
±r
 = 
	`js_©omics_gë_±r
(
˘x
, &
size_log2
, 
NULL
, 
¨gv
[0],árgv[1], 
FALSE
);

52194 i‡(!
±r
)

52195  
JS_EXCEPTION
;

52196 #ifde‡
CONFIG_BIGNUM


52197 i‡(
size_log2
 == 3) {

52198 
öt64_t
 
v64
;

52199 
ªt
 = 
	`JS_ToBigI¡VÆueFªe
(
˘x
, 
	`JS_DupVÆue
(˘x, 
¨gv
[2]));

52200 i‡(
	`JS_IsEx˚±i⁄
(
ªt
))

52201  
ªt
;

52202 i‡(
	`JS_ToBigI¡64
(
˘x
, &
v64
, 
ªt
)) {

52203 
	`JS_FªeVÆue
(
˘x
, 
ªt
);

52204  
JS_EXCEPTION
;

52206 
	`©omic_°‹e
((
	`_Atomic
(
uöt64_t
Ë*)
±r
, 
v64
);

52210 
uöt32_t
 
v
;

52212 
ªt
 = 
	`JS_ToI¡egîFªe
(
˘x
, 
	`JS_DupVÆue
(˘x, 
¨gv
[2]));

52213 i‡(
	`JS_IsEx˚±i⁄
(
ªt
))

52214  
ªt
;

52215 i‡(
	`JS_ToUöt32
(
˘x
, &
v
, 
ªt
)) {

52216 
	`JS_FªeVÆue
(
˘x
, 
ªt
);

52217  
JS_EXCEPTION
;

52219 
size_log2
) {

52221 
	`©omic_°‹e
((
	`_Atomic
(
uöt8_t
Ë*)
±r
, 
v
);

52224 
	`©omic_°‹e
((
	`_Atomic
(
uöt16_t
Ë*)
±r
, 
v
);

52227 
	`©omic_°‹e
((
	`_Atomic
(
uöt32_t
Ë*)
±r
, 
v
);

52230 
	`ab‹t
();

52233  
ªt
;

52234 
	}
}

52236 
JSVÆue
 
	$js_©omics_isLockFªe
(
JSC⁄ãxt
 *
˘x
,

52237 
JSVÆueC⁄°
 
this_obj
,

52238 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

52240 
v
, 
ªt
;

52241 i‡(
	`JS_ToI¡32S©
(
˘x
, &
v
, 
¨gv
[0]))

52242  
JS_EXCEPTION
;

52243 
ªt
 = (
v
 == 1 || v == 2 || v == 4

52244 #ifde‡
CONFIG_BIGNUM


52245 || 
v
 == 8

52248  
	`JS_NewBoﬁ
(
˘x
, 
ªt
);

52249 
	}
}

52251 
	sJSAtomicsWaôî
 {

52252 
li°_hód
 
	mlök
;

52253 
BOOL
 
	mlöked
;

52254 
±hªad_c⁄d_t
 
	mc⁄d
;

52255 
öt32_t
 *
	m±r
;

52256 } 
	tJSAtomicsWaôî
;

52258 
±hªad_muãx_t
 
	gjs_©omics_muãx
 = 
PTHREAD_MUTEX_INITIALIZER
;

52259 
li°_hód
 
	gjs_©omics_waôî_li°
 =

52260 
LIST_HEAD_INIT
(
js_©omics_waôî_li°
);

52262 
JSVÆue
 
	$js_©omics_waô
(
JSC⁄ãxt
 *
˘x
,

52263 
JSVÆueC⁄°
 
this_obj
,

52264 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

52266 
söt64_t
 
v
;

52267 
öt32_t
 
v32
;

52268 *
±r
;

52269 
söt64_t
 
timeout
;

52270 
time•ec
 
ts
;

52271 
JSAtomicsWaôî
 
waôî_s
, *
waôî
;

52272 
ªt
, 
size_log2
, 
ªs
;

52273 
d
;

52275 
±r
 = 
	`js_©omics_gë_±r
(
˘x
, &
size_log2
, 
NULL
, 
¨gv
[0],árgv[1], 
TRUE
);

52276 i‡(!
±r
)

52277  
JS_EXCEPTION
;

52278 #ifde‡
CONFIG_BIGNUM


52279 i‡(
size_log2
 == 3) {

52280 i‡(
	`JS_ToBigI¡64
(
˘x
, &
v
, 
¨gv
[2]))

52281  
JS_EXCEPTION
;

52285 i‡(
	`JS_ToI¡32
(
˘x
, &
v32
, 
¨gv
[2]))

52286  
JS_EXCEPTION
;

52287 
v
 = 
v32
;

52289 i‡(
	`JS_ToFlﬂt64
(
˘x
, &
d
, 
¨gv
[3]))

52290  
JS_EXCEPTION
;

52291 i‡(
	`i¢™
(
d
Ë|| d > 
INT64_MAX
)

52292 
timeout
 = 
INT64_MAX
;

52293 i‡(
d
 < 0)

52294 
timeout
 = 0;

52296 
timeout
 = (
söt64_t
)
d
;

52297 i‡(!
˘x
->
π
->
ˇn_block
)

52298  
	`JS_ThrowTy≥Eº‹
(
˘x
, "cannot block inÅhisÅhread");

52303 
	`±hªad_muãx_lock
(&
js_©omics_muãx
);

52304 i‡(
size_log2
 == 3) {

52305 
ªs
 = *(
söt64_t
 *)
±r
 !
v
;

52307 
ªs
 = *(
öt32_t
 *)
±r
 !
v
;

52309 i‡(
ªs
) {

52310 
	`±hªad_muãx_u∆ock
(&
js_©omics_muãx
);

52311  
	`JS_AtomToSåög
(
˘x
, 
JS_ATOM_nŸ_equÆ
);

52314 
waôî
 = &
waôî_s
;

52315 
waôî
->
±r
 =Ötr;

52316 
	`±hªad_c⁄d_öô
(&
waôî
->
c⁄d
, 
NULL
);

52317 
waôî
->
löked
 = 
TRUE
;

52318 
	`li°_add_èû
(&
waôî
->
lök
, &
js_©omics_waôî_li°
);

52320 i‡(
timeout
 =
INT64_MAX
) {

52321 
	`±hªad_c⁄d_waô
(&
waôî
->
c⁄d
, &
js_©omics_muãx
);

52322 
ªt
 = 0;

52325 
	`˛ock_gëtime
(
CLOCK_REALTIME
, &
ts
);

52326 
ts
.
tv_£c
 +
timeout
 / 1000;

52327 
ts
.
tv_n£c
 +(
timeout
 % 1000) * 1000000;

52328 i‡(
ts
.
tv_n£c
 >= 1000000000) {

52329 
ts
.
tv_n£c
 -= 1000000000;

52330 
ts
.
tv_£c
++;

52332 
ªt
 = 
	`±hªad_c⁄d_timedwaô
(&
waôî
->
c⁄d
, &
js_©omics_muãx
,

52333 &
ts
);

52335 i‡(
waôî
->
löked
)

52336 
	`li°_dñ
(&
waôî
->
lök
);

52337 
	`±hªad_muãx_u∆ock
(&
js_©omics_muãx
);

52338 
	`±hªad_c⁄d_de°roy
(&
waôî
->
c⁄d
);

52339 i‡(
ªt
 =
ETIMEDOUT
) {

52340  
	`JS_AtomToSåög
(
˘x
, 
JS_ATOM_timed_out
);

52342  
	`JS_AtomToSåög
(
˘x
, 
JS_ATOM_ok
);

52344 
	}
}

52346 
JSVÆue
 
	$js_©omics_nŸify
(
JSC⁄ãxt
 *
˘x
,

52347 
JSVÆueC⁄°
 
this_obj
,

52348 
¨gc
, 
JSVÆueC⁄°
 *
¨gv
)

52350 
li°_hód
 *
ñ
, *
ñ1
, 
waôî_li°
;

52351 
öt32_t
 
cou¡
, 
n
;

52352 *
±r
;

52353 
JSAtomicsWaôî
 *
waôî
;

52355 
±r
 = 
	`js_©omics_gë_±r
(
˘x
, 
NULL
, NULL, 
¨gv
[0],árgv[1], 
TRUE
);

52356 i‡(!
±r
)

52357  
JS_EXCEPTION
;

52359 i‡(
	`JS_IsUndeföed
(
¨gv
[2])) {

52360 
cou¡
 = 
INT32_MAX
;

52362 i‡(
	`JS_ToI¡32Cœmp
(
˘x
, &
cou¡
, 
¨gv
[2], 0, 
INT32_MAX
, 0))

52363  
JS_EXCEPTION
;

52366 
n
 = 0;

52367 i‡(
cou¡
 > 0) {

52368 
	`±hªad_muãx_lock
(&
js_©omics_muãx
);

52369 
	`öô_li°_hód
(&
waôî_li°
);

52370 
	`li°_f‹_óch_ß„
(
ñ
, 
ñ1
, &
js_©omics_waôî_li°
) {

52371 
waôî
 = 
	`li°_íåy
(
ñ
, 
JSAtomicsWaôî
, 
lök
);

52372 i‡(
waôî
->
±r
 ==Ötr) {

52373 
	`li°_dñ
(&
waôî
->
lök
);

52374 
waôî
->
löked
 = 
FALSE
;

52375 
	`li°_add_èû
(&
waôî
->
lök
, &
waôî_li°
);

52376 
n
++;

52377 i‡(
n
 >
cou¡
)

52381 
	`li°_f‹_óch
(
ñ
, &
waôî_li°
) {

52382 
waôî
 = 
	`li°_íåy
(
ñ
, 
JSAtomicsWaôî
, 
lök
);

52383 
	`±hªad_c⁄d_sig«l
(&
waôî
->
c⁄d
);

52385 
	`±hªad_muãx_u∆ock
(&
js_©omics_muãx
);

52387  
	`JS_NewI¡32
(
˘x
, 
n
);

52388 
	}
}

52390 c⁄° 
JSCFun˘i⁄Li°E¡ry
 
	gjs_©omics_funcs
[] = {

52391 
JS_CFUNC_MAGIC_DEF
("add", 3, 
js_©omics_›
, 
ATOMICS_OP_ADD
 ),

52392 
JS_CFUNC_MAGIC_DEF
("™d", 3, 
js_©omics_›
, 
ATOMICS_OP_AND
 ),

52393 
JS_CFUNC_MAGIC_DEF
("‹", 3, 
js_©omics_›
, 
ATOMICS_OP_OR
 ),

52394 
JS_CFUNC_MAGIC_DEF
("sub", 3, 
js_©omics_›
, 
ATOMICS_OP_SUB
 ),

52395 
JS_CFUNC_MAGIC_DEF
("x‹", 3, 
js_©omics_›
, 
ATOMICS_OP_XOR
 ),

52396 
JS_CFUNC_MAGIC_DEF
("exch™ge", 3, 
js_©omics_›
, 
ATOMICS_OP_EXCHANGE
 ),

52397 
JS_CFUNC_MAGIC_DEF
("com∑ªExch™ge", 4, 
js_©omics_›
, 
ATOMICS_OP_COMPARE_EXCHANGE
 ),

52398 
JS_CFUNC_MAGIC_DEF
("lﬂd", 2, 
js_©omics_›
, 
ATOMICS_OP_LOAD
 ),

52399 
JS_CFUNC_DEF
("°‹e", 3, 
js_©omics_°‹e
 ),

52400 
JS_CFUNC_DEF
("isLockFªe", 1, 
js_©omics_isLockFªe
 ),

52401 
JS_CFUNC_DEF
("waô", 4, 
js_©omics_waô
 ),

52402 
JS_CFUNC_DEF
("nŸify", 3, 
js_©omics_nŸify
 ),

52403 
JS_PROP_STRING_DEF
("[Symbﬁ.toSåögTag]", "Atomics", 
JS_PROP_CONFIGURABLE
 ),

52406 c⁄° 
JSCFun˘i⁄Li°E¡ry
 
	gjs_©omics_obj
[] = {

52407 
JS_OBJECT_DEF
("Atomics", 
js_©omics_funcs
, 
cou¡of
(js_©omics_funcs), 
JS_PROP_WRITABLE
 | 
JS_PROP_CONFIGURABLE
 ),

52410 
	$JS_AddI¡rösicAtomics
(
JSC⁄ãxt
 *
˘x
)

52413 
	`JS_SëPr›îtyFun˘i⁄Li°
(
˘x
, ctx->
globÆ_obj
, 
js_©omics_obj
, 
	`cou¡of
(js_atomics_obj));

52414 
	}
}

52418 
	$JS_AddI¡rösicTy≥dAºays
(
JSC⁄ãxt
 *
˘x
)

52420 
JSVÆue
 
ty≥d_¨øy_ba£_¥Ÿo
, 
ty≥d_¨øy_ba£_func
;

52421 
JSVÆueC⁄°
 
¨øy_buf„r_func
, 
sh¨ed_¨øy_buf„r_func
;

52422 
i
;

52424 
˘x
->
˛ass_¥Ÿo
[
JS_CLASS_ARRAY_BUFFER
] = 
	`JS_NewObje˘
(ctx);

52425 
	`JS_SëPr›îtyFun˘i⁄Li°
(
˘x
, ctx->
˛ass_¥Ÿo
[
JS_CLASS_ARRAY_BUFFER
],

52426 
js_¨øy_buf„r_¥Ÿo_funcs
,

52427 
	`cou¡of
(
js_¨øy_buf„r_¥Ÿo_funcs
));

52429 
¨øy_buf„r_func
 = 
	`JS_NewGlobÆCC⁄°ru˘‹O∆y
(
˘x
, "ArrayBuffer",

52430 
js_¨øy_buf„r_c⁄°ru˘‹
, 1,

52431 
˘x
->
˛ass_¥Ÿo
[
JS_CLASS_ARRAY_BUFFER
]);

52432 
	`JS_SëPr›îtyFun˘i⁄Li°
(
˘x
, 
¨øy_buf„r_func
,

52433 
js_¨øy_buf„r_funcs
,

52434 
	`cou¡of
(
js_¨øy_buf„r_funcs
));

52436 
˘x
->
˛ass_¥Ÿo
[
JS_CLASS_SHARED_ARRAY_BUFFER
] = 
	`JS_NewObje˘
(ctx);

52437 
	`JS_SëPr›îtyFun˘i⁄Li°
(
˘x
, ctx->
˛ass_¥Ÿo
[
JS_CLASS_SHARED_ARRAY_BUFFER
],

52438 
js_sh¨ed_¨øy_buf„r_¥Ÿo_funcs
,

52439 
	`cou¡of
(
js_sh¨ed_¨øy_buf„r_¥Ÿo_funcs
));

52441 
sh¨ed_¨øy_buf„r_func
 = 
	`JS_NewGlobÆCC⁄°ru˘‹O∆y
(
˘x
, "SharedArrayBuffer",

52442 
js_sh¨ed_¨øy_buf„r_c⁄°ru˘‹
, 1,

52443 
˘x
->
˛ass_¥Ÿo
[
JS_CLASS_SHARED_ARRAY_BUFFER
]);

52444 
	`JS_SëPr›îtyFun˘i⁄Li°
(
˘x
, 
sh¨ed_¨øy_buf„r_func
,

52445 
js_sh¨ed_¨øy_buf„r_funcs
,

52446 
	`cou¡of
(
js_sh¨ed_¨øy_buf„r_funcs
));

52448 
ty≥d_¨øy_ba£_¥Ÿo
 = 
	`JS_NewObje˘
(
˘x
);

52449 
	`JS_SëPr›îtyFun˘i⁄Li°
(
˘x
, 
ty≥d_¨øy_ba£_¥Ÿo
,

52450 
js_ty≥d_¨øy_ba£_¥Ÿo_funcs
,

52451 
	`cou¡of
(
js_ty≥d_¨øy_ba£_¥Ÿo_funcs
));

52454 
JSVÆue
 
obj
 = 
	`JS_GëPr›îty
(
˘x
, ctx->
˛ass_¥Ÿo
[
JS_CLASS_ARRAY
], 
JS_ATOM_toSåög
);

52456 
	`JS_DeföePr›îtyVÆue
(
˘x
, 
ty≥d_¨øy_ba£_¥Ÿo
, 
JS_ATOM_toSåög
, 
obj
,

52457 
JS_PROP_WRITABLE
 | 
JS_PROP_CONFIGURABLE
);

52459 
ty≥d_¨øy_ba£_func
 = 
	`JS_NewCFun˘i⁄
(
˘x
, 
js_ty≥d_¨øy_ba£_c⁄°ru˘‹
,

52461 
	`JS_SëPr›îtyFun˘i⁄Li°
(
˘x
, 
ty≥d_¨øy_ba£_func
,

52462 
js_ty≥d_¨øy_ba£_funcs
,

52463 
	`cou¡of
(
js_ty≥d_¨øy_ba£_funcs
));

52464 
	`JS_SëC⁄°ru˘‹
(
˘x
, 
ty≥d_¨øy_ba£_func
, 
ty≥d_¨øy_ba£_¥Ÿo
);

52466 
i
 = 
JS_CLASS_UINT8C_ARRAY
; i < JS_CLASS_UINT8C_ARRAY + 
JS_TYPED_ARRAY_COUNT
; i++) {

52467 
JSVÆue
 
func_obj
;

52468 
buf
[
ATOM_GET_STR_BUF_SIZE
];

52469 c⁄° *
«me
;

52471 
˘x
->
˛ass_¥Ÿo
[
i
] = 
	`JS_NewObje˘PrŸo
(˘x, 
ty≥d_¨øy_ba£_¥Ÿo
);

52472 
	`JS_DeföePr›îtyVÆueSå
(
˘x
, ctx->
˛ass_¥Ÿo
[
i
],

52474 
	`JS_NewI¡32
(
˘x
, 1 << 
	`ty≥d_¨øy_size_log2
(
i
)),

52476 
«me
 = 
	`JS_AtomGëSå
(
˘x
, 
buf
, (buf),

52477 
JS_ATOM_Uöt8Cœm≥dAºay
 + 
i
 - 
JS_CLASS_UINT8C_ARRAY
);

52478 
func_obj
 = 
	`JS_NewCFun˘i⁄3
(
˘x
, (
JSCFun˘i⁄
 *)
js_ty≥d_¨øy_c⁄°ru˘‹
,

52479 
«me
, 3, 
JS_CFUNC_c⁄°ru˘‹_magic
, 
i
,

52480 
ty≥d_¨øy_ba£_func
);

52481 
	`JS_NewGlobÆCC⁄°ru˘‹2
(
˘x
, 
func_obj
, 
«me
, ctx->
˛ass_¥Ÿo
[
i
]);

52482 
	`JS_DeföePr›îtyVÆueSå
(
˘x
, 
func_obj
,

52484 
	`JS_NewI¡32
(
˘x
, 1 << 
	`ty≥d_¨øy_size_log2
(
i
)),

52487 
	`JS_FªeVÆue
(
˘x
, 
ty≥d_¨øy_ba£_¥Ÿo
);

52488 
	`JS_FªeVÆue
(
˘x
, 
ty≥d_¨øy_ba£_func
);

52491 
˘x
->
˛ass_¥Ÿo
[
JS_CLASS_DATAVIEW
] = 
	`JS_NewObje˘
(ctx);

52492 
	`JS_SëPr›îtyFun˘i⁄Li°
(
˘x
, ctx->
˛ass_¥Ÿo
[
JS_CLASS_DATAVIEW
],

52493 
js_d©avõw_¥Ÿo_funcs
,

52494 
	`cou¡of
(
js_d©avõw_¥Ÿo_funcs
));

52495 
	`JS_NewGlobÆCC⁄°ru˘‹O∆y
(
˘x
, "DataView",

52496 
js_d©avõw_c⁄°ru˘‹
, 1,

52497 
˘x
->
˛ass_¥Ÿo
[
JS_CLASS_DATAVIEW
]);

52499 #ifde‡
CONFIG_ATOMICS


52500 
	`JS_AddI¡rösicAtomics
(
˘x
);

52502 
	}
}

	@/usr/include/assert.h

22 #ifdef 
_ASSERT_H


24 #unde‡
_ASSERT_H


25 #unde‡
as£π


26 #unde‡
__ASSERT_VOID_CAST


28 #ifdef 
__USE_GNU


29 #unde‡
as£π_≥º‹


34 
	#_ASSERT_H
 1

	)

35 
	~<„©uªs.h
>

37 #i‡
deföed
 
__˝lu•lus
 && 
__GNUC_PREREQ
 (2,95)

38 
	#__ASSERT_VOID_CAST
 
°©ic_ˇ°
<>

	)

40 
	#__ASSERT_VOID_CAST
 ()

	)

48 #ifdef 
NDEBUG


50 
	#as£π
(
ex¥
Ë(
	`__ASSERT_VOID_CAST
 (0))

	)

58 #ifdef 
__USE_GNU


59 
	#as£π_≥º‹
(
î∫um
Ë(
	`__ASSERT_VOID_CAST
 (0))

	)

64 
__BEGIN_DECLS


67 
	$__as£π_Áû
 (c⁄° *
__as£πi⁄
, c⁄° *
__fûe
,

68 
__löe
, c⁄° *
__fun˘i⁄
)

69 
__THROW
 
	`__©åibuã__
 ((
__n‹ëu∫__
));

72 
	$__as£π_≥º‹_Áû
 (
__î∫um
, c⁄° *
__fûe
,

73 
__löe
, c⁄° *
__fun˘i⁄
)

74 
__THROW
 
	`__©åibuã__
 ((
__n‹ëu∫__
));

79 
	$__as£π
 (c⁄° *
__as£πi⁄
, c⁄° *
__fûe
, 
__löe
)

80 
__THROW
 
	`__©åibuã__
 ((
__n‹ëu∫__
));

83 
__END_DECLS


88 #i‡
deföed
 
__˝lu•lus


89 
	#as£π
(
ex¥
) \

90 (
°©ic_ˇ°
 <
boﬁ
> (
ex¥
) \

92 : 
	`__as£π_Áû
 (#ex¥, 
__FILE__
, 
__LINE__
, 
__ASSERT_FUNCTION
))

	)

93 #ñi‡!
deföed
 
__GNUC__
 || deföed 
__STRICT_ANSI__


94 
	#as£π
(
ex¥
) \

95 ((
ex¥
) \

96 ? 
	`__ASSERT_VOID_CAST
 (0) \

97 : 
	`__as£π_Áû
 (#ex¥, 
__FILE__
, 
__LINE__
, 
__ASSERT_FUNCTION
))

	)

104 
	#as£π
(
ex¥
) \

105 ((Ë ((
ex¥
Ë? 1 : 0), 
	`__exãnsi⁄__
 ({ \

106 i‡(
ex¥
) \

109 
	`__as£π_Áû
 (#ex¥, 
__FILE__
, 
__LINE__
, 
__ASSERT_FUNCTION
); \

110 
	}
}))

	)

113 #ifdef 
__USE_GNU


114 
	#as£π_≥º‹
(
î∫um
) \

115 (!(
î∫um
) \

116 ? 
	`__ASSERT_VOID_CAST
 (0) \

117 : 
	`__as£π_≥º‹_Áû
 ((
î∫um
), 
__FILE__
, 
__LINE__
, 
__ASSERT_FUNCTION
))

	)

125 #i‡
deföed
 
__˝lu•lus
 ? 
__GNUC_PREREQ
 (2, 6) : __GNUC_PREREQ (2, 4)

126 
	#__ASSERT_FUNCTION
 
__exãnsi⁄__
 
__PRETTY_FUNCTION__


	)

128 #i‡
deföed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L

129 
	#__ASSERT_FUNCTION
 
__func__


	)

131 
	#__ASSERT_FUNCTION
 ((c⁄° *Ë0)

	)

138 #i‡
deföed
 
__USE_ISOC11
 && !deföed 
__˝lu•lus


139 #unde‡
°©ic_as£π


140 
	#°©ic_as£π
 
_Sètic_as£π


	)

	@/usr/include/features.h

18 #i‚def 
_FEATURES_H


19 
	#_FEATURES_H
 1

	)

120 #unde‡
__USE_ISOC11


121 #unde‡
__USE_ISOC99


122 #unde‡
__USE_ISOC95


123 #unde‡
__USE_ISOCXX11


124 #unde‡
__USE_POSIX


125 #unde‡
__USE_POSIX2


126 #unde‡
__USE_POSIX199309


127 #unde‡
__USE_POSIX199506


128 #unde‡
__USE_XOPEN


129 #unde‡
__USE_XOPEN_EXTENDED


130 #unde‡
__USE_UNIX98


131 #unde‡
__USE_XOPEN2K


132 #unde‡
__USE_XOPEN2KXSI


133 #unde‡
__USE_XOPEN2K8


134 #unde‡
__USE_XOPEN2K8XSI


135 #unde‡
__USE_LARGEFILE


136 #unde‡
__USE_LARGEFILE64


137 #unde‡
__USE_FILE_OFFSET64


138 #unde‡
__USE_MISC


139 #unde‡
__USE_ATFILE


140 #unde‡
__USE_GNU


141 #unde‡
__USE_FORTIFY_LEVEL


142 #unde‡
__KERNEL_STRICT_NAMES


143 #unde‡
__GLIBC_USE_ISOC2X


144 #unde‡
__GLIBC_USE_DEPRECATED_GETS


145 #unde‡
__GLIBC_USE_DEPRECATED_SCANF


149 #i‚de‡
_LOOSE_KERNEL_NAMES


150 
	#__KERNEL_STRICT_NAMES


	)

160 #i‡
deföed
 
__GNUC__
 && deföed 
__GNUC_MINOR__


161 
	#__GNUC_PREREQ
(
maj
, 
mö
) \

162 ((
__GNUC__
 << 16Ë+ 
__GNUC_MINOR__
 >((
maj
Ë<< 16Ë+ (
mö
))

	)

164 
	#__GNUC_PREREQ
(
maj
, 
mö
Ë0

	)

171 #i‡
deföed
 
__˛™g_maj‹__
 && deföed 
__˛™g_mö‹__


172 
	#__glibc_˛™g_¥îeq
(
maj
, 
mö
) \

173 ((
__˛™g_maj‹__
 << 16Ë+ 
__˛™g_mö‹__
 >((
maj
Ë<< 16Ë+ (
mö
))

	)

175 
	#__glibc_˛™g_¥îeq
(
maj
, 
mö
Ë0

	)

179 
	#__GLIBC_USE
(
F
Ë
__GLIBC_USE_
 ## 
	)
F

185 #i‡(
deföed
 
_BSD_SOURCE
 || deföed 
_SVID_SOURCE
) \

186 && !
deföed
 
	g_DEFAULT_SOURCE


188 #unde‡
_DEFAULT_SOURCE


189 
	#_DEFAULT_SOURCE
 1

	)

193 #ifde‡
_GNU_SOURCE


194 #unde‡
_ISOC95_SOURCE


195 
	#_ISOC95_SOURCE
 1

	)

196 #unde‡
_ISOC99_SOURCE


197 
	#_ISOC99_SOURCE
 1

	)

198 #unde‡
_ISOC11_SOURCE


199 
	#_ISOC11_SOURCE
 1

	)

200 #unde‡
_ISOC2X_SOURCE


201 
	#_ISOC2X_SOURCE
 1

	)

202 #unde‡
_POSIX_SOURCE


203 
	#_POSIX_SOURCE
 1

	)

204 #unde‡
_POSIX_C_SOURCE


205 
	#_POSIX_C_SOURCE
 200809L

	)

206 #unde‡
_XOPEN_SOURCE


207 
	#_XOPEN_SOURCE
 700

	)

208 #unde‡
_XOPEN_SOURCE_EXTENDED


209 
	#_XOPEN_SOURCE_EXTENDED
 1

	)

210 #unde‡
_LARGEFILE64_SOURCE


211 
	#_LARGEFILE64_SOURCE
 1

	)

212 #unde‡
_DEFAULT_SOURCE


213 
	#_DEFAULT_SOURCE
 1

	)

214 #unde‡
_ATFILE_SOURCE


215 
	#_ATFILE_SOURCE
 1

	)

220 #i‡(
deföed
 
_DEFAULT_SOURCE
 \

221 || (!
deföed
 
	g__STRICT_ANSI__
 \

222 && !
deföed
 
	g_ISOC99_SOURCE
 && !deföed 
	g_ISOC11_SOURCE
 \

223 && !
deföed
 
	g_ISOC2X_SOURCE
 \

224 && !
deföed
 
	g_POSIX_SOURCE
 && !deföed 
	g_POSIX_C_SOURCE
 \

225 && !
deföed
 
	g_XOPEN_SOURCE
))

226 #unde‡
_DEFAULT_SOURCE


227 
	#_DEFAULT_SOURCE
 1

	)

231 #i‡(
deföed
 
_ISOC2X_SOURCE
 \

232 || (
deföed
 
	g__STDC_VERSION__
 && __STDC_VERSION__ > 201710L))

233 
	#__GLIBC_USE_ISOC2X
 1

	)

235 
	#__GLIBC_USE_ISOC2X
 0

	)

239 #i‡(
deföed
 
_ISOC11_SOURCE
 || deföed 
_ISOC2X_SOURCE
 \

240 || (
deföed
 
	g__STDC_VERSION__
 && __STDC_VERSION__ >= 201112L))

241 
	#__USE_ISOC11
 1

	)

245 #i‡(
deföed
 
_ISOC99_SOURCE
 || deföed 
_ISOC11_SOURCE
 \

246 || 
deföed
 
_ISOC2X_SOURCE
 \

247 || (
deföed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L))

248 
	#__USE_ISOC99
 1

	)

252 #i‡(
deföed
 
_ISOC99_SOURCE
 || deföed 
_ISOC11_SOURCE
 \

253 || 
deföed
 
_ISOC2X_SOURCE
 \

254 || (
deföed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199409L))

255 
	#__USE_ISOC95
 1

	)

258 #ifde‡
__˝lu•lus


260 #i‡
__˝lu•lus
 >= 201703L

261 
	#__USE_ISOC11
 1

	)

265 #i‡
__˝lu•lus
 >201103L || 
deföed
 
__GXX_EXPERIMENTAL_CXX0X__


266 
	#__USE_ISOCXX11
 1

	)

267 
	#__USE_ISOC99
 1

	)

274 #ifde‡
_DEFAULT_SOURCE


275 #i‡!
deföed
 
_POSIX_SOURCE
 && !deföed 
_POSIX_C_SOURCE


276 
	#__USE_POSIX_IMPLICITLY
 1

	)

278 #unde‡
_POSIX_SOURCE


279 
	#_POSIX_SOURCE
 1

	)

280 #unde‡
_POSIX_C_SOURCE


281 
	#_POSIX_C_SOURCE
 200809L

	)

284 #i‡((!
deföed
 
__STRICT_ANSI__
 \

285 || (
deföed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) >= 500)) \

286 && !
deföed
 
_POSIX_SOURCE
 && !deföed 
_POSIX_C_SOURCE
)

287 
	#_POSIX_SOURCE
 1

	)

288 #i‡
deföed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 500

289 
	#_POSIX_C_SOURCE
 2

	)

290 #ñi‡
deföed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 600

291 
	#_POSIX_C_SOURCE
 199506L

	)

292 #ñi‡
deföed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 700

293 
	#_POSIX_C_SOURCE
 200112L

	)

295 
	#_POSIX_C_SOURCE
 200809L

	)

297 
	#__USE_POSIX_IMPLICITLY
 1

	)

306 #i‡((!
deföed
 
_POSIX_C_SOURCE
 || (_POSIX_C_SOURCE - 0) < 199506L) \

307 && (
deföed
 
_REENTRANT
 || deföed 
_THREAD_SAFE
))

308 
	#_POSIX_SOURCE
 1

	)

309 #unde‡
_POSIX_C_SOURCE


310 
	#_POSIX_C_SOURCE
 199506L

	)

313 #i‡(
deföed
 
_POSIX_SOURCE
 \

314 || (
deföed
 
_POSIX_C_SOURCE
 && _POSIX_C_SOURCE >= 1) \

315 || 
deföed
 
_XOPEN_SOURCE
)

316 
	#__USE_POSIX
 1

	)

319 #i‡
deföed
 
_POSIX_C_SOURCE
 && _POSIX_C_SOURCE >2 || deföed 
_XOPEN_SOURCE


320 
	#__USE_POSIX2
 1

	)

323 #i‡
deföed
 
_POSIX_C_SOURCE
 && (_POSIX_C_SOURCE - 0) >= 199309L

324 
	#__USE_POSIX199309
 1

	)

327 #i‡
deföed
 
_POSIX_C_SOURCE
 && (_POSIX_C_SOURCE - 0) >= 199506L

328 
	#__USE_POSIX199506
 1

	)

331 #i‡
deföed
 
_POSIX_C_SOURCE
 && (_POSIX_C_SOURCE - 0) >= 200112L

332 
	#__USE_XOPEN2K
 1

	)

333 #unde‡
__USE_ISOC95


334 
	#__USE_ISOC95
 1

	)

335 #unde‡
__USE_ISOC99


336 
	#__USE_ISOC99
 1

	)

339 #i‡
deföed
 
_POSIX_C_SOURCE
 && (_POSIX_C_SOURCE - 0) >= 200809L

340 
	#__USE_XOPEN2K8
 1

	)

341 #unde‡
_ATFILE_SOURCE


342 
	#_ATFILE_SOURCE
 1

	)

345 #ifdef 
_XOPEN_SOURCE


346 
	#__USE_XOPEN
 1

	)

347 #i‡(
_XOPEN_SOURCE
 - 0) >= 500

348 
	#__USE_XOPEN_EXTENDED
 1

	)

349 
	#__USE_UNIX98
 1

	)

350 #unde‡
_LARGEFILE_SOURCE


351 
	#_LARGEFILE_SOURCE
 1

	)

352 #i‡(
_XOPEN_SOURCE
 - 0) >= 600

353 #i‡(
_XOPEN_SOURCE
 - 0) >= 700

354 
	#__USE_XOPEN2K8
 1

	)

355 
	#__USE_XOPEN2K8XSI
 1

	)

357 
	#__USE_XOPEN2K
 1

	)

358 
	#__USE_XOPEN2KXSI
 1

	)

359 #unde‡
__USE_ISOC95


360 
	#__USE_ISOC95
 1

	)

361 #unde‡
__USE_ISOC99


362 
	#__USE_ISOC99
 1

	)

365 #ifde‡
_XOPEN_SOURCE_EXTENDED


366 
	#__USE_XOPEN_EXTENDED
 1

	)

371 #ifde‡
_LARGEFILE_SOURCE


372 
	#__USE_LARGEFILE
 1

	)

375 #ifde‡
_LARGEFILE64_SOURCE


376 
	#__USE_LARGEFILE64
 1

	)

379 #i‡
deföed
 
_FILE_OFFSET_BITS
 && _FILE_OFFSET_BITS == 64

380 
	#__USE_FILE_OFFSET64
 1

	)

383 #i‡
deföed
 
_DEFAULT_SOURCE


384 
	#__USE_MISC
 1

	)

387 #ifdef 
_ATFILE_SOURCE


388 
	#__USE_ATFILE
 1

	)

391 #ifdef 
_GNU_SOURCE


392 
	#__USE_GNU
 1

	)

395 #i‡
deföed
 
_FORTIFY_SOURCE
 && _FORTIFY_SOURCE > 0

396 #i‡!
deföed
 
__OPTIMIZE__
 || __OPTIMIZE__ <= 0

397 #w¨nög 
_FORTIFY_SOURCE
 
ªquúes
 
compûög
 
wôh
 
›timiz©i⁄
 (-
O
)

398 #ñi‡!
__GNUC_PREREQ
 (4, 1)

399 #w¨nög 
_FORTIFY_SOURCE
 
ªquúes
 
GCC
 4.1 
‹
 
œãr


400 #ñi‡
_FORTIFY_SOURCE
 > 1

401 
	#__USE_FORTIFY_LEVEL
 2

	)

403 
	#__USE_FORTIFY_LEVEL
 1

	)

406 #i‚de‡
__USE_FORTIFY_LEVEL


407 
	#__USE_FORTIFY_LEVEL
 0

	)

414 #i‡
deföed
 
__˝lu•lus
 ? __˝lu•lu†>201402L : deföed 
__USE_ISOC11


415 
	#__GLIBC_USE_DEPRECATED_GETS
 0

	)

417 
	#__GLIBC_USE_DEPRECATED_GETS
 1

	)

432 #i‡(
deföed
 
__USE_GNU
 \

433 && (
deföed
 
	g__˝lu•lus
 \

434 ? (
	g__˝lu•lus
 < 201103L && !
deföed
 
	g__GXX_EXPERIMENTAL_CXX0X__
) \

435 : (!
deföed
 
__STDC_VERSION__
 || __STDC_VERSION__ < 199901L)))

436 
	#__GLIBC_USE_DEPRECATED_SCANF
 1

	)

438 
	#__GLIBC_USE_DEPRECATED_SCANF
 0

	)

443 
	~<°dc-¥edef.h
>

451 #unde‡
__GNU_LIBRARY__


452 
	#__GNU_LIBRARY__
 6

	)

456 
	#__GLIBC__
 2

	)

457 
	#__GLIBC_MINOR__
 31

	)

459 
	#__GLIBC_PREREQ
(
maj
, 
mö
) \

460 ((
__GLIBC__
 << 16Ë+ 
__GLIBC_MINOR__
 >((
maj
Ë<< 16Ë+ (
mö
))

	)

463 #i‚de‡
__ASSEMBLER__


464 #i‚de‡
_SYS_CDEFS_H


465 
	~<sys/cdefs.h
>

470 #i‡
deföed
 
__USE_FILE_OFFSET64
 && !deföed 
__REDIRECT


471 
	#__USE_LARGEFILE
 1

	)

472 
	#__USE_LARGEFILE64
 1

	)

478 #i‡
__GNUC_PREREQ
 (2, 7Ë&& 
deföed
 
__OPTIMIZE__
 \

479 && !
deföed
 
	g__OPTIMIZE_SIZE__
 && !deföed 
	g__NO_INLINE__
 \

480 && 
deföed
 
	g__exã∫_ölöe


481 
	#__USE_EXTERN_INLINES
 1

	)

489 
	~<gnu/°ubs.h
>

	@/usr/include/gnu/stubs.h

6 #i‡!
deföed
 
__x86_64__


7 
	~<gnu/°ubs-32.h
>

9 #i‡
deföed
 
__x86_64__
 && deföed 
__LP64__


10 
	~<gnu/°ubs-64.h
>

12 #i‡
deföed
 
__x86_64__
 && deföed 
__ILP32__


13 
	~<gnu/°ubs-x32.h
>

	@/usr/include/stdc-predef.h

18 #i‚def 
_STDC_PREDEF_H


19 
	#_STDC_PREDEF_H
 1

	)

36 #ifde‡
__GCC_IEC_559


37 #i‡
__GCC_IEC_559
 > 0

38 
	#__STDC_IEC_559__
 1

	)

41 
	#__STDC_IEC_559__
 1

	)

44 #ifde‡
__GCC_IEC_559_COMPLEX


45 #i‡
__GCC_IEC_559_COMPLEX
 > 0

46 
	#__STDC_IEC_559_COMPLEX__
 1

	)

49 
	#__STDC_IEC_559_COMPLEX__
 1

	)

58 
	#__STDC_ISO_10646__
 201706L

	)

	@/usr/include/sys/cdefs.h

18 #i‚def 
_SYS_CDEFS_H


19 
	#_SYS_CDEFS_H
 1

	)

22 #i‚de‡
_FEATURES_H


23 
	~<„©uªs.h
>

29 #i‡
deföed
 
__GNUC__
 && !deföed 
__STDC__


34 #unde‡
__P


35 #unde‡
__PMT


37 #ifde‡
__GNUC__


41 #i‡
__GNUC_PREREQ
 (4, 6Ë&& !
deföed
 
_LIBC


42 
	#__LEAF
 , 
__Àaf__


	)

43 
	#__LEAF_ATTR
 
	`__©åibuã__
 ((
__Àaf__
))

	)

45 
	#__LEAF


	)

46 
	#__LEAF_ATTR


	)

54 #i‡!
deföed
 
__˝lu•lus
 && 
__GNUC_PREREQ
 (3, 3)

55 
	#__THROW
 
	`__©åibuã__
 ((
__nŸhrow__
 
__LEAF
))

	)

56 
	#__THROWNL
 
	`__©åibuã__
 ((
__nŸhrow__
))

	)

57 
	#__NTH
(
f˘
Ë
	`__©åibuã__
 ((
__nŸhrow__
 
__LEAF
)Ë
	)
fct

58 
	#__NTHNL
(
f˘
Ë
	`__©åibuã__
 ((
__nŸhrow__
)Ë
	)
fct

60 #i‡
deföed
 
__˝lu•lus
 && 
__GNUC_PREREQ
 (2,8)

61 
	#__THROW
 
	`throw
 ()

	)

62 
	#__THROWNL
 
	`throw
 ()

	)

63 
	#__NTH
(
f˘
Ë
__LEAF_ATTR
 f˘ 
	`throw
 ()

	)

64 
	#__NTHNL
(
f˘
Ëf˘ 
	`throw
 ()

	)

66 
	#__THROW


	)

67 
	#__THROWNL


	)

68 
	#__NTH
(
f˘
Ë
	)
fct

69 
	#__NTHNL
(
f˘
Ë
	)
fct

75 #i‡(
deföed
 
__˝lu•lus
 \

76 || (
deföed
 
	g__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L))

77 
	#__ölöe
 
ölöe


	)

79 
	#__ölöe


	)

82 
	#__THROW


	)

83 
	#__THROWNL


	)

84 
	#__NTH
(
f˘
Ë
	)
fct

91 #i‡
deföed
 
__˛™g__
 && deföed 
__has_exãnsi⁄


92 
	#__glibc_˛™g_has_exãnsi⁄
(
ext
Ë
	`__has_exãnsi⁄
 (ext)

	)

94 
	#__glibc_˛™g_has_exãnsi⁄
(
ext
Ë0

	)

99 
	#__P
(
¨gs
Ë
	)
args

100 
	#__PMT
(
¨gs
Ë
	)
args

105 
	#__CONCAT
(
x
,
y
Ëx ## 
	)
y

106 
	#__STRING
(
x
Ë#x

	)

109 
	#__±r_t
 *

	)

113 #ifdef 
__˝lu•lus


114 
	#__BEGIN_DECLS
 "C" {

	)

115 
	#__END_DECLS
 }

	)

117 
	#__BEGIN_DECLS


	)

118 
	#__END_DECLS


	)

123 
	#__bos
(
±r
Ë
	`__buûtö_obje˘_size
 (±r, 
__USE_FORTIFY_LEVEL
 > 1)

	)

124 
	#__bos0
(
±r
Ë
	`__buûtö_obje˘_size
 (±r, 0)

	)

126 #i‡
__GNUC_PREREQ
 (4,3)

127 
	#__w¨nde˛
(
«me
, 
msg
) \

128 
	`«me
 (Ë
	`__©åibuã__
((
	`__w¨nög__
 (
msg
)))

	)

129 
	#__w¨«âr
(
msg
Ë
	`__©åibuã__
((
	`__w¨nög__
 (msg)))

	)

130 
	#__îr‹de˛
(
«me
, 
msg
) \

131 
	`«me
 (Ë
	`__©åibuã__
((
	`__îr‹__
 (
msg
)))

	)

133 
	#__w¨nde˛
(
«me
, 
msg
Ë
	`«me
 ()

	)

134 
	#__w¨«âr
(
msg
)

	)

135 
	#__îr‹de˛
(
«me
, 
msg
Ë
	`«me
 ()

	)

142 #i‡
deföed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L

143 
	#__Êex¨r
 []

	)

144 
	#__glibc_c99_Êex¨r_avaûabÀ
 1

	)

145 #ñi‡
__GNUC_PREREQ
 (2,97)

148 
	#__Êex¨r
 []

	)

149 
	#__glibc_c99_Êex¨r_avaûabÀ
 1

	)

150 #ñi‡
deföed
 
__GNUC__


153 
	#__Êex¨r
 [0]

	)

154 
	#__glibc_c99_Êex¨r_avaûabÀ
 1

	)

157 
	#__Êex¨r
 [1]

	)

158 
	#__glibc_c99_Êex¨r_avaûabÀ
 0

	)

172 #i‡
deföed
 
__GNUC__
 && __GNUC__ >= 2

174 
	#__REDIRECT
(
«me
, 
¥Ÿo
, 
Æüs
Ë«mê¥Ÿÿ
	`__asm__
 (
	`__ASMNAME
 (#Æüs))

	)

175 #ifde‡
__˝lu•lus


176 
	#__REDIRECT_NTH
(
«me
, 
¥Ÿo
, 
Æüs
) \

177 
«me
 
¥Ÿo
 
__THROW
 
	`__asm__
 (
	`__ASMNAME
 (#Æüs))

	)

178 
	#__REDIRECT_NTHNL
(
«me
, 
¥Ÿo
, 
Æüs
) \

179 
«me
 
¥Ÿo
 
__THROWNL
 
	`__asm__
 (
	`__ASMNAME
 (#Æüs))

	)

181 
	#__REDIRECT_NTH
(
«me
, 
¥Ÿo
, 
Æüs
) \

182 
«me
 
¥Ÿo
 
	`__asm__
 (
	`__ASMNAME
 (#Æüs)Ë
__THROW


	)

183 
	#__REDIRECT_NTHNL
(
«me
, 
¥Ÿo
, 
Æüs
) \

184 
«me
 
¥Ÿo
 
	`__asm__
 (
	`__ASMNAME
 (#Æüs)Ë
__THROWNL


	)

186 
	#__ASMNAME
(
˙ame
Ë
	`__ASMNAME2
 (
__USER_LABEL_PREFIX__
, c«me)

	)

187 
	#__ASMNAME2
(
¥efix
, 
˙ame
Ë
	`__STRING
 (¥efixË
	)
cname

200 #i‡!
deföed
 
__GNUC__
 || __GNUC__ < 2

201 
	#__©åibuã__
(
xyz
Ë

	)

207 #i‡
__GNUC_PREREQ
 (2,96)

208 
	#__©åibuã_mÆloc__
 
	`__©åibuã__
 ((
__mÆloc__
))

	)

210 
	#__©åibuã_mÆloc__


	)

215 #i‡
__GNUC_PREREQ
 (4, 3)

216 
	#__©åibuã_Æloc_size__
(
∑øms
) \

217 
	`__©åibuã__
 ((
__Æloc_size__
 
∑øms
))

	)

219 
	#__©åibuã_Æloc_size__
(
∑øms
Ë

	)

225 #i‡
__GNUC_PREREQ
 (2,96)

226 
	#__©åibuã_puª__
 
	`__©åibuã__
 ((
__puª__
))

	)

228 
	#__©åibuã_puª__


	)

232 #i‡
__GNUC_PREREQ
 (2,5)

233 
	#__©åibuã_c⁄°__
 
	`__©åibuã__
 ((
__c⁄°__
))

	)

235 
	#__©åibuã_c⁄°__


	)

241 #i‡
__GNUC_PREREQ
 (3,1)

242 
	#__©åibuã_u£d__
 
	`__©åibuã__
 ((
__u£d__
))

	)

243 
	#__©åibuã_noölöe__
 
	`__©åibuã__
 ((
__noölöe__
))

	)

245 
	#__©åibuã_u£d__
 
	`__©åibuã__
 ((
__unu£d__
))

	)

246 
	#__©åibuã_noölöe__


	)

250 #i‡
__GNUC_PREREQ
 (3,2)

251 
	#__©åibuã_dïªˇãd__
 
	`__©åibuã__
 ((
__dïªˇãd__
))

	)

253 
	#__©åibuã_dïªˇãd__


	)

259 #i‡
__GNUC_PREREQ
 (4,5) \

260 || 
	$__glibc_˛™g_has_exãnsi⁄
 (
__©åibuã_dïªˇãd_wôh_mesßge__
)

261 
	#__©åibuã_dïªˇãd_msg__
(
msg
) \

262 
	`__©åibuã__
 ((
	`__dïªˇãd__
 (
msg
)))

	)

264 
	#__©åibuã_dïªˇãd_msg__
(
msg
Ë
__©åibuã_dïªˇãd__


	)

273 #i‡
	`__GNUC_PREREQ
 (2,8)

274 
	#__©åibuã_f‹m©_¨g__
(
x
Ë
	`__©åibuã__
 ((
	`__f‹m©_¨g__
 (x)))

	)

276 
	#__©åibuã_f‹m©_¨g__
(
x
Ë

	)

283 #i‡
	`__GNUC_PREREQ
 (2,97)

284 
	#__©åibuã_f‹m©_°rfm⁄__
(
a
,
b
) \

285 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__°rfm⁄__
, 
a
, 
b
)))

	)

287 
	#__©åibuã_f‹m©_°rfm⁄__
(
a
,
b
Ë

	)

292 #i‡
	`__GNUC_PREREQ
 (3,3)

293 
	#__n⁄nuŒ
(
∑øms
Ë
	`__©åibuã__
 ((
__n⁄nuŒ__
Ö¨ams))

	)

295 
	#__n⁄nuŒ
(
∑øms
)

	)

300 #i‡
	`__GNUC_PREREQ
 (3,4)

301 
	#__©åibuã_w¨n_unu£d_ªsu…__
 \

302 
	`__©åibuã__
 ((
__w¨n_unu£d_ªsu…__
))

	)

303 #i‡
__USE_FORTIFY_LEVEL
 > 0

304 
	#__wur
 
__©åibuã_w¨n_unu£d_ªsu…__


	)

307 
	#__©åibuã_w¨n_unu£d_ªsu…__


	)

309 #i‚de‡
__wur


310 
	#__wur


	)

314 #i‡
	`__GNUC_PREREQ
 (3,2)

318 #unde‡
__Æways_ölöe


319 
	#__Æways_ölöe
 
__ölöe
 
	`__©åibuã__
 ((
__Æways_ölöe__
))

	)

321 #unde‡
__Æways_ölöe


322 
	#__Æways_ölöe
 
__ölöe


	)

327 #i‡
	`__GNUC_PREREQ
 (4,3)

328 
	#__©åibuã_¨tificül__
 
	`__©åibuã__
 ((
__¨tificül__
))

	)

330 
	#__©åibuã_¨tificül__


	)

342 #i‡(!
deföed
 
__˝lu•lus
 || 
	`__GNUC_PREREQ
 (4,3) \

343 || (
deföed
 
__˛™g__
 && (deföed 
__GNUC_STDC_INLINE__
 \

344 || 
deföed
 
__GNUC_GNU_INLINE__
)))

345 #i‡
deföed
 
__GNUC_STDC_INLINE__
 || deföed 
__˝lu•lus


346 
	#__exã∫_ölöe
 
__ölöe
 
	`__©åibuã__
 ((
__gnu_ölöe__
))

	)

347 
	#__exã∫_Æways_ölöe
 \

348 
__Æways_ölöe
 
	`__©åibuã__
 ((
__gnu_ölöe__
))

	)

350 
	#__exã∫_ölöe
 
__ölöe


	)

351 
	#__exã∫_Æways_ölöe
 
__Æways_ölöe


	)

355 #ifde‡
__exã∫_Æways_ölöe


356 
	#__f‹tify_fun˘i⁄
 
__exã∫_Æways_ölöe
 
__©åibuã_¨tificül__


	)

361 #i‡
	`__GNUC_PREREQ
 (4,3)

362 
	#__va_¨g_∑ck
(Ë
	`__buûtö_va_¨g_∑ck
 ()

	)

363 
	#__va_¨g_∑ck_Àn
(Ë
	`__buûtö_va_¨g_∑ck_Àn
 ()

	)

370 #i‡!
	`__GNUC_PREREQ
 (2,8)

371 
	#__exãnsi⁄__


	)

375 #i‡!
	`__GNUC_PREREQ
 (2,92)

376 #i‡
deföed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L

377 
	#__ª°ri˘
 
ª°ri˘


	)

379 
	#__ª°ri˘


	)

386 #i‡
	`__GNUC_PREREQ
 (3,1Ë&& !
deföed
 
__GNUG__


387 
	#__ª°ri˘_¨r
 
__ª°ri˘


	)

389 #ifde‡
__GNUC__


390 
	#__ª°ri˘_¨r


	)

392 #i‡
deföed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L

393 
	#__ª°ri˘_¨r
 
ª°ri˘


	)

396 
	#__ª°ri˘_¨r


	)

401 #i‡
__GNUC__
 >= 3

402 
	#__glibc_u∆ikñy
(
c⁄d
Ë
	`__buûtö_ex≥˘
 ((c⁄d), 0)

	)

403 
	#__glibc_likñy
(
c⁄d
Ë
	`__buûtö_ex≥˘
 ((c⁄d), 1)

	)

405 
	#__glibc_u∆ikñy
(
c⁄d
Ë(c⁄d)

	)

406 
	#__glibc_likñy
(
c⁄d
Ë(c⁄d)

	)

409 #ifde‡
__has_©åibuã


410 
	#__glibc_has_©åibuã
(
©å
Ë
	`__has_©åibuã
 (©å)

	)

412 
	#__glibc_has_©åibuã
(
©å
Ë0

	)

415 #i‡(!
deföed
 
_N‹ëu∫
 \

416 && (
deföed
 
__STDC_VERSION__
 ? __STDC_VERSION__ : 0) < 201112 \

417 && !
	$__GNUC_PREREQ
 (4,7))

418 #i‡
	`__GNUC_PREREQ
 (2,8)

419 
	#_N‹ëu∫
 
	`__©åibuã__
 ((
__n‹ëu∫__
))

	)

421 
	#_N‹ëu∫


	)

425 #i‡
	`__GNUC_PREREQ
 (8, 0)

429 
	#__©åibuã_n⁄°rög__
 
	`__©åibuã__
 ((
__n⁄°rög__
))

	)

431 
	#__©åibuã_n⁄°rög__


	)

435 #unde‡
__©åibuã_c›y__


436 #i‡
	`__GNUC_PREREQ
 (9, 0)

439 
	#__©åibuã_c›y__
(
¨g
Ë
	`__©åibuã__
 ((
	`__c›y__
 (¨g)))

	)

441 
	#__©åibuã_c›y__
(
¨g
)

	)

444 #i‡(!
deföed
 
_Sètic_as£π
 && !deföed 
__˝lu•lus
 \

445 && (
deföed
 
__STDC_VERSION__
 ? __STDC_VERSION__ : 0) < 201112 \

446 && (!
	`__GNUC_PREREQ
 (4, 6Ë|| 
deföed
 
__STRICT_ANSI__
))

447 
	#_Sètic_as£π
(
ex¥
, 
dügno°ic
) \

448 (*
	`__Sètic_as£π_fun˘i⁄
 ()) \

449 [!! (°ru˘ { 
__îr‹_if_√g©ive
: (
ex¥
Ë? 2 : -1; })]

	)

452 
	~<bôs/w‹dsize.h
>

453 
	~<bôs/l⁄g-doubÀ.h
>

455 #i‡
deföed
 
__LONG_DOUBLE_MATH_OPTIONAL
 && deföed 
__NO_LONG_DOUBLE_MATH


456 
	#__LDBL_COMPAT
 1

	)

457 #ifde‡
__REDIRECT


458 
	#__LDBL_REDIR1
(
«me
, 
¥Ÿo
, 
Æüs
Ë
	`__REDIRECT
 («me,ÖrŸo,álüs)

	)

459 
	#__LDBL_REDIR
(
«me
, 
¥Ÿo
) \

460 
	`__LDBL_REDIR1
 (
«me
, 
¥Ÿo
, 
__∆dbl_
##«me)

	)

461 
	#__LDBL_REDIR1_NTH
(
«me
, 
¥Ÿo
, 
Æüs
Ë
	`__REDIRECT_NTH
 («me,ÖrŸo,álüs)

	)

462 
	#__LDBL_REDIR_NTH
(
«me
, 
¥Ÿo
) \

463 
	`__LDBL_REDIR1_NTH
 (
«me
, 
¥Ÿo
, 
__∆dbl_
##«me)

	)

464 
	#__LDBL_REDIR1_DECL
(
«me
, 
Æüs
) \

465 
	`__ty≥of
 (
«me
Ë«mê
	`__asm
 (
	`__ASMNAME
 (#Æüs));

	)

466 
	#__LDBL_REDIR_DECL
(
«me
) \

467 
	`__ty≥of
 (
«me
Ë«mê
	`__asm
 (
	`__ASMNAME
 ("__∆dbl_" #«me));

	)

468 
	#__REDIRECT_LDBL
(
«me
, 
¥Ÿo
, 
Æüs
) \

469 
	`__LDBL_REDIR1
 (
«me
, 
¥Ÿo
, 
__∆dbl_
##
Æüs
)

	)

470 
	#__REDIRECT_NTH_LDBL
(
«me
, 
¥Ÿo
, 
Æüs
) \

471 
	`__LDBL_REDIR1_NTH
 (
«me
, 
¥Ÿo
, 
__∆dbl_
##
Æüs
)

	)

474 #i‡!
deföed
 
__LDBL_COMPAT
 || !deföed 
__REDIRECT


475 
	#__LDBL_REDIR1
(
«me
, 
¥Ÿo
, 
Æüs
Ë«mê
	)
proto

476 
	#__LDBL_REDIR
(
«me
, 
¥Ÿo
Ë«mê
	)
proto

477 
	#__LDBL_REDIR1_NTH
(
«me
, 
¥Ÿo
, 
Æüs
Ë«mê¥Ÿÿ
__THROW


	)

478 
	#__LDBL_REDIR_NTH
(
«me
, 
¥Ÿo
Ë«mê¥Ÿÿ
__THROW


	)

479 
	#__LDBL_REDIR_DECL
(
«me
)

	)

480 #ifde‡
__REDIRECT


481 
	#__REDIRECT_LDBL
(
«me
, 
¥Ÿo
, 
Æüs
Ë
	`__REDIRECT
 («me,ÖrŸo,álüs)

	)

482 
	#__REDIRECT_NTH_LDBL
(
«me
, 
¥Ÿo
, 
Æüs
) \

483 
	`__REDIRECT_NTH
 (
«me
, 
¥Ÿo
, 
Æüs
)

	)

492 #i‡
	`__GNUC_PREREQ
 (4,8Ë|| 
	`__glibc_˛™g_¥îeq
 (3,5)

493 
	#__glibc_ma¸o_w¨nög1
(
mesßge
Ë
	`_Pøgma
 (#mesßge)

	)

494 
	#__glibc_ma¸o_w¨nög
(
mesßge
) \

495 
	`__glibc_ma¸o_w¨nög1
 (
GCC
 
w¨nög
 
mesßge
)

	)

497 
	#__glibc_ma¸o_w¨nög
(
msg
)

	)

507 #i‡!
deföed
 
__˝lu•lus
 \

508 && (
	`__GNUC_PREREQ
 (4, 9) \

509 || 
	`__glibc_˛™g_has_exãnsi⁄
 (
c_gíîic_£À˘i⁄s
) \

510 || (!
deföed
 
__GNUC__
 && deföed 
__STDC_VERSION__
 \

511 && 
__STDC_VERSION__
 >= 201112L))

512 
	#__HAVE_GENERIC_SELECTION
 1

	)

514 
	#__HAVE_GENERIC_SELECTION
 0

	)

	@/usr/include/bits/long-double.h

21 
	#__LONG_DOUBLE_USES_FLOAT128
 0

	)

	@/usr/include/bits/wordsize.h

3 #i‡
deföed
 
__x86_64__
 && !deföed 
__ILP32__


4 
	#__WORDSIZE
 64

	)

6 
	#__WORDSIZE
 32

	)

7 
	#__WORDSIZE32_SIZE_ULONG
 0

	)

8 
	#__WORDSIZE32_PTRDIFF_LONG
 0

	)

11 #ifde‡
__x86_64__


12 
	#__WORDSIZE_TIME64_COMPAT32
 1

	)

14 
	#__SYSCALL_WORDSIZE
 64

	)

16 
	#__WORDSIZE_TIME64_COMPAT32
 0

	)

	@/usr/include/gnu/stubs-32.h

6 #ifde‡
_LIBC


7 #îr‹ 
Aµliˇti⁄s
 
may
 
nŸ
 
deföe
 
the
 
ma¸o
 
_LIBC


10 
	#__°ub_chÊags


	)

11 
	#__°ub_fchÊags


	)

12 
	#__°ub_gây


	)

13 
	#__°ub_lchmod


	)

14 
	#__°ub_ªvoke


	)

15 
	#__°ub_£éogö


	)

16 
	#__°ub_sigªtu∫


	)

17 
	#__°ub_s°k


	)

18 
	#__°ub_°ty


	)

	@/usr/include/gnu/stubs-64.h

6 #ifde‡
_LIBC


7 #îr‹ 
Aµliˇti⁄s
 
may
 
nŸ
 
deföe
 
the
 
ma¸o
 
_LIBC


10 
	#__°ub___com∑t_bdÊush


	)

11 
	#__°ub_chÊags


	)

12 
	#__°ub_fchÊags


	)

13 
	#__°ub_gây


	)

14 
	#__°ub_lchmod


	)

15 
	#__°ub_ªvoke


	)

16 
	#__°ub_£éogö


	)

17 
	#__°ub_sigªtu∫


	)

18 
	#__°ub_s°k


	)

19 
	#__°ub_°ty


	)

	@
1
.
1
/usr/include
16
312
config.h
libregexp.c
libunicode.c
main.c
qjs.c
quickjs-libc.c
quickjs.c
/usr/include/assert.h
/usr/include/features.h
/usr/include/gnu/stubs.h
/usr/include/stdc-predef.h
/usr/include/sys/cdefs.h
/usr/include/bits/long-double.h
/usr/include/bits/wordsize.h
/usr/include/gnu/stubs-32.h
/usr/include/gnu/stubs-64.h
